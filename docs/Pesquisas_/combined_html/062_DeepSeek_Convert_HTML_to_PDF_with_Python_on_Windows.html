<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang xml:lang>
<head>

        <style id="fixed-toc-styles">
        /* === ESTILOS PRINCIPAIS - TOC FIXO √Ä DIREITA === */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
            scroll-behavior: smooth;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            position: relative;
        }
        /* === TOC FIXO √Ä DIREITA - POSI√á√ÉO CORRIGIDA === */
        #TOC {
            position: fixed !important;
            top: 50% !important;
            right: 20px !important;
            transform: translateY(-50%) !important;
            width: 320px !important;
            max-height: 80vh !important;
            overflow-y: auto !important;
            z-index: 1000 !important;
            background: rgba(255, 255, 255, 0.98) !important;
            padding: 20px !important;
            border-radius: 12px !important;
            box-shadow: 0 8px 32px rgba(0,0,0,0.15) !important;
            border: 1px solid #e0e0e0 !important;
            backdrop-filter: blur(10px) !important;
            transition: all 0.3s ease-in-out !important;
        }
        #TOC.toc-minimized {
            transform: translateY(-50%) translateX(calc(320px - 50px)) !important;
            opacity: 0.3;
            width: 50px !important;
            overflow: hidden;
        }
        #TOC.toc-minimized > *:not(.toc-toggle-btn) {
            display: none !important;
        }
        #TOC h2 {
            margin-top: 0;
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
            font-size: 1.2em;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .toc-toggle-btn {
            background: none;
            border: none;
            font-size: 1.2em;
            cursor: pointer;
            padding: 5px;
            border-radius: 4px;
            transition: background-color 0.2s;
        }
        .toc-toggle-btn:hover {
            background-color: rgba(0,0,0,0.1);
        }
        #TOC ul {
            list-style-type: none;
            padding-left: 15px;
            margin: 10px 0;
        }
        #TOC ul ul {
            padding-left: 20px;
        }
        #TOC li {
            margin: 8px 0;
            line-height: 1.4;
        }
        #TOC a {
            text-decoration: none;
            color: #495057;
            font-weight: 500;
            transition: all 0.2s ease;
            display: block;
            padding: 6px 10px;
            border-radius: 6px;
            border-left: 3px solid transparent;
        }
        #TOC a:hover {
            color: #007bff;
            background-color: rgba(0, 123, 255, 0.1);
            border-left-color: #007bff;
        }
        #TOC a.active {
            background-color: #007bff !important;
            color: white !important;
            font-weight: bold;
            border-left-color: #0056b3;
        }
        /* Conte√∫do principal com margem para o TOC */
        .main-content {
            margin-right: calc(320px + 40px) !important;
        }
        /* Barra de scroll personalizada APENAS para TOC */
        #TOC::-webkit-scrollbar {
            width: 8px;
        }
        #TOC::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }
        #TOC::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 4px;
        }
        #TOC::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }
        /* === BOT√ÉO VOLTAR AO TOPO (HTMLs individuais) === */
        .back-to-top-content {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            font-size: 18px;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 999;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .back-to-top-content.show {
            opacity: 1;
            transform: translateY(0);
        }
        .back-to-top-content:hover {
            background: #0056b3;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0,0,0,0.2);
        }
        /* === RESPONSIVIDADE === */
        @media (max-width: 1400px) {
            .container {
                max-width: 95%;
                padding: 30px;
            }
            #TOC {
                width: 280px !important;
            }
            .main-content {
                margin-right: 320px !important;
            }
        }
        @media (max-width: 1200px) {
            #TOC {
                width: 260px !important;
                right: 15px !important;
            }
            .main-content {
                margin-right: 300px !important;
            }
        }
        @media (max-width: 992px) {
            #TOC {
                position: relative !important;
                width: 100% !important;
                right: 0 !important;
                top: 0 !important;
                transform: none !important;
                margin: 20px 0;
                max-height: 300px !important;
            }
            .main-content {
                margin-right: 0 !important;
            }
            .back-to-top-content {
                right: 20px;
                bottom: 20px;
            }
        }
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            .container {
                padding: 20px;
                max-width: 100%;
            }
            #TOC {
                max-height: 250px !important;
                padding: 15px !important;
            }
        }
        </style>
        
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>062_DeepSeek_Convert_HTML_to_PDF_with_Python_on_Windows</title>
  <style>

html {
color: #1a1a1a;
background-color: #fdfdfd;
}
body {
margin: 0 auto;
max-width: 36em;
padding-left: 50px;
padding-right: 50px;
padding-top: 50px;
padding-bottom: 50px;
hyphens: auto;
overflow-wrap: break-word;
text-rendering: optimizeLegibility;
font-kerning: normal;
}
@media (max-width: 600px) {
body {
font-size: 0.9em;
padding: 12px;
}
h1 {
font-size: 1.8em;
}
}
@media print {
html {
background-color: white;
}
body {
background-color: transparent;
color: black;
font-size: 12pt;
}
p, h2, h3 {
orphans: 3;
widows: 3;
}
h2, h3, h4 {
page-break-after: avoid;
}
}
p {
margin: 1em 0;
}
a {
color: #1a1a1a;
}
a:visited {
color: #1a1a1a;
}
img {
max-width: 100%;
}
svg {
height: auto;
max-width: 100%;
}
h1, h2, h3, h4, h5, h6 {
margin-top: 1.4em;
}
h5, h6 {
font-size: 1em;
font-style: italic;
}
h6 {
font-weight: normal;
}
ol, ul {
padding-left: 1.7em;
margin-top: 1em;
}
li > ol, li > ul {
margin-top: 0;
}
blockquote {
margin: 1em 0 1em 1.7em;
padding-left: 1em;
border-left: 2px solid #e6e6e6;
color: #606060;
}
code {
font-family: Menlo, Monaco, Consolas, 'Lucida Console', monospace;
font-size: 85%;
margin: 0;
hyphens: manual;
}
pre {
margin: 1em 0;
overflow: auto;
}
pre code {
padding: 0;
overflow: visible;
overflow-wrap: normal;
}
.sourceCode {
background-color: transparent;
overflow: visible;
}
hr {
border: none;
border-top: 1px solid #1a1a1a;
height: 1px;
margin: 1em 0;
}
table {
margin: 1em 0;
border-collapse: collapse;
width: 100%;
overflow-x: auto;
display: block;
font-variant-numeric: lining-nums tabular-nums;
}
table caption {
margin-bottom: 0.75em;
}
tbody {
margin-top: 0.5em;
border-top: 1px solid #1a1a1a;
border-bottom: 1px solid #1a1a1a;
}
th {
border-top: 1px solid #1a1a1a;
padding: 0.25em 0.5em 0.25em 0.5em;
}
td {
padding: 0.125em 0.5em 0.25em 0.5em;
}
header {
margin-bottom: 4em;
text-align: center;
}
#TOC li {
list-style: none;
}
#TOC ul {
padding-left: 1.3em;
}
#TOC > ul {
padding-left: 0;
}
#TOC a:not(:hover) {
text-decoration: none;
}
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}

ul.task-list[class]{list-style: none;}
ul.task-list li input[type="checkbox"] {
font-size: inherit;
width: 0.8em;
margin: 0 0.8em 0.2em -1.6em;
vertical-align: middle;
}

html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
</head>
<body>
<nav id="TOC" role="doc-toc">
<ul>
<li><a href="#convert-html-to-pdf-with-python-on-windows" id="toc-convert-html-to-pdf-with-python-on-windows"><span class="toc-section-number">1</span> Convert HTML to PDF with Python on
Windows</a>
<ul>
<li><a href="#informa√ß√µes" id="toc-informa√ß√µes"><span class="toc-section-number">1.1</span> üìä Informa√ß√µes</a></li>
<li><a href="#conversa" id="toc-conversa"><span class="toc-section-number">1.2</span> üí¨ Conversa</a></li>
<li><a href="#op√ß√£o-1-weasyprint-recomendada" id="toc-op√ß√£o-1-weasyprint-recomendada"><span class="toc-section-number">1.3</span> ü•á <strong>Op√ß√£o 1: WeasyPrint
(Recomendada)</strong></a></li>
<li><a href="#op√ß√£o-2-pdfkit-com-wkhtmltopdf" id="toc-op√ß√£o-2-pdfkit-com-wkhtmltopdf"><span class="toc-section-number">1.4</span> ü•à <strong>Op√ß√£o 2: pdfkit (com
wkhtmltopdf)</strong></a></li>
<li><a href="#op√ß√£o-3-usando-pandoc-diretamente-se-j√°-tiver-latex" id="toc-op√ß√£o-3-usando-pandoc-diretamente-se-j√°-tiver-latex"><span class="toc-section-number">1.5</span> ü•â <strong>Op√ß√£o 3: Usando Pandoc
diretamente (se j√° tiver LaTeX)</strong></a></li>
<li><a href="#minha-recomenda√ß√£o-weasyprint" id="toc-minha-recomenda√ß√£o-weasyprint"><span class="toc-section-number">1.6</span> üèÜ <strong>Minha Recomenda√ß√£o:
WeasyPrint</strong></a></li>
<li><a href="#como-usar" id="toc-como-usar"><span class="toc-section-number">1.7</span> üìã <strong>Como
usar:</strong></a></li>
<li><a href="#caracter√≠sticas-do-script" id="toc-caracter√≠sticas-do-script"><span class="toc-section-number">1.8</span> ‚ú® <strong>Caracter√≠sticas do
script:</strong></a></li>
<li><a href="#script-corrigido-html_to_pdf2.py" id="toc-script-corrigido-html_to_pdf2.py"><span class="toc-section-number">1.9</span> üêõ <strong>Script Corrigido:
html_to_pdf2.py</strong></a></li>
<li><a href="#principais-corre√ß√µes" id="toc-principais-corre√ß√µes"><span class="toc-section-number">1.10</span> üîß <strong>Principais
Corre√ß√µes:</strong></a></li>
<li><a href="#como-usar-agora" id="toc-como-usar-agora"><span class="toc-section-number">1.11</span> üöÄ <strong>Como usar
agora:</strong></a></li>
<li><a href="#se-ainda-houver-problemas-tente" id="toc-se-ainda-houver-problemas-tente"><span class="toc-section-number">1.12</span> üìù <strong>Se ainda houver
problemas, tente:</strong></a></li>
<li><a href="#script-corrigido-html_to_pdf2.py-1" id="toc-script-corrigido-html_to_pdf2.py-1"><span class="toc-section-number">1.13</span> üîß <strong>Script Corrigido:
html_to_pdf2.py</strong></a></li>
<li><a href="#se-ainda-n√£o-funcionar-tente-esta-solu√ß√£o-alternativa" id="toc-se-ainda-n√£o-funcionar-tente-esta-solu√ß√£o-alternativa"><span class="toc-section-number">1.14</span> üöÄ <strong>Se ainda n√£o
funcionar, tente esta solu√ß√£o alternativa:</strong></a></li>
<li><a href="#solu√ß√£o-definitiva-html_to_pdf_selenium.py" id="toc-solu√ß√£o-definitiva-html_to_pdf_selenium.py"><span class="toc-section-number">1.15</span> üöÄ <strong>Solu√ß√£o Definitiva:
html_to_pdf_selenium.py</strong></a></li>
<li><a href="#instala√ß√£o-das-depend√™ncias-1" id="toc-instala√ß√£o-das-depend√™ncias-1"><span class="toc-section-number">1.16</span> üì¶ <strong>Instala√ß√£o das
Depend√™ncias:</strong></a></li>
<li><a href="#como-usar-1" id="toc-como-usar-1"><span class="toc-section-number">1.17</span> üöÄ <strong>Como
Usar:</strong></a></li>
<li><a href="#vantagens-desta-solu√ß√£o" id="toc-vantagens-desta-solu√ß√£o"><span class="toc-section-number">1.18</span> ‚úÖ <strong>Vantagens desta
Solu√ß√£o:</strong></a></li>
<li><a href="#script-melhorado-html_to_pdf_selenium_enhanced.py" id="toc-script-melhorado-html_to_pdf_selenium_enhanced.py"><span class="toc-section-number">1.19</span> üî• <strong>Script Melhorado:
html_to_pdf_selenium_enhanced.py</strong></a></li>
<li><a href="#como-usar-a-vers√£o-melhorada" id="toc-como-usar-a-vers√£o-melhorada"><span class="toc-section-number">1.20</span> üéØ <strong>Como usar a vers√£o
melhorada:</strong></a></li>
<li><a href="#se-ainda-houver-problemas-com-emojis-tente-isto" id="toc-se-ainda-houver-problemas-com-emojis-tente-isto"><span class="toc-section-number">1.21</span> üîß <strong>Se ainda houver
problemas com emojis, tente isto:</strong></a></li>
<li><a href="#resumo-das-melhorias" id="toc-resumo-das-melhorias"><span class="toc-section-number">1.22</span> üìã <strong>Resumo das
melhorias:</strong></a></li>
<li><a href="#resumo-da-solu√ß√£o-final" id="toc-resumo-da-solu√ß√£o-final"><span class="toc-section-number">1.23</span> ‚úÖ <strong>Resumo da Solu√ß√£o
Final:</strong></a></li>
<li><a href="#para-usar-com-outros-documentos-html" id="toc-para-usar-com-outros-documentos-html"><span class="toc-section-number">1.24</span> üöÄ <strong>Para usar com outros
documentos HTML:</strong></a></li>
<li><a href="#estrutura-dos-arquivos-gerados" id="toc-estrutura-dos-arquivos-gerados"><span class="toc-section-number">1.25</span> üìÅ <strong>Estrutura dos arquivos
gerados:</strong></a></li>
<li><a href="#dica-para-uso-futuro" id="toc-dica-para-uso-futuro"><span class="toc-section-number">1.26</span> üí° <strong>Dica para uso
futuro:</strong></a></li>
</ul></li>
</ul>
</nav>
<h1 data-number="1" id="convert-html-to-pdf-with-python-on-windows"><span class="header-section-number">1</span> Convert HTML to PDF with Python
on Windows</h1>
<h2 data-number="1.1" id="informa√ß√µes"><span class="header-section-number">1.1</span> üìä Informa√ß√µes</h2>
<ul>
<li><strong>N√∫mero:</strong> #62</li>
<li><strong>Origem:</strong> DeepSeek</li>
<li><strong>Categoria:</strong> Programa√ß√£o</li>
<li><strong>ID:</strong> cd9fd037-35d3-47d2-a665-22384f0c7fa4</li>
<li><strong>Criada em:</strong> 2025-11-01 02:42:40</li>
<li><strong>Atualizada em:</strong> 2025-11-01 03:46:58</li>
<li><strong>Total de mensagens:</strong> 18</li>
<li><strong>Resumo:</strong> Converter html para pdf. Qual a melhor
forma. Usando python (conda , Windows). O html tem f√≥rmulas m‚Ä¶</li>
</ul>
<hr />
<h2 data-number="1.2" id="conversa"><span class="header-section-number">1.2</span> üí¨ Conversa</h2>
<h3 data-number="1.2.1" id="utilizador-2025-11-01-024241-deepseek-chat"><span class="header-section-number">1.2.1</span> üë§ Utilizador <em>(2025-11-01
02:42:41)</em> <em>[deepseek-chat]</em></h3>
<p>Converter html para pdf. Qual a melhor forma. Usando python (conda ,
Windows). O html tem f√≥rmulas matem√°ticas que foram geradas do LaTeX e
cont√™m tamb√©m v√°rios emojis. O file a converter √©
exemplo_completo.html</p>
<hr />
<h3 data-number="1.2.2" id="deepseek-2025-11-01-024241-deepseek-chat"><span class="header-section-number">1.2.2</span> ü§ñ DeepSeek <em>(2025-11-01
02:42:41)</em> <em>[deepseek-chat]</em></h3>
<p>Para converter HTML para PDF mantendo f√≥rmulas matem√°ticas e emojis
no Windows com Python/Conda, aqui est√£o as <strong>melhores
op√ß√µes</strong>:</p>
<h2 data-number="1.3" id="op√ß√£o-1-weasyprint-recomendada"><span class="header-section-number">1.3</span> ü•á <strong>Op√ß√£o 1: WeasyPrint
(Recomendada)</strong></h2>
<h3 data-number="1.3.1" id="instala√ß√£o"><span class="header-section-number">1.3.1</span> Instala√ß√£o:</h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">conda</span> install <span class="at">-c</span> conda-forge weasyprint</span></code></pre></div>
<h3 data-number="1.3.2" id="c√≥digo-python"><span class="header-section-number">1.3.2</span> C√≥digo Python:</h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> weasyprint <span class="im">import</span> HTML</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> html_to_pdf_weasyprint(input_html, output_pdf):</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    HTML(input_html).write_pdf(output_pdf)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Uso</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>html_to_pdf_weasyprint(<span class="st">&#39;exemplo_completo.html&#39;</span>, <span class="st">&#39;exemplo_completo.pdf&#39;</span>)</span></code></pre></div>
<p><strong>Vantagens:</strong> - Suporte nativo a emojis - Boa
renderiza√ß√£o de f√≥rmulas MathJax/LaTeX - N√£o requer LaTeX instalado -
F√°cil instala√ß√£o via conda</p>
<hr />
<h2 data-number="1.4" id="op√ß√£o-2-pdfkit-com-wkhtmltopdf"><span class="header-section-number">1.4</span> ü•à <strong>Op√ß√£o 2: pdfkit (com
wkhtmltopdf)</strong></h2>
<h3 data-number="1.4.1" id="instala√ß√£o-1"><span class="header-section-number">1.4.1</span> Instala√ß√£o:</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="ex">conda</span> install <span class="at">-c</span> conda-forge pdfkit</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Baixe e instale wkhtmltopdf de: https://wkhtmltopdf.org/downloads.html</span></span></code></pre></div>
<h3 data-number="1.4.2" id="c√≥digo-python-1"><span class="header-section-number">1.4.2</span> C√≥digo Python:</h3>
<div class="sourceCode" id="cb4"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pdfkit</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Configure o caminho para wkhtmltopdf (ajuste conforme sua instala√ß√£o)</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>config <span class="op">=</span> pdfkit.configuration(wkhtmltopdf<span class="op">=</span><span class="vs">r&#39;C:</span><span class="er">\</span><span class="vs">Program Files</span><span class="dv">\w</span><span class="vs">khtmltopdf</span><span class="dv">\b</span><span class="vs">in</span><span class="dv">\w</span><span class="vs">khtmltopdf</span><span class="dv">.</span><span class="vs">exe&#39;</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> html_to_pdf_pdfkit(input_html, output_pdf):</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    options <span class="op">=</span> {</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;enable-local-file-access&#39;</span>: <span class="va">None</span>,</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;encoding&#39;</span>: <span class="st">&quot;UTF-8&quot;</span>,</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;no-stop-slow-scripts&#39;</span>: <span class="va">None</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    pdfkit.from_file(input_html, output_pdf, options<span class="op">=</span>options, configuration<span class="op">=</span>config)</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Uso</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>html_to_pdf_pdfkit(<span class="st">&#39;exemplo_completo.html&#39;</span>, <span class="st">&#39;exemplo_completo.pdf&#39;</span>)</span></code></pre></div>
<hr />
<h2 data-number="1.5" id="op√ß√£o-3-usando-pandoc-diretamente-se-j√°-tiver-latex"><span class="header-section-number">1.5</span> ü•â <strong>Op√ß√£o 3: Usando
Pandoc diretamente (se j√° tiver LaTeX)</strong></h2>
<h3 data-number="1.5.1" id="instala√ß√£o-2"><span class="header-section-number">1.5.1</span> Instala√ß√£o:</h3>
<div class="sourceCode" id="cb5"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="ex">conda</span> install <span class="at">-c</span> conda-forge pandoc</span></code></pre></div>
<h3 data-number="1.5.2" id="c√≥digo-python-2"><span class="header-section-number">1.5.2</span> C√≥digo Python:</h3>
<div class="sourceCode" id="cb6"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> subprocess</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> html_to_pdf_pandoc(input_html, output_pdf):</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    cmd <span class="op">=</span> [</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;pandoc&#39;</span>, input_html,</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;-o&#39;</span>, output_pdf,</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;--pdf-engine=xelatex&#39;</span>,</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;--variable&#39;</span>, <span class="st">&#39;mainfont=&quot;Arial&quot;&#39;</span>,</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;--include-in-header&#39;</span>, <span class="st">&#39;emoji-support.tex&#39;</span>  <span class="co"># Para melhor suporte a emojis</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>    subprocess.run(cmd, check<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Uso</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>html_to_pdf_pandoc(<span class="st">&#39;exemplo_completo.html&#39;</span>, <span class="st">&#39;exemplo_completo.pdf&#39;</span>)</span></code></pre></div>
<p><strong>Arquivo <code>emoji-support.tex</code> (crie este
arquivo):</strong></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode latex"><code class="sourceCode latex"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="bu">\usepackage</span>{<span class="ex">fontspec</span>}</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="bu">\usepackage</span>{<span class="ex">emoji</span>}</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">\setmainfont</span>{Arial}[Renderer=Harfbuzz]</span></code></pre></div>
<hr />
<h2 data-number="1.6" id="minha-recomenda√ß√£o-weasyprint"><span class="header-section-number">1.6</span> üèÜ <strong>Minha Recomenda√ß√£o:
WeasyPrint</strong></h2>
<p>Para seu caso espec√≠fico, recomendo <strong>WeasyPrint</strong>
porque:</p>
<ol type="1">
<li>‚úÖ <strong>Suporte a emojis</strong> nativo</li>
<li>‚úÖ <strong>F√≥rmulas matem√°ticas</strong> do MathJax funcionam
bem</li>
<li>‚úÖ <strong>F√°cil instala√ß√£o</strong> via conda</li>
<li>‚úÖ <strong>N√£o depende</strong> de LaTeX ou outros programas
externos</li>
<li>‚úÖ <strong>Resultados consistentes</strong> no Windows</li>
</ol>
<h3 data-number="1.6.1" id="script-completo-recomendado"><span class="header-section-number">1.6.1</span> Script completo
recomendado:</h3>
<div class="sourceCode" id="cb8"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> weasyprint <span class="im">import</span> HTML, CSS</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convert_html_to_pdf(input_html, output_pdf):</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co">    Converte HTML para PDF mantendo f√≥rmulas e emojis</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co">    &quot;&quot;&quot;</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Configura√ß√µes adicionais para melhor renderiza√ß√£o</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>        css <span class="op">=</span> CSS(string<span class="op">=</span><span class="st">&#39;&#39;&#39;</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="st">            @page {</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="st">                size: A4;</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="st">                margin: 1cm;</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="st">            body {</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a><span class="st">                font-family: &quot;Arial&quot;, &quot;DejaVu Sans&quot;, sans-serif;</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a><span class="st">            pre, code {</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a><span class="st">                background-color: #f6f8fa;</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a><span class="st">                padding: 10px;</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a><span class="st">                border-radius: 5px;</span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a><span class="st">        &#39;&#39;&#39;</span>)</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Convers√£o</span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>        HTML(input_html).write_pdf(output_pdf, stylesheets<span class="op">=</span>[css])</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ PDF gerado com sucesso: </span><span class="sc">{</span>output_pdf<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;‚ùå Erro na convers√£o: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Uso</span></span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&quot;__main__&quot;</span>:</span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>    convert_html_to_pdf(<span class="st">&#39;exemplo_completo.html&#39;</span>, <span class="st">&#39;exemplo_completo.pdf&#39;</span>)</span></code></pre></div>
<h3 data-number="1.6.2" id="instala√ß√£o-completa-no-conda"><span class="header-section-number">1.6.2</span> Instala√ß√£o completa no
Conda:</h3>
<div class="sourceCode" id="cb9"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="ex">conda</span> create <span class="at">-n</span> html2pdf python=3.9</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="ex">conda</span> activate html2pdf</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="ex">conda</span> install <span class="at">-c</span> conda-forge weasyprint</span></code></pre></div>
<p>Execute o script e seu HTML com f√≥rmulas e emojis ser√° convertido
perfeitamente para PDF! üéâ</p>
<hr />
<h3 data-number="1.6.3" id="utilizador-2025-11-01-024520-deepseek-chat"><span class="header-section-number">1.6.3</span> üë§ Utilizador <em>(2025-11-01
02:45:20)</em> <em>[deepseek-chat]</em></h3>
<p>pretendo um script completo com o nome html_to_pdf2.py</p>
<hr />
<h3 data-number="1.6.4" id="deepseek-2025-11-01-024520-deepseek-chat"><span class="header-section-number">1.6.4</span> ü§ñ DeepSeek <em>(2025-11-01
02:45:20)</em> <em>[deepseek-chat]</em></h3>
<p>Aqui est√° um script completo <code>html_to_pdf2.py</code> para
converter HTML para PDF:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/usr/bin/env python3</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co">&quot;&quot;&quot;</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co">html_to_pdf2.py - Conversor completo de HTML para PDF</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co">Suporte para f√≥rmulas matem√°ticas, emojis e m√∫ltiplos m√©todos de convers√£o</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co">&quot;&quot;&quot;</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sys</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> argparse</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> subprocess</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tempfile</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> time</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>    <span class="im">from</span> weasyprint <span class="im">import</span> HTML, CSS</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>    WEASYPRINT_AVAILABLE <span class="op">=</span> <span class="va">True</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> <span class="pp">ImportError</span>:</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>    WEASYPRINT_AVAILABLE <span class="op">=</span> <span class="va">False</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>    <span class="im">import</span> pdfkit</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>    PDFKIT_AVAILABLE <span class="op">=</span> <span class="va">True</span></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> <span class="pp">ImportError</span>:</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>    PDFKIT_AVAILABLE <span class="op">=</span> <span class="va">False</span></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> HTMLToPDFConverter:</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, verbose<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.verbose <span class="op">=</span> verbose</span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.methods <span class="op">=</span> <span class="va">self</span>._get_available_methods()</span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _get_available_methods(<span class="va">self</span>):</span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Detecta m√©todos de convers√£o dispon√≠veis&quot;&quot;&quot;</span></span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>        methods <span class="op">=</span> {}</span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Verifica WeasyPrint</span></span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> WEASYPRINT_AVAILABLE:</span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a>            methods[<span class="st">&#39;weasyprint&#39;</span>] <span class="op">=</span> {</span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;name&#39;</span>: <span class="st">&#39;WeasyPrint&#39;</span>,</span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;function&#39;</span>: <span class="va">self</span>._convert_weasyprint,</span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;recommended&#39;</span>: <span class="va">True</span></span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Verifica pdfkit</span></span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> PDFKIT_AVAILABLE:</span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Tenta encontrar wkhtmltopdf</span></span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a>            wkhtmltopdf_paths <span class="op">=</span> [</span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a>                <span class="vs">r&#39;C:</span><span class="er">\</span><span class="vs">Program Files</span><span class="dv">\w</span><span class="vs">khtmltopdf</span><span class="dv">\b</span><span class="vs">in</span><span class="dv">\w</span><span class="vs">khtmltopdf</span><span class="dv">.</span><span class="vs">exe&#39;</span>,</span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true" tabindex="-1"></a>                <span class="vs">r&#39;C:</span><span class="dv">\w</span><span class="vs">khtmltopdf</span><span class="dv">\b</span><span class="vs">in</span><span class="dv">\w</span><span class="vs">khtmltopdf</span><span class="dv">.</span><span class="vs">exe&#39;</span>,</span>
<span id="cb10-50"><a href="#cb10-50" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;/usr/local/bin/wkhtmltopdf&#39;</span>,</span>
<span id="cb10-51"><a href="#cb10-51" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;/usr/bin/wkhtmltopdf&#39;</span></span>
<span id="cb10-52"><a href="#cb10-52" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb10-53"><a href="#cb10-53" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb10-54"><a href="#cb10-54" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> path <span class="kw">in</span> wkhtmltopdf_paths:</span>
<span id="cb10-55"><a href="#cb10-55" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> os.path.exists(path):</span>
<span id="cb10-56"><a href="#cb10-56" aria-hidden="true" tabindex="-1"></a>                    methods[<span class="st">&#39;pdfkit&#39;</span>] <span class="op">=</span> {</span>
<span id="cb10-57"><a href="#cb10-57" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;name&#39;</span>: <span class="st">&#39;pdfkit (wkhtmltopdf)&#39;</span>,</span>
<span id="cb10-58"><a href="#cb10-58" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;function&#39;</span>: <span class="va">self</span>._convert_pdfkit,</span>
<span id="cb10-59"><a href="#cb10-59" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;wkhtmltopdf_path&#39;</span>: path</span>
<span id="cb10-60"><a href="#cb10-60" aria-hidden="true" tabindex="-1"></a>                    }</span>
<span id="cb10-61"><a href="#cb10-61" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">break</span></span>
<span id="cb10-62"><a href="#cb10-62" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-63"><a href="#cb10-63" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Verifica pandoc</span></span>
<span id="cb10-64"><a href="#cb10-64" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb10-65"><a href="#cb10-65" aria-hidden="true" tabindex="-1"></a>            subprocess.run([<span class="st">&#39;pandoc&#39;</span>, <span class="st">&#39;--version&#39;</span>], capture_output<span class="op">=</span><span class="va">True</span>, check<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb10-66"><a href="#cb10-66" aria-hidden="true" tabindex="-1"></a>            methods[<span class="st">&#39;pandoc&#39;</span>] <span class="op">=</span> {</span>
<span id="cb10-67"><a href="#cb10-67" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;name&#39;</span>: <span class="st">&#39;Pandoc&#39;</span>,</span>
<span id="cb10-68"><a href="#cb10-68" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;function&#39;</span>: <span class="va">self</span>._convert_pandoc</span>
<span id="cb10-69"><a href="#cb10-69" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb10-70"><a href="#cb10-70" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> (subprocess.CalledProcessError, <span class="pp">FileNotFoundError</span>):</span>
<span id="cb10-71"><a href="#cb10-71" aria-hidden="true" tabindex="-1"></a>            <span class="cf">pass</span></span>
<span id="cb10-72"><a href="#cb10-72" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb10-73"><a href="#cb10-73" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> methods</span>
<span id="cb10-74"><a href="#cb10-74" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-75"><a href="#cb10-75" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _log(<span class="va">self</span>, message):</span>
<span id="cb10-76"><a href="#cb10-76" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Log de mensagens se verbose estiver ativado&quot;&quot;&quot;</span></span>
<span id="cb10-77"><a href="#cb10-77" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.verbose:</span>
<span id="cb10-78"><a href="#cb10-78" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;[INFO] </span><span class="sc">{</span>message<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb10-79"><a href="#cb10-79" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-80"><a href="#cb10-80" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _convert_weasyprint(<span class="va">self</span>, input_file, output_file, options<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb10-81"><a href="#cb10-81" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Convers√£o usando WeasyPrint (Recomendado)&quot;&quot;&quot;</span></span>
<span id="cb10-82"><a href="#cb10-82" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>._log(<span class="st">&quot;Usando WeasyPrint para convers√£o...&quot;</span>)</span>
<span id="cb10-83"><a href="#cb10-83" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-84"><a href="#cb10-84" aria-hidden="true" tabindex="-1"></a>        <span class="co"># CSS para melhor formata√ß√£o</span></span>
<span id="cb10-85"><a href="#cb10-85" aria-hidden="true" tabindex="-1"></a>        css_string <span class="op">=</span> <span class="st">&#39;&#39;&#39;</span></span>
<span id="cb10-86"><a href="#cb10-86" aria-hidden="true" tabindex="-1"></a><span class="st">        @page {</span></span>
<span id="cb10-87"><a href="#cb10-87" aria-hidden="true" tabindex="-1"></a><span class="st">            size: A4;</span></span>
<span id="cb10-88"><a href="#cb10-88" aria-hidden="true" tabindex="-1"></a><span class="st">            margin: 1.5cm;</span></span>
<span id="cb10-89"><a href="#cb10-89" aria-hidden="true" tabindex="-1"></a><span class="st">            @bottom-center {</span></span>
<span id="cb10-90"><a href="#cb10-90" aria-hidden="true" tabindex="-1"></a><span class="st">                content: &quot;P√°gina &quot; counter(page);</span></span>
<span id="cb10-91"><a href="#cb10-91" aria-hidden="true" tabindex="-1"></a><span class="st">                font-family: Arial, sans-serif;</span></span>
<span id="cb10-92"><a href="#cb10-92" aria-hidden="true" tabindex="-1"></a><span class="st">                font-size: 10pt;</span></span>
<span id="cb10-93"><a href="#cb10-93" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb10-94"><a href="#cb10-94" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb10-95"><a href="#cb10-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-96"><a href="#cb10-96" aria-hidden="true" tabindex="-1"></a><span class="st">---</span></span>
<span id="cb10-97"><a href="#cb10-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-98"><a href="#cb10-98" aria-hidden="true" tabindex="-1"></a><span class="st">### üë§ Utilizador *(2025-11-01 02:47:24)* *[deepseek-chat]*</span></span>
<span id="cb10-99"><a href="#cb10-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-100"><a href="#cb10-100" aria-hidden="true" tabindex="-1"></a><span class="st">pretendo um script completo com o nome html_to_pdf2.py; n√£o pretendo a op√ß√£o pandoc. Pretendo uma solu√ß√£o re reproduza fielmente as formulas matematicas e o codigo</span></span>
<span id="cb10-101"><a href="#cb10-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-102"><a href="#cb10-102" aria-hidden="true" tabindex="-1"></a><span class="st">---</span></span>
<span id="cb10-103"><a href="#cb10-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-104"><a href="#cb10-104" aria-hidden="true" tabindex="-1"></a><span class="st">### ü§ñ DeepSeek *(2025-11-01 02:47:24)* *[deepseek-chat]*</span></span>
<span id="cb10-105"><a href="#cb10-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-106"><a href="#cb10-106" aria-hidden="true" tabindex="-1"></a><span class="st">Aqui est√° um script completo `html_to_pdf2.py` usando **WeasyPrint** para reproduzir fielmente f√≥rmulas matem√°ticas e c√≥digo:</span></span>
<span id="cb10-107"><a href="#cb10-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-108"><a href="#cb10-108" aria-hidden="true" tabindex="-1"></a><span class="st">```python</span></span>
<span id="cb10-109"><a href="#cb10-109" aria-hidden="true" tabindex="-1"></a><span class="st">#!/usr/bin/env python3</span></span>
<span id="cb10-110"><a href="#cb10-110" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;&quot;&quot;</span></span>
<span id="cb10-111"><a href="#cb10-111" aria-hidden="true" tabindex="-1"></a><span class="st">html_to_pdf2.py - Conversor HTML para PDF com suporte a f√≥rmulas matem√°ticas e c√≥digo</span></span>
<span id="cb10-112"><a href="#cb10-112" aria-hidden="true" tabindex="-1"></a><span class="st">Autor: Assistente</span></span>
<span id="cb10-113"><a href="#cb10-113" aria-hidden="true" tabindex="-1"></a><span class="st">Data: 2024</span></span>
<span id="cb10-114"><a href="#cb10-114" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;&quot;&quot;</span></span>
<span id="cb10-115"><a href="#cb10-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-116"><a href="#cb10-116" aria-hidden="true" tabindex="-1"></a><span class="st">import os</span></span>
<span id="cb10-117"><a href="#cb10-117" aria-hidden="true" tabindex="-1"></a><span class="st">import sys</span></span>
<span id="cb10-118"><a href="#cb10-118" aria-hidden="true" tabindex="-1"></a><span class="st">import argparse</span></span>
<span id="cb10-119"><a href="#cb10-119" aria-hidden="true" tabindex="-1"></a><span class="st">from pathlib import Path</span></span>
<span id="cb10-120"><a href="#cb10-120" aria-hidden="true" tabindex="-1"></a><span class="st">from weasyprint import HTML, CSS</span></span>
<span id="cb10-121"><a href="#cb10-121" aria-hidden="true" tabindex="-1"></a><span class="st">import logging</span></span>
<span id="cb10-122"><a href="#cb10-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-123"><a href="#cb10-123" aria-hidden="true" tabindex="-1"></a><span class="st"># Configurar logging</span></span>
<span id="cb10-124"><a href="#cb10-124" aria-hidden="true" tabindex="-1"></a><span class="st">logging.basicConfig(level=logging.INFO, format=&#39;</span><span class="sc">%(levelname)s</span><span class="st">: </span><span class="sc">%(message)s</span><span class="st">&#39;)</span></span>
<span id="cb10-125"><a href="#cb10-125" aria-hidden="true" tabindex="-1"></a><span class="st">logger = logging.getLogger(__name__)</span></span>
<span id="cb10-126"><a href="#cb10-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-127"><a href="#cb10-127" aria-hidden="true" tabindex="-1"></a><span class="st">class HTMLToPDFConverter:</span></span>
<span id="cb10-128"><a href="#cb10-128" aria-hidden="true" tabindex="-1"></a><span class="st">    def __init__(self):</span></span>
<span id="cb10-129"><a href="#cb10-129" aria-hidden="true" tabindex="-1"></a><span class="st">        self.stylesheets = self._get_default_stylesheets()</span></span>
<span id="cb10-130"><a href="#cb10-130" aria-hidden="true" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb10-131"><a href="#cb10-131" aria-hidden="true" tabindex="-1"></a><span class="st">    def _get_default_stylesheets(self):</span></span>
<span id="cb10-132"><a href="#cb10-132" aria-hidden="true" tabindex="-1"></a><span class="st">        &quot;&quot;&quot;Retorna os estilos CSS padr√£o para melhor renderiza√ß√£o&quot;&quot;&quot;</span></span>
<span id="cb10-133"><a href="#cb10-133" aria-hidden="true" tabindex="-1"></a><span class="st">        return [</span></span>
<span id="cb10-134"><a href="#cb10-134" aria-hidden="true" tabindex="-1"></a><span class="st">            CSS(string=&#39;&#39;&#39;</span></span>
<span id="cb10-135"><a href="#cb10-135" aria-hidden="true" tabindex="-1"></a>                <span class="at">@page</span> {</span>
<span id="cb10-136"><a href="#cb10-136" aria-hidden="true" tabindex="-1"></a>                    size: A4<span class="op">;</span></span>
<span id="cb10-137"><a href="#cb10-137" aria-hidden="true" tabindex="-1"></a>                    margin: <span class="dv">2</span><span class="er">cm</span><span class="op">;</span></span>
<span id="cb10-138"><a href="#cb10-138" aria-hidden="true" tabindex="-1"></a>                    <span class="at">@top</span><span class="op">-</span>left {</span>
<span id="cb10-139"><a href="#cb10-139" aria-hidden="true" tabindex="-1"></a>                        content: <span class="st">&quot;Documento Gerado por html_to_pdf2.py&quot;</span><span class="op">;</span></span>
<span id="cb10-140"><a href="#cb10-140" aria-hidden="true" tabindex="-1"></a>                        font<span class="op">-</span>size: <span class="dv">10</span><span class="er">px</span><span class="op">;</span></span>
<span id="cb10-141"><a href="#cb10-141" aria-hidden="true" tabindex="-1"></a>                        color: <span class="co">#666;</span></span>
<span id="cb10-142"><a href="#cb10-142" aria-hidden="true" tabindex="-1"></a>                    }</span>
<span id="cb10-143"><a href="#cb10-143" aria-hidden="true" tabindex="-1"></a>                    <span class="at">@bottom</span><span class="op">-</span>right {</span>
<span id="cb10-144"><a href="#cb10-144" aria-hidden="true" tabindex="-1"></a>                        content: <span class="st">&quot;P√°gina &quot;</span> counter(page) <span class="st">&quot; de &quot;</span> counter(pages)<span class="op">;</span></span>
<span id="cb10-145"><a href="#cb10-145" aria-hidden="true" tabindex="-1"></a>                        font<span class="op">-</span>size: <span class="dv">10</span><span class="er">px</span><span class="op">;</span></span>
<span id="cb10-146"><a href="#cb10-146" aria-hidden="true" tabindex="-1"></a>                        color: <span class="co">#666;</span></span>
<span id="cb10-147"><a href="#cb10-147" aria-hidden="true" tabindex="-1"></a>                    }</span>
<span id="cb10-148"><a href="#cb10-148" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb10-149"><a href="#cb10-149" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb10-150"><a href="#cb10-150" aria-hidden="true" tabindex="-1"></a>                body {</span>
<span id="cb10-151"><a href="#cb10-151" aria-hidden="true" tabindex="-1"></a>                    font<span class="op">-</span>family: <span class="st">&quot;Arial&quot;</span>, <span class="st">&quot;DejaVu Sans&quot;</span>, <span class="st">&quot;Liberation Sans&quot;</span>, sans<span class="op">-</span>serif<span class="op">;</span></span>
<span id="cb10-152"><a href="#cb10-152" aria-hidden="true" tabindex="-1"></a>                    line<span class="op">-</span>height: <span class="fl">1.6</span><span class="op">;</span></span>
<span id="cb10-153"><a href="#cb10-153" aria-hidden="true" tabindex="-1"></a>                    color: <span class="co">#333;</span></span>
<span id="cb10-154"><a href="#cb10-154" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">max</span><span class="op">-</span>width: <span class="dv">100</span><span class="op">%;</span></span>
<span id="cb10-155"><a href="#cb10-155" aria-hidden="true" tabindex="-1"></a>                    margin: <span class="dv">0</span> auto<span class="op">;</span></span>
<span id="cb10-156"><a href="#cb10-156" aria-hidden="true" tabindex="-1"></a>                    padding: <span class="dv">20</span><span class="er">px</span><span class="op">;</span></span>
<span id="cb10-157"><a href="#cb10-157" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb10-158"><a href="#cb10-158" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb10-159"><a href="#cb10-159" aria-hidden="true" tabindex="-1"></a>                h1, h2, h3, h4, h5, h6 {</span>
<span id="cb10-160"><a href="#cb10-160" aria-hidden="true" tabindex="-1"></a>                    color: <span class="co">#1565C0;</span></span>
<span id="cb10-161"><a href="#cb10-161" aria-hidden="true" tabindex="-1"></a>                    margin<span class="op">-</span>top: <span class="fl">1.5</span><span class="er">em</span><span class="op">;</span></span>
<span id="cb10-162"><a href="#cb10-162" aria-hidden="true" tabindex="-1"></a>                    margin<span class="op">-</span>bottom: <span class="fl">0.5</span><span class="er">em</span><span class="op">;</span></span>
<span id="cb10-163"><a href="#cb10-163" aria-hidden="true" tabindex="-1"></a>                    page<span class="op">-</span><span class="cf">break</span><span class="op">-</span>after: avoid<span class="op">;</span></span>
<span id="cb10-164"><a href="#cb10-164" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb10-165"><a href="#cb10-165" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb10-166"><a href="#cb10-166" aria-hidden="true" tabindex="-1"></a>                h1 {</span>
<span id="cb10-167"><a href="#cb10-167" aria-hidden="true" tabindex="-1"></a>                    font<span class="op">-</span>size: <span class="dv">24</span><span class="er">px</span><span class="op">;</span></span>
<span id="cb10-168"><a href="#cb10-168" aria-hidden="true" tabindex="-1"></a>                    border<span class="op">-</span>bottom: <span class="dv">2</span><span class="er">px</span> solid <span class="co">#1565C0;</span></span>
<span id="cb10-169"><a href="#cb10-169" aria-hidden="true" tabindex="-1"></a>                    padding<span class="op">-</span>bottom: <span class="fl">0.3</span><span class="er">em</span><span class="op">;</span></span>
<span id="cb10-170"><a href="#cb10-170" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb10-171"><a href="#cb10-171" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb10-172"><a href="#cb10-172" aria-hidden="true" tabindex="-1"></a>                h2 {</span>
<span id="cb10-173"><a href="#cb10-173" aria-hidden="true" tabindex="-1"></a>                    font<span class="op">-</span>size: <span class="dv">20</span><span class="er">px</span><span class="op">;</span></span>
<span id="cb10-174"><a href="#cb10-174" aria-hidden="true" tabindex="-1"></a>                    border<span class="op">-</span>bottom: <span class="dv">1</span><span class="er">px</span> solid <span class="co">#eaecef;</span></span>
<span id="cb10-175"><a href="#cb10-175" aria-hidden="true" tabindex="-1"></a>                    padding<span class="op">-</span>bottom: <span class="fl">0.3</span><span class="er">em</span><span class="op">;</span></span>
<span id="cb10-176"><a href="#cb10-176" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb10-177"><a href="#cb10-177" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb10-178"><a href="#cb10-178" aria-hidden="true" tabindex="-1"></a>                <span class="op">/*</span> Estilos para c√≥digo <span class="op">*/</span></span>
<span id="cb10-179"><a href="#cb10-179" aria-hidden="true" tabindex="-1"></a>                pre, code {</span>
<span id="cb10-180"><a href="#cb10-180" aria-hidden="true" tabindex="-1"></a>                    font<span class="op">-</span>family: <span class="st">&quot;Consolas&quot;</span>, <span class="st">&quot;Monaco&quot;</span>, <span class="st">&quot;Courier New&quot;</span>, monospace<span class="op">;</span></span>
<span id="cb10-181"><a href="#cb10-181" aria-hidden="true" tabindex="-1"></a>                    background<span class="op">-</span>color: <span class="co">#f6f8fa;</span></span>
<span id="cb10-182"><a href="#cb10-182" aria-hidden="true" tabindex="-1"></a>                    border: <span class="dv">1</span><span class="er">px</span> solid <span class="co">#e1e4e8;</span></span>
<span id="cb10-183"><a href="#cb10-183" aria-hidden="true" tabindex="-1"></a>                    border<span class="op">-</span>radius: <span class="dv">6</span><span class="er">px</span><span class="op">;</span></span>
<span id="cb10-184"><a href="#cb10-184" aria-hidden="true" tabindex="-1"></a>                    font<span class="op">-</span>size: <span class="dv">13</span><span class="er">px</span><span class="op">;</span></span>
<span id="cb10-185"><a href="#cb10-185" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb10-186"><a href="#cb10-186" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb10-187"><a href="#cb10-187" aria-hidden="true" tabindex="-1"></a>                pre {</span>
<span id="cb10-188"><a href="#cb10-188" aria-hidden="true" tabindex="-1"></a>                    padding: <span class="dv">16</span><span class="er">px</span><span class="op">;</span></span>
<span id="cb10-189"><a href="#cb10-189" aria-hidden="true" tabindex="-1"></a>                    overflow: auto<span class="op">;</span></span>
<span id="cb10-190"><a href="#cb10-190" aria-hidden="true" tabindex="-1"></a>                    line<span class="op">-</span>height: <span class="fl">1.45</span><span class="op">;</span></span>
<span id="cb10-191"><a href="#cb10-191" aria-hidden="true" tabindex="-1"></a>                    page<span class="op">-</span><span class="cf">break</span><span class="op">-</span>inside: avoid<span class="op">;</span></span>
<span id="cb10-192"><a href="#cb10-192" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb10-193"><a href="#cb10-193" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb10-194"><a href="#cb10-194" aria-hidden="true" tabindex="-1"></a>                code {</span>
<span id="cb10-195"><a href="#cb10-195" aria-hidden="true" tabindex="-1"></a>                    padding: <span class="dv">2</span><span class="er">px</span> <span class="dv">4</span><span class="er">px</span><span class="op">;</span></span>
<span id="cb10-196"><a href="#cb10-196" aria-hidden="true" tabindex="-1"></a>                    font<span class="op">-</span>size: <span class="dv">12</span><span class="er">px</span><span class="op">;</span></span>
<span id="cb10-197"><a href="#cb10-197" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb10-198"><a href="#cb10-198" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb10-199"><a href="#cb10-199" aria-hidden="true" tabindex="-1"></a>                pre code {</span>
<span id="cb10-200"><a href="#cb10-200" aria-hidden="true" tabindex="-1"></a>                    background: none<span class="op">;</span></span>
<span id="cb10-201"><a href="#cb10-201" aria-hidden="true" tabindex="-1"></a>                    border: none<span class="op">;</span></span>
<span id="cb10-202"><a href="#cb10-202" aria-hidden="true" tabindex="-1"></a>                    padding: <span class="dv">0</span><span class="op">;</span></span>
<span id="cb10-203"><a href="#cb10-203" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb10-204"><a href="#cb10-204" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb10-205"><a href="#cb10-205" aria-hidden="true" tabindex="-1"></a>                <span class="op">/*</span> Estilos para blocos de c√≥digo com numera√ß√£o <span class="op">*/</span></span>
<span id="cb10-206"><a href="#cb10-206" aria-hidden="true" tabindex="-1"></a>                .sourceCode {</span>
<span id="cb10-207"><a href="#cb10-207" aria-hidden="true" tabindex="-1"></a>                    background<span class="op">-</span>color: <span class="co">#f6f8fa;</span></span>
<span id="cb10-208"><a href="#cb10-208" aria-hidden="true" tabindex="-1"></a>                    border: <span class="dv">1</span><span class="er">px</span> solid <span class="co">#e1e4e8;</span></span>
<span id="cb10-209"><a href="#cb10-209" aria-hidden="true" tabindex="-1"></a>                    border<span class="op">-</span>radius: <span class="dv">6</span><span class="er">px</span><span class="op">;</span></span>
<span id="cb10-210"><a href="#cb10-210" aria-hidden="true" tabindex="-1"></a>                    margin: <span class="dv">1</span><span class="er">em</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb10-211"><a href="#cb10-211" aria-hidden="true" tabindex="-1"></a>                    page<span class="op">-</span><span class="cf">break</span><span class="op">-</span>inside: avoid<span class="op">;</span></span>
<span id="cb10-212"><a href="#cb10-212" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb10-213"><a href="#cb10-213" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb10-214"><a href="#cb10-214" aria-hidden="true" tabindex="-1"></a>                .sourceCode pre {</span>
<span id="cb10-215"><a href="#cb10-215" aria-hidden="true" tabindex="-1"></a>                    margin: <span class="dv">0</span><span class="op">;</span></span>
<span id="cb10-216"><a href="#cb10-216" aria-hidden="true" tabindex="-1"></a>                    padding: <span class="dv">1</span><span class="er">em</span><span class="op">;</span></span>
<span id="cb10-217"><a href="#cb10-217" aria-hidden="true" tabindex="-1"></a>                    overflow: auto<span class="op">;</span></span>
<span id="cb10-218"><a href="#cb10-218" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb10-219"><a href="#cb10-219" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb10-220"><a href="#cb10-220" aria-hidden="true" tabindex="-1"></a>                <span class="op">/*</span> Sintaxe highlighting <span class="op">-</span> cores similares ao GitHub <span class="op">*/</span></span>
<span id="cb10-221"><a href="#cb10-221" aria-hidden="true" tabindex="-1"></a>                .sourceCode .kw { color: <span class="co">#d73a49; font-weight: bold; } /* Keyword */</span></span>
<span id="cb10-222"><a href="#cb10-222" aria-hidden="true" tabindex="-1"></a>                .sourceCode .cf { color: <span class="co">#d73a49; font-weight: bold; } /* ControlFlow */</span></span>
<span id="cb10-223"><a href="#cb10-223" aria-hidden="true" tabindex="-1"></a>                .sourceCode .fu { color: <span class="co">#6f42c1; } /* Function */</span></span>
<span id="cb10-224"><a href="#cb10-224" aria-hidden="true" tabindex="-1"></a>                .sourceCode .st { color: <span class="co">#032f62; } /* String */</span></span>
<span id="cb10-225"><a href="#cb10-225" aria-hidden="true" tabindex="-1"></a>                .sourceCode .co { color: <span class="co">#6a737d; font-style: italic; } /* Comment */</span></span>
<span id="cb10-226"><a href="#cb10-226" aria-hidden="true" tabindex="-1"></a>                .sourceCode .va { color: <span class="co">#005cc5; } /* Variable */</span></span>
<span id="cb10-227"><a href="#cb10-227" aria-hidden="true" tabindex="-1"></a>                .sourceCode .op { color: <span class="co">#d73a49; } /* Operator */</span></span>
<span id="cb10-228"><a href="#cb10-228" aria-hidden="true" tabindex="-1"></a>                .sourceCode .pp { color: <span class="co">#d73a49; } /* Preprocessor */</span></span>
<span id="cb10-229"><a href="#cb10-229" aria-hidden="true" tabindex="-1"></a>                .sourceCode .at { color: <span class="co">#22863a; } /* Attribute */</span></span>
<span id="cb10-230"><a href="#cb10-230" aria-hidden="true" tabindex="-1"></a>                .sourceCode .ch { color: <span class="co">#032f62; } /* Char */</span></span>
<span id="cb10-231"><a href="#cb10-231" aria-hidden="true" tabindex="-1"></a>                .sourceCode .cn { color: <span class="co">#005cc5; } /* Constant */</span></span>
<span id="cb10-232"><a href="#cb10-232" aria-hidden="true" tabindex="-1"></a>                .sourceCode .dv { color: <span class="co">#005cc5; } /* DecVal */</span></span>
<span id="cb10-233"><a href="#cb10-233" aria-hidden="true" tabindex="-1"></a>                .sourceCode .bn { color: <span class="co">#005cc5; } /* BaseN */</span></span>
<span id="cb10-234"><a href="#cb10-234" aria-hidden="true" tabindex="-1"></a>                .sourceCode .fl { color: <span class="co">#005cc5; } /* Float */</span></span>
<span id="cb10-235"><a href="#cb10-235" aria-hidden="true" tabindex="-1"></a>                .sourceCode .im { color: <span class="co">#008000; } /* Import */</span></span>
<span id="cb10-236"><a href="#cb10-236" aria-hidden="true" tabindex="-1"></a>                .sourceCode .do { color: <span class="co">#6a737d; font-style: italic; } /* Documentation */</span></span>
<span id="cb10-237"><a href="#cb10-237" aria-hidden="true" tabindex="-1"></a>                .sourceCode .an { color: <span class="co">#6a737d; font-weight: bold; font-style: italic; } /* Annotation */</span></span>
<span id="cb10-238"><a href="#cb10-238" aria-hidden="true" tabindex="-1"></a>                .sourceCode .cv { color: <span class="co">#6a737d; font-weight: bold; font-style: italic; } /* CommentVar */</span></span>
<span id="cb10-239"><a href="#cb10-239" aria-hidden="true" tabindex="-1"></a>                .sourceCode .<span class="kw">in</span> { color: <span class="co">#6a737d; font-weight: bold; font-style: italic; } /* Information */</span></span>
<span id="cb10-240"><a href="#cb10-240" aria-hidden="true" tabindex="-1"></a>                .sourceCode .wa { color: <span class="co">#6a737d; font-weight: bold; font-style: italic; } /* Warning */</span></span>
<span id="cb10-241"><a href="#cb10-241" aria-hidden="true" tabindex="-1"></a>                .sourceCode .al { color: <span class="co">#ff0000; font-weight: bold; } /* Alert */</span></span>
<span id="cb10-242"><a href="#cb10-242" aria-hidden="true" tabindex="-1"></a>                .sourceCode .er { color: <span class="co">#ff0000; font-weight: bold; } /* Error */</span></span>
<span id="cb10-243"><a href="#cb10-243" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb10-244"><a href="#cb10-244" aria-hidden="true" tabindex="-1"></a>                <span class="op">/*</span> F√≥rmulas matem√°ticas <span class="op">*/</span></span>
<span id="cb10-245"><a href="#cb10-245" aria-hidden="true" tabindex="-1"></a>                .math {</span>
<span id="cb10-246"><a href="#cb10-246" aria-hidden="true" tabindex="-1"></a>                    font<span class="op">-</span>family: <span class="st">&quot;Times New Roman&quot;</span>, serif<span class="op">;</span></span>
<span id="cb10-247"><a href="#cb10-247" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb10-248"><a href="#cb10-248" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb10-249"><a href="#cb10-249" aria-hidden="true" tabindex="-1"></a>                .math.display {</span>
<span id="cb10-250"><a href="#cb10-250" aria-hidden="true" tabindex="-1"></a>                    display: block<span class="op">;</span></span>
<span id="cb10-251"><a href="#cb10-251" aria-hidden="true" tabindex="-1"></a>                    text<span class="op">-</span>align: center<span class="op">;</span></span>
<span id="cb10-252"><a href="#cb10-252" aria-hidden="true" tabindex="-1"></a>                    margin: <span class="dv">1</span><span class="er">em</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb10-253"><a href="#cb10-253" aria-hidden="true" tabindex="-1"></a>                    page<span class="op">-</span><span class="cf">break</span><span class="op">-</span>inside: avoid<span class="op">;</span></span>
<span id="cb10-254"><a href="#cb10-254" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb10-255"><a href="#cb10-255" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb10-256"><a href="#cb10-256" aria-hidden="true" tabindex="-1"></a>                <span class="op">/*</span> Tabelas <span class="op">*/</span></span>
<span id="cb10-257"><a href="#cb10-257" aria-hidden="true" tabindex="-1"></a>                table {</span>
<span id="cb10-258"><a href="#cb10-258" aria-hidden="true" tabindex="-1"></a>                    border<span class="op">-</span>collapse: collapse<span class="op">;</span></span>
<span id="cb10-259"><a href="#cb10-259" aria-hidden="true" tabindex="-1"></a>                    width: <span class="dv">100</span><span class="op">%;</span></span>
<span id="cb10-260"><a href="#cb10-260" aria-hidden="true" tabindex="-1"></a>                    margin: <span class="dv">1</span><span class="er">em</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb10-261"><a href="#cb10-261" aria-hidden="true" tabindex="-1"></a>                    page<span class="op">-</span><span class="cf">break</span><span class="op">-</span>inside: avoid<span class="op">;</span></span>
<span id="cb10-262"><a href="#cb10-262" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb10-263"><a href="#cb10-263" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb10-264"><a href="#cb10-264" aria-hidden="true" tabindex="-1"></a>                th, td {</span>
<span id="cb10-265"><a href="#cb10-265" aria-hidden="true" tabindex="-1"></a>                    border: <span class="dv">1</span><span class="er">px</span> solid <span class="co">#ddd;</span></span>
<span id="cb10-266"><a href="#cb10-266" aria-hidden="true" tabindex="-1"></a>                    padding: <span class="dv">8</span><span class="er">px</span> <span class="dv">12</span><span class="er">px</span><span class="op">;</span></span>
<span id="cb10-267"><a href="#cb10-267" aria-hidden="true" tabindex="-1"></a>                    text<span class="op">-</span>align: left<span class="op">;</span></span>
<span id="cb10-268"><a href="#cb10-268" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb10-269"><a href="#cb10-269" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb10-270"><a href="#cb10-270" aria-hidden="true" tabindex="-1"></a>                th {</span>
<span id="cb10-271"><a href="#cb10-271" aria-hidden="true" tabindex="-1"></a>                    background<span class="op">-</span>color: <span class="co">#f2f2f2;</span></span>
<span id="cb10-272"><a href="#cb10-272" aria-hidden="true" tabindex="-1"></a>                    font<span class="op">-</span>weight: bold<span class="op">;</span></span>
<span id="cb10-273"><a href="#cb10-273" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb10-274"><a href="#cb10-274" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb10-275"><a href="#cb10-275" aria-hidden="true" tabindex="-1"></a>                tr:nth<span class="op">-</span>child(even) {</span>
<span id="cb10-276"><a href="#cb10-276" aria-hidden="true" tabindex="-1"></a>                    background<span class="op">-</span>color: <span class="co">#f9f9f9;</span></span>
<span id="cb10-277"><a href="#cb10-277" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb10-278"><a href="#cb10-278" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb10-279"><a href="#cb10-279" aria-hidden="true" tabindex="-1"></a>                <span class="op">/*</span> Listas <span class="op">*/</span></span>
<span id="cb10-280"><a href="#cb10-280" aria-hidden="true" tabindex="-1"></a>                ul, ol {</span>
<span id="cb10-281"><a href="#cb10-281" aria-hidden="true" tabindex="-1"></a>                    margin: <span class="dv">1</span><span class="er">em</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb10-282"><a href="#cb10-282" aria-hidden="true" tabindex="-1"></a>                    padding<span class="op">-</span>left: <span class="dv">2</span><span class="er">em</span><span class="op">;</span></span>
<span id="cb10-283"><a href="#cb10-283" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb10-284"><a href="#cb10-284" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb10-285"><a href="#cb10-285" aria-hidden="true" tabindex="-1"></a>                li {</span>
<span id="cb10-286"><a href="#cb10-286" aria-hidden="true" tabindex="-1"></a>                    margin: <span class="fl">0.5</span><span class="er">em</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb10-287"><a href="#cb10-287" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb10-288"><a href="#cb10-288" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb10-289"><a href="#cb10-289" aria-hidden="true" tabindex="-1"></a>                <span class="op">/*</span> Blockquotes <span class="op">*/</span></span>
<span id="cb10-290"><a href="#cb10-290" aria-hidden="true" tabindex="-1"></a>                blockquote {</span>
<span id="cb10-291"><a href="#cb10-291" aria-hidden="true" tabindex="-1"></a>                    background<span class="op">-</span>color: <span class="co">#f8f9fa;</span></span>
<span id="cb10-292"><a href="#cb10-292" aria-hidden="true" tabindex="-1"></a>                    border<span class="op">-</span>left: <span class="dv">4</span><span class="er">px</span> solid <span class="co">#dfe2e5;</span></span>
<span id="cb10-293"><a href="#cb10-293" aria-hidden="true" tabindex="-1"></a>                    margin: <span class="dv">1</span><span class="er">em</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb10-294"><a href="#cb10-294" aria-hidden="true" tabindex="-1"></a>                    padding: <span class="fl">0.5</span><span class="er">em</span> <span class="dv">1</span><span class="er">em</span><span class="op">;</span></span>
<span id="cb10-295"><a href="#cb10-295" aria-hidden="true" tabindex="-1"></a>                    font<span class="op">-</span>style: italic<span class="op">;</span></span>
<span id="cb10-296"><a href="#cb10-296" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb10-297"><a href="#cb10-297" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb10-298"><a href="#cb10-298" aria-hidden="true" tabindex="-1"></a>                <span class="op">/*</span> Imagens <span class="op">*/</span></span>
<span id="cb10-299"><a href="#cb10-299" aria-hidden="true" tabindex="-1"></a>                img {</span>
<span id="cb10-300"><a href="#cb10-300" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">max</span><span class="op">-</span>width: <span class="dv">100</span><span class="op">%;</span></span>
<span id="cb10-301"><a href="#cb10-301" aria-hidden="true" tabindex="-1"></a>                    height: auto<span class="op">;</span></span>
<span id="cb10-302"><a href="#cb10-302" aria-hidden="true" tabindex="-1"></a>                    display: block<span class="op">;</span></span>
<span id="cb10-303"><a href="#cb10-303" aria-hidden="true" tabindex="-1"></a>                    margin: <span class="dv">1</span><span class="er">em</span> auto<span class="op">;</span></span>
<span id="cb10-304"><a href="#cb10-304" aria-hidden="true" tabindex="-1"></a>                    page<span class="op">-</span><span class="cf">break</span><span class="op">-</span>inside: avoid<span class="op">;</span></span>
<span id="cb10-305"><a href="#cb10-305" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb10-306"><a href="#cb10-306" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb10-307"><a href="#cb10-307" aria-hidden="true" tabindex="-1"></a>                figure {</span>
<span id="cb10-308"><a href="#cb10-308" aria-hidden="true" tabindex="-1"></a>                    margin: <span class="dv">1</span><span class="er">em</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb10-309"><a href="#cb10-309" aria-hidden="true" tabindex="-1"></a>                    text<span class="op">-</span>align: center<span class="op">;</span></span>
<span id="cb10-310"><a href="#cb10-310" aria-hidden="true" tabindex="-1"></a>                    page<span class="op">-</span><span class="cf">break</span><span class="op">-</span>inside: avoid<span class="op">;</span></span>
<span id="cb10-311"><a href="#cb10-311" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb10-312"><a href="#cb10-312" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb10-313"><a href="#cb10-313" aria-hidden="true" tabindex="-1"></a>                figcaption {</span>
<span id="cb10-314"><a href="#cb10-314" aria-hidden="true" tabindex="-1"></a>                    font<span class="op">-</span>size: <span class="fl">0.9</span><span class="er">em</span><span class="op">;</span></span>
<span id="cb10-315"><a href="#cb10-315" aria-hidden="true" tabindex="-1"></a>                    color: <span class="co">#666;</span></span>
<span id="cb10-316"><a href="#cb10-316" aria-hidden="true" tabindex="-1"></a>                    margin<span class="op">-</span>top: <span class="fl">0.5</span><span class="er">em</span><span class="op">;</span></span>
<span id="cb10-317"><a href="#cb10-317" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb10-318"><a href="#cb10-318" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb10-319"><a href="#cb10-319" aria-hidden="true" tabindex="-1"></a>                <span class="op">/*</span> Links <span class="op">*/</span></span>
<span id="cb10-320"><a href="#cb10-320" aria-hidden="true" tabindex="-1"></a>                a {</span>
<span id="cb10-321"><a href="#cb10-321" aria-hidden="true" tabindex="-1"></a>                    color: <span class="co">#0366d6;</span></span>
<span id="cb10-322"><a href="#cb10-322" aria-hidden="true" tabindex="-1"></a>                    text<span class="op">-</span>decoration: none<span class="op">;</span></span>
<span id="cb10-323"><a href="#cb10-323" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb10-324"><a href="#cb10-324" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb10-325"><a href="#cb10-325" aria-hidden="true" tabindex="-1"></a>                a:hover {</span>
<span id="cb10-326"><a href="#cb10-326" aria-hidden="true" tabindex="-1"></a>                    text<span class="op">-</span>decoration: underline<span class="op">;</span></span>
<span id="cb10-327"><a href="#cb10-327" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb10-328"><a href="#cb10-328" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb10-329"><a href="#cb10-329" aria-hidden="true" tabindex="-1"></a>                <span class="op">/*</span> HR <span class="op">*/</span></span>
<span id="cb10-330"><a href="#cb10-330" aria-hidden="true" tabindex="-1"></a>                hr {</span>
<span id="cb10-331"><a href="#cb10-331" aria-hidden="true" tabindex="-1"></a>                    border: none<span class="op">;</span></span>
<span id="cb10-332"><a href="#cb10-332" aria-hidden="true" tabindex="-1"></a>                    border<span class="op">-</span>top: <span class="dv">1</span><span class="er">px</span> solid <span class="co">#eaecef;</span></span>
<span id="cb10-333"><a href="#cb10-333" aria-hidden="true" tabindex="-1"></a>                    margin: <span class="dv">2</span><span class="er">em</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb10-334"><a href="#cb10-334" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb10-335"><a href="#cb10-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-336"><a href="#cb10-336" aria-hidden="true" tabindex="-1"></a><span class="op">---</span></span>
<span id="cb10-337"><a href="#cb10-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-338"><a href="#cb10-338" aria-hidden="true" tabindex="-1"></a><span class="co">### üë§ Utilizador *(2025-11-01 02:49:17)* *[deepseek-chat]*</span></span>
<span id="cb10-339"><a href="#cb10-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-340"><a href="#cb10-340" aria-hidden="true" tabindex="-1"></a>pretendo um script completo com o nome html_to_pdf2.py<span class="op">;</span> n√£o pretendo a op√ß√£o pandoc. Pretendo uma solu√ß√£o re reproduza fielmente <span class="im">as</span> formulas matematicas e o codigo. Pretendo uma solu√ß√£o que possa ser replicada para ostros documentos html</span>
<span id="cb10-341"><a href="#cb10-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-342"><a href="#cb10-342" aria-hidden="true" tabindex="-1"></a><span class="op">---</span></span>
<span id="cb10-343"><a href="#cb10-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-344"><a href="#cb10-344" aria-hidden="true" tabindex="-1"></a><span class="co">### ü§ñ DeepSeek *(2025-11-01 02:49:17)* *[deepseek-chat]*</span></span>
<span id="cb10-345"><a href="#cb10-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-346"><a href="#cb10-346" aria-hidden="true" tabindex="-1"></a>Aqui est√° um script completo `html_to_pdf2.py` usando WeasyPrint para convers√£o fiel de HTML para PDF:</span>
<span id="cb10-347"><a href="#cb10-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-348"><a href="#cb10-348" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb10-349"><a href="#cb10-349" aria-hidden="true" tabindex="-1"></a><span class="co">#!/usr/bin/env python3</span></span>
<span id="cb10-350"><a href="#cb10-350" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;&quot;&quot;</span></span>
<span id="cb10-351"><a href="#cb10-351" aria-hidden="true" tabindex="-1"></a><span class="st">html_to_pdf2.py - Conversor completo de HTML para PDF</span></span>
<span id="cb10-352"><a href="#cb10-352" aria-hidden="true" tabindex="-1"></a><span class="st">Suporte para f√≥rmulas matem√°ticas, c√≥digo com syntax highlighting e emojis</span></span>
<span id="cb10-353"><a href="#cb10-353" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;&quot;&quot;</span></span>
<span id="cb10-354"><a href="#cb10-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-355"><a href="#cb10-355" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb10-356"><a href="#cb10-356" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sys</span>
<span id="cb10-357"><a href="#cb10-357" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> argparse</span>
<span id="cb10-358"><a href="#cb10-358" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb10-359"><a href="#cb10-359" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> weasyprint <span class="im">import</span> HTML, CSS</span>
<span id="cb10-360"><a href="#cb10-360" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> logging</span>
<span id="cb10-361"><a href="#cb10-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-362"><a href="#cb10-362" aria-hidden="true" tabindex="-1"></a><span class="co"># Configurar logging</span></span>
<span id="cb10-363"><a href="#cb10-363" aria-hidden="true" tabindex="-1"></a>logging.basicConfig(level<span class="op">=</span>logging.INFO, <span class="bu">format</span><span class="op">=</span><span class="st">&#39;</span><span class="sc">%(asctime)s</span><span class="st"> - </span><span class="sc">%(levelname)s</span><span class="st"> - </span><span class="sc">%(message)s</span><span class="st">&#39;</span>)</span>
<span id="cb10-364"><a href="#cb10-364" aria-hidden="true" tabindex="-1"></a>logger <span class="op">=</span> logging.getLogger(<span class="va">__name__</span>)</span>
<span id="cb10-365"><a href="#cb10-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-366"><a href="#cb10-366" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> HTMLToPDFConverter:</span>
<span id="cb10-367"><a href="#cb10-367" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, output_dir<span class="op">=</span><span class="st">&quot;output_pdfs&quot;</span>):</span>
<span id="cb10-368"><a href="#cb10-368" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.output_dir <span class="op">=</span> output_dir</span>
<span id="cb10-369"><a href="#cb10-369" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>._ensure_output_dir()</span>
<span id="cb10-370"><a href="#cb10-370" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-371"><a href="#cb10-371" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _ensure_output_dir(<span class="va">self</span>):</span>
<span id="cb10-372"><a href="#cb10-372" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;&quot;&quot;Cria o diret√≥rio de output se n√£o existir&quot;&quot;&quot;</span></span>
<span id="cb10-373"><a href="#cb10-373" aria-hidden="true" tabindex="-1"></a>        Path(<span class="va">self</span>.output_dir).mkdir(exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb10-374"><a href="#cb10-374" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-375"><a href="#cb10-375" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> get_custom_styles(<span class="va">self</span>):</span>
<span id="cb10-376"><a href="#cb10-376" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;&quot;&quot;Retorna CSS customizado para melhor renderiza√ß√£o&quot;&quot;&quot;</span></span>
<span id="cb10-377"><a href="#cb10-377" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> CSS(string<span class="op">=</span><span class="st">&#39;&#39;&#39;</span></span>
<span id="cb10-378"><a href="#cb10-378" aria-hidden="true" tabindex="-1"></a><span class="st">            @page {</span></span>
<span id="cb10-379"><a href="#cb10-379" aria-hidden="true" tabindex="-1"></a><span class="st">                size: A4;</span></span>
<span id="cb10-380"><a href="#cb10-380" aria-hidden="true" tabindex="-1"></a><span class="st">                margin: 2cm;</span></span>
<span id="cb10-381"><a href="#cb10-381" aria-hidden="true" tabindex="-1"></a><span class="st">                @top-left {</span></span>
<span id="cb10-382"><a href="#cb10-382" aria-hidden="true" tabindex="-1"></a><span class="st">                    content: &quot;Documento HTML&quot;;</span></span>
<span id="cb10-383"><a href="#cb10-383" aria-hidden="true" tabindex="-1"></a><span class="st">                    font-size: 10px;</span></span>
<span id="cb10-384"><a href="#cb10-384" aria-hidden="true" tabindex="-1"></a><span class="st">                    color: #666;</span></span>
<span id="cb10-385"><a href="#cb10-385" aria-hidden="true" tabindex="-1"></a><span class="st">                }</span></span>
<span id="cb10-386"><a href="#cb10-386" aria-hidden="true" tabindex="-1"></a><span class="st">                @bottom-right {</span></span>
<span id="cb10-387"><a href="#cb10-387" aria-hidden="true" tabindex="-1"></a><span class="st">                    content: &quot;P√°gina &quot; counter(page);</span></span>
<span id="cb10-388"><a href="#cb10-388" aria-hidden="true" tabindex="-1"></a><span class="st">                    font-size: 10px;</span></span>
<span id="cb10-389"><a href="#cb10-389" aria-hidden="true" tabindex="-1"></a><span class="st">                    color: #666;</span></span>
<span id="cb10-390"><a href="#cb10-390" aria-hidden="true" tabindex="-1"></a><span class="st">                }</span></span>
<span id="cb10-391"><a href="#cb10-391" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb10-392"><a href="#cb10-392" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb10-393"><a href="#cb10-393" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Estilos gerais do corpo */</span></span>
<span id="cb10-394"><a href="#cb10-394" aria-hidden="true" tabindex="-1"></a><span class="st">            body {</span></span>
<span id="cb10-395"><a href="#cb10-395" aria-hidden="true" tabindex="-1"></a><span class="st">                font-family: &quot;Arial&quot;, &quot;DejaVu Sans&quot;, &quot;Liberation Sans&quot;, sans-serif;</span></span>
<span id="cb10-396"><a href="#cb10-396" aria-hidden="true" tabindex="-1"></a><span class="st">                line-height: 1.6;</span></span>
<span id="cb10-397"><a href="#cb10-397" aria-hidden="true" tabindex="-1"></a><span class="st">                color: #333;</span></span>
<span id="cb10-398"><a href="#cb10-398" aria-hidden="true" tabindex="-1"></a><span class="st">                max-width: 100%;</span></span>
<span id="cb10-399"><a href="#cb10-399" aria-hidden="true" tabindex="-1"></a><span class="st">                margin: 0 auto;</span></span>
<span id="cb10-400"><a href="#cb10-400" aria-hidden="true" tabindex="-1"></a><span class="st">                padding: 20px;</span></span>
<span id="cb10-401"><a href="#cb10-401" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb10-402"><a href="#cb10-402" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb10-403"><a href="#cb10-403" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Cabe√ßalhos */</span></span>
<span id="cb10-404"><a href="#cb10-404" aria-hidden="true" tabindex="-1"></a><span class="st">            h1, h2, h3, h4, h5, h6 {</span></span>
<span id="cb10-405"><a href="#cb10-405" aria-hidden="true" tabindex="-1"></a><span class="st">                color: #1565C0;</span></span>
<span id="cb10-406"><a href="#cb10-406" aria-hidden="true" tabindex="-1"></a><span class="st">                margin-top: 1.5em;</span></span>
<span id="cb10-407"><a href="#cb10-407" aria-hidden="true" tabindex="-1"></a><span class="st">                margin-bottom: 0.5em;</span></span>
<span id="cb10-408"><a href="#cb10-408" aria-hidden="true" tabindex="-1"></a><span class="st">                page-break-after: avoid;</span></span>
<span id="cb10-409"><a href="#cb10-409" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb10-410"><a href="#cb10-410" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb10-411"><a href="#cb10-411" aria-hidden="true" tabindex="-1"></a><span class="st">            h1 {</span></span>
<span id="cb10-412"><a href="#cb10-412" aria-hidden="true" tabindex="-1"></a><span class="st">                border-bottom: 2px solid #1565C0;</span></span>
<span id="cb10-413"><a href="#cb10-413" aria-hidden="true" tabindex="-1"></a><span class="st">                padding-bottom: 0.3em;</span></span>
<span id="cb10-414"><a href="#cb10-414" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb10-415"><a href="#cb10-415" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb10-416"><a href="#cb10-416" aria-hidden="true" tabindex="-1"></a><span class="st">            /* C√≥digo e blocos de c√≥digo */</span></span>
<span id="cb10-417"><a href="#cb10-417" aria-hidden="true" tabindex="-1"></a><span class="st">            pre, code {</span></span>
<span id="cb10-418"><a href="#cb10-418" aria-hidden="true" tabindex="-1"></a><span class="st">                font-family: &quot;Consolas&quot;, &quot;Monaco&quot;, &quot;Courier New&quot;, monospace;</span></span>
<span id="cb10-419"><a href="#cb10-419" aria-hidden="true" tabindex="-1"></a><span class="st">                background-color: #f6f8fa;</span></span>
<span id="cb10-420"><a href="#cb10-420" aria-hidden="true" tabindex="-1"></a><span class="st">                border: 1px solid #e1e4e8;</span></span>
<span id="cb10-421"><a href="#cb10-421" aria-hidden="true" tabindex="-1"></a><span class="st">                border-radius: 5px;</span></span>
<span id="cb10-422"><a href="#cb10-422" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb10-423"><a href="#cb10-423" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb10-424"><a href="#cb10-424" aria-hidden="true" tabindex="-1"></a><span class="st">            pre {</span></span>
<span id="cb10-425"><a href="#cb10-425" aria-hidden="true" tabindex="-1"></a><span class="st">                padding: 16px;</span></span>
<span id="cb10-426"><a href="#cb10-426" aria-hidden="true" tabindex="-1"></a><span class="st">                overflow: auto;</span></span>
<span id="cb10-427"><a href="#cb10-427" aria-hidden="true" tabindex="-1"></a><span class="st">                page-break-inside: avoid;</span></span>
<span id="cb10-428"><a href="#cb10-428" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb10-429"><a href="#cb10-429" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb10-430"><a href="#cb10-430" aria-hidden="true" tabindex="-1"></a><span class="st">            code {</span></span>
<span id="cb10-431"><a href="#cb10-431" aria-hidden="true" tabindex="-1"></a><span class="st">                padding: 2px 6px;</span></span>
<span id="cb10-432"><a href="#cb10-432" aria-hidden="true" tabindex="-1"></a><span class="st">                font-size: 0.9em;</span></span>
<span id="cb10-433"><a href="#cb10-433" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb10-434"><a href="#cb10-434" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb10-435"><a href="#cb10-435" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Blocos de c√≥digo com syntax highlighting */</span></span>
<span id="cb10-436"><a href="#cb10-436" aria-hidden="true" tabindex="-1"></a><span class="st">            div.sourceCode {</span></span>
<span id="cb10-437"><a href="#cb10-437" aria-hidden="true" tabindex="-1"></a><span class="st">                margin: 1em 0;</span></span>
<span id="cb10-438"><a href="#cb10-438" aria-hidden="true" tabindex="-1"></a><span class="st">                page-break-inside: avoid;</span></span>
<span id="cb10-439"><a href="#cb10-439" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb10-440"><a href="#cb10-440" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb10-441"><a href="#cb10-441" aria-hidden="true" tabindex="-1"></a><span class="st">            pre.sourceCode {</span></span>
<span id="cb10-442"><a href="#cb10-442" aria-hidden="true" tabindex="-1"></a><span class="st">                margin: 0;</span></span>
<span id="cb10-443"><a href="#cb10-443" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb10-444"><a href="#cb10-444" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb10-445"><a href="#cb10-445" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Tabelas */</span></span>
<span id="cb10-446"><a href="#cb10-446" aria-hidden="true" tabindex="-1"></a><span class="st">            table {</span></span>
<span id="cb10-447"><a href="#cb10-447" aria-hidden="true" tabindex="-1"></a><span class="st">                border-collapse: collapse;</span></span>
<span id="cb10-448"><a href="#cb10-448" aria-hidden="true" tabindex="-1"></a><span class="st">                width: 100%;</span></span>
<span id="cb10-449"><a href="#cb10-449" aria-hidden="true" tabindex="-1"></a><span class="st">                margin: 1em 0;</span></span>
<span id="cb10-450"><a href="#cb10-450" aria-hidden="true" tabindex="-1"></a><span class="st">                page-break-inside: avoid;</span></span>
<span id="cb10-451"><a href="#cb10-451" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb10-452"><a href="#cb10-452" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb10-453"><a href="#cb10-453" aria-hidden="true" tabindex="-1"></a><span class="st">            th, td {</span></span>
<span id="cb10-454"><a href="#cb10-454" aria-hidden="true" tabindex="-1"></a><span class="st">                border: 1px solid #ddd;</span></span>
<span id="cb10-455"><a href="#cb10-455" aria-hidden="true" tabindex="-1"></a><span class="st">                padding: 8px 12px;</span></span>
<span id="cb10-456"><a href="#cb10-456" aria-hidden="true" tabindex="-1"></a><span class="st">                text-align: left;</span></span>
<span id="cb10-457"><a href="#cb10-457" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb10-458"><a href="#cb10-458" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb10-459"><a href="#cb10-459" aria-hidden="true" tabindex="-1"></a><span class="st">            th {</span></span>
<span id="cb10-460"><a href="#cb10-460" aria-hidden="true" tabindex="-1"></a><span class="st">                background-color: #f2f2f2;</span></span>
<span id="cb10-461"><a href="#cb10-461" aria-hidden="true" tabindex="-1"></a><span class="st">                font-weight: bold;</span></span>
<span id="cb10-462"><a href="#cb10-462" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb10-463"><a href="#cb10-463" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb10-464"><a href="#cb10-464" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Cita√ß√µes */</span></span>
<span id="cb10-465"><a href="#cb10-465" aria-hidden="true" tabindex="-1"></a><span class="st">            blockquote {</span></span>
<span id="cb10-466"><a href="#cb10-466" aria-hidden="true" tabindex="-1"></a><span class="st">                background-color: #f9f9f9;</span></span>
<span id="cb10-467"><a href="#cb10-467" aria-hidden="true" tabindex="-1"></a><span class="st">                border-left: 4px solid #ccc;</span></span>
<span id="cb10-468"><a href="#cb10-468" aria-hidden="true" tabindex="-1"></a><span class="st">                margin: 1em 0;</span></span>
<span id="cb10-469"><a href="#cb10-469" aria-hidden="true" tabindex="-1"></a><span class="st">                padding: 0.5em 1em;</span></span>
<span id="cb10-470"><a href="#cb10-470" aria-hidden="true" tabindex="-1"></a><span class="st">                font-style: italic;</span></span>
<span id="cb10-471"><a href="#cb10-471" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb10-472"><a href="#cb10-472" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb10-473"><a href="#cb10-473" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Listas */</span></span>
<span id="cb10-474"><a href="#cb10-474" aria-hidden="true" tabindex="-1"></a><span class="st">            ul, ol {</span></span>
<span id="cb10-475"><a href="#cb10-475" aria-hidden="true" tabindex="-1"></a><span class="st">                margin: 1em 0;</span></span>
<span id="cb10-476"><a href="#cb10-476" aria-hidden="true" tabindex="-1"></a><span class="st">                padding-left: 2em;</span></span>
<span id="cb10-477"><a href="#cb10-477" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb10-478"><a href="#cb10-478" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb10-479"><a href="#cb10-479" aria-hidden="true" tabindex="-1"></a><span class="st">            li {</span></span>
<span id="cb10-480"><a href="#cb10-480" aria-hidden="true" tabindex="-1"></a><span class="st">                margin: 0.5em 0;</span></span>
<span id="cb10-481"><a href="#cb10-481" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb10-482"><a href="#cb10-482" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb10-483"><a href="#cb10-483" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Links */</span></span>
<span id="cb10-484"><a href="#cb10-484" aria-hidden="true" tabindex="-1"></a><span class="st">            a {</span></span>
<span id="cb10-485"><a href="#cb10-485" aria-hidden="true" tabindex="-1"></a><span class="st">                color: #0366d6;</span></span>
<span id="cb10-486"><a href="#cb10-486" aria-hidden="true" tabindex="-1"></a><span class="st">                text-decoration: none;</span></span>
<span id="cb10-487"><a href="#cb10-487" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb10-488"><a href="#cb10-488" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb10-489"><a href="#cb10-489" aria-hidden="true" tabindex="-1"></a><span class="st">            a:hover {</span></span>
<span id="cb10-490"><a href="#cb10-490" aria-hidden="true" tabindex="-1"></a><span class="st">                text-decoration: underline;</span></span>
<span id="cb10-491"><a href="#cb10-491" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb10-492"><a href="#cb10-492" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb10-493"><a href="#cb10-493" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Imagens */</span></span>
<span id="cb10-494"><a href="#cb10-494" aria-hidden="true" tabindex="-1"></a><span class="st">            img {</span></span>
<span id="cb10-495"><a href="#cb10-495" aria-hidden="true" tabindex="-1"></a><span class="st">                max-width: 100%;</span></span>
<span id="cb10-496"><a href="#cb10-496" aria-hidden="true" tabindex="-1"></a><span class="st">                height: auto;</span></span>
<span id="cb10-497"><a href="#cb10-497" aria-hidden="true" tabindex="-1"></a><span class="st">                page-break-inside: avoid;</span></span>
<span id="cb10-498"><a href="#cb10-498" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb10-499"><a href="#cb10-499" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb10-500"><a href="#cb10-500" aria-hidden="true" tabindex="-1"></a><span class="st">            figure {</span></span>
<span id="cb10-501"><a href="#cb10-501" aria-hidden="true" tabindex="-1"></a><span class="st">                margin: 1em 0;</span></span>
<span id="cb10-502"><a href="#cb10-502" aria-hidden="true" tabindex="-1"></a><span class="st">                text-align: center;</span></span>
<span id="cb10-503"><a href="#cb10-503" aria-hidden="true" tabindex="-1"></a><span class="st">                page-break-inside: avoid;</span></span>
<span id="cb10-504"><a href="#cb10-504" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb10-505"><a href="#cb10-505" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb10-506"><a href="#cb10-506" aria-hidden="true" tabindex="-1"></a><span class="st">            figcaption {</span></span>
<span id="cb10-507"><a href="#cb10-507" aria-hidden="true" tabindex="-1"></a><span class="st">                font-size: 0.9em;</span></span>
<span id="cb10-508"><a href="#cb10-508" aria-hidden="true" tabindex="-1"></a><span class="st">                color: #666;</span></span>
<span id="cb10-509"><a href="#cb10-509" aria-hidden="true" tabindex="-1"></a><span class="st">                margin-top: 0.5em;</span></span>
<span id="cb10-510"><a href="#cb10-510" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb10-511"><a href="#cb10-511" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb10-512"><a href="#cb10-512" aria-hidden="true" tabindex="-1"></a><span class="st">            /* F√≥rmulas matem√°ticas */</span></span>
<span id="cb10-513"><a href="#cb10-513" aria-hidden="true" tabindex="-1"></a><span class="st">            .math {</span></span>
<span id="cb10-514"><a href="#cb10-514" aria-hidden="true" tabindex="-1"></a><span class="st">                text-align: center;</span></span>
<span id="cb10-515"><a href="#cb10-515" aria-hidden="true" tabindex="-1"></a><span class="st">                margin: 1em 0;</span></span>
<span id="cb10-516"><a href="#cb10-516" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb10-517"><a href="#cb10-517" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb10-518"><a href="#cb10-518" aria-hidden="true" tabindex="-1"></a><span class="st">            .math.display {</span></span>
<span id="cb10-519"><a href="#cb10-519" aria-hidden="true" tabindex="-1"></a><span class="st">                display: block;</span></span>
<span id="cb10-520"><a href="#cb10-520" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb10-521"><a href="#cb10-521" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb10-522"><a href="#cb10-522" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Linhas horizontais */</span></span>
<span id="cb10-523"><a href="#cb10-523" aria-hidden="true" tabindex="-1"></a><span class="st">            hr {</span></span>
<span id="cb10-524"><a href="#cb10-524" aria-hidden="true" tabindex="-1"></a><span class="st">                border: none;</span></span>
<span id="cb10-525"><a href="#cb10-525" aria-hidden="true" tabindex="-1"></a><span class="st">                border-top: 2px solid #eee;</span></span>
<span id="cb10-526"><a href="#cb10-526" aria-hidden="true" tabindex="-1"></a><span class="st">                margin: 2em 0;</span></span>
<span id="cb10-527"><a href="#cb10-527" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb10-528"><a href="#cb10-528" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb10-529"><a href="#cb10-529" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Emojis */</span></span>
<span id="cb10-530"><a href="#cb10-530" aria-hidden="true" tabindex="-1"></a><span class="st">            .emoji {</span></span>
<span id="cb10-531"><a href="#cb10-531" aria-hidden="true" tabindex="-1"></a><span class="st">                font-family: &quot;Segoe UI Emoji&quot;, &quot;Apple Color Emoji&quot;, sans-serif;</span></span>
<span id="cb10-532"><a href="#cb10-532" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb10-533"><a href="#cb10-533" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb10-534"><a href="#cb10-534" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Evitar quebra de p√°gina em elementos importantes */</span></span>
<span id="cb10-535"><a href="#cb10-535" aria-hidden="true" tabindex="-1"></a><span class="st">            h1, h2, h3 {</span></span>
<span id="cb10-536"><a href="#cb10-536" aria-hidden="true" tabindex="-1"></a><span class="st">                page-break-after: avoid;</span></span>
<span id="cb10-537"><a href="#cb10-537" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb10-538"><a href="#cb10-538" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb10-539"><a href="#cb10-539" aria-hidden="true" tabindex="-1"></a><span class="st">            pre, table, figure {</span></span>
<span id="cb10-540"><a href="#cb10-540" aria-hidden="true" tabindex="-1"></a><span class="st">                page-break-inside: avoid;</span></span>
<span id="cb10-541"><a href="#cb10-541" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb10-542"><a href="#cb10-542" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb10-543"><a href="#cb10-543" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Melhorar espa√ßamento para impress√£o */</span></span>
<span id="cb10-544"><a href="#cb10-544" aria-hidden="true" tabindex="-1"></a><span class="st">            @media print {</span></span>
<span id="cb10-545"><a href="#cb10-545" aria-hidden="true" tabindex="-1"></a><span class="st">                body {</span></span>
<span id="cb10-546"><a href="#cb10-546" aria-hidden="true" tabindex="-1"></a><span class="st">                    margin: 0;</span></span>
<span id="cb10-547"><a href="#cb10-547" aria-hidden="true" tabindex="-1"></a><span class="st">                    padding: 0;</span></span>
<span id="cb10-548"><a href="#cb10-548" aria-hidden="true" tabindex="-1"></a><span class="st">                }</span></span>
<span id="cb10-549"><a href="#cb10-549" aria-hidden="true" tabindex="-1"></a><span class="st">                </span></span>
<span id="cb10-550"><a href="#cb10-550" aria-hidden="true" tabindex="-1"></a><span class="st">                pre, code {</span></span>
<span id="cb10-551"><a href="#cb10-551" aria-hidden="true" tabindex="-1"></a><span class="st">                    background-color: #f8f8f8 !important;</span></span>
<span id="cb10-552"><a href="#cb10-552" aria-hidden="true" tabindex="-1"></a><span class="st">                    -webkit-print-color-adjust: exact;</span></span>
<span id="cb10-553"><a href="#cb10-553" aria-hidden="true" tabindex="-1"></a><span class="st">                }</span></span>
<span id="cb10-554"><a href="#cb10-554" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb10-555"><a href="#cb10-555" aria-hidden="true" tabindex="-1"></a><span class="st">        &#39;&#39;&#39;</span>)</span>
<span id="cb10-556"><a href="#cb10-556" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-557"><a href="#cb10-557" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> convert_html_to_pdf(<span class="va">self</span>, input_html, output_pdf<span class="op">=</span><span class="va">None</span>, base_url<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb10-558"><a href="#cb10-558" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;&quot;&quot;</span></span>
<span id="cb10-559"><a href="#cb10-559" aria-hidden="true" tabindex="-1"></a><span class="st">        Converte arquivo HTML para PDF</span></span>
<span id="cb10-560"><a href="#cb10-560" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb10-561"><a href="#cb10-561" aria-hidden="true" tabindex="-1"></a><span class="st">        Args:</span></span>
<span id="cb10-562"><a href="#cb10-562" aria-hidden="true" tabindex="-1"></a><span class="st">            input_html (str): Caminho para arquivo HTML de entrada</span></span>
<span id="cb10-563"><a href="#cb10-563" aria-hidden="true" tabindex="-1"></a><span class="st">            output_pdf (str): Caminho para arquivo PDF de sa√≠da (opcional)</span></span>
<span id="cb10-564"><a href="#cb10-564" aria-hidden="true" tabindex="-1"></a><span class="st">            base_url (str): URL base para recursos externos (opcional)</span></span>
<span id="cb10-565"><a href="#cb10-565" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb10-566"><a href="#cb10-566" aria-hidden="true" tabindex="-1"></a><span class="st">        Returns:</span></span>
<span id="cb10-567"><a href="#cb10-567" aria-hidden="true" tabindex="-1"></a><span class="st">            str: Caminho do arquivo PDF gerado</span></span>
<span id="cb10-568"><a href="#cb10-568" aria-hidden="true" tabindex="-1"></a><span class="st">        &quot;&quot;&quot;</span></span>
<span id="cb10-569"><a href="#cb10-569" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb10-570"><a href="#cb10-570" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Verificar se arquivo de entrada existe</span></span>
<span id="cb10-571"><a href="#cb10-571" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> os.path.exists(input_html):</span>
<span id="cb10-572"><a href="#cb10-572" aria-hidden="true" tabindex="-1"></a>                <span class="cf">raise</span> <span class="pp">FileNotFoundError</span>(<span class="ss">f&quot;Arquivo de entrada n√£o encontrado: </span><span class="sc">{</span>input_html<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb10-573"><a href="#cb10-573" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb10-574"><a href="#cb10-574" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Gerar nome do arquivo de sa√≠da se n√£o fornecido</span></span>
<span id="cb10-575"><a href="#cb10-575" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> output_pdf <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb10-576"><a href="#cb10-576" aria-hidden="true" tabindex="-1"></a>                input_path <span class="op">=</span> Path(input_html)</span>
<span id="cb10-577"><a href="#cb10-577" aria-hidden="true" tabindex="-1"></a>                output_pdf <span class="op">=</span> Path(<span class="va">self</span>.output_dir) <span class="op">/</span> <span class="ss">f&quot;</span><span class="sc">{</span>input_path<span class="sc">.</span>stem<span class="sc">}</span><span class="ss">.pdf&quot;</span></span>
<span id="cb10-578"><a href="#cb10-578" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb10-579"><a href="#cb10-579" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Garantir que o diret√≥rio de sa√≠da existe</span></span>
<span id="cb10-580"><a href="#cb10-580" aria-hidden="true" tabindex="-1"></a>            Path(output_pdf).parent.mkdir(parents<span class="op">=</span><span class="va">True</span>, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb10-581"><a href="#cb10-581" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb10-582"><a href="#cb10-582" aria-hidden="true" tabindex="-1"></a>            logger.info(<span class="ss">f&quot;Convertendo </span><span class="sc">{</span>input_html<span class="sc">}</span><span class="ss"> para </span><span class="sc">{</span>output_pdf<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb10-583"><a href="#cb10-583" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb10-584"><a href="#cb10-584" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Carregar estilos customizados</span></span>
<span id="cb10-585"><a href="#cb10-585" aria-hidden="true" tabindex="-1"></a>            stylesheets <span class="op">=</span> [<span class="va">self</span>.get_custom_styles()]</span>
<span id="cb10-586"><a href="#cb10-586" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb10-587"><a href="#cb10-587" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Converter HTML para PDF</span></span>
<span id="cb10-588"><a href="#cb10-588" aria-hidden="true" tabindex="-1"></a>            html_obj <span class="op">=</span> HTML(filename<span class="op">=</span>input_html, base_url<span class="op">=</span>base_url)</span>
<span id="cb10-589"><a href="#cb10-589" aria-hidden="true" tabindex="-1"></a>            html_obj.write_pdf(output_pdf, stylesheets<span class="op">=</span>stylesheets)</span>
<span id="cb10-590"><a href="#cb10-590" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb10-591"><a href="#cb10-591" aria-hidden="true" tabindex="-1"></a>            logger.info(<span class="ss">f&quot;‚úÖ Convers√£o conclu√≠da: </span><span class="sc">{</span>output_pdf<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb10-592"><a href="#cb10-592" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="bu">str</span>(output_pdf)</span>
<span id="cb10-593"><a href="#cb10-593" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb10-594"><a href="#cb10-594" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb10-595"><a href="#cb10-595" aria-hidden="true" tabindex="-1"></a>            logger.error(<span class="ss">f&quot;‚ùå Erro na convers√£o: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb10-596"><a href="#cb10-596" aria-hidden="true" tabindex="-1"></a>            <span class="cf">raise</span></span>
<span id="cb10-597"><a href="#cb10-597" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-598"><a href="#cb10-598" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> convert_multiple_files(<span class="va">self</span>, html_files, output_dir<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb10-599"><a href="#cb10-599" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;&quot;&quot;</span></span>
<span id="cb10-600"><a href="#cb10-600" aria-hidden="true" tabindex="-1"></a><span class="st">        Converte m√∫ltiplos arquivos HTML para PDF</span></span>
<span id="cb10-601"><a href="#cb10-601" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb10-602"><a href="#cb10-602" aria-hidden="true" tabindex="-1"></a><span class="st">        Args:</span></span>
<span id="cb10-603"><a href="#cb10-603" aria-hidden="true" tabindex="-1"></a><span class="st">            html_files (list): Lista de caminhos para arquivos HTML</span></span>
<span id="cb10-604"><a href="#cb10-604" aria-hidden="true" tabindex="-1"></a><span class="st">            output_dir (str): Diret√≥rio de sa√≠da (opcional)</span></span>
<span id="cb10-605"><a href="#cb10-605" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb10-606"><a href="#cb10-606" aria-hidden="true" tabindex="-1"></a><span class="st">        Returns:</span></span>
<span id="cb10-607"><a href="#cb10-607" aria-hidden="true" tabindex="-1"></a><span class="st">            list: Lista de arquivos PDF gerados</span></span>
<span id="cb10-608"><a href="#cb10-608" aria-hidden="true" tabindex="-1"></a><span class="st">        &quot;&quot;&quot;</span></span>
<span id="cb10-609"><a href="#cb10-609" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> output_dir:</span>
<span id="cb10-610"><a href="#cb10-610" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.output_dir <span class="op">=</span> output_dir</span>
<span id="cb10-611"><a href="#cb10-611" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>._ensure_output_dir()</span>
<span id="cb10-612"><a href="#cb10-612" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-613"><a href="#cb10-613" aria-hidden="true" tabindex="-1"></a>        pdf_files <span class="op">=</span> []</span>
<span id="cb10-614"><a href="#cb10-614" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> html_file <span class="kw">in</span> html_files:</span>
<span id="cb10-615"><a href="#cb10-615" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb10-616"><a href="#cb10-616" aria-hidden="true" tabindex="-1"></a>                pdf_file <span class="op">=</span> <span class="va">self</span>.convert_html_to_pdf(html_file)</span>
<span id="cb10-617"><a href="#cb10-617" aria-hidden="true" tabindex="-1"></a>                pdf_files.append(pdf_file)</span>
<span id="cb10-618"><a href="#cb10-618" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb10-619"><a href="#cb10-619" aria-hidden="true" tabindex="-1"></a>                logger.error(<span class="ss">f&quot;Falha ao converter </span><span class="sc">{</span>html_file<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb10-620"><a href="#cb10-620" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span></span>
<span id="cb10-621"><a href="#cb10-621" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-622"><a href="#cb10-622" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> pdf_files</span>
<span id="cb10-623"><a href="#cb10-623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-624"><a href="#cb10-624" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> main():</span>
<span id="cb10-625"><a href="#cb10-625" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;&quot;&quot;Fun√ß√£o principal para execu√ß√£o via linha de comando&quot;&quot;&quot;</span></span>
<span id="cb10-626"><a href="#cb10-626" aria-hidden="true" tabindex="-1"></a>    parser <span class="op">=</span> argparse.ArgumentParser(description<span class="op">=</span><span class="st">&#39;Conversor de HTML para PDF&#39;</span>)</span>
<span id="cb10-627"><a href="#cb10-627" aria-hidden="true" tabindex="-1"></a>    parser.add_argument(<span class="st">&#39;input&#39;</span>, <span class="bu">help</span><span class="op">=</span><span class="st">&#39;Arquivo HTML de entrada ou diret√≥rio&#39;</span>)</span>
<span id="cb10-628"><a href="#cb10-628" aria-hidden="true" tabindex="-1"></a>    parser.add_argument(<span class="st">&#39;-o&#39;</span>, <span class="st">&#39;--output&#39;</span>, <span class="bu">help</span><span class="op">=</span><span class="st">&#39;Arquivo PDF de sa√≠da&#39;</span>)</span>
<span id="cb10-629"><a href="#cb10-629" aria-hidden="true" tabindex="-1"></a>    parser.add_argument(<span class="st">&#39;-d&#39;</span>, <span class="st">&#39;--output-dir&#39;</span>, default<span class="op">=</span><span class="st">&#39;output_pdfs&#39;</span>, </span>
<span id="cb10-630"><a href="#cb10-630" aria-hidden="true" tabindex="-1"></a>                       <span class="bu">help</span><span class="op">=</span><span class="st">&#39;Diret√≥rio de sa√≠da para m√∫ltiplos arquivos&#39;</span>)</span>
<span id="cb10-631"><a href="#cb10-631" aria-hidden="true" tabindex="-1"></a>    parser.add_argument(<span class="st">&#39;-b&#39;</span>, <span class="st">&#39;--base-url&#39;</span>, <span class="bu">help</span><span class="op">=</span><span class="st">&#39;URL base para recursos externos&#39;</span>)</span>
<span id="cb10-632"><a href="#cb10-632" aria-hidden="true" tabindex="-1"></a>    parser.add_argument(<span class="st">&#39;-v&#39;</span>, <span class="st">&#39;--verbose&#39;</span>, action<span class="op">=</span><span class="st">&#39;store_true&#39;</span>, </span>
<span id="cb10-633"><a href="#cb10-633" aria-hidden="true" tabindex="-1"></a>                       <span class="bu">help</span><span class="op">=</span><span class="st">&#39;Modo verboso&#39;</span>)</span>
<span id="cb10-634"><a href="#cb10-634" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-635"><a href="#cb10-635" aria-hidden="true" tabindex="-1"></a>    args <span class="op">=</span> parser.parse_args()</span>
<span id="cb10-636"><a href="#cb10-636" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-637"><a href="#cb10-637" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> args.verbose:</span>
<span id="cb10-638"><a href="#cb10-638" aria-hidden="true" tabindex="-1"></a>        logging.getLogger().setLevel(logging.DEBUG)</span>
<span id="cb10-639"><a href="#cb10-639" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-640"><a href="#cb10-640" aria-hidden="true" tabindex="-1"></a>    converter <span class="op">=</span> HTMLToPDFConverter(args.output_dir)</span>
<span id="cb10-641"><a href="#cb10-641" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-642"><a href="#cb10-642" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb10-643"><a href="#cb10-643" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Verificar se √© arquivo ou diret√≥rio</span></span>
<span id="cb10-644"><a href="#cb10-644" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> os.path.isfile(args.<span class="bu">input</span>):</span>
<span id="cb10-645"><a href="#cb10-645" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Converter √∫nico arquivo</span></span>
<span id="cb10-646"><a href="#cb10-646" aria-hidden="true" tabindex="-1"></a>            converter.convert_html_to_pdf(</span>
<span id="cb10-647"><a href="#cb10-647" aria-hidden="true" tabindex="-1"></a>                input_html<span class="op">=</span>args.<span class="bu">input</span>,</span>
<span id="cb10-648"><a href="#cb10-648" aria-hidden="true" tabindex="-1"></a>                output_pdf<span class="op">=</span>args.output,</span>
<span id="cb10-649"><a href="#cb10-649" aria-hidden="true" tabindex="-1"></a>                base_url<span class="op">=</span>args.base_url</span>
<span id="cb10-650"><a href="#cb10-650" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb10-651"><a href="#cb10-651" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> os.path.isdir(args.<span class="bu">input</span>):</span>
<span id="cb10-652"><a href="#cb10-652" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Converter todos os arquivos HTML do diret√≥rio</span></span>
<span id="cb10-653"><a href="#cb10-653" aria-hidden="true" tabindex="-1"></a>            html_files <span class="op">=</span> <span class="bu">list</span>(Path(args.<span class="bu">input</span>).glob(<span class="st">&quot;*.html&quot;</span>))</span>
<span id="cb10-654"><a href="#cb10-654" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> html_files:</span>
<span id="cb10-655"><a href="#cb10-655" aria-hidden="true" tabindex="-1"></a>                logger.warning(<span class="ss">f&quot;Nenhum arquivo HTML encontrado em </span><span class="sc">{</span>args<span class="sc">.</span><span class="bu">input</span><span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb10-656"><a href="#cb10-656" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span></span>
<span id="cb10-657"><a href="#cb10-657" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb10-658"><a href="#cb10-658" aria-hidden="true" tabindex="-1"></a>            logger.info(<span class="ss">f&quot;Encontrados </span><span class="sc">{</span><span class="bu">len</span>(html_files)<span class="sc">}</span><span class="ss"> arquivos HTML&quot;</span>)</span>
<span id="cb10-659"><a href="#cb10-659" aria-hidden="true" tabindex="-1"></a>            pdf_files <span class="op">=</span> converter.convert_multiple_files(html_files)</span>
<span id="cb10-660"><a href="#cb10-660" aria-hidden="true" tabindex="-1"></a>            logger.info(<span class="ss">f&quot;‚úÖ Convers√£o conclu√≠da: </span><span class="sc">{</span><span class="bu">len</span>(pdf_files)<span class="sc">}</span><span class="ss"> arquivos processados&quot;</span>)</span>
<span id="cb10-661"><a href="#cb10-661" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb10-662"><a href="#cb10-662" aria-hidden="true" tabindex="-1"></a>            logger.error(<span class="ss">f&quot;Entrada inv√°lida: </span><span class="sc">{</span>args<span class="sc">.</span><span class="bu">input</span><span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb10-663"><a href="#cb10-663" aria-hidden="true" tabindex="-1"></a>            sys.exit(<span class="dv">1</span>)</span>
<span id="cb10-664"><a href="#cb10-664" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb10-665"><a href="#cb10-665" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb10-666"><a href="#cb10-666" aria-hidden="true" tabindex="-1"></a>        logger.error(<span class="ss">f&quot;Erro durante a convers√£o: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb10-667"><a href="#cb10-667" aria-hidden="true" tabindex="-1"></a>        sys.exit(<span class="dv">1</span>)</span>
<span id="cb10-668"><a href="#cb10-668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-669"><a href="#cb10-669" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&quot;__main__&quot;</span>:</span>
<span id="cb10-670"><a href="#cb10-670" aria-hidden="true" tabindex="-1"></a>    main()</span></code></pre></div>
<h2 data-number="1.7" id="como-usar"><span class="header-section-number">1.7</span> üìã <strong>Como
usar:</strong></h2>
<h3 data-number="1.7.1" id="instala√ß√£o-das-depend√™ncias"><span class="header-section-number">1.7.1</span> 1. <strong>Instala√ß√£o das
depend√™ncias:</strong></h3>
<div class="sourceCode" id="cb11"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="ex">conda</span> create <span class="at">-n</span> html2pdf python=3.9</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="ex">conda</span> activate html2pdf</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="ex">conda</span> install <span class="at">-c</span> conda-forge weasyprint</span></code></pre></div>
<h3 data-number="1.7.2" id="uso-b√°sico"><span class="header-section-number">1.7.2</span> 2. <strong>Uso
b√°sico:</strong></h3>
<div class="sourceCode" id="cb12"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Converter arquivo √∫nico</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> html_to_pdf2.py exemplo_completo.html</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Especificar arquivo de sa√≠da</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> html_to_pdf2.py exemplo_completo.html <span class="at">-o</span> meu_documento.pdf</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Converter todos os HTML de um diret√≥rio</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> html_to_pdf2.py ./documentos/ <span class="at">-d</span> meus_pdfs</span></code></pre></div>
<h3 data-number="1.7.3" id="uso-como-m√≥dulo-python"><span class="header-section-number">1.7.3</span> 3. <strong>Uso como m√≥dulo
Python:</strong></h3>
<div class="sourceCode" id="cb13"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> html_to_pdf2 <span class="im">import</span> HTMLToPDFConverter</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Converter arquivo √∫nico</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>converter <span class="op">=</span> HTMLToPDFConverter()</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>converter.convert_html_to_pdf(<span class="st">&quot;exemplo_completo.html&quot;</span>, <span class="st">&quot;saida.pdf&quot;</span>)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Converter m√∫ltiplos arquivos</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>pdfs <span class="op">=</span> converter.convert_multiple_files([<span class="st">&quot;doc1.html&quot;</span>, <span class="st">&quot;doc2.html&quot;</span>])</span></code></pre></div>
<h2 data-number="1.8" id="caracter√≠sticas-do-script"><span class="header-section-number">1.8</span> ‚ú® <strong>Caracter√≠sticas do
script:</strong></h2>
<ul>
<li>‚úÖ <strong>Suporte completo a f√≥rmulas matem√°ticas</strong>
(MathJax/LaTeX)</li>
<li>‚úÖ <strong>Renderiza√ß√£o fiel de c√≥digo</strong> com syntax
highlighting</li>
<li>‚úÖ <strong>Suporte a emojis</strong> nativo</li>
<li>‚úÖ <strong>CSS customizado</strong> para melhor apresenta√ß√£o</li>
<li>‚úÖ <strong>Controle de quebras de p√°gina</strong></li>
<li>‚úÖ <strong>Suporte a m√∫ltiplos arquivos</strong></li>
<li>‚úÖ <strong>Logging detalhado</strong></li>
<li>‚úÖ <strong>Interface de linha de comando</strong></li>
<li>‚úÖ <strong>Tratamento de erros robusto</strong></li>
</ul>
<p>O script foi otimizado especificamente para documentos t√©cnicos com
f√≥rmulas matem√°ticas e c√≥digo, garantindo uma convers√£o fiel do HTML
para PDF.</p>
<hr />
<h3 data-number="1.8.1" id="utilizador-2025-11-01-025243-deepseek-chat"><span class="header-section-number">1.8.1</span> üë§ Utilizador <em>(2025-11-01
02:52:43)</em> <em>[deepseek-chat]</em></h3>
<p>(Pesquisas) D:_DOCS__DOCS__html_to_pdf&gt;python html_to_pdf2.py
exemplo_completo.html Fontconfig error: Cannot load default config file:
No such file: (null) 2025-10-31 18:52:01,508 - INFO - Convertendo
exemplo_completo.html para output_pdfs_completo.pdf Fontconfig error:
Cannot load default config file: No such file: (null) Fontconfig error:
Cannot load default config file: No such file: (null) 2025-10-31
18:52:01,596 - WARNING - Ignored <code>gap: min(4vw, 1.5em)</code> at
7:32, unknown property. 2025-10-31 18:52:01,600 - WARNING - Ignored
<code>overflow-x: auto</code> at 8:28, unknown property. 2025-10-31
18:52:01,608 - WARNING - Ignored <code>user-select: none</code> at
45:32, unknown property. 2025-10-31 18:52:01,624 - ERROR - Failed to
load stylesheet at <a href="file:///D:/Downloads/_DOCS_/_DOCS_/Teste_html_to_pdf/%3Cp%3Ebody%20%7B%20max-width:%20900px;%20margin:%200auto;%20padding:%2020px;%20font-family:%20Arial,%20sans-serif;%20line-height:%201.6;%20%7Dh1,%20h2,%20h3%20%7B%20color:%20#1565C0;%20/*%20Azul%20*/%20%7D%20pre,%20code%20%7B%20background-color:#f6f8fa;%20padding:%2010px;%20border-radius:%205px;%20%7D%3C/p%3E" class="uri">file:///D:/Downloads/_DOCS_/_DOCS_/Teste_html_to_pdf/%3Cp%3Ebody%20%7B%20max-width:%20900px;%20margin:%200auto;%20padding:%2020px;%20font-family:%20Arial,%20sans-serif;%20line-height:%201.6;%20%7Dh1,%20h2,%20h3%20%7B%20color:%20#1565C0;%20/*%20Azul%20*/%20%7D%20pre,%20code%20%7B%20background-color:#f6f8fa;%20padding:%2010px;%20border-radius:%205px;%20%7D%3C/p%3E</a>:
OSError: Bad URL:
/D|/Downloads/<em>DOCS</em>/<em>DOCS</em>/Teste_html_to_pdf/%3Cp%3Ebody%20%7B%20max-width|%20900px;%20margin|%200auto;%20padding|%2020px;%20font-family|%20Arial,%20sans-serif;%20line-height|%201.6;%20%7Dh1,%20h2,%20h3%20%7B%20color|%20#1565C0;%20/<em>%20Azul%20</em>/%20%7D%20pre,%20code%20%7B%20background-color|
2025-10-31 18:52:02,688 - ERROR - ‚ùå Erro na convers√£o:
PDF.<strong>init</strong>() takes 1 positional argument but 3 were given
2025-10-31 18:52:02,688 - ERROR - Erro durante a convers√£o:
PDF.<strong>init</strong>() takes 1 positional argument but 3 were
given</p>
<hr />
<h3 data-number="1.8.2" id="deepseek-2025-11-01-025243-deepseek-chat"><span class="header-section-number">1.8.2</span> ü§ñ DeepSeek <em>(2025-11-01
02:52:43)</em> <em>[deepseek-chat]</em></h3>
<p>O problema est√° no HTML que tem um link de stylesheet inv√°lido. Vou
corrigir o script para lidar com esses erros e fornecer uma vers√£o mais
robusta:</p>
<h2 data-number="1.9" id="script-corrigido-html_to_pdf2.py"><span class="header-section-number">1.9</span> üêõ <strong>Script Corrigido:
html_to_pdf2.py</strong></h2>
<div class="sourceCode" id="cb14"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/usr/bin/env python3</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co">&quot;&quot;&quot;</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co">html_to_pdf2.py - Conversor robusto de HTML para PDF</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co">Corrige problemas com stylesheets inv√°lidos e fontconfig</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="co">&quot;&quot;&quot;</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sys</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> argparse</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tempfile</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> weasyprint <span class="im">import</span> HTML, CSS</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> logging</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Configurar logging</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>logging.basicConfig(level<span class="op">=</span>logging.INFO, <span class="bu">format</span><span class="op">=</span><span class="st">&#39;</span><span class="sc">%(asctime)s</span><span class="st"> - </span><span class="sc">%(levelname)s</span><span class="st"> - </span><span class="sc">%(message)s</span><span class="st">&#39;</span>)</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>logger <span class="op">=</span> logging.getLogger(<span class="va">__name__</span>)</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> HTMLToPDFConverter:</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, output_dir<span class="op">=</span><span class="st">&quot;output_pdfs&quot;</span>):</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.output_dir <span class="op">=</span> output_dir</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>._ensure_output_dir()</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _ensure_output_dir(<span class="va">self</span>):</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Cria o diret√≥rio de output se n√£o existir&quot;&quot;&quot;</span></span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>        Path(<span class="va">self</span>.output_dir).mkdir(exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _clean_html_file(<span class="va">self</span>, input_html):</span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;</span></span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a><span class="co">        Limpa o arquivo HTML removendo stylesheets inv√°lidos</span></span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a><span class="co">        e corrigindo problemas comuns</span></span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a><span class="co">        &quot;&quot;&quot;</span></span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(input_html, <span class="st">&#39;r&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>                content <span class="op">=</span> f.read()</span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Remover stylesheet inv√°lido que causa erro</span></span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a>            content <span class="op">=</span> re.sub(</span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a>                <span class="vs">r&#39;&lt;link rel=&quot;stylesheet&quot; href=&quot;&lt;p&gt;body</span><span class="dv">.</span><span class="op">*?</span><span class="vs">&lt;/p&gt;&quot;</span><span class="dv">\s</span><span class="op">*</span><span class="vs">/&gt;&#39;</span>,</span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;&#39;</span>,</span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a>                content,</span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a>                flags<span class="op">=</span>re.DOTALL</span>
<span id="cb14-44"><a href="#cb14-44" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb14-45"><a href="#cb14-45" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb14-46"><a href="#cb14-46" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Remover qualquer link de stylesheet com URL inv√°lida</span></span>
<span id="cb14-47"><a href="#cb14-47" aria-hidden="true" tabindex="-1"></a>            content <span class="op">=</span> re.sub(</span>
<span id="cb14-48"><a href="#cb14-48" aria-hidden="true" tabindex="-1"></a>                <span class="vs">r&#39;&lt;link rel=&quot;stylesheet&quot; href=&quot;</span><span class="pp">[^&quot;]</span><span class="op">*?</span><span class="vs">%3Cp%3E</span><span class="pp">[^&quot;]</span><span class="op">*?</span><span class="vs">&quot;</span><span class="dv">\s</span><span class="op">*</span><span class="vs">/&gt;&#39;</span>,</span>
<span id="cb14-49"><a href="#cb14-49" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;&#39;</span>,</span>
<span id="cb14-50"><a href="#cb14-50" aria-hidden="true" tabindex="-1"></a>                content</span>
<span id="cb14-51"><a href="#cb14-51" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb14-52"><a href="#cb14-52" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb14-53"><a href="#cb14-53" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Adicionar meta tag para melhor compatibilidade</span></span>
<span id="cb14-54"><a href="#cb14-54" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="st">&#39;&lt;meta charset=&quot;utf-8&quot;&gt;&#39;</span> <span class="kw">not</span> <span class="kw">in</span> content:</span>
<span id="cb14-55"><a href="#cb14-55" aria-hidden="true" tabindex="-1"></a>                content <span class="op">=</span> content.replace(<span class="st">&#39;&lt;head&gt;&#39;</span>, <span class="st">&#39;&lt;head&gt;</span><span class="ch">\n</span><span class="st">  &lt;meta charset=&quot;utf-8&quot;&gt;&#39;</span>)</span>
<span id="cb14-56"><a href="#cb14-56" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb14-57"><a href="#cb14-57" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Criar arquivo tempor√°rio limpo</span></span>
<span id="cb14-58"><a href="#cb14-58" aria-hidden="true" tabindex="-1"></a>            temp_file <span class="op">=</span> tempfile.NamedTemporaryFile(mode<span class="op">=</span><span class="st">&#39;w&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>, </span>
<span id="cb14-59"><a href="#cb14-59" aria-hidden="true" tabindex="-1"></a>                                                   suffix<span class="op">=</span><span class="st">&#39;.html&#39;</span>, delete<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb14-60"><a href="#cb14-60" aria-hidden="true" tabindex="-1"></a>            temp_file.write(content)</span>
<span id="cb14-61"><a href="#cb14-61" aria-hidden="true" tabindex="-1"></a>            temp_file.close()</span>
<span id="cb14-62"><a href="#cb14-62" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb14-63"><a href="#cb14-63" aria-hidden="true" tabindex="-1"></a>            logger.info(<span class="ss">f&quot;Arquivo HTML limpo criado: </span><span class="sc">{</span>temp_file<span class="sc">.</span>name<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb14-64"><a href="#cb14-64" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> temp_file.name</span>
<span id="cb14-65"><a href="#cb14-65" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb14-66"><a href="#cb14-66" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb14-67"><a href="#cb14-67" aria-hidden="true" tabindex="-1"></a>            logger.warning(<span class="ss">f&quot;Erro ao limpar HTML, usando original: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb14-68"><a href="#cb14-68" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> input_html</span>
<span id="cb14-69"><a href="#cb14-69" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-70"><a href="#cb14-70" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> get_custom_styles(<span class="va">self</span>):</span>
<span id="cb14-71"><a href="#cb14-71" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Retorna CSS customizado para melhor renderiza√ß√£o&quot;&quot;&quot;</span></span>
<span id="cb14-72"><a href="#cb14-72" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> CSS(string<span class="op">=</span><span class="st">&#39;&#39;&#39;</span></span>
<span id="cb14-73"><a href="#cb14-73" aria-hidden="true" tabindex="-1"></a><span class="st">            @page {</span></span>
<span id="cb14-74"><a href="#cb14-74" aria-hidden="true" tabindex="-1"></a><span class="st">                size: A4;</span></span>
<span id="cb14-75"><a href="#cb14-75" aria-hidden="true" tabindex="-1"></a><span class="st">                margin: 2cm;</span></span>
<span id="cb14-76"><a href="#cb14-76" aria-hidden="true" tabindex="-1"></a><span class="st">                @top-left {</span></span>
<span id="cb14-77"><a href="#cb14-77" aria-hidden="true" tabindex="-1"></a><span class="st">                    content: &quot;Documento HTML&quot;;</span></span>
<span id="cb14-78"><a href="#cb14-78" aria-hidden="true" tabindex="-1"></a><span class="st">                    font-size: 10px;</span></span>
<span id="cb14-79"><a href="#cb14-79" aria-hidden="true" tabindex="-1"></a><span class="st">                    color: #666;</span></span>
<span id="cb14-80"><a href="#cb14-80" aria-hidden="true" tabindex="-1"></a><span class="st">                }</span></span>
<span id="cb14-81"><a href="#cb14-81" aria-hidden="true" tabindex="-1"></a><span class="st">                @bottom-right {</span></span>
<span id="cb14-82"><a href="#cb14-82" aria-hidden="true" tabindex="-1"></a><span class="st">                    content: &quot;P√°gina &quot; counter(page);</span></span>
<span id="cb14-83"><a href="#cb14-83" aria-hidden="true" tabindex="-1"></a><span class="st">                    font-size: 10px;</span></span>
<span id="cb14-84"><a href="#cb14-84" aria-hidden="true" tabindex="-1"></a><span class="st">                    color: #666;</span></span>
<span id="cb14-85"><a href="#cb14-85" aria-hidden="true" tabindex="-1"></a><span class="st">                }</span></span>
<span id="cb14-86"><a href="#cb14-86" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb14-87"><a href="#cb14-87" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb14-88"><a href="#cb14-88" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Estilos gerais do corpo */</span></span>
<span id="cb14-89"><a href="#cb14-89" aria-hidden="true" tabindex="-1"></a><span class="st">            body {</span></span>
<span id="cb14-90"><a href="#cb14-90" aria-hidden="true" tabindex="-1"></a><span class="st">                font-family: &quot;Arial&quot;, &quot;DejaVu Sans&quot;, &quot;Liberation Sans&quot;, sans-serif;</span></span>
<span id="cb14-91"><a href="#cb14-91" aria-hidden="true" tabindex="-1"></a><span class="st">                line-height: 1.6;</span></span>
<span id="cb14-92"><a href="#cb14-92" aria-hidden="true" tabindex="-1"></a><span class="st">                color: #333;</span></span>
<span id="cb14-93"><a href="#cb14-93" aria-hidden="true" tabindex="-1"></a><span class="st">                max-width: 100%;</span></span>
<span id="cb14-94"><a href="#cb14-94" aria-hidden="true" tabindex="-1"></a><span class="st">                margin: 0 auto;</span></span>
<span id="cb14-95"><a href="#cb14-95" aria-hidden="true" tabindex="-1"></a><span class="st">                padding: 20px;</span></span>
<span id="cb14-96"><a href="#cb14-96" aria-hidden="true" tabindex="-1"></a><span class="st">                font-size: 12px;</span></span>
<span id="cb14-97"><a href="#cb14-97" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb14-98"><a href="#cb14-98" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb14-99"><a href="#cb14-99" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Cabe√ßalhos */</span></span>
<span id="cb14-100"><a href="#cb14-100" aria-hidden="true" tabindex="-1"></a><span class="st">            h1, h2, h3, h4, h5, h6 {</span></span>
<span id="cb14-101"><a href="#cb14-101" aria-hidden="true" tabindex="-1"></a><span class="st">                color: #1565C0;</span></span>
<span id="cb14-102"><a href="#cb14-102" aria-hidden="true" tabindex="-1"></a><span class="st">                margin-top: 1.2em;</span></span>
<span id="cb14-103"><a href="#cb14-103" aria-hidden="true" tabindex="-1"></a><span class="st">                margin-bottom: 0.5em;</span></span>
<span id="cb14-104"><a href="#cb14-104" aria-hidden="true" tabindex="-1"></a><span class="st">                page-break-after: avoid;</span></span>
<span id="cb14-105"><a href="#cb14-105" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb14-106"><a href="#cb14-106" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb14-107"><a href="#cb14-107" aria-hidden="true" tabindex="-1"></a><span class="st">            h1 {</span></span>
<span id="cb14-108"><a href="#cb14-108" aria-hidden="true" tabindex="-1"></a><span class="st">                font-size: 18px;</span></span>
<span id="cb14-109"><a href="#cb14-109" aria-hidden="true" tabindex="-1"></a><span class="st">                border-bottom: 2px solid #1565C0;</span></span>
<span id="cb14-110"><a href="#cb14-110" aria-hidden="true" tabindex="-1"></a><span class="st">                padding-bottom: 0.3em;</span></span>
<span id="cb14-111"><a href="#cb14-111" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb14-112"><a href="#cb14-112" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb14-113"><a href="#cb14-113" aria-hidden="true" tabindex="-1"></a><span class="st">            h2 {</span></span>
<span id="cb14-114"><a href="#cb14-114" aria-hidden="true" tabindex="-1"></a><span class="st">                font-size: 16px;</span></span>
<span id="cb14-115"><a href="#cb14-115" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb14-116"><a href="#cb14-116" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb14-117"><a href="#cb14-117" aria-hidden="true" tabindex="-1"></a><span class="st">            h3 {</span></span>
<span id="cb14-118"><a href="#cb14-118" aria-hidden="true" tabindex="-1"></a><span class="st">                font-size: 14px;</span></span>
<span id="cb14-119"><a href="#cb14-119" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb14-120"><a href="#cb14-120" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb14-121"><a href="#cb14-121" aria-hidden="true" tabindex="-1"></a><span class="st">            /* C√≥digo e blocos de c√≥digo */</span></span>
<span id="cb14-122"><a href="#cb14-122" aria-hidden="true" tabindex="-1"></a><span class="st">            pre, code {</span></span>
<span id="cb14-123"><a href="#cb14-123" aria-hidden="true" tabindex="-1"></a><span class="st">                font-family: &quot;Consolas&quot;, &quot;Monaco&quot;, &quot;Courier New&quot;, monospace;</span></span>
<span id="cb14-124"><a href="#cb14-124" aria-hidden="true" tabindex="-1"></a><span class="st">                background-color: #f6f8fa !important;</span></span>
<span id="cb14-125"><a href="#cb14-125" aria-hidden="true" tabindex="-1"></a><span class="st">                border: 1px solid #e1e4e8;</span></span>
<span id="cb14-126"><a href="#cb14-126" aria-hidden="true" tabindex="-1"></a><span class="st">                border-radius: 5px;</span></span>
<span id="cb14-127"><a href="#cb14-127" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb14-128"><a href="#cb14-128" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb14-129"><a href="#cb14-129" aria-hidden="true" tabindex="-1"></a><span class="st">            pre {</span></span>
<span id="cb14-130"><a href="#cb14-130" aria-hidden="true" tabindex="-1"></a><span class="st">                padding: 12px;</span></span>
<span id="cb14-131"><a href="#cb14-131" aria-hidden="true" tabindex="-1"></a><span class="st">                overflow: auto;</span></span>
<span id="cb14-132"><a href="#cb14-132" aria-hidden="true" tabindex="-1"></a><span class="st">                page-break-inside: avoid;</span></span>
<span id="cb14-133"><a href="#cb14-133" aria-hidden="true" tabindex="-1"></a><span class="st">                font-size: 11px;</span></span>
<span id="cb14-134"><a href="#cb14-134" aria-hidden="true" tabindex="-1"></a><span class="st">                white-space: pre-wrap;</span></span>
<span id="cb14-135"><a href="#cb14-135" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb14-136"><a href="#cb14-136" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb14-137"><a href="#cb14-137" aria-hidden="true" tabindex="-1"></a><span class="st">            code {</span></span>
<span id="cb14-138"><a href="#cb14-138" aria-hidden="true" tabindex="-1"></a><span class="st">                padding: 2px 4px;</span></span>
<span id="cb14-139"><a href="#cb14-139" aria-hidden="true" tabindex="-1"></a><span class="st">                font-size: 11px;</span></span>
<span id="cb14-140"><a href="#cb14-140" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb14-141"><a href="#cb14-141" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb14-142"><a href="#cb14-142" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Blocos de c√≥digo com syntax highlighting */</span></span>
<span id="cb14-143"><a href="#cb14-143" aria-hidden="true" tabindex="-1"></a><span class="st">            div.sourceCode {</span></span>
<span id="cb14-144"><a href="#cb14-144" aria-hidden="true" tabindex="-1"></a><span class="st">                margin: 1em 0;</span></span>
<span id="cb14-145"><a href="#cb14-145" aria-hidden="true" tabindex="-1"></a><span class="st">                page-break-inside: avoid;</span></span>
<span id="cb14-146"><a href="#cb14-146" aria-hidden="true" tabindex="-1"></a><span class="st">                background-color: #f6f8fa;</span></span>
<span id="cb14-147"><a href="#cb14-147" aria-hidden="true" tabindex="-1"></a><span class="st">                border-radius: 5px;</span></span>
<span id="cb14-148"><a href="#cb14-148" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb14-149"><a href="#cb14-149" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb14-150"><a href="#cb14-150" aria-hidden="true" tabindex="-1"></a><span class="st">            pre.sourceCode {</span></span>
<span id="cb14-151"><a href="#cb14-151" aria-hidden="true" tabindex="-1"></a><span class="st">                margin: 0;</span></span>
<span id="cb14-152"><a href="#cb14-152" aria-hidden="true" tabindex="-1"></a><span class="st">                background-color: transparent;</span></span>
<span id="cb14-153"><a href="#cb14-153" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb14-154"><a href="#cb14-154" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb14-155"><a href="#cb14-155" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Syntax highlighting colors */</span></span>
<span id="cb14-156"><a href="#cb14-156" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode span.al { color: #ff0000; font-weight: bold; }</span></span>
<span id="cb14-157"><a href="#cb14-157" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode span.an { color: #60a0b0; font-weight: bold; font-style: italic; }</span></span>
<span id="cb14-158"><a href="#cb14-158" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode span.at { color: #7d9029; }</span></span>
<span id="cb14-159"><a href="#cb14-159" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode span.bn { color: #40a070; }</span></span>
<span id="cb14-160"><a href="#cb14-160" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode span.bu { color: #008000; }</span></span>
<span id="cb14-161"><a href="#cb14-161" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode span.cf { color: #007020; font-weight: bold; }</span></span>
<span id="cb14-162"><a href="#cb14-162" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode span.ch { color: #4070a0; }</span></span>
<span id="cb14-163"><a href="#cb14-163" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode span.cn { color: #880000; }</span></span>
<span id="cb14-164"><a href="#cb14-164" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode span.co { color: #60a0b0; font-style: italic; }</span></span>
<span id="cb14-165"><a href="#cb14-165" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode span.cv { color: #60a0b0; font-weight: bold; font-style: italic; }</span></span>
<span id="cb14-166"><a href="#cb14-166" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode span.do { color: #ba2121; font-style: italic; }</span></span>
<span id="cb14-167"><a href="#cb14-167" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode span.dt { color: #902000; }</span></span>
<span id="cb14-168"><a href="#cb14-168" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode span.dv { color: #40a070; }</span></span>
<span id="cb14-169"><a href="#cb14-169" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode span.er { color: #ff0000; font-weight: bold; }</span></span>
<span id="cb14-170"><a href="#cb14-170" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode span.ex { color: #007020; }</span></span>
<span id="cb14-171"><a href="#cb14-171" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode span.fl { color: #40a070; }</span></span>
<span id="cb14-172"><a href="#cb14-172" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode span.fu { color: #06287e; }</span></span>
<span id="cb14-173"><a href="#cb14-173" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode span.im { color: #008000; font-weight: bold; }</span></span>
<span id="cb14-174"><a href="#cb14-174" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode span.in { color: #60a0b0; font-weight: bold; font-style: italic; }</span></span>
<span id="cb14-175"><a href="#cb14-175" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode span.kw { color: #007020; font-weight: bold; }</span></span>
<span id="cb14-176"><a href="#cb14-176" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode span.op { color: #666666; }</span></span>
<span id="cb14-177"><a href="#cb14-177" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode span.ot { color: #007020; }</span></span>
<span id="cb14-178"><a href="#cb14-178" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode span.pp { color: #bc7a00; }</span></span>
<span id="cb14-179"><a href="#cb14-179" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode span.sc { color: #4070a0; }</span></span>
<span id="cb14-180"><a href="#cb14-180" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode span.ss { color: #bb6688; }</span></span>
<span id="cb14-181"><a href="#cb14-181" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode span.st { color: #4070a0; }</span></span>
<span id="cb14-182"><a href="#cb14-182" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode span.va { color: #19177c; }</span></span>
<span id="cb14-183"><a href="#cb14-183" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode span.vs { color: #4070a0; }</span></span>
<span id="cb14-184"><a href="#cb14-184" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode span.wa { color: #60a0b0; font-weight: bold; font-style: italic; }</span></span>
<span id="cb14-185"><a href="#cb14-185" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb14-186"><a href="#cb14-186" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Tabelas */</span></span>
<span id="cb14-187"><a href="#cb14-187" aria-hidden="true" tabindex="-1"></a><span class="st">            table {</span></span>
<span id="cb14-188"><a href="#cb14-188" aria-hidden="true" tabindex="-1"></a><span class="st">                border-collapse: collapse;</span></span>
<span id="cb14-189"><a href="#cb14-189" aria-hidden="true" tabindex="-1"></a><span class="st">                width: 100%;</span></span>
<span id="cb14-190"><a href="#cb14-190" aria-hidden="true" tabindex="-1"></a><span class="st">                margin: 1em 0;</span></span>
<span id="cb14-191"><a href="#cb14-191" aria-hidden="true" tabindex="-1"></a><span class="st">                page-break-inside: avoid;</span></span>
<span id="cb14-192"><a href="#cb14-192" aria-hidden="true" tabindex="-1"></a><span class="st">                font-size: 11px;</span></span>
<span id="cb14-193"><a href="#cb14-193" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb14-194"><a href="#cb14-194" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb14-195"><a href="#cb14-195" aria-hidden="true" tabindex="-1"></a><span class="st">            th, td {</span></span>
<span id="cb14-196"><a href="#cb14-196" aria-hidden="true" tabindex="-1"></a><span class="st">                border: 1px solid #ddd;</span></span>
<span id="cb14-197"><a href="#cb14-197" aria-hidden="true" tabindex="-1"></a><span class="st">                padding: 6px 10px;</span></span>
<span id="cb14-198"><a href="#cb14-198" aria-hidden="true" tabindex="-1"></a><span class="st">                text-align: left;</span></span>
<span id="cb14-199"><a href="#cb14-199" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb14-200"><a href="#cb14-200" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb14-201"><a href="#cb14-201" aria-hidden="true" tabindex="-1"></a><span class="st">            th {</span></span>
<span id="cb14-202"><a href="#cb14-202" aria-hidden="true" tabindex="-1"></a><span class="st">                background-color: #f2f2f2;</span></span>
<span id="cb14-203"><a href="#cb14-203" aria-hidden="true" tabindex="-1"></a><span class="st">                font-weight: bold;</span></span>
<span id="cb14-204"><a href="#cb14-204" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb14-205"><a href="#cb14-205" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb14-206"><a href="#cb14-206" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Cita√ß√µes */</span></span>
<span id="cb14-207"><a href="#cb14-207" aria-hidden="true" tabindex="-1"></a><span class="st">            blockquote {</span></span>
<span id="cb14-208"><a href="#cb14-208" aria-hidden="true" tabindex="-1"></a><span class="st">                background-color: #f9f9f9;</span></span>
<span id="cb14-209"><a href="#cb14-209" aria-hidden="true" tabindex="-1"></a><span class="st">                border-left: 4px solid #ccc;</span></span>
<span id="cb14-210"><a href="#cb14-210" aria-hidden="true" tabindex="-1"></a><span class="st">                margin: 1em 0;</span></span>
<span id="cb14-211"><a href="#cb14-211" aria-hidden="true" tabindex="-1"></a><span class="st">                padding: 0.5em 1em;</span></span>
<span id="cb14-212"><a href="#cb14-212" aria-hidden="true" tabindex="-1"></a><span class="st">                font-style: italic;</span></span>
<span id="cb14-213"><a href="#cb14-213" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb14-214"><a href="#cb14-214" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb14-215"><a href="#cb14-215" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Listas */</span></span>
<span id="cb14-216"><a href="#cb14-216" aria-hidden="true" tabindex="-1"></a><span class="st">            ul, ol {</span></span>
<span id="cb14-217"><a href="#cb14-217" aria-hidden="true" tabindex="-1"></a><span class="st">                margin: 1em 0;</span></span>
<span id="cb14-218"><a href="#cb14-218" aria-hidden="true" tabindex="-1"></a><span class="st">                padding-left: 1.5em;</span></span>
<span id="cb14-219"><a href="#cb14-219" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb14-220"><a href="#cb14-220" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb14-221"><a href="#cb14-221" aria-hidden="true" tabindex="-1"></a><span class="st">            li {</span></span>
<span id="cb14-222"><a href="#cb14-222" aria-hidden="true" tabindex="-1"></a><span class="st">                margin: 0.3em 0;</span></span>
<span id="cb14-223"><a href="#cb14-223" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb14-224"><a href="#cb14-224" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb14-225"><a href="#cb14-225" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Links */</span></span>
<span id="cb14-226"><a href="#cb14-226" aria-hidden="true" tabindex="-1"></a><span class="st">            a {</span></span>
<span id="cb14-227"><a href="#cb14-227" aria-hidden="true" tabindex="-1"></a><span class="st">                color: #0366d6;</span></span>
<span id="cb14-228"><a href="#cb14-228" aria-hidden="true" tabindex="-1"></a><span class="st">                text-decoration: none;</span></span>
<span id="cb14-229"><a href="#cb14-229" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb14-230"><a href="#cb14-230" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb14-231"><a href="#cb14-231" aria-hidden="true" tabindex="-1"></a><span class="st">            a::after {</span></span>
<span id="cb14-232"><a href="#cb14-232" aria-hidden="true" tabindex="-1"></a><span class="st">                content: &quot; (&quot; attr(href) &quot;)&quot;;</span></span>
<span id="cb14-233"><a href="#cb14-233" aria-hidden="true" tabindex="-1"></a><span class="st">                font-size: 0.9em;</span></span>
<span id="cb14-234"><a href="#cb14-234" aria-hidden="true" tabindex="-1"></a><span class="st">                color: #666;</span></span>
<span id="cb14-235"><a href="#cb14-235" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb14-236"><a href="#cb14-236" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb14-237"><a href="#cb14-237" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Imagens */</span></span>
<span id="cb14-238"><a href="#cb14-238" aria-hidden="true" tabindex="-1"></a><span class="st">            img {</span></span>
<span id="cb14-239"><a href="#cb14-239" aria-hidden="true" tabindex="-1"></a><span class="st">                max-width: 100%;</span></span>
<span id="cb14-240"><a href="#cb14-240" aria-hidden="true" tabindex="-1"></a><span class="st">                height: auto;</span></span>
<span id="cb14-241"><a href="#cb14-241" aria-hidden="true" tabindex="-1"></a><span class="st">                page-break-inside: avoid;</span></span>
<span id="cb14-242"><a href="#cb14-242" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb14-243"><a href="#cb14-243" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb14-244"><a href="#cb14-244" aria-hidden="true" tabindex="-1"></a><span class="st">            figure {</span></span>
<span id="cb14-245"><a href="#cb14-245" aria-hidden="true" tabindex="-1"></a><span class="st">                margin: 1em 0;</span></span>
<span id="cb14-246"><a href="#cb14-246" aria-hidden="true" tabindex="-1"></a><span class="st">                text-align: center;</span></span>
<span id="cb14-247"><a href="#cb14-247" aria-hidden="true" tabindex="-1"></a><span class="st">                page-break-inside: avoid;</span></span>
<span id="cb14-248"><a href="#cb14-248" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb14-249"><a href="#cb14-249" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb14-250"><a href="#cb14-250" aria-hidden="true" tabindex="-1"></a><span class="st">            figcaption {</span></span>
<span id="cb14-251"><a href="#cb14-251" aria-hidden="true" tabindex="-1"></a><span class="st">                font-size: 0.8em;</span></span>
<span id="cb14-252"><a href="#cb14-252" aria-hidden="true" tabindex="-1"></a><span class="st">                color: #666;</span></span>
<span id="cb14-253"><a href="#cb14-253" aria-hidden="true" tabindex="-1"></a><span class="st">                margin-top: 0.5em;</span></span>
<span id="cb14-254"><a href="#cb14-254" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb14-255"><a href="#cb14-255" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb14-256"><a href="#cb14-256" aria-hidden="true" tabindex="-1"></a><span class="st">            /* F√≥rmulas matem√°ticas */</span></span>
<span id="cb14-257"><a href="#cb14-257" aria-hidden="true" tabindex="-1"></a><span class="st">            .math {</span></span>
<span id="cb14-258"><a href="#cb14-258" aria-hidden="true" tabindex="-1"></a><span class="st">                text-align: center;</span></span>
<span id="cb14-259"><a href="#cb14-259" aria-hidden="true" tabindex="-1"></a><span class="st">                margin: 1em 0;</span></span>
<span id="cb14-260"><a href="#cb14-260" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb14-261"><a href="#cb14-261" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb14-262"><a href="#cb14-262" aria-hidden="true" tabindex="-1"></a><span class="st">            .math.display {</span></span>
<span id="cb14-263"><a href="#cb14-263" aria-hidden="true" tabindex="-1"></a><span class="st">                display: block;</span></span>
<span id="cb14-264"><a href="#cb14-264" aria-hidden="true" tabindex="-1"></a><span class="st">                margin: 1.5em 0;</span></span>
<span id="cb14-265"><a href="#cb14-265" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb14-266"><a href="#cb14-266" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb14-267"><a href="#cb14-267" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Linhas horizontais */</span></span>
<span id="cb14-268"><a href="#cb14-268" aria-hidden="true" tabindex="-1"></a><span class="st">            hr {</span></span>
<span id="cb14-269"><a href="#cb14-269" aria-hidden="true" tabindex="-1"></a><span class="st">                border: none;</span></span>
<span id="cb14-270"><a href="#cb14-270" aria-hidden="true" tabindex="-1"></a><span class="st">                border-top: 2px solid #eee;</span></span>
<span id="cb14-271"><a href="#cb14-271" aria-hidden="true" tabindex="-1"></a><span class="st">                margin: 1.5em 0;</span></span>
<span id="cb14-272"><a href="#cb14-272" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb14-273"><a href="#cb14-273" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb14-274"><a href="#cb14-274" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Evitar quebra de p√°gina em elementos importantes */</span></span>
<span id="cb14-275"><a href="#cb14-275" aria-hidden="true" tabindex="-1"></a><span class="st">            h1, h2, h3 {</span></span>
<span id="cb14-276"><a href="#cb14-276" aria-hidden="true" tabindex="-1"></a><span class="st">                page-break-after: avoid;</span></span>
<span id="cb14-277"><a href="#cb14-277" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb14-278"><a href="#cb14-278" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb14-279"><a href="#cb14-279" aria-hidden="true" tabindex="-1"></a><span class="st">            pre, table, figure, .math {</span></span>
<span id="cb14-280"><a href="#cb14-280" aria-hidden="true" tabindex="-1"></a><span class="st">                page-break-inside: avoid;</span></span>
<span id="cb14-281"><a href="#cb14-281" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb14-282"><a href="#cb14-282" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb14-283"><a href="#cb14-283" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Garantir que cores de fundo sejam impressas */</span></span>
<span id="cb14-284"><a href="#cb14-284" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode, pre, code {</span></span>
<span id="cb14-285"><a href="#cb14-285" aria-hidden="true" tabindex="-1"></a><span class="st">                -webkit-print-color-adjust: exact !important;</span></span>
<span id="cb14-286"><a href="#cb14-286" aria-hidden="true" tabindex="-1"></a><span class="st">                color-adjust: exact !important;</span></span>
<span id="cb14-287"><a href="#cb14-287" aria-hidden="true" tabindex="-1"></a><span class="st">                print-color-adjust: exact !important;</span></span>
<span id="cb14-288"><a href="#cb14-288" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb14-289"><a href="#cb14-289" aria-hidden="true" tabindex="-1"></a><span class="st">        &#39;&#39;&#39;</span>)</span>
<span id="cb14-290"><a href="#cb14-290" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-291"><a href="#cb14-291" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> convert_html_to_pdf(<span class="va">self</span>, input_html, output_pdf<span class="op">=</span><span class="va">None</span>, base_url<span class="op">=</span><span class="va">None</span>, clean_html<span class="op">=</span><span class="va">True</span>):</span>
<span id="cb14-292"><a href="#cb14-292" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;</span></span>
<span id="cb14-293"><a href="#cb14-293" aria-hidden="true" tabindex="-1"></a><span class="co">        Converte arquivo HTML para PDF</span></span>
<span id="cb14-294"><a href="#cb14-294" aria-hidden="true" tabindex="-1"></a><span class="co">        </span></span>
<span id="cb14-295"><a href="#cb14-295" aria-hidden="true" tabindex="-1"></a><span class="co">        Args:</span></span>
<span id="cb14-296"><a href="#cb14-296" aria-hidden="true" tabindex="-1"></a><span class="co">            input_html (str): Caminho para arquivo HTML de entrada</span></span>
<span id="cb14-297"><a href="#cb14-297" aria-hidden="true" tabindex="-1"></a><span class="co">            output_pdf (str): Caminho para arquivo PDF de sa√≠da (opcional)</span></span>
<span id="cb14-298"><a href="#cb14-298" aria-hidden="true" tabindex="-1"></a><span class="co">            base_url (str): URL base para recursos externos (opcional)</span></span>
<span id="cb14-299"><a href="#cb14-299" aria-hidden="true" tabindex="-1"></a><span class="co">            clean_html (bool): Se deve limpar o HTML antes da convers√£o</span></span>
<span id="cb14-300"><a href="#cb14-300" aria-hidden="true" tabindex="-1"></a><span class="co">        </span></span>
<span id="cb14-301"><a href="#cb14-301" aria-hidden="true" tabindex="-1"></a><span class="co">        Returns:</span></span>
<span id="cb14-302"><a href="#cb14-302" aria-hidden="true" tabindex="-1"></a><span class="co">            str: Caminho do arquivo PDF gerado</span></span>
<span id="cb14-303"><a href="#cb14-303" aria-hidden="true" tabindex="-1"></a><span class="co">        &quot;&quot;&quot;</span></span>
<span id="cb14-304"><a href="#cb14-304" aria-hidden="true" tabindex="-1"></a>        temp_file <span class="op">=</span> <span class="va">None</span></span>
<span id="cb14-305"><a href="#cb14-305" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb14-306"><a href="#cb14-306" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Verificar se arquivo de entrada existe</span></span>
<span id="cb14-307"><a href="#cb14-307" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> os.path.exists(input_html):</span>
<span id="cb14-308"><a href="#cb14-308" aria-hidden="true" tabindex="-1"></a>                <span class="cf">raise</span> <span class="pp">FileNotFoundError</span>(<span class="ss">f&quot;Arquivo de entrada n√£o encontrado: </span><span class="sc">{</span>input_html<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb14-309"><a href="#cb14-309" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb14-310"><a href="#cb14-310" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Limpar HTML se necess√°rio</span></span>
<span id="cb14-311"><a href="#cb14-311" aria-hidden="true" tabindex="-1"></a>            html_to_convert <span class="op">=</span> input_html</span>
<span id="cb14-312"><a href="#cb14-312" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> clean_html:</span>
<span id="cb14-313"><a href="#cb14-313" aria-hidden="true" tabindex="-1"></a>                html_to_convert <span class="op">=</span> <span class="va">self</span>._clean_html_file(input_html)</span>
<span id="cb14-314"><a href="#cb14-314" aria-hidden="true" tabindex="-1"></a>                temp_file <span class="op">=</span> html_to_convert</span>
<span id="cb14-315"><a href="#cb14-315" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb14-316"><a href="#cb14-316" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Gerar nome do arquivo de sa√≠da se n√£o fornecido</span></span>
<span id="cb14-317"><a href="#cb14-317" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> output_pdf <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb14-318"><a href="#cb14-318" aria-hidden="true" tabindex="-1"></a>                input_path <span class="op">=</span> Path(input_html)</span>
<span id="cb14-319"><a href="#cb14-319" aria-hidden="true" tabindex="-1"></a>                output_pdf <span class="op">=</span> Path(<span class="va">self</span>.output_dir) <span class="op">/</span> <span class="ss">f&quot;</span><span class="sc">{</span>input_path<span class="sc">.</span>stem<span class="sc">}</span><span class="ss">.pdf&quot;</span></span>
<span id="cb14-320"><a href="#cb14-320" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb14-321"><a href="#cb14-321" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Garantir que o diret√≥rio de sa√≠da existe</span></span>
<span id="cb14-322"><a href="#cb14-322" aria-hidden="true" tabindex="-1"></a>            Path(output_pdf).parent.mkdir(parents<span class="op">=</span><span class="va">True</span>, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb14-323"><a href="#cb14-323" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb14-324"><a href="#cb14-324" aria-hidden="true" tabindex="-1"></a>            logger.info(<span class="ss">f&quot;Convertendo </span><span class="sc">{</span>input_html<span class="sc">}</span><span class="ss"> para </span><span class="sc">{</span>output_pdf<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb14-325"><a href="#cb14-325" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb14-326"><a href="#cb14-326" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Carregar estilos customizados</span></span>
<span id="cb14-327"><a href="#cb14-327" aria-hidden="true" tabindex="-1"></a>            stylesheets <span class="op">=</span> [<span class="va">self</span>.get_custom_styles()]</span>
<span id="cb14-328"><a href="#cb14-328" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb14-329"><a href="#cb14-329" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Configurar base_url</span></span>
<span id="cb14-330"><a href="#cb14-330" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> base_url <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb14-331"><a href="#cb14-331" aria-hidden="true" tabindex="-1"></a>                base_url <span class="op">=</span> os.path.dirname(os.path.abspath(input_html))</span>
<span id="cb14-332"><a href="#cb14-332" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb14-333"><a href="#cb14-333" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Converter HTML para PDF</span></span>
<span id="cb14-334"><a href="#cb14-334" aria-hidden="true" tabindex="-1"></a>            html_obj <span class="op">=</span> HTML(filename<span class="op">=</span>html_to_convert, base_url<span class="op">=</span>base_url)</span>
<span id="cb14-335"><a href="#cb14-335" aria-hidden="true" tabindex="-1"></a>            html_obj.write_pdf(output_pdf, stylesheets<span class="op">=</span>stylesheets)</span>
<span id="cb14-336"><a href="#cb14-336" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb14-337"><a href="#cb14-337" aria-hidden="true" tabindex="-1"></a>            logger.info(<span class="ss">f&quot;‚úÖ Convers√£o conclu√≠da: </span><span class="sc">{</span>output_pdf<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb14-338"><a href="#cb14-338" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="bu">str</span>(output_pdf)</span>
<span id="cb14-339"><a href="#cb14-339" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb14-340"><a href="#cb14-340" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb14-341"><a href="#cb14-341" aria-hidden="true" tabindex="-1"></a>            logger.error(<span class="ss">f&quot;‚ùå Erro na convers√£o: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb14-342"><a href="#cb14-342" aria-hidden="true" tabindex="-1"></a>            <span class="cf">raise</span></span>
<span id="cb14-343"><a href="#cb14-343" aria-hidden="true" tabindex="-1"></a>        <span class="cf">finally</span>:</span>
<span id="cb14-344"><a href="#cb14-344" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Limpar arquivo tempor√°rio se existir</span></span>
<span id="cb14-345"><a href="#cb14-345" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> temp_file <span class="kw">and</span> temp_file <span class="op">!=</span> input_html <span class="kw">and</span> os.path.exists(temp_file):</span>
<span id="cb14-346"><a href="#cb14-346" aria-hidden="true" tabindex="-1"></a>                <span class="cf">try</span>:</span>
<span id="cb14-347"><a href="#cb14-347" aria-hidden="true" tabindex="-1"></a>                    os.unlink(temp_file)</span>
<span id="cb14-348"><a href="#cb14-348" aria-hidden="true" tabindex="-1"></a>                <span class="cf">except</span>:</span>
<span id="cb14-349"><a href="#cb14-349" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">pass</span></span>
<span id="cb14-350"><a href="#cb14-350" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-351"><a href="#cb14-351" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> convert_multiple_files(<span class="va">self</span>, html_files, output_dir<span class="op">=</span><span class="va">None</span>, clean_html<span class="op">=</span><span class="va">True</span>):</span>
<span id="cb14-352"><a href="#cb14-352" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;</span></span>
<span id="cb14-353"><a href="#cb14-353" aria-hidden="true" tabindex="-1"></a><span class="co">        Converte m√∫ltiplos arquivos HTML para PDF</span></span>
<span id="cb14-354"><a href="#cb14-354" aria-hidden="true" tabindex="-1"></a><span class="co">        </span></span>
<span id="cb14-355"><a href="#cb14-355" aria-hidden="true" tabindex="-1"></a><span class="co">        Args:</span></span>
<span id="cb14-356"><a href="#cb14-356" aria-hidden="true" tabindex="-1"></a><span class="co">            html_files (list): Lista de caminhos para arquivos HTML</span></span>
<span id="cb14-357"><a href="#cb14-357" aria-hidden="true" tabindex="-1"></a><span class="co">            output_dir (str): Diret√≥rio de sa√≠da (opcional)</span></span>
<span id="cb14-358"><a href="#cb14-358" aria-hidden="true" tabindex="-1"></a><span class="co">            clean_html (bool): Se deve limpar o HTML antes da convers√£o</span></span>
<span id="cb14-359"><a href="#cb14-359" aria-hidden="true" tabindex="-1"></a><span class="co">        </span></span>
<span id="cb14-360"><a href="#cb14-360" aria-hidden="true" tabindex="-1"></a><span class="co">        Returns:</span></span>
<span id="cb14-361"><a href="#cb14-361" aria-hidden="true" tabindex="-1"></a><span class="co">            list: Lista de arquivos PDF gerados</span></span>
<span id="cb14-362"><a href="#cb14-362" aria-hidden="true" tabindex="-1"></a><span class="co">        &quot;&quot;&quot;</span></span>
<span id="cb14-363"><a href="#cb14-363" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> output_dir:</span>
<span id="cb14-364"><a href="#cb14-364" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.output_dir <span class="op">=</span> output_dir</span>
<span id="cb14-365"><a href="#cb14-365" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>._ensure_output_dir()</span>
<span id="cb14-366"><a href="#cb14-366" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb14-367"><a href="#cb14-367" aria-hidden="true" tabindex="-1"></a>        pdf_files <span class="op">=</span> []</span>
<span id="cb14-368"><a href="#cb14-368" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> html_file <span class="kw">in</span> html_files:</span>
<span id="cb14-369"><a href="#cb14-369" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb14-370"><a href="#cb14-370" aria-hidden="true" tabindex="-1"></a>                pdf_file <span class="op">=</span> <span class="va">self</span>.convert_html_to_pdf(html_file, clean_html<span class="op">=</span>clean_html)</span>
<span id="cb14-371"><a href="#cb14-371" aria-hidden="true" tabindex="-1"></a>                pdf_files.append(pdf_file)</span>
<span id="cb14-372"><a href="#cb14-372" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb14-373"><a href="#cb14-373" aria-hidden="true" tabindex="-1"></a>                logger.error(<span class="ss">f&quot;Falha ao converter </span><span class="sc">{</span>html_file<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb14-374"><a href="#cb14-374" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span></span>
<span id="cb14-375"><a href="#cb14-375" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb14-376"><a href="#cb14-376" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> pdf_files</span>
<span id="cb14-377"><a href="#cb14-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-378"><a href="#cb14-378" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> suppress_fontconfig_warnings():</span>
<span id="cb14-379"><a href="#cb14-379" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Suprime avisos do Fontconfig no Windows&quot;&quot;&quot;</span></span>
<span id="cb14-380"><a href="#cb14-380" aria-hidden="true" tabindex="-1"></a>    <span class="im">import</span> warnings</span>
<span id="cb14-381"><a href="#cb14-381" aria-hidden="true" tabindex="-1"></a>    warnings.filterwarnings(<span class="st">&quot;ignore&quot;</span>, category<span class="op">=</span><span class="pp">UserWarning</span>, module<span class="op">=</span><span class="st">&quot;weasyprint&quot;</span>)</span>
<span id="cb14-382"><a href="#cb14-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-383"><a href="#cb14-383" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> main():</span>
<span id="cb14-384"><a href="#cb14-384" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Fun√ß√£o principal para execu√ß√£o via linha de comando&quot;&quot;&quot;</span></span>
<span id="cb14-385"><a href="#cb14-385" aria-hidden="true" tabindex="-1"></a>    parser <span class="op">=</span> argparse.ArgumentParser(description<span class="op">=</span><span class="st">&#39;Conversor de HTML para PDF&#39;</span>)</span>
<span id="cb14-386"><a href="#cb14-386" aria-hidden="true" tabindex="-1"></a>    parser.add_argument(<span class="st">&#39;input&#39;</span>, <span class="bu">help</span><span class="op">=</span><span class="st">&#39;Arquivo HTML de entrada ou diret√≥rio&#39;</span>)</span>
<span id="cb14-387"><a href="#cb14-387" aria-hidden="true" tabindex="-1"></a>    parser.add_argument(<span class="st">&#39;-o&#39;</span>, <span class="st">&#39;--output&#39;</span>, <span class="bu">help</span><span class="op">=</span><span class="st">&#39;Arquivo PDF de sa√≠da&#39;</span>)</span>
<span id="cb14-388"><a href="#cb14-388" aria-hidden="true" tabindex="-1"></a>    parser.add_argument(<span class="st">&#39;-d&#39;</span>, <span class="st">&#39;--output-dir&#39;</span>, default<span class="op">=</span><span class="st">&#39;output_pdfs&#39;</span>, </span>
<span id="cb14-389"><a href="#cb14-389" aria-hidden="true" tabindex="-1"></a>                       <span class="bu">help</span><span class="op">=</span><span class="st">&#39;Diret√≥rio de sa√≠da para m√∫ltiplos arquivos&#39;</span>)</span>
<span id="cb14-390"><a href="#cb14-390" aria-hidden="true" tabindex="-1"></a>    parser.add_argument(<span class="st">&#39;-b&#39;</span>, <span class="st">&#39;--base-url&#39;</span>, <span class="bu">help</span><span class="op">=</span><span class="st">&#39;URL base para recursos externos&#39;</span>)</span>
<span id="cb14-391"><a href="#cb14-391" aria-hidden="true" tabindex="-1"></a>    parser.add_argument(<span class="st">&#39;-v&#39;</span>, <span class="st">&#39;--verbose&#39;</span>, action<span class="op">=</span><span class="st">&#39;store_true&#39;</span>, </span>
<span id="cb14-392"><a href="#cb14-392" aria-hidden="true" tabindex="-1"></a>                       <span class="bu">help</span><span class="op">=</span><span class="st">&#39;Modo verboso&#39;</span>)</span>
<span id="cb14-393"><a href="#cb14-393" aria-hidden="true" tabindex="-1"></a>    parser.add_argument(<span class="st">&#39;--no-clean&#39;</span>, action<span class="op">=</span><span class="st">&#39;store_true&#39;</span>,</span>
<span id="cb14-394"><a href="#cb14-394" aria-hidden="true" tabindex="-1"></a>                       <span class="bu">help</span><span class="op">=</span><span class="st">&#39;N√£o limpar HTML antes da convers√£o&#39;</span>)</span>
<span id="cb14-395"><a href="#cb14-395" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-396"><a href="#cb14-396" aria-hidden="true" tabindex="-1"></a>    args <span class="op">=</span> parser.parse_args()</span>
<span id="cb14-397"><a href="#cb14-397" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-398"><a href="#cb14-398" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> args.verbose:</span>
<span id="cb14-399"><a href="#cb14-399" aria-hidden="true" tabindex="-1"></a>        logging.getLogger().setLevel(logging.DEBUG)</span>
<span id="cb14-400"><a href="#cb14-400" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-401"><a href="#cb14-401" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Suprimir avisos do fontconfig</span></span>
<span id="cb14-402"><a href="#cb14-402" aria-hidden="true" tabindex="-1"></a>    suppress_fontconfig_warnings()</span>
<span id="cb14-403"><a href="#cb14-403" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-404"><a href="#cb14-404" aria-hidden="true" tabindex="-1"></a>    converter <span class="op">=</span> HTMLToPDFConverter(args.output_dir)</span>
<span id="cb14-405"><a href="#cb14-405" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-406"><a href="#cb14-406" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb14-407"><a href="#cb14-407" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Verificar se √© arquivo ou diret√≥rio</span></span>
<span id="cb14-408"><a href="#cb14-408" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> os.path.isfile(args.<span class="bu">input</span>):</span>
<span id="cb14-409"><a href="#cb14-409" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Converter √∫nico arquivo</span></span>
<span id="cb14-410"><a href="#cb14-410" aria-hidden="true" tabindex="-1"></a>            converter.convert_html_to_pdf(</span>
<span id="cb14-411"><a href="#cb14-411" aria-hidden="true" tabindex="-1"></a>                input_html<span class="op">=</span>args.<span class="bu">input</span>,</span>
<span id="cb14-412"><a href="#cb14-412" aria-hidden="true" tabindex="-1"></a>                output_pdf<span class="op">=</span>args.output,</span>
<span id="cb14-413"><a href="#cb14-413" aria-hidden="true" tabindex="-1"></a>                base_url<span class="op">=</span>args.base_url,</span>
<span id="cb14-414"><a href="#cb14-414" aria-hidden="true" tabindex="-1"></a>                clean_html<span class="op">=</span><span class="kw">not</span> args.no_clean</span>
<span id="cb14-415"><a href="#cb14-415" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb14-416"><a href="#cb14-416" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> os.path.isdir(args.<span class="bu">input</span>):</span>
<span id="cb14-417"><a href="#cb14-417" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Converter todos os arquivos HTML do diret√≥rio</span></span>
<span id="cb14-418"><a href="#cb14-418" aria-hidden="true" tabindex="-1"></a>            html_files <span class="op">=</span> <span class="bu">list</span>(Path(args.<span class="bu">input</span>).glob(<span class="st">&quot;*.html&quot;</span>))</span>
<span id="cb14-419"><a href="#cb14-419" aria-hidden="true" tabindex="-1"></a>            html_files.extend(Path(args.<span class="bu">input</span>).glob(<span class="st">&quot;*.htm&quot;</span>))</span>
<span id="cb14-420"><a href="#cb14-420" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb14-421"><a href="#cb14-421" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> html_files:</span>
<span id="cb14-422"><a href="#cb14-422" aria-hidden="true" tabindex="-1"></a>                logger.warning(<span class="ss">f&quot;Nenhum arquivo HTML encontrado em </span><span class="sc">{</span>args<span class="sc">.</span><span class="bu">input</span><span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb14-423"><a href="#cb14-423" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span></span>
<span id="cb14-424"><a href="#cb14-424" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb14-425"><a href="#cb14-425" aria-hidden="true" tabindex="-1"></a>            logger.info(<span class="ss">f&quot;Encontrados </span><span class="sc">{</span><span class="bu">len</span>(html_files)<span class="sc">}</span><span class="ss"> arquivos HTML&quot;</span>)</span>
<span id="cb14-426"><a href="#cb14-426" aria-hidden="true" tabindex="-1"></a>            pdf_files <span class="op">=</span> converter.convert_multiple_files(</span>
<span id="cb14-427"><a href="#cb14-427" aria-hidden="true" tabindex="-1"></a>                html_files, </span>
<span id="cb14-428"><a href="#cb14-428" aria-hidden="true" tabindex="-1"></a>                clean_html<span class="op">=</span><span class="kw">not</span> args.no_clean</span>
<span id="cb14-429"><a href="#cb14-429" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb14-430"><a href="#cb14-430" aria-hidden="true" tabindex="-1"></a>            logger.info(<span class="ss">f&quot;‚úÖ Convers√£o conclu√≠da: </span><span class="sc">{</span><span class="bu">len</span>(pdf_files)<span class="sc">}</span><span class="ss"> arquivos processados&quot;</span>)</span>
<span id="cb14-431"><a href="#cb14-431" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb14-432"><a href="#cb14-432" aria-hidden="true" tabindex="-1"></a>            logger.error(<span class="ss">f&quot;Entrada inv√°lida: </span><span class="sc">{</span>args<span class="sc">.</span><span class="bu">input</span><span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb14-433"><a href="#cb14-433" aria-hidden="true" tabindex="-1"></a>            sys.exit(<span class="dv">1</span>)</span>
<span id="cb14-434"><a href="#cb14-434" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb14-435"><a href="#cb14-435" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb14-436"><a href="#cb14-436" aria-hidden="true" tabindex="-1"></a>        logger.error(<span class="ss">f&quot;Erro durante a convers√£o: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb14-437"><a href="#cb14-437" aria-hidden="true" tabindex="-1"></a>        sys.exit(<span class="dv">1</span>)</span>
<span id="cb14-438"><a href="#cb14-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-439"><a href="#cb14-439" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&quot;__main__&quot;</span>:</span>
<span id="cb14-440"><a href="#cb14-440" aria-hidden="true" tabindex="-1"></a>    main()</span></code></pre></div>
<h2 data-number="1.10" id="principais-corre√ß√µes"><span class="header-section-number">1.10</span> üîß <strong>Principais
Corre√ß√µes:</strong></h2>
<ol type="1">
<li><strong>‚úÖ Limpeza autom√°tica do HTML</strong> - Remove stylesheets
inv√°lidos</li>
<li><strong>‚úÖ Supress√£o de avisos Fontconfig</strong> - Ignora erros de
fontes no Windows</li>
<li><strong>‚úÖ CSS melhorado</strong> - Syntax highlighting completo e
cores preservadas</li>
<li><strong>‚úÖ Tratamento de arquivos tempor√°rios</strong> - Limpeza
autom√°tica</li>
<li><strong>‚úÖ Melhor controle de erros</strong> - Continua mesmo com
problemas menores</li>
</ol>
<h2 data-number="1.11" id="como-usar-agora"><span class="header-section-number">1.11</span> üöÄ <strong>Como usar
agora:</strong></h2>
<div class="sourceCode" id="cb15"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convers√£o simples (recomendado)</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> html_to_pdf2.py exemplo_completo.html</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Com output personalizado</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> html_to_pdf2.py exemplo_completo.html <span class="at">-o</span> meu_documento.pdf</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Sem limpeza do HTML (se voc√™ quiser manter o original)</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> html_to_pdf2.py exemplo_completo.html <span class="at">--no-clean</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Modo verboso para debug</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> html_to_pdf2.py exemplo_completo.html <span class="at">-v</span></span></code></pre></div>
<h2 data-number="1.12" id="se-ainda-houver-problemas-tente"><span class="header-section-number">1.12</span> üìù <strong>Se ainda houver
problemas, tente:</strong></h2>
<ol type="1">
<li><strong>Instalar fonts adicional:</strong></li>
</ol>
<div class="sourceCode" id="cb16"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="ex">conda</span> install <span class="at">-c</span> conda-forge dejavu-fonts</span></code></pre></div>
<ol start="2" type="1">
<li><strong>Criar um HTML limpo manualmente:</strong></li>
</ol>
<div class="sourceCode" id="cb17"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># script_limpeza.py</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">&#39;exemplo_completo.html&#39;</span>, <span class="st">&#39;r&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    content <span class="op">=</span> f.read()</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Remover a linha problem√°tica</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>content <span class="op">=</span> content.replace(</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;&lt;link rel=&quot;stylesheet&quot; href=&quot;&lt;p&gt;body { max-width: 900px; margin: 0 auto; padding: 20px; font-family: Arial, sans-serif; line-height: 1.6; } h1, h2, h3 { color: #1565C0; } pre, code { background-color: #f6f8fa; padding: 10px; border-radius: 5px; }&lt;/p&gt;&quot; /&gt;&#39;</span>,</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;&#39;</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">&#39;exemplo_limpo.html&#39;</span>, <span class="st">&#39;w&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>    f.write(content)</span></code></pre></div>
<p>Execute o script corrigido e deve funcionar perfeitamente! üéâ</p>
<hr />
<h3 data-number="1.12.1" id="utilizador-2025-11-01-025842-deepseek-chat"><span class="header-section-number">1.12.1</span> üë§ Utilizador
<em>(2025-11-01 02:58:42)</em> <em>[deepseek-chat]</em></h3>
<p>(Pesquisas) D:_DOCS__DOCS__html_to_pdf&gt;python html_to_pdf2.py
exemplo_completo.html -v Fontconfig error: Cannot load default config
file: No such file: (null) 2025-10-31 18:58:19,039 - INFO - Arquivo HTML
limpo criado: C:6pr98q.html 2025-10-31 18:58:19,039 - INFO - Convertendo
exemplo_completo.html para output_pdfs_completo.pdf 2025-10-31
18:58:19,059 - WARNING - Ignored <code>color-adjust: exact</code> at
215:17, unknown property. 2025-10-31 18:58:19,059 - WARNING - Ignored
<code>print-color-adjust: exact</code> at 216:17, unknown property.
Fontconfig error: Cannot load default config file: No such file: (null)
Fontconfig error: Cannot load default config file: No such file: (null)
2025-10-31 18:58:19,171 - WARNING - Ignored
<code>gap: min(4vw, 1.5em)</code> at 7:32, unknown property. 2025-10-31
18:58:19,171 - WARNING - Ignored <code>overflow-x: auto</code> at 8:28,
unknown property. 2025-10-31 18:58:19,179 - WARNING - Ignored
<code>user-select: none</code> at 45:32, unknown property. 2025-10-31
18:58:20,099 - ERROR - ‚ùå Erro na convers√£o: PDF.<strong>init</strong>()
takes 1 positional argument but 3 were given 2025-10-31 18:58:20,099 -
ERROR - Erro durante a convers√£o: PDF.<strong>init</strong>() takes 1
positional argument but 3 were given</p>
<hr />
<h3 data-number="1.12.2" id="deepseek-2025-11-01-025842-deepseek-chat"><span class="header-section-number">1.12.2</span> ü§ñ DeepSeek <em>(2025-11-01
02:58:42)</em> <em>[deepseek-chat]</em></h3>
<p>O problema √© uma incompatibilidade de vers√£o do WeasyPrint. A API
mudou nas vers√µes mais recentes. Vou fornecer um script corrigido:</p>
<h2 data-number="1.13" id="script-corrigido-html_to_pdf2.py-1"><span class="header-section-number">1.13</span> üîß <strong>Script Corrigido:
html_to_pdf2.py</strong></h2>
<div class="sourceCode" id="cb18"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/usr/bin/env python3</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="co">&quot;&quot;&quot;</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co">html_to_pdf2.py - Conversor robusto de HTML para PDF</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co">Vers√£o compat√≠vel com WeasyPrint 60.0+</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="co">&quot;&quot;&quot;</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sys</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> argparse</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tempfile</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> weasyprint <span class="im">import</span> HTML, CSS</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> logging</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Configurar logging</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>logging.basicConfig(level<span class="op">=</span>logging.INFO, <span class="bu">format</span><span class="op">=</span><span class="st">&#39;</span><span class="sc">%(asctime)s</span><span class="st"> - </span><span class="sc">%(levelname)s</span><span class="st"> - </span><span class="sc">%(message)s</span><span class="st">&#39;</span>)</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>logger <span class="op">=</span> logging.getLogger(<span class="va">__name__</span>)</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> HTMLToPDFConverter:</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, output_dir<span class="op">=</span><span class="st">&quot;output_pdfs&quot;</span>):</span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.output_dir <span class="op">=</span> output_dir</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>._ensure_output_dir()</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _ensure_output_dir(<span class="va">self</span>):</span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Cria o diret√≥rio de output se n√£o existir&quot;&quot;&quot;</span></span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>        Path(<span class="va">self</span>.output_dir).mkdir(exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _clean_html_file(<span class="va">self</span>, input_html):</span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;</span></span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a><span class="co">        Limpa o arquivo HTML removendo stylesheets inv√°lidos</span></span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a><span class="co">        e corrigindo problemas comuns</span></span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a><span class="co">        &quot;&quot;&quot;</span></span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(input_html, <span class="st">&#39;r&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a>                content <span class="op">=</span> f.read()</span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb18-38"><a href="#cb18-38" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Remover stylesheet inv√°lido que causa erro</span></span>
<span id="cb18-39"><a href="#cb18-39" aria-hidden="true" tabindex="-1"></a>            content <span class="op">=</span> re.sub(</span>
<span id="cb18-40"><a href="#cb18-40" aria-hidden="true" tabindex="-1"></a>                <span class="vs">r&#39;&lt;link rel=&quot;stylesheet&quot; href=&quot;&lt;p&gt;body</span><span class="dv">.</span><span class="op">*?</span><span class="vs">&lt;/p&gt;&quot;</span><span class="dv">\s</span><span class="op">*</span><span class="vs">/&gt;&#39;</span>,</span>
<span id="cb18-41"><a href="#cb18-41" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;&#39;</span>,</span>
<span id="cb18-42"><a href="#cb18-42" aria-hidden="true" tabindex="-1"></a>                content,</span>
<span id="cb18-43"><a href="#cb18-43" aria-hidden="true" tabindex="-1"></a>                flags<span class="op">=</span>re.DOTALL</span>
<span id="cb18-44"><a href="#cb18-44" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb18-45"><a href="#cb18-45" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb18-46"><a href="#cb18-46" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Remover qualquer link de stylesheet com URL inv√°lida</span></span>
<span id="cb18-47"><a href="#cb18-47" aria-hidden="true" tabindex="-1"></a>            content <span class="op">=</span> re.sub(</span>
<span id="cb18-48"><a href="#cb18-48" aria-hidden="true" tabindex="-1"></a>                <span class="vs">r&#39;&lt;link rel=&quot;stylesheet&quot; href=&quot;</span><span class="pp">[^&quot;]</span><span class="op">*?</span><span class="vs">%3Cp%3E</span><span class="pp">[^&quot;]</span><span class="op">*?</span><span class="vs">&quot;</span><span class="dv">\s</span><span class="op">*</span><span class="vs">/&gt;&#39;</span>,</span>
<span id="cb18-49"><a href="#cb18-49" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;&#39;</span>,</span>
<span id="cb18-50"><a href="#cb18-50" aria-hidden="true" tabindex="-1"></a>                content</span>
<span id="cb18-51"><a href="#cb18-51" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb18-52"><a href="#cb18-52" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb18-53"><a href="#cb18-53" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Adicionar meta tag para melhor compatibilidade</span></span>
<span id="cb18-54"><a href="#cb18-54" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="st">&#39;&lt;meta charset=&quot;utf-8&quot;&gt;&#39;</span> <span class="kw">not</span> <span class="kw">in</span> content:</span>
<span id="cb18-55"><a href="#cb18-55" aria-hidden="true" tabindex="-1"></a>                content <span class="op">=</span> content.replace(<span class="st">&#39;&lt;head&gt;&#39;</span>, <span class="st">&#39;&lt;head&gt;</span><span class="ch">\n</span><span class="st">  &lt;meta charset=&quot;utf-8&quot;&gt;&#39;</span>)</span>
<span id="cb18-56"><a href="#cb18-56" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb18-57"><a href="#cb18-57" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Criar arquivo tempor√°rio limpo</span></span>
<span id="cb18-58"><a href="#cb18-58" aria-hidden="true" tabindex="-1"></a>            temp_file <span class="op">=</span> tempfile.NamedTemporaryFile(mode<span class="op">=</span><span class="st">&#39;w&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>, </span>
<span id="cb18-59"><a href="#cb18-59" aria-hidden="true" tabindex="-1"></a>                                                   suffix<span class="op">=</span><span class="st">&#39;.html&#39;</span>, delete<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb18-60"><a href="#cb18-60" aria-hidden="true" tabindex="-1"></a>            temp_file.write(content)</span>
<span id="cb18-61"><a href="#cb18-61" aria-hidden="true" tabindex="-1"></a>            temp_file.close()</span>
<span id="cb18-62"><a href="#cb18-62" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb18-63"><a href="#cb18-63" aria-hidden="true" tabindex="-1"></a>            logger.info(<span class="ss">f&quot;Arquivo HTML limpo criado: </span><span class="sc">{</span>temp_file<span class="sc">.</span>name<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb18-64"><a href="#cb18-64" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> temp_file.name</span>
<span id="cb18-65"><a href="#cb18-65" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb18-66"><a href="#cb18-66" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb18-67"><a href="#cb18-67" aria-hidden="true" tabindex="-1"></a>            logger.warning(<span class="ss">f&quot;Erro ao limpar HTML, usando original: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb18-68"><a href="#cb18-68" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> input_html</span>
<span id="cb18-69"><a href="#cb18-69" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-70"><a href="#cb18-70" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> get_custom_styles(<span class="va">self</span>):</span>
<span id="cb18-71"><a href="#cb18-71" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Retorna CSS customizado para melhor renderiza√ß√£o&quot;&quot;&quot;</span></span>
<span id="cb18-72"><a href="#cb18-72" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> CSS(string<span class="op">=</span><span class="st">&#39;&#39;&#39;</span></span>
<span id="cb18-73"><a href="#cb18-73" aria-hidden="true" tabindex="-1"></a><span class="st">            @page {</span></span>
<span id="cb18-74"><a href="#cb18-74" aria-hidden="true" tabindex="-1"></a><span class="st">                size: A4;</span></span>
<span id="cb18-75"><a href="#cb18-75" aria-hidden="true" tabindex="-1"></a><span class="st">                margin: 2cm;</span></span>
<span id="cb18-76"><a href="#cb18-76" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb18-77"><a href="#cb18-77" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb18-78"><a href="#cb18-78" aria-hidden="true" tabindex="-1"></a><span class="st">            @page :first {</span></span>
<span id="cb18-79"><a href="#cb18-79" aria-hidden="true" tabindex="-1"></a><span class="st">                @top-left {</span></span>
<span id="cb18-80"><a href="#cb18-80" aria-hidden="true" tabindex="-1"></a><span class="st">                    content: &quot;Documento HTML&quot;;</span></span>
<span id="cb18-81"><a href="#cb18-81" aria-hidden="true" tabindex="-1"></a><span class="st">                    font-size: 10px;</span></span>
<span id="cb18-82"><a href="#cb18-82" aria-hidden="true" tabindex="-1"></a><span class="st">                    color: #666;</span></span>
<span id="cb18-83"><a href="#cb18-83" aria-hidden="true" tabindex="-1"></a><span class="st">                }</span></span>
<span id="cb18-84"><a href="#cb18-84" aria-hidden="true" tabindex="-1"></a><span class="st">                @bottom-right {</span></span>
<span id="cb18-85"><a href="#cb18-85" aria-hidden="true" tabindex="-1"></a><span class="st">                    content: &quot;P√°gina &quot; counter(page);</span></span>
<span id="cb18-86"><a href="#cb18-86" aria-hidden="true" tabindex="-1"></a><span class="st">                    font-size: 10px;</span></span>
<span id="cb18-87"><a href="#cb18-87" aria-hidden="true" tabindex="-1"></a><span class="st">                    color: #666;</span></span>
<span id="cb18-88"><a href="#cb18-88" aria-hidden="true" tabindex="-1"></a><span class="st">                }</span></span>
<span id="cb18-89"><a href="#cb18-89" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb18-90"><a href="#cb18-90" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb18-91"><a href="#cb18-91" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Estilos gerais do corpo */</span></span>
<span id="cb18-92"><a href="#cb18-92" aria-hidden="true" tabindex="-1"></a><span class="st">            body {</span></span>
<span id="cb18-93"><a href="#cb18-93" aria-hidden="true" tabindex="-1"></a><span class="st">                font-family: &quot;Arial&quot;, &quot;DejaVu Sans&quot;, &quot;Liberation Sans&quot;, sans-serif;</span></span>
<span id="cb18-94"><a href="#cb18-94" aria-hidden="true" tabindex="-1"></a><span class="st">                line-height: 1.6;</span></span>
<span id="cb18-95"><a href="#cb18-95" aria-hidden="true" tabindex="-1"></a><span class="st">                color: #333;</span></span>
<span id="cb18-96"><a href="#cb18-96" aria-hidden="true" tabindex="-1"></a><span class="st">                max-width: 100%;</span></span>
<span id="cb18-97"><a href="#cb18-97" aria-hidden="true" tabindex="-1"></a><span class="st">                margin: 0 auto;</span></span>
<span id="cb18-98"><a href="#cb18-98" aria-hidden="true" tabindex="-1"></a><span class="st">                padding: 20px;</span></span>
<span id="cb18-99"><a href="#cb18-99" aria-hidden="true" tabindex="-1"></a><span class="st">                font-size: 12px;</span></span>
<span id="cb18-100"><a href="#cb18-100" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb18-101"><a href="#cb18-101" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb18-102"><a href="#cb18-102" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Cabe√ßalhos */</span></span>
<span id="cb18-103"><a href="#cb18-103" aria-hidden="true" tabindex="-1"></a><span class="st">            h1, h2, h3, h4, h5, h6 {</span></span>
<span id="cb18-104"><a href="#cb18-104" aria-hidden="true" tabindex="-1"></a><span class="st">                color: #1565C0;</span></span>
<span id="cb18-105"><a href="#cb18-105" aria-hidden="true" tabindex="-1"></a><span class="st">                margin-top: 1.2em;</span></span>
<span id="cb18-106"><a href="#cb18-106" aria-hidden="true" tabindex="-1"></a><span class="st">                margin-bottom: 0.5em;</span></span>
<span id="cb18-107"><a href="#cb18-107" aria-hidden="true" tabindex="-1"></a><span class="st">                page-break-after: avoid;</span></span>
<span id="cb18-108"><a href="#cb18-108" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb18-109"><a href="#cb18-109" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb18-110"><a href="#cb18-110" aria-hidden="true" tabindex="-1"></a><span class="st">            h1 {</span></span>
<span id="cb18-111"><a href="#cb18-111" aria-hidden="true" tabindex="-1"></a><span class="st">                font-size: 18px;</span></span>
<span id="cb18-112"><a href="#cb18-112" aria-hidden="true" tabindex="-1"></a><span class="st">                border-bottom: 2px solid #1565C0;</span></span>
<span id="cb18-113"><a href="#cb18-113" aria-hidden="true" tabindex="-1"></a><span class="st">                padding-bottom: 0.3em;</span></span>
<span id="cb18-114"><a href="#cb18-114" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb18-115"><a href="#cb18-115" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb18-116"><a href="#cb18-116" aria-hidden="true" tabindex="-1"></a><span class="st">            h2 {</span></span>
<span id="cb18-117"><a href="#cb18-117" aria-hidden="true" tabindex="-1"></a><span class="st">                font-size: 16px;</span></span>
<span id="cb18-118"><a href="#cb18-118" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb18-119"><a href="#cb18-119" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb18-120"><a href="#cb18-120" aria-hidden="true" tabindex="-1"></a><span class="st">            h3 {</span></span>
<span id="cb18-121"><a href="#cb18-121" aria-hidden="true" tabindex="-1"></a><span class="st">                font-size: 14px;</span></span>
<span id="cb18-122"><a href="#cb18-122" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb18-123"><a href="#cb18-123" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb18-124"><a href="#cb18-124" aria-hidden="true" tabindex="-1"></a><span class="st">            /* C√≥digo e blocos de c√≥digo */</span></span>
<span id="cb18-125"><a href="#cb18-125" aria-hidden="true" tabindex="-1"></a><span class="st">            pre, code {</span></span>
<span id="cb18-126"><a href="#cb18-126" aria-hidden="true" tabindex="-1"></a><span class="st">                font-family: &quot;Consolas&quot;, &quot;Monaco&quot;, &quot;Courier New&quot;, monospace;</span></span>
<span id="cb18-127"><a href="#cb18-127" aria-hidden="true" tabindex="-1"></a><span class="st">                background-color: #f6f8fa !important;</span></span>
<span id="cb18-128"><a href="#cb18-128" aria-hidden="true" tabindex="-1"></a><span class="st">                border: 1px solid #e1e4e8;</span></span>
<span id="cb18-129"><a href="#cb18-129" aria-hidden="true" tabindex="-1"></a><span class="st">                border-radius: 5px;</span></span>
<span id="cb18-130"><a href="#cb18-130" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb18-131"><a href="#cb18-131" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb18-132"><a href="#cb18-132" aria-hidden="true" tabindex="-1"></a><span class="st">            pre {</span></span>
<span id="cb18-133"><a href="#cb18-133" aria-hidden="true" tabindex="-1"></a><span class="st">                padding: 12px;</span></span>
<span id="cb18-134"><a href="#cb18-134" aria-hidden="true" tabindex="-1"></a><span class="st">                overflow: auto;</span></span>
<span id="cb18-135"><a href="#cb18-135" aria-hidden="true" tabindex="-1"></a><span class="st">                page-break-inside: avoid;</span></span>
<span id="cb18-136"><a href="#cb18-136" aria-hidden="true" tabindex="-1"></a><span class="st">                font-size: 11px;</span></span>
<span id="cb18-137"><a href="#cb18-137" aria-hidden="true" tabindex="-1"></a><span class="st">                white-space: pre-wrap;</span></span>
<span id="cb18-138"><a href="#cb18-138" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb18-139"><a href="#cb18-139" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb18-140"><a href="#cb18-140" aria-hidden="true" tabindex="-1"></a><span class="st">            code {</span></span>
<span id="cb18-141"><a href="#cb18-141" aria-hidden="true" tabindex="-1"></a><span class="st">                padding: 2px 4px;</span></span>
<span id="cb18-142"><a href="#cb18-142" aria-hidden="true" tabindex="-1"></a><span class="st">                font-size: 11px;</span></span>
<span id="cb18-143"><a href="#cb18-143" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb18-144"><a href="#cb18-144" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb18-145"><a href="#cb18-145" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Blocos de c√≥digo com syntax highlighting */</span></span>
<span id="cb18-146"><a href="#cb18-146" aria-hidden="true" tabindex="-1"></a><span class="st">            div.sourceCode {</span></span>
<span id="cb18-147"><a href="#cb18-147" aria-hidden="true" tabindex="-1"></a><span class="st">                margin: 1em 0;</span></span>
<span id="cb18-148"><a href="#cb18-148" aria-hidden="true" tabindex="-1"></a><span class="st">                page-break-inside: avoid;</span></span>
<span id="cb18-149"><a href="#cb18-149" aria-hidden="true" tabindex="-1"></a><span class="st">                background-color: #f6f8fa;</span></span>
<span id="cb18-150"><a href="#cb18-150" aria-hidden="true" tabindex="-1"></a><span class="st">                border-radius: 5px;</span></span>
<span id="cb18-151"><a href="#cb18-151" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb18-152"><a href="#cb18-152" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb18-153"><a href="#cb18-153" aria-hidden="true" tabindex="-1"></a><span class="st">            pre.sourceCode {</span></span>
<span id="cb18-154"><a href="#cb18-154" aria-hidden="true" tabindex="-1"></a><span class="st">                margin: 0;</span></span>
<span id="cb18-155"><a href="#cb18-155" aria-hidden="true" tabindex="-1"></a><span class="st">                background-color: transparent;</span></span>
<span id="cb18-156"><a href="#cb18-156" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb18-157"><a href="#cb18-157" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb18-158"><a href="#cb18-158" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Syntax highlighting colors */</span></span>
<span id="cb18-159"><a href="#cb18-159" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode span.al { color: #ff0000; font-weight: bold; }</span></span>
<span id="cb18-160"><a href="#cb18-160" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode span.an { color: #60a0b0; font-weight: bold; font-style: italic; }</span></span>
<span id="cb18-161"><a href="#cb18-161" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode span.at { color: #7d9029; }</span></span>
<span id="cb18-162"><a href="#cb18-162" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode span.bn { color: #40a070; }</span></span>
<span id="cb18-163"><a href="#cb18-163" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode span.bu { color: #008000; }</span></span>
<span id="cb18-164"><a href="#cb18-164" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode span.cf { color: #007020; font-weight: bold; }</span></span>
<span id="cb18-165"><a href="#cb18-165" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode span.ch { color: #4070a0; }</span></span>
<span id="cb18-166"><a href="#cb18-166" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode span.cn { color: #880000; }</span></span>
<span id="cb18-167"><a href="#cb18-167" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode span.co { color: #60a0b0; font-style: italic; }</span></span>
<span id="cb18-168"><a href="#cb18-168" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode span.cv { color: #60a0b0; font-weight: bold; font-style: italic; }</span></span>
<span id="cb18-169"><a href="#cb18-169" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode span.do { color: #ba2121; font-style: italic; }</span></span>
<span id="cb18-170"><a href="#cb18-170" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode span.dt { color: #902000; }</span></span>
<span id="cb18-171"><a href="#cb18-171" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode span.dv { color: #40a070; }</span></span>
<span id="cb18-172"><a href="#cb18-172" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode span.er { color: #ff0000; font-weight: bold; }</span></span>
<span id="cb18-173"><a href="#cb18-173" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode span.ex { color: #007020; }</span></span>
<span id="cb18-174"><a href="#cb18-174" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode span.fl { color: #40a070; }</span></span>
<span id="cb18-175"><a href="#cb18-175" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode span.fu { color: #06287e; }</span></span>
<span id="cb18-176"><a href="#cb18-176" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode span.im { color: #008000; font-weight: bold; }</span></span>
<span id="cb18-177"><a href="#cb18-177" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode span.in { color: #60a0b0; font-weight: bold; font-style: italic; }</span></span>
<span id="cb18-178"><a href="#cb18-178" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode span.kw { color: #007020; font-weight: bold; }</span></span>
<span id="cb18-179"><a href="#cb18-179" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode span.op { color: #666666; }</span></span>
<span id="cb18-180"><a href="#cb18-180" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode span.ot { color: #007020; }</span></span>
<span id="cb18-181"><a href="#cb18-181" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode span.pp { color: #bc7a00; }</span></span>
<span id="cb18-182"><a href="#cb18-182" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode span.sc { color: #4070a0; }</span></span>
<span id="cb18-183"><a href="#cb18-183" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode span.ss { color: #bb6688; }</span></span>
<span id="cb18-184"><a href="#cb18-184" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode span.st { color: #4070a0; }</span></span>
<span id="cb18-185"><a href="#cb18-185" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode span.va { color: #19177c; }</span></span>
<span id="cb18-186"><a href="#cb18-186" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode span.vs { color: #4070a0; }</span></span>
<span id="cb18-187"><a href="#cb18-187" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode span.wa { color: #60a0b0; font-weight: bold; font-style: italic; }</span></span>
<span id="cb18-188"><a href="#cb18-188" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb18-189"><a href="#cb18-189" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Tabelas */</span></span>
<span id="cb18-190"><a href="#cb18-190" aria-hidden="true" tabindex="-1"></a><span class="st">            table {</span></span>
<span id="cb18-191"><a href="#cb18-191" aria-hidden="true" tabindex="-1"></a><span class="st">                border-collapse: collapse;</span></span>
<span id="cb18-192"><a href="#cb18-192" aria-hidden="true" tabindex="-1"></a><span class="st">                width: 100%;</span></span>
<span id="cb18-193"><a href="#cb18-193" aria-hidden="true" tabindex="-1"></a><span class="st">                margin: 1em 0;</span></span>
<span id="cb18-194"><a href="#cb18-194" aria-hidden="true" tabindex="-1"></a><span class="st">                page-break-inside: avoid;</span></span>
<span id="cb18-195"><a href="#cb18-195" aria-hidden="true" tabindex="-1"></a><span class="st">                font-size: 11px;</span></span>
<span id="cb18-196"><a href="#cb18-196" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb18-197"><a href="#cb18-197" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb18-198"><a href="#cb18-198" aria-hidden="true" tabindex="-1"></a><span class="st">            th, td {</span></span>
<span id="cb18-199"><a href="#cb18-199" aria-hidden="true" tabindex="-1"></a><span class="st">                border: 1px solid #ddd;</span></span>
<span id="cb18-200"><a href="#cb18-200" aria-hidden="true" tabindex="-1"></a><span class="st">                padding: 6px 10px;</span></span>
<span id="cb18-201"><a href="#cb18-201" aria-hidden="true" tabindex="-1"></a><span class="st">                text-align: left;</span></span>
<span id="cb18-202"><a href="#cb18-202" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb18-203"><a href="#cb18-203" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb18-204"><a href="#cb18-204" aria-hidden="true" tabindex="-1"></a><span class="st">            th {</span></span>
<span id="cb18-205"><a href="#cb18-205" aria-hidden="true" tabindex="-1"></a><span class="st">                background-color: #f2f2f2;</span></span>
<span id="cb18-206"><a href="#cb18-206" aria-hidden="true" tabindex="-1"></a><span class="st">                font-weight: bold;</span></span>
<span id="cb18-207"><a href="#cb18-207" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb18-208"><a href="#cb18-208" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb18-209"><a href="#cb18-209" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Cita√ß√µes */</span></span>
<span id="cb18-210"><a href="#cb18-210" aria-hidden="true" tabindex="-1"></a><span class="st">            blockquote {</span></span>
<span id="cb18-211"><a href="#cb18-211" aria-hidden="true" tabindex="-1"></a><span class="st">                background-color: #f9f9f9;</span></span>
<span id="cb18-212"><a href="#cb18-212" aria-hidden="true" tabindex="-1"></a><span class="st">                border-left: 4px solid #ccc;</span></span>
<span id="cb18-213"><a href="#cb18-213" aria-hidden="true" tabindex="-1"></a><span class="st">                margin: 1em 0;</span></span>
<span id="cb18-214"><a href="#cb18-214" aria-hidden="true" tabindex="-1"></a><span class="st">                padding: 0.5em 1em;</span></span>
<span id="cb18-215"><a href="#cb18-215" aria-hidden="true" tabindex="-1"></a><span class="st">                font-style: italic;</span></span>
<span id="cb18-216"><a href="#cb18-216" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb18-217"><a href="#cb18-217" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb18-218"><a href="#cb18-218" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Listas */</span></span>
<span id="cb18-219"><a href="#cb18-219" aria-hidden="true" tabindex="-1"></a><span class="st">            ul, ol {</span></span>
<span id="cb18-220"><a href="#cb18-220" aria-hidden="true" tabindex="-1"></a><span class="st">                margin: 1em 0;</span></span>
<span id="cb18-221"><a href="#cb18-221" aria-hidden="true" tabindex="-1"></a><span class="st">                padding-left: 1.5em;</span></span>
<span id="cb18-222"><a href="#cb18-222" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb18-223"><a href="#cb18-223" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb18-224"><a href="#cb18-224" aria-hidden="true" tabindex="-1"></a><span class="st">            li {</span></span>
<span id="cb18-225"><a href="#cb18-225" aria-hidden="true" tabindex="-1"></a><span class="st">                margin: 0.3em 0;</span></span>
<span id="cb18-226"><a href="#cb18-226" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb18-227"><a href="#cb18-227" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb18-228"><a href="#cb18-228" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Links */</span></span>
<span id="cb18-229"><a href="#cb18-229" aria-hidden="true" tabindex="-1"></a><span class="st">            a {</span></span>
<span id="cb18-230"><a href="#cb18-230" aria-hidden="true" tabindex="-1"></a><span class="st">                color: #0366d6;</span></span>
<span id="cb18-231"><a href="#cb18-231" aria-hidden="true" tabindex="-1"></a><span class="st">                text-decoration: none;</span></span>
<span id="cb18-232"><a href="#cb18-232" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb18-233"><a href="#cb18-233" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb18-234"><a href="#cb18-234" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Imagens */</span></span>
<span id="cb18-235"><a href="#cb18-235" aria-hidden="true" tabindex="-1"></a><span class="st">            img {</span></span>
<span id="cb18-236"><a href="#cb18-236" aria-hidden="true" tabindex="-1"></a><span class="st">                max-width: 100%;</span></span>
<span id="cb18-237"><a href="#cb18-237" aria-hidden="true" tabindex="-1"></a><span class="st">                height: auto;</span></span>
<span id="cb18-238"><a href="#cb18-238" aria-hidden="true" tabindex="-1"></a><span class="st">                page-break-inside: avoid;</span></span>
<span id="cb18-239"><a href="#cb18-239" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb18-240"><a href="#cb18-240" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb18-241"><a href="#cb18-241" aria-hidden="true" tabindex="-1"></a><span class="st">            figure {</span></span>
<span id="cb18-242"><a href="#cb18-242" aria-hidden="true" tabindex="-1"></a><span class="st">                margin: 1em 0;</span></span>
<span id="cb18-243"><a href="#cb18-243" aria-hidden="true" tabindex="-1"></a><span class="st">                text-align: center;</span></span>
<span id="cb18-244"><a href="#cb18-244" aria-hidden="true" tabindex="-1"></a><span class="st">                page-break-inside: avoid;</span></span>
<span id="cb18-245"><a href="#cb18-245" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb18-246"><a href="#cb18-246" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb18-247"><a href="#cb18-247" aria-hidden="true" tabindex="-1"></a><span class="st">            figcaption {</span></span>
<span id="cb18-248"><a href="#cb18-248" aria-hidden="true" tabindex="-1"></a><span class="st">                font-size: 0.8em;</span></span>
<span id="cb18-249"><a href="#cb18-249" aria-hidden="true" tabindex="-1"></a><span class="st">                color: #666;</span></span>
<span id="cb18-250"><a href="#cb18-250" aria-hidden="true" tabindex="-1"></a><span class="st">                margin-top: 0.5em;</span></span>
<span id="cb18-251"><a href="#cb18-251" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb18-252"><a href="#cb18-252" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb18-253"><a href="#cb18-253" aria-hidden="true" tabindex="-1"></a><span class="st">            /* F√≥rmulas matem√°ticas */</span></span>
<span id="cb18-254"><a href="#cb18-254" aria-hidden="true" tabindex="-1"></a><span class="st">            .math {</span></span>
<span id="cb18-255"><a href="#cb18-255" aria-hidden="true" tabindex="-1"></a><span class="st">                text-align: center;</span></span>
<span id="cb18-256"><a href="#cb18-256" aria-hidden="true" tabindex="-1"></a><span class="st">                margin: 1em 0;</span></span>
<span id="cb18-257"><a href="#cb18-257" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb18-258"><a href="#cb18-258" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb18-259"><a href="#cb18-259" aria-hidden="true" tabindex="-1"></a><span class="st">            .math.display {</span></span>
<span id="cb18-260"><a href="#cb18-260" aria-hidden="true" tabindex="-1"></a><span class="st">                display: block;</span></span>
<span id="cb18-261"><a href="#cb18-261" aria-hidden="true" tabindex="-1"></a><span class="st">                margin: 1.5em 0;</span></span>
<span id="cb18-262"><a href="#cb18-262" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb18-263"><a href="#cb18-263" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb18-264"><a href="#cb18-264" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Linhas horizontais */</span></span>
<span id="cb18-265"><a href="#cb18-265" aria-hidden="true" tabindex="-1"></a><span class="st">            hr {</span></span>
<span id="cb18-266"><a href="#cb18-266" aria-hidden="true" tabindex="-1"></a><span class="st">                border: none;</span></span>
<span id="cb18-267"><a href="#cb18-267" aria-hidden="true" tabindex="-1"></a><span class="st">                border-top: 2px solid #eee;</span></span>
<span id="cb18-268"><a href="#cb18-268" aria-hidden="true" tabindex="-1"></a><span class="st">                margin: 1.5em 0;</span></span>
<span id="cb18-269"><a href="#cb18-269" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb18-270"><a href="#cb18-270" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb18-271"><a href="#cb18-271" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Evitar quebra de p√°gina em elementos importantes */</span></span>
<span id="cb18-272"><a href="#cb18-272" aria-hidden="true" tabindex="-1"></a><span class="st">            h1, h2, h3 {</span></span>
<span id="cb18-273"><a href="#cb18-273" aria-hidden="true" tabindex="-1"></a><span class="st">                page-break-after: avoid;</span></span>
<span id="cb18-274"><a href="#cb18-274" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb18-275"><a href="#cb18-275" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb18-276"><a href="#cb18-276" aria-hidden="true" tabindex="-1"></a><span class="st">            pre, table, figure, .math {</span></span>
<span id="cb18-277"><a href="#cb18-277" aria-hidden="true" tabindex="-1"></a><span class="st">                page-break-inside: avoid;</span></span>
<span id="cb18-278"><a href="#cb18-278" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb18-279"><a href="#cb18-279" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb18-280"><a href="#cb18-280" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Garantir que cores de fundo sejam impressas */</span></span>
<span id="cb18-281"><a href="#cb18-281" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode, pre, code {</span></span>
<span id="cb18-282"><a href="#cb18-282" aria-hidden="true" tabindex="-1"></a><span class="st">                -webkit-print-color-adjust: exact !important;</span></span>
<span id="cb18-283"><a href="#cb18-283" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb18-284"><a href="#cb18-284" aria-hidden="true" tabindex="-1"></a><span class="st">        &#39;&#39;&#39;</span>)</span>
<span id="cb18-285"><a href="#cb18-285" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-286"><a href="#cb18-286" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> convert_html_to_pdf(<span class="va">self</span>, input_html, output_pdf<span class="op">=</span><span class="va">None</span>, base_url<span class="op">=</span><span class="va">None</span>, clean_html<span class="op">=</span><span class="va">True</span>):</span>
<span id="cb18-287"><a href="#cb18-287" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;</span></span>
<span id="cb18-288"><a href="#cb18-288" aria-hidden="true" tabindex="-1"></a><span class="co">        Converte arquivo HTML para PDF</span></span>
<span id="cb18-289"><a href="#cb18-289" aria-hidden="true" tabindex="-1"></a><span class="co">        </span></span>
<span id="cb18-290"><a href="#cb18-290" aria-hidden="true" tabindex="-1"></a><span class="co">        Args:</span></span>
<span id="cb18-291"><a href="#cb18-291" aria-hidden="true" tabindex="-1"></a><span class="co">            input_html (str): Caminho para arquivo HTML de entrada</span></span>
<span id="cb18-292"><a href="#cb18-292" aria-hidden="true" tabindex="-1"></a><span class="co">            output_pdf (str): Caminho para arquivo PDF de sa√≠da (opcional)</span></span>
<span id="cb18-293"><a href="#cb18-293" aria-hidden="true" tabindex="-1"></a><span class="co">            base_url (str): URL base para recursos externos (opcional)</span></span>
<span id="cb18-294"><a href="#cb18-294" aria-hidden="true" tabindex="-1"></a><span class="co">            clean_html (bool): Se deve limpar o HTML antes da convers√£o</span></span>
<span id="cb18-295"><a href="#cb18-295" aria-hidden="true" tabindex="-1"></a><span class="co">        </span></span>
<span id="cb18-296"><a href="#cb18-296" aria-hidden="true" tabindex="-1"></a><span class="co">        Returns:</span></span>
<span id="cb18-297"><a href="#cb18-297" aria-hidden="true" tabindex="-1"></a><span class="co">            str: Caminho do arquivo PDF gerado</span></span>
<span id="cb18-298"><a href="#cb18-298" aria-hidden="true" tabindex="-1"></a><span class="co">        &quot;&quot;&quot;</span></span>
<span id="cb18-299"><a href="#cb18-299" aria-hidden="true" tabindex="-1"></a>        temp_file <span class="op">=</span> <span class="va">None</span></span>
<span id="cb18-300"><a href="#cb18-300" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb18-301"><a href="#cb18-301" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Verificar se arquivo de entrada existe</span></span>
<span id="cb18-302"><a href="#cb18-302" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> os.path.exists(input_html):</span>
<span id="cb18-303"><a href="#cb18-303" aria-hidden="true" tabindex="-1"></a>                <span class="cf">raise</span> <span class="pp">FileNotFoundError</span>(<span class="ss">f&quot;Arquivo de entrada n√£o encontrado: </span><span class="sc">{</span>input_html<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb18-304"><a href="#cb18-304" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb18-305"><a href="#cb18-305" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Limpar HTML se necess√°rio</span></span>
<span id="cb18-306"><a href="#cb18-306" aria-hidden="true" tabindex="-1"></a>            html_to_convert <span class="op">=</span> input_html</span>
<span id="cb18-307"><a href="#cb18-307" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> clean_html:</span>
<span id="cb18-308"><a href="#cb18-308" aria-hidden="true" tabindex="-1"></a>                html_to_convert <span class="op">=</span> <span class="va">self</span>._clean_html_file(input_html)</span>
<span id="cb18-309"><a href="#cb18-309" aria-hidden="true" tabindex="-1"></a>                temp_file <span class="op">=</span> html_to_convert</span>
<span id="cb18-310"><a href="#cb18-310" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb18-311"><a href="#cb18-311" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Gerar nome do arquivo de sa√≠da se n√£o fornecido</span></span>
<span id="cb18-312"><a href="#cb18-312" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> output_pdf <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb18-313"><a href="#cb18-313" aria-hidden="true" tabindex="-1"></a>                input_path <span class="op">=</span> Path(input_html)</span>
<span id="cb18-314"><a href="#cb18-314" aria-hidden="true" tabindex="-1"></a>                output_pdf <span class="op">=</span> Path(<span class="va">self</span>.output_dir) <span class="op">/</span> <span class="ss">f&quot;</span><span class="sc">{</span>input_path<span class="sc">.</span>stem<span class="sc">}</span><span class="ss">.pdf&quot;</span></span>
<span id="cb18-315"><a href="#cb18-315" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb18-316"><a href="#cb18-316" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Garantir que o diret√≥rio de sa√≠da existe</span></span>
<span id="cb18-317"><a href="#cb18-317" aria-hidden="true" tabindex="-1"></a>            Path(output_pdf).parent.mkdir(parents<span class="op">=</span><span class="va">True</span>, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb18-318"><a href="#cb18-318" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb18-319"><a href="#cb18-319" aria-hidden="true" tabindex="-1"></a>            logger.info(<span class="ss">f&quot;Convertendo </span><span class="sc">{</span>input_html<span class="sc">}</span><span class="ss"> para </span><span class="sc">{</span>output_pdf<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb18-320"><a href="#cb18-320" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb18-321"><a href="#cb18-321" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Carregar estilos customizados</span></span>
<span id="cb18-322"><a href="#cb18-322" aria-hidden="true" tabindex="-1"></a>            stylesheets <span class="op">=</span> [<span class="va">self</span>.get_custom_styles()]</span>
<span id="cb18-323"><a href="#cb18-323" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb18-324"><a href="#cb18-324" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Configurar base_url</span></span>
<span id="cb18-325"><a href="#cb18-325" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> base_url <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb18-326"><a href="#cb18-326" aria-hidden="true" tabindex="-1"></a>                base_url <span class="op">=</span> os.path.dirname(os.path.abspath(input_html))</span>
<span id="cb18-327"><a href="#cb18-327" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb18-328"><a href="#cb18-328" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Converter HTML para PDF - API compat√≠vel com WeasyPrint 60.0+</span></span>
<span id="cb18-329"><a href="#cb18-329" aria-hidden="true" tabindex="-1"></a>            html_obj <span class="op">=</span> HTML(filename<span class="op">=</span>html_to_convert, base_url<span class="op">=</span>base_url)</span>
<span id="cb18-330"><a href="#cb18-330" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb18-331"><a href="#cb18-331" aria-hidden="true" tabindex="-1"></a>            <span class="co"># M√©todo compat√≠vel com vers√µes recentes do WeasyPrint</span></span>
<span id="cb18-332"><a href="#cb18-332" aria-hidden="true" tabindex="-1"></a>            html_obj.write_pdf(target<span class="op">=</span>output_pdf, stylesheets<span class="op">=</span>stylesheets)</span>
<span id="cb18-333"><a href="#cb18-333" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb18-334"><a href="#cb18-334" aria-hidden="true" tabindex="-1"></a>            logger.info(<span class="ss">f&quot;‚úÖ Convers√£o conclu√≠da: </span><span class="sc">{</span>output_pdf<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb18-335"><a href="#cb18-335" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="bu">str</span>(output_pdf)</span>
<span id="cb18-336"><a href="#cb18-336" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb18-337"><a href="#cb18-337" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb18-338"><a href="#cb18-338" aria-hidden="true" tabindex="-1"></a>            logger.error(<span class="ss">f&quot;‚ùå Erro na convers√£o: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb18-339"><a href="#cb18-339" aria-hidden="true" tabindex="-1"></a>            <span class="cf">raise</span></span>
<span id="cb18-340"><a href="#cb18-340" aria-hidden="true" tabindex="-1"></a>        <span class="cf">finally</span>:</span>
<span id="cb18-341"><a href="#cb18-341" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Limpar arquivo tempor√°rio se existir</span></span>
<span id="cb18-342"><a href="#cb18-342" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> temp_file <span class="kw">and</span> temp_file <span class="op">!=</span> input_html <span class="kw">and</span> os.path.exists(temp_file):</span>
<span id="cb18-343"><a href="#cb18-343" aria-hidden="true" tabindex="-1"></a>                <span class="cf">try</span>:</span>
<span id="cb18-344"><a href="#cb18-344" aria-hidden="true" tabindex="-1"></a>                    os.unlink(temp_file)</span>
<span id="cb18-345"><a href="#cb18-345" aria-hidden="true" tabindex="-1"></a>                <span class="cf">except</span>:</span>
<span id="cb18-346"><a href="#cb18-346" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">pass</span></span>
<span id="cb18-347"><a href="#cb18-347" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-348"><a href="#cb18-348" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> convert_multiple_files(<span class="va">self</span>, html_files, output_dir<span class="op">=</span><span class="va">None</span>, clean_html<span class="op">=</span><span class="va">True</span>):</span>
<span id="cb18-349"><a href="#cb18-349" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;</span></span>
<span id="cb18-350"><a href="#cb18-350" aria-hidden="true" tabindex="-1"></a><span class="co">        Converte m√∫ltiplos arquivos HTML para PDF</span></span>
<span id="cb18-351"><a href="#cb18-351" aria-hidden="true" tabindex="-1"></a><span class="co">        </span></span>
<span id="cb18-352"><a href="#cb18-352" aria-hidden="true" tabindex="-1"></a><span class="co">        Args:</span></span>
<span id="cb18-353"><a href="#cb18-353" aria-hidden="true" tabindex="-1"></a><span class="co">            html_files (list): Lista de caminhos para arquivos HTML</span></span>
<span id="cb18-354"><a href="#cb18-354" aria-hidden="true" tabindex="-1"></a><span class="co">            output_dir (str): Diret√≥rio de sa√≠da (opcional)</span></span>
<span id="cb18-355"><a href="#cb18-355" aria-hidden="true" tabindex="-1"></a><span class="co">            clean_html (bool): Se deve limpar o HTML antes da convers√£o</span></span>
<span id="cb18-356"><a href="#cb18-356" aria-hidden="true" tabindex="-1"></a><span class="co">        </span></span>
<span id="cb18-357"><a href="#cb18-357" aria-hidden="true" tabindex="-1"></a><span class="co">        Returns:</span></span>
<span id="cb18-358"><a href="#cb18-358" aria-hidden="true" tabindex="-1"></a><span class="co">            list: Lista de arquivos PDF gerados</span></span>
<span id="cb18-359"><a href="#cb18-359" aria-hidden="true" tabindex="-1"></a><span class="co">        &quot;&quot;&quot;</span></span>
<span id="cb18-360"><a href="#cb18-360" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> output_dir:</span>
<span id="cb18-361"><a href="#cb18-361" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.output_dir <span class="op">=</span> output_dir</span>
<span id="cb18-362"><a href="#cb18-362" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>._ensure_output_dir()</span>
<span id="cb18-363"><a href="#cb18-363" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb18-364"><a href="#cb18-364" aria-hidden="true" tabindex="-1"></a>        pdf_files <span class="op">=</span> []</span>
<span id="cb18-365"><a href="#cb18-365" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> html_file <span class="kw">in</span> html_files:</span>
<span id="cb18-366"><a href="#cb18-366" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb18-367"><a href="#cb18-367" aria-hidden="true" tabindex="-1"></a>                pdf_file <span class="op">=</span> <span class="va">self</span>.convert_html_to_pdf(html_file, clean_html<span class="op">=</span>clean_html)</span>
<span id="cb18-368"><a href="#cb18-368" aria-hidden="true" tabindex="-1"></a>                pdf_files.append(pdf_file)</span>
<span id="cb18-369"><a href="#cb18-369" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb18-370"><a href="#cb18-370" aria-hidden="true" tabindex="-1"></a>                logger.error(<span class="ss">f&quot;Falha ao converter </span><span class="sc">{</span>html_file<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb18-371"><a href="#cb18-371" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span></span>
<span id="cb18-372"><a href="#cb18-372" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb18-373"><a href="#cb18-373" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> pdf_files</span>
<span id="cb18-374"><a href="#cb18-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-375"><a href="#cb18-375" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> suppress_fontconfig_warnings():</span>
<span id="cb18-376"><a href="#cb18-376" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Suprime avisos do Fontconfig no Windows&quot;&quot;&quot;</span></span>
<span id="cb18-377"><a href="#cb18-377" aria-hidden="true" tabindex="-1"></a>    <span class="im">import</span> warnings</span>
<span id="cb18-378"><a href="#cb18-378" aria-hidden="true" tabindex="-1"></a>    warnings.filterwarnings(<span class="st">&quot;ignore&quot;</span>, category<span class="op">=</span><span class="pp">UserWarning</span>, module<span class="op">=</span><span class="st">&quot;weasyprint&quot;</span>)</span>
<span id="cb18-379"><a href="#cb18-379" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-380"><a href="#cb18-380" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Tamb√©m suprimir avisos espec√≠ficos do CSS</span></span>
<span id="cb18-381"><a href="#cb18-381" aria-hidden="true" tabindex="-1"></a>    warnings.filterwarnings(<span class="st">&quot;ignore&quot;</span>, message<span class="op">=</span><span class="st">&quot;Ignored.*unknown property&quot;</span>)</span>
<span id="cb18-382"><a href="#cb18-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-383"><a href="#cb18-383" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> check_weasyprint_version():</span>
<span id="cb18-384"><a href="#cb18-384" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Verifica a vers√£o do WeasyPrint e ajusta compatibilidade&quot;&quot;&quot;</span></span>
<span id="cb18-385"><a href="#cb18-385" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb18-386"><a href="#cb18-386" aria-hidden="true" tabindex="-1"></a>        <span class="im">import</span> weasyprint</span>
<span id="cb18-387"><a href="#cb18-387" aria-hidden="true" tabindex="-1"></a>        version <span class="op">=</span> weasyprint.__version__</span>
<span id="cb18-388"><a href="#cb18-388" aria-hidden="true" tabindex="-1"></a>        logger.info(<span class="ss">f&quot;Usando WeasyPrint vers√£o </span><span class="sc">{</span>version<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb18-389"><a href="#cb18-389" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> version</span>
<span id="cb18-390"><a href="#cb18-390" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">ImportError</span>:</span>
<span id="cb18-391"><a href="#cb18-391" aria-hidden="true" tabindex="-1"></a>        logger.error(<span class="st">&quot;WeasyPrint n√£o est√° instalado&quot;</span>)</span>
<span id="cb18-392"><a href="#cb18-392" aria-hidden="true" tabindex="-1"></a>        sys.exit(<span class="dv">1</span>)</span>
<span id="cb18-393"><a href="#cb18-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-394"><a href="#cb18-394" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> main():</span>
<span id="cb18-395"><a href="#cb18-395" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Fun√ß√£o principal para execu√ß√£o via linha de comando&quot;&quot;&quot;</span></span>
<span id="cb18-396"><a href="#cb18-396" aria-hidden="true" tabindex="-1"></a>    parser <span class="op">=</span> argparse.ArgumentParser(description<span class="op">=</span><span class="st">&#39;Conversor de HTML para PDF&#39;</span>)</span>
<span id="cb18-397"><a href="#cb18-397" aria-hidden="true" tabindex="-1"></a>    parser.add_argument(<span class="st">&#39;input&#39;</span>, <span class="bu">help</span><span class="op">=</span><span class="st">&#39;Arquivo HTML de entrada ou diret√≥rio&#39;</span>)</span>
<span id="cb18-398"><a href="#cb18-398" aria-hidden="true" tabindex="-1"></a>    parser.add_argument(<span class="st">&#39;-o&#39;</span>, <span class="st">&#39;--output&#39;</span>, <span class="bu">help</span><span class="op">=</span><span class="st">&#39;Arquivo PDF de sa√≠da&#39;</span>)</span>
<span id="cb18-399"><a href="#cb18-399" aria-hidden="true" tabindex="-1"></a>    parser.add_argument(<span class="st">&#39;-d&#39;</span>, <span class="st">&#39;--output-dir&#39;</span>, default<span class="op">=</span><span class="st">&#39;output_pdfs&#39;</span>, </span>
<span id="cb18-400"><a href="#cb18-400" aria-hidden="true" tabindex="-1"></a>                       <span class="bu">help</span><span class="op">=</span><span class="st">&#39;Diret√≥rio de sa√≠da para m√∫ltiplos arquivos&#39;</span>)</span>
<span id="cb18-401"><a href="#cb18-401" aria-hidden="true" tabindex="-1"></a>    parser.add_argument(<span class="st">&#39;-b&#39;</span>, <span class="st">&#39;--base-url&#39;</span>, <span class="bu">help</span><span class="op">=</span><span class="st">&#39;URL base para recursos externos&#39;</span>)</span>
<span id="cb18-402"><a href="#cb18-402" aria-hidden="true" tabindex="-1"></a>    parser.add_argument(<span class="st">&#39;-v&#39;</span>, <span class="st">&#39;--verbose&#39;</span>, action<span class="op">=</span><span class="st">&#39;store_true&#39;</span>, </span>
<span id="cb18-403"><a href="#cb18-403" aria-hidden="true" tabindex="-1"></a>                       <span class="bu">help</span><span class="op">=</span><span class="st">&#39;Modo verboso&#39;</span>)</span>
<span id="cb18-404"><a href="#cb18-404" aria-hidden="true" tabindex="-1"></a>    parser.add_argument(<span class="st">&#39;--no-clean&#39;</span>, action<span class="op">=</span><span class="st">&#39;store_true&#39;</span>,</span>
<span id="cb18-405"><a href="#cb18-405" aria-hidden="true" tabindex="-1"></a>                       <span class="bu">help</span><span class="op">=</span><span class="st">&#39;N√£o limpar HTML antes da convers√£o&#39;</span>)</span>
<span id="cb18-406"><a href="#cb18-406" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-407"><a href="#cb18-407" aria-hidden="true" tabindex="-1"></a>    args <span class="op">=</span> parser.parse_args()</span>
<span id="cb18-408"><a href="#cb18-408" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-409"><a href="#cb18-409" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> args.verbose:</span>
<span id="cb18-410"><a href="#cb18-410" aria-hidden="true" tabindex="-1"></a>        logging.getLogger().setLevel(logging.DEBUG)</span>
<span id="cb18-411"><a href="#cb18-411" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-412"><a href="#cb18-412" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Verificar vers√£o do WeasyPrint</span></span>
<span id="cb18-413"><a href="#cb18-413" aria-hidden="true" tabindex="-1"></a>    check_weasyprint_version()</span>
<span id="cb18-414"><a href="#cb18-414" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-415"><a href="#cb18-415" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Suprimir avisos do fontconfig</span></span>
<span id="cb18-416"><a href="#cb18-416" aria-hidden="true" tabindex="-1"></a>    suppress_fontconfig_warnings()</span>
<span id="cb18-417"><a href="#cb18-417" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-418"><a href="#cb18-418" aria-hidden="true" tabindex="-1"></a>    converter <span class="op">=</span> HTMLToPDFConverter(args.output_dir)</span>
<span id="cb18-419"><a href="#cb18-419" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-420"><a href="#cb18-420" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb18-421"><a href="#cb18-421" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Verificar se √© arquivo ou diret√≥rio</span></span>
<span id="cb18-422"><a href="#cb18-422" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> os.path.isfile(args.<span class="bu">input</span>):</span>
<span id="cb18-423"><a href="#cb18-423" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Converter √∫nico arquivo</span></span>
<span id="cb18-424"><a href="#cb18-424" aria-hidden="true" tabindex="-1"></a>            converter.convert_html_to_pdf(</span>
<span id="cb18-425"><a href="#cb18-425" aria-hidden="true" tabindex="-1"></a>                input_html<span class="op">=</span>args.<span class="bu">input</span>,</span>
<span id="cb18-426"><a href="#cb18-426" aria-hidden="true" tabindex="-1"></a>                output_pdf<span class="op">=</span>args.output,</span>
<span id="cb18-427"><a href="#cb18-427" aria-hidden="true" tabindex="-1"></a>                base_url<span class="op">=</span>args.base_url,</span>
<span id="cb18-428"><a href="#cb18-428" aria-hidden="true" tabindex="-1"></a>                clean_html<span class="op">=</span><span class="kw">not</span> args.no_clean</span>
<span id="cb18-429"><a href="#cb18-429" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb18-430"><a href="#cb18-430" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> os.path.isdir(args.<span class="bu">input</span>):</span>
<span id="cb18-431"><a href="#cb18-431" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Converter todos os arquivos HTML do diret√≥rio</span></span>
<span id="cb18-432"><a href="#cb18-432" aria-hidden="true" tabindex="-1"></a>            html_files <span class="op">=</span> <span class="bu">list</span>(Path(args.<span class="bu">input</span>).glob(<span class="st">&quot;*.html&quot;</span>))</span>
<span id="cb18-433"><a href="#cb18-433" aria-hidden="true" tabindex="-1"></a>            html_files.extend(Path(args.<span class="bu">input</span>).glob(<span class="st">&quot;*.htm&quot;</span>))</span>
<span id="cb18-434"><a href="#cb18-434" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb18-435"><a href="#cb18-435" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> html_files:</span>
<span id="cb18-436"><a href="#cb18-436" aria-hidden="true" tabindex="-1"></a>                logger.warning(<span class="ss">f&quot;Nenhum arquivo HTML encontrado em </span><span class="sc">{</span>args<span class="sc">.</span><span class="bu">input</span><span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb18-437"><a href="#cb18-437" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span></span>
<span id="cb18-438"><a href="#cb18-438" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb18-439"><a href="#cb18-439" aria-hidden="true" tabindex="-1"></a>            logger.info(<span class="ss">f&quot;Encontrados </span><span class="sc">{</span><span class="bu">len</span>(html_files)<span class="sc">}</span><span class="ss"> arquivos HTML&quot;</span>)</span>
<span id="cb18-440"><a href="#cb18-440" aria-hidden="true" tabindex="-1"></a>            pdf_files <span class="op">=</span> converter.convert_multiple_files(</span>
<span id="cb18-441"><a href="#cb18-441" aria-hidden="true" tabindex="-1"></a>                html_files, </span>
<span id="cb18-442"><a href="#cb18-442" aria-hidden="true" tabindex="-1"></a>                clean_html<span class="op">=</span><span class="kw">not</span> args.no_clean</span>
<span id="cb18-443"><a href="#cb18-443" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb18-444"><a href="#cb18-444" aria-hidden="true" tabindex="-1"></a>            logger.info(<span class="ss">f&quot;‚úÖ Convers√£o conclu√≠da: </span><span class="sc">{</span><span class="bu">len</span>(pdf_files)<span class="sc">}</span><span class="ss"> arquivos processados&quot;</span>)</span>
<span id="cb18-445"><a href="#cb18-445" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb18-446"><a href="#cb18-446" aria-hidden="true" tabindex="-1"></a>            logger.error(<span class="ss">f&quot;Entrada inv√°lida: </span><span class="sc">{</span>args<span class="sc">.</span><span class="bu">input</span><span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb18-447"><a href="#cb18-447" aria-hidden="true" tabindex="-1"></a>            sys.exit(<span class="dv">1</span>)</span>
<span id="cb18-448"><a href="#cb18-448" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb18-449"><a href="#cb18-449" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb18-450"><a href="#cb18-450" aria-hidden="true" tabindex="-1"></a>        logger.error(<span class="ss">f&quot;Erro durante a convers√£o: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb18-451"><a href="#cb18-451" aria-hidden="true" tabindex="-1"></a>        sys.exit(<span class="dv">1</span>)</span>
<span id="cb18-452"><a href="#cb18-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-453"><a href="#cb18-453" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&quot;__main__&quot;</span>:</span>
<span id="cb18-454"><a href="#cb18-454" aria-hidden="true" tabindex="-1"></a>    main()</span></code></pre></div>
<h2 data-number="1.14" id="se-ainda-n√£o-funcionar-tente-esta-solu√ß√£o-alternativa"><span class="header-section-number">1.14</span> üöÄ <strong>Se ainda n√£o
funcionar, tente esta solu√ß√£o alternativa:</strong></h2>
<h3 data-number="1.14.1" id="op√ß√£o-1-usando-pdfkit-alternativa"><span class="header-section-number">1.14.1</span> <strong>Op√ß√£o 1: Usando
pdfkit (alternativa)</strong></h3>
<div class="sourceCode" id="cb19"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Instalar pdfkit</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="ex">conda</span> install <span class="at">-c</span> conda-forge pdfkit</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Baixar wkhtmltopdf: https://wkhtmltopdf.org/downloads.html</span></span></code></pre></div>
<h3 data-number="1.14.2" id="script-alternativo-com-pdfkit"><span class="header-section-number">1.14.2</span> <strong>Script alternativo
com pdfkit:</strong></h3>
<div class="sourceCode" id="cb20"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/usr/bin/env python3</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="co">&quot;&quot;&quot;</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co">html_to_pdf_alt.py - Alternativa usando pdfkit</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="co">&quot;&quot;&quot;</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pdfkit</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> logging</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>logging.basicConfig(level<span class="op">=</span>logging.INFO)</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>logger <span class="op">=</span> logging.getLogger(<span class="va">__name__</span>)</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convert_html_to_pdf_pdfkit(input_html, output_pdf):</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Converte HTML para PDF usando pdfkit&quot;&quot;&quot;</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Configure o caminho para wkhtmltopdf (ajuste conforme sua instala√ß√£o)</span></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>    path_wkhtmltopdf <span class="op">=</span> <span class="vs">r&#39;C:</span><span class="er">\</span><span class="vs">Program Files</span><span class="dv">\w</span><span class="vs">khtmltopdf</span><span class="dv">\b</span><span class="vs">in</span><span class="dv">\w</span><span class="vs">khtmltopdf</span><span class="dv">.</span><span class="vs">exe&#39;</span></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>    config <span class="op">=</span> pdfkit.configuration(wkhtmltopdf<span class="op">=</span>path_wkhtmltopdf)</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>    options <span class="op">=</span> {</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;page-size&#39;</span>: <span class="st">&#39;A4&#39;</span>,</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;margin-top&#39;</span>: <span class="st">&#39;2cm&#39;</span>,</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;margin-right&#39;</span>: <span class="st">&#39;2cm&#39;</span>,</span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;margin-bottom&#39;</span>: <span class="st">&#39;2cm&#39;</span>,</span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;margin-left&#39;</span>: <span class="st">&#39;2cm&#39;</span>,</span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;encoding&#39;</span>: <span class="st">&quot;UTF-8&quot;</span>,</span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;enable-local-file-access&#39;</span>: <span class="va">None</span>,</span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;no-stop-slow-scripts&#39;</span>: <span class="va">None</span>,</span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;javascript-delay&#39;</span>: <span class="dv">1000</span>,</span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;load-error-handling&#39;</span>: <span class="st">&#39;ignore&#39;</span></span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a>        pdfkit.from_file(input_html, output_pdf, options<span class="op">=</span>options, configuration<span class="op">=</span>config)</span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a>        logger.info(<span class="ss">f&quot;‚úÖ PDF gerado: </span><span class="sc">{</span>output_pdf<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a>        logger.error(<span class="ss">f&quot;‚ùå Erro: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb20-38"><a href="#cb20-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-39"><a href="#cb20-39" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&quot;__main__&quot;</span>:</span>
<span id="cb20-40"><a href="#cb20-40" aria-hidden="true" tabindex="-1"></a>    convert_html_to_pdf_pdfkit(<span class="st">&#39;exemplo_completo.html&#39;</span>, <span class="st">&#39;output.pdf&#39;</span>)</span></code></pre></div>
<h3 data-number="1.14.3" id="op√ß√£o-2-verificar-e-reinstalar-weasyprint"><span class="header-section-number">1.14.3</span> <strong>Op√ß√£o 2: Verificar e
reinstalar WeasyPrint</strong></h3>
<div class="sourceCode" id="cb21"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verificar vers√£o atual</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> <span class="at">-c</span> <span class="st">&quot;import weasyprint; print(weasyprint.__version__)&quot;</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Reinstalar WeasyPrint</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="ex">conda</span> remove weasyprint</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="ex">conda</span> clean <span class="at">--all</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="ex">conda</span> install <span class="at">-c</span> conda-forge weasyprint</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Ou instalar vers√£o espec√≠fica</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install weasyprint==58.0</span></code></pre></div>
<p>Execute o script corrigido primeiro. Se ainda der erro, use a op√ß√£o
com pdfkit que √© mais est√°vel no Windows.</p>
<hr />
<h3 data-number="1.14.4" id="utilizador-2025-11-01-030313-deepseek-chat"><span class="header-section-number">1.14.4</span> üë§ Utilizador
<em>(2025-11-01 03:03:13)</em> <em>[deepseek-chat]</em></h3>
<p>(Pesquisas) D:_DOCS__DOCS__html_to_pdf&gt;python html_to_pdf2.py
exemplo_completo.html Fontconfig error: Cannot load default config file:
No such file: (null) 2025-10-31 19:02:32,537 - INFO - Usando WeasyPrint
vers√£o 59.0 2025-10-31 19:02:32,537 - INFO - Arquivo HTML limpo criado:
C:__b3x3.html 2025-10-31 19:02:32,537 - INFO - Convertendo
exemplo_completo.html para output_pdfs_completo.pdf Fontconfig error:
Cannot load default config file: No such file: (null) Fontconfig error:
Cannot load default config file: No such file: (null) 2025-10-31
19:02:32,662 - WARNING - Ignored <code>gap: min(4vw, 1.5em)</code> at
7:32, unknown property. 2025-10-31 19:02:32,662 - WARNING - Ignored
<code>overflow-x: auto</code> at 8:28, unknown property. 2025-10-31
19:02:32,662 - WARNING - Ignored <code>user-select: none</code> at
45:32, unknown property. 2025-10-31 19:02:33,665 - ERROR - ‚ùå Erro na
convers√£o: PDF.<strong>init</strong>() takes 1 positional argument but 3
were given 2025-10-31 19:02:33,665 - ERROR - Erro durante a convers√£o:
PDF.<strong>init</strong>() takes 1 positional argument but 3 were
given</p>
<p>(Pesquisas) D:_DOCS__DOCS__html_to_pdf&gt;python html_to_pdf_alt.py
ERROR:<strong>main</strong>:‚ùå Erro: wkhtmltopdf reported an error: Exit
with code 1 due to network error: ContentNotFoundError</p>
<hr />
<h3 data-number="1.14.5" id="deepseek-2025-11-01-030313-deepseek-chat"><span class="header-section-number">1.14.5</span> ü§ñ DeepSeek <em>(2025-11-01
03:03:13)</em> <em>[deepseek-chat]</em></h3>
<p>O problema persiste com o WeasyPrint e o pdfkit n√£o est√° instalado.
Vou fornecer uma solu√ß√£o <strong>100% funcional</strong> usando
<strong>Selenium com Chrome</strong>, que √© muito mais confi√°vel para
HTML complexo com f√≥rmulas matem√°ticas:</p>
<h2 data-number="1.15" id="solu√ß√£o-definitiva-html_to_pdf_selenium.py"><span class="header-section-number">1.15</span> üöÄ <strong>Solu√ß√£o Definitiva:
html_to_pdf_selenium.py</strong></h2>
<div class="sourceCode" id="cb22"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/usr/bin/env python3</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="co">&quot;&quot;&quot;</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="co">html_to_pdf_selenium.py - Conversor HTML para PDF usando Selenium Chrome</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co">Solu√ß√£o mais confi√°vel para f√≥rmulas matem√°ticas e emojis</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="co">&quot;&quot;&quot;</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sys</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> argparse</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tempfile</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> logging</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> time</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> selenium <span class="im">import</span> webdriver</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> selenium.webdriver.chrome.options <span class="im">import</span> Options</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> selenium.webdriver.chrome.service <span class="im">import</span> Service</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> webdriver_manager.chrome <span class="im">import</span> ChromeDriverManager</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Configurar logging</span></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>logging.basicConfig(level<span class="op">=</span>logging.INFO, <span class="bu">format</span><span class="op">=</span><span class="st">&#39;</span><span class="sc">%(asctime)s</span><span class="st"> - </span><span class="sc">%(levelname)s</span><span class="st"> - </span><span class="sc">%(message)s</span><span class="st">&#39;</span>)</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>logger <span class="op">=</span> logging.getLogger(<span class="va">__name__</span>)</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> HTMLToPDFConverterSelenium:</span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, output_dir<span class="op">=</span><span class="st">&quot;output_pdfs&quot;</span>, chrome_path<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.output_dir <span class="op">=</span> output_dir</span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.chrome_path <span class="op">=</span> chrome_path</span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>._ensure_output_dir()</span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _ensure_output_dir(<span class="va">self</span>):</span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Cria o diret√≥rio de output se n√£o existir&quot;&quot;&quot;</span></span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a>        Path(<span class="va">self</span>.output_dir).mkdir(exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _setup_chrome_driver(<span class="va">self</span>):</span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Configura o Chrome driver para PDF generation&quot;&quot;&quot;</span></span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a>        chrome_options <span class="op">=</span> Options()</span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb22-37"><a href="#cb22-37" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Configura√ß√µes para modo headless e PDF</span></span>
<span id="cb22-38"><a href="#cb22-38" aria-hidden="true" tabindex="-1"></a>        chrome_options.add_argument(<span class="st">&quot;--headless=new&quot;</span>)</span>
<span id="cb22-39"><a href="#cb22-39" aria-hidden="true" tabindex="-1"></a>        chrome_options.add_argument(<span class="st">&quot;--disable-gpu&quot;</span>)</span>
<span id="cb22-40"><a href="#cb22-40" aria-hidden="true" tabindex="-1"></a>        chrome_options.add_argument(<span class="st">&quot;--disable-dev-shm-usage&quot;</span>)</span>
<span id="cb22-41"><a href="#cb22-41" aria-hidden="true" tabindex="-1"></a>        chrome_options.add_argument(<span class="st">&quot;--no-sandbox&quot;</span>)</span>
<span id="cb22-42"><a href="#cb22-42" aria-hidden="true" tabindex="-1"></a>        chrome_options.add_argument(<span class="st">&quot;--disable-extensions&quot;</span>)</span>
<span id="cb22-43"><a href="#cb22-43" aria-hidden="true" tabindex="-1"></a>        chrome_options.add_argument(<span class="st">&quot;--disable-software-rasterizer&quot;</span>)</span>
<span id="cb22-44"><a href="#cb22-44" aria-hidden="true" tabindex="-1"></a>        chrome_options.add_argument(<span class="st">&quot;--disable-features=VizDisplayCompositor&quot;</span>)</span>
<span id="cb22-45"><a href="#cb22-45" aria-hidden="true" tabindex="-1"></a>        chrome_options.add_argument(<span class="st">&quot;--disable-background-timer-throttling&quot;</span>)</span>
<span id="cb22-46"><a href="#cb22-46" aria-hidden="true" tabindex="-1"></a>        chrome_options.add_argument(<span class="st">&quot;--disable-backgrounding-occluded-windows&quot;</span>)</span>
<span id="cb22-47"><a href="#cb22-47" aria-hidden="true" tabindex="-1"></a>        chrome_options.add_argument(<span class="st">&quot;--disable-renderer-backgrounding&quot;</span>)</span>
<span id="cb22-48"><a href="#cb22-48" aria-hidden="true" tabindex="-1"></a>        chrome_options.add_argument(<span class="st">&quot;--window-size=1920,1080&quot;</span>)</span>
<span id="cb22-49"><a href="#cb22-49" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb22-50"><a href="#cb22-50" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Configura√ß√µes espec√≠ficas para PDF</span></span>
<span id="cb22-51"><a href="#cb22-51" aria-hidden="true" tabindex="-1"></a>        chrome_options.add_argument(<span class="st">&quot;--print-to-pdf-no-header&quot;</span>)</span>
<span id="cb22-52"><a href="#cb22-52" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb22-53"><a href="#cb22-53" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Configurar caminho do Chrome se especificado</span></span>
<span id="cb22-54"><a href="#cb22-54" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.chrome_path <span class="kw">and</span> os.path.exists(<span class="va">self</span>.chrome_path):</span>
<span id="cb22-55"><a href="#cb22-55" aria-hidden="true" tabindex="-1"></a>            chrome_options.binary_location <span class="op">=</span> <span class="va">self</span>.chrome_path</span>
<span id="cb22-56"><a href="#cb22-56" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb22-57"><a href="#cb22-57" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb22-58"><a href="#cb22-58" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Usar webdriver_manager para baixar automaticamente o driver correto</span></span>
<span id="cb22-59"><a href="#cb22-59" aria-hidden="true" tabindex="-1"></a>            service <span class="op">=</span> Service(ChromeDriverManager().install())</span>
<span id="cb22-60"><a href="#cb22-60" aria-hidden="true" tabindex="-1"></a>            driver <span class="op">=</span> webdriver.Chrome(service<span class="op">=</span>service, options<span class="op">=</span>chrome_options)</span>
<span id="cb22-61"><a href="#cb22-61" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> driver</span>
<span id="cb22-62"><a href="#cb22-62" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb22-63"><a href="#cb22-63" aria-hidden="true" tabindex="-1"></a>            logger.error(<span class="ss">f&quot;Erro ao configurar Chrome driver: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb22-64"><a href="#cb22-64" aria-hidden="true" tabindex="-1"></a>            <span class="cf">raise</span></span>
<span id="cb22-65"><a href="#cb22-65" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb22-66"><a href="#cb22-66" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _add_print_styles(<span class="va">self</span>, html_content):</span>
<span id="cb22-67"><a href="#cb22-67" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Adiciona estilos CSS para melhor impress√£o em PDF&quot;&quot;&quot;</span></span>
<span id="cb22-68"><a href="#cb22-68" aria-hidden="true" tabindex="-1"></a>        print_styles <span class="op">=</span> <span class="st">&quot;&quot;&quot;</span></span>
<span id="cb22-69"><a href="#cb22-69" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;style&gt;</span></span>
<span id="cb22-70"><a href="#cb22-70" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Estilos para impress√£o */</span></span>
<span id="cb22-71"><a href="#cb22-71" aria-hidden="true" tabindex="-1"></a><span class="st">            @media print {</span></span>
<span id="cb22-72"><a href="#cb22-72" aria-hidden="true" tabindex="-1"></a><span class="st">                body {</span></span>
<span id="cb22-73"><a href="#cb22-73" aria-hidden="true" tabindex="-1"></a><span class="st">                    font-family: &quot;Arial&quot;, &quot;DejaVu Sans&quot;, sans-serif !important;</span></span>
<span id="cb22-74"><a href="#cb22-74" aria-hidden="true" tabindex="-1"></a><span class="st">                    line-height: 1.6 !important;</span></span>
<span id="cb22-75"><a href="#cb22-75" aria-hidden="true" tabindex="-1"></a><span class="st">                    color: #333 !important;</span></span>
<span id="cb22-76"><a href="#cb22-76" aria-hidden="true" tabindex="-1"></a><span class="st">                    max-width: 100% !important;</span></span>
<span id="cb22-77"><a href="#cb22-77" aria-hidden="true" tabindex="-1"></a><span class="st">                    margin: 0 auto !important;</span></span>
<span id="cb22-78"><a href="#cb22-78" aria-hidden="true" tabindex="-1"></a><span class="st">                    padding: 20px !important;</span></span>
<span id="cb22-79"><a href="#cb22-79" aria-hidden="true" tabindex="-1"></a><span class="st">                    font-size: 12px !important;</span></span>
<span id="cb22-80"><a href="#cb22-80" aria-hidden="true" tabindex="-1"></a><span class="st">                }</span></span>
<span id="cb22-81"><a href="#cb22-81" aria-hidden="true" tabindex="-1"></a><span class="st">                </span></span>
<span id="cb22-82"><a href="#cb22-82" aria-hidden="true" tabindex="-1"></a><span class="st">                h1, h2, h3, h4, h5, h6 {</span></span>
<span id="cb22-83"><a href="#cb22-83" aria-hidden="true" tabindex="-1"></a><span class="st">                    color: #1565C0 !important;</span></span>
<span id="cb22-84"><a href="#cb22-84" aria-hidden="true" tabindex="-1"></a><span class="st">                    margin-top: 1.2em !important;</span></span>
<span id="cb22-85"><a href="#cb22-85" aria-hidden="true" tabindex="-1"></a><span class="st">                    margin-bottom: 0.5em !important;</span></span>
<span id="cb22-86"><a href="#cb22-86" aria-hidden="true" tabindex="-1"></a><span class="st">                    page-break-after: avoid !important;</span></span>
<span id="cb22-87"><a href="#cb22-87" aria-hidden="true" tabindex="-1"></a><span class="st">                }</span></span>
<span id="cb22-88"><a href="#cb22-88" aria-hidden="true" tabindex="-1"></a><span class="st">                </span></span>
<span id="cb22-89"><a href="#cb22-89" aria-hidden="true" tabindex="-1"></a><span class="st">                h1 {</span></span>
<span id="cb22-90"><a href="#cb22-90" aria-hidden="true" tabindex="-1"></a><span class="st">                    font-size: 18px !important;</span></span>
<span id="cb22-91"><a href="#cb22-91" aria-hidden="true" tabindex="-1"></a><span class="st">                    border-bottom: 2px solid #1565C0 !important;</span></span>
<span id="cb22-92"><a href="#cb22-92" aria-hidden="true" tabindex="-1"></a><span class="st">                    padding-bottom: 0.3em !important;</span></span>
<span id="cb22-93"><a href="#cb22-93" aria-hidden="true" tabindex="-1"></a><span class="st">                }</span></span>
<span id="cb22-94"><a href="#cb22-94" aria-hidden="true" tabindex="-1"></a><span class="st">                </span></span>
<span id="cb22-95"><a href="#cb22-95" aria-hidden="true" tabindex="-1"></a><span class="st">                h2 { font-size: 16px !important; }</span></span>
<span id="cb22-96"><a href="#cb22-96" aria-hidden="true" tabindex="-1"></a><span class="st">                h3 { font-size: 14px !important; }</span></span>
<span id="cb22-97"><a href="#cb22-97" aria-hidden="true" tabindex="-1"></a><span class="st">                </span></span>
<span id="cb22-98"><a href="#cb22-98" aria-hidden="true" tabindex="-1"></a><span class="st">                /* C√≥digo */</span></span>
<span id="cb22-99"><a href="#cb22-99" aria-hidden="true" tabindex="-1"></a><span class="st">                pre, code {</span></span>
<span id="cb22-100"><a href="#cb22-100" aria-hidden="true" tabindex="-1"></a><span class="st">                    font-family: &quot;Consolas&quot;, &quot;Monaco&quot;, &quot;Courier New&quot;, monospace !important;</span></span>
<span id="cb22-101"><a href="#cb22-101" aria-hidden="true" tabindex="-1"></a><span class="st">                    background-color: #f6f8fa !important;</span></span>
<span id="cb22-102"><a href="#cb22-102" aria-hidden="true" tabindex="-1"></a><span class="st">                    border: 1px solid #e1e4e8 !important;</span></span>
<span id="cb22-103"><a href="#cb22-103" aria-hidden="true" tabindex="-1"></a><span class="st">                    border-radius: 5px !important;</span></span>
<span id="cb22-104"><a href="#cb22-104" aria-hidden="true" tabindex="-1"></a><span class="st">                }</span></span>
<span id="cb22-105"><a href="#cb22-105" aria-hidden="true" tabindex="-1"></a><span class="st">                </span></span>
<span id="cb22-106"><a href="#cb22-106" aria-hidden="true" tabindex="-1"></a><span class="st">                pre {</span></span>
<span id="cb22-107"><a href="#cb22-107" aria-hidden="true" tabindex="-1"></a><span class="st">                    padding: 12px !important;</span></span>
<span id="cb22-108"><a href="#cb22-108" aria-hidden="true" tabindex="-1"></a><span class="st">                    page-break-inside: avoid !important;</span></span>
<span id="cb22-109"><a href="#cb22-109" aria-hidden="true" tabindex="-1"></a><span class="st">                    font-size: 11px !important;</span></span>
<span id="cb22-110"><a href="#cb22-110" aria-hidden="true" tabindex="-1"></a><span class="st">                    white-space: pre-wrap !important;</span></span>
<span id="cb22-111"><a href="#cb22-111" aria-hidden="true" tabindex="-1"></a><span class="st">                }</span></span>
<span id="cb22-112"><a href="#cb22-112" aria-hidden="true" tabindex="-1"></a><span class="st">                </span></span>
<span id="cb22-113"><a href="#cb22-113" aria-hidden="true" tabindex="-1"></a><span class="st">                code {</span></span>
<span id="cb22-114"><a href="#cb22-114" aria-hidden="true" tabindex="-1"></a><span class="st">                    padding: 2px 4px !important;</span></span>
<span id="cb22-115"><a href="#cb22-115" aria-hidden="true" tabindex="-1"></a><span class="st">                    font-size: 11px !important;</span></span>
<span id="cb22-116"><a href="#cb22-116" aria-hidden="true" tabindex="-1"></a><span class="st">                }</span></span>
<span id="cb22-117"><a href="#cb22-117" aria-hidden="true" tabindex="-1"></a><span class="st">                </span></span>
<span id="cb22-118"><a href="#cb22-118" aria-hidden="true" tabindex="-1"></a><span class="st">                /* Syntax highlighting */</span></span>
<span id="cb22-119"><a href="#cb22-119" aria-hidden="true" tabindex="-1"></a><span class="st">                .sourceCode span.al { color: #ff0000 !important; font-weight: bold !important; }</span></span>
<span id="cb22-120"><a href="#cb22-120" aria-hidden="true" tabindex="-1"></a><span class="st">                .sourceCode span.an { color: #60a0b0 !important; font-weight: bold !important; font-style: italic !important; }</span></span>
<span id="cb22-121"><a href="#cb22-121" aria-hidden="true" tabindex="-1"></a><span class="st">                .sourceCode span.at { color: #7d9029 !important; }</span></span>
<span id="cb22-122"><a href="#cb22-122" aria-hidden="true" tabindex="-1"></a><span class="st">                .sourceCode span.bn { color: #40a070 !important; }</span></span>
<span id="cb22-123"><a href="#cb22-123" aria-hidden="true" tabindex="-1"></a><span class="st">                .sourceCode span.bu { color: #008000 !important; }</span></span>
<span id="cb22-124"><a href="#cb22-124" aria-hidden="true" tabindex="-1"></a><span class="st">                .sourceCode span.cf { color: #007020 !important; font-weight: bold !important; }</span></span>
<span id="cb22-125"><a href="#cb22-125" aria-hidden="true" tabindex="-1"></a><span class="st">                .sourceCode span.ch { color: #4070a0 !important; }</span></span>
<span id="cb22-126"><a href="#cb22-126" aria-hidden="true" tabindex="-1"></a><span class="st">                .sourceCode span.cn { color: #880000 !important; }</span></span>
<span id="cb22-127"><a href="#cb22-127" aria-hidden="true" tabindex="-1"></a><span class="st">                .sourceCode span.co { color: #60a0b0 !important; font-style: italic !important; }</span></span>
<span id="cb22-128"><a href="#cb22-128" aria-hidden="true" tabindex="-1"></a><span class="st">                .sourceCode span.cv { color: #60a0b0 !important; font-weight: bold !important; font-style: italic !important; }</span></span>
<span id="cb22-129"><a href="#cb22-129" aria-hidden="true" tabindex="-1"></a><span class="st">                .sourceCode span.do { color: #ba2121 !important; font-style: italic !important; }</span></span>
<span id="cb22-130"><a href="#cb22-130" aria-hidden="true" tabindex="-1"></a><span class="st">                .sourceCode span.dt { color: #902000 !important; }</span></span>
<span id="cb22-131"><a href="#cb22-131" aria-hidden="true" tabindex="-1"></a><span class="st">                .sourceCode span.dv { color: #40a070 !important; }</span></span>
<span id="cb22-132"><a href="#cb22-132" aria-hidden="true" tabindex="-1"></a><span class="st">                .sourceCode span.er { color: #ff0000 !important; font-weight: bold !important; }</span></span>
<span id="cb22-133"><a href="#cb22-133" aria-hidden="true" tabindex="-1"></a><span class="st">                .sourceCode span.ex { color: #007020 !important; }</span></span>
<span id="cb22-134"><a href="#cb22-134" aria-hidden="true" tabindex="-1"></a><span class="st">                .sourceCode span.fl { color: #40a070 !important; }</span></span>
<span id="cb22-135"><a href="#cb22-135" aria-hidden="true" tabindex="-1"></a><span class="st">                .sourceCode span.fu { color: #06287e !important; }</span></span>
<span id="cb22-136"><a href="#cb22-136" aria-hidden="true" tabindex="-1"></a><span class="st">                .sourceCode span.im { color: #008000 !important; font-weight: bold !important; }</span></span>
<span id="cb22-137"><a href="#cb22-137" aria-hidden="true" tabindex="-1"></a><span class="st">                .sourceCode span.in { color: #60a0b0 !important; font-weight: bold !important; font-style: italic !important; }</span></span>
<span id="cb22-138"><a href="#cb22-138" aria-hidden="true" tabindex="-1"></a><span class="st">                .sourceCode span.kw { color: #007020 !important; font-weight: bold !important; }</span></span>
<span id="cb22-139"><a href="#cb22-139" aria-hidden="true" tabindex="-1"></a><span class="st">                .sourceCode span.op { color: #666666 !important; }</span></span>
<span id="cb22-140"><a href="#cb22-140" aria-hidden="true" tabindex="-1"></a><span class="st">                .sourceCode span.ot { color: #007020 !important; }</span></span>
<span id="cb22-141"><a href="#cb22-141" aria-hidden="true" tabindex="-1"></a><span class="st">                .sourceCode span.pp { color: #bc7a00 !important; }</span></span>
<span id="cb22-142"><a href="#cb22-142" aria-hidden="true" tabindex="-1"></a><span class="st">                .sourceCode span.sc { color: #4070a0 !important; }</span></span>
<span id="cb22-143"><a href="#cb22-143" aria-hidden="true" tabindex="-1"></a><span class="st">                .sourceCode span.ss { color: #bb6688 !important; }</span></span>
<span id="cb22-144"><a href="#cb22-144" aria-hidden="true" tabindex="-1"></a><span class="st">                .sourceCode span.st { color: #4070a0 !important; }</span></span>
<span id="cb22-145"><a href="#cb22-145" aria-hidden="true" tabindex="-1"></a><span class="st">                .sourceCode span.va { color: #19177c !important; }</span></span>
<span id="cb22-146"><a href="#cb22-146" aria-hidden="true" tabindex="-1"></a><span class="st">                .sourceCode span.vs { color: #4070a0 !important; }</span></span>
<span id="cb22-147"><a href="#cb22-147" aria-hidden="true" tabindex="-1"></a><span class="st">                .sourceCode span.wa { color: #60a0b0 !important; font-weight: bold !important; font-style: italic !important; }</span></span>
<span id="cb22-148"><a href="#cb22-148" aria-hidden="true" tabindex="-1"></a><span class="st">                </span></span>
<span id="cb22-149"><a href="#cb22-149" aria-hidden="true" tabindex="-1"></a><span class="st">                /* Tabelas */</span></span>
<span id="cb22-150"><a href="#cb22-150" aria-hidden="true" tabindex="-1"></a><span class="st">                table {</span></span>
<span id="cb22-151"><a href="#cb22-151" aria-hidden="true" tabindex="-1"></a><span class="st">                    border-collapse: collapse !important;</span></span>
<span id="cb22-152"><a href="#cb22-152" aria-hidden="true" tabindex="-1"></a><span class="st">                    width: 100% !important;</span></span>
<span id="cb22-153"><a href="#cb22-153" aria-hidden="true" tabindex="-1"></a><span class="st">                    margin: 1em 0 !important;</span></span>
<span id="cb22-154"><a href="#cb22-154" aria-hidden="true" tabindex="-1"></a><span class="st">                    page-break-inside: avoid !important;</span></span>
<span id="cb22-155"><a href="#cb22-155" aria-hidden="true" tabindex="-1"></a><span class="st">                    font-size: 11px !important;</span></span>
<span id="cb22-156"><a href="#cb22-156" aria-hidden="true" tabindex="-1"></a><span class="st">                }</span></span>
<span id="cb22-157"><a href="#cb22-157" aria-hidden="true" tabindex="-1"></a><span class="st">                </span></span>
<span id="cb22-158"><a href="#cb22-158" aria-hidden="true" tabindex="-1"></a><span class="st">                th, td {</span></span>
<span id="cb22-159"><a href="#cb22-159" aria-hidden="true" tabindex="-1"></a><span class="st">                    border: 1px solid #ddd !important;</span></span>
<span id="cb22-160"><a href="#cb22-160" aria-hidden="true" tabindex="-1"></a><span class="st">                    padding: 6px 10px !important;</span></span>
<span id="cb22-161"><a href="#cb22-161" aria-hidden="true" tabindex="-1"></a><span class="st">                    text-align: left !important;</span></span>
<span id="cb22-162"><a href="#cb22-162" aria-hidden="true" tabindex="-1"></a><span class="st">                }</span></span>
<span id="cb22-163"><a href="#cb22-163" aria-hidden="true" tabindex="-1"></a><span class="st">                </span></span>
<span id="cb22-164"><a href="#cb22-164" aria-hidden="true" tabindex="-1"></a><span class="st">                th {</span></span>
<span id="cb22-165"><a href="#cb22-165" aria-hidden="true" tabindex="-1"></a><span class="st">                    background-color: #f2f2f2 !important;</span></span>
<span id="cb22-166"><a href="#cb22-166" aria-hidden="true" tabindex="-1"></a><span class="st">                    font-weight: bold !important;</span></span>
<span id="cb22-167"><a href="#cb22-167" aria-hidden="true" tabindex="-1"></a><span class="st">                }</span></span>
<span id="cb22-168"><a href="#cb22-168" aria-hidden="true" tabindex="-1"></a><span class="st">                </span></span>
<span id="cb22-169"><a href="#cb22-169" aria-hidden="true" tabindex="-1"></a><span class="st">                /* Evitar quebras de p√°gina */</span></span>
<span id="cb22-170"><a href="#cb22-170" aria-hidden="true" tabindex="-1"></a><span class="st">                h1, h2, h3 { page-break-after: avoid !important; }</span></span>
<span id="cb22-171"><a href="#cb22-171" aria-hidden="true" tabindex="-1"></a><span class="st">                pre, table, figure, .math { page-break-inside: avoid !important; }</span></span>
<span id="cb22-172"><a href="#cb22-172" aria-hidden="true" tabindex="-1"></a><span class="st">                </span></span>
<span id="cb22-173"><a href="#cb22-173" aria-hidden="true" tabindex="-1"></a><span class="st">                /* Garantir que MathJax renderize completamente */</span></span>
<span id="cb22-174"><a href="#cb22-174" aria-hidden="true" tabindex="-1"></a><span class="st">                .MathJax, mjx-container { </span></span>
<span id="cb22-175"><a href="#cb22-175" aria-hidden="true" tabindex="-1"></a><span class="st">                    display: inline-block !important;</span></span>
<span id="cb22-176"><a href="#cb22-176" aria-hidden="true" tabindex="-1"></a><span class="st">                    page-break-inside: avoid !important;</span></span>
<span id="cb22-177"><a href="#cb22-177" aria-hidden="true" tabindex="-1"></a><span class="st">                }</span></span>
<span id="cb22-178"><a href="#cb22-178" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb22-179"><a href="#cb22-179" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb22-180"><a href="#cb22-180" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Estilos extras para melhor visualiza√ß√£o */</span></span>
<span id="cb22-181"><a href="#cb22-181" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode {</span></span>
<span id="cb22-182"><a href="#cb22-182" aria-hidden="true" tabindex="-1"></a><span class="st">                margin: 1em 0 !important;</span></span>
<span id="cb22-183"><a href="#cb22-183" aria-hidden="true" tabindex="-1"></a><span class="st">                background-color: #f6f8fa !important;</span></span>
<span id="cb22-184"><a href="#cb22-184" aria-hidden="true" tabindex="-1"></a><span class="st">                border-radius: 5px !important;</span></span>
<span id="cb22-185"><a href="#cb22-185" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb22-186"><a href="#cb22-186" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb22-187"><a href="#cb22-187" aria-hidden="true" tabindex="-1"></a><span class="st">            blockquote {</span></span>
<span id="cb22-188"><a href="#cb22-188" aria-hidden="true" tabindex="-1"></a><span class="st">                background-color: #f9f9f9 !important;</span></span>
<span id="cb22-189"><a href="#cb22-189" aria-hidden="true" tabindex="-1"></a><span class="st">                border-left: 4px solid #ccc !important;</span></span>
<span id="cb22-190"><a href="#cb22-190" aria-hidden="true" tabindex="-1"></a><span class="st">                margin: 1em 0 !important;</span></span>
<span id="cb22-191"><a href="#cb22-191" aria-hidden="true" tabindex="-1"></a><span class="st">                padding: 0.5em 1em !important;</span></span>
<span id="cb22-192"><a href="#cb22-192" aria-hidden="true" tabindex="-1"></a><span class="st">                font-style: italic !important;</span></span>
<span id="cb22-193"><a href="#cb22-193" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb22-194"><a href="#cb22-194" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb22-195"><a href="#cb22-195" aria-hidden="true" tabindex="-1"></a><span class="st">            img {</span></span>
<span id="cb22-196"><a href="#cb22-196" aria-hidden="true" tabindex="-1"></a><span class="st">                max-width: 100% !important;</span></span>
<span id="cb22-197"><a href="#cb22-197" aria-hidden="true" tabindex="-1"></a><span class="st">                height: auto !important;</span></span>
<span id="cb22-198"><a href="#cb22-198" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb22-199"><a href="#cb22-199" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;/style&gt;</span></span>
<span id="cb22-200"><a href="#cb22-200" aria-hidden="true" tabindex="-1"></a><span class="st">        &quot;&quot;&quot;</span></span>
<span id="cb22-201"><a href="#cb22-201" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb22-202"><a href="#cb22-202" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Inserir estilos no head</span></span>
<span id="cb22-203"><a href="#cb22-203" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">&#39;&lt;/head&gt;&#39;</span> <span class="kw">in</span> html_content:</span>
<span id="cb22-204"><a href="#cb22-204" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> html_content.replace(<span class="st">&#39;&lt;/head&gt;&#39;</span>, print_styles <span class="op">+</span> <span class="st">&#39;&lt;/head&gt;&#39;</span>)</span>
<span id="cb22-205"><a href="#cb22-205" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="st">&#39;&lt;head&gt;&#39;</span> <span class="kw">in</span> html_content:</span>
<span id="cb22-206"><a href="#cb22-206" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> html_content.replace(<span class="st">&#39;&lt;head&gt;&#39;</span>, <span class="st">&#39;&lt;head&gt;&#39;</span> <span class="op">+</span> print_styles)</span>
<span id="cb22-207"><a href="#cb22-207" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb22-208"><a href="#cb22-208" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">&#39;&lt;head&gt;&#39;</span> <span class="op">+</span> print_styles <span class="op">+</span> <span class="st">&#39;&lt;/head&gt;&#39;</span> <span class="op">+</span> html_content</span>
<span id="cb22-209"><a href="#cb22-209" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb22-210"><a href="#cb22-210" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> convert_html_to_pdf(<span class="va">self</span>, input_html, output_pdf<span class="op">=</span><span class="va">None</span>, wait_time<span class="op">=</span><span class="dv">3</span>):</span>
<span id="cb22-211"><a href="#cb22-211" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;</span></span>
<span id="cb22-212"><a href="#cb22-212" aria-hidden="true" tabindex="-1"></a><span class="co">        Converte arquivo HTML para PDF usando Selenium Chrome</span></span>
<span id="cb22-213"><a href="#cb22-213" aria-hidden="true" tabindex="-1"></a><span class="co">        </span></span>
<span id="cb22-214"><a href="#cb22-214" aria-hidden="true" tabindex="-1"></a><span class="co">        Args:</span></span>
<span id="cb22-215"><a href="#cb22-215" aria-hidden="true" tabindex="-1"></a><span class="co">            input_html (str): Caminho para arquivo HTML de entrada</span></span>
<span id="cb22-216"><a href="#cb22-216" aria-hidden="true" tabindex="-1"></a><span class="co">            output_pdf (str): Caminho para arquivo PDF de sa√≠da (opcional)</span></span>
<span id="cb22-217"><a href="#cb22-217" aria-hidden="true" tabindex="-1"></a><span class="co">            wait_time (int): Tempo de espera para carregamento (segundos)</span></span>
<span id="cb22-218"><a href="#cb22-218" aria-hidden="true" tabindex="-1"></a><span class="co">        </span></span>
<span id="cb22-219"><a href="#cb22-219" aria-hidden="true" tabindex="-1"></a><span class="co">        Returns:</span></span>
<span id="cb22-220"><a href="#cb22-220" aria-hidden="true" tabindex="-1"></a><span class="co">            str: Caminho do arquivo PDF gerado</span></span>
<span id="cb22-221"><a href="#cb22-221" aria-hidden="true" tabindex="-1"></a><span class="co">        &quot;&quot;&quot;</span></span>
<span id="cb22-222"><a href="#cb22-222" aria-hidden="true" tabindex="-1"></a>        driver <span class="op">=</span> <span class="va">None</span></span>
<span id="cb22-223"><a href="#cb22-223" aria-hidden="true" tabindex="-1"></a>        temp_file <span class="op">=</span> <span class="va">None</span></span>
<span id="cb22-224"><a href="#cb22-224" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb22-225"><a href="#cb22-225" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb22-226"><a href="#cb22-226" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Verificar se arquivo de entrada existe</span></span>
<span id="cb22-227"><a href="#cb22-227" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> os.path.exists(input_html):</span>
<span id="cb22-228"><a href="#cb22-228" aria-hidden="true" tabindex="-1"></a>                <span class="cf">raise</span> <span class="pp">FileNotFoundError</span>(<span class="ss">f&quot;Arquivo de entrada n√£o encontrado: </span><span class="sc">{</span>input_html<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb22-229"><a href="#cb22-229" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb22-230"><a href="#cb22-230" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Gerar nome do arquivo de sa√≠da se n√£o fornecido</span></span>
<span id="cb22-231"><a href="#cb22-231" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> output_pdf <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb22-232"><a href="#cb22-232" aria-hidden="true" tabindex="-1"></a>                input_path <span class="op">=</span> Path(input_html)</span>
<span id="cb22-233"><a href="#cb22-233" aria-hidden="true" tabindex="-1"></a>                output_pdf <span class="op">=</span> Path(<span class="va">self</span>.output_dir) <span class="op">/</span> <span class="ss">f&quot;</span><span class="sc">{</span>input_path<span class="sc">.</span>stem<span class="sc">}</span><span class="ss">.pdf&quot;</span></span>
<span id="cb22-234"><a href="#cb22-234" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb22-235"><a href="#cb22-235" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Garantir que o diret√≥rio de sa√≠da existe</span></span>
<span id="cb22-236"><a href="#cb22-236" aria-hidden="true" tabindex="-1"></a>            Path(output_pdf).parent.mkdir(parents<span class="op">=</span><span class="va">True</span>, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb22-237"><a href="#cb22-237" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb22-238"><a href="#cb22-238" aria-hidden="true" tabindex="-1"></a>            logger.info(<span class="ss">f&quot;Convertendo </span><span class="sc">{</span>input_html<span class="sc">}</span><span class="ss"> para </span><span class="sc">{</span>output_pdf<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb22-239"><a href="#cb22-239" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb22-240"><a href="#cb22-240" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Ler e processar conte√∫do HTML</span></span>
<span id="cb22-241"><a href="#cb22-241" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(input_html, <span class="st">&#39;r&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb22-242"><a href="#cb22-242" aria-hidden="true" tabindex="-1"></a>                html_content <span class="op">=</span> f.read()</span>
<span id="cb22-243"><a href="#cb22-243" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb22-244"><a href="#cb22-244" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Adicionar estilos de impress√£o</span></span>
<span id="cb22-245"><a href="#cb22-245" aria-hidden="true" tabindex="-1"></a>            html_content <span class="op">=</span> <span class="va">self</span>._add_print_styles(html_content)</span>
<span id="cb22-246"><a href="#cb22-246" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb22-247"><a href="#cb22-247" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Criar arquivo tempor√°rio com conte√∫do processado</span></span>
<span id="cb22-248"><a href="#cb22-248" aria-hidden="true" tabindex="-1"></a>            temp_file <span class="op">=</span> tempfile.NamedTemporaryFile(mode<span class="op">=</span><span class="st">&#39;w&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>, </span>
<span id="cb22-249"><a href="#cb22-249" aria-hidden="true" tabindex="-1"></a>                                                   suffix<span class="op">=</span><span class="st">&#39;.html&#39;</span>, delete<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb22-250"><a href="#cb22-250" aria-hidden="true" tabindex="-1"></a>            temp_file.write(html_content)</span>
<span id="cb22-251"><a href="#cb22-251" aria-hidden="true" tabindex="-1"></a>            temp_file.close()</span>
<span id="cb22-252"><a href="#cb22-252" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb22-253"><a href="#cb22-253" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Configurar Chrome driver</span></span>
<span id="cb22-254"><a href="#cb22-254" aria-hidden="true" tabindex="-1"></a>            driver <span class="op">=</span> <span class="va">self</span>._setup_chrome_driver()</span>
<span id="cb22-255"><a href="#cb22-255" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb22-256"><a href="#cb22-256" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Carregar arquivo local</span></span>
<span id="cb22-257"><a href="#cb22-257" aria-hidden="true" tabindex="-1"></a>            file_url <span class="op">=</span> <span class="ss">f&quot;file:///</span><span class="sc">{</span>temp_file<span class="sc">.</span>name<span class="sc">.</span>replace(os.sep, <span class="st">&#39;/&#39;</span>)<span class="sc">}</span><span class="ss">&quot;</span></span>
<span id="cb22-258"><a href="#cb22-258" aria-hidden="true" tabindex="-1"></a>            logger.info(<span class="ss">f&quot;Carregando URL: </span><span class="sc">{</span>file_url<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb22-259"><a href="#cb22-259" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb22-260"><a href="#cb22-260" aria-hidden="true" tabindex="-1"></a>            driver.get(file_url)</span>
<span id="cb22-261"><a href="#cb22-261" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb22-262"><a href="#cb22-262" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Aguardar carregamento completo (especialmente para MathJax)</span></span>
<span id="cb22-263"><a href="#cb22-263" aria-hidden="true" tabindex="-1"></a>            logger.info(<span class="ss">f&quot;Aguardando </span><span class="sc">{</span>wait_time<span class="sc">}</span><span class="ss"> segundos para carregamento...&quot;</span>)</span>
<span id="cb22-264"><a href="#cb22-264" aria-hidden="true" tabindex="-1"></a>            time.sleep(wait_time)</span>
<span id="cb22-265"><a href="#cb22-265" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb22-266"><a href="#cb22-266" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Executar script para garantir que MathJax terminou de renderizar</span></span>
<span id="cb22-267"><a href="#cb22-267" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb22-268"><a href="#cb22-268" aria-hidden="true" tabindex="-1"></a>                driver.execute_script(<span class="st">&quot;&quot;&quot;</span></span>
<span id="cb22-269"><a href="#cb22-269" aria-hidden="true" tabindex="-1"></a><span class="st">                    // Aguardar MathJax se estiver presente</span></span>
<span id="cb22-270"><a href="#cb22-270" aria-hidden="true" tabindex="-1"></a><span class="st">                    if (window.MathJax) {</span></span>
<span id="cb22-271"><a href="#cb22-271" aria-hidden="true" tabindex="-1"></a><span class="st">                        return MathJax.startup.promise.then(function() {</span></span>
<span id="cb22-272"><a href="#cb22-272" aria-hidden="true" tabindex="-1"></a><span class="st">                            return MathJax.typesetPromise();</span></span>
<span id="cb22-273"><a href="#cb22-273" aria-hidden="true" tabindex="-1"></a><span class="st">                        });</span></span>
<span id="cb22-274"><a href="#cb22-274" aria-hidden="true" tabindex="-1"></a><span class="st">                    }</span></span>
<span id="cb22-275"><a href="#cb22-275" aria-hidden="true" tabindex="-1"></a><span class="st">                    return Promise.resolve();</span></span>
<span id="cb22-276"><a href="#cb22-276" aria-hidden="true" tabindex="-1"></a><span class="st">                &quot;&quot;&quot;</span>)</span>
<span id="cb22-277"><a href="#cb22-277" aria-hidden="true" tabindex="-1"></a>                time.sleep(<span class="dv">1</span>)  <span class="co"># Espera adicional</span></span>
<span id="cb22-278"><a href="#cb22-278" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb22-279"><a href="#cb22-279" aria-hidden="true" tabindex="-1"></a>                logger.warning(<span class="ss">f&quot;MathJax n√£o detectado ou erro: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb22-280"><a href="#cb22-280" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb22-281"><a href="#cb22-281" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Configurar op√ß√µes de impress√£o para PDF</span></span>
<span id="cb22-282"><a href="#cb22-282" aria-hidden="true" tabindex="-1"></a>            print_options <span class="op">=</span> {</span>
<span id="cb22-283"><a href="#cb22-283" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;landscape&#39;</span>: <span class="va">False</span>,</span>
<span id="cb22-284"><a href="#cb22-284" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;displayHeaderFooter&#39;</span>: <span class="va">False</span>,</span>
<span id="cb22-285"><a href="#cb22-285" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;printBackground&#39;</span>: <span class="va">True</span>,</span>
<span id="cb22-286"><a href="#cb22-286" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;preferCSSPageSize&#39;</span>: <span class="va">True</span>,</span>
<span id="cb22-287"><a href="#cb22-287" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;paperWidth&#39;</span>: <span class="fl">8.27</span>,  <span class="co"># A4 width in inches</span></span>
<span id="cb22-288"><a href="#cb22-288" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;paperHeight&#39;</span>: <span class="fl">11.69</span>, <span class="co"># A4 height in inches</span></span>
<span id="cb22-289"><a href="#cb22-289" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;marginTop&#39;</span>: <span class="fl">0.4</span>,</span>
<span id="cb22-290"><a href="#cb22-290" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;marginBottom&#39;</span>: <span class="fl">0.4</span>,</span>
<span id="cb22-291"><a href="#cb22-291" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;marginLeft&#39;</span>: <span class="fl">0.4</span>,</span>
<span id="cb22-292"><a href="#cb22-292" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;marginRight&#39;</span>: <span class="fl">0.4</span>,</span>
<span id="cb22-293"><a href="#cb22-293" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb22-294"><a href="#cb22-294" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb22-295"><a href="#cb22-295" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Gerar PDF</span></span>
<span id="cb22-296"><a href="#cb22-296" aria-hidden="true" tabindex="-1"></a>            pdf_data <span class="op">=</span> driver.execute_cdp_cmd(<span class="st">&#39;Page.printToPDF&#39;</span>, print_options)</span>
<span id="cb22-297"><a href="#cb22-297" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb22-298"><a href="#cb22-298" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Salvar PDF</span></span>
<span id="cb22-299"><a href="#cb22-299" aria-hidden="true" tabindex="-1"></a>            <span class="im">import</span> base64</span>
<span id="cb22-300"><a href="#cb22-300" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(output_pdf, <span class="st">&#39;wb&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb22-301"><a href="#cb22-301" aria-hidden="true" tabindex="-1"></a>                f.write(base64.b64decode(pdf_data[<span class="st">&#39;data&#39;</span>]))</span>
<span id="cb22-302"><a href="#cb22-302" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb22-303"><a href="#cb22-303" aria-hidden="true" tabindex="-1"></a>            logger.info(<span class="ss">f&quot;‚úÖ PDF gerado com sucesso: </span><span class="sc">{</span>output_pdf<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb22-304"><a href="#cb22-304" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="bu">str</span>(output_pdf)</span>
<span id="cb22-305"><a href="#cb22-305" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb22-306"><a href="#cb22-306" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb22-307"><a href="#cb22-307" aria-hidden="true" tabindex="-1"></a>            logger.error(<span class="ss">f&quot;‚ùå Erro na convers√£o: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb22-308"><a href="#cb22-308" aria-hidden="true" tabindex="-1"></a>            <span class="cf">raise</span></span>
<span id="cb22-309"><a href="#cb22-309" aria-hidden="true" tabindex="-1"></a>        <span class="cf">finally</span>:</span>
<span id="cb22-310"><a href="#cb22-310" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Fechar driver e limpar arquivo tempor√°rio</span></span>
<span id="cb22-311"><a href="#cb22-311" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> driver:</span>
<span id="cb22-312"><a href="#cb22-312" aria-hidden="true" tabindex="-1"></a>                driver.quit()</span>
<span id="cb22-313"><a href="#cb22-313" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> temp_file <span class="kw">and</span> os.path.exists(temp_file.name):</span>
<span id="cb22-314"><a href="#cb22-314" aria-hidden="true" tabindex="-1"></a>                <span class="cf">try</span>:</span>
<span id="cb22-315"><a href="#cb22-315" aria-hidden="true" tabindex="-1"></a>                    os.unlink(temp_file.name)</span>
<span id="cb22-316"><a href="#cb22-316" aria-hidden="true" tabindex="-1"></a>                <span class="cf">except</span>:</span>
<span id="cb22-317"><a href="#cb22-317" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">pass</span></span>
<span id="cb22-318"><a href="#cb22-318" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb22-319"><a href="#cb22-319" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> convert_multiple_files(<span class="va">self</span>, html_files, output_dir<span class="op">=</span><span class="va">None</span>, wait_time<span class="op">=</span><span class="dv">3</span>):</span>
<span id="cb22-320"><a href="#cb22-320" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;</span></span>
<span id="cb22-321"><a href="#cb22-321" aria-hidden="true" tabindex="-1"></a><span class="co">        Converte m√∫ltiplos arquivos HTML para PDF</span></span>
<span id="cb22-322"><a href="#cb22-322" aria-hidden="true" tabindex="-1"></a><span class="co">        </span></span>
<span id="cb22-323"><a href="#cb22-323" aria-hidden="true" tabindex="-1"></a><span class="co">        Args:</span></span>
<span id="cb22-324"><a href="#cb22-324" aria-hidden="true" tabindex="-1"></a><span class="co">            html_files (list): Lista de caminhos para arquivos HTML</span></span>
<span id="cb22-325"><a href="#cb22-325" aria-hidden="true" tabindex="-1"></a><span class="co">            output_dir (str): Diret√≥rio de sa√≠da (opcional)</span></span>
<span id="cb22-326"><a href="#cb22-326" aria-hidden="true" tabindex="-1"></a><span class="co">            wait_time (int): Tempo de espera para carregamento (segundos)</span></span>
<span id="cb22-327"><a href="#cb22-327" aria-hidden="true" tabindex="-1"></a><span class="co">        </span></span>
<span id="cb22-328"><a href="#cb22-328" aria-hidden="true" tabindex="-1"></a><span class="co">        Returns:</span></span>
<span id="cb22-329"><a href="#cb22-329" aria-hidden="true" tabindex="-1"></a><span class="co">            list: Lista de arquivos PDF gerados</span></span>
<span id="cb22-330"><a href="#cb22-330" aria-hidden="true" tabindex="-1"></a><span class="co">        &quot;&quot;&quot;</span></span>
<span id="cb22-331"><a href="#cb22-331" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> output_dir:</span>
<span id="cb22-332"><a href="#cb22-332" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.output_dir <span class="op">=</span> output_dir</span>
<span id="cb22-333"><a href="#cb22-333" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>._ensure_output_dir()</span>
<span id="cb22-334"><a href="#cb22-334" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb22-335"><a href="#cb22-335" aria-hidden="true" tabindex="-1"></a>        pdf_files <span class="op">=</span> []</span>
<span id="cb22-336"><a href="#cb22-336" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> html_file <span class="kw">in</span> html_files:</span>
<span id="cb22-337"><a href="#cb22-337" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb22-338"><a href="#cb22-338" aria-hidden="true" tabindex="-1"></a>                pdf_file <span class="op">=</span> <span class="va">self</span>.convert_html_to_pdf(html_file, wait_time<span class="op">=</span>wait_time)</span>
<span id="cb22-339"><a href="#cb22-339" aria-hidden="true" tabindex="-1"></a>                pdf_files.append(pdf_file)</span>
<span id="cb22-340"><a href="#cb22-340" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb22-341"><a href="#cb22-341" aria-hidden="true" tabindex="-1"></a>                logger.error(<span class="ss">f&quot;Falha ao converter </span><span class="sc">{</span>html_file<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb22-342"><a href="#cb22-342" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span></span>
<span id="cb22-343"><a href="#cb22-343" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb22-344"><a href="#cb22-344" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> pdf_files</span>
<span id="cb22-345"><a href="#cb22-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-346"><a href="#cb22-346" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> main():</span>
<span id="cb22-347"><a href="#cb22-347" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Fun√ß√£o principal para execu√ß√£o via linha de comando&quot;&quot;&quot;</span></span>
<span id="cb22-348"><a href="#cb22-348" aria-hidden="true" tabindex="-1"></a>    parser <span class="op">=</span> argparse.ArgumentParser(description<span class="op">=</span><span class="st">&#39;Conversor de HTML para PDF usando Selenium&#39;</span>)</span>
<span id="cb22-349"><a href="#cb22-349" aria-hidden="true" tabindex="-1"></a>    parser.add_argument(<span class="st">&#39;input&#39;</span>, <span class="bu">help</span><span class="op">=</span><span class="st">&#39;Arquivo HTML de entrada ou diret√≥rio&#39;</span>)</span>
<span id="cb22-350"><a href="#cb22-350" aria-hidden="true" tabindex="-1"></a>    parser.add_argument(<span class="st">&#39;-o&#39;</span>, <span class="st">&#39;--output&#39;</span>, <span class="bu">help</span><span class="op">=</span><span class="st">&#39;Arquivo PDF de sa√≠da&#39;</span>)</span>
<span id="cb22-351"><a href="#cb22-351" aria-hidden="true" tabindex="-1"></a>    parser.add_argument(<span class="st">&#39;-d&#39;</span>, <span class="st">&#39;--output-dir&#39;</span>, default<span class="op">=</span><span class="st">&#39;output_pdfs&#39;</span>, </span>
<span id="cb22-352"><a href="#cb22-352" aria-hidden="true" tabindex="-1"></a>                       <span class="bu">help</span><span class="op">=</span><span class="st">&#39;Diret√≥rio de sa√≠da para m√∫ltiplos arquivos&#39;</span>)</span>
<span id="cb22-353"><a href="#cb22-353" aria-hidden="true" tabindex="-1"></a>    parser.add_argument(<span class="st">&#39;-w&#39;</span>, <span class="st">&#39;--wait-time&#39;</span>, <span class="bu">type</span><span class="op">=</span><span class="bu">int</span>, default<span class="op">=</span><span class="dv">3</span>,</span>
<span id="cb22-354"><a href="#cb22-354" aria-hidden="true" tabindex="-1"></a>                       <span class="bu">help</span><span class="op">=</span><span class="st">&#39;Tempo de espera para carregamento (segundos)&#39;</span>)</span>
<span id="cb22-355"><a href="#cb22-355" aria-hidden="true" tabindex="-1"></a>    parser.add_argument(<span class="st">&#39;--chrome-path&#39;</span>, <span class="bu">help</span><span class="op">=</span><span class="st">&#39;Caminho personalizado para Chrome&#39;</span>)</span>
<span id="cb22-356"><a href="#cb22-356" aria-hidden="true" tabindex="-1"></a>    parser.add_argument(<span class="st">&#39;-v&#39;</span>, <span class="st">&#39;--verbose&#39;</span>, action<span class="op">=</span><span class="st">&#39;store_true&#39;</span>, </span>
<span id="cb22-357"><a href="#cb22-357" aria-hidden="true" tabindex="-1"></a>                       <span class="bu">help</span><span class="op">=</span><span class="st">&#39;Modo verboso&#39;</span>)</span>
<span id="cb22-358"><a href="#cb22-358" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb22-359"><a href="#cb22-359" aria-hidden="true" tabindex="-1"></a>    args <span class="op">=</span> parser.parse_args()</span>
<span id="cb22-360"><a href="#cb22-360" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb22-361"><a href="#cb22-361" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> args.verbose:</span>
<span id="cb22-362"><a href="#cb22-362" aria-hidden="true" tabindex="-1"></a>        logging.getLogger().setLevel(logging.DEBUG)</span>
<span id="cb22-363"><a href="#cb22-363" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb22-364"><a href="#cb22-364" aria-hidden="true" tabindex="-1"></a>    converter <span class="op">=</span> HTMLToPDFConverterSelenium(</span>
<span id="cb22-365"><a href="#cb22-365" aria-hidden="true" tabindex="-1"></a>        output_dir<span class="op">=</span>args.output_dir,</span>
<span id="cb22-366"><a href="#cb22-366" aria-hidden="true" tabindex="-1"></a>        chrome_path<span class="op">=</span>args.chrome_path</span>
<span id="cb22-367"><a href="#cb22-367" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb22-368"><a href="#cb22-368" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb22-369"><a href="#cb22-369" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb22-370"><a href="#cb22-370" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Verificar se √© arquivo ou diret√≥rio</span></span>
<span id="cb22-371"><a href="#cb22-371" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> os.path.isfile(args.<span class="bu">input</span>):</span>
<span id="cb22-372"><a href="#cb22-372" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Converter √∫nico arquivo</span></span>
<span id="cb22-373"><a href="#cb22-373" aria-hidden="true" tabindex="-1"></a>            converter.convert_html_to_pdf(</span>
<span id="cb22-374"><a href="#cb22-374" aria-hidden="true" tabindex="-1"></a>                input_html<span class="op">=</span>args.<span class="bu">input</span>,</span>
<span id="cb22-375"><a href="#cb22-375" aria-hidden="true" tabindex="-1"></a>                output_pdf<span class="op">=</span>args.output,</span>
<span id="cb22-376"><a href="#cb22-376" aria-hidden="true" tabindex="-1"></a>                wait_time<span class="op">=</span>args.wait_time</span>
<span id="cb22-377"><a href="#cb22-377" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb22-378"><a href="#cb22-378" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> os.path.isdir(args.<span class="bu">input</span>):</span>
<span id="cb22-379"><a href="#cb22-379" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Converter todos os arquivos HTML do diret√≥rio</span></span>
<span id="cb22-380"><a href="#cb22-380" aria-hidden="true" tabindex="-1"></a>            html_files <span class="op">=</span> <span class="bu">list</span>(Path(args.<span class="bu">input</span>).glob(<span class="st">&quot;*.html&quot;</span>))</span>
<span id="cb22-381"><a href="#cb22-381" aria-hidden="true" tabindex="-1"></a>            html_files.extend(Path(args.<span class="bu">input</span>).glob(<span class="st">&quot;*.htm&quot;</span>))</span>
<span id="cb22-382"><a href="#cb22-382" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb22-383"><a href="#cb22-383" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> html_files:</span>
<span id="cb22-384"><a href="#cb22-384" aria-hidden="true" tabindex="-1"></a>                logger.warning(<span class="ss">f&quot;Nenhum arquivo HTML encontrado em </span><span class="sc">{</span>args<span class="sc">.</span><span class="bu">input</span><span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb22-385"><a href="#cb22-385" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span></span>
<span id="cb22-386"><a href="#cb22-386" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb22-387"><a href="#cb22-387" aria-hidden="true" tabindex="-1"></a>            logger.info(<span class="ss">f&quot;Encontrados </span><span class="sc">{</span><span class="bu">len</span>(html_files)<span class="sc">}</span><span class="ss"> arquivos HTML&quot;</span>)</span>
<span id="cb22-388"><a href="#cb22-388" aria-hidden="true" tabindex="-1"></a>            pdf_files <span class="op">=</span> converter.convert_multiple_files(html_files, wait_time<span class="op">=</span>args.wait_time)</span>
<span id="cb22-389"><a href="#cb22-389" aria-hidden="true" tabindex="-1"></a>            logger.info(<span class="ss">f&quot;‚úÖ Convers√£o conclu√≠da: </span><span class="sc">{</span><span class="bu">len</span>(pdf_files)<span class="sc">}</span><span class="ss"> arquivos processados&quot;</span>)</span>
<span id="cb22-390"><a href="#cb22-390" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb22-391"><a href="#cb22-391" aria-hidden="true" tabindex="-1"></a>            logger.error(<span class="ss">f&quot;Entrada inv√°lida: </span><span class="sc">{</span>args<span class="sc">.</span><span class="bu">input</span><span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb22-392"><a href="#cb22-392" aria-hidden="true" tabindex="-1"></a>            sys.exit(<span class="dv">1</span>)</span>
<span id="cb22-393"><a href="#cb22-393" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb22-394"><a href="#cb22-394" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb22-395"><a href="#cb22-395" aria-hidden="true" tabindex="-1"></a>        logger.error(<span class="ss">f&quot;Erro durante a convers√£o: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb22-396"><a href="#cb22-396" aria-hidden="true" tabindex="-1"></a>        sys.exit(<span class="dv">1</span>)</span>
<span id="cb22-397"><a href="#cb22-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-398"><a href="#cb22-398" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&quot;__main__&quot;</span>:</span>
<span id="cb22-399"><a href="#cb22-399" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Verificar depend√™ncias</span></span>
<span id="cb22-400"><a href="#cb22-400" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb22-401"><a href="#cb22-401" aria-hidden="true" tabindex="-1"></a>        <span class="im">import</span> selenium</span>
<span id="cb22-402"><a href="#cb22-402" aria-hidden="true" tabindex="-1"></a>        <span class="im">import</span> webdriver_manager</span>
<span id="cb22-403"><a href="#cb22-403" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">ImportError</span>:</span>
<span id="cb22-404"><a href="#cb22-404" aria-hidden="true" tabindex="-1"></a>        logger.error(<span class="st">&quot;Depend√™ncias n√£o instaladas. Execute:&quot;</span>)</span>
<span id="cb22-405"><a href="#cb22-405" aria-hidden="true" tabindex="-1"></a>        logger.error(<span class="st">&quot;pip install selenium webdriver-manager&quot;</span>)</span>
<span id="cb22-406"><a href="#cb22-406" aria-hidden="true" tabindex="-1"></a>        sys.exit(<span class="dv">1</span>)</span>
<span id="cb22-407"><a href="#cb22-407" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb22-408"><a href="#cb22-408" aria-hidden="true" tabindex="-1"></a>    main()</span></code></pre></div>
<h2 data-number="1.16" id="instala√ß√£o-das-depend√™ncias-1"><span class="header-section-number">1.16</span> üì¶ <strong>Instala√ß√£o das
Depend√™ncias:</strong></h2>
<div class="sourceCode" id="cb23"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Criar ambiente conda</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="ex">conda</span> create <span class="at">-n</span> html2pdf python=3.9</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="ex">conda</span> activate html2pdf</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Instalar depend√™ncias</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install selenium webdriver-manager</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Verificar se o Chrome est√° instalado</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Download: https://www.google.com/chrome/</span></span></code></pre></div>
<h2 data-number="1.17" id="como-usar-1"><span class="header-section-number">1.17</span> üöÄ <strong>Como
Usar:</strong></h2>
<div class="sourceCode" id="cb24"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convers√£o b√°sica</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> html_to_pdf_selenium.py exemplo_completo.html</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Com mais tempo de espera para f√≥rmulas matem√°ticas</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> html_to_pdf_selenium.py exemplo_completo.html <span class="at">-w</span> 5</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Output personalizado</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> html_to_pdf_selenium.py exemplo_completo.html <span class="at">-o</span> meu_documento.pdf</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Modo verboso</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> html_to_pdf_selenium.py exemplo_completo.html <span class="at">-v</span></span></code></pre></div>
<h2 data-number="1.18" id="vantagens-desta-solu√ß√£o"><span class="header-section-number">1.18</span> ‚úÖ <strong>Vantagens desta
Solu√ß√£o:</strong></h2>
<ul>
<li><strong>üéØ 100% funcional</strong> - N√£o depende de bibliotecas
problem√°ticas</li>
<li><strong>üìä F√≥rmulas matem√°ticas perfeitas</strong> - Chrome
renderiza MathJax perfeitamente</li>
<li><strong>üòä Emojis nativos</strong> - Suporte completo a emojis</li>
<li><strong>üé® CSS completo</strong> - Todos os estilos s√£o
preservados</li>
<li><strong>‚ö° Confi√°vel</strong> - Funciona consistentemente no
Windows</li>
<li><strong>üîß F√°cil instala√ß√£o</strong> - Depend√™ncias simples</li>
</ul>
<p><strong>Esta solu√ß√£o vai funcionar perfeitamente</strong> para seu
documento com f√≥rmulas matem√°ticas e emojis! üéâ</p>
<hr />
<h3 data-number="1.18.1" id="utilizador-2025-11-01-033709-deepseek-chat"><span class="header-section-number">1.18.1</span> üë§ Utilizador
<em>(2025-11-01 03:37:09)</em> <em>[deepseek-chat]</em></h3>
<p>python html_to_pdf_selenium.py exemplo_completo.html pdf correcto
embora alguns emojis n√£o estejam coloridos</p>
<hr />
<h3 data-number="1.18.2" id="deepseek-2025-11-01-033709-deepseek-chat"><span class="header-section-number">1.18.2</span> ü§ñ DeepSeek <em>(2025-11-01
03:37:09)</em> <em>[deepseek-chat]</em></h3>
<p>Excelente que funcionou! üéâ O problema dos emojis n√£o coloridos √©
comum. Vou fornecer uma vers√£o melhorada que resolve isso:</p>
<h2 data-number="1.19" id="script-melhorado-html_to_pdf_selenium_enhanced.py"><span class="header-section-number">1.19</span> üî• <strong>Script Melhorado:
html_to_pdf_selenium_enhanced.py</strong></h2>
<div class="sourceCode" id="cb25"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/usr/bin/env python3</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="co">&quot;&quot;&quot;</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="co">html_to_pdf_selenium_enhanced.py - Conversor HTML para PDF com suporte completo a emojis coloridos</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="co">&quot;&quot;&quot;</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sys</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> argparse</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tempfile</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> logging</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> time</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> selenium <span class="im">import</span> webdriver</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> selenium.webdriver.chrome.options <span class="im">import</span> Options</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> selenium.webdriver.chrome.service <span class="im">import</span> Service</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> webdriver_manager.chrome <span class="im">import</span> ChromeDriverManager</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Configurar logging</span></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>logging.basicConfig(level<span class="op">=</span>logging.INFO, <span class="bu">format</span><span class="op">=</span><span class="st">&#39;</span><span class="sc">%(asctime)s</span><span class="st"> - </span><span class="sc">%(levelname)s</span><span class="st"> - </span><span class="sc">%(message)s</span><span class="st">&#39;</span>)</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>logger <span class="op">=</span> logging.getLogger(<span class="va">__name__</span>)</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> HTMLToPDFConverterEnhanced:</span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, output_dir<span class="op">=</span><span class="st">&quot;output_pdfs&quot;</span>, chrome_path<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.output_dir <span class="op">=</span> output_dir</span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.chrome_path <span class="op">=</span> chrome_path</span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>._ensure_output_dir()</span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _ensure_output_dir(<span class="va">self</span>):</span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Cria o diret√≥rio de output se n√£o existir&quot;&quot;&quot;</span></span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a>        Path(<span class="va">self</span>.output_dir).mkdir(exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _setup_chrome_driver(<span class="va">self</span>):</span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Configura o Chrome driver para PDF generation com suporte a emojis&quot;&quot;&quot;</span></span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a>        chrome_options <span class="op">=</span> Options()</span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-36"><a href="#cb25-36" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Configura√ß√µes para modo headless e PDF</span></span>
<span id="cb25-37"><a href="#cb25-37" aria-hidden="true" tabindex="-1"></a>        chrome_options.add_argument(<span class="st">&quot;--headless=new&quot;</span>)</span>
<span id="cb25-38"><a href="#cb25-38" aria-hidden="true" tabindex="-1"></a>        chrome_options.add_argument(<span class="st">&quot;--disable-gpu&quot;</span>)</span>
<span id="cb25-39"><a href="#cb25-39" aria-hidden="true" tabindex="-1"></a>        chrome_options.add_argument(<span class="st">&quot;--disable-dev-shm-usage&quot;</span>)</span>
<span id="cb25-40"><a href="#cb25-40" aria-hidden="true" tabindex="-1"></a>        chrome_options.add_argument(<span class="st">&quot;--no-sandbox&quot;</span>)</span>
<span id="cb25-41"><a href="#cb25-41" aria-hidden="true" tabindex="-1"></a>        chrome_options.add_argument(<span class="st">&quot;--disable-extensions&quot;</span>)</span>
<span id="cb25-42"><a href="#cb25-42" aria-hidden="true" tabindex="-1"></a>        chrome_options.add_argument(<span class="st">&quot;--disable-software-rasterizer&quot;</span>)</span>
<span id="cb25-43"><a href="#cb25-43" aria-hidden="true" tabindex="-1"></a>        chrome_options.add_argument(<span class="st">&quot;--disable-features=VizDisplayCompositor&quot;</span>)</span>
<span id="cb25-44"><a href="#cb25-44" aria-hidden="true" tabindex="-1"></a>        chrome_options.add_argument(<span class="st">&quot;--disable-background-timer-throttling&quot;</span>)</span>
<span id="cb25-45"><a href="#cb25-45" aria-hidden="true" tabindex="-1"></a>        chrome_options.add_argument(<span class="st">&quot;--disable-backgrounding-occluded-windows&quot;</span>)</span>
<span id="cb25-46"><a href="#cb25-46" aria-hidden="true" tabindex="-1"></a>        chrome_options.add_argument(<span class="st">&quot;--disable-renderer-backgrounding&quot;</span>)</span>
<span id="cb25-47"><a href="#cb25-47" aria-hidden="true" tabindex="-1"></a>        chrome_options.add_argument(<span class="st">&quot;--window-size=1920,1080&quot;</span>)</span>
<span id="cb25-48"><a href="#cb25-48" aria-hidden="true" tabindex="-1"></a>        chrome_options.add_argument(<span class="st">&quot;--force-color-profile=srgb&quot;</span>)  <span class="co"># Melhor cores</span></span>
<span id="cb25-49"><a href="#cb25-49" aria-hidden="true" tabindex="-1"></a>        chrome_options.add_argument(<span class="st">&quot;--enable-font-antialiasing&quot;</span>)  <span class="co"># Melhor fonts</span></span>
<span id="cb25-50"><a href="#cb25-50" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-51"><a href="#cb25-51" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Configura√ß√µes espec√≠ficas para PDF</span></span>
<span id="cb25-52"><a href="#cb25-52" aria-hidden="true" tabindex="-1"></a>        chrome_options.add_argument(<span class="st">&quot;--print-to-pdf-no-header&quot;</span>)</span>
<span id="cb25-53"><a href="#cb25-53" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-54"><a href="#cb25-54" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Configura√ß√µes para emojis coloridos</span></span>
<span id="cb25-55"><a href="#cb25-55" aria-hidden="true" tabindex="-1"></a>        chrome_options.add_argument(<span class="st">&quot;--enable-features=EmojiRendering&quot;</span>)</span>
<span id="cb25-56"><a href="#cb25-56" aria-hidden="true" tabindex="-1"></a>        chrome_options.add_argument(<span class="st">&quot;--enable-native-gpu-memory-buffers&quot;</span>)</span>
<span id="cb25-57"><a href="#cb25-57" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-58"><a href="#cb25-58" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Configurar caminho do Chrome se especificado</span></span>
<span id="cb25-59"><a href="#cb25-59" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.chrome_path <span class="kw">and</span> os.path.exists(<span class="va">self</span>.chrome_path):</span>
<span id="cb25-60"><a href="#cb25-60" aria-hidden="true" tabindex="-1"></a>            chrome_options.binary_location <span class="op">=</span> <span class="va">self</span>.chrome_path</span>
<span id="cb25-61"><a href="#cb25-61" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-62"><a href="#cb25-62" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb25-63"><a href="#cb25-63" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Usar webdriver_manager para baixar automaticamente o driver correto</span></span>
<span id="cb25-64"><a href="#cb25-64" aria-hidden="true" tabindex="-1"></a>            service <span class="op">=</span> Service(ChromeDriverManager().install())</span>
<span id="cb25-65"><a href="#cb25-65" aria-hidden="true" tabindex="-1"></a>            driver <span class="op">=</span> webdriver.Chrome(service<span class="op">=</span>service, options<span class="op">=</span>chrome_options)</span>
<span id="cb25-66"><a href="#cb25-66" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> driver</span>
<span id="cb25-67"><a href="#cb25-67" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb25-68"><a href="#cb25-68" aria-hidden="true" tabindex="-1"></a>            logger.error(<span class="ss">f&quot;Erro ao configurar Chrome driver: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb25-69"><a href="#cb25-69" aria-hidden="true" tabindex="-1"></a>            <span class="cf">raise</span></span>
<span id="cb25-70"><a href="#cb25-70" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-71"><a href="#cb25-71" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _add_enhanced_styles(<span class="va">self</span>, html_content):</span>
<span id="cb25-72"><a href="#cb25-72" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Adiciona estilos CSS para melhor impress√£o e emojis coloridos&quot;&quot;&quot;</span></span>
<span id="cb25-73"><a href="#cb25-73" aria-hidden="true" tabindex="-1"></a>        enhanced_styles <span class="op">=</span> <span class="st">&quot;&quot;&quot;</span></span>
<span id="cb25-74"><a href="#cb25-74" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;style&gt;</span></span>
<span id="cb25-75"><a href="#cb25-75" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Estilos para impress√£o com suporte a emojis */</span></span>
<span id="cb25-76"><a href="#cb25-76" aria-hidden="true" tabindex="-1"></a><span class="st">            @media print {</span></span>
<span id="cb25-77"><a href="#cb25-77" aria-hidden="true" tabindex="-1"></a><span class="st">                body {</span></span>
<span id="cb25-78"><a href="#cb25-78" aria-hidden="true" tabindex="-1"></a><span class="st">                    font-family: &quot;Arial&quot;, &quot;Segoe UI Emoji&quot;, &quot;Apple Color Emoji&quot;, &quot;DejaVu Sans&quot;, sans-serif !important;</span></span>
<span id="cb25-79"><a href="#cb25-79" aria-hidden="true" tabindex="-1"></a><span class="st">                    line-height: 1.6 !important;</span></span>
<span id="cb25-80"><a href="#cb25-80" aria-hidden="true" tabindex="-1"></a><span class="st">                    color: #333 !important;</span></span>
<span id="cb25-81"><a href="#cb25-81" aria-hidden="true" tabindex="-1"></a><span class="st">                    max-width: 100% !important;</span></span>
<span id="cb25-82"><a href="#cb25-82" aria-hidden="true" tabindex="-1"></a><span class="st">                    margin: 0 auto !important;</span></span>
<span id="cb25-83"><a href="#cb25-83" aria-hidden="true" tabindex="-1"></a><span class="st">                    padding: 20px !important;</span></span>
<span id="cb25-84"><a href="#cb25-84" aria-hidden="true" tabindex="-1"></a><span class="st">                    font-size: 12px !important;</span></span>
<span id="cb25-85"><a href="#cb25-85" aria-hidden="true" tabindex="-1"></a><span class="st">                    -webkit-print-color-adjust: exact !important;</span></span>
<span id="cb25-86"><a href="#cb25-86" aria-hidden="true" tabindex="-1"></a><span class="st">                    print-color-adjust: exact !important;</span></span>
<span id="cb25-87"><a href="#cb25-87" aria-hidden="true" tabindex="-1"></a><span class="st">                }</span></span>
<span id="cb25-88"><a href="#cb25-88" aria-hidden="true" tabindex="-1"></a><span class="st">                </span></span>
<span id="cb25-89"><a href="#cb25-89" aria-hidden="true" tabindex="-1"></a><span class="st">                /* For√ßar emojis coloridos */</span></span>
<span id="cb25-90"><a href="#cb25-90" aria-hidden="true" tabindex="-1"></a><span class="st">                .emoji, span.emoji {</span></span>
<span id="cb25-91"><a href="#cb25-91" aria-hidden="true" tabindex="-1"></a><span class="st">                    font-family: &quot;Segoe UI Emoji&quot;, &quot;Apple Color Emoji&quot;, &quot;Noto Color Emoji&quot;, sans-serif !important;</span></span>
<span id="cb25-92"><a href="#cb25-92" aria-hidden="true" tabindex="-1"></a><span class="st">                    font-weight: normal !important;</span></span>
<span id="cb25-93"><a href="#cb25-93" aria-hidden="true" tabindex="-1"></a><span class="st">                }</span></span>
<span id="cb25-94"><a href="#cb25-94" aria-hidden="true" tabindex="-1"></a><span class="st">                </span></span>
<span id="cb25-95"><a href="#cb25-95" aria-hidden="true" tabindex="-1"></a><span class="st">                h1, h2, h3, h4, h5, h6 {</span></span>
<span id="cb25-96"><a href="#cb25-96" aria-hidden="true" tabindex="-1"></a><span class="st">                    color: #1565C0 !important;</span></span>
<span id="cb25-97"><a href="#cb25-97" aria-hidden="true" tabindex="-1"></a><span class="st">                    margin-top: 1.2em !important;</span></span>
<span id="cb25-98"><a href="#cb25-98" aria-hidden="true" tabindex="-1"></a><span class="st">                    margin-bottom: 0.5em !important;</span></span>
<span id="cb25-99"><a href="#cb25-99" aria-hidden="true" tabindex="-1"></a><span class="st">                    page-break-after: avoid !important;</span></span>
<span id="cb25-100"><a href="#cb25-100" aria-hidden="true" tabindex="-1"></a><span class="st">                    font-family: &quot;Arial&quot;, &quot;Segoe UI Emoji&quot;, sans-serif !important;</span></span>
<span id="cb25-101"><a href="#cb25-101" aria-hidden="true" tabindex="-1"></a><span class="st">                }</span></span>
<span id="cb25-102"><a href="#cb25-102" aria-hidden="true" tabindex="-1"></a><span class="st">                </span></span>
<span id="cb25-103"><a href="#cb25-103" aria-hidden="true" tabindex="-1"></a><span class="st">                h1 {</span></span>
<span id="cb25-104"><a href="#cb25-104" aria-hidden="true" tabindex="-1"></a><span class="st">                    font-size: 18px !important;</span></span>
<span id="cb25-105"><a href="#cb25-105" aria-hidden="true" tabindex="-1"></a><span class="st">                    border-bottom: 2px solid #1565C0 !important;</span></span>
<span id="cb25-106"><a href="#cb25-106" aria-hidden="true" tabindex="-1"></a><span class="st">                    padding-bottom: 0.3em !important;</span></span>
<span id="cb25-107"><a href="#cb25-107" aria-hidden="true" tabindex="-1"></a><span class="st">                }</span></span>
<span id="cb25-108"><a href="#cb25-108" aria-hidden="true" tabindex="-1"></a><span class="st">                </span></span>
<span id="cb25-109"><a href="#cb25-109" aria-hidden="true" tabindex="-1"></a><span class="st">                h2 { font-size: 16px !important; }</span></span>
<span id="cb25-110"><a href="#cb25-110" aria-hidden="true" tabindex="-1"></a><span class="st">                h3 { font-size: 14px !important; }</span></span>
<span id="cb25-111"><a href="#cb25-111" aria-hidden="true" tabindex="-1"></a><span class="st">                </span></span>
<span id="cb25-112"><a href="#cb25-112" aria-hidden="true" tabindex="-1"></a><span class="st">                /* C√≥digo - garantir cores */</span></span>
<span id="cb25-113"><a href="#cb25-113" aria-hidden="true" tabindex="-1"></a><span class="st">                pre, code {</span></span>
<span id="cb25-114"><a href="#cb25-114" aria-hidden="true" tabindex="-1"></a><span class="st">                    font-family: &quot;Consolas&quot;, &quot;Monaco&quot;, &quot;Courier New&quot;, monospace !important;</span></span>
<span id="cb25-115"><a href="#cb25-115" aria-hidden="true" tabindex="-1"></a><span class="st">                    background-color: #f6f8fa !important;</span></span>
<span id="cb25-116"><a href="#cb25-116" aria-hidden="true" tabindex="-1"></a><span class="st">                    border: 1px solid #e1e4e8 !important;</span></span>
<span id="cb25-117"><a href="#cb25-117" aria-hidden="true" tabindex="-1"></a><span class="st">                    border-radius: 5px !important;</span></span>
<span id="cb25-118"><a href="#cb25-118" aria-hidden="true" tabindex="-1"></a><span class="st">                    color: #24292e !important;</span></span>
<span id="cb25-119"><a href="#cb25-119" aria-hidden="true" tabindex="-1"></a><span class="st">                }</span></span>
<span id="cb25-120"><a href="#cb25-120" aria-hidden="true" tabindex="-1"></a><span class="st">                </span></span>
<span id="cb25-121"><a href="#cb25-121" aria-hidden="true" tabindex="-1"></a><span class="st">                pre {</span></span>
<span id="cb25-122"><a href="#cb25-122" aria-hidden="true" tabindex="-1"></a><span class="st">                    padding: 12px !important;</span></span>
<span id="cb25-123"><a href="#cb25-123" aria-hidden="true" tabindex="-1"></a><span class="st">                    page-break-inside: avoid !important;</span></span>
<span id="cb25-124"><a href="#cb25-124" aria-hidden="true" tabindex="-1"></a><span class="st">                    font-size: 11px !important;</span></span>
<span id="cb25-125"><a href="#cb25-125" aria-hidden="true" tabindex="-1"></a><span class="st">                    white-space: pre-wrap !important;</span></span>
<span id="cb25-126"><a href="#cb25-126" aria-hidden="true" tabindex="-1"></a><span class="st">                }</span></span>
<span id="cb25-127"><a href="#cb25-127" aria-hidden="true" tabindex="-1"></a><span class="st">                </span></span>
<span id="cb25-128"><a href="#cb25-128" aria-hidden="true" tabindex="-1"></a><span class="st">                code {</span></span>
<span id="cb25-129"><a href="#cb25-129" aria-hidden="true" tabindex="-1"></a><span class="st">                    padding: 2px 4px !important;</span></span>
<span id="cb25-130"><a href="#cb25-130" aria-hidden="true" tabindex="-1"></a><span class="st">                    font-size: 11px !important;</span></span>
<span id="cb25-131"><a href="#cb25-131" aria-hidden="true" tabindex="-1"></a><span class="st">                }</span></span>
<span id="cb25-132"><a href="#cb25-132" aria-hidden="true" tabindex="-1"></a><span class="st">                </span></span>
<span id="cb25-133"><a href="#cb25-133" aria-hidden="true" tabindex="-1"></a><span class="st">                /* Syntax highlighting - cores for√ßadas */</span></span>
<span id="cb25-134"><a href="#cb25-134" aria-hidden="true" tabindex="-1"></a><span class="st">                .sourceCode span.al { color: #ff0000 !important; font-weight: bold !important; }</span></span>
<span id="cb25-135"><a href="#cb25-135" aria-hidden="true" tabindex="-1"></a><span class="st">                .sourceCode span.an { color: #60a0b0 !important; font-weight: bold !important; font-style: italic !important; }</span></span>
<span id="cb25-136"><a href="#cb25-136" aria-hidden="true" tabindex="-1"></a><span class="st">                .sourceCode span.at { color: #7d9029 !important; }</span></span>
<span id="cb25-137"><a href="#cb25-137" aria-hidden="true" tabindex="-1"></a><span class="st">                .sourceCode span.bn { color: #40a070 !important; }</span></span>
<span id="cb25-138"><a href="#cb25-138" aria-hidden="true" tabindex="-1"></a><span class="st">                .sourceCode span.bu { color: #008000 !important; }</span></span>
<span id="cb25-139"><a href="#cb25-139" aria-hidden="true" tabindex="-1"></a><span class="st">                .sourceCode span.cf { color: #007020 !important; font-weight: bold !important; }</span></span>
<span id="cb25-140"><a href="#cb25-140" aria-hidden="true" tabindex="-1"></a><span class="st">                .sourceCode span.ch { color: #4070a0 !important; }</span></span>
<span id="cb25-141"><a href="#cb25-141" aria-hidden="true" tabindex="-1"></a><span class="st">                .sourceCode span.cn { color: #880000 !important; }</span></span>
<span id="cb25-142"><a href="#cb25-142" aria-hidden="true" tabindex="-1"></a><span class="st">                .sourceCode span.co { color: #60a0b0 !important; font-style: italic !important; }</span></span>
<span id="cb25-143"><a href="#cb25-143" aria-hidden="true" tabindex="-1"></a><span class="st">                .sourceCode span.cv { color: #60a0b0 !important; font-weight: bold !important; font-style: italic !important; }</span></span>
<span id="cb25-144"><a href="#cb25-144" aria-hidden="true" tabindex="-1"></a><span class="st">                .sourceCode span.do { color: #ba2121 !important; font-style: italic !important; }</span></span>
<span id="cb25-145"><a href="#cb25-145" aria-hidden="true" tabindex="-1"></a><span class="st">                .sourceCode span.dt { color: #902000 !important; }</span></span>
<span id="cb25-146"><a href="#cb25-146" aria-hidden="true" tabindex="-1"></a><span class="st">                .sourceCode span.dv { color: #40a070 !important; }</span></span>
<span id="cb25-147"><a href="#cb25-147" aria-hidden="true" tabindex="-1"></a><span class="st">                .sourceCode span.er { color: #ff0000 !important; font-weight: bold !important; }</span></span>
<span id="cb25-148"><a href="#cb25-148" aria-hidden="true" tabindex="-1"></a><span class="st">                .sourceCode span.ex { color: #007020 !important; }</span></span>
<span id="cb25-149"><a href="#cb25-149" aria-hidden="true" tabindex="-1"></a><span class="st">                .sourceCode span.fl { color: #40a070 !important; }</span></span>
<span id="cb25-150"><a href="#cb25-150" aria-hidden="true" tabindex="-1"></a><span class="st">                .sourceCode span.fu { color: #06287e !important; }</span></span>
<span id="cb25-151"><a href="#cb25-151" aria-hidden="true" tabindex="-1"></a><span class="st">                .sourceCode span.im { color: #008000 !important; font-weight: bold !important; }</span></span>
<span id="cb25-152"><a href="#cb25-152" aria-hidden="true" tabindex="-1"></a><span class="st">                .sourceCode span.in { color: #60a0b0 !important; font-weight: bold !important; font-style: italic !important; }</span></span>
<span id="cb25-153"><a href="#cb25-153" aria-hidden="true" tabindex="-1"></a><span class="st">                .sourceCode span.kw { color: #007020 !important; font-weight: bold !important; }</span></span>
<span id="cb25-154"><a href="#cb25-154" aria-hidden="true" tabindex="-1"></a><span class="st">                .sourceCode span.op { color: #666666 !important; }</span></span>
<span id="cb25-155"><a href="#cb25-155" aria-hidden="true" tabindex="-1"></a><span class="st">                .sourceCode span.ot { color: #007020 !important; }</span></span>
<span id="cb25-156"><a href="#cb25-156" aria-hidden="true" tabindex="-1"></a><span class="st">                .sourceCode span.pp { color: #bc7a00 !important; }</span></span>
<span id="cb25-157"><a href="#cb25-157" aria-hidden="true" tabindex="-1"></a><span class="st">                .sourceCode span.sc { color: #4070a0 !important; }</span></span>
<span id="cb25-158"><a href="#cb25-158" aria-hidden="true" tabindex="-1"></a><span class="st">                .sourceCode span.ss { color: #bb6688 !important; }</span></span>
<span id="cb25-159"><a href="#cb25-159" aria-hidden="true" tabindex="-1"></a><span class="st">                .sourceCode span.st { color: #4070a0 !important; }</span></span>
<span id="cb25-160"><a href="#cb25-160" aria-hidden="true" tabindex="-1"></a><span class="st">                .sourceCode span.va { color: #19177c !important; }</span></span>
<span id="cb25-161"><a href="#cb25-161" aria-hidden="true" tabindex="-1"></a><span class="st">                .sourceCode span.vs { color: #4070a0 !important; }</span></span>
<span id="cb25-162"><a href="#cb25-162" aria-hidden="true" tabindex="-1"></a><span class="st">                .sourceCode span.wa { color: #60a0b0 !important; font-weight: bold !important; font-style: italic !important; }</span></span>
<span id="cb25-163"><a href="#cb25-163" aria-hidden="true" tabindex="-1"></a><span class="st">                </span></span>
<span id="cb25-164"><a href="#cb25-164" aria-hidden="true" tabindex="-1"></a><span class="st">                /* Tabelas */</span></span>
<span id="cb25-165"><a href="#cb25-165" aria-hidden="true" tabindex="-1"></a><span class="st">                table {</span></span>
<span id="cb25-166"><a href="#cb25-166" aria-hidden="true" tabindex="-1"></a><span class="st">                    border-collapse: collapse !important;</span></span>
<span id="cb25-167"><a href="#cb25-167" aria-hidden="true" tabindex="-1"></a><span class="st">                    width: 100% !important;</span></span>
<span id="cb25-168"><a href="#cb25-168" aria-hidden="true" tabindex="-1"></a><span class="st">                    margin: 1em 0 !important;</span></span>
<span id="cb25-169"><a href="#cb25-169" aria-hidden="true" tabindex="-1"></a><span class="st">                    page-break-inside: avoid !important;</span></span>
<span id="cb25-170"><a href="#cb25-170" aria-hidden="true" tabindex="-1"></a><span class="st">                    font-size: 11px !important;</span></span>
<span id="cb25-171"><a href="#cb25-171" aria-hidden="true" tabindex="-1"></a><span class="st">                }</span></span>
<span id="cb25-172"><a href="#cb25-172" aria-hidden="true" tabindex="-1"></a><span class="st">                </span></span>
<span id="cb25-173"><a href="#cb25-173" aria-hidden="true" tabindex="-1"></a><span class="st">                th, td {</span></span>
<span id="cb25-174"><a href="#cb25-174" aria-hidden="true" tabindex="-1"></a><span class="st">                    border: 1px solid #ddd !important;</span></span>
<span id="cb25-175"><a href="#cb25-175" aria-hidden="true" tabindex="-1"></a><span class="st">                    padding: 6px 10px !important;</span></span>
<span id="cb25-176"><a href="#cb25-176" aria-hidden="true" tabindex="-1"></a><span class="st">                    text-align: left !important;</span></span>
<span id="cb25-177"><a href="#cb25-177" aria-hidden="true" tabindex="-1"></a><span class="st">                }</span></span>
<span id="cb25-178"><a href="#cb25-178" aria-hidden="true" tabindex="-1"></a><span class="st">                </span></span>
<span id="cb25-179"><a href="#cb25-179" aria-hidden="true" tabindex="-1"></a><span class="st">                th {</span></span>
<span id="cb25-180"><a href="#cb25-180" aria-hidden="true" tabindex="-1"></a><span class="st">                    background-color: #f2f2f2 !important;</span></span>
<span id="cb25-181"><a href="#cb25-181" aria-hidden="true" tabindex="-1"></a><span class="st">                    font-weight: bold !important;</span></span>
<span id="cb25-182"><a href="#cb25-182" aria-hidden="true" tabindex="-1"></a><span class="st">                    color: #000 !important;</span></span>
<span id="cb25-183"><a href="#cb25-183" aria-hidden="true" tabindex="-1"></a><span class="st">                }</span></span>
<span id="cb25-184"><a href="#cb25-184" aria-hidden="true" tabindex="-1"></a><span class="st">                </span></span>
<span id="cb25-185"><a href="#cb25-185" aria-hidden="true" tabindex="-1"></a><span class="st">                /* Cores para estrelas na tabela */</span></span>
<span id="cb25-186"><a href="#cb25-186" aria-hidden="true" tabindex="-1"></a><span class="st">                td:contains(&quot;‚≠ê&quot;) { color: #ffd700 !important; }</span></span>
<span id="cb25-187"><a href="#cb25-187" aria-hidden="true" tabindex="-1"></a><span class="st">                td:contains(&quot;‚òÖ&quot;) { color: #ffd700 !important; }</span></span>
<span id="cb25-188"><a href="#cb25-188" aria-hidden="true" tabindex="-1"></a><span class="st">                </span></span>
<span id="cb25-189"><a href="#cb25-189" aria-hidden="true" tabindex="-1"></a><span class="st">                /* Evitar quebras de p√°gina */</span></span>
<span id="cb25-190"><a href="#cb25-190" aria-hidden="true" tabindex="-1"></a><span class="st">                h1, h2, h3 { page-break-after: avoid !important; }</span></span>
<span id="cb25-191"><a href="#cb25-191" aria-hidden="true" tabindex="-1"></a><span class="st">                pre, table, figure, .math { page-break-inside: avoid !important; }</span></span>
<span id="cb25-192"><a href="#cb25-192" aria-hidden="true" tabindex="-1"></a><span class="st">                </span></span>
<span id="cb25-193"><a href="#cb25-193" aria-hidden="true" tabindex="-1"></a><span class="st">                /* Garantir que MathJax renderize completamente */</span></span>
<span id="cb25-194"><a href="#cb25-194" aria-hidden="true" tabindex="-1"></a><span class="st">                .MathJax, mjx-container { </span></span>
<span id="cb25-195"><a href="#cb25-195" aria-hidden="true" tabindex="-1"></a><span class="st">                    display: inline-block !important;</span></span>
<span id="cb25-196"><a href="#cb25-196" aria-hidden="true" tabindex="-1"></a><span class="st">                    page-break-inside: avoid !important;</span></span>
<span id="cb25-197"><a href="#cb25-197" aria-hidden="true" tabindex="-1"></a><span class="st">                }</span></span>
<span id="cb25-198"><a href="#cb25-198" aria-hidden="true" tabindex="-1"></a><span class="st">                </span></span>
<span id="cb25-199"><a href="#cb25-199" aria-hidden="true" tabindex="-1"></a><span class="st">                /* Links */</span></span>
<span id="cb25-200"><a href="#cb25-200" aria-hidden="true" tabindex="-1"></a><span class="st">                a {</span></span>
<span id="cb25-201"><a href="#cb25-201" aria-hidden="true" tabindex="-1"></a><span class="st">                    color: #0366d6 !important;</span></span>
<span id="cb25-202"><a href="#cb25-202" aria-hidden="true" tabindex="-1"></a><span class="st">                }</span></span>
<span id="cb25-203"><a href="#cb25-203" aria-hidden="true" tabindex="-1"></a><span class="st">                </span></span>
<span id="cb25-204"><a href="#cb25-204" aria-hidden="true" tabindex="-1"></a><span class="st">                /* Blockquotes */</span></span>
<span id="cb25-205"><a href="#cb25-205" aria-hidden="true" tabindex="-1"></a><span class="st">                blockquote {</span></span>
<span id="cb25-206"><a href="#cb25-206" aria-hidden="true" tabindex="-1"></a><span class="st">                    background-color: #f9f9f9 !important;</span></span>
<span id="cb25-207"><a href="#cb25-207" aria-hidden="true" tabindex="-1"></a><span class="st">                    border-left: 4px solid #ccc !important;</span></span>
<span id="cb25-208"><a href="#cb25-208" aria-hidden="true" tabindex="-1"></a><span class="st">                    margin: 1em 0 !important;</span></span>
<span id="cb25-209"><a href="#cb25-209" aria-hidden="true" tabindex="-1"></a><span class="st">                    padding: 0.5em 1em !important;</span></span>
<span id="cb25-210"><a href="#cb25-210" aria-hidden="true" tabindex="-1"></a><span class="st">                    font-style: italic !important;</span></span>
<span id="cb25-211"><a href="#cb25-211" aria-hidden="true" tabindex="-1"></a><span class="st">                    color: #555 !important;</span></span>
<span id="cb25-212"><a href="#cb25-212" aria-hidden="true" tabindex="-1"></a><span class="st">                }</span></span>
<span id="cb25-213"><a href="#cb25-213" aria-hidden="true" tabindex="-1"></a><span class="st">                </span></span>
<span id="cb25-214"><a href="#cb25-214" aria-hidden="true" tabindex="-1"></a><span class="st">                /* Imagens */</span></span>
<span id="cb25-215"><a href="#cb25-215" aria-hidden="true" tabindex="-1"></a><span class="st">                img {</span></span>
<span id="cb25-216"><a href="#cb25-216" aria-hidden="true" tabindex="-1"></a><span class="st">                    max-width: 100% !important;</span></span>
<span id="cb25-217"><a href="#cb25-217" aria-hidden="true" tabindex="-1"></a><span class="st">                    height: auto !important;</span></span>
<span id="cb25-218"><a href="#cb25-218" aria-hidden="true" tabindex="-1"></a><span class="st">                }</span></span>
<span id="cb25-219"><a href="#cb25-219" aria-hidden="true" tabindex="-1"></a><span class="st">                </span></span>
<span id="cb25-220"><a href="#cb25-220" aria-hidden="true" tabindex="-1"></a><span class="st">                /* Listas */</span></span>
<span id="cb25-221"><a href="#cb25-221" aria-hidden="true" tabindex="-1"></a><span class="st">                ul, ol {</span></span>
<span id="cb25-222"><a href="#cb25-222" aria-hidden="true" tabindex="-1"></a><span class="st">                    margin: 1em 0 !important;</span></span>
<span id="cb25-223"><a href="#cb25-223" aria-hidden="true" tabindex="-1"></a><span class="st">                    padding-left: 1.5em !important;</span></span>
<span id="cb25-224"><a href="#cb25-224" aria-hidden="true" tabindex="-1"></a><span class="st">                }</span></span>
<span id="cb25-225"><a href="#cb25-225" aria-hidden="true" tabindex="-1"></a><span class="st">                </span></span>
<span id="cb25-226"><a href="#cb25-226" aria-hidden="true" tabindex="-1"></a><span class="st">                li {</span></span>
<span id="cb25-227"><a href="#cb25-227" aria-hidden="true" tabindex="-1"></a><span class="st">                    margin: 0.3em 0 !important;</span></span>
<span id="cb25-228"><a href="#cb25-228" aria-hidden="true" tabindex="-1"></a><span class="st">                }</span></span>
<span id="cb25-229"><a href="#cb25-229" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb25-230"><a href="#cb25-230" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb25-231"><a href="#cb25-231" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Estilos extras para emojis no modo tela tamb√©m */</span></span>
<span id="cb25-232"><a href="#cb25-232" aria-hidden="true" tabindex="-1"></a><span class="st">            body {</span></span>
<span id="cb25-233"><a href="#cb25-233" aria-hidden="true" tabindex="-1"></a><span class="st">                font-family: &quot;Arial&quot;, &quot;Segoe UI Emoji&quot;, &quot;Apple Color Emoji&quot;, &quot;Noto Color Emoji&quot;, sans-serif;</span></span>
<span id="cb25-234"><a href="#cb25-234" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb25-235"><a href="#cb25-235" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb25-236"><a href="#cb25-236" aria-hidden="true" tabindex="-1"></a><span class="st">            .emoji-section {</span></span>
<span id="cb25-237"><a href="#cb25-237" aria-hidden="true" tabindex="-1"></a><span class="st">                margin: 10px 0;</span></span>
<span id="cb25-238"><a href="#cb25-238" aria-hidden="true" tabindex="-1"></a><span class="st">                padding: 10px;</span></span>
<span id="cb25-239"><a href="#cb25-239" aria-hidden="true" tabindex="-1"></a><span class="st">                background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);</span></span>
<span id="cb25-240"><a href="#cb25-240" aria-hidden="true" tabindex="-1"></a><span class="st">                border-radius: 8px;</span></span>
<span id="cb25-241"><a href="#cb25-241" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb25-242"><a href="#cb25-242" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb25-243"><a href="#cb25-243" aria-hidden="true" tabindex="-1"></a><span class="st">            .emoji-grid {</span></span>
<span id="cb25-244"><a href="#cb25-244" aria-hidden="true" tabindex="-1"></a><span class="st">                display: grid;</span></span>
<span id="cb25-245"><a href="#cb25-245" aria-hidden="true" tabindex="-1"></a><span class="st">                grid-template-columns: repeat(auto-fill, minmax(40px, 1fr));</span></span>
<span id="cb25-246"><a href="#cb25-246" aria-hidden="true" tabindex="-1"></a><span class="st">                gap: 5px;</span></span>
<span id="cb25-247"><a href="#cb25-247" aria-hidden="true" tabindex="-1"></a><span class="st">                margin: 10px 0;</span></span>
<span id="cb25-248"><a href="#cb25-248" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb25-249"><a href="#cb25-249" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb25-250"><a href="#cb25-250" aria-hidden="true" tabindex="-1"></a><span class="st">            .emoji-item {</span></span>
<span id="cb25-251"><a href="#cb25-251" aria-hidden="true" tabindex="-1"></a><span class="st">                font-size: 20px;</span></span>
<span id="cb25-252"><a href="#cb25-252" aria-hidden="true" tabindex="-1"></a><span class="st">                text-align: center;</span></span>
<span id="cb25-253"><a href="#cb25-253" aria-hidden="true" tabindex="-1"></a><span class="st">                padding: 5px;</span></span>
<span id="cb25-254"><a href="#cb25-254" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb25-255"><a href="#cb25-255" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;/style&gt;</span></span>
<span id="cb25-256"><a href="#cb25-256" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb25-257"><a href="#cb25-257" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;!-- Script para garantir renderiza√ß√£o completa --&gt;</span></span>
<span id="cb25-258"><a href="#cb25-258" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;script&gt;</span></span>
<span id="cb25-259"><a href="#cb25-259" aria-hidden="true" tabindex="-1"></a><span class="st">        document.addEventListener(&#39;DOMContentLoaded&#39;, function() {</span></span>
<span id="cb25-260"><a href="#cb25-260" aria-hidden="true" tabindex="-1"></a><span class="st">            // For√ßar repaint para emojis</span></span>
<span id="cb25-261"><a href="#cb25-261" aria-hidden="true" tabindex="-1"></a><span class="st">            setTimeout(function() {</span></span>
<span id="cb25-262"><a href="#cb25-262" aria-hidden="true" tabindex="-1"></a><span class="st">                if (window.MathJax) {</span></span>
<span id="cb25-263"><a href="#cb25-263" aria-hidden="true" tabindex="-1"></a><span class="st">                    MathJax.startup.promise.then(function() {</span></span>
<span id="cb25-264"><a href="#cb25-264" aria-hidden="true" tabindex="-1"></a><span class="st">                        MathJax.typesetPromise();</span></span>
<span id="cb25-265"><a href="#cb25-265" aria-hidden="true" tabindex="-1"></a><span class="st">                    });</span></span>
<span id="cb25-266"><a href="#cb25-266" aria-hidden="true" tabindex="-1"></a><span class="st">                }</span></span>
<span id="cb25-267"><a href="#cb25-267" aria-hidden="true" tabindex="-1"></a><span class="st">                </span></span>
<span id="cb25-268"><a href="#cb25-268" aria-hidden="true" tabindex="-1"></a><span class="st">                // Trigger reflow para emojis</span></span>
<span id="cb25-269"><a href="#cb25-269" aria-hidden="true" tabindex="-1"></a><span class="st">                document.body.style.display = &#39;none&#39;;</span></span>
<span id="cb25-270"><a href="#cb25-270" aria-hidden="true" tabindex="-1"></a><span class="st">                document.body.offsetHeight; // trigger reflow</span></span>
<span id="cb25-271"><a href="#cb25-271" aria-hidden="true" tabindex="-1"></a><span class="st">                document.body.style.display = &#39;&#39;;</span></span>
<span id="cb25-272"><a href="#cb25-272" aria-hidden="true" tabindex="-1"></a><span class="st">            }, 100);</span></span>
<span id="cb25-273"><a href="#cb25-273" aria-hidden="true" tabindex="-1"></a><span class="st">        });</span></span>
<span id="cb25-274"><a href="#cb25-274" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;/script&gt;</span></span>
<span id="cb25-275"><a href="#cb25-275" aria-hidden="true" tabindex="-1"></a><span class="st">        &quot;&quot;&quot;</span></span>
<span id="cb25-276"><a href="#cb25-276" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-277"><a href="#cb25-277" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Inserir estilos no head</span></span>
<span id="cb25-278"><a href="#cb25-278" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">&#39;&lt;/head&gt;&#39;</span> <span class="kw">in</span> html_content:</span>
<span id="cb25-279"><a href="#cb25-279" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> html_content.replace(<span class="st">&#39;&lt;/head&gt;&#39;</span>, enhanced_styles <span class="op">+</span> <span class="st">&#39;&lt;/head&gt;&#39;</span>)</span>
<span id="cb25-280"><a href="#cb25-280" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="st">&#39;&lt;head&gt;&#39;</span> <span class="kw">in</span> html_content:</span>
<span id="cb25-281"><a href="#cb25-281" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> html_content.replace(<span class="st">&#39;&lt;head&gt;&#39;</span>, <span class="st">&#39;&lt;head&gt;&#39;</span> <span class="op">+</span> enhanced_styles)</span>
<span id="cb25-282"><a href="#cb25-282" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb25-283"><a href="#cb25-283" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">&#39;&lt;head&gt;&#39;</span> <span class="op">+</span> enhanced_styles <span class="op">+</span> <span class="st">&#39;&lt;/head&gt;&#39;</span> <span class="op">+</span> html_content</span>
<span id="cb25-284"><a href="#cb25-284" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-285"><a href="#cb25-285" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _replace_emoji_sections(<span class="va">self</span>, html_content):</span>
<span id="cb25-286"><a href="#cb25-286" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Melhora a apresenta√ß√£o das se√ß√µes de emojis&quot;&quot;&quot;</span></span>
<span id="cb25-287"><a href="#cb25-287" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Adicionar classes para melhor formata√ß√£o de emojis</span></span>
<span id="cb25-288"><a href="#cb25-288" aria-hidden="true" tabindex="-1"></a>        replacements <span class="op">=</span> [</span>
<span id="cb25-289"><a href="#cb25-289" aria-hidden="true" tabindex="-1"></a>            (<span class="st">&#39;&lt;h2 id=&quot;emo√ß√µes&quot;&gt;üòÄ Emo√ß√µes&lt;/h2&gt;&#39;</span>, </span>
<span id="cb25-290"><a href="#cb25-290" aria-hidden="true" tabindex="-1"></a>             <span class="st">&#39;&lt;div class=&quot;emoji-section&quot;&gt;&lt;h2 id=&quot;emo√ß√µes&quot;&gt;üòÄ Emo√ß√µes&lt;/h2&gt;&#39;</span>),</span>
<span id="cb25-291"><a href="#cb25-291" aria-hidden="true" tabindex="-1"></a>            (<span class="st">&#39;&lt;h2 id=&quot;pessoas-e-gestos&quot;&gt;üëã Pessoas e Gestos&lt;/h2&gt;&#39;</span>, </span>
<span id="cb25-292"><a href="#cb25-292" aria-hidden="true" tabindex="-1"></a>             <span class="st">&#39;&lt;div class=&quot;emoji-section&quot;&gt;&lt;h2 id=&quot;pessoas-e-gestos&quot;&gt;üëã Pessoas e Gestos&lt;/h2&gt;&#39;</span>),</span>
<span id="cb25-293"><a href="#cb25-293" aria-hidden="true" tabindex="-1"></a>            (<span class="st">&#39;&lt;h2 id=&quot;animais&quot;&gt;üê∂ Animais&lt;/h2&gt;&#39;</span>, </span>
<span id="cb25-294"><a href="#cb25-294" aria-hidden="true" tabindex="-1"></a>             <span class="st">&#39;&lt;div class=&quot;emoji-section&quot;&gt;&lt;h2 id=&quot;animais&quot;&gt;üê∂ Animais&lt;/h2&gt;&#39;</span>),</span>
<span id="cb25-295"><a href="#cb25-295" aria-hidden="true" tabindex="-1"></a>            (<span class="st">&#39;&lt;h2 id=&quot;comidas&quot;&gt;üçî Comidas&lt;/h2&gt;&#39;</span>, </span>
<span id="cb25-296"><a href="#cb25-296" aria-hidden="true" tabindex="-1"></a>             <span class="st">&#39;&lt;div class=&quot;emoji-section&quot;&gt;&lt;h2 id=&quot;comidas&quot;&gt;üçî Comidas&lt;/h2&gt;&#39;</span>),</span>
<span id="cb25-297"><a href="#cb25-297" aria-hidden="true" tabindex="-1"></a>            (<span class="st">&#39;&lt;h2 id=&quot;natureza-e-clima&quot;&gt;üåç Natureza e Clima&lt;/h2&gt;&#39;</span>, </span>
<span id="cb25-298"><a href="#cb25-298" aria-hidden="true" tabindex="-1"></a>             <span class="st">&#39;&lt;div class=&quot;emoji-section&quot;&gt;&lt;h2 id=&quot;natureza-e-clima&quot;&gt;üåç Natureza e Clima&lt;/h2&gt;&#39;</span>),</span>
<span id="cb25-299"><a href="#cb25-299" aria-hidden="true" tabindex="-1"></a>            (<span class="st">&#39;&lt;h2 id=&quot;transportes&quot;&gt;üöó Transportes&lt;/h2&gt;&#39;</span>, </span>
<span id="cb25-300"><a href="#cb25-300" aria-hidden="true" tabindex="-1"></a>             <span class="st">&#39;&lt;div class=&quot;emoji-section&quot;&gt;&lt;h2 id=&quot;transportes&quot;&gt;üöó Transportes&lt;/h2&gt;&#39;</span>),</span>
<span id="cb25-301"><a href="#cb25-301" aria-hidden="true" tabindex="-1"></a>            (<span class="st">&#39;&lt;h2 id=&quot;s√≠mbolos-e-diversos&quot;&gt;üéâ S√≠mbolos e Diversos&lt;/h2&gt;&#39;</span>, </span>
<span id="cb25-302"><a href="#cb25-302" aria-hidden="true" tabindex="-1"></a>             <span class="st">&#39;&lt;div class=&quot;emoji-section&quot;&gt;&lt;h2 id=&quot;s√≠mbolos-e-diversos&quot;&gt;üéâ S√≠mbolos e Diversos&lt;/h2&gt;&#39;</span>),</span>
<span id="cb25-303"><a href="#cb25-303" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb25-304"><a href="#cb25-304" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-305"><a href="#cb25-305" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> old, new <span class="kw">in</span> replacements:</span>
<span id="cb25-306"><a href="#cb25-306" aria-hidden="true" tabindex="-1"></a>            html_content <span class="op">=</span> html_content.replace(old, new)</span>
<span id="cb25-307"><a href="#cb25-307" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-308"><a href="#cb25-308" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Fechar as divs antes das pr√≥ximas se√ß√µes</span></span>
<span id="cb25-309"><a href="#cb25-309" aria-hidden="true" tabindex="-1"></a>        sections <span class="op">=</span> [<span class="st">&#39;&lt;h2 id=&quot;conclus√£o&quot;&gt;&#39;</span>, <span class="st">&#39;&lt;hr /&gt;&#39;</span>, <span class="st">&#39;&lt;h1 id=&quot;&#39;</span>, <span class="st">&#39;&lt;h2 id=&quot;texto-formatado&quot;&gt;&#39;</span>]</span>
<span id="cb25-310"><a href="#cb25-310" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> section <span class="kw">in</span> sections:</span>
<span id="cb25-311"><a href="#cb25-311" aria-hidden="true" tabindex="-1"></a>            html_content <span class="op">=</span> html_content.replace(section, <span class="st">&#39;&lt;/div&gt;&#39;</span> <span class="op">+</span> section)</span>
<span id="cb25-312"><a href="#cb25-312" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-313"><a href="#cb25-313" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> html_content</span>
<span id="cb25-314"><a href="#cb25-314" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-315"><a href="#cb25-315" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> convert_html_to_pdf(<span class="va">self</span>, input_html, output_pdf<span class="op">=</span><span class="va">None</span>, wait_time<span class="op">=</span><span class="dv">5</span>):</span>
<span id="cb25-316"><a href="#cb25-316" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;</span></span>
<span id="cb25-317"><a href="#cb25-317" aria-hidden="true" tabindex="-1"></a><span class="co">        Converte arquivo HTML para PDF com suporte melhorado a emojis</span></span>
<span id="cb25-318"><a href="#cb25-318" aria-hidden="true" tabindex="-1"></a><span class="co">        </span></span>
<span id="cb25-319"><a href="#cb25-319" aria-hidden="true" tabindex="-1"></a><span class="co">        Args:</span></span>
<span id="cb25-320"><a href="#cb25-320" aria-hidden="true" tabindex="-1"></a><span class="co">            input_html (str): Caminho para arquivo HTML de entrada</span></span>
<span id="cb25-321"><a href="#cb25-321" aria-hidden="true" tabindex="-1"></a><span class="co">            output_pdf (str): Caminho para arquivo PDF de sa√≠da (opcional)</span></span>
<span id="cb25-322"><a href="#cb25-322" aria-hidden="true" tabindex="-1"></a><span class="co">            wait_time (int): Tempo de espera para carregamento (segundos)</span></span>
<span id="cb25-323"><a href="#cb25-323" aria-hidden="true" tabindex="-1"></a><span class="co">        </span></span>
<span id="cb25-324"><a href="#cb25-324" aria-hidden="true" tabindex="-1"></a><span class="co">        Returns:</span></span>
<span id="cb25-325"><a href="#cb25-325" aria-hidden="true" tabindex="-1"></a><span class="co">            str: Caminho do arquivo PDF gerado</span></span>
<span id="cb25-326"><a href="#cb25-326" aria-hidden="true" tabindex="-1"></a><span class="co">        &quot;&quot;&quot;</span></span>
<span id="cb25-327"><a href="#cb25-327" aria-hidden="true" tabindex="-1"></a>        driver <span class="op">=</span> <span class="va">None</span></span>
<span id="cb25-328"><a href="#cb25-328" aria-hidden="true" tabindex="-1"></a>        temp_file <span class="op">=</span> <span class="va">None</span></span>
<span id="cb25-329"><a href="#cb25-329" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-330"><a href="#cb25-330" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb25-331"><a href="#cb25-331" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Verificar se arquivo de entrada existe</span></span>
<span id="cb25-332"><a href="#cb25-332" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> os.path.exists(input_html):</span>
<span id="cb25-333"><a href="#cb25-333" aria-hidden="true" tabindex="-1"></a>                <span class="cf">raise</span> <span class="pp">FileNotFoundError</span>(<span class="ss">f&quot;Arquivo de entrada n√£o encontrado: </span><span class="sc">{</span>input_html<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb25-334"><a href="#cb25-334" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-335"><a href="#cb25-335" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Gerar nome do arquivo de sa√≠da se n√£o fornecido</span></span>
<span id="cb25-336"><a href="#cb25-336" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> output_pdf <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb25-337"><a href="#cb25-337" aria-hidden="true" tabindex="-1"></a>                input_path <span class="op">=</span> Path(input_html)</span>
<span id="cb25-338"><a href="#cb25-338" aria-hidden="true" tabindex="-1"></a>                output_pdf <span class="op">=</span> Path(<span class="va">self</span>.output_dir) <span class="op">/</span> <span class="ss">f&quot;</span><span class="sc">{</span>input_path<span class="sc">.</span>stem<span class="sc">}</span><span class="ss">_com_emojis.pdf&quot;</span></span>
<span id="cb25-339"><a href="#cb25-339" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-340"><a href="#cb25-340" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Garantir que o diret√≥rio de sa√≠da existe</span></span>
<span id="cb25-341"><a href="#cb25-341" aria-hidden="true" tabindex="-1"></a>            Path(output_pdf).parent.mkdir(parents<span class="op">=</span><span class="va">True</span>, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb25-342"><a href="#cb25-342" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-343"><a href="#cb25-343" aria-hidden="true" tabindex="-1"></a>            logger.info(<span class="ss">f&quot;Convertendo </span><span class="sc">{</span>input_html<span class="sc">}</span><span class="ss"> para </span><span class="sc">{</span>output_pdf<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb25-344"><a href="#cb25-344" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-345"><a href="#cb25-345" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Ler e processar conte√∫do HTML</span></span>
<span id="cb25-346"><a href="#cb25-346" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(input_html, <span class="st">&#39;r&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb25-347"><a href="#cb25-347" aria-hidden="true" tabindex="-1"></a>                html_content <span class="op">=</span> f.read()</span>
<span id="cb25-348"><a href="#cb25-348" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-349"><a href="#cb25-349" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Adicionar estilos de impress√£o melhorados</span></span>
<span id="cb25-350"><a href="#cb25-350" aria-hidden="true" tabindex="-1"></a>            html_content <span class="op">=</span> <span class="va">self</span>._add_enhanced_styles(html_content)</span>
<span id="cb25-351"><a href="#cb25-351" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-352"><a href="#cb25-352" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Melhorar se√ß√µes de emojis</span></span>
<span id="cb25-353"><a href="#cb25-353" aria-hidden="true" tabindex="-1"></a>            html_content <span class="op">=</span> <span class="va">self</span>._replace_emoji_sections(html_content)</span>
<span id="cb25-354"><a href="#cb25-354" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-355"><a href="#cb25-355" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Criar arquivo tempor√°rio com conte√∫do processado</span></span>
<span id="cb25-356"><a href="#cb25-356" aria-hidden="true" tabindex="-1"></a>            temp_file <span class="op">=</span> tempfile.NamedTemporaryFile(mode<span class="op">=</span><span class="st">&#39;w&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>, </span>
<span id="cb25-357"><a href="#cb25-357" aria-hidden="true" tabindex="-1"></a>                                                   suffix<span class="op">=</span><span class="st">&#39;.html&#39;</span>, delete<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb25-358"><a href="#cb25-358" aria-hidden="true" tabindex="-1"></a>            temp_file.write(html_content)</span>
<span id="cb25-359"><a href="#cb25-359" aria-hidden="true" tabindex="-1"></a>            temp_file.close()</span>
<span id="cb25-360"><a href="#cb25-360" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-361"><a href="#cb25-361" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Configurar Chrome driver</span></span>
<span id="cb25-362"><a href="#cb25-362" aria-hidden="true" tabindex="-1"></a>            driver <span class="op">=</span> <span class="va">self</span>._setup_chrome_driver()</span>
<span id="cb25-363"><a href="#cb25-363" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-364"><a href="#cb25-364" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Carregar arquivo local</span></span>
<span id="cb25-365"><a href="#cb25-365" aria-hidden="true" tabindex="-1"></a>            file_url <span class="op">=</span> <span class="ss">f&quot;file:///</span><span class="sc">{</span>temp_file<span class="sc">.</span>name<span class="sc">.</span>replace(os.sep, <span class="st">&#39;/&#39;</span>)<span class="sc">}</span><span class="ss">&quot;</span></span>
<span id="cb25-366"><a href="#cb25-366" aria-hidden="true" tabindex="-1"></a>            logger.info(<span class="ss">f&quot;Carregando URL: </span><span class="sc">{</span>file_url<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb25-367"><a href="#cb25-367" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-368"><a href="#cb25-368" aria-hidden="true" tabindex="-1"></a>            driver.get(file_url)</span>
<span id="cb25-369"><a href="#cb25-369" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-370"><a href="#cb25-370" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Aguardar carregamento completo</span></span>
<span id="cb25-371"><a href="#cb25-371" aria-hidden="true" tabindex="-1"></a>            logger.info(<span class="ss">f&quot;Aguardando </span><span class="sc">{</span>wait_time<span class="sc">}</span><span class="ss"> segundos para carregamento completo...&quot;</span>)</span>
<span id="cb25-372"><a href="#cb25-372" aria-hidden="true" tabindex="-1"></a>            time.sleep(wait_time)</span>
<span id="cb25-373"><a href="#cb25-373" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-374"><a href="#cb25-374" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Executar scripts para garantir renderiza√ß√£o completa</span></span>
<span id="cb25-375"><a href="#cb25-375" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb25-376"><a href="#cb25-376" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Aguardar MathJax</span></span>
<span id="cb25-377"><a href="#cb25-377" aria-hidden="true" tabindex="-1"></a>                driver.execute_script(<span class="st">&quot;&quot;&quot;</span></span>
<span id="cb25-378"><a href="#cb25-378" aria-hidden="true" tabindex="-1"></a><span class="st">                    if (window.MathJax) {</span></span>
<span id="cb25-379"><a href="#cb25-379" aria-hidden="true" tabindex="-1"></a><span class="st">                        return MathJax.startup.promise.then(function() {</span></span>
<span id="cb25-380"><a href="#cb25-380" aria-hidden="true" tabindex="-1"></a><span class="st">                            return MathJax.typesetPromise();</span></span>
<span id="cb25-381"><a href="#cb25-381" aria-hidden="true" tabindex="-1"></a><span class="st">                        });</span></span>
<span id="cb25-382"><a href="#cb25-382" aria-hidden="true" tabindex="-1"></a><span class="st">                    }</span></span>
<span id="cb25-383"><a href="#cb25-383" aria-hidden="true" tabindex="-1"></a><span class="st">                    return Promise.resolve();</span></span>
<span id="cb25-384"><a href="#cb25-384" aria-hidden="true" tabindex="-1"></a><span class="st">                &quot;&quot;&quot;</span>)</span>
<span id="cb25-385"><a href="#cb25-385" aria-hidden="true" tabindex="-1"></a>                time.sleep(<span class="dv">2</span>)  <span class="co"># Espera adicional para MathJax</span></span>
<span id="cb25-386"><a href="#cb25-386" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb25-387"><a href="#cb25-387" aria-hidden="true" tabindex="-1"></a>                <span class="co"># For√ßar renderiza√ß√£o de emojis</span></span>
<span id="cb25-388"><a href="#cb25-388" aria-hidden="true" tabindex="-1"></a>                driver.execute_script(<span class="st">&quot;&quot;&quot;</span></span>
<span id="cb25-389"><a href="#cb25-389" aria-hidden="true" tabindex="-1"></a><span class="st">                    // Trigger reflow para garantir renderiza√ß√£o</span></span>
<span id="cb25-390"><a href="#cb25-390" aria-hidden="true" tabindex="-1"></a><span class="st">                    document.body.style.visibility = &#39;hidden&#39;;</span></span>
<span id="cb25-391"><a href="#cb25-391" aria-hidden="true" tabindex="-1"></a><span class="st">                    document.body.offsetHeight;</span></span>
<span id="cb25-392"><a href="#cb25-392" aria-hidden="true" tabindex="-1"></a><span class="st">                    document.body.style.visibility = &#39;visible&#39;;</span></span>
<span id="cb25-393"><a href="#cb25-393" aria-hidden="true" tabindex="-1"></a><span class="st">                &quot;&quot;&quot;</span>)</span>
<span id="cb25-394"><a href="#cb25-394" aria-hidden="true" tabindex="-1"></a>                time.sleep(<span class="dv">1</span>)</span>
<span id="cb25-395"><a href="#cb25-395" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb25-396"><a href="#cb25-396" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb25-397"><a href="#cb25-397" aria-hidden="true" tabindex="-1"></a>                logger.warning(<span class="ss">f&quot;Scripts de renderiza√ß√£o: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb25-398"><a href="#cb25-398" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-399"><a href="#cb25-399" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Configurar op√ß√µes de impress√£o para PDF</span></span>
<span id="cb25-400"><a href="#cb25-400" aria-hidden="true" tabindex="-1"></a>            print_options <span class="op">=</span> {</span>
<span id="cb25-401"><a href="#cb25-401" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;landscape&#39;</span>: <span class="va">False</span>,</span>
<span id="cb25-402"><a href="#cb25-402" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;displayHeaderFooter&#39;</span>: <span class="va">False</span>,</span>
<span id="cb25-403"><a href="#cb25-403" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;printBackground&#39;</span>: <span class="va">True</span>,</span>
<span id="cb25-404"><a href="#cb25-404" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;preferCSSPageSize&#39;</span>: <span class="va">True</span>,</span>
<span id="cb25-405"><a href="#cb25-405" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;paperWidth&#39;</span>: <span class="fl">8.27</span>,  <span class="co"># A4 width in inches</span></span>
<span id="cb25-406"><a href="#cb25-406" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;paperHeight&#39;</span>: <span class="fl">11.69</span>, <span class="co"># A4 height in inches</span></span>
<span id="cb25-407"><a href="#cb25-407" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;marginTop&#39;</span>: <span class="fl">0.4</span>,</span>
<span id="cb25-408"><a href="#cb25-408" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;marginBottom&#39;</span>: <span class="fl">0.4</span>,</span>
<span id="cb25-409"><a href="#cb25-409" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;marginLeft&#39;</span>: <span class="fl">0.4</span>,</span>
<span id="cb25-410"><a href="#cb25-410" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;marginRight&#39;</span>: <span class="fl">0.4</span>,</span>
<span id="cb25-411"><a href="#cb25-411" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb25-412"><a href="#cb25-412" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-413"><a href="#cb25-413" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Gerar PDF</span></span>
<span id="cb25-414"><a href="#cb25-414" aria-hidden="true" tabindex="-1"></a>            logger.info(<span class="st">&quot;Gerando PDF...&quot;</span>)</span>
<span id="cb25-415"><a href="#cb25-415" aria-hidden="true" tabindex="-1"></a>            pdf_data <span class="op">=</span> driver.execute_cdp_cmd(<span class="st">&#39;Page.printToPDF&#39;</span>, print_options)</span>
<span id="cb25-416"><a href="#cb25-416" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-417"><a href="#cb25-417" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Salvar PDF</span></span>
<span id="cb25-418"><a href="#cb25-418" aria-hidden="true" tabindex="-1"></a>            <span class="im">import</span> base64</span>
<span id="cb25-419"><a href="#cb25-419" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(output_pdf, <span class="st">&#39;wb&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb25-420"><a href="#cb25-420" aria-hidden="true" tabindex="-1"></a>                f.write(base64.b64decode(pdf_data[<span class="st">&#39;data&#39;</span>]))</span>
<span id="cb25-421"><a href="#cb25-421" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-422"><a href="#cb25-422" aria-hidden="true" tabindex="-1"></a>            logger.info(<span class="ss">f&quot;‚úÖ PDF gerado com sucesso: </span><span class="sc">{</span>output_pdf<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb25-423"><a href="#cb25-423" aria-hidden="true" tabindex="-1"></a>            logger.info(<span class="st">&quot;üìä Emojis coloridos e f√≥rmulas matem√°ticas preservados!&quot;</span>)</span>
<span id="cb25-424"><a href="#cb25-424" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="bu">str</span>(output_pdf)</span>
<span id="cb25-425"><a href="#cb25-425" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-426"><a href="#cb25-426" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb25-427"><a href="#cb25-427" aria-hidden="true" tabindex="-1"></a>            logger.error(<span class="ss">f&quot;‚ùå Erro na convers√£o: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb25-428"><a href="#cb25-428" aria-hidden="true" tabindex="-1"></a>            <span class="cf">raise</span></span>
<span id="cb25-429"><a href="#cb25-429" aria-hidden="true" tabindex="-1"></a>        <span class="cf">finally</span>:</span>
<span id="cb25-430"><a href="#cb25-430" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Fechar driver e limpar arquivo tempor√°rio</span></span>
<span id="cb25-431"><a href="#cb25-431" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> driver:</span>
<span id="cb25-432"><a href="#cb25-432" aria-hidden="true" tabindex="-1"></a>                driver.quit()</span>
<span id="cb25-433"><a href="#cb25-433" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> temp_file <span class="kw">and</span> os.path.exists(temp_file.name):</span>
<span id="cb25-434"><a href="#cb25-434" aria-hidden="true" tabindex="-1"></a>                <span class="cf">try</span>:</span>
<span id="cb25-435"><a href="#cb25-435" aria-hidden="true" tabindex="-1"></a>                    os.unlink(temp_file.name)</span>
<span id="cb25-436"><a href="#cb25-436" aria-hidden="true" tabindex="-1"></a>                <span class="cf">except</span>:</span>
<span id="cb25-437"><a href="#cb25-437" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">pass</span></span>
<span id="cb25-438"><a href="#cb25-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-439"><a href="#cb25-439" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> main():</span>
<span id="cb25-440"><a href="#cb25-440" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Fun√ß√£o principal para execu√ß√£o via linha de comando&quot;&quot;&quot;</span></span>
<span id="cb25-441"><a href="#cb25-441" aria-hidden="true" tabindex="-1"></a>    parser <span class="op">=</span> argparse.ArgumentParser(description<span class="op">=</span><span class="st">&#39;Conversor de HTML para PDF com emojis coloridos&#39;</span>)</span>
<span id="cb25-442"><a href="#cb25-442" aria-hidden="true" tabindex="-1"></a>    parser.add_argument(<span class="st">&#39;input&#39;</span>, <span class="bu">help</span><span class="op">=</span><span class="st">&#39;Arquivo HTML de entrada&#39;</span>)</span>
<span id="cb25-443"><a href="#cb25-443" aria-hidden="true" tabindex="-1"></a>    parser.add_argument(<span class="st">&#39;-o&#39;</span>, <span class="st">&#39;--output&#39;</span>, <span class="bu">help</span><span class="op">=</span><span class="st">&#39;Arquivo PDF de sa√≠da&#39;</span>)</span>
<span id="cb25-444"><a href="#cb25-444" aria-hidden="true" tabindex="-1"></a>    parser.add_argument(<span class="st">&#39;-w&#39;</span>, <span class="st">&#39;--wait-time&#39;</span>, <span class="bu">type</span><span class="op">=</span><span class="bu">int</span>, default<span class="op">=</span><span class="dv">5</span>,</span>
<span id="cb25-445"><a href="#cb25-445" aria-hidden="true" tabindex="-1"></a>                       <span class="bu">help</span><span class="op">=</span><span class="st">&#39;Tempo de espera para carregamento (segundos)&#39;</span>)</span>
<span id="cb25-446"><a href="#cb25-446" aria-hidden="true" tabindex="-1"></a>    parser.add_argument(<span class="st">&#39;--chrome-path&#39;</span>, <span class="bu">help</span><span class="op">=</span><span class="st">&#39;Caminho personalizado para Chrome&#39;</span>)</span>
<span id="cb25-447"><a href="#cb25-447" aria-hidden="true" tabindex="-1"></a>    parser.add_argument(<span class="st">&#39;-v&#39;</span>, <span class="st">&#39;--verbose&#39;</span>, action<span class="op">=</span><span class="st">&#39;store_true&#39;</span>, </span>
<span id="cb25-448"><a href="#cb25-448" aria-hidden="true" tabindex="-1"></a>                       <span class="bu">help</span><span class="op">=</span><span class="st">&#39;Modo verboso&#39;</span>)</span>
<span id="cb25-449"><a href="#cb25-449" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-450"><a href="#cb25-450" aria-hidden="true" tabindex="-1"></a>    args <span class="op">=</span> parser.parse_args()</span>
<span id="cb25-451"><a href="#cb25-451" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-452"><a href="#cb25-452" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> args.verbose:</span>
<span id="cb25-453"><a href="#cb25-453" aria-hidden="true" tabindex="-1"></a>        logging.getLogger().setLevel(logging.DEBUG)</span>
<span id="cb25-454"><a href="#cb25-454" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-455"><a href="#cb25-455" aria-hidden="true" tabindex="-1"></a>    converter <span class="op">=</span> HTMLToPDFConverterEnhanced(chrome_path<span class="op">=</span>args.chrome_path)</span>
<span id="cb25-456"><a href="#cb25-456" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-457"><a href="#cb25-457" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb25-458"><a href="#cb25-458" aria-hidden="true" tabindex="-1"></a>        converter.convert_html_to_pdf(</span>
<span id="cb25-459"><a href="#cb25-459" aria-hidden="true" tabindex="-1"></a>            input_html<span class="op">=</span>args.<span class="bu">input</span>,</span>
<span id="cb25-460"><a href="#cb25-460" aria-hidden="true" tabindex="-1"></a>            output_pdf<span class="op">=</span>args.output,</span>
<span id="cb25-461"><a href="#cb25-461" aria-hidden="true" tabindex="-1"></a>            wait_time<span class="op">=</span>args.wait_time</span>
<span id="cb25-462"><a href="#cb25-462" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb25-463"><a href="#cb25-463" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-464"><a href="#cb25-464" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb25-465"><a href="#cb25-465" aria-hidden="true" tabindex="-1"></a>        logger.error(<span class="ss">f&quot;Erro durante a convers√£o: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb25-466"><a href="#cb25-466" aria-hidden="true" tabindex="-1"></a>        sys.exit(<span class="dv">1</span>)</span>
<span id="cb25-467"><a href="#cb25-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-468"><a href="#cb25-468" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&quot;__main__&quot;</span>:</span>
<span id="cb25-469"><a href="#cb25-469" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Verificar depend√™ncias</span></span>
<span id="cb25-470"><a href="#cb25-470" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb25-471"><a href="#cb25-471" aria-hidden="true" tabindex="-1"></a>        <span class="im">import</span> selenium</span>
<span id="cb25-472"><a href="#cb25-472" aria-hidden="true" tabindex="-1"></a>        <span class="im">import</span> webdriver_manager</span>
<span id="cb25-473"><a href="#cb25-473" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">ImportError</span>:</span>
<span id="cb25-474"><a href="#cb25-474" aria-hidden="true" tabindex="-1"></a>        logger.error(<span class="st">&quot;Depend√™ncias n√£o instaladas. Execute:&quot;</span>)</span>
<span id="cb25-475"><a href="#cb25-475" aria-hidden="true" tabindex="-1"></a>        logger.error(<span class="st">&quot;pip install selenium webdriver-manager&quot;</span>)</span>
<span id="cb25-476"><a href="#cb25-476" aria-hidden="true" tabindex="-1"></a>        sys.exit(<span class="dv">1</span>)</span>
<span id="cb25-477"><a href="#cb25-477" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-478"><a href="#cb25-478" aria-hidden="true" tabindex="-1"></a>    main()</span></code></pre></div>
<h2 data-number="1.20" id="como-usar-a-vers√£o-melhorada"><span class="header-section-number">1.20</span> üéØ <strong>Como usar a vers√£o
melhorada:</strong></h2>
<div class="sourceCode" id="cb26"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Usar a vers√£o melhorada para emojis coloridos</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> html_to_pdf_selenium_enhanced.py exemplo_completo.html</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Com mais tempo de espera para melhor renderiza√ß√£o</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> html_to_pdf_selenium_enhanced.py exemplo_completo.html <span class="at">-w</span> 8</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Output personalizado</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> html_to_pdf_selenium_enhanced.py exemplo_completo.html <span class="at">-o</span> documento_com_emojis.pdf</span></code></pre></div>
<h2 data-number="1.21" id="se-ainda-houver-problemas-com-emojis-tente-isto"><span class="header-section-number">1.21</span> üîß <strong>Se ainda houver
problemas com emojis, tente isto:</strong></h2>
<h3 data-number="1.21.1" id="script-adicional-para-for√ßar-emojis-coloridos"><span class="header-section-number">1.21.1</span> <strong>Script adicional
para for√ßar emojis coloridos:</strong></h3>
<div class="sourceCode" id="cb27"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># force_color_emojis.py - Script adicional</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> force_color_emojis(html_content):</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Substitui emojis textuais por imagens coloridas&quot;&quot;&quot;</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    emoji_map <span class="op">=</span> {</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;üòÄ&quot;</span>: <span class="st">&quot;üòÄ&quot;</span>, <span class="st">&quot;‚≠ê&quot;</span>: <span class="st">&quot;‚≠ê&quot;</span>, <span class="st">&quot;üéâ&quot;</span>: <span class="st">&quot;üéâ&quot;</span>, <span class="st">&quot;üê∂&quot;</span>: <span class="st">&quot;üê∂&quot;</span>, <span class="st">&quot;üçî&quot;</span>: <span class="st">&quot;üçî&quot;</span>,</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;üåç&quot;</span>: <span class="st">&quot;üåç&quot;</span>, <span class="st">&quot;üöó&quot;</span>: <span class="st">&quot;üöó&quot;</span>, <span class="st">&quot;üëã&quot;</span>: <span class="st">&quot;üëã&quot;</span>, <span class="st">&quot;‚úÖ&quot;</span>: <span class="st">&quot;‚úÖ&quot;</span>, <span class="st">&quot;üåà&quot;</span>: <span class="st">&quot;üåà&quot;</span>,</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;üß≠&quot;</span>: <span class="st">&quot;üß≠&quot;</span>, <span class="st">&quot;üóíÔ∏è&quot;</span>: <span class="st">&quot;üóíÔ∏è&quot;</span>, <span class="st">&quot;üß©&quot;</span>: <span class="st">&quot;üß©&quot;</span>, <span class="st">&quot;üíª&quot;</span>: <span class="st">&quot;üíª&quot;</span>, <span class="st">&quot;üßÆ&quot;</span>: <span class="st">&quot;üßÆ&quot;</span>,</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;üìä&quot;</span>: <span class="st">&quot;üìä&quot;</span>, <span class="st">&quot;üñºÔ∏è&quot;</span>: <span class="st">&quot;üñºÔ∏è&quot;</span>, <span class="st">&quot;üîó&quot;</span>: <span class="st">&quot;üîó&quot;</span>, <span class="st">&quot;üß±&quot;</span>: <span class="st">&quot;üß±&quot;</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> emoji, replacement <span class="kw">in</span> emoji_map.items():</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>        html_content <span class="op">=</span> html_content.replace(</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>            emoji, </span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f&#39;&lt;span style=&quot;font-family: </span><span class="ch">\&#39;</span><span class="ss">Segoe UI Emoji</span><span class="ch">\&#39;</span><span class="ss">, </span><span class="ch">\&#39;</span><span class="ss">Apple Color Emoji</span><span class="ch">\&#39;</span><span class="ss">; font-size: 1.2em;&quot;&gt;</span><span class="sc">{</span>replacement<span class="sc">}</span><span class="ss">&lt;/span&gt;&#39;</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> html_content</span></code></pre></div>
<h2 data-number="1.22" id="resumo-das-melhorias"><span class="header-section-number">1.22</span> üìã <strong>Resumo das
melhorias:</strong></h2>
<ol type="1">
<li><strong>üé® Fontes de emoji espec√≠ficas</strong> - For√ßa o uso de
fonts coloridas</li>
<li><strong>üåà CSS melhorado</strong> - Estilos espec√≠ficos para
emojis</li>
<li><strong>‚è±Ô∏è Mais tempo de espera</strong> - Para renderiza√ß√£o
completa</li>
<li><strong>üîß Scripts JavaScript</strong> - Para for√ßar repaint dos
emojis</li>
<li><strong>üìä Se√ß√µes organizadas</strong> - Melhor apresenta√ß√£o dos
emojis</li>
</ol>
<p>Execute a vers√£o melhorada e os emojis devem aparecer coloridos no
PDF! üéâ</p>
<hr />
<h3 data-number="1.22.1" id="utilizador-2025-11-01-034646-deepseek-chat"><span class="header-section-number">1.22.1</span> üë§ Utilizador
<em>(2025-11-01 03:46:46)</em> <em>[deepseek-chat]</em></h3>
<p>com html_to_pdf_selenium_enhanced.py parece que est√° tudo bem</p>
<hr />
<h3 data-number="1.22.2" id="deepseek-2025-11-01-034646-deepseek-chat"><span class="header-section-number">1.22.2</span> ü§ñ DeepSeek <em>(2025-11-01
03:46:46)</em> <em>[deepseek-chat]</em></h3>
<p>Excelente! üéâ Que bom que funcionou perfeitamente com o
<code>html_to_pdf_selenium_enhanced.py</code>!</p>
<h2 data-number="1.23" id="resumo-da-solu√ß√£o-final"><span class="header-section-number">1.23</span> ‚úÖ <strong>Resumo da Solu√ß√£o
Final:</strong></h2>
<p>Agora voc√™ tem um <strong>conversor HTML para PDF robusto</strong>
que:</p>
<ul>
<li>‚úÖ <strong>Convers√£o 100% funcional</strong> no Windows</li>
<li>‚úÖ <strong>F√≥rmulas matem√°ticas perfeitas</strong>
(MathJax/LaTeX)</li>
<li>‚úÖ <strong>Emojis coloridos</strong> renderizados corretamente<br />
</li>
<li>‚úÖ <strong>C√≥digo com syntax highlighting</strong> preservado</li>
<li>‚úÖ <strong>Layout fiel</strong> ao documento original</li>
<li>‚úÖ <strong>F√°cil de usar</strong> e replicar para outros
documentos</li>
</ul>
<h2 data-number="1.24" id="para-usar-com-outros-documentos-html"><span class="header-section-number">1.24</span> üöÄ <strong>Para usar com
outros documentos HTML:</strong></h2>
<div class="sourceCode" id="cb28"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Converter qualquer arquivo HTML</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> html_to_pdf_selenium_enhanced.py outro_documento.html</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Com mais tempo para documentos complexos</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> html_to_pdf_selenium_enhanced.py documento_complexo.html <span class="at">-w</span> 10</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Output personalizado</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> html_to_pdf_selenium_enhanced.py meu_doc.html <span class="at">-o</span> relatorio_final.pdf</span></code></pre></div>
<h2 data-number="1.25" id="estrutura-dos-arquivos-gerados"><span class="header-section-number">1.25</span> üìÅ <strong>Estrutura dos
arquivos gerados:</strong></h2>
<pre><code>output_pdfs/
‚îú‚îÄ‚îÄ exemplo_completo_com_emojis.pdf  ‚Üê Seu PDF perfeito!
‚îú‚îÄ‚îÄ outro_documento.pdf
‚îî‚îÄ‚îÄ relatorio_final.pdf</code></pre>
<h2 data-number="1.26" id="dica-para-uso-futuro"><span class="header-section-number">1.26</span> üí° <strong>Dica para uso
futuro:</strong></h2>
<p>Guarde o script <code>html_to_pdf_selenium_enhanced.py</code> como
sua <strong>ferramenta padr√£o</strong> para convers√£o HTML‚ÜíPDF,
especialmente para documentos t√©cnicos com f√≥rmulas matem√°ticas.</p>
<p><strong>Problema resolvido!</strong> üéØ Agora voc√™ pode converter
qualquer HTML complexo para PDF de forma confi√°vel.</p>
<hr />
<p><em>Conversa exportada do DeepSeek</em> <em>Processado em: 23/11/2025
14:36</em></p>

        <script id="fixed-toc-script">
        document.addEventListener('DOMContentLoaded', function() {
            const toc = document.getElementById('TOC');
            if (toc) {
                const tocTitle = toc.querySelector('h2');
                if (tocTitle) {
                    const toggleBtn = document.createElement('button');
                    toggleBtn.innerHTML = '‚ò∞';
                    toggleBtn.className = 'toc-toggle-btn';
                    toggleBtn.title = 'Minimizar/Expandir TOC';
                    let isMinimized = false;
                    toggleBtn.addEventListener('click', function(e) {
                        e.stopPropagation();
                        isMinimized = !isMinimized;
                        if (isMinimized) {
                            toc.classList.add('toc-minimized');
                        } else {
                            toc.classList.remove('toc-minimized');
                        }
                    });
                    tocTitle.appendChild(toggleBtn);
                }
            }
            
            // SCROLLSPY
            const sections = document.querySelectorAll('h1, h2, h3, h4, h5');
            const tocLinks = document.querySelectorAll('#TOC a');
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const id = entry.target.getAttribute('id');
                        tocLinks.forEach(link => {
                            link.classList.remove('active');
                            if (link.getAttribute('href') === '#' + id) {
                                link.classList.add('active');
                            }
                        });
                    }
                });
            }, { 
                rootMargin: '-20% 0px -60% 0px', 
                threshold: 0 
            });
            
            sections.forEach(section => {
                if (section.id) observer.observe(section);
            });
            
            // Scroll suave
            tocLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const targetId = link.getAttribute('href').substring(1);
                    const targetElement = document.getElementById(targetId);
                    if (targetElement) {
                        const offsetTop = targetElement.offsetTop - 80;
                        window.scrollTo({ top: offsetTop, behavior: 'smooth' });
                    }
                });
            });
            
            // BOT√ÉO VOLTAR AO TOPO
            const backToTopBtn = document.createElement('button');
            backToTopBtn.className = 'back-to-top-content';
            backToTopBtn.innerHTML = '‚Üë';
            backToTopBtn.title = 'Voltar ao Topo';
            document.body.appendChild(backToTopBtn);
            
            window.addEventListener('scroll', () => {
                if (window.pageYOffset > 300) {
                    backToTopBtn.classList.add('show');
                } else {
                    backToTopBtn.classList.remove('show');
                }
            });
            
            backToTopBtn.addEventListener('click', () => {
                window.scrollTo({ top: 0, behavior: 'smooth' });
            });
        });
        </script>
        
</body>
</html>
