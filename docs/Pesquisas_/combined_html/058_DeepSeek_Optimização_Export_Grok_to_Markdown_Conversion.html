<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang xml:lang>
<head>

        <style id="fixed-toc-styles">
        /* === ESTILOS PRINCIPAIS - TOC FIXO √Ä DIREITA === */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
            scroll-behavior: smooth;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            position: relative;
        }
        /* === TOC FIXO √Ä DIREITA - POSI√á√ÉO CORRIGIDA === */
        #TOC {
            position: fixed !important;
            top: 50% !important;
            right: 20px !important;
            transform: translateY(-50%) !important;
            width: 320px !important;
            max-height: 80vh !important;
            overflow-y: auto !important;
            z-index: 1000 !important;
            background: rgba(255, 255, 255, 0.98) !important;
            padding: 20px !important;
            border-radius: 12px !important;
            box-shadow: 0 8px 32px rgba(0,0,0,0.15) !important;
            border: 1px solid #e0e0e0 !important;
            backdrop-filter: blur(10px) !important;
            transition: all 0.3s ease-in-out !important;
        }
        #TOC.toc-minimized {
            transform: translateY(-50%) translateX(calc(320px - 50px)) !important;
            opacity: 0.3;
            width: 50px !important;
            overflow: hidden;
        }
        #TOC.toc-minimized > *:not(.toc-toggle-btn) {
            display: none !important;
        }
        #TOC h2 {
            margin-top: 0;
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
            font-size: 1.2em;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .toc-toggle-btn {
            background: none;
            border: none;
            font-size: 1.2em;
            cursor: pointer;
            padding: 5px;
            border-radius: 4px;
            transition: background-color 0.2s;
        }
        .toc-toggle-btn:hover {
            background-color: rgba(0,0,0,0.1);
        }
        #TOC ul {
            list-style-type: none;
            padding-left: 15px;
            margin: 10px 0;
        }
        #TOC ul ul {
            padding-left: 20px;
        }
        #TOC li {
            margin: 8px 0;
            line-height: 1.4;
        }
        #TOC a {
            text-decoration: none;
            color: #495057;
            font-weight: 500;
            transition: all 0.2s ease;
            display: block;
            padding: 6px 10px;
            border-radius: 6px;
            border-left: 3px solid transparent;
        }
        #TOC a:hover {
            color: #007bff;
            background-color: rgba(0, 123, 255, 0.1);
            border-left-color: #007bff;
        }
        #TOC a.active {
            background-color: #007bff !important;
            color: white !important;
            font-weight: bold;
            border-left-color: #0056b3;
        }
        /* Conte√∫do principal com margem para o TOC */
        .main-content {
            margin-right: calc(320px + 40px) !important;
        }
        /* Barra de scroll personalizada APENAS para TOC */
        #TOC::-webkit-scrollbar {
            width: 8px;
        }
        #TOC::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }
        #TOC::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 4px;
        }
        #TOC::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }
        /* === BOT√ÉO VOLTAR AO TOPO (HTMLs individuais) === */
        .back-to-top-content {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            font-size: 18px;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 999;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .back-to-top-content.show {
            opacity: 1;
            transform: translateY(0);
        }
        .back-to-top-content:hover {
            background: #0056b3;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0,0,0,0.2);
        }
        /* === RESPONSIVIDADE === */
        @media (max-width: 1400px) {
            .container {
                max-width: 95%;
                padding: 30px;
            }
            #TOC {
                width: 280px !important;
            }
            .main-content {
                margin-right: 320px !important;
            }
        }
        @media (max-width: 1200px) {
            #TOC {
                width: 260px !important;
                right: 15px !important;
            }
            .main-content {
                margin-right: 300px !important;
            }
        }
        @media (max-width: 992px) {
            #TOC {
                position: relative !important;
                width: 100% !important;
                right: 0 !important;
                top: 0 !important;
                transform: none !important;
                margin: 20px 0;
                max-height: 300px !important;
            }
            .main-content {
                margin-right: 0 !important;
            }
            .back-to-top-content {
                right: 20px;
                bottom: 20px;
            }
        }
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            .container {
                padding: 20px;
                max-width: 100%;
            }
            #TOC {
                max-height: 250px !important;
                padding: 15px !important;
            }
        }
        </style>
        
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>058_DeepSeek_Optimiza√ß√£o_Export_Grok_to_Markdown_Conversion</title>
  <style>

html {
color: #1a1a1a;
background-color: #fdfdfd;
}
body {
margin: 0 auto;
max-width: 36em;
padding-left: 50px;
padding-right: 50px;
padding-top: 50px;
padding-bottom: 50px;
hyphens: auto;
overflow-wrap: break-word;
text-rendering: optimizeLegibility;
font-kerning: normal;
}
@media (max-width: 600px) {
body {
font-size: 0.9em;
padding: 12px;
}
h1 {
font-size: 1.8em;
}
}
@media print {
html {
background-color: white;
}
body {
background-color: transparent;
color: black;
font-size: 12pt;
}
p, h2, h3 {
orphans: 3;
widows: 3;
}
h2, h3, h4 {
page-break-after: avoid;
}
}
p {
margin: 1em 0;
}
a {
color: #1a1a1a;
}
a:visited {
color: #1a1a1a;
}
img {
max-width: 100%;
}
svg {
height: auto;
max-width: 100%;
}
h1, h2, h3, h4, h5, h6 {
margin-top: 1.4em;
}
h5, h6 {
font-size: 1em;
font-style: italic;
}
h6 {
font-weight: normal;
}
ol, ul {
padding-left: 1.7em;
margin-top: 1em;
}
li > ol, li > ul {
margin-top: 0;
}
blockquote {
margin: 1em 0 1em 1.7em;
padding-left: 1em;
border-left: 2px solid #e6e6e6;
color: #606060;
}
code {
font-family: Menlo, Monaco, Consolas, 'Lucida Console', monospace;
font-size: 85%;
margin: 0;
hyphens: manual;
}
pre {
margin: 1em 0;
overflow: auto;
}
pre code {
padding: 0;
overflow: visible;
overflow-wrap: normal;
}
.sourceCode {
background-color: transparent;
overflow: visible;
}
hr {
border: none;
border-top: 1px solid #1a1a1a;
height: 1px;
margin: 1em 0;
}
table {
margin: 1em 0;
border-collapse: collapse;
width: 100%;
overflow-x: auto;
display: block;
font-variant-numeric: lining-nums tabular-nums;
}
table caption {
margin-bottom: 0.75em;
}
tbody {
margin-top: 0.5em;
border-top: 1px solid #1a1a1a;
border-bottom: 1px solid #1a1a1a;
}
th {
border-top: 1px solid #1a1a1a;
padding: 0.25em 0.5em 0.25em 0.5em;
}
td {
padding: 0.125em 0.5em 0.25em 0.5em;
}
header {
margin-bottom: 4em;
text-align: center;
}
#TOC li {
list-style: none;
}
#TOC ul {
padding-left: 1.3em;
}
#TOC > ul {
padding-left: 0;
}
#TOC a:not(:hover) {
text-decoration: none;
}
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}

ul.task-list[class]{list-style: none;}
ul.task-list li input[type="checkbox"] {
font-size: inherit;
width: 0.8em;
margin: 0 0.8em 0.2em -1.6em;
vertical-align: middle;
}

html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
</head>
<body>
<nav id="TOC" role="doc-toc">
<ul>
<li><a href="#optimiza√ß√£o-export-grok-to-markdown-conversion-script" id="toc-optimiza√ß√£o-export-grok-to-markdown-conversion-script"><span class="toc-section-number">1</span> Optimiza√ß√£o Export Grok to Markdown
Conversion Script</a>
<ul>
<li><a href="#informa√ß√µes" id="toc-informa√ß√µes"><span class="toc-section-number">1.1</span> üìä Informa√ß√µes</a></li>
<li><a href="#conversa" id="toc-conversa"><span class="toc-section-number">1.2</span> üí¨ Conversa</a></li>
</ul></li>
<li><a href="#depois-converta-os-markdown-para-pdf" id="toc-depois-converta-os-markdown-para-pdf"><span class="toc-section-number">2</span> 2. Depois converta os Markdown para
PDF</a>
<ul>
<li><a href="#script-principal-otimizado-processor" id="toc-script-principal-otimizado-processor"><span class="toc-section-number">2.1</span> 1. Script Principal Otimizado
(Processor)</a></li>
<li><a href="#script-de-convers√£o-pdf-otimizado" id="toc-script-de-convers√£o-pdf-otimizado"><span class="toc-section-number">2.2</span> 2. Script de Convers√£o PDF
Otimizado</a></li>
<li><a href="#script-de-gerenciamento-principal" id="toc-script-de-gerenciamento-principal"><span class="toc-section-number">2.3</span> 3. Script de Gerenciamento
Principal</a></li>
<li><a href="#fluxo-otimizado-de-uso" id="toc-fluxo-otimizado-de-uso"><span class="toc-section-number">2.4</span> Fluxo Otimizado de Uso:</a></li>
<li><a href="#principais-melhorias" id="toc-principais-melhorias"><span class="toc-section-number">2.5</span> Principais Melhorias:</a></li>
<li><a href="#script-de-gerenciamento-atualizado" id="toc-script-de-gerenciamento-atualizado"><span class="toc-section-number">2.6</span> Script de Gerenciamento
Atualizado:</a></li>
<li><a href="#principais-otimiza√ß√µes-implementadas" id="toc-principais-otimiza√ß√µes-implementadas"><span class="toc-section-number">2.7</span> Principais Otimiza√ß√µes
Implementadas:</a></li>
<li><a href="#uso" id="toc-uso"><span class="toc-section-number">2.8</span> Uso:</a></li>
<li><a href="#principais-melhorias-implementadas" id="toc-principais-melhorias-implementadas"><span class="toc-section-number">2.9</span> Principais Melhorias
Implementadas:</a></li>
<li><a href="#principais-corre√ß√µes-implementadas" id="toc-principais-corre√ß√µes-implementadas"><span class="toc-section-number">2.10</span> Principais Corre√ß√µes
Implementadas:</a></li>
</ul></li>
</ul>
</nav>
<h1 data-number="1" id="optimiza√ß√£o-export-grok-to-markdown-conversion-script"><span class="header-section-number">1</span> Optimiza√ß√£o Export Grok to
Markdown Conversion Script</h1>
<h2 data-number="1.1" id="informa√ß√µes"><span class="header-section-number">1.1</span> üìä Informa√ß√µes</h2>
<ul>
<li><strong>N√∫mero:</strong> #58</li>
<li><strong>Origem:</strong> DeepSeek</li>
<li><strong>Categoria:</strong> Programa√ß√£o</li>
<li><strong>ID:</strong> a0bc469a-8b61-41a1-81c4-46a47628e946</li>
<li><strong>Criada em:</strong> 2025-11-02 00:43:33</li>
<li><strong>Atualizada em:</strong> 2025-11-02 04:25:34</li>
<li><strong>Total de mensagens:</strong> 10</li>
<li><strong>Resumo:</strong> Optimiza√ß√£o Export Grok to Markdown
Conversion Script Optimiza√ß√£o de Export Grok actual: # 1. Prim‚Ä¶</li>
</ul>
<hr />
<h2 data-number="1.2" id="conversa"><span class="header-section-number">1.2</span> üí¨ Conversa</h2>
<h3 data-number="1.2.1" id="utilizador-2025-11-02-004335-deepseek-chat"><span class="header-section-number">1.2.1</span> üë§ Utilizador <em>(2025-11-02
00:43:35)</em> <em>[deepseek-chat]</em></h3>
<p>Optimiza√ß√£o Export Grok to Markdown Conversion Script Optimiza√ß√£o de
Export Grok actual: # 1. Primeiro gere o dashboard com os arquivos
Markdown python grok_complete_dashboard.py</p>
<h1 data-number="2" id="depois-converta-os-markdown-para-pdf"><span class="header-section-number">2</span> 2. Depois converta os Markdown
para PDF</h1>
<p>python grok_markdown_to_pdf.py</p>
<ol type="1">
<li>Exporta√ß√£o do Grok ‚Ä¢ ‚úÖ conversas convertidas para Markdown ‚Ä¢ ‚úÖ
Metadados preservados (datas, t√≠tulos, resumos) ‚Ä¢ ‚úÖ Estrutura
organizada por n√∫meros e t√≠tulos</li>
<li>√çndice Pesquis√°vel ‚Ä¢ ‚úÖ Interface web moderna e responsiva, com
onversas ordenadas por data (mais recente primeiro) ‚Ä¢ ‚úÖ Busca em tempo
real por qualquer termo ‚Ä¢ ‚úÖ Filtros por categoria ‚Ä¢ ‚úÖ Acesso r√°pido a
MD e PDF ‚Ä¢ ‚úÖ Design profissional com gradientes</li>
<li>Exporta√ß√£o para PDF ‚Ä¢ ‚úÖ Convers√£o autom√°tica com Pandoc para html e
depois convers√£o para pdf pelo metodo do script deepseek_pdf_direct2.py.
Assim pretende-se optimiza√ß√£o dos sistema com um script para processar o
sistema e outro para a convers√£o md para html e de seguida para pdf</li>
</ol>
<p>Pretende-se optimiza√ß√£o dos sistema com um script para processar o
sistema e outro para a convers√£o md para html e de seguida para pdf</p>
<p>Fluxo Otimizado: grok.zip ‚Üí Processor ‚Üí Markdown + √çndice HTML ‚Üí PDF
Converter ‚Üí PDFs Pretende-se: 6. Pandoc com MathJax: Agora usa
‚Äìstandalone ‚Äìmathjax para suporte a f√≥rmulas matem√°ticas 7. Progresso
Detalhado: Feedback visual melhorado</p>
<hr />
<h3 data-number="2.0.1" id="deepseek-2025-11-02-004335-deepseek-chat"><span class="header-section-number">2.0.1</span> ü§ñ DeepSeek <em>(2025-11-02
00:43:35)</em> <em>[deepseek-chat]</em></h3>
<p>Vou otimizar o sistema dividindo o processo em dois scripts
especializados e implementando melhorias significativas. Aqui est√° a
solu√ß√£o:</p>
<h2 data-number="2.1" id="script-principal-otimizado-processor"><span class="header-section-number">2.1</span> 1. Script Principal Otimizado
(Processor)</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># grok_processor.py</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> zipfile</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> Counter</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> webbrowser</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> shutil</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> GrokProcessor:</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.conversations <span class="op">=</span> []</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.all_messages <span class="op">=</span> []</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> load_grok_data(<span class="va">self</span>):</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Carrega e processa os dados do arquivo zip de forma otimizada&quot;&quot;&quot;</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>        zip_files <span class="op">=</span> [<span class="st">&quot;grok.zip&quot;</span>, <span class="st">&quot;gork.zip&quot;</span>]</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>        zip_path <span class="op">=</span> <span class="bu">next</span>((f <span class="cf">for</span> f <span class="kw">in</span> zip_files <span class="cf">if</span> os.path.exists(f)), <span class="va">None</span>)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> zip_path <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;‚ùå Nenhum arquivo zip encontrado!&quot;</span>)</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;üìÇ Carregando dados do </span><span class="sc">{</span>zip_path<span class="sc">}</span><span class="ss">...&quot;</span>)</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> zipfile.ZipFile(zip_path, <span class="st">&#39;r&#39;</span>) <span class="im">as</span> zip_ref:</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>                json_files <span class="op">=</span> [f <span class="cf">for</span> f <span class="kw">in</span> zip_ref.namelist() <span class="cf">if</span> f.endswith(<span class="st">&#39;.json&#39;</span>)]</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;üîç Processando </span><span class="sc">{</span><span class="bu">len</span>(json_files)<span class="sc">}</span><span class="ss"> arquivos JSON...&quot;</span>)</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>                all_data <span class="op">=</span> []</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> file_name <span class="kw">in</span> json_files:</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">try</span>:</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">with</span> zip_ref.<span class="bu">open</span>(file_name) <span class="im">as</span> f:</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>                            content <span class="op">=</span> f.read().decode(<span class="st">&#39;utf-8&#39;</span>)</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>                            data <span class="op">=</span> json.loads(content)</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>                            all_data.append({</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&#39;file_name&#39;</span>: file_name,</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&#39;data&#39;</span>: data,</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&#39;size&#39;</span>: <span class="bu">len</span>(content)</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>                            })</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>                        <span class="bu">print</span>(<span class="ss">f&quot;‚ö†Ô∏è  </span><span class="sc">{</span>file_name<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ Dados brutos carregados: </span><span class="sc">{</span><span class="bu">len</span>(all_data)<span class="sc">}</span><span class="ss"> arquivos&quot;</span>)</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> all_data</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚ùå Erro ao processar </span><span class="sc">{</span>zip_path<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> extract_conversations(<span class="va">self</span>, all_data):</span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Extrai conversas dos dados brutos de forma otimizada&quot;&quot;&quot;</span></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;üìä Extraindo conversas...&quot;</span>)</span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> item <span class="kw">in</span> all_data:</span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>            data <span class="op">=</span> item[<span class="st">&#39;data&#39;</span>]</span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>            file_name <span class="op">=</span> item[<span class="st">&#39;file_name&#39;</span>]</span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="st">&#39;prod-grok-backend.json&#39;</span> <span class="kw">in</span> file_name <span class="kw">and</span> <span class="bu">isinstance</span>(data, <span class="bu">dict</span>):</span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="st">&#39;conversations&#39;</span> <span class="kw">in</span> data <span class="kw">and</span> <span class="bu">isinstance</span>(data[<span class="st">&#39;conversations&#39;</span>], <span class="bu">list</span>):</span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ </span><span class="sc">{</span>file_name<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span><span class="bu">len</span>(data[<span class="st">&#39;conversations&#39;</span>])<span class="sc">}</span><span class="ss"> conversas encontradas&quot;</span>)</span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.conversations.extend(data[<span class="st">&#39;conversations&#39;</span>])</span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;üéØ Total de conversas extra√≠das: </span><span class="sc">{</span><span class="bu">len</span>(<span class="va">self</span>.conversations)<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.conversations</span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> extract_messages(<span class="va">self</span>, conv):</span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Extrai mensagens de uma conversa de forma otimizada&quot;&quot;&quot;</span></span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a>        messages <span class="op">=</span> []</span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">isinstance</span>(conv, <span class="bu">dict</span>) <span class="kw">and</span> <span class="st">&#39;responses&#39;</span> <span class="kw">in</span> conv <span class="kw">and</span> <span class="bu">isinstance</span>(conv[<span class="st">&#39;responses&#39;</span>], <span class="bu">list</span>):</span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> response <span class="kw">in</span> conv[<span class="st">&#39;responses&#39;</span>]:</span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="bu">isinstance</span>(response, <span class="bu">dict</span>) <span class="kw">and</span> <span class="st">&#39;response&#39;</span> <span class="kw">in</span> response:</span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a>                    response_data <span class="op">=</span> response[<span class="st">&#39;response&#39;</span>]</span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="bu">isinstance</span>(response_data, <span class="bu">dict</span>):</span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a>                        message_content <span class="op">=</span> response_data.get(<span class="st">&#39;message&#39;</span>, <span class="st">&#39;&#39;</span>)</span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a>                        sender <span class="op">=</span> response_data.get(<span class="st">&#39;sender&#39;</span>, <span class="st">&#39;&#39;</span>)</span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">if</span> message_content <span class="kw">and</span> sender:</span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a>                            messages.append({</span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&#39;content&#39;</span>: message_content,</span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&#39;sender&#39;</span>: sender,</span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&#39;response_id&#39;</span>: response_data.get(<span class="st">&#39;_id&#39;</span>, <span class="st">&#39;&#39;</span>),</span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&#39;model&#39;</span>: response_data.get(<span class="st">&#39;model&#39;</span>, <span class="st">&#39;&#39;</span>),</span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&#39;create_time&#39;</span>: response_data.get(<span class="st">&#39;create_time&#39;</span>, {})</span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a>                            })</span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> messages</span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> analyze_conversations(<span class="va">self</span>):</span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Analisa as conversas com m√©tricas otimizadas&quot;&quot;&quot;</span></span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;üìä Analisando conversas...&quot;</span>)</span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.conversations:</span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;‚ùå Nenhuma conversa para analisar!&quot;</span>)</span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> pd.DataFrame(), []</span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true" tabindex="-1"></a>        analysis_data <span class="op">=</span> []</span>
<span id="cb1-105"><a href="#cb1-105" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-106"><a href="#cb1-106" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, conv <span class="kw">in</span> <span class="bu">enumerate</span>(<span class="va">self</span>.conversations):</span>
<span id="cb1-107"><a href="#cb1-107" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(conv, <span class="bu">dict</span>):</span>
<span id="cb1-108"><a href="#cb1-108" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span></span>
<span id="cb1-109"><a href="#cb1-109" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb1-110"><a href="#cb1-110" aria-hidden="true" tabindex="-1"></a>            conversation_data <span class="op">=</span> conv.get(<span class="st">&#39;conversation&#39;</span>, {})</span>
<span id="cb1-111"><a href="#cb1-111" aria-hidden="true" tabindex="-1"></a>            conv_id <span class="op">=</span> conversation_data.get(<span class="st">&#39;id&#39;</span>, <span class="ss">f&#39;conv_</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb1-112"><a href="#cb1-112" aria-hidden="true" tabindex="-1"></a>            title <span class="op">=</span> conversation_data.get(<span class="st">&#39;title&#39;</span>, <span class="ss">f&#39;Conversa </span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb1-113"><a href="#cb1-113" aria-hidden="true" tabindex="-1"></a>            created_at <span class="op">=</span> conversation_data.get(<span class="st">&#39;create_time&#39;</span>, <span class="st">&#39;&#39;</span>)</span>
<span id="cb1-114"><a href="#cb1-114" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb1-115"><a href="#cb1-115" aria-hidden="true" tabindex="-1"></a>            messages <span class="op">=</span> <span class="va">self</span>.extract_messages(conv)</span>
<span id="cb1-116"><a href="#cb1-116" aria-hidden="true" tabindex="-1"></a>            num_messages <span class="op">=</span> <span class="bu">len</span>(messages)</span>
<span id="cb1-117"><a href="#cb1-117" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb1-118"><a href="#cb1-118" aria-hidden="true" tabindex="-1"></a>            <span class="co"># M√©tricas otimizadas</span></span>
<span id="cb1-119"><a href="#cb1-119" aria-hidden="true" tabindex="-1"></a>            total_words <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb1-120"><a href="#cb1-120" aria-hidden="true" tabindex="-1"></a>            user_words <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb1-121"><a href="#cb1-121" aria-hidden="true" tabindex="-1"></a>            assistant_words <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb1-122"><a href="#cb1-122" aria-hidden="true" tabindex="-1"></a>            user_messages <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb1-123"><a href="#cb1-123" aria-hidden="true" tabindex="-1"></a>            assistant_messages <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb1-124"><a href="#cb1-124" aria-hidden="true" tabindex="-1"></a>            total_chars <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb1-125"><a href="#cb1-125" aria-hidden="true" tabindex="-1"></a>            preview_content <span class="op">=</span> <span class="st">&quot;&quot;</span></span>
<span id="cb1-126"><a href="#cb1-126" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb1-127"><a href="#cb1-127" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> j, msg <span class="kw">in</span> <span class="bu">enumerate</span>(messages):</span>
<span id="cb1-128"><a href="#cb1-128" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="bu">isinstance</span>(msg, <span class="bu">dict</span>):</span>
<span id="cb1-129"><a href="#cb1-129" aria-hidden="true" tabindex="-1"></a>                    content <span class="op">=</span> msg.get(<span class="st">&#39;content&#39;</span>, <span class="st">&#39;&#39;</span>)</span>
<span id="cb1-130"><a href="#cb1-130" aria-hidden="true" tabindex="-1"></a>                    sender <span class="op">=</span> msg.get(<span class="st">&#39;sender&#39;</span>, <span class="st">&#39;&#39;</span>)</span>
<span id="cb1-131"><a href="#cb1-131" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb1-132"><a href="#cb1-132" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> content <span class="kw">and</span> <span class="bu">len</span>(content.strip()) <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb1-133"><a href="#cb1-133" aria-hidden="true" tabindex="-1"></a>                        words <span class="op">=</span> <span class="bu">len</span>(content.split())</span>
<span id="cb1-134"><a href="#cb1-134" aria-hidden="true" tabindex="-1"></a>                        chars <span class="op">=</span> <span class="bu">len</span>(content)</span>
<span id="cb1-135"><a href="#cb1-135" aria-hidden="true" tabindex="-1"></a>                        total_words <span class="op">+=</span> words</span>
<span id="cb1-136"><a href="#cb1-136" aria-hidden="true" tabindex="-1"></a>                        total_chars <span class="op">+=</span> chars</span>
<span id="cb1-137"><a href="#cb1-137" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb1-138"><a href="#cb1-138" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">if</span> j <span class="op">==</span> <span class="dv">0</span> <span class="kw">and</span> content:</span>
<span id="cb1-139"><a href="#cb1-139" aria-hidden="true" tabindex="-1"></a>                            preview_content <span class="op">=</span> content[:<span class="dv">100</span>] <span class="op">+</span> <span class="st">&quot;...&quot;</span> <span class="cf">if</span> <span class="bu">len</span>(content) <span class="op">&gt;</span> <span class="dv">100</span> <span class="cf">else</span> content</span>
<span id="cb1-140"><a href="#cb1-140" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb1-141"><a href="#cb1-141" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">if</span> sender <span class="op">==</span> <span class="st">&#39;human&#39;</span>:</span>
<span id="cb1-142"><a href="#cb1-142" aria-hidden="true" tabindex="-1"></a>                            user_words <span class="op">+=</span> words</span>
<span id="cb1-143"><a href="#cb1-143" aria-hidden="true" tabindex="-1"></a>                            user_messages <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb1-144"><a href="#cb1-144" aria-hidden="true" tabindex="-1"></a>                            role <span class="op">=</span> <span class="st">&#39;user&#39;</span></span>
<span id="cb1-145"><a href="#cb1-145" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">elif</span> sender <span class="kw">in</span> [<span class="st">&#39;assistant&#39;</span>, <span class="st">&#39;grok&#39;</span>, <span class="st">&#39;model&#39;</span>]:</span>
<span id="cb1-146"><a href="#cb1-146" aria-hidden="true" tabindex="-1"></a>                            assistant_words <span class="op">+=</span> words</span>
<span id="cb1-147"><a href="#cb1-147" aria-hidden="true" tabindex="-1"></a>                            assistant_messages <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb1-148"><a href="#cb1-148" aria-hidden="true" tabindex="-1"></a>                            role <span class="op">=</span> <span class="st">&#39;assistant&#39;</span></span>
<span id="cb1-149"><a href="#cb1-149" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">else</span>:</span>
<span id="cb1-150"><a href="#cb1-150" aria-hidden="true" tabindex="-1"></a>                            role <span class="op">=</span> sender</span>
<span id="cb1-151"><a href="#cb1-151" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb1-152"><a href="#cb1-152" aria-hidden="true" tabindex="-1"></a>                        <span class="va">self</span>.all_messages.append({</span>
<span id="cb1-153"><a href="#cb1-153" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&#39;conversation_id&#39;</span>: conv_id,</span>
<span id="cb1-154"><a href="#cb1-154" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&#39;conversation_title&#39;</span>: title,</span>
<span id="cb1-155"><a href="#cb1-155" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&#39;message_index&#39;</span>: j,</span>
<span id="cb1-156"><a href="#cb1-156" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&#39;role&#39;</span>: role,</span>
<span id="cb1-157"><a href="#cb1-157" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&#39;sender&#39;</span>: sender,</span>
<span id="cb1-158"><a href="#cb1-158" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&#39;content&#39;</span>: content,</span>
<span id="cb1-159"><a href="#cb1-159" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&#39;word_count&#39;</span>: words,</span>
<span id="cb1-160"><a href="#cb1-160" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&#39;char_count&#39;</span>: chars,</span>
<span id="cb1-161"><a href="#cb1-161" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&#39;model&#39;</span>: msg.get(<span class="st">&#39;model&#39;</span>, <span class="st">&#39;&#39;</span>),</span>
<span id="cb1-162"><a href="#cb1-162" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&#39;response_id&#39;</span>: msg.get(<span class="st">&#39;response_id&#39;</span>, <span class="st">&#39;&#39;</span>)</span>
<span id="cb1-163"><a href="#cb1-163" aria-hidden="true" tabindex="-1"></a>                        })</span>
<span id="cb1-164"><a href="#cb1-164" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb1-165"><a href="#cb1-165" aria-hidden="true" tabindex="-1"></a>            analysis_data.append({</span>
<span id="cb1-166"><a href="#cb1-166" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;conversation_id&#39;</span>: conv_id,</span>
<span id="cb1-167"><a href="#cb1-167" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;title&#39;</span>: title,</span>
<span id="cb1-168"><a href="#cb1-168" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;created_at&#39;</span>: created_at,</span>
<span id="cb1-169"><a href="#cb1-169" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;num_messages&#39;</span>: num_messages,</span>
<span id="cb1-170"><a href="#cb1-170" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;total_words&#39;</span>: total_words,</span>
<span id="cb1-171"><a href="#cb1-171" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;total_chars&#39;</span>: total_chars,</span>
<span id="cb1-172"><a href="#cb1-172" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;user_words&#39;</span>: user_words,</span>
<span id="cb1-173"><a href="#cb1-173" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;assistant_words&#39;</span>: assistant_words,</span>
<span id="cb1-174"><a href="#cb1-174" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;user_messages&#39;</span>: user_messages,</span>
<span id="cb1-175"><a href="#cb1-175" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;assistant_messages&#39;</span>: assistant_messages,</span>
<span id="cb1-176"><a href="#cb1-176" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;preview_content&#39;</span>: preview_content,</span>
<span id="cb1-177"><a href="#cb1-177" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;avg_words_per_message&#39;</span>: total_words <span class="op">/</span> <span class="bu">max</span>(num_messages, <span class="dv">1</span>)</span>
<span id="cb1-178"><a href="#cb1-178" aria-hidden="true" tabindex="-1"></a>            })</span>
<span id="cb1-179"><a href="#cb1-179" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-180"><a href="#cb1-180" aria-hidden="true" tabindex="-1"></a>        df <span class="op">=</span> pd.DataFrame(analysis_data)</span>
<span id="cb1-181"><a href="#cb1-181" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-182"><a href="#cb1-182" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">&#39;created_at&#39;</span> <span class="kw">in</span> df.columns:</span>
<span id="cb1-183"><a href="#cb1-183" aria-hidden="true" tabindex="-1"></a>            df <span class="op">=</span> df.sort_values(<span class="st">&#39;created_at&#39;</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb1-184"><a href="#cb1-184" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-185"><a href="#cb1-185" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> df.empty:</span>
<span id="cb1-186"><a href="#cb1-186" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;üìà Total de conversas analisadas: </span><span class="sc">{</span><span class="bu">len</span>(df)<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb1-187"><a href="#cb1-187" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;üí¨ Total de mensagens: </span><span class="sc">{</span>df[<span class="st">&#39;num_messages&#39;</span>]<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb1-188"><a href="#cb1-188" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;üìù Total de palavras: </span><span class="sc">{</span>df[<span class="st">&#39;total_words&#39;</span>]<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb1-189"><a href="#cb1-189" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-190"><a href="#cb1-190" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> df, <span class="va">self</span>.all_messages</span>
<span id="cb1-191"><a href="#cb1-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-192"><a href="#cb1-192" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> categorize_conversation(<span class="va">self</span>, title):</span>
<span id="cb1-193"><a href="#cb1-193" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Categoriza conversas de forma inteligente&quot;&quot;&quot;</span></span>
<span id="cb1-194"><a href="#cb1-194" aria-hidden="true" tabindex="-1"></a>        title_lower <span class="op">=</span> title.lower()</span>
<span id="cb1-195"><a href="#cb1-195" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-196"><a href="#cb1-196" aria-hidden="true" tabindex="-1"></a>        categories <span class="op">=</span> {</span>
<span id="cb1-197"><a href="#cb1-197" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Programa√ß√£o&#39;</span>: [<span class="st">&#39;python&#39;</span>, <span class="st">&#39;programming&#39;</span>, <span class="st">&#39;code&#39;</span>, <span class="st">&#39;script&#39;</span>, <span class="st">&#39;api&#39;</span>, <span class="st">&#39;function&#39;</span>, <span class="st">&#39;class&#39;</span>],</span>
<span id="cb1-198"><a href="#cb1-198" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Sistemas&#39;</span>: [<span class="st">&#39;linux&#39;</span>, <span class="st">&#39;ubuntu&#39;</span>, <span class="st">&#39;windows&#39;</span>, <span class="st">&#39;install&#39;</span>, <span class="st">&#39;os&#39;</span>, <span class="st">&#39;system&#39;</span>],</span>
<span id="cb1-199"><a href="#cb1-199" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Ambientes&#39;</span>: [<span class="st">&#39;conda&#39;</span>, <span class="st">&#39;anaconda&#39;</span>, <span class="st">&#39;virtualenv&#39;</span>, <span class="st">&#39;package&#39;</span>, <span class="st">&#39;environment&#39;</span>],</span>
<span id="cb1-200"><a href="#cb1-200" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Exporta√ß√£o&#39;</span>: [<span class="st">&#39;markdown&#39;</span>, <span class="st">&#39;pdf&#39;</span>, <span class="st">&#39;export&#39;</span>, <span class="st">&#39;convert&#39;</span>, <span class="st">&#39;conversion&#39;</span>],</span>
<span id="cb1-201"><a href="#cb1-201" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Terminal&#39;</span>: [<span class="st">&#39;msys2&#39;</span>, <span class="st">&#39;terminal&#39;</span>, <span class="st">&#39;command&#39;</span>, <span class="st">&#39;shell&#39;</span>, <span class="st">&#39;bash&#39;</span>, <span class="st">&#39;cmd&#39;</span>],</span>
<span id="cb1-202"><a href="#cb1-202" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Fontes&#39;</span>: [<span class="st">&#39;emoji&#39;</span>, <span class="st">&#39;font&#39;</span>, <span class="st">&#39;noto&#39;</span>, <span class="st">&#39;typography&#39;</span>],</span>
<span id="cb1-203"><a href="#cb1-203" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;IA&#39;</span>: [<span class="st">&#39;ai&#39;</span>, <span class="st">&#39;gpt&#39;</span>, <span class="st">&#39;model&#39;</span>, <span class="st">&#39;neural&#39;</span>, <span class="st">&#39;machine learning&#39;</span>],</span>
<span id="cb1-204"><a href="#cb1-204" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Web&#39;</span>: [<span class="st">&#39;html&#39;</span>, <span class="st">&#39;css&#39;</span>, <span class="st">&#39;javascript&#39;</span>, <span class="st">&#39;web&#39;</span>, <span class="st">&#39;browser&#39;</span>],</span>
<span id="cb1-205"><a href="#cb1-205" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Dados&#39;</span>: [<span class="st">&#39;data&#39;</span>, <span class="st">&#39;analysis&#39;</span>, <span class="st">&#39;pandas&#39;</span>, <span class="st">&#39;dataframe&#39;</span>, <span class="st">&#39;csv&#39;</span>]</span>
<span id="cb1-206"><a href="#cb1-206" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb1-207"><a href="#cb1-207" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-208"><a href="#cb1-208" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> category, keywords <span class="kw">in</span> categories.items():</span>
<span id="cb1-209"><a href="#cb1-209" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">any</span>(keyword <span class="kw">in</span> title_lower <span class="cf">for</span> keyword <span class="kw">in</span> keywords):</span>
<span id="cb1-210"><a href="#cb1-210" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> category</span>
<span id="cb1-211"><a href="#cb1-211" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-212"><a href="#cb1-212" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">&#39;Geral&#39;</span></span>
<span id="cb1-213"><a href="#cb1-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-214"><a href="#cb1-214" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_markdown_files(<span class="va">self</span>, df):</span>
<span id="cb1-215"><a href="#cb1-215" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Cria arquivos Markdown otimizados&quot;&quot;&quot;</span></span>
<span id="cb1-216"><a href="#cb1-216" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;üìù Criando arquivos Markdown...&quot;</span>)</span>
<span id="cb1-217"><a href="#cb1-217" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-218"><a href="#cb1-218" aria-hidden="true" tabindex="-1"></a>        md_dir <span class="op">=</span> <span class="st">&quot;grok_complete_dashboard/markdown&quot;</span></span>
<span id="cb1-219"><a href="#cb1-219" aria-hidden="true" tabindex="-1"></a>        os.makedirs(md_dir, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb1-220"><a href="#cb1-220" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-221"><a href="#cb1-221" aria-hidden="true" tabindex="-1"></a>        created_files <span class="op">=</span> []</span>
<span id="cb1-222"><a href="#cb1-222" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-223"><a href="#cb1-223" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> _, row <span class="kw">in</span> df.iterrows():</span>
<span id="cb1-224"><a href="#cb1-224" aria-hidden="true" tabindex="-1"></a>            safe_title <span class="op">=</span> <span class="va">self</span>.create_safe_filename(row[<span class="st">&#39;title&#39;</span>])</span>
<span id="cb1-225"><a href="#cb1-225" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb1-226"><a href="#cb1-226" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Pular t√≠tulos gen√©ricos</span></span>
<span id="cb1-227"><a href="#cb1-227" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="va">self</span>.is_generic_title(safe_title):</span>
<span id="cb1-228"><a href="#cb1-228" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span></span>
<span id="cb1-229"><a href="#cb1-229" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb1-230"><a href="#cb1-230" aria-hidden="true" tabindex="-1"></a>            conv_messages <span class="op">=</span> [msg <span class="cf">for</span> msg <span class="kw">in</span> <span class="va">self</span>.all_messages </span>
<span id="cb1-231"><a href="#cb1-231" aria-hidden="true" tabindex="-1"></a>                           <span class="cf">if</span> msg[<span class="st">&#39;conversation_id&#39;</span>] <span class="op">==</span> row[<span class="st">&#39;conversation_id&#39;</span>]]</span>
<span id="cb1-232"><a href="#cb1-232" aria-hidden="true" tabindex="-1"></a>            conv_messages.sort(key<span class="op">=</span><span class="kw">lambda</span> x: x[<span class="st">&#39;message_index&#39;</span>])</span>
<span id="cb1-233"><a href="#cb1-233" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb1-234"><a href="#cb1-234" aria-hidden="true" tabindex="-1"></a>            md_content <span class="op">=</span> <span class="va">self</span>.generate_markdown_content(row, conv_messages)</span>
<span id="cb1-235"><a href="#cb1-235" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb1-236"><a href="#cb1-236" aria-hidden="true" tabindex="-1"></a>            md_filename <span class="op">=</span> <span class="ss">f&quot;</span><span class="sc">{</span>md_dir<span class="sc">}</span><span class="ss">/</span><span class="sc">{</span>safe_title<span class="sc">}</span><span class="ss">.md&quot;</span></span>
<span id="cb1-237"><a href="#cb1-237" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(md_filename, <span class="st">&#39;w&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb1-238"><a href="#cb1-238" aria-hidden="true" tabindex="-1"></a>                f.write(md_content)</span>
<span id="cb1-239"><a href="#cb1-239" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb1-240"><a href="#cb1-240" aria-hidden="true" tabindex="-1"></a>            created_files.append(md_filename)</span>
<span id="cb1-241"><a href="#cb1-241" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-242"><a href="#cb1-242" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ </span><span class="sc">{</span><span class="bu">len</span>(created_files)<span class="sc">}</span><span class="ss"> arquivos Markdown criados&quot;</span>)</span>
<span id="cb1-243"><a href="#cb1-243" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> md_dir</span>
<span id="cb1-244"><a href="#cb1-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-245"><a href="#cb1-245" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_safe_filename(<span class="va">self</span>, title):</span>
<span id="cb1-246"><a href="#cb1-246" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Cria nome de arquivo seguro&quot;&quot;&quot;</span></span>
<span id="cb1-247"><a href="#cb1-247" aria-hidden="true" tabindex="-1"></a>        safe <span class="op">=</span> <span class="st">&quot;&quot;</span>.join(c <span class="cf">for</span> c <span class="kw">in</span> title <span class="cf">if</span> c.isalnum() <span class="kw">or</span> c <span class="kw">in</span> (<span class="st">&#39; &#39;</span>, <span class="st">&#39;-&#39;</span>, <span class="st">&#39;_&#39;</span>)).rstrip()</span>
<span id="cb1-248"><a href="#cb1-248" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> safe[:<span class="dv">50</span>] <span class="cf">if</span> safe <span class="cf">else</span> <span class="ss">f&quot;conversa_</span><span class="sc">{</span><span class="bu">int</span>(datetime.now().timestamp())<span class="sc">}</span><span class="ss">&quot;</span></span>
<span id="cb1-249"><a href="#cb1-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-250"><a href="#cb1-250" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> is_generic_title(<span class="va">self</span>, title):</span>
<span id="cb1-251"><a href="#cb1-251" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Verifica se o t√≠tulo √© gen√©rico&quot;&quot;&quot;</span></span>
<span id="cb1-252"><a href="#cb1-252" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">bool</span>(re.match(<span class="vs">r&#39;</span><span class="dv">^</span><span class="kw">(</span><span class="vs">conversa</span><span class="cf">|</span><span class="vs">conv</span><span class="cf">|</span><span class="vs">chat</span><span class="kw">)</span><span class="dv">\s</span><span class="op">*</span><span class="dv">\d</span><span class="op">+</span><span class="dv">$</span><span class="vs">&#39;</span>, title.lower()))</span>
<span id="cb1-253"><a href="#cb1-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-254"><a href="#cb1-254" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> generate_markdown_content(<span class="va">self</span>, row, messages):</span>
<span id="cb1-255"><a href="#cb1-255" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Gera conte√∫do Markdown formatado&quot;&quot;&quot;</span></span>
<span id="cb1-256"><a href="#cb1-256" aria-hidden="true" tabindex="-1"></a>        content <span class="op">=</span> <span class="ss">f&quot;&quot;&quot;# </span><span class="sc">{</span>row[<span class="st">&#39;title&#39;</span>]<span class="sc">}</span></span>
<span id="cb1-257"><a href="#cb1-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-258"><a href="#cb1-258" aria-hidden="true" tabindex="-1"></a><span class="ss">**Data**: </span><span class="sc">{</span>row[<span class="st">&#39;created_at&#39;</span>]<span class="sc">}</span><span class="ss">  </span></span>
<span id="cb1-259"><a href="#cb1-259" aria-hidden="true" tabindex="-1"></a><span class="ss">**ID**: </span><span class="sc">{</span>row[<span class="st">&#39;conversation_id&#39;</span>]<span class="sc">}</span><span class="ss">  </span></span>
<span id="cb1-260"><a href="#cb1-260" aria-hidden="true" tabindex="-1"></a><span class="ss">**Total de Mensagens**: </span><span class="sc">{</span>row[<span class="st">&#39;num_messages&#39;</span>]<span class="sc">}</span><span class="ss">  </span></span>
<span id="cb1-261"><a href="#cb1-261" aria-hidden="true" tabindex="-1"></a><span class="ss">**Total de Palavras**: </span><span class="sc">{</span>row[<span class="st">&#39;total_words&#39;</span>]<span class="sc">}</span><span class="ss">  </span></span>
<span id="cb1-262"><a href="#cb1-262" aria-hidden="true" tabindex="-1"></a><span class="ss">**Total de Caracteres**: </span><span class="sc">{</span>row[<span class="st">&#39;total_chars&#39;</span>]<span class="sc">}</span><span class="ss">  </span></span>
<span id="cb1-263"><a href="#cb1-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-264"><a href="#cb1-264" aria-hidden="true" tabindex="-1"></a><span class="ss">---</span></span>
<span id="cb1-265"><a href="#cb1-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-266"><a href="#cb1-266" aria-hidden="true" tabindex="-1"></a><span class="ss">&quot;&quot;&quot;</span></span>
<span id="cb1-267"><a href="#cb1-267" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-268"><a href="#cb1-268" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> msg <span class="kw">in</span> messages:</span>
<span id="cb1-269"><a href="#cb1-269" aria-hidden="true" tabindex="-1"></a>            role_emoji <span class="op">=</span> <span class="st">&quot;üë§&quot;</span> <span class="cf">if</span> msg[<span class="st">&#39;role&#39;</span>] <span class="op">==</span> <span class="st">&#39;user&#39;</span> <span class="cf">else</span> <span class="st">&quot;ü§ñ&quot;</span></span>
<span id="cb1-270"><a href="#cb1-270" aria-hidden="true" tabindex="-1"></a>            role_name <span class="op">=</span> <span class="st">&quot;Usu√°rio&quot;</span> <span class="cf">if</span> msg[<span class="st">&#39;role&#39;</span>] <span class="op">==</span> <span class="st">&#39;user&#39;</span> <span class="cf">else</span> <span class="st">&quot;Assistente&quot;</span></span>
<span id="cb1-271"><a href="#cb1-271" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb1-272"><a href="#cb1-272" aria-hidden="true" tabindex="-1"></a>            content <span class="op">+=</span> <span class="ss">f&quot;&quot;&quot;</span></span>
<span id="cb1-273"><a href="#cb1-273" aria-hidden="true" tabindex="-1"></a><span class="ss">## </span><span class="sc">{</span>role_emoji<span class="sc">}</span><span class="ss"> </span><span class="sc">{</span>role_name<span class="sc">}</span></span>
<span id="cb1-274"><a href="#cb1-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-275"><a href="#cb1-275" aria-hidden="true" tabindex="-1"></a><span class="sc">{</span>msg[<span class="st">&#39;content&#39;</span>]<span class="sc">}</span></span>
<span id="cb1-276"><a href="#cb1-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-277"><a href="#cb1-277" aria-hidden="true" tabindex="-1"></a><span class="ss">---</span></span>
<span id="cb1-278"><a href="#cb1-278" aria-hidden="true" tabindex="-1"></a><span class="ss">&quot;&quot;&quot;</span></span>
<span id="cb1-279"><a href="#cb1-279" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-280"><a href="#cb1-280" aria-hidden="true" tabindex="-1"></a>        content <span class="op">+=</span> <span class="ss">f&quot;&quot;&quot;</span></span>
<span id="cb1-281"><a href="#cb1-281" aria-hidden="true" tabindex="-1"></a><span class="ss">## üìä Estat√≠sticas</span></span>
<span id="cb1-282"><a href="#cb1-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-283"><a href="#cb1-283" aria-hidden="true" tabindex="-1"></a><span class="ss">- **Mensagens do usu√°rio**: </span><span class="sc">{</span>row[<span class="st">&#39;user_messages&#39;</span>]<span class="sc">}</span></span>
<span id="cb1-284"><a href="#cb1-284" aria-hidden="true" tabindex="-1"></a><span class="ss">- **Mensagens do assistente**: </span><span class="sc">{</span>row[<span class="st">&#39;assistant_messages&#39;</span>]<span class="sc">}</span><span class="ss"> </span></span>
<span id="cb1-285"><a href="#cb1-285" aria-hidden="true" tabindex="-1"></a><span class="ss">- **Palavras do usu√°rio**: </span><span class="sc">{</span>row[<span class="st">&#39;user_words&#39;</span>]<span class="sc">}</span></span>
<span id="cb1-286"><a href="#cb1-286" aria-hidden="true" tabindex="-1"></a><span class="ss">- **Palavras do assistente**: </span><span class="sc">{</span>row[<span class="st">&#39;assistant_words&#39;</span>]<span class="sc">}</span></span>
<span id="cb1-287"><a href="#cb1-287" aria-hidden="true" tabindex="-1"></a><span class="ss">- **Palavras por mensagem (m√©dia)**: </span><span class="sc">{</span>row[<span class="st">&#39;avg_words_per_message&#39;</span>]<span class="sc">:.1f}</span></span>
<span id="cb1-288"><a href="#cb1-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-289"><a href="#cb1-289" aria-hidden="true" tabindex="-1"></a><span class="ss">*Exportado automaticamente em </span><span class="sc">{</span>datetime<span class="sc">.</span>now()<span class="sc">.</span>strftime(<span class="st">&#39;</span><span class="sc">%d</span><span class="st">/%m/%Y %H:%M&#39;</span>)<span class="sc">}</span><span class="ss">*</span></span>
<span id="cb1-290"><a href="#cb1-290" aria-hidden="true" tabindex="-1"></a><span class="ss">&quot;&quot;&quot;</span></span>
<span id="cb1-291"><a href="#cb1-291" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> content</span>
<span id="cb1-292"><a href="#cb1-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-293"><a href="#cb1-293" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_dashboard(<span class="va">self</span>, df):</span>
<span id="cb1-294"><a href="#cb1-294" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Cria dashboard HTML otimizado&quot;&quot;&quot;</span></span>
<span id="cb1-295"><a href="#cb1-295" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;üé® Criando dashboard...&quot;</span>)</span>
<span id="cb1-296"><a href="#cb1-296" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-297"><a href="#cb1-297" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Adicionar categorias</span></span>
<span id="cb1-298"><a href="#cb1-298" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">&#39;category&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;title&#39;</span>].<span class="bu">apply</span>(<span class="va">self</span>.categorize_conversation)</span>
<span id="cb1-299"><a href="#cb1-299" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-300"><a href="#cb1-300" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Filtrar conversas n√£o gen√©ricas</span></span>
<span id="cb1-301"><a href="#cb1-301" aria-hidden="true" tabindex="-1"></a>        saved_conversations <span class="op">=</span> []</span>
<span id="cb1-302"><a href="#cb1-302" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> _, row <span class="kw">in</span> df.iterrows():</span>
<span id="cb1-303"><a href="#cb1-303" aria-hidden="true" tabindex="-1"></a>            safe_title <span class="op">=</span> <span class="va">self</span>.create_safe_filename(row[<span class="st">&#39;title&#39;</span>])</span>
<span id="cb1-304"><a href="#cb1-304" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.is_generic_title(safe_title):</span>
<span id="cb1-305"><a href="#cb1-305" aria-hidden="true" tabindex="-1"></a>                saved_conversations.append((_, row))</span>
<span id="cb1-306"><a href="#cb1-306" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-307"><a href="#cb1-307" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Estat√≠sticas</span></span>
<span id="cb1-308"><a href="#cb1-308" aria-hidden="true" tabindex="-1"></a>        total_conv <span class="op">=</span> <span class="bu">len</span>(saved_conversations)</span>
<span id="cb1-309"><a href="#cb1-309" aria-hidden="true" tabindex="-1"></a>        total_msgs <span class="op">=</span> <span class="bu">sum</span>(row[<span class="st">&#39;num_messages&#39;</span>] <span class="cf">for</span> _, row <span class="kw">in</span> saved_conversations)</span>
<span id="cb1-310"><a href="#cb1-310" aria-hidden="true" tabindex="-1"></a>        total_words <span class="op">=</span> <span class="bu">sum</span>(row[<span class="st">&#39;total_words&#39;</span>] <span class="cf">for</span> _, row <span class="kw">in</span> saved_conversations)</span>
<span id="cb1-311"><a href="#cb1-311" aria-hidden="true" tabindex="-1"></a>        total_chars <span class="op">=</span> <span class="bu">sum</span>(row[<span class="st">&#39;total_chars&#39;</span>] <span class="cf">for</span> _, row <span class="kw">in</span> saved_conversations)</span>
<span id="cb1-312"><a href="#cb1-312" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-313"><a href="#cb1-313" aria-hidden="true" tabindex="-1"></a>        html_content <span class="op">=</span> <span class="va">self</span>.generate_dashboard_html(saved_conversations, total_conv, total_msgs, total_words, total_chars)</span>
<span id="cb1-314"><a href="#cb1-314" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-315"><a href="#cb1-315" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> <span class="bu">open</span>(<span class="st">&quot;grok_complete_dashboard/index.html&quot;</span>, <span class="st">&quot;w&quot;</span>, encoding<span class="op">=</span><span class="st">&quot;utf-8&quot;</span>) <span class="im">as</span> f:</span>
<span id="cb1-316"><a href="#cb1-316" aria-hidden="true" tabindex="-1"></a>            f.write(html_content)</span>
<span id="cb1-317"><a href="#cb1-317" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-318"><a href="#cb1-318" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;‚úÖ Dashboard criado: grok_complete_dashboard/index.html&quot;</span>)</span>
<span id="cb1-319"><a href="#cb1-319" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">&quot;grok_complete_dashboard/index.html&quot;</span></span>
<span id="cb1-320"><a href="#cb1-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-321"><a href="#cb1-321" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> generate_dashboard_html(<span class="va">self</span>, conversations, total_conv, total_msgs, total_words, total_chars):</span>
<span id="cb1-322"><a href="#cb1-322" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Gera HTML do dashboard&quot;&quot;&quot;</span></span>
<span id="cb1-323"><a href="#cb1-323" aria-hidden="true" tabindex="-1"></a>        current_date <span class="op">=</span> datetime.now().strftime(<span class="st">&#39;</span><span class="sc">%d</span><span class="st">/%m/%Y %H:%M&#39;</span>)</span>
<span id="cb1-324"><a href="#cb1-324" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-325"><a href="#cb1-325" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="ss">f&quot;&quot;&quot;</span></span>
<span id="cb1-326"><a href="#cb1-326" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;!DOCTYPE html&gt;</span></span>
<span id="cb1-327"><a href="#cb1-327" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;html lang=&quot;pt&quot;&gt;</span></span>
<span id="cb1-328"><a href="#cb1-328" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;head&gt;</span></span>
<span id="cb1-329"><a href="#cb1-329" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span></span>
<span id="cb1-330"><a href="#cb1-330" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span></span>
<span id="cb1-331"><a href="#cb1-331" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;title&gt;Grok - Hist√≥rico Completo&lt;/title&gt;</span></span>
<span id="cb1-332"><a href="#cb1-332" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;style&gt;</span></span>
<span id="cb1-333"><a href="#cb1-333" aria-hidden="true" tabindex="-1"></a><span class="ss">        /* CSS otimizado - mantido do original */</span></span>
<span id="cb1-334"><a href="#cb1-334" aria-hidden="true" tabindex="-1"></a><span class="ss">        * </span><span class="ch">{{</span><span class="ss"> margin: 0; padding: 0; box-sizing: border-box; </span><span class="ch">}}</span></span>
<span id="cb1-335"><a href="#cb1-335" aria-hidden="true" tabindex="-1"></a><span class="ss">        body </span><span class="ch">{{</span><span class="ss"> font-family: -apple-system, BlinkMacSystemFont, &#39;Segoe UI&#39;, Roboto, sans-serif; background: #f8f9fa; color: #2c3e50; line-height: 1.6; </span><span class="ch">}}</span></span>
<span id="cb1-336"><a href="#cb1-336" aria-hidden="true" tabindex="-1"></a><span class="ss">        .container </span><span class="ch">{{</span><span class="ss"> max-width: 1400px; margin: 0 auto; padding: 20px; </span><span class="ch">}}</span></span>
<span id="cb1-337"><a href="#cb1-337" aria-hidden="true" tabindex="-1"></a><span class="ss">        .header </span><span class="ch">{{</span><span class="ss"> text-align: center; margin-bottom: 40px; padding: 40px 20px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border-radius: 15px; </span><span class="ch">}}</span></span>
<span id="cb1-338"><a href="#cb1-338" aria-hidden="true" tabindex="-1"></a><span class="ss">        .stats-bar </span><span class="ch">{{</span><span class="ss"> display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; margin: 30px 0; text-align: center; </span><span class="ch">}}</span></span>
<span id="cb1-339"><a href="#cb1-339" aria-hidden="true" tabindex="-1"></a><span class="ss">        .conversation-grid </span><span class="ch">{{</span><span class="ss"> display: grid; grid-template-columns: repeat(2, 1fr); gap: 25px; </span><span class="ch">}}</span></span>
<span id="cb1-340"><a href="#cb1-340" aria-hidden="true" tabindex="-1"></a><span class="ss">        .conversation-card </span><span class="ch">{{</span><span class="ss"> background: white; border-radius: 12px; padding: 25px; box-shadow: 0 4px 15px rgba(0,0,0,0.08); transition: transform 0.2s ease; </span><span class="ch">}}</span></span>
<span id="cb1-341"><a href="#cb1-341" aria-hidden="true" tabindex="-1"></a><span class="ss">        @media (max-width: 1200px) </span><span class="ch">{{</span><span class="ss"> .conversation-grid </span><span class="ch">{{</span><span class="ss"> grid-template-columns: 1fr; </span><span class="ch">}}</span><span class="ss"> </span><span class="ch">}}</span></span>
<span id="cb1-342"><a href="#cb1-342" aria-hidden="true" tabindex="-1"></a><span class="ss">        @media (max-width: 768px) </span><span class="ch">{{</span><span class="ss"> .stats-bar </span><span class="ch">{{</span><span class="ss"> grid-template-columns: repeat(2, 1fr); </span><span class="ch">}}</span><span class="ss"> </span><span class="ch">}}</span></span>
<span id="cb1-343"><a href="#cb1-343" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;/style&gt;</span></span>
<span id="cb1-344"><a href="#cb1-344" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;/head&gt;</span></span>
<span id="cb1-345"><a href="#cb1-345" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;body&gt;</span></span>
<span id="cb1-346"><a href="#cb1-346" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;div class=&quot;container&quot;&gt;</span></span>
<span id="cb1-347"><a href="#cb1-347" aria-hidden="true" tabindex="-1"></a><span class="ss">        &lt;div class=&quot;header&quot;&gt;</span></span>
<span id="cb1-348"><a href="#cb1-348" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;h1&gt;Grok - Hist√≥rico Completo&lt;/h1&gt;</span></span>
<span id="cb1-349"><a href="#cb1-349" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;div class=&quot;subtitle&quot;&gt;Exporta√ß√£o otimizada com Markdown + PDF&lt;/div&gt;</span></span>
<span id="cb1-350"><a href="#cb1-350" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span></span>
<span id="cb1-351"><a href="#cb1-351" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;div class=&quot;stats-bar&quot;&gt;</span></span>
<span id="cb1-352"><a href="#cb1-352" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;div class=&quot;stat-item&quot;&gt;&lt;span class=&quot;stat-number&quot;&gt;</span><span class="sc">{</span>total_conv<span class="sc">}</span><span class="ss">&lt;/span&gt;&lt;span class=&quot;stat-label&quot;&gt;Conversas&lt;/span&gt;&lt;/div&gt;</span></span>
<span id="cb1-353"><a href="#cb1-353" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;div class=&quot;stat-item&quot;&gt;&lt;span class=&quot;stat-number&quot;&gt;</span><span class="sc">{</span>total_msgs<span class="sc">}</span><span class="ss">&lt;/span&gt;&lt;span class=&quot;stat-label&quot;&gt;Mensagens&lt;/span&gt;&lt;/div&gt;</span></span>
<span id="cb1-354"><a href="#cb1-354" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;div class=&quot;stat-item&quot;&gt;&lt;span class=&quot;stat-number&quot;&gt;</span><span class="sc">{</span>total_words<span class="sc">:,}</span><span class="ss">&lt;/span&gt;&lt;span class=&quot;stat-label&quot;&gt;Palavras&lt;/span&gt;&lt;/div&gt;</span></span>
<span id="cb1-355"><a href="#cb1-355" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;div class=&quot;stat-item&quot;&gt;&lt;span class=&quot;stat-number&quot;&gt;</span><span class="sc">{</span>total_chars<span class="sc">:,}</span><span class="ss">&lt;/span&gt;&lt;span class=&quot;stat-label&quot;&gt;Caracteres&lt;/span&gt;&lt;/div&gt;</span></span>
<span id="cb1-356"><a href="#cb1-356" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;/div&gt;</span></span>
<span id="cb1-357"><a href="#cb1-357" aria-hidden="true" tabindex="-1"></a><span class="ss">        &lt;/div&gt;</span></span>
<span id="cb1-358"><a href="#cb1-358" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb1-359"><a href="#cb1-359" aria-hidden="true" tabindex="-1"></a><span class="ss">        &lt;div class=&quot;conversation-grid&quot;&gt;</span></span>
<span id="cb1-360"><a href="#cb1-360" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span><span class="sc">{</span><span class="st">&quot;&quot;</span><span class="sc">.</span>join(<span class="va">self</span>.generate_conversation_cards(conversations))<span class="sc">}</span></span>
<span id="cb1-361"><a href="#cb1-361" aria-hidden="true" tabindex="-1"></a><span class="ss">        &lt;/div&gt;</span></span>
<span id="cb1-362"><a href="#cb1-362" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb1-363"><a href="#cb1-363" aria-hidden="true" tabindex="-1"></a><span class="ss">        &lt;div class=&quot;footer&quot;&gt;</span></span>
<span id="cb1-364"><a href="#cb1-364" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;p&gt;Dashboard gerado automaticamente em </span><span class="sc">{</span>current_date<span class="sc">}</span><span class="ss">&lt;/p&gt;</span></span>
<span id="cb1-365"><a href="#cb1-365" aria-hidden="true" tabindex="-1"></a><span class="ss">        &lt;/div&gt;</span></span>
<span id="cb1-366"><a href="#cb1-366" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;/div&gt;</span></span>
<span id="cb1-367"><a href="#cb1-367" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;/body&gt;</span></span>
<span id="cb1-368"><a href="#cb1-368" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;/html&gt;</span></span>
<span id="cb1-369"><a href="#cb1-369" aria-hidden="true" tabindex="-1"></a><span class="ss">&quot;&quot;&quot;</span></span>
<span id="cb1-370"><a href="#cb1-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-371"><a href="#cb1-371" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> generate_conversation_cards(<span class="va">self</span>, conversations):</span>
<span id="cb1-372"><a href="#cb1-372" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Gera cards de conversa para o dashboard&quot;&quot;&quot;</span></span>
<span id="cb1-373"><a href="#cb1-373" aria-hidden="true" tabindex="-1"></a>        cards <span class="op">=</span> []</span>
<span id="cb1-374"><a href="#cb1-374" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> idx, (_, row) <span class="kw">in</span> <span class="bu">enumerate</span>(conversations, <span class="dv">1</span>):</span>
<span id="cb1-375"><a href="#cb1-375" aria-hidden="true" tabindex="-1"></a>            safe_title <span class="op">=</span> <span class="va">self</span>.create_safe_filename(row[<span class="st">&#39;title&#39;</span>])</span>
<span id="cb1-376"><a href="#cb1-376" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb1-377"><a href="#cb1-377" aria-hidden="true" tabindex="-1"></a>            cards.append(<span class="ss">f&quot;&quot;&quot;</span></span>
<span id="cb1-378"><a href="#cb1-378" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;div class=&quot;conversation-card&quot;&gt;</span></span>
<span id="cb1-379"><a href="#cb1-379" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;div class=&quot;conversation-header&quot;&gt;</span></span>
<span id="cb1-380"><a href="#cb1-380" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;span class=&quot;conversation-category&quot;&gt;</span><span class="sc">{</span>row[<span class="st">&#39;category&#39;</span>]<span class="sc">}</span><span class="ss">&lt;/span&gt;</span></span>
<span id="cb1-381"><a href="#cb1-381" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;span class=&quot;conversation-number&quot;&gt;#</span><span class="sc">{</span>idx<span class="sc">}</span><span class="ss">&lt;/span&gt;</span></span>
<span id="cb1-382"><a href="#cb1-382" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;/div&gt;</span></span>
<span id="cb1-383"><a href="#cb1-383" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;div class=&quot;conversation-title&quot;&gt;</span><span class="sc">{</span>row[<span class="st">&#39;title&#39;</span>]<span class="sc">}</span><span class="ss">&lt;/div&gt;</span></span>
<span id="cb1-384"><a href="#cb1-384" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;div class=&quot;conversation-date&quot;&gt;</span><span class="sc">{</span>row<span class="sc">.</span>get(<span class="st">&#39;created_at&#39;</span>, <span class="st">&#39;&#39;</span>)<span class="sc">}</span><span class="ss">&lt;/div&gt;</span></span>
<span id="cb1-385"><a href="#cb1-385" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;div class=&quot;conversation-preview&quot;&gt;</span><span class="sc">{</span>row<span class="sc">.</span>get(<span class="st">&#39;preview_content&#39;</span>, <span class="st">&#39;&#39;</span>)<span class="sc">}</span><span class="ss">&lt;/div&gt;</span></span>
<span id="cb1-386"><a href="#cb1-386" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;div class=&quot;conversation-stats&quot;&gt;</span></span>
<span id="cb1-387"><a href="#cb1-387" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;div class=&quot;stat-box&quot;&gt;&lt;span class=&quot;stat-value&quot;&gt;</span><span class="sc">{</span>row[<span class="st">&#39;num_messages&#39;</span>]<span class="sc">}</span><span class="ss">&lt;/span&gt;&lt;span class=&quot;stat-name&quot;&gt;Mensagens&lt;/span&gt;&lt;/div&gt;</span></span>
<span id="cb1-388"><a href="#cb1-388" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;div class=&quot;stat-box&quot;&gt;&lt;span class=&quot;stat-value&quot;&gt;</span><span class="sc">{</span>row[<span class="st">&#39;total_words&#39;</span>]<span class="sc">}</span><span class="ss">&lt;/span&gt;&lt;span class=&quot;stat-name&quot;&gt;Palavras&lt;/span&gt;&lt;/div&gt;</span></span>
<span id="cb1-389"><a href="#cb1-389" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;/div&gt;</span></span>
<span id="cb1-390"><a href="#cb1-390" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;div class=&quot;conversation-actions&quot;&gt;</span></span>
<span id="cb1-391"><a href="#cb1-391" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;a href=&quot;markdown/</span><span class="sc">{</span>safe_title<span class="sc">}</span><span class="ss">.md&quot; class=&quot;action-btn btn-md&quot; target=&quot;_blank&quot;&gt;üìÑ Markdown&lt;/a&gt;</span></span>
<span id="cb1-392"><a href="#cb1-392" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;a href=&quot;pdf/conversas/</span><span class="sc">{</span>safe_title<span class="sc">}</span><span class="ss">.pdf&quot; class=&quot;action-btn btn-pdf&quot; target=&quot;_blank&quot;&gt;üìä PDF&lt;/a&gt;</span></span>
<span id="cb1-393"><a href="#cb1-393" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;/div&gt;</span></span>
<span id="cb1-394"><a href="#cb1-394" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;/div&gt;</span></span>
<span id="cb1-395"><a href="#cb1-395" aria-hidden="true" tabindex="-1"></a><span class="ss">            &quot;&quot;&quot;</span>)</span>
<span id="cb1-396"><a href="#cb1-396" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> cards</span>
<span id="cb1-397"><a href="#cb1-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-398"><a href="#cb1-398" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> main():</span>
<span id="cb1-399"><a href="#cb1-399" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;üöÄ Iniciando Grok Processor Otimizado&quot;</span>)</span>
<span id="cb1-400"><a href="#cb1-400" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;=&quot;</span> <span class="op">*</span> <span class="dv">50</span>)</span>
<span id="cb1-401"><a href="#cb1-401" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-402"><a href="#cb1-402" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Criar estrutura de pastas</span></span>
<span id="cb1-403"><a href="#cb1-403" aria-hidden="true" tabindex="-1"></a>    os.makedirs(<span class="st">&quot;grok_complete_dashboard/pdf/conversas&quot;</span>, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb1-404"><a href="#cb1-404" aria-hidden="true" tabindex="-1"></a>    os.makedirs(<span class="st">&quot;grok_complete_dashboard/markdown&quot;</span>, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb1-405"><a href="#cb1-405" aria-hidden="true" tabindex="-1"></a>    os.makedirs(<span class="st">&quot;grok_complete_dashboard/data&quot;</span>, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb1-406"><a href="#cb1-406" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-407"><a href="#cb1-407" aria-hidden="true" tabindex="-1"></a>    processor <span class="op">=</span> GrokProcessor()</span>
<span id="cb1-408"><a href="#cb1-408" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-409"><a href="#cb1-409" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Carregar dados</span></span>
<span id="cb1-410"><a href="#cb1-410" aria-hidden="true" tabindex="-1"></a>    all_data <span class="op">=</span> processor.load_grok_data()</span>
<span id="cb1-411"><a href="#cb1-411" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> all_data:</span>
<span id="cb1-412"><a href="#cb1-412" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span></span>
<span id="cb1-413"><a href="#cb1-413" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-414"><a href="#cb1-414" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Processar conversas</span></span>
<span id="cb1-415"><a href="#cb1-415" aria-hidden="true" tabindex="-1"></a>    processor.extract_conversations(all_data)</span>
<span id="cb1-416"><a href="#cb1-416" aria-hidden="true" tabindex="-1"></a>    df, all_messages <span class="op">=</span> processor.analyze_conversations()</span>
<span id="cb1-417"><a href="#cb1-417" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-418"><a href="#cb1-418" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> df.empty:</span>
<span id="cb1-419"><a href="#cb1-419" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;‚ùå Nenhuma conversa v√°lida!&quot;</span>)</span>
<span id="cb1-420"><a href="#cb1-420" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span></span>
<span id="cb1-421"><a href="#cb1-421" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-422"><a href="#cb1-422" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Criar Markdown e Dashboard</span></span>
<span id="cb1-423"><a href="#cb1-423" aria-hidden="true" tabindex="-1"></a>    processor.create_markdown_files(df)</span>
<span id="cb1-424"><a href="#cb1-424" aria-hidden="true" tabindex="-1"></a>    index_file <span class="op">=</span> processor.create_dashboard(df)</span>
<span id="cb1-425"><a href="#cb1-425" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-426"><a href="#cb1-426" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Salvar dados</span></span>
<span id="cb1-427"><a href="#cb1-427" aria-hidden="true" tabindex="-1"></a>    df.to_csv(<span class="st">&quot;grok_complete_dashboard/data/processed_conversations.csv&quot;</span>, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb1-428"><a href="#cb1-428" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-429"><a href="#cb1-429" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> all_messages:</span>
<span id="cb1-430"><a href="#cb1-430" aria-hidden="true" tabindex="-1"></a>        pd.DataFrame(all_messages).to_csv(<span class="st">&quot;grok_complete_dashboard/data/all_messages.csv&quot;</span>, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb1-431"><a href="#cb1-431" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-432"><a href="#cb1-432" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Abrir dashboard</span></span>
<span id="cb1-433"><a href="#cb1-433" aria-hidden="true" tabindex="-1"></a>    webbrowser.<span class="bu">open</span>(<span class="ss">f&#39;file://</span><span class="sc">{</span>os<span class="sc">.</span>path<span class="sc">.</span>abspath(index_file)<span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb1-434"><a href="#cb1-434" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-435"><a href="#cb1-435" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span> <span class="op">+</span> <span class="st">&quot;=&quot;</span> <span class="op">*</span> <span class="dv">50</span>)</span>
<span id="cb1-436"><a href="#cb1-436" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;üéâ PROCESSAMENTO CONCLU√çDO!&quot;</span>)</span>
<span id="cb1-437"><a href="#cb1-437" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;=&quot;</span> <span class="op">*</span> <span class="dv">50</span>)</span>
<span id="cb1-438"><a href="#cb1-438" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;üìÅ Pr√≥ximo passo: Execute o conversor PDF&quot;</span>)</span>
<span id="cb1-439"><a href="#cb1-439" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;   python grok_pdf_converter.py&quot;</span>)</span>
<span id="cb1-440"><a href="#cb1-440" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;=&quot;</span> <span class="op">*</span> <span class="dv">50</span>)</span>
<span id="cb1-441"><a href="#cb1-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-442"><a href="#cb1-442" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&quot;__main__&quot;</span>:</span>
<span id="cb1-443"><a href="#cb1-443" aria-hidden="true" tabindex="-1"></a>    main()</span></code></pre></div>
<h2 data-number="2.2" id="script-de-convers√£o-pdf-otimizado"><span class="header-section-number">2.2</span> 2. Script de Convers√£o PDF
Otimizado</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># grok_pdf_converter.py</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> asyncio</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> subprocess</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tempfile</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sys</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> PDFConverter:</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.md_dir <span class="op">=</span> <span class="st">&quot;grok_complete_dashboard/markdown&quot;</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.pdf_dir <span class="op">=</span> <span class="st">&quot;grok_complete_dashboard/pdf/conversas&quot;</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.html_dir <span class="op">=</span> <span class="st">&quot;grok_complete_dashboard/html_temp&quot;</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> check_dependencies(<span class="va">self</span>):</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Verifica se todas as depend√™ncias est√£o instaladas&quot;&quot;&quot;</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;üîç Verificando depend√™ncias...&quot;</span>)</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>        dependencies <span class="op">=</span> {</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;pandoc&#39;</span>: <span class="va">self</span>.check_pandoc(),</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;playwright&#39;</span>: <span class="va">self</span>.check_playwright()</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>        all_ok <span class="op">=</span> <span class="bu">all</span>(dependencies.values())</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> all_ok:</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">‚ö†Ô∏è  Depend√™ncias faltando:&quot;</span>)</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> dep, installed <span class="kw">in</span> dependencies.items():</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="kw">not</span> installed:</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="ss">f&quot;   ‚ùå </span><span class="sc">{</span>dep<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">üì¶ Instale as depend√™ncias faltantes:&quot;</span>)</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> dependencies[<span class="st">&#39;pandoc&#39;</span>]:</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;   Ubuntu/Debian: sudo apt-get install pandoc&quot;</span>)</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;   macOS: brew install pandoc&quot;</span>)</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;   Windows: choco install pandoc&quot;</span>)</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> dependencies[<span class="st">&#39;playwright&#39;</span>]:</span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;   pip install playwright &amp;&amp; playwright install chromium&quot;</span>)</span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> all_ok</span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> check_pandoc(<span class="va">self</span>):</span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Verifica se pandoc est√° instalado&quot;&quot;&quot;</span></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>            result <span class="op">=</span> subprocess.run([<span class="st">&#39;pandoc&#39;</span>, <span class="st">&#39;--version&#39;</span>], </span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>                                  capture_output<span class="op">=</span><span class="va">True</span>, text<span class="op">=</span><span class="va">True</span>, timeout<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> result.returncode <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>                version_line <span class="op">=</span> result.stdout.split(<span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>)[<span class="dv">0</span>]</span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ Pandoc: </span><span class="sc">{</span>version_line<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span>:</span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a>            <span class="cf">pass</span></span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;‚ùå Pandoc n√£o encontrado&quot;</span>)</span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> check_playwright(<span class="va">self</span>):</span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Verifica se playwright est√° dispon√≠vel&quot;&quot;&quot;</span></span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a>            <span class="im">import</span> playwright</span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;‚úÖ Playwright: Dispon√≠vel&quot;</span>)</span>
<span id="cb2-63"><a href="#cb2-63" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb2-64"><a href="#cb2-64" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">ImportError</span>:</span>
<span id="cb2-65"><a href="#cb2-65" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;‚ùå Playwright n√£o instalado&quot;</span>)</span>
<span id="cb2-66"><a href="#cb2-66" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb2-67"><a href="#cb2-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-68"><a href="#cb2-68" aria-hidden="true" tabindex="-1"></a>    <span class="cf">async</span> <span class="kw">def</span> convert_with_pandoc(<span class="va">self</span>, md_file, pdf_output):</span>
<span id="cb2-69"><a href="#cb2-69" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Converte Markdown para PDF usando Pandoc (m√©todo preferido)&quot;&quot;&quot;</span></span>
<span id="cb2-70"><a href="#cb2-70" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb2-71"><a href="#cb2-71" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Template HTML otimizado para Pandoc</span></span>
<span id="cb2-72"><a href="#cb2-72" aria-hidden="true" tabindex="-1"></a>            html_template <span class="op">=</span> <span class="st">&quot;&quot;&quot;</span></span>
<span id="cb2-73"><a href="#cb2-73" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;!DOCTYPE html&gt;</span></span>
<span id="cb2-74"><a href="#cb2-74" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;html&gt;</span></span>
<span id="cb2-75"><a href="#cb2-75" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;head&gt;</span></span>
<span id="cb2-76"><a href="#cb2-76" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span></span>
<span id="cb2-77"><a href="#cb2-77" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;title&gt;</span><span class="sc">{{</span><span class="st">TITLE</span><span class="sc">}}</span><span class="st">&lt;/title&gt;</span></span>
<span id="cb2-78"><a href="#cb2-78" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;style&gt;</span></span>
<span id="cb2-79"><a href="#cb2-79" aria-hidden="true" tabindex="-1"></a><span class="st">        body </span><span class="sc">{{</span><span class="st"> </span></span>
<span id="cb2-80"><a href="#cb2-80" aria-hidden="true" tabindex="-1"></a><span class="st">            font-family: -apple-system, BlinkMacSystemFont, &#39;Segoe UI&#39;, Roboto, sans-serif;</span></span>
<span id="cb2-81"><a href="#cb2-81" aria-hidden="true" tabindex="-1"></a><span class="st">            margin: 40px;</span></span>
<span id="cb2-82"><a href="#cb2-82" aria-hidden="true" tabindex="-1"></a><span class="st">            line-height: 1.6;</span></span>
<span id="cb2-83"><a href="#cb2-83" aria-hidden="true" tabindex="-1"></a><span class="st">            color: #2c3e50;</span></span>
<span id="cb2-84"><a href="#cb2-84" aria-hidden="true" tabindex="-1"></a><span class="st">            max-width: 800px;</span></span>
<span id="cb2-85"><a href="#cb2-85" aria-hidden="true" tabindex="-1"></a><span class="st">            margin: 0 auto;</span></span>
<span id="cb2-86"><a href="#cb2-86" aria-hidden="true" tabindex="-1"></a><span class="st">            padding: 40px 20px;</span></span>
<span id="cb2-87"><a href="#cb2-87" aria-hidden="true" tabindex="-1"></a><span class="st">        </span><span class="sc">}}</span></span>
<span id="cb2-88"><a href="#cb2-88" aria-hidden="true" tabindex="-1"></a><span class="st">        .header </span><span class="sc">{{</span><span class="st"> </span></span>
<span id="cb2-89"><a href="#cb2-89" aria-hidden="true" tabindex="-1"></a><span class="st">            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);</span></span>
<span id="cb2-90"><a href="#cb2-90" aria-hidden="true" tabindex="-1"></a><span class="st">            color: white; </span></span>
<span id="cb2-91"><a href="#cb2-91" aria-hidden="true" tabindex="-1"></a><span class="st">            padding: 40px; </span></span>
<span id="cb2-92"><a href="#cb2-92" aria-hidden="true" tabindex="-1"></a><span class="st">            border-radius: 15px;</span></span>
<span id="cb2-93"><a href="#cb2-93" aria-hidden="true" tabindex="-1"></a><span class="st">            margin-bottom: 40px;</span></span>
<span id="cb2-94"><a href="#cb2-94" aria-hidden="true" tabindex="-1"></a><span class="st">            text-align: center;</span></span>
<span id="cb2-95"><a href="#cb2-95" aria-hidden="true" tabindex="-1"></a><span class="st">        </span><span class="sc">}}</span></span>
<span id="cb2-96"><a href="#cb2-96" aria-hidden="true" tabindex="-1"></a><span class="st">        h1 </span><span class="sc">{{</span><span class="st"> color: #2c3e50; border-bottom: 3px solid #3498db; padding-bottom: 10px; </span><span class="sc">}}</span></span>
<span id="cb2-97"><a href="#cb2-97" aria-hidden="true" tabindex="-1"></a><span class="st">        h2 </span><span class="sc">{{</span><span class="st"> color: #34495e; border-bottom: 2px solid #ecf0f1; padding-bottom: 8px; </span><span class="sc">}}</span></span>
<span id="cb2-98"><a href="#cb2-98" aria-hidden="true" tabindex="-1"></a><span class="st">        code </span><span class="sc">{{</span><span class="st"> background: #f8f9fa; padding: 2px 6px; border-radius: 4px; </span><span class="sc">}}</span></span>
<span id="cb2-99"><a href="#cb2-99" aria-hidden="true" tabindex="-1"></a><span class="st">        pre </span><span class="sc">{{</span><span class="st"> background: #2c3e50; color: #ecf0f1; padding: 20px; border-radius: 8px; overflow-x: auto; </span><span class="sc">}}</span></span>
<span id="cb2-100"><a href="#cb2-100" aria-hidden="true" tabindex="-1"></a><span class="st">        blockquote </span><span class="sc">{{</span><span class="st"> border-left: 4px solid #3498db; padding-left: 20px; margin-left: 0; color: #7f8c8d; </span><span class="sc">}}</span></span>
<span id="cb2-101"><a href="#cb2-101" aria-hidden="true" tabindex="-1"></a><span class="st">        .footer </span><span class="sc">{{</span><span class="st"> text-align: center; margin-top: 50px; padding: 30px; color: #7f8c8d; border-top: 1px solid #e9ecef; </span><span class="sc">}}</span></span>
<span id="cb2-102"><a href="#cb2-102" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;/style&gt;</span></span>
<span id="cb2-103"><a href="#cb2-103" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;/head&gt;</span></span>
<span id="cb2-104"><a href="#cb2-104" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;body&gt;</span></span>
<span id="cb2-105"><a href="#cb2-105" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;div class=&quot;header&quot;&gt;</span></span>
<span id="cb2-106"><a href="#cb2-106" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;h1&gt;</span><span class="sc">{{</span><span class="st">TITLE</span><span class="sc">}}</span><span class="st">&lt;/h1&gt;</span></span>
<span id="cb2-107"><a href="#cb2-107" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;p&gt;Conversa exportada do Grok - Gerado com Pandoc&lt;/p&gt;</span></span>
<span id="cb2-108"><a href="#cb2-108" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;/div&gt;</span></span>
<span id="cb2-109"><a href="#cb2-109" aria-hidden="true" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb2-110"><a href="#cb2-110" aria-hidden="true" tabindex="-1"></a><span class="st">    </span><span class="sc">{{</span><span class="st">CONTENT</span><span class="sc">}}</span></span>
<span id="cb2-111"><a href="#cb2-111" aria-hidden="true" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb2-112"><a href="#cb2-112" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;div class=&quot;footer&quot;&gt;</span></span>
<span id="cb2-113"><a href="#cb2-113" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;p&gt;Documento gerado automaticamente em </span><span class="sc">{{</span><span class="st">DATE</span><span class="sc">}}</span><span class="st">&lt;/p&gt;</span></span>
<span id="cb2-114"><a href="#cb2-114" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;/div&gt;</span></span>
<span id="cb2-115"><a href="#cb2-115" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;/body&gt;</span></span>
<span id="cb2-116"><a href="#cb2-116" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;/html&gt;</span></span>
<span id="cb2-117"><a href="#cb2-117" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;&quot;&quot;</span></span>
<span id="cb2-118"><a href="#cb2-118" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb2-119"><a href="#cb2-119" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Ler conte√∫do Markdown</span></span>
<span id="cb2-120"><a href="#cb2-120" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(md_file, <span class="st">&#39;r&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb2-121"><a href="#cb2-121" aria-hidden="true" tabindex="-1"></a>                md_content <span class="op">=</span> f.read()</span>
<span id="cb2-122"><a href="#cb2-122" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb2-123"><a href="#cb2-123" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Criar arquivo HTML tempor√°rio</span></span>
<span id="cb2-124"><a href="#cb2-124" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> tempfile.NamedTemporaryFile(mode<span class="op">=</span><span class="st">&#39;w&#39;</span>, suffix<span class="op">=</span><span class="st">&#39;.html&#39;</span>, delete<span class="op">=</span><span class="va">False</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb2-125"><a href="#cb2-125" aria-hidden="true" tabindex="-1"></a>                html_content <span class="op">=</span> html_template.replace(<span class="st">&#39;</span><span class="sc">{{</span><span class="st">TITLE</span><span class="sc">}}</span><span class="st">&#39;</span>, md_file.stem)</span>
<span id="cb2-126"><a href="#cb2-126" aria-hidden="true" tabindex="-1"></a>                html_content <span class="op">=</span> html_content.replace(<span class="st">&#39;</span><span class="sc">{{</span><span class="st">CONTENT</span><span class="sc">}}</span><span class="st">&#39;</span>, md_content)</span>
<span id="cb2-127"><a href="#cb2-127" aria-hidden="true" tabindex="-1"></a>                html_content <span class="op">=</span> html_content.replace(<span class="st">&#39;</span><span class="sc">{{</span><span class="st">DATE</span><span class="sc">}}</span><span class="st">&#39;</span>, datetime.now().strftime(<span class="st">&#39;</span><span class="sc">%d</span><span class="st">/%m/%Y √†s %H:%M&#39;</span>))</span>
<span id="cb2-128"><a href="#cb2-128" aria-hidden="true" tabindex="-1"></a>                f.write(html_content)</span>
<span id="cb2-129"><a href="#cb2-129" aria-hidden="true" tabindex="-1"></a>                temp_html <span class="op">=</span> f.name</span>
<span id="cb2-130"><a href="#cb2-130" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb2-131"><a href="#cb2-131" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Converter para PDF com Pandoc</span></span>
<span id="cb2-132"><a href="#cb2-132" aria-hidden="true" tabindex="-1"></a>            cmd <span class="op">=</span> [</span>
<span id="cb2-133"><a href="#cb2-133" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;pandoc&#39;</span>,</span>
<span id="cb2-134"><a href="#cb2-134" aria-hidden="true" tabindex="-1"></a>                temp_html,</span>
<span id="cb2-135"><a href="#cb2-135" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;-o&#39;</span>, pdf_output,</span>
<span id="cb2-136"><a href="#cb2-136" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;--pdf-engine=wkhtmltopdf&#39;</span>,</span>
<span id="cb2-137"><a href="#cb2-137" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;--standalone&#39;</span>,</span>
<span id="cb2-138"><a href="#cb2-138" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;--mathjax&#39;</span>,</span>
<span id="cb2-139"><a href="#cb2-139" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;--toc&#39;</span>,</span>
<span id="cb2-140"><a href="#cb2-140" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;--toc-depth=2&#39;</span>,</span>
<span id="cb2-141"><a href="#cb2-141" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;-V&#39;</span>, <span class="st">&#39;margin-top=20mm&#39;</span>,</span>
<span id="cb2-142"><a href="#cb2-142" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;-V&#39;</span>, <span class="st">&#39;margin-right=20mm&#39;</span>,</span>
<span id="cb2-143"><a href="#cb2-143" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;-V&#39;</span>, <span class="st">&#39;margin-bottom=20mm&#39;</span>,</span>
<span id="cb2-144"><a href="#cb2-144" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;-V&#39;</span>, <span class="st">&#39;margin-left=20mm&#39;</span></span>
<span id="cb2-145"><a href="#cb2-145" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb2-146"><a href="#cb2-146" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb2-147"><a href="#cb2-147" aria-hidden="true" tabindex="-1"></a>            result <span class="op">=</span> subprocess.run(cmd, capture_output<span class="op">=</span><span class="va">True</span>, text<span class="op">=</span><span class="va">True</span>, timeout<span class="op">=</span><span class="dv">120</span>)</span>
<span id="cb2-148"><a href="#cb2-148" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb2-149"><a href="#cb2-149" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Limpar arquivo tempor√°rio</span></span>
<span id="cb2-150"><a href="#cb2-150" aria-hidden="true" tabindex="-1"></a>            os.unlink(temp_html)</span>
<span id="cb2-151"><a href="#cb2-151" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb2-152"><a href="#cb2-152" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> result.returncode <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb2-153"><a href="#cb2-153" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="va">True</span>, <span class="st">&quot;Sucesso&quot;</span></span>
<span id="cb2-154"><a href="#cb2-154" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb2-155"><a href="#cb2-155" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="va">False</span>, result.stderr</span>
<span id="cb2-156"><a href="#cb2-156" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb2-157"><a href="#cb2-157" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> subprocess.TimeoutExpired:</span>
<span id="cb2-158"><a href="#cb2-158" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span>, <span class="st">&quot;Timeout na convers√£o&quot;</span></span>
<span id="cb2-159"><a href="#cb2-159" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb2-160"><a href="#cb2-160" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span>, <span class="bu">str</span>(e)</span>
<span id="cb2-161"><a href="#cb2-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-162"><a href="#cb2-162" aria-hidden="true" tabindex="-1"></a>    <span class="cf">async</span> <span class="kw">def</span> convert_with_playwright(<span class="va">self</span>, md_file, pdf_output):</span>
<span id="cb2-163"><a href="#cb2-163" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Converte Markdown para PDF usando Playwright (fallback)&quot;&quot;&quot;</span></span>
<span id="cb2-164"><a href="#cb2-164" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb2-165"><a href="#cb2-165" aria-hidden="true" tabindex="-1"></a>            <span class="im">from</span> playwright.async_api <span class="im">import</span> async_playwright</span>
<span id="cb2-166"><a href="#cb2-166" aria-hidden="true" tabindex="-1"></a>            <span class="im">import</span> markdown</span>
<span id="cb2-167"><a href="#cb2-167" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb2-168"><a href="#cb2-168" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Ler e converter Markdown</span></span>
<span id="cb2-169"><a href="#cb2-169" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(md_file, <span class="st">&#39;r&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb2-170"><a href="#cb2-170" aria-hidden="true" tabindex="-1"></a>                md_content <span class="op">=</span> f.read()</span>
<span id="cb2-171"><a href="#cb2-171" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb2-172"><a href="#cb2-172" aria-hidden="true" tabindex="-1"></a>            html_content <span class="op">=</span> markdown.markdown(md_content, extensions<span class="op">=</span>[<span class="st">&#39;extra&#39;</span>, <span class="st">&#39;tables&#39;</span>, <span class="st">&#39;fenced_code&#39;</span>, <span class="st">&#39;codehilite&#39;</span>])</span>
<span id="cb2-173"><a href="#cb2-173" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb2-174"><a href="#cb2-174" aria-hidden="true" tabindex="-1"></a>            full_html <span class="op">=</span> <span class="ss">f&quot;&quot;&quot;</span></span>
<span id="cb2-175"><a href="#cb2-175" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;!DOCTYPE html&gt;</span></span>
<span id="cb2-176"><a href="#cb2-176" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;html&gt;</span></span>
<span id="cb2-177"><a href="#cb2-177" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;head&gt;</span></span>
<span id="cb2-178"><a href="#cb2-178" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span></span>
<span id="cb2-179"><a href="#cb2-179" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;title&gt;</span><span class="sc">{</span>md_file<span class="sc">.</span>stem<span class="sc">}</span><span class="ss">&lt;/title&gt;</span></span>
<span id="cb2-180"><a href="#cb2-180" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;style&gt;</span></span>
<span id="cb2-181"><a href="#cb2-181" aria-hidden="true" tabindex="-1"></a><span class="ss">        body </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb2-182"><a href="#cb2-182" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-family: -apple-system, BlinkMacSystemFont, &#39;Segoe UI&#39;, Roboto, sans-serif;</span></span>
<span id="cb2-183"><a href="#cb2-183" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin: 40px;</span></span>
<span id="cb2-184"><a href="#cb2-184" aria-hidden="true" tabindex="-1"></a><span class="ss">            line-height: 1.6;</span></span>
<span id="cb2-185"><a href="#cb2-185" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #2c3e50;</span></span>
<span id="cb2-186"><a href="#cb2-186" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb2-187"><a href="#cb2-187" aria-hidden="true" tabindex="-1"></a><span class="ss">        .header </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb2-188"><a href="#cb2-188" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);</span></span>
<span id="cb2-189"><a href="#cb2-189" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: white; </span></span>
<span id="cb2-190"><a href="#cb2-190" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 40px; </span></span>
<span id="cb2-191"><a href="#cb2-191" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 15px;</span></span>
<span id="cb2-192"><a href="#cb2-192" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-bottom: 40px;</span></span>
<span id="cb2-193"><a href="#cb2-193" aria-hidden="true" tabindex="-1"></a><span class="ss">            text-align: center;</span></span>
<span id="cb2-194"><a href="#cb2-194" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb2-195"><a href="#cb2-195" aria-hidden="true" tabindex="-1"></a><span class="ss">        h1 </span><span class="ch">{{</span><span class="ss"> color: #2c3e50; border-bottom: 3px solid #3498db; padding-bottom: 10px; </span><span class="ch">}}</span></span>
<span id="cb2-196"><a href="#cb2-196" aria-hidden="true" tabindex="-1"></a><span class="ss">        pre </span><span class="ch">{{</span><span class="ss"> background: #2c3e50; color: #ecf0f1; padding: 20px; border-radius: 8px; </span><span class="ch">}}</span></span>
<span id="cb2-197"><a href="#cb2-197" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;/style&gt;</span></span>
<span id="cb2-198"><a href="#cb2-198" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;/head&gt;</span></span>
<span id="cb2-199"><a href="#cb2-199" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;body&gt;</span></span>
<span id="cb2-200"><a href="#cb2-200" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;div class=&quot;header&quot;&gt;</span></span>
<span id="cb2-201"><a href="#cb2-201" aria-hidden="true" tabindex="-1"></a><span class="ss">        &lt;h1&gt;</span><span class="sc">{</span>md_file<span class="sc">.</span>stem<span class="sc">}</span><span class="ss">&lt;/h1&gt;</span></span>
<span id="cb2-202"><a href="#cb2-202" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;/div&gt;</span></span>
<span id="cb2-203"><a href="#cb2-203" aria-hidden="true" tabindex="-1"></a><span class="ss">    </span><span class="sc">{</span>html_content<span class="sc">}</span></span>
<span id="cb2-204"><a href="#cb2-204" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;/body&gt;</span></span>
<span id="cb2-205"><a href="#cb2-205" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;/html&gt;</span></span>
<span id="cb2-206"><a href="#cb2-206" aria-hidden="true" tabindex="-1"></a><span class="ss">&quot;&quot;&quot;</span></span>
<span id="cb2-207"><a href="#cb2-207" aria-hidden="true" tabindex="-1"></a>            <span class="cf">async</span> <span class="cf">with</span> async_playwright() <span class="im">as</span> p:</span>
<span id="cb2-208"><a href="#cb2-208" aria-hidden="true" tabindex="-1"></a>                browser <span class="op">=</span> <span class="cf">await</span> p.chromium.launch(headless<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb2-209"><a href="#cb2-209" aria-hidden="true" tabindex="-1"></a>                page <span class="op">=</span> <span class="cf">await</span> browser.new_page()</span>
<span id="cb2-210"><a href="#cb2-210" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb2-211"><a href="#cb2-211" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Salvar HTML tempor√°rio</span></span>
<span id="cb2-212"><a href="#cb2-212" aria-hidden="true" tabindex="-1"></a>                <span class="cf">with</span> tempfile.NamedTemporaryFile(mode<span class="op">=</span><span class="st">&#39;w&#39;</span>, suffix<span class="op">=</span><span class="st">&#39;.html&#39;</span>, delete<span class="op">=</span><span class="va">False</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb2-213"><a href="#cb2-213" aria-hidden="true" tabindex="-1"></a>                    f.write(full_html)</span>
<span id="cb2-214"><a href="#cb2-214" aria-hidden="true" tabindex="-1"></a>                    temp_html <span class="op">=</span> f.name</span>
<span id="cb2-215"><a href="#cb2-215" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb2-216"><a href="#cb2-216" aria-hidden="true" tabindex="-1"></a>                <span class="cf">await</span> page.goto(<span class="ss">f&quot;file://</span><span class="sc">{</span>temp_html<span class="sc">}</span><span class="ss">&quot;</span>, wait_until<span class="op">=</span><span class="st">&#39;networkidle&#39;</span>)</span>
<span id="cb2-217"><a href="#cb2-217" aria-hidden="true" tabindex="-1"></a>                <span class="cf">await</span> page.pdf(path<span class="op">=</span>pdf_output, <span class="bu">format</span><span class="op">=</span><span class="st">&#39;A4&#39;</span>, print_background<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb2-218"><a href="#cb2-218" aria-hidden="true" tabindex="-1"></a>                              margin<span class="op">=</span>{<span class="st">&#39;top&#39;</span>: <span class="st">&#39;0.5in&#39;</span>, <span class="st">&#39;right&#39;</span>: <span class="st">&#39;0.5in&#39;</span>, <span class="st">&#39;bottom&#39;</span>: <span class="st">&#39;0.5in&#39;</span>, <span class="st">&#39;left&#39;</span>: <span class="st">&#39;0.5in&#39;</span>})</span>
<span id="cb2-219"><a href="#cb2-219" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb2-220"><a href="#cb2-220" aria-hidden="true" tabindex="-1"></a>                <span class="cf">await</span> browser.close()</span>
<span id="cb2-221"><a href="#cb2-221" aria-hidden="true" tabindex="-1"></a>                os.unlink(temp_html)</span>
<span id="cb2-222"><a href="#cb2-222" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb2-223"><a href="#cb2-223" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">True</span>, <span class="st">&quot;Sucesso&quot;</span></span>
<span id="cb2-224"><a href="#cb2-224" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb2-225"><a href="#cb2-225" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb2-226"><a href="#cb2-226" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span>, <span class="bu">str</span>(e)</span>
<span id="cb2-227"><a href="#cb2-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-228"><a href="#cb2-228" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> show_progress(<span class="va">self</span>, current, total, filename, status):</span>
<span id="cb2-229"><a href="#cb2-229" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Mostra progresso detalhado&quot;&quot;&quot;</span></span>
<span id="cb2-230"><a href="#cb2-230" aria-hidden="true" tabindex="-1"></a>        percent <span class="op">=</span> (current <span class="op">/</span> total) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb2-231"><a href="#cb2-231" aria-hidden="true" tabindex="-1"></a>        bar_length <span class="op">=</span> <span class="dv">30</span></span>
<span id="cb2-232"><a href="#cb2-232" aria-hidden="true" tabindex="-1"></a>        filled_length <span class="op">=</span> <span class="bu">int</span>(bar_length <span class="op">*</span> current <span class="op">//</span> total)</span>
<span id="cb2-233"><a href="#cb2-233" aria-hidden="true" tabindex="-1"></a>        bar <span class="op">=</span> <span class="st">&#39;‚ñà&#39;</span> <span class="op">*</span> filled_length <span class="op">+</span> <span class="st">&#39;‚ñë&#39;</span> <span class="op">*</span> (bar_length <span class="op">-</span> filled_length)</span>
<span id="cb2-234"><a href="#cb2-234" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-235"><a href="#cb2-235" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&#39;</span><span class="ch">\r</span><span class="ss">üìä [</span><span class="sc">{</span>bar<span class="sc">}</span><span class="ss">] </span><span class="sc">{</span>percent<span class="sc">:.1f}</span><span class="ss">% (</span><span class="sc">{</span>current<span class="sc">}</span><span class="ss">/</span><span class="sc">{</span>total<span class="sc">}</span><span class="ss">) </span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss"> - </span><span class="sc">{</span>status<span class="sc">}</span><span class="ss">&#39;</span>, end<span class="op">=</span><span class="st">&#39;&#39;</span>, flush<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb2-236"><a href="#cb2-236" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-237"><a href="#cb2-237" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> current <span class="op">==</span> total:</span>
<span id="cb2-238"><a href="#cb2-238" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>()</span>
<span id="cb2-239"><a href="#cb2-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-240"><a href="#cb2-240" aria-hidden="true" tabindex="-1"></a>    <span class="cf">async</span> <span class="kw">def</span> convert_all_files(<span class="va">self</span>):</span>
<span id="cb2-241"><a href="#cb2-241" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Converte todos os arquivos Markdown para PDF&quot;&quot;&quot;</span></span>
<span id="cb2-242"><a href="#cb2-242" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;üöÄ Iniciando convers√£o Markdown ‚Üí PDF&quot;</span>)</span>
<span id="cb2-243"><a href="#cb2-243" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;=&quot;</span> <span class="op">*</span> <span class="dv">50</span>)</span>
<span id="cb2-244"><a href="#cb2-244" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-245"><a href="#cb2-245" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.check_dependencies():</span>
<span id="cb2-246"><a href="#cb2-246" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">‚ùå Instale as depend√™ncias faltantes antes de continuar&quot;</span>)</span>
<span id="cb2-247"><a href="#cb2-247" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb2-248"><a href="#cb2-248" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-249"><a href="#cb2-249" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Garantir pastas</span></span>
<span id="cb2-250"><a href="#cb2-250" aria-hidden="true" tabindex="-1"></a>        os.makedirs(<span class="va">self</span>.pdf_dir, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb2-251"><a href="#cb2-251" aria-hidden="true" tabindex="-1"></a>        os.makedirs(<span class="va">self</span>.html_dir, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb2-252"><a href="#cb2-252" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-253"><a href="#cb2-253" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Encontrar arquivos</span></span>
<span id="cb2-254"><a href="#cb2-254" aria-hidden="true" tabindex="-1"></a>        md_files <span class="op">=</span> <span class="bu">list</span>(Path(<span class="va">self</span>.md_dir).glob(<span class="st">&quot;*.md&quot;</span>))</span>
<span id="cb2-255"><a href="#cb2-255" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-256"><a href="#cb2-256" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> md_files:</span>
<span id="cb2-257"><a href="#cb2-257" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;‚ùå Nenhum arquivo .md encontrado&quot;</span>)</span>
<span id="cb2-258"><a href="#cb2-258" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;üí° Execute primeiro: python grok_processor.py&quot;</span>)</span>
<span id="cb2-259"><a href="#cb2-259" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb2-260"><a href="#cb2-260" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-261"><a href="#cb2-261" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;üìÑ Encontrados </span><span class="sc">{</span><span class="bu">len</span>(md_files)<span class="sc">}</span><span class="ss"> arquivos Markdown&quot;</span>)</span>
<span id="cb2-262"><a href="#cb2-262" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;üîÑ Iniciando convers√£o...&quot;</span>)</span>
<span id="cb2-263"><a href="#cb2-263" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-264"><a href="#cb2-264" aria-hidden="true" tabindex="-1"></a>        successful <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb2-265"><a href="#cb2-265" aria-hidden="true" tabindex="-1"></a>        failed <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb2-266"><a href="#cb2-266" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-267"><a href="#cb2-267" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, md_file <span class="kw">in</span> <span class="bu">enumerate</span>(md_files, <span class="dv">1</span>):</span>
<span id="cb2-268"><a href="#cb2-268" aria-hidden="true" tabindex="-1"></a>            pdf_output <span class="op">=</span> Path(<span class="va">self</span>.pdf_dir) <span class="op">/</span> <span class="ss">f&quot;</span><span class="sc">{</span>md_file<span class="sc">.</span>stem<span class="sc">}</span><span class="ss">.pdf&quot;</span></span>
<span id="cb2-269"><a href="#cb2-269" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb2-270"><a href="#cb2-270" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.show_progress(i, <span class="bu">len</span>(md_files), md_file.name, <span class="st">&quot;Convertendo...&quot;</span>)</span>
<span id="cb2-271"><a href="#cb2-271" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb2-272"><a href="#cb2-272" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Tentar Pandoc primeiro</span></span>
<span id="cb2-273"><a href="#cb2-273" aria-hidden="true" tabindex="-1"></a>            success, message <span class="op">=</span> <span class="cf">await</span> <span class="va">self</span>.convert_with_pandoc(md_file, pdf_output)</span>
<span id="cb2-274"><a href="#cb2-274" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb2-275"><a href="#cb2-275" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Se Pandoc falhar, tentar Playwright</span></span>
<span id="cb2-276"><a href="#cb2-276" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> success:</span>
<span id="cb2-277"><a href="#cb2-277" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.show_progress(i, <span class="bu">len</span>(md_files), md_file.name, <span class="st">&quot;Fallback Playwright...&quot;</span>)</span>
<span id="cb2-278"><a href="#cb2-278" aria-hidden="true" tabindex="-1"></a>                success, message <span class="op">=</span> <span class="cf">await</span> <span class="va">self</span>.convert_with_playwright(md_file, pdf_output)</span>
<span id="cb2-279"><a href="#cb2-279" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb2-280"><a href="#cb2-280" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> success:</span>
<span id="cb2-281"><a href="#cb2-281" aria-hidden="true" tabindex="-1"></a>                successful <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb2-282"><a href="#cb2-282" aria-hidden="true" tabindex="-1"></a>                status <span class="op">=</span> <span class="st">&quot;‚úÖ&quot;</span></span>
<span id="cb2-283"><a href="#cb2-283" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb2-284"><a href="#cb2-284" aria-hidden="true" tabindex="-1"></a>                failed <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb2-285"><a href="#cb2-285" aria-hidden="true" tabindex="-1"></a>                status <span class="op">=</span> <span class="st">&quot;‚ùå&quot;</span></span>
<span id="cb2-286"><a href="#cb2-286" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb2-287"><a href="#cb2-287" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.show_progress(i, <span class="bu">len</span>(md_files), md_file.name, <span class="ss">f&quot;</span><span class="sc">{</span>status<span class="sc">}</span><span class="ss"> </span><span class="sc">{</span>message<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb2-288"><a href="#cb2-288" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-289"><a href="#cb2-289" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Relat√≥rio final</span></span>
<span id="cb2-290"><a href="#cb2-290" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span> <span class="op">+</span> <span class="st">&quot;=&quot;</span> <span class="op">*</span> <span class="dv">50</span>)</span>
<span id="cb2-291"><a href="#cb2-291" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;üéâ CONVERS√ÉO CONCLU√çDA!&quot;</span>)</span>
<span id="cb2-292"><a href="#cb2-292" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;=&quot;</span> <span class="op">*</span> <span class="dv">50</span>)</span>
<span id="cb2-293"><a href="#cb2-293" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ Sucessos: </span><span class="sc">{</span>successful<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb2-294"><a href="#cb2-294" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;‚ùå Falhas: </span><span class="sc">{</span>failed<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb2-295"><a href="#cb2-295" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;üìÅ PDFs em: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>pdf_dir<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb2-296"><a href="#cb2-296" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-297"><a href="#cb2-297" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> failed <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb2-298"><a href="#cb2-298" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">‚ö†Ô∏è  Algumas convers√µes falharam. Verifique as depend√™ncias:&quot;</span>)</span>
<span id="cb2-299"><a href="#cb2-299" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;   - Pandoc com wkhtmltopdf&quot;</span>)</span>
<span id="cb2-300"><a href="#cb2-300" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;   - Playwright com Chromium&quot;</span>)</span>
<span id="cb2-301"><a href="#cb2-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-302"><a href="#cb2-302" aria-hidden="true" tabindex="-1"></a><span class="cf">async</span> <span class="kw">def</span> main():</span>
<span id="cb2-303"><a href="#cb2-303" aria-hidden="true" tabindex="-1"></a>    converter <span class="op">=</span> PDFConverter()</span>
<span id="cb2-304"><a href="#cb2-304" aria-hidden="true" tabindex="-1"></a>    <span class="cf">await</span> converter.convert_all_files()</span>
<span id="cb2-305"><a href="#cb2-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-306"><a href="#cb2-306" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&quot;__main__&quot;</span>:</span>
<span id="cb2-307"><a href="#cb2-307" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Verificar se √© Windows para ajuste de evento loop</span></span>
<span id="cb2-308"><a href="#cb2-308" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> sys.platform <span class="op">==</span> <span class="st">&quot;win32&quot;</span>:</span>
<span id="cb2-309"><a href="#cb2-309" aria-hidden="true" tabindex="-1"></a>        asyncio.set_event_loop_policy(asyncio.WindowsProactorEventLoopPolicy())</span>
<span id="cb2-310"><a href="#cb2-310" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-311"><a href="#cb2-311" aria-hidden="true" tabindex="-1"></a>    asyncio.run(main())</span></code></pre></div>
<h2 data-number="2.3" id="script-de-gerenciamento-principal"><span class="header-section-number">2.3</span> 3. Script de Gerenciamento
Principal</h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># grok_export_manager.py</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> subprocess</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sys</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> run_processor():</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Executa o processador principal&quot;&quot;&quot;</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;üîÑ Executando Grok Processor...&quot;</span>)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> subprocess.run([sys.executable, <span class="st">&quot;grok_processor.py&quot;</span>], </span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>                          capture_output<span class="op">=</span><span class="va">True</span>, text<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> result.returncode <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;‚úÖ Processamento conclu√≠do com sucesso!&quot;</span>)</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;‚ùå Erro no processamento:&quot;</span>)</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(result.stderr)</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> run_pdf_converter():</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Executa o conversor PDF&quot;&quot;&quot;</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;üîÑ Executando PDF Converter...&quot;</span>)</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> subprocess.run([sys.executable, <span class="st">&quot;grok_pdf_converter.py&quot;</span>], </span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>                          capture_output<span class="op">=</span><span class="va">True</span>, text<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> result.returncode <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;‚úÖ Convers√£o PDF conclu√≠da com sucesso!&quot;</span>)</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;‚ùå Erro na convers√£o PDF:&quot;</span>)</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(result.stderr)</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> main():</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;üöÄ GERENCIADOR DE EXPORTA√á√ÉO GROK&quot;</span>)</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;=&quot;</span> <span class="op">*</span> <span class="dv">50</span>)</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;1. Processar dados e gerar Markdown + Dashboard&quot;</span>)</span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;2. Converter Markdown para PDF&quot;</span>)</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;3. Processamento completo (1 + 2)&quot;</span>)</span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;4. Verificar depend√™ncias&quot;</span>)</span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;=&quot;</span> <span class="op">*</span> <span class="dv">50</span>)</span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>    choice <span class="op">=</span> <span class="bu">input</span>(<span class="st">&quot;Escolha uma op√ß√£o (1-4): &quot;</span>).strip()</span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>    start_time <span class="op">=</span> datetime.now()</span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> choice <span class="op">==</span> <span class="st">&quot;1&quot;</span>:</span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>        run_processor()</span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> choice <span class="op">==</span> <span class="st">&quot;2&quot;</span>:</span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>        run_pdf_converter()</span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> choice <span class="op">==</span> <span class="st">&quot;3&quot;</span>:</span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> run_processor():</span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a>            run_pdf_converter()</span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> choice <span class="op">==</span> <span class="st">&quot;4&quot;</span>:</span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Verificar depend√™ncias</span></span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a>        <span class="im">from</span> grok_pdf_converter <span class="im">import</span> PDFConverter</span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a>        converter <span class="op">=</span> PDFConverter()</span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a>        converter.check_dependencies()</span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;‚ùå Op√ß√£o inv√°lida&quot;</span>)</span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a>    elapsed <span class="op">=</span> datetime.now() <span class="op">-</span> start_time</span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="ch">\n</span><span class="ss">‚è±Ô∏è  Tempo total: </span><span class="sc">{</span>elapsed<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&quot;__main__&quot;</span>:</span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a>    main()</span></code></pre></div>
<h2 data-number="2.4" id="fluxo-otimizado-de-uso"><span class="header-section-number">2.4</span> Fluxo Otimizado de Uso:</h2>
<div class="sourceCode" id="cb4"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Processamento completo (recomendado)</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> grok_export_manager.py</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Ou executar manualmente:</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> grok_processor.py</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> grok_pdf_converter.py</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Apenas verificar depend√™ncias</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> grok_export_manager.py</span></code></pre></div>
<h2 data-number="2.5" id="principais-melhorias"><span class="header-section-number">2.5</span> Principais Melhorias:</h2>
<ol type="1">
<li><strong>Separa√ß√£o Clara</strong>: Processor vs PDF Converter</li>
<li><strong>Depend√™ncias Verificadas</strong>: Pandoc + Playwright</li>
<li><strong>Fallback Inteligente</strong>: Pandoc ‚Üí Playwright</li>
<li><strong>Progresso Detalhado</strong>: Barra de progresso em tempo
real</li>
<li><strong>MathJax Support</strong>: F√≥rmulas matem√°ticas com
<code>--mathjax</code></li>
<li><strong>Categoriza√ß√£o Inteligente</strong>: Mais categorias
relevantes</li>
<li><strong>Tratamento de Erros</strong>: Melhor resili√™ncia</li>
<li><strong>Gerenciador Unificado</strong>: Interface √∫nica para todo o
processo</li>
</ol>
<p>O sistema agora √© muito mais robusto, com verifica√ß√£o de
depend√™ncias, fallback autom√°tico e feedback visual detalhado!</p>
<hr />
<h3 data-number="2.5.1" id="utilizador-2025-11-02-005750-deepseek-chat"><span class="header-section-number">2.5.1</span> üë§ Utilizador <em>(2025-11-02
00:57:50)</em> <em>[deepseek-chat]</em></h3>
<p>com grok_pdf_converter.py a convers√£o √© lenta. Assim pretendo que a
convers√£o html para pdf use o metodo que √© usado em
pdf_converter_optimized.py</p>
<hr />
<h3 data-number="2.5.2" id="deepseek-2025-11-02-005750-deepseek-chat"><span class="header-section-number">2.5.2</span> ü§ñ DeepSeek <em>(2025-11-02
00:57:50)</em> <em>[deepseek-chat]</em></h3>
<p>Perfeito! Vou otimizar o <code>grok_pdf_converter.py</code> para usar
o m√©todo mais r√°pido do <code>pdf_converter_optimized.py</code> com
Selenium. Aqui est√° a vers√£o otimizada:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># grok_pdf_converter_optimized.py</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> asyncio</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> subprocess</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tempfile</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sys</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> time</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> base64</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> glob</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> selenium <span class="im">import</span> webdriver</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> selenium.webdriver.chrome.options <span class="im">import</span> Options</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> selenium.webdriver.support.ui <span class="im">import</span> WebDriverWait</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> PDFConverterOptimized:</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.md_dir <span class="op">=</span> <span class="st">&quot;grok_complete_dashboard/markdown&quot;</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.pdf_dir <span class="op">=</span> <span class="st">&quot;grok_complete_dashboard/pdf/conversas&quot;</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.batch_size <span class="op">=</span> <span class="dv">3</span>  <span class="co"># Tamanho do lote para processamento</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> check_dependencies(<span class="va">self</span>):</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Verifica se todas as depend√™ncias est√£o instaladas&quot;&quot;&quot;</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;üîç Verificando depend√™ncias...&quot;</span>)</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>        dependencies <span class="op">=</span> {</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;pandoc&#39;</span>: <span class="va">self</span>.check_pandoc(),</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;selenium&#39;</span>: <span class="va">self</span>.check_selenium(),</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;chrome_driver&#39;</span>: <span class="va">self</span>.check_chrome_driver()</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>        all_ok <span class="op">=</span> <span class="bu">all</span>(dependencies.values())</span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> all_ok:</span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">‚ö†Ô∏è  Depend√™ncias faltando:&quot;</span>)</span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> dep, installed <span class="kw">in</span> dependencies.items():</span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="kw">not</span> installed:</span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="ss">f&quot;   ‚ùå </span><span class="sc">{</span>dep<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">üì¶ Instale as depend√™ncias faltantes:&quot;</span>)</span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> dependencies[<span class="st">&#39;pandoc&#39;</span>]:</span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;   Ubuntu/Debian: sudo apt-get install pandoc&quot;</span>)</span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;   macOS: brew install pandoc&quot;</span>)</span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;   Windows: choco install pandoc&quot;</span>)</span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> dependencies[<span class="st">&#39;selenium&#39;</span>]:</span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;   pip install selenium&quot;</span>)</span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> dependencies[<span class="st">&#39;chrome_driver&#39;</span>]:</span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;   Baixe ChromeDriver: https://chromedriver.chromium.org/&quot;</span>)</span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;   Ou use: playwright install chromium&quot;</span>)</span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> all_ok</span>
<span id="cb5-54"><a href="#cb5-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-55"><a href="#cb5-55" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> check_pandoc(<span class="va">self</span>):</span>
<span id="cb5-56"><a href="#cb5-56" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Verifica se pandoc est√° instalado&quot;&quot;&quot;</span></span>
<span id="cb5-57"><a href="#cb5-57" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb5-58"><a href="#cb5-58" aria-hidden="true" tabindex="-1"></a>            result <span class="op">=</span> subprocess.run([<span class="st">&#39;pandoc&#39;</span>, <span class="st">&#39;--version&#39;</span>], </span>
<span id="cb5-59"><a href="#cb5-59" aria-hidden="true" tabindex="-1"></a>                                  capture_output<span class="op">=</span><span class="va">True</span>, text<span class="op">=</span><span class="va">True</span>, timeout<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb5-60"><a href="#cb5-60" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> result.returncode <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb5-61"><a href="#cb5-61" aria-hidden="true" tabindex="-1"></a>                version_line <span class="op">=</span> result.stdout.split(<span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>)[<span class="dv">0</span>]</span>
<span id="cb5-62"><a href="#cb5-62" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ Pandoc: </span><span class="sc">{</span>version_line<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb5-63"><a href="#cb5-63" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb5-64"><a href="#cb5-64" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span>:</span>
<span id="cb5-65"><a href="#cb5-65" aria-hidden="true" tabindex="-1"></a>            <span class="cf">pass</span></span>
<span id="cb5-66"><a href="#cb5-66" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;‚ùå Pandoc n√£o encontrado&quot;</span>)</span>
<span id="cb5-67"><a href="#cb5-67" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb5-68"><a href="#cb5-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-69"><a href="#cb5-69" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> check_selenium(<span class="va">self</span>):</span>
<span id="cb5-70"><a href="#cb5-70" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Verifica se selenium est√° dispon√≠vel&quot;&quot;&quot;</span></span>
<span id="cb5-71"><a href="#cb5-71" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb5-72"><a href="#cb5-72" aria-hidden="true" tabindex="-1"></a>            <span class="im">import</span> selenium</span>
<span id="cb5-73"><a href="#cb5-73" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;‚úÖ Selenium: Dispon√≠vel&quot;</span>)</span>
<span id="cb5-74"><a href="#cb5-74" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb5-75"><a href="#cb5-75" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">ImportError</span>:</span>
<span id="cb5-76"><a href="#cb5-76" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;‚ùå Selenium n√£o instalado&quot;</span>)</span>
<span id="cb5-77"><a href="#cb5-77" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb5-78"><a href="#cb5-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-79"><a href="#cb5-79" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> check_chrome_driver(<span class="va">self</span>):</span>
<span id="cb5-80"><a href="#cb5-80" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Verifica se ChromeDriver est√° dispon√≠vel&quot;&quot;&quot;</span></span>
<span id="cb5-81"><a href="#cb5-81" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb5-82"><a href="#cb5-82" aria-hidden="true" tabindex="-1"></a>            chrome_options <span class="op">=</span> Options()</span>
<span id="cb5-83"><a href="#cb5-83" aria-hidden="true" tabindex="-1"></a>            chrome_options.add_argument(<span class="st">&#39;--headless&#39;</span>)</span>
<span id="cb5-84"><a href="#cb5-84" aria-hidden="true" tabindex="-1"></a>            driver <span class="op">=</span> webdriver.Chrome(options<span class="op">=</span>chrome_options)</span>
<span id="cb5-85"><a href="#cb5-85" aria-hidden="true" tabindex="-1"></a>            driver.quit()</span>
<span id="cb5-86"><a href="#cb5-86" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;‚úÖ ChromeDriver: Dispon√≠vel&quot;</span>)</span>
<span id="cb5-87"><a href="#cb5-87" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb5-88"><a href="#cb5-88" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb5-89"><a href="#cb5-89" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚ùå ChromeDriver: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb5-90"><a href="#cb5-90" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb5-91"><a href="#cb5-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-92"><a href="#cb5-92" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> setup_chrome_driver(<span class="va">self</span>):</span>
<span id="cb5-93"><a href="#cb5-93" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Configura e retorna o driver do Chrome otimizado&quot;&quot;&quot;</span></span>
<span id="cb5-94"><a href="#cb5-94" aria-hidden="true" tabindex="-1"></a>        chrome_options <span class="op">=</span> Options()</span>
<span id="cb5-95"><a href="#cb5-95" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb5-96"><a href="#cb5-96" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Otimiza√ß√µes para performance</span></span>
<span id="cb5-97"><a href="#cb5-97" aria-hidden="true" tabindex="-1"></a>        chrome_options.add_argument(<span class="st">&#39;--headless&#39;</span>)</span>
<span id="cb5-98"><a href="#cb5-98" aria-hidden="true" tabindex="-1"></a>        chrome_options.add_argument(<span class="st">&#39;--disable-gpu&#39;</span>)</span>
<span id="cb5-99"><a href="#cb5-99" aria-hidden="true" tabindex="-1"></a>        chrome_options.add_argument(<span class="st">&#39;--no-sandbox&#39;</span>)</span>
<span id="cb5-100"><a href="#cb5-100" aria-hidden="true" tabindex="-1"></a>        chrome_options.add_argument(<span class="st">&#39;--disable-dev-shm-usage&#39;</span>)</span>
<span id="cb5-101"><a href="#cb5-101" aria-hidden="true" tabindex="-1"></a>        chrome_options.add_argument(<span class="st">&#39;--window-size=1920,1080&#39;</span>)</span>
<span id="cb5-102"><a href="#cb5-102" aria-hidden="true" tabindex="-1"></a>        chrome_options.add_argument(<span class="st">&#39;--disable-extensions&#39;</span>)</span>
<span id="cb5-103"><a href="#cb5-103" aria-hidden="true" tabindex="-1"></a>        chrome_options.add_argument(<span class="st">&#39;--disable-plugins&#39;</span>)</span>
<span id="cb5-104"><a href="#cb5-104" aria-hidden="true" tabindex="-1"></a>        chrome_options.add_argument(<span class="st">&#39;--disable-images&#39;</span>)  <span class="co"># Desabilita imagens para velocidade</span></span>
<span id="cb5-105"><a href="#cb5-105" aria-hidden="true" tabindex="-1"></a>        chrome_options.add_argument(<span class="st">&#39;--blink-settings=imagesEnabled=false&#39;</span>)</span>
<span id="cb5-106"><a href="#cb5-106" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb5-107"><a href="#cb5-107" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Otimiza√ß√µes de mem√≥ria</span></span>
<span id="cb5-108"><a href="#cb5-108" aria-hidden="true" tabindex="-1"></a>        chrome_options.add_argument(<span class="st">&#39;--memory-pressure-off&#39;</span>)</span>
<span id="cb5-109"><a href="#cb5-109" aria-hidden="true" tabindex="-1"></a>        chrome_options.add_argument(<span class="st">&#39;--max_old_space_size=4096&#39;</span>)</span>
<span id="cb5-110"><a href="#cb5-110" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb5-111"><a href="#cb5-111" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb5-112"><a href="#cb5-112" aria-hidden="true" tabindex="-1"></a>            driver <span class="op">=</span> webdriver.Chrome(options<span class="op">=</span>chrome_options)</span>
<span id="cb5-113"><a href="#cb5-113" aria-hidden="true" tabindex="-1"></a>            driver.set_page_load_timeout(<span class="dv">30</span>)  <span class="co"># Timeout reduzido</span></span>
<span id="cb5-114"><a href="#cb5-114" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> driver</span>
<span id="cb5-115"><a href="#cb5-115" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb5-116"><a href="#cb5-116" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚ùå Erro ao iniciar ChromeDriver: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb5-117"><a href="#cb5-117" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb5-118"><a href="#cb5-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-119"><a href="#cb5-119" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> convert_with_pandoc_optimized(<span class="va">self</span>, md_file):</span>
<span id="cb5-120"><a href="#cb5-120" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Converte Markdown para HTML usando Pandoc otimizado&quot;&quot;&quot;</span></span>
<span id="cb5-121"><a href="#cb5-121" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb5-122"><a href="#cb5-122" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Template HTML otimizado para performance</span></span>
<span id="cb5-123"><a href="#cb5-123" aria-hidden="true" tabindex="-1"></a>            html_template <span class="op">=</span> <span class="st">&quot;&quot;&quot;&lt;!DOCTYPE html&gt;</span></span>
<span id="cb5-124"><a href="#cb5-124" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;html&gt;</span></span>
<span id="cb5-125"><a href="#cb5-125" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;head&gt;</span></span>
<span id="cb5-126"><a href="#cb5-126" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span></span>
<span id="cb5-127"><a href="#cb5-127" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;title&gt;</span><span class="sc">{{</span><span class="st">TITLE</span><span class="sc">}}</span><span class="st">&lt;/title&gt;</span></span>
<span id="cb5-128"><a href="#cb5-128" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;script src=&quot;https://polyfill.io/v3/polyfill.min.js?features=es6&quot;&gt;&lt;/script&gt;</span></span>
<span id="cb5-129"><a href="#cb5-129" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;script id=&quot;MathJax-script&quot; async src=&quot;https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js&quot;&gt;&lt;/script&gt;</span></span>
<span id="cb5-130"><a href="#cb5-130" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;style&gt;</span></span>
<span id="cb5-131"><a href="#cb5-131" aria-hidden="true" tabindex="-1"></a><span class="st">        body { </span></span>
<span id="cb5-132"><a href="#cb5-132" aria-hidden="true" tabindex="-1"></a><span class="st">            font-family: -apple-system, BlinkMacSystemFont, &#39;Segoe UI&#39;, Roboto, sans-serif;</span></span>
<span id="cb5-133"><a href="#cb5-133" aria-hidden="true" tabindex="-1"></a><span class="st">            margin: 20px;</span></span>
<span id="cb5-134"><a href="#cb5-134" aria-hidden="true" tabindex="-1"></a><span class="st">            line-height: 1.5;</span></span>
<span id="cb5-135"><a href="#cb5-135" aria-hidden="true" tabindex="-1"></a><span class="st">            color: #2c3e50;</span></span>
<span id="cb5-136"><a href="#cb5-136" aria-hidden="true" tabindex="-1"></a><span class="st">            background: white;</span></span>
<span id="cb5-137"><a href="#cb5-137" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb5-138"><a href="#cb5-138" aria-hidden="true" tabindex="-1"></a><span class="st">        .header { </span></span>
<span id="cb5-139"><a href="#cb5-139" aria-hidden="true" tabindex="-1"></a><span class="st">            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);</span></span>
<span id="cb5-140"><a href="#cb5-140" aria-hidden="true" tabindex="-1"></a><span class="st">            color: white; </span></span>
<span id="cb5-141"><a href="#cb5-141" aria-hidden="true" tabindex="-1"></a><span class="st">            padding: 30px; </span></span>
<span id="cb5-142"><a href="#cb5-142" aria-hidden="true" tabindex="-1"></a><span class="st">            border-radius: 10px;</span></span>
<span id="cb5-143"><a href="#cb5-143" aria-hidden="true" tabindex="-1"></a><span class="st">            margin-bottom: 30px;</span></span>
<span id="cb5-144"><a href="#cb5-144" aria-hidden="true" tabindex="-1"></a><span class="st">            text-align: center;</span></span>
<span id="cb5-145"><a href="#cb5-145" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb5-146"><a href="#cb5-146" aria-hidden="true" tabindex="-1"></a><span class="st">        h1 { </span></span>
<span id="cb5-147"><a href="#cb5-147" aria-hidden="true" tabindex="-1"></a><span class="st">            color: #2c3e50; </span></span>
<span id="cb5-148"><a href="#cb5-148" aria-hidden="true" tabindex="-1"></a><span class="st">            border-bottom: 2px solid #3498db; </span></span>
<span id="cb5-149"><a href="#cb5-149" aria-hidden="true" tabindex="-1"></a><span class="st">            padding-bottom: 8px;</span></span>
<span id="cb5-150"><a href="#cb5-150" aria-hidden="true" tabindex="-1"></a><span class="st">            margin-top: 30px;</span></span>
<span id="cb5-151"><a href="#cb5-151" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb5-152"><a href="#cb5-152" aria-hidden="true" tabindex="-1"></a><span class="st">        h2 { </span></span>
<span id="cb5-153"><a href="#cb5-153" aria-hidden="true" tabindex="-1"></a><span class="st">            color: #34495e; </span></span>
<span id="cb5-154"><a href="#cb5-154" aria-hidden="true" tabindex="-1"></a><span class="st">            border-bottom: 1px solid #ecf0f1; </span></span>
<span id="cb5-155"><a href="#cb5-155" aria-hidden="true" tabindex="-1"></a><span class="st">            padding-bottom: 6px;</span></span>
<span id="cb5-156"><a href="#cb5-156" aria-hidden="true" tabindex="-1"></a><span class="st">            margin-top: 25px;</span></span>
<span id="cb5-157"><a href="#cb5-157" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb5-158"><a href="#cb5-158" aria-hidden="true" tabindex="-1"></a><span class="st">        .message { </span></span>
<span id="cb5-159"><a href="#cb5-159" aria-hidden="true" tabindex="-1"></a><span class="st">            margin: 15px 0; </span></span>
<span id="cb5-160"><a href="#cb5-160" aria-hidden="true" tabindex="-1"></a><span class="st">            padding: 15px; </span></span>
<span id="cb5-161"><a href="#cb5-161" aria-hidden="true" tabindex="-1"></a><span class="st">            border-radius: 8px;</span></span>
<span id="cb5-162"><a href="#cb5-162" aria-hidden="true" tabindex="-1"></a><span class="st">            border-left: 4px solid #ccc;</span></span>
<span id="cb5-163"><a href="#cb5-163" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb5-164"><a href="#cb5-164" aria-hidden="true" tabindex="-1"></a><span class="st">        .user { </span></span>
<span id="cb5-165"><a href="#cb5-165" aria-hidden="true" tabindex="-1"></a><span class="st">            background: #e3f2fd; </span></span>
<span id="cb5-166"><a href="#cb5-166" aria-hidden="true" tabindex="-1"></a><span class="st">            border-left-color: #1976d2; </span></span>
<span id="cb5-167"><a href="#cb5-167" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb5-168"><a href="#cb5-168" aria-hidden="true" tabindex="-1"></a><span class="st">        .assistant { </span></span>
<span id="cb5-169"><a href="#cb5-169" aria-hidden="true" tabindex="-1"></a><span class="st">            background: #f3e5f5; </span></span>
<span id="cb5-170"><a href="#cb5-170" aria-hidden="true" tabindex="-1"></a><span class="st">            border-left-color: #7b1fa2; </span></span>
<span id="cb5-171"><a href="#cb5-171" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb5-172"><a href="#cb5-172" aria-hidden="true" tabindex="-1"></a><span class="st">        code { </span></span>
<span id="cb5-173"><a href="#cb5-173" aria-hidden="true" tabindex="-1"></a><span class="st">            background: #f8f9fa; </span></span>
<span id="cb5-174"><a href="#cb5-174" aria-hidden="true" tabindex="-1"></a><span class="st">            padding: 2px 4px; </span></span>
<span id="cb5-175"><a href="#cb5-175" aria-hidden="true" tabindex="-1"></a><span class="st">            border-radius: 3px; </span></span>
<span id="cb5-176"><a href="#cb5-176" aria-hidden="true" tabindex="-1"></a><span class="st">            font-family: &#39;Monaco&#39;, &#39;Menlo&#39;, monospace;</span></span>
<span id="cb5-177"><a href="#cb5-177" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb5-178"><a href="#cb5-178" aria-hidden="true" tabindex="-1"></a><span class="st">        pre { </span></span>
<span id="cb5-179"><a href="#cb5-179" aria-hidden="true" tabindex="-1"></a><span class="st">            background: #2c3e50; </span></span>
<span id="cb5-180"><a href="#cb5-180" aria-hidden="true" tabindex="-1"></a><span class="st">            color: #ecf0f1; </span></span>
<span id="cb5-181"><a href="#cb5-181" aria-hidden="true" tabindex="-1"></a><span class="st">            padding: 12px; </span></span>
<span id="cb5-182"><a href="#cb5-182" aria-hidden="true" tabindex="-1"></a><span class="st">            border-radius: 5px; </span></span>
<span id="cb5-183"><a href="#cb5-183" aria-hidden="true" tabindex="-1"></a><span class="st">            overflow-x: auto;</span></span>
<span id="cb5-184"><a href="#cb5-184" aria-hidden="true" tabindex="-1"></a><span class="st">            font-size: 0.9em;</span></span>
<span id="cb5-185"><a href="#cb5-185" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb5-186"><a href="#cb5-186" aria-hidden="true" tabindex="-1"></a><span class="st">        blockquote { </span></span>
<span id="cb5-187"><a href="#cb5-187" aria-hidden="true" tabindex="-1"></a><span class="st">            border-left: 3px solid #3498db; </span></span>
<span id="cb5-188"><a href="#cb5-188" aria-hidden="true" tabindex="-1"></a><span class="st">            padding-left: 15px; </span></span>
<span id="cb5-189"><a href="#cb5-189" aria-hidden="true" tabindex="-1"></a><span class="st">            margin-left: 0; </span></span>
<span id="cb5-190"><a href="#cb5-190" aria-hidden="true" tabindex="-1"></a><span class="st">            color: #7f8c8d;</span></span>
<span id="cb5-191"><a href="#cb5-191" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb5-192"><a href="#cb5-192" aria-hidden="true" tabindex="-1"></a><span class="st">        hr { </span></span>
<span id="cb5-193"><a href="#cb5-193" aria-hidden="true" tabindex="-1"></a><span class="st">            border: none; </span></span>
<span id="cb5-194"><a href="#cb5-194" aria-hidden="true" tabindex="-1"></a><span class="st">            height: 1px; </span></span>
<span id="cb5-195"><a href="#cb5-195" aria-hidden="true" tabindex="-1"></a><span class="st">            background: linear-gradient(90deg, transparent, #3498db, transparent);</span></span>
<span id="cb5-196"><a href="#cb5-196" aria-hidden="true" tabindex="-1"></a><span class="st">            margin: 20px 0;</span></span>
<span id="cb5-197"><a href="#cb5-197" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb5-198"><a href="#cb5-198" aria-hidden="true" tabindex="-1"></a><span class="st">        .footer { </span></span>
<span id="cb5-199"><a href="#cb5-199" aria-hidden="true" tabindex="-1"></a><span class="st">            text-align: center; </span></span>
<span id="cb5-200"><a href="#cb5-200" aria-hidden="true" tabindex="-1"></a><span class="st">            margin-top: 40px; </span></span>
<span id="cb5-201"><a href="#cb5-201" aria-hidden="true" tabindex="-1"></a><span class="st">            padding: 20px; </span></span>
<span id="cb5-202"><a href="#cb5-202" aria-hidden="true" tabindex="-1"></a><span class="st">            color: #7f8c8d; </span></span>
<span id="cb5-203"><a href="#cb5-203" aria-hidden="true" tabindex="-1"></a><span class="st">            border-top: 1px solid #e9ecef;</span></span>
<span id="cb5-204"><a href="#cb5-204" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb5-205"><a href="#cb5-205" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;/style&gt;</span></span>
<span id="cb5-206"><a href="#cb5-206" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;/head&gt;</span></span>
<span id="cb5-207"><a href="#cb5-207" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;body&gt;</span></span>
<span id="cb5-208"><a href="#cb5-208" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;div class=&quot;header&quot;&gt;</span></span>
<span id="cb5-209"><a href="#cb5-209" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;h1&gt;</span><span class="sc">{{</span><span class="st">TITLE</span><span class="sc">}}</span><span class="st">&lt;/h1&gt;</span></span>
<span id="cb5-210"><a href="#cb5-210" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;p&gt;Conversa exportada do Grok - PDF Otimizado&lt;/p&gt;</span></span>
<span id="cb5-211"><a href="#cb5-211" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;/div&gt;</span></span>
<span id="cb5-212"><a href="#cb5-212" aria-hidden="true" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb5-213"><a href="#cb5-213" aria-hidden="true" tabindex="-1"></a><span class="st">    </span><span class="sc">{{</span><span class="st">CONTENT</span><span class="sc">}}</span></span>
<span id="cb5-214"><a href="#cb5-214" aria-hidden="true" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb5-215"><a href="#cb5-215" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;div class=&quot;footer&quot;&gt;</span></span>
<span id="cb5-216"><a href="#cb5-216" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;p&gt;Gerado em </span><span class="sc">{{</span><span class="st">DATE</span><span class="sc">}}</span><span class="st">&lt;/p&gt;</span></span>
<span id="cb5-217"><a href="#cb5-217" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;/div&gt;</span></span>
<span id="cb5-218"><a href="#cb5-218" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;/body&gt;</span></span>
<span id="cb5-219"><a href="#cb5-219" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;/html&gt;&quot;&quot;&quot;</span></span>
<span id="cb5-220"><a href="#cb5-220" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb5-221"><a href="#cb5-221" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Converter com Pandoc</span></span>
<span id="cb5-222"><a href="#cb5-222" aria-hidden="true" tabindex="-1"></a>            result <span class="op">=</span> subprocess.run([</span>
<span id="cb5-223"><a href="#cb5-223" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;pandoc&#39;</span>, <span class="bu">str</span>(md_file),</span>
<span id="cb5-224"><a href="#cb5-224" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;--from&#39;</span>, <span class="st">&#39;markdown+emoji&#39;</span>,</span>
<span id="cb5-225"><a href="#cb5-225" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;--to&#39;</span>, <span class="st">&#39;html&#39;</span>,</span>
<span id="cb5-226"><a href="#cb5-226" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;--standalone&#39;</span>,</span>
<span id="cb5-227"><a href="#cb5-227" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;--mathjax&#39;</span></span>
<span id="cb5-228"><a href="#cb5-228" aria-hidden="true" tabindex="-1"></a>            ], capture_output<span class="op">=</span><span class="va">True</span>, text<span class="op">=</span><span class="va">True</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>, timeout<span class="op">=</span><span class="dv">30</span>)</span>
<span id="cb5-229"><a href="#cb5-229" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb5-230"><a href="#cb5-230" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> result.returncode <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb5-231"><a href="#cb5-231" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Aplicar template personalizado</span></span>
<span id="cb5-232"><a href="#cb5-232" aria-hidden="true" tabindex="-1"></a>                html_content <span class="op">=</span> html_template.replace(<span class="st">&#39;</span><span class="sc">{{</span><span class="st">TITLE</span><span class="sc">}}</span><span class="st">&#39;</span>, md_file.stem)</span>
<span id="cb5-233"><a href="#cb5-233" aria-hidden="true" tabindex="-1"></a>                html_content <span class="op">=</span> html_content.replace(<span class="st">&#39;</span><span class="sc">{{</span><span class="st">CONTENT</span><span class="sc">}}</span><span class="st">&#39;</span>, result.stdout)</span>
<span id="cb5-234"><a href="#cb5-234" aria-hidden="true" tabindex="-1"></a>                html_content <span class="op">=</span> html_content.replace(<span class="st">&#39;</span><span class="sc">{{</span><span class="st">DATE</span><span class="sc">}}</span><span class="st">&#39;</span>, datetime.now().strftime(<span class="st">&#39;</span><span class="sc">%d</span><span class="st">/%m/%Y %H:%M&#39;</span>))</span>
<span id="cb5-235"><a href="#cb5-235" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> html_content</span>
<span id="cb5-236"><a href="#cb5-236" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb5-237"><a href="#cb5-237" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;‚ö†Ô∏è  Pandoc falhou: </span><span class="sc">{</span>result<span class="sc">.</span>stderr<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb5-238"><a href="#cb5-238" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="va">self</span>.convert_with_fallback(md_file)</span>
<span id="cb5-239"><a href="#cb5-239" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb5-240"><a href="#cb5-240" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> subprocess.TimeoutExpired:</span>
<span id="cb5-241"><a href="#cb5-241" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;‚ö†Ô∏è  Timeout no Pandoc, usando fallback&quot;</span>)</span>
<span id="cb5-242"><a href="#cb5-242" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">self</span>.convert_with_fallback(md_file)</span>
<span id="cb5-243"><a href="#cb5-243" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb5-244"><a href="#cb5-244" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚ö†Ô∏è  Erro no Pandoc: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb5-245"><a href="#cb5-245" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">self</span>.convert_with_fallback(md_file)</span>
<span id="cb5-246"><a href="#cb5-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-247"><a href="#cb5-247" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> convert_with_fallback(<span class="va">self</span>, md_file):</span>
<span id="cb5-248"><a href="#cb5-248" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Convers√£o fallback sem Pandoc - otimizada&quot;&quot;&quot;</span></span>
<span id="cb5-249"><a href="#cb5-249" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb5-250"><a href="#cb5-250" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(md_file, <span class="st">&#39;r&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb5-251"><a href="#cb5-251" aria-hidden="true" tabindex="-1"></a>                markdown_content <span class="op">=</span> f.read()</span>
<span id="cb5-252"><a href="#cb5-252" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb5-253"><a href="#cb5-253" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Processamento mais simples e r√°pido</span></span>
<span id="cb5-254"><a href="#cb5-254" aria-hidden="true" tabindex="-1"></a>            html_content <span class="op">=</span> <span class="va">self</span>.simple_markdown_to_html(markdown_content, md_file.stem)</span>
<span id="cb5-255"><a href="#cb5-255" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> html_content</span>
<span id="cb5-256"><a href="#cb5-256" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb5-257"><a href="#cb5-257" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb5-258"><a href="#cb5-258" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚ùå Erro no fallback: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb5-259"><a href="#cb5-259" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb5-260"><a href="#cb5-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-261"><a href="#cb5-261" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> simple_markdown_to_html(<span class="va">self</span>, markdown_text, title):</span>
<span id="cb5-262"><a href="#cb5-262" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Conversor simples e r√°pido de Markdown para HTML&quot;&quot;&quot;</span></span>
<span id="cb5-263"><a href="#cb5-263" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Substitui√ß√µes b√°sicas</span></span>
<span id="cb5-264"><a href="#cb5-264" aria-hidden="true" tabindex="-1"></a>        html <span class="op">=</span> markdown_text</span>
<span id="cb5-265"><a href="#cb5-265" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb5-266"><a href="#cb5-266" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Headers</span></span>
<span id="cb5-267"><a href="#cb5-267" aria-hidden="true" tabindex="-1"></a>        html <span class="op">=</span> html.replace(<span class="st">&#39;# &#39;</span>, <span class="st">&#39;&lt;h1&gt;&#39;</span>).replace(<span class="st">&#39;</span><span class="ch">\n</span><span class="st"># &#39;</span>, <span class="st">&#39;&lt;/h1&gt;</span><span class="ch">\n</span><span class="st">&lt;h1&gt;&#39;</span>)</span>
<span id="cb5-268"><a href="#cb5-268" aria-hidden="true" tabindex="-1"></a>        html <span class="op">=</span> html.replace(<span class="st">&#39;## &#39;</span>, <span class="st">&#39;&lt;h2&gt;&#39;</span>).replace(<span class="st">&#39;</span><span class="ch">\n</span><span class="st">## &#39;</span>, <span class="st">&#39;&lt;/h2&gt;</span><span class="ch">\n</span><span class="st">&lt;h2&gt;&#39;</span>)</span>
<span id="cb5-269"><a href="#cb5-269" aria-hidden="true" tabindex="-1"></a>        html <span class="op">=</span> html.replace(<span class="st">&#39;### &#39;</span>, <span class="st">&#39;&lt;h3&gt;&#39;</span>).replace(<span class="st">&#39;</span><span class="ch">\n</span><span class="st">### &#39;</span>, <span class="st">&#39;&lt;/h3&gt;</span><span class="ch">\n</span><span class="st">&lt;h3&gt;&#39;</span>)</span>
<span id="cb5-270"><a href="#cb5-270" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb5-271"><a href="#cb5-271" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Mensagens de usu√°rio/assistente</span></span>
<span id="cb5-272"><a href="#cb5-272" aria-hidden="true" tabindex="-1"></a>        html <span class="op">=</span> html.replace(<span class="st">&#39;## üë§ Usu√°rio&#39;</span>, <span class="st">&#39;&lt;div class=&quot;message user&quot;&gt;&lt;strong&gt;üë§ Usu√°rio&lt;/strong&gt;&#39;</span>)</span>
<span id="cb5-273"><a href="#cb5-273" aria-hidden="true" tabindex="-1"></a>        html <span class="op">=</span> html.replace(<span class="st">&#39;## ü§ñ Assistente&#39;</span>, <span class="st">&#39;&lt;div class=&quot;message assistant&quot;&gt;&lt;strong&gt;ü§ñ Assistente&lt;/strong&gt;&#39;</span>)</span>
<span id="cb5-274"><a href="#cb5-274" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb5-275"><a href="#cb5-275" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Separadores</span></span>
<span id="cb5-276"><a href="#cb5-276" aria-hidden="true" tabindex="-1"></a>        html <span class="op">=</span> html.replace(<span class="st">&#39;---&#39;</span>, <span class="st">&#39;&lt;hr&gt;&#39;</span>)</span>
<span id="cb5-277"><a href="#cb5-277" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb5-278"><a href="#cb5-278" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Fechar divs de mensagem nos pr√≥ximos headers</span></span>
<span id="cb5-279"><a href="#cb5-279" aria-hidden="true" tabindex="-1"></a>        lines <span class="op">=</span> html.split(<span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>)</span>
<span id="cb5-280"><a href="#cb5-280" aria-hidden="true" tabindex="-1"></a>        processed_lines <span class="op">=</span> []</span>
<span id="cb5-281"><a href="#cb5-281" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb5-282"><a href="#cb5-282" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, line <span class="kw">in</span> <span class="bu">enumerate</span>(lines):</span>
<span id="cb5-283"><a href="#cb5-283" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> line.startswith(<span class="st">&#39;&lt;h3&gt;&#39;</span>) <span class="kw">and</span> i <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb5-284"><a href="#cb5-284" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="kw">not</span> lines[i<span class="op">-</span><span class="dv">1</span>].startswith(<span class="st">&#39;&lt;/div&gt;&#39;</span>):</span>
<span id="cb5-285"><a href="#cb5-285" aria-hidden="true" tabindex="-1"></a>                    processed_lines.append(<span class="st">&#39;&lt;/div&gt;&#39;</span>)</span>
<span id="cb5-286"><a href="#cb5-286" aria-hidden="true" tabindex="-1"></a>            processed_lines.append(line)</span>
<span id="cb5-287"><a href="#cb5-287" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb5-288"><a href="#cb5-288" aria-hidden="true" tabindex="-1"></a>        html <span class="op">=</span> <span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>.join(processed_lines)</span>
<span id="cb5-289"><a href="#cb5-289" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb5-290"><a href="#cb5-290" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Template final</span></span>
<span id="cb5-291"><a href="#cb5-291" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="ss">f&quot;&quot;&quot;&lt;!DOCTYPE html&gt;</span></span>
<span id="cb5-292"><a href="#cb5-292" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;html&gt;</span></span>
<span id="cb5-293"><a href="#cb5-293" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;head&gt;</span></span>
<span id="cb5-294"><a href="#cb5-294" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span></span>
<span id="cb5-295"><a href="#cb5-295" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;title&gt;</span><span class="sc">{</span>title<span class="sc">}</span><span class="ss">&lt;/title&gt;</span></span>
<span id="cb5-296"><a href="#cb5-296" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;style&gt;</span></span>
<span id="cb5-297"><a href="#cb5-297" aria-hidden="true" tabindex="-1"></a><span class="ss">        body </span><span class="ch">{{</span><span class="ss"> font-family: Arial, sans-serif; margin: 20px; line-height: 1.5; </span><span class="ch">}}</span></span>
<span id="cb5-298"><a href="#cb5-298" aria-hidden="true" tabindex="-1"></a><span class="ss">        .header </span><span class="ch">{{</span><span class="ss"> background: #667eea; color: white; padding: 20px; text-align: center; </span><span class="ch">}}</span></span>
<span id="cb5-299"><a href="#cb5-299" aria-hidden="true" tabindex="-1"></a><span class="ss">        .message </span><span class="ch">{{</span><span class="ss"> margin: 10px 0; padding: 10px; border-radius: 5px; </span><span class="ch">}}</span></span>
<span id="cb5-300"><a href="#cb5-300" aria-hidden="true" tabindex="-1"></a><span class="ss">        .user </span><span class="ch">{{</span><span class="ss"> background: #e3f2fd; border-left: 4px solid #1976d2; </span><span class="ch">}}</span></span>
<span id="cb5-301"><a href="#cb5-301" aria-hidden="true" tabindex="-1"></a><span class="ss">        .assistant </span><span class="ch">{{</span><span class="ss"> background: #f3e5f5; border-left: 4px solid #7b1fa2; </span><span class="ch">}}</span></span>
<span id="cb5-302"><a href="#cb5-302" aria-hidden="true" tabindex="-1"></a><span class="ss">        pre </span><span class="ch">{{</span><span class="ss"> background: #f4f4f4; padding: 10px; overflow-x: auto; </span><span class="ch">}}</span></span>
<span id="cb5-303"><a href="#cb5-303" aria-hidden="true" tabindex="-1"></a><span class="ss">        hr </span><span class="ch">{{</span><span class="ss"> border: none; height: 1px; background: #ccc; margin: 20px 0; </span><span class="ch">}}</span></span>
<span id="cb5-304"><a href="#cb5-304" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;/style&gt;</span></span>
<span id="cb5-305"><a href="#cb5-305" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;/head&gt;</span></span>
<span id="cb5-306"><a href="#cb5-306" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;body&gt;</span></span>
<span id="cb5-307"><a href="#cb5-307" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;div class=&quot;header&quot;&gt;</span></span>
<span id="cb5-308"><a href="#cb5-308" aria-hidden="true" tabindex="-1"></a><span class="ss">        &lt;h1&gt;</span><span class="sc">{</span>title<span class="sc">}</span><span class="ss">&lt;/h1&gt;</span></span>
<span id="cb5-309"><a href="#cb5-309" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;/div&gt;</span></span>
<span id="cb5-310"><a href="#cb5-310" aria-hidden="true" tabindex="-1"></a><span class="ss">    </span><span class="sc">{</span>html<span class="sc">}</span></span>
<span id="cb5-311"><a href="#cb5-311" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;div class=&quot;footer&quot;&gt;</span></span>
<span id="cb5-312"><a href="#cb5-312" aria-hidden="true" tabindex="-1"></a><span class="ss">        &lt;p&gt;Gerado em </span><span class="sc">{</span>datetime<span class="sc">.</span>now()<span class="sc">.</span>strftime(<span class="st">&#39;</span><span class="sc">%d</span><span class="st">/%m/%Y %H:%M&#39;</span>)<span class="sc">}</span><span class="ss">&lt;/p&gt;</span></span>
<span id="cb5-313"><a href="#cb5-313" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;/div&gt;</span></span>
<span id="cb5-314"><a href="#cb5-314" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;/body&gt;</span></span>
<span id="cb5-315"><a href="#cb5-315" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;/html&gt;&quot;&quot;&quot;</span></span>
<span id="cb5-316"><a href="#cb5-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-317"><a href="#cb5-317" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> html_to_pdf_fast(<span class="va">self</span>, html_file, pdf_file):</span>
<span id="cb5-318"><a href="#cb5-318" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Converte HTML para PDF usando ChromeDriver otimizado&quot;&quot;&quot;</span></span>
<span id="cb5-319"><a href="#cb5-319" aria-hidden="true" tabindex="-1"></a>        driver <span class="op">=</span> <span class="va">None</span></span>
<span id="cb5-320"><a href="#cb5-320" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb5-321"><a href="#cb5-321" aria-hidden="true" tabindex="-1"></a>            driver <span class="op">=</span> <span class="va">self</span>.setup_chrome_driver()</span>
<span id="cb5-322"><a href="#cb5-322" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> driver:</span>
<span id="cb5-323"><a href="#cb5-323" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb5-324"><a href="#cb5-324" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb5-325"><a href="#cb5-325" aria-hidden="true" tabindex="-1"></a>            full_path <span class="op">=</span> <span class="ss">f&quot;file:///</span><span class="sc">{</span>os<span class="sc">.</span>path<span class="sc">.</span>abspath(html_file)<span class="sc">.</span>replace(os.sep, <span class="st">&#39;/&#39;</span>)<span class="sc">}</span><span class="ss">&quot;</span></span>
<span id="cb5-326"><a href="#cb5-326" aria-hidden="true" tabindex="-1"></a>            driver.get(full_path)</span>
<span id="cb5-327"><a href="#cb5-327" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb5-328"><a href="#cb5-328" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Wait mais curto e eficiente</span></span>
<span id="cb5-329"><a href="#cb5-329" aria-hidden="true" tabindex="-1"></a>            WebDriverWait(driver, <span class="dv">15</span>).until(</span>
<span id="cb5-330"><a href="#cb5-330" aria-hidden="true" tabindex="-1"></a>                <span class="kw">lambda</span> d: d.execute_script(<span class="st">&#39;return document.readyState&#39;</span>) <span class="op">==</span> <span class="st">&#39;complete&#39;</span></span>
<span id="cb5-331"><a href="#cb5-331" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb5-332"><a href="#cb5-332" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb5-333"><a href="#cb5-333" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Aguardar breve para MathJax (se necess√°rio)</span></span>
<span id="cb5-334"><a href="#cb5-334" aria-hidden="true" tabindex="-1"></a>            time.sleep(<span class="dv">2</span>)</span>
<span id="cb5-335"><a href="#cb5-335" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb5-336"><a href="#cb5-336" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Configura√ß√µes otimizadas para PDF</span></span>
<span id="cb5-337"><a href="#cb5-337" aria-hidden="true" tabindex="-1"></a>            pdf_params <span class="op">=</span> {</span>
<span id="cb5-338"><a href="#cb5-338" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;landscape&#39;</span>: <span class="va">False</span>,</span>
<span id="cb5-339"><a href="#cb5-339" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;displayHeaderFooter&#39;</span>: <span class="va">False</span>,</span>
<span id="cb5-340"><a href="#cb5-340" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;printBackground&#39;</span>: <span class="va">True</span>,</span>
<span id="cb5-341"><a href="#cb5-341" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;preferCSSPageSize&#39;</span>: <span class="va">True</span>,</span>
<span id="cb5-342"><a href="#cb5-342" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;marginTop&#39;</span>: <span class="fl">0.4</span>,</span>
<span id="cb5-343"><a href="#cb5-343" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;marginBottom&#39;</span>: <span class="fl">0.4</span>,</span>
<span id="cb5-344"><a href="#cb5-344" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;marginLeft&#39;</span>: <span class="fl">0.4</span>,</span>
<span id="cb5-345"><a href="#cb5-345" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;marginRight&#39;</span>: <span class="fl">0.4</span>,</span>
<span id="cb5-346"><a href="#cb5-346" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb5-347"><a href="#cb5-347" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb5-348"><a href="#cb5-348" aria-hidden="true" tabindex="-1"></a>            result <span class="op">=</span> driver.execute_cdp_cmd(<span class="st">&#39;Page.printToPDF&#39;</span>, pdf_params)</span>
<span id="cb5-349"><a href="#cb5-349" aria-hidden="true" tabindex="-1"></a>            pdf_data <span class="op">=</span> base64.b64decode(result[<span class="st">&#39;data&#39;</span>])</span>
<span id="cb5-350"><a href="#cb5-350" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb5-351"><a href="#cb5-351" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Garantir pasta de destino</span></span>
<span id="cb5-352"><a href="#cb5-352" aria-hidden="true" tabindex="-1"></a>            os.makedirs(os.path.dirname(pdf_file), exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb5-353"><a href="#cb5-353" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb5-354"><a href="#cb5-354" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(pdf_file, <span class="st">&#39;wb&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb5-355"><a href="#cb5-355" aria-hidden="true" tabindex="-1"></a>                f.write(pdf_data)</span>
<span id="cb5-356"><a href="#cb5-356" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb5-357"><a href="#cb5-357" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb5-358"><a href="#cb5-358" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb5-359"><a href="#cb5-359" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb5-360"><a href="#cb5-360" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚ùå Erro na convers√£o PDF: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb5-361"><a href="#cb5-361" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb5-362"><a href="#cb5-362" aria-hidden="true" tabindex="-1"></a>        <span class="cf">finally</span>:</span>
<span id="cb5-363"><a href="#cb5-363" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> driver:</span>
<span id="cb5-364"><a href="#cb5-364" aria-hidden="true" tabindex="-1"></a>                driver.quit()</span>
<span id="cb5-365"><a href="#cb5-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-366"><a href="#cb5-366" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> show_progress(<span class="va">self</span>, current, total, filename, status):</span>
<span id="cb5-367"><a href="#cb5-367" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Mostra progresso detalhado com barra&quot;&quot;&quot;</span></span>
<span id="cb5-368"><a href="#cb5-368" aria-hidden="true" tabindex="-1"></a>        percent <span class="op">=</span> (current <span class="op">/</span> total) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb5-369"><a href="#cb5-369" aria-hidden="true" tabindex="-1"></a>        bar_length <span class="op">=</span> <span class="dv">40</span></span>
<span id="cb5-370"><a href="#cb5-370" aria-hidden="true" tabindex="-1"></a>        filled_length <span class="op">=</span> <span class="bu">int</span>(bar_length <span class="op">*</span> current <span class="op">//</span> total)</span>
<span id="cb5-371"><a href="#cb5-371" aria-hidden="true" tabindex="-1"></a>        bar <span class="op">=</span> <span class="st">&#39;‚ñà&#39;</span> <span class="op">*</span> filled_length <span class="op">+</span> <span class="st">&#39;‚ñë&#39;</span> <span class="op">*</span> (bar_length <span class="op">-</span> filled_length)</span>
<span id="cb5-372"><a href="#cb5-372" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb5-373"><a href="#cb5-373" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&#39;</span><span class="ch">\r</span><span class="ss">üìä [</span><span class="sc">{</span>bar<span class="sc">}</span><span class="ss">] </span><span class="sc">{</span>percent<span class="sc">:.1f}</span><span class="ss">% (</span><span class="sc">{</span>current<span class="sc">}</span><span class="ss">/</span><span class="sc">{</span>total<span class="sc">}</span><span class="ss">) </span><span class="sc">{</span>filename[:<span class="dv">30</span>]<span class="sc">:&lt;30}</span><span class="ss"> - </span><span class="sc">{</span>status<span class="sc">}</span><span class="ss">&#39;</span>, </span>
<span id="cb5-374"><a href="#cb5-374" aria-hidden="true" tabindex="-1"></a>              end<span class="op">=</span><span class="st">&#39;&#39;</span>, flush<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb5-375"><a href="#cb5-375" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb5-376"><a href="#cb5-376" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> current <span class="op">==</span> total:</span>
<span id="cb5-377"><a href="#cb5-377" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>()</span>
<span id="cb5-378"><a href="#cb5-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-379"><a href="#cb5-379" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> process_batch(<span class="va">self</span>, batch_files, batch_num, total_batches):</span>
<span id="cb5-380"><a href="#cb5-380" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Processa um lote de arquivos&quot;&quot;&quot;</span></span>
<span id="cb5-381"><a href="#cb5-381" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="ch">\n</span><span class="ss">üîÑ Lote </span><span class="sc">{</span>batch_num<span class="sc">}</span><span class="ss">/</span><span class="sc">{</span>total_batches<span class="sc">}</span><span class="ss"> - </span><span class="sc">{</span><span class="bu">len</span>(batch_files)<span class="sc">}</span><span class="ss"> arquivos&quot;</span>)</span>
<span id="cb5-382"><a href="#cb5-382" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb5-383"><a href="#cb5-383" aria-hidden="true" tabindex="-1"></a>        successful <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb5-384"><a href="#cb5-384" aria-hidden="true" tabindex="-1"></a>        driver <span class="op">=</span> <span class="va">self</span>.setup_chrome_driver()</span>
<span id="cb5-385"><a href="#cb5-385" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb5-386"><a href="#cb5-386" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb5-387"><a href="#cb5-387" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> i, md_file <span class="kw">in</span> <span class="bu">enumerate</span>(batch_files, <span class="dv">1</span>):</span>
<span id="cb5-388"><a href="#cb5-388" aria-hidden="true" tabindex="-1"></a>                pdf_output <span class="op">=</span> Path(<span class="va">self</span>.pdf_dir) <span class="op">/</span> <span class="ss">f&quot;</span><span class="sc">{</span>md_file<span class="sc">.</span>stem<span class="sc">}</span><span class="ss">.pdf&quot;</span></span>
<span id="cb5-389"><a href="#cb5-389" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb5-390"><a href="#cb5-390" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Pular se j√° existe</span></span>
<span id="cb5-391"><a href="#cb5-391" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> pdf_output.exists():</span>
<span id="cb5-392"><a href="#cb5-392" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.show_progress(i, <span class="bu">len</span>(batch_files), md_file.name, <span class="st">&quot;‚è≠Ô∏è Existente&quot;</span>)</span>
<span id="cb5-393"><a href="#cb5-393" aria-hidden="true" tabindex="-1"></a>                    successful <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb5-394"><a href="#cb5-394" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">continue</span></span>
<span id="cb5-395"><a href="#cb5-395" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb5-396"><a href="#cb5-396" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.show_progress(i, <span class="bu">len</span>(batch_files), md_file.name, <span class="st">&quot;üîÑ Convertendo...&quot;</span>)</span>
<span id="cb5-397"><a href="#cb5-397" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb5-398"><a href="#cb5-398" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Converter Markdown para HTML</span></span>
<span id="cb5-399"><a href="#cb5-399" aria-hidden="true" tabindex="-1"></a>                html_content <span class="op">=</span> <span class="va">self</span>.convert_with_pandoc_optimized(md_file)</span>
<span id="cb5-400"><a href="#cb5-400" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="kw">not</span> html_content:</span>
<span id="cb5-401"><a href="#cb5-401" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.show_progress(i, <span class="bu">len</span>(batch_files), md_file.name, <span class="st">&quot;‚ùå HTML falhou&quot;</span>)</span>
<span id="cb5-402"><a href="#cb5-402" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">continue</span></span>
<span id="cb5-403"><a href="#cb5-403" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb5-404"><a href="#cb5-404" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Salvar HTML tempor√°rio</span></span>
<span id="cb5-405"><a href="#cb5-405" aria-hidden="true" tabindex="-1"></a>                <span class="cf">with</span> tempfile.NamedTemporaryFile(mode<span class="op">=</span><span class="st">&#39;w&#39;</span>, suffix<span class="op">=</span><span class="st">&#39;.html&#39;</span>, delete<span class="op">=</span><span class="va">False</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb5-406"><a href="#cb5-406" aria-hidden="true" tabindex="-1"></a>                    f.write(html_content)</span>
<span id="cb5-407"><a href="#cb5-407" aria-hidden="true" tabindex="-1"></a>                    temp_html <span class="op">=</span> f.name</span>
<span id="cb5-408"><a href="#cb5-408" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb5-409"><a href="#cb5-409" aria-hidden="true" tabindex="-1"></a>                <span class="cf">try</span>:</span>
<span id="cb5-410"><a href="#cb5-410" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># Converter HTML para PDF</span></span>
<span id="cb5-411"><a href="#cb5-411" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> driver <span class="kw">and</span> <span class="va">self</span>.html_to_pdf_with_driver(driver, temp_html, pdf_output):</span>
<span id="cb5-412"><a href="#cb5-412" aria-hidden="true" tabindex="-1"></a>                        successful <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb5-413"><a href="#cb5-413" aria-hidden="true" tabindex="-1"></a>                        <span class="va">self</span>.show_progress(i, <span class="bu">len</span>(batch_files), md_file.name, <span class="st">&quot;‚úÖ Sucesso&quot;</span>)</span>
<span id="cb5-414"><a href="#cb5-414" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">else</span>:</span>
<span id="cb5-415"><a href="#cb5-415" aria-hidden="true" tabindex="-1"></a>                        <span class="va">self</span>.show_progress(i, <span class="bu">len</span>(batch_files), md_file.name, <span class="st">&quot;‚ùå PDF falhou&quot;</span>)</span>
<span id="cb5-416"><a href="#cb5-416" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb5-417"><a href="#cb5-417" aria-hidden="true" tabindex="-1"></a>                <span class="cf">finally</span>:</span>
<span id="cb5-418"><a href="#cb5-418" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># Limpar arquivo tempor√°rio</span></span>
<span id="cb5-419"><a href="#cb5-419" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> os.path.exists(temp_html):</span>
<span id="cb5-420"><a href="#cb5-420" aria-hidden="true" tabindex="-1"></a>                        os.remove(temp_html)</span>
<span id="cb5-421"><a href="#cb5-421" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb5-422"><a href="#cb5-422" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Pequena pausa entre arquivos</span></span>
<span id="cb5-423"><a href="#cb5-423" aria-hidden="true" tabindex="-1"></a>                time.sleep(<span class="dv">1</span>)</span>
<span id="cb5-424"><a href="#cb5-424" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb5-425"><a href="#cb5-425" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> successful</span>
<span id="cb5-426"><a href="#cb5-426" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb5-427"><a href="#cb5-427" aria-hidden="true" tabindex="-1"></a>        <span class="cf">finally</span>:</span>
<span id="cb5-428"><a href="#cb5-428" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> driver:</span>
<span id="cb5-429"><a href="#cb5-429" aria-hidden="true" tabindex="-1"></a>                driver.quit()</span>
<span id="cb5-430"><a href="#cb5-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-431"><a href="#cb5-431" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> html_to_pdf_with_driver(<span class="va">self</span>, driver, html_file, pdf_file):</span>
<span id="cb5-432"><a href="#cb5-432" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Usa driver existente para converter HTML para PDF&quot;&quot;&quot;</span></span>
<span id="cb5-433"><a href="#cb5-433" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb5-434"><a href="#cb5-434" aria-hidden="true" tabindex="-1"></a>            full_path <span class="op">=</span> <span class="ss">f&quot;file:///</span><span class="sc">{</span>os<span class="sc">.</span>path<span class="sc">.</span>abspath(html_file)<span class="sc">.</span>replace(os.sep, <span class="st">&#39;/&#39;</span>)<span class="sc">}</span><span class="ss">&quot;</span></span>
<span id="cb5-435"><a href="#cb5-435" aria-hidden="true" tabindex="-1"></a>            driver.get(full_path)</span>
<span id="cb5-436"><a href="#cb5-436" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb5-437"><a href="#cb5-437" aria-hidden="true" tabindex="-1"></a>            WebDriverWait(driver, <span class="dv">15</span>).until(</span>
<span id="cb5-438"><a href="#cb5-438" aria-hidden="true" tabindex="-1"></a>                <span class="kw">lambda</span> d: d.execute_script(<span class="st">&#39;return document.readyState&#39;</span>) <span class="op">==</span> <span class="st">&#39;complete&#39;</span></span>
<span id="cb5-439"><a href="#cb5-439" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb5-440"><a href="#cb5-440" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb5-441"><a href="#cb5-441" aria-hidden="true" tabindex="-1"></a>            time.sleep(<span class="dv">1</span>)  <span class="co"># Pausa reduzida</span></span>
<span id="cb5-442"><a href="#cb5-442" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb5-443"><a href="#cb5-443" aria-hidden="true" tabindex="-1"></a>            pdf_params <span class="op">=</span> {</span>
<span id="cb5-444"><a href="#cb5-444" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;landscape&#39;</span>: <span class="va">False</span>,</span>
<span id="cb5-445"><a href="#cb5-445" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;displayHeaderFooter&#39;</span>: <span class="va">False</span>,</span>
<span id="cb5-446"><a href="#cb5-446" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;printBackground&#39;</span>: <span class="va">True</span>,</span>
<span id="cb5-447"><a href="#cb5-447" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;preferCSSPageSize&#39;</span>: <span class="va">True</span>,</span>
<span id="cb5-448"><a href="#cb5-448" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;marginTop&#39;</span>: <span class="fl">0.4</span>,</span>
<span id="cb5-449"><a href="#cb5-449" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;marginBottom&#39;</span>: <span class="fl">0.4</span>,</span>
<span id="cb5-450"><a href="#cb5-450" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;marginLeft&#39;</span>: <span class="fl">0.4</span>,</span>
<span id="cb5-451"><a href="#cb5-451" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;marginRight&#39;</span>: <span class="fl">0.4</span>,</span>
<span id="cb5-452"><a href="#cb5-452" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb5-453"><a href="#cb5-453" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb5-454"><a href="#cb5-454" aria-hidden="true" tabindex="-1"></a>            result <span class="op">=</span> driver.execute_cdp_cmd(<span class="st">&#39;Page.printToPDF&#39;</span>, pdf_params)</span>
<span id="cb5-455"><a href="#cb5-455" aria-hidden="true" tabindex="-1"></a>            pdf_data <span class="op">=</span> base64.b64decode(result[<span class="st">&#39;data&#39;</span>])</span>
<span id="cb5-456"><a href="#cb5-456" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb5-457"><a href="#cb5-457" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(pdf_file, <span class="st">&#39;wb&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb5-458"><a href="#cb5-458" aria-hidden="true" tabindex="-1"></a>                f.write(pdf_data)</span>
<span id="cb5-459"><a href="#cb5-459" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb5-460"><a href="#cb5-460" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb5-461"><a href="#cb5-461" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb5-462"><a href="#cb5-462" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb5-463"><a href="#cb5-463" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚ùå Erro no driver: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb5-464"><a href="#cb5-464" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb5-465"><a href="#cb5-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-466"><a href="#cb5-466" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> convert_all_files(<span class="va">self</span>):</span>
<span id="cb5-467"><a href="#cb5-467" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Converte todos os arquivos Markdown para PDF de forma otimizada&quot;&quot;&quot;</span></span>
<span id="cb5-468"><a href="#cb5-468" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;üöÄ CONVERSOR PDF OTIMIZADO - Iniciando&quot;</span>)</span>
<span id="cb5-469"><a href="#cb5-469" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;=&quot;</span> <span class="op">*</span> <span class="dv">60</span>)</span>
<span id="cb5-470"><a href="#cb5-470" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb5-471"><a href="#cb5-471" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.check_dependencies():</span>
<span id="cb5-472"><a href="#cb5-472" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">‚ùå Instale as depend√™ncias faltantes antes de continuar&quot;</span>)</span>
<span id="cb5-473"><a href="#cb5-473" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb5-474"><a href="#cb5-474" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb5-475"><a href="#cb5-475" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Verificar arquivos</span></span>
<span id="cb5-476"><a href="#cb5-476" aria-hidden="true" tabindex="-1"></a>        md_files <span class="op">=</span> <span class="bu">list</span>(Path(<span class="va">self</span>.md_dir).glob(<span class="st">&quot;*.md&quot;</span>))</span>
<span id="cb5-477"><a href="#cb5-477" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb5-478"><a href="#cb5-478" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> md_files:</span>
<span id="cb5-479"><a href="#cb5-479" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;‚ùå Nenhum arquivo .md encontrado&quot;</span>)</span>
<span id="cb5-480"><a href="#cb5-480" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;üí° Execute primeiro: python grok_processor.py&quot;</span>)</span>
<span id="cb5-481"><a href="#cb5-481" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb5-482"><a href="#cb5-482" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb5-483"><a href="#cb5-483" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;üìÑ Arquivos encontrados: </span><span class="sc">{</span><span class="bu">len</span>(md_files)<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb5-484"><a href="#cb5-484" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;üîß M√©todo: Pandoc + ChromeDriver (Lotes de </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>batch_size<span class="sc">}</span><span class="ss">)&quot;</span>)</span>
<span id="cb5-485"><a href="#cb5-485" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;‚è±Ô∏è  Iniciando convers√£o...</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb5-486"><a href="#cb5-486" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb5-487"><a href="#cb5-487" aria-hidden="true" tabindex="-1"></a>        total_successful <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb5-488"><a href="#cb5-488" aria-hidden="true" tabindex="-1"></a>        total_files <span class="op">=</span> <span class="bu">len</span>(md_files)</span>
<span id="cb5-489"><a href="#cb5-489" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb5-490"><a href="#cb5-490" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Processar em lotes</span></span>
<span id="cb5-491"><a href="#cb5-491" aria-hidden="true" tabindex="-1"></a>        total_batches <span class="op">=</span> (<span class="bu">len</span>(md_files) <span class="op">+</span> <span class="va">self</span>.batch_size <span class="op">-</span> <span class="dv">1</span>) <span class="op">//</span> <span class="va">self</span>.batch_size</span>
<span id="cb5-492"><a href="#cb5-492" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb5-493"><a href="#cb5-493" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> batch_num <span class="kw">in</span> <span class="bu">range</span>(total_batches):</span>
<span id="cb5-494"><a href="#cb5-494" aria-hidden="true" tabindex="-1"></a>            start_idx <span class="op">=</span> batch_num <span class="op">*</span> <span class="va">self</span>.batch_size</span>
<span id="cb5-495"><a href="#cb5-495" aria-hidden="true" tabindex="-1"></a>            end_idx <span class="op">=</span> start_idx <span class="op">+</span> <span class="va">self</span>.batch_size</span>
<span id="cb5-496"><a href="#cb5-496" aria-hidden="true" tabindex="-1"></a>            batch <span class="op">=</span> md_files[start_idx:end_idx]</span>
<span id="cb5-497"><a href="#cb5-497" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb5-498"><a href="#cb5-498" aria-hidden="true" tabindex="-1"></a>            batch_success <span class="op">=</span> <span class="va">self</span>.process_batch(batch, batch_num <span class="op">+</span> <span class="dv">1</span>, total_batches)</span>
<span id="cb5-499"><a href="#cb5-499" aria-hidden="true" tabindex="-1"></a>            total_successful <span class="op">+=</span> batch_success</span>
<span id="cb5-500"><a href="#cb5-500" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb5-501"><a href="#cb5-501" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Pausa entre lotes (exceto √∫ltimo)</span></span>
<span id="cb5-502"><a href="#cb5-502" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> batch_num <span class="op">&lt;</span> total_batches <span class="op">-</span> <span class="dv">1</span>:</span>
<span id="cb5-503"><a href="#cb5-503" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="ch">\n</span><span class="ss">üí§ Pausa entre lotes...&quot;</span>)</span>
<span id="cb5-504"><a href="#cb5-504" aria-hidden="true" tabindex="-1"></a>                time.sleep(<span class="dv">2</span>)</span>
<span id="cb5-505"><a href="#cb5-505" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb5-506"><a href="#cb5-506" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Relat√≥rio final</span></span>
<span id="cb5-507"><a href="#cb5-507" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="ch">\n</span><span class="ss">&quot;</span> <span class="op">+</span> <span class="st">&quot;=&quot;</span> <span class="op">*</span> <span class="dv">60</span>)</span>
<span id="cb5-508"><a href="#cb5-508" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;üéâ CONVERS√ÉO CONCLU√çDA!&quot;</span>)</span>
<span id="cb5-509"><a href="#cb5-509" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;=&quot;</span> <span class="op">*</span> <span class="dv">60</span>)</span>
<span id="cb5-510"><a href="#cb5-510" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;üìä RESUMO:&quot;</span>)</span>
<span id="cb5-511"><a href="#cb5-511" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;   ‚úÖ Sucessos: </span><span class="sc">{</span>total_successful<span class="sc">}</span><span class="ss">/</span><span class="sc">{</span>total_files<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb5-512"><a href="#cb5-512" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;   üìÅ Pasta: </span><span class="sc">{</span>os<span class="sc">.</span>path<span class="sc">.</span>abspath(<span class="va">self</span>.pdf_dir)<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb5-513"><a href="#cb5-513" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;   ‚ö° M√©todo: ChromeDriver Otimizado&quot;</span>)</span>
<span id="cb5-514"><a href="#cb5-514" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb5-515"><a href="#cb5-515" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> total_successful <span class="op">&lt;</span> total_files:</span>
<span id="cb5-516"><a href="#cb5-516" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="ch">\n</span><span class="ss">‚ö†Ô∏è  </span><span class="sc">{</span>total_files <span class="op">-</span> total_successful<span class="sc">}</span><span class="ss"> arquivos falharam&quot;</span>)</span>
<span id="cb5-517"><a href="#cb5-517" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;üí° Verifique as depend√™ncias e tente novamente&quot;</span>)</span>
<span id="cb5-518"><a href="#cb5-518" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb5-519"><a href="#cb5-519" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> total_successful <span class="op">&gt;</span> <span class="dv">0</span></span>
<span id="cb5-520"><a href="#cb5-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-521"><a href="#cb5-521" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> main():</span>
<span id="cb5-522"><a href="#cb5-522" aria-hidden="true" tabindex="-1"></a>    converter <span class="op">=</span> PDFConverterOptimized()</span>
<span id="cb5-523"><a href="#cb5-523" aria-hidden="true" tabindex="-1"></a>    success <span class="op">=</span> converter.convert_all_files()</span>
<span id="cb5-524"><a href="#cb5-524" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-525"><a href="#cb5-525" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> success:</span>
<span id="cb5-526"><a href="#cb5-526" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">‚ú® Todos os PDFs foram gerados com sucesso!&quot;</span>)</span>
<span id="cb5-527"><a href="#cb5-527" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb5-528"><a href="#cb5-528" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">‚ùå Houve problemas na convers√£o&quot;</span>)</span>
<span id="cb5-529"><a href="#cb5-529" aria-hidden="true" tabindex="-1"></a>        sys.exit(<span class="dv">1</span>)</span>
<span id="cb5-530"><a href="#cb5-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-531"><a href="#cb5-531" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&quot;__main__&quot;</span>:</span>
<span id="cb5-532"><a href="#cb5-532" aria-hidden="true" tabindex="-1"></a>    main()</span></code></pre></div>
<h2 data-number="2.6" id="script-de-gerenciamento-atualizado"><span class="header-section-number">2.6</span> Script de Gerenciamento
Atualizado:</h2>
<div class="sourceCode" id="cb6"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># grok_export_manager.py</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> subprocess</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sys</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> run_processor():</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Executa o processador principal&quot;&quot;&quot;</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;üîÑ Executando Grok Processor...&quot;</span>)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> subprocess.run([sys.executable, <span class="st">&quot;grok_processor.py&quot;</span>], </span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>                          capture_output<span class="op">=</span><span class="va">True</span>, text<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> result.returncode <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;‚úÖ Processamento conclu√≠do com sucesso!&quot;</span>)</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;‚ùå Erro no processamento:&quot;</span>)</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(result.stderr)</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> run_pdf_converter():</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Executa o conversor PDF otimizado&quot;&quot;&quot;</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;üîÑ Executando PDF Converter Otimizado...&quot;</span>)</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> subprocess.run([sys.executable, <span class="st">&quot;grok_pdf_converter_optimized.py&quot;</span>], </span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>                          capture_output<span class="op">=</span><span class="va">True</span>, text<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> result.returncode <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;‚úÖ Convers√£o PDF conclu√≠da com sucesso!&quot;</span>)</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;‚ùå Erro na convers√£o PDF:&quot;</span>)</span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(result.stderr)</span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> main():</span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;üöÄ GERENCIADOR DE EXPORTA√á√ÉO GROK - OTIMIZADO&quot;</span>)</span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;=&quot;</span> <span class="op">*</span> <span class="dv">50</span>)</span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;1. Processar dados e gerar Markdown + Dashboard&quot;</span>)</span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;2. Converter Markdown para PDF (R√ÅPIDO)&quot;</span>)</span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;3. Processamento completo (1 + 2)&quot;</span>)</span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;4. Verificar depend√™ncias&quot;</span>)</span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;=&quot;</span> <span class="op">*</span> <span class="dv">50</span>)</span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a>    choice <span class="op">=</span> <span class="bu">input</span>(<span class="st">&quot;Escolha uma op√ß√£o (1-4): &quot;</span>).strip()</span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a>    start_time <span class="op">=</span> datetime.now()</span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> choice <span class="op">==</span> <span class="st">&quot;1&quot;</span>:</span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a>        run_processor()</span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> choice <span class="op">==</span> <span class="st">&quot;2&quot;</span>:</span>
<span id="cb6-51"><a href="#cb6-51" aria-hidden="true" tabindex="-1"></a>        run_pdf_converter()</span>
<span id="cb6-52"><a href="#cb6-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> choice <span class="op">==</span> <span class="st">&quot;3&quot;</span>:</span>
<span id="cb6-53"><a href="#cb6-53" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> run_processor():</span>
<span id="cb6-54"><a href="#cb6-54" aria-hidden="true" tabindex="-1"></a>            run_pdf_converter()</span>
<span id="cb6-55"><a href="#cb6-55" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> choice <span class="op">==</span> <span class="st">&quot;4&quot;</span>:</span>
<span id="cb6-56"><a href="#cb6-56" aria-hidden="true" tabindex="-1"></a>        <span class="im">from</span> grok_pdf_converter_optimized <span class="im">import</span> PDFConverterOptimized</span>
<span id="cb6-57"><a href="#cb6-57" aria-hidden="true" tabindex="-1"></a>        converter <span class="op">=</span> PDFConverterOptimized()</span>
<span id="cb6-58"><a href="#cb6-58" aria-hidden="true" tabindex="-1"></a>        converter.check_dependencies()</span>
<span id="cb6-59"><a href="#cb6-59" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb6-60"><a href="#cb6-60" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;‚ùå Op√ß√£o inv√°lida&quot;</span>)</span>
<span id="cb6-61"><a href="#cb6-61" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-62"><a href="#cb6-62" aria-hidden="true" tabindex="-1"></a>    elapsed <span class="op">=</span> datetime.now() <span class="op">-</span> start_time</span>
<span id="cb6-63"><a href="#cb6-63" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="ch">\n</span><span class="ss">‚è±Ô∏è  Tempo total: </span><span class="sc">{</span>elapsed<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb6-64"><a href="#cb6-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-65"><a href="#cb6-65" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&quot;__main__&quot;</span>:</span>
<span id="cb6-66"><a href="#cb6-66" aria-hidden="true" tabindex="-1"></a>    main()</span></code></pre></div>
<h2 data-number="2.7" id="principais-otimiza√ß√µes-implementadas"><span class="header-section-number">2.7</span> Principais Otimiza√ß√µes
Implementadas:</h2>
<ol type="1">
<li><strong>ChromeDriver Otimizado</strong>:
<ul>
<li>Desabilita imagens para maior velocidade</li>
<li>Timeouts reduzidos</li>
<li>Configura√ß√µes de mem√≥ria otimizadas</li>
</ul></li>
<li><strong>Processamento em Lotes</strong>:
<ul>
<li>Reutiliza o mesmo driver para m√∫ltiplos arquivos</li>
<li>Reduz overhead de inicializa√ß√£o</li>
</ul></li>
<li><strong>Convers√£o Mais R√°pida</strong>:
<ul>
<li>Template HTML simplificado</li>
<li>Wait times reduzidos</li>
<li>Processamento mais eficiente</li>
</ul></li>
<li><strong>Progresso em Tempo Real</strong>:
<ul>
<li>Barra de progresso visual</li>
<li>Status detalhado por arquivo</li>
</ul></li>
<li><strong>Fallback Robusto</strong>:
<ul>
<li>Pandoc como prim√°rio</li>
<li>Conversor simples como fallback</li>
</ul></li>
</ol>
<h2 data-number="2.8" id="uso"><span class="header-section-number">2.8</span> Uso:</h2>
<div class="sourceCode" id="cb7"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convers√£o r√°pida com ChromeDriver</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> grok_pdf_converter_optimized.py</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Ou pelo gerenciador</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> grok_export_manager.py</span></code></pre></div>
<p>Esta vers√£o deve ser significativamente mais r√°pida que a anterior
com Playwright, especialmente para grandes quantidades de arquivos!</p>
<hr />
<h3 data-number="2.8.1" id="utilizador-2025-11-02-011140-deepseek-chat"><span class="header-section-number">2.8.1</span> üë§ Utilizador <em>(2025-11-02
01:11:40)</em> <em>[deepseek-chat]</em></h3>
<p>Pretendia que o grok_processor.py fosse melhorado com uma estrutura
semelhante ao chatgpt_index_system.py</p>
<hr />
<h3 data-number="2.8.2" id="deepseek-2025-11-02-011140-deepseek-chat"><span class="header-section-number">2.8.2</span> ü§ñ DeepSeek <em>(2025-11-02
01:11:40)</em> <em>[deepseek-chat]</em></h3>
<p>Perfeito! Vou melhorar o <code>grok_processor.py</code> com a
estrutura e funcionalidades do <code>chatgpt_index_system.py</code>.
Aqui est√° a vers√£o otimizada:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># grok_processor_optimized.py</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> zipfile</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> Counter</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> webbrowser</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> glob</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> subprocess</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> GrokProcessorOptimized:</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.conversations <span class="op">=</span> []</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a><span class="op">---</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a><span class="co">### üë§ Utilizador *(2025-11-02 01:12:58)* *[deepseek-chat]*</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>Pretendia que o grok_processor.py fosse melhorado com uma estrutura semelhante ao chatgpt_index_system.py  Com ordena√ß√£o das conversas por data (mais recente primeiro)</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a><span class="op">---</span></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a><span class="co">### ü§ñ DeepSeek *(2025-11-02 01:12:58)* *[deepseek-chat]*</span></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>Perfeito<span class="op">!</span> Vou melhorar o `grok_processor.py` com a estrutura do `chatgpt_index_system.py` e adicionar ordena√ß√£o por data. Aqui est√° a vers√£o otimizada:</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a><span class="co"># grok_processor_optimized.py</span></span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> zipfile</span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime</span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> Counter</span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> webbrowser</span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> glob</span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> GrokProcessorOptimized:</span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.conversations <span class="op">=</span> []</span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.all_messages <span class="op">=</span> []</span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.index_file <span class="op">=</span> <span class="st">&quot;grok_complete_dashboard/index.html&quot;</span></span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.markdown_folder <span class="op">=</span> <span class="st">&quot;grok_complete_dashboard/markdown&quot;</span></span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.pdf_folder <span class="op">=</span> <span class="st">&quot;grok_complete_dashboard/pdf/conversas&quot;</span></span>
<span id="cb8-51"><a href="#cb8-51" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.data_folder <span class="op">=</span> <span class="st">&quot;grok_complete_dashboard/data&quot;</span></span>
<span id="cb8-52"><a href="#cb8-52" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-53"><a href="#cb8-53" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> setup_folders(<span class="va">self</span>):</span>
<span id="cb8-54"><a href="#cb8-54" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Cria estrutura de pastas necess√°ria&quot;&quot;&quot;</span></span>
<span id="cb8-55"><a href="#cb8-55" aria-hidden="true" tabindex="-1"></a>        folders <span class="op">=</span> [</span>
<span id="cb8-56"><a href="#cb8-56" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.markdown_folder,</span>
<span id="cb8-57"><a href="#cb8-57" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.pdf_folder,</span>
<span id="cb8-58"><a href="#cb8-58" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.data_folder,</span>
<span id="cb8-59"><a href="#cb8-59" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;grok_complete_dashboard/pdf&quot;</span></span>
<span id="cb8-60"><a href="#cb8-60" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb8-61"><a href="#cb8-61" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-62"><a href="#cb8-62" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> folder <span class="kw">in</span> folders:</span>
<span id="cb8-63"><a href="#cb8-63" aria-hidden="true" tabindex="-1"></a>            os.makedirs(folder, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb8-64"><a href="#cb8-64" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-65"><a href="#cb8-65" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;üìÅ Estrutura de pastas criada&quot;</span>)</span>
<span id="cb8-66"><a href="#cb8-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-67"><a href="#cb8-67" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> load_grok_data(<span class="va">self</span>):</span>
<span id="cb8-68"><a href="#cb8-68" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Carrega e processa os dados do arquivo zip de forma otimizada&quot;&quot;&quot;</span></span>
<span id="cb8-69"><a href="#cb8-69" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-70"><a href="#cb8-70" aria-hidden="true" tabindex="-1"></a>        zip_files <span class="op">=</span> [<span class="st">&quot;grok.zip&quot;</span>, <span class="st">&quot;gork.zip&quot;</span>]</span>
<span id="cb8-71"><a href="#cb8-71" aria-hidden="true" tabindex="-1"></a>        zip_path <span class="op">=</span> <span class="bu">next</span>((f <span class="cf">for</span> f <span class="kw">in</span> zip_files <span class="cf">if</span> os.path.exists(f)), <span class="va">None</span>)</span>
<span id="cb8-72"><a href="#cb8-72" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-73"><a href="#cb8-73" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> zip_path <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb8-74"><a href="#cb8-74" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;‚ùå Nenhum arquivo zip encontrado!&quot;</span>)</span>
<span id="cb8-75"><a href="#cb8-75" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb8-76"><a href="#cb8-76" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-77"><a href="#cb8-77" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;üìÇ Carregando dados do </span><span class="sc">{</span>zip_path<span class="sc">}</span><span class="ss">...&quot;</span>)</span>
<span id="cb8-78"><a href="#cb8-78" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-79"><a href="#cb8-79" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb8-80"><a href="#cb8-80" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> zipfile.ZipFile(zip_path, <span class="st">&#39;r&#39;</span>) <span class="im">as</span> zip_ref:</span>
<span id="cb8-81"><a href="#cb8-81" aria-hidden="true" tabindex="-1"></a>                json_files <span class="op">=</span> [f <span class="cf">for</span> f <span class="kw">in</span> zip_ref.namelist() <span class="cf">if</span> f.endswith(<span class="st">&#39;.json&#39;</span>)]</span>
<span id="cb8-82"><a href="#cb8-82" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;üîç Processando </span><span class="sc">{</span><span class="bu">len</span>(json_files)<span class="sc">}</span><span class="ss"> arquivos JSON...&quot;</span>)</span>
<span id="cb8-83"><a href="#cb8-83" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb8-84"><a href="#cb8-84" aria-hidden="true" tabindex="-1"></a>                all_data <span class="op">=</span> []</span>
<span id="cb8-85"><a href="#cb8-85" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> file_name <span class="kw">in</span> json_files:</span>
<span id="cb8-86"><a href="#cb8-86" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">try</span>:</span>
<span id="cb8-87"><a href="#cb8-87" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">with</span> zip_ref.<span class="bu">open</span>(file_name) <span class="im">as</span> f:</span>
<span id="cb8-88"><a href="#cb8-88" aria-hidden="true" tabindex="-1"></a>                            content <span class="op">=</span> f.read().decode(<span class="st">&#39;utf-8&#39;</span>)</span>
<span id="cb8-89"><a href="#cb8-89" aria-hidden="true" tabindex="-1"></a>                            data <span class="op">=</span> json.loads(content)</span>
<span id="cb8-90"><a href="#cb8-90" aria-hidden="true" tabindex="-1"></a>                            all_data.append({</span>
<span id="cb8-91"><a href="#cb8-91" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&#39;file_name&#39;</span>: file_name,</span>
<span id="cb8-92"><a href="#cb8-92" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&#39;data&#39;</span>: data,</span>
<span id="cb8-93"><a href="#cb8-93" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&#39;size&#39;</span>: <span class="bu">len</span>(content)</span>
<span id="cb8-94"><a href="#cb8-94" aria-hidden="true" tabindex="-1"></a>                            })</span>
<span id="cb8-95"><a href="#cb8-95" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb8-96"><a href="#cb8-96" aria-hidden="true" tabindex="-1"></a>                        <span class="bu">print</span>(<span class="ss">f&quot;‚ö†Ô∏è  </span><span class="sc">{</span>file_name<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb8-97"><a href="#cb8-97" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb8-98"><a href="#cb8-98" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ Dados brutos carregados: </span><span class="sc">{</span><span class="bu">len</span>(all_data)<span class="sc">}</span><span class="ss"> arquivos&quot;</span>)</span>
<span id="cb8-99"><a href="#cb8-99" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> all_data</span>
<span id="cb8-100"><a href="#cb8-100" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb8-101"><a href="#cb8-101" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb8-102"><a href="#cb8-102" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚ùå Erro ao processar </span><span class="sc">{</span>zip_path<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb8-103"><a href="#cb8-103" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb8-104"><a href="#cb8-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-105"><a href="#cb8-105" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> extract_conversations(<span class="va">self</span>, all_data):</span>
<span id="cb8-106"><a href="#cb8-106" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Extrai conversas dos dados brutos&quot;&quot;&quot;</span></span>
<span id="cb8-107"><a href="#cb8-107" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;üìä Extraindo conversas...&quot;</span>)</span>
<span id="cb8-108"><a href="#cb8-108" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-109"><a href="#cb8-109" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.conversations <span class="op">=</span> []</span>
<span id="cb8-110"><a href="#cb8-110" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-111"><a href="#cb8-111" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> item <span class="kw">in</span> all_data:</span>
<span id="cb8-112"><a href="#cb8-112" aria-hidden="true" tabindex="-1"></a>            data <span class="op">=</span> item[<span class="st">&#39;data&#39;</span>]</span>
<span id="cb8-113"><a href="#cb8-113" aria-hidden="true" tabindex="-1"></a>            file_name <span class="op">=</span> item[<span class="st">&#39;file_name&#39;</span>]</span>
<span id="cb8-114"><a href="#cb8-114" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb8-115"><a href="#cb8-115" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="st">&#39;prod-grok-backend.json&#39;</span> <span class="kw">in</span> file_name <span class="kw">and</span> <span class="bu">isinstance</span>(data, <span class="bu">dict</span>):</span>
<span id="cb8-116"><a href="#cb8-116" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="st">&#39;conversations&#39;</span> <span class="kw">in</span> data <span class="kw">and</span> <span class="bu">isinstance</span>(data[<span class="st">&#39;conversations&#39;</span>], <span class="bu">list</span>):</span>
<span id="cb8-117"><a href="#cb8-117" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ </span><span class="sc">{</span>file_name<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span><span class="bu">len</span>(data[<span class="st">&#39;conversations&#39;</span>])<span class="sc">}</span><span class="ss"> conversas encontradas&quot;</span>)</span>
<span id="cb8-118"><a href="#cb8-118" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.conversations.extend(data[<span class="st">&#39;conversations&#39;</span>])</span>
<span id="cb8-119"><a href="#cb8-119" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-120"><a href="#cb8-120" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;üéØ Total de conversas extra√≠das: </span><span class="sc">{</span><span class="bu">len</span>(<span class="va">self</span>.conversations)<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb8-121"><a href="#cb8-121" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.conversations</span>
<span id="cb8-122"><a href="#cb8-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-123"><a href="#cb8-123" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> extract_messages(<span class="va">self</span>, conv):</span>
<span id="cb8-124"><a href="#cb8-124" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Extrai mensagens de uma conversa&quot;&quot;&quot;</span></span>
<span id="cb8-125"><a href="#cb8-125" aria-hidden="true" tabindex="-1"></a>        messages <span class="op">=</span> []</span>
<span id="cb8-126"><a href="#cb8-126" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-127"><a href="#cb8-127" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">isinstance</span>(conv, <span class="bu">dict</span>) <span class="kw">and</span> <span class="st">&#39;responses&#39;</span> <span class="kw">in</span> conv <span class="kw">and</span> <span class="bu">isinstance</span>(conv[<span class="st">&#39;responses&#39;</span>], <span class="bu">list</span>):</span>
<span id="cb8-128"><a href="#cb8-128" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> response <span class="kw">in</span> conv[<span class="st">&#39;responses&#39;</span>]:</span>
<span id="cb8-129"><a href="#cb8-129" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="bu">isinstance</span>(response, <span class="bu">dict</span>) <span class="kw">and</span> <span class="st">&#39;response&#39;</span> <span class="kw">in</span> response:</span>
<span id="cb8-130"><a href="#cb8-130" aria-hidden="true" tabindex="-1"></a>                    response_data <span class="op">=</span> response[<span class="st">&#39;response&#39;</span>]</span>
<span id="cb8-131"><a href="#cb8-131" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="bu">isinstance</span>(response_data, <span class="bu">dict</span>):</span>
<span id="cb8-132"><a href="#cb8-132" aria-hidden="true" tabindex="-1"></a>                        message_content <span class="op">=</span> response_data.get(<span class="st">&#39;message&#39;</span>, <span class="st">&#39;&#39;</span>)</span>
<span id="cb8-133"><a href="#cb8-133" aria-hidden="true" tabindex="-1"></a>                        sender <span class="op">=</span> response_data.get(<span class="st">&#39;sender&#39;</span>, <span class="st">&#39;&#39;</span>)</span>
<span id="cb8-134"><a href="#cb8-134" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb8-135"><a href="#cb8-135" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">if</span> message_content <span class="kw">and</span> sender:</span>
<span id="cb8-136"><a href="#cb8-136" aria-hidden="true" tabindex="-1"></a>                            messages.append({</span>
<span id="cb8-137"><a href="#cb8-137" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&#39;content&#39;</span>: message_content,</span>
<span id="cb8-138"><a href="#cb8-138" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&#39;sender&#39;</span>: sender,</span>
<span id="cb8-139"><a href="#cb8-139" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&#39;response_id&#39;</span>: response_data.get(<span class="st">&#39;_id&#39;</span>, <span class="st">&#39;&#39;</span>),</span>
<span id="cb8-140"><a href="#cb8-140" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&#39;model&#39;</span>: response_data.get(<span class="st">&#39;model&#39;</span>, <span class="st">&#39;&#39;</span>),</span>
<span id="cb8-141"><a href="#cb8-141" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&#39;create_time&#39;</span>: response_data.get(<span class="st">&#39;create_time&#39;</span>, {})</span>
<span id="cb8-142"><a href="#cb8-142" aria-hidden="true" tabindex="-1"></a>                            })</span>
<span id="cb8-143"><a href="#cb8-143" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-144"><a href="#cb8-144" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> messages</span>
<span id="cb8-145"><a href="#cb8-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-146"><a href="#cb8-146" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> parse_datetime(<span class="va">self</span>, date_string):</span>
<span id="cb8-147"><a href="#cb8-147" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Converte string de data para objeto datetime para ordena√ß√£o&quot;&quot;&quot;</span></span>
<span id="cb8-148"><a href="#cb8-148" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> date_string:</span>
<span id="cb8-149"><a href="#cb8-149" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> datetime.<span class="bu">min</span></span>
<span id="cb8-150"><a href="#cb8-150" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-151"><a href="#cb8-151" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb8-152"><a href="#cb8-152" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Tenta v√°rios formatos de data</span></span>
<span id="cb8-153"><a href="#cb8-153" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">isinstance</span>(date_string, <span class="bu">dict</span>):</span>
<span id="cb8-154"><a href="#cb8-154" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Se for objeto, pega timestamp</span></span>
<span id="cb8-155"><a href="#cb8-155" aria-hidden="true" tabindex="-1"></a>                timestamp <span class="op">=</span> date_string.get(<span class="st">&#39;$date&#39;</span>, <span class="dv">0</span>)</span>
<span id="cb8-156"><a href="#cb8-156" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> timestamp:</span>
<span id="cb8-157"><a href="#cb8-157" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">return</span> datetime.fromtimestamp(timestamp <span class="op">/</span> <span class="dv">1000</span>)</span>
<span id="cb8-158"><a href="#cb8-158" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> datetime.<span class="bu">min</span></span>
<span id="cb8-159"><a href="#cb8-159" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb8-160"><a href="#cb8-160" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Tenta formato ISO</span></span>
<span id="cb8-161"><a href="#cb8-161" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="st">&#39;T&#39;</span> <span class="kw">in</span> <span class="bu">str</span>(date_string):</span>
<span id="cb8-162"><a href="#cb8-162" aria-hidden="true" tabindex="-1"></a>                date_str <span class="op">=</span> <span class="bu">str</span>(date_string).replace(<span class="st">&#39;Z&#39;</span>, <span class="st">&#39;+00:00&#39;</span>)</span>
<span id="cb8-163"><a href="#cb8-163" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> datetime.fromisoformat(date_str)</span>
<span id="cb8-164"><a href="#cb8-164" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb8-165"><a href="#cb8-165" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Tenta outros formatos</span></span>
<span id="cb8-166"><a href="#cb8-166" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> fmt <span class="kw">in</span> [<span class="st">&#39;%Y-%m-</span><span class="sc">%d</span><span class="st"> %H:%M:%S&#39;</span>, <span class="st">&#39;%Y-%m-</span><span class="sc">%d</span><span class="st">&#39;</span>, <span class="st">&#39;</span><span class="sc">%d</span><span class="st">/%m/%Y %H:%M:%S&#39;</span>]:</span>
<span id="cb8-167"><a href="#cb8-167" aria-hidden="true" tabindex="-1"></a>                <span class="cf">try</span>:</span>
<span id="cb8-168"><a href="#cb8-168" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">return</span> datetime.strptime(<span class="bu">str</span>(date_string), fmt)</span>
<span id="cb8-169"><a href="#cb8-169" aria-hidden="true" tabindex="-1"></a>                <span class="cf">except</span>:</span>
<span id="cb8-170"><a href="#cb8-170" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">continue</span></span>
<span id="cb8-171"><a href="#cb8-171" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb8-172"><a href="#cb8-172" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> datetime.<span class="bu">min</span></span>
<span id="cb8-173"><a href="#cb8-173" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span>:</span>
<span id="cb8-174"><a href="#cb8-174" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> datetime.<span class="bu">min</span></span>
<span id="cb8-175"><a href="#cb8-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-176"><a href="#cb8-176" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> analyze_conversations(<span class="va">self</span>):</span>
<span id="cb8-177"><a href="#cb8-177" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Analisa as conversas com m√©tricas completas&quot;&quot;&quot;</span></span>
<span id="cb8-178"><a href="#cb8-178" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;üìä Analisando conversas...&quot;</span>)</span>
<span id="cb8-179"><a href="#cb8-179" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-180"><a href="#cb8-180" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.conversations:</span>
<span id="cb8-181"><a href="#cb8-181" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;‚ùå Nenhuma conversa para analisar!&quot;</span>)</span>
<span id="cb8-182"><a href="#cb8-182" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> pd.DataFrame(), []</span>
<span id="cb8-183"><a href="#cb8-183" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-184"><a href="#cb8-184" aria-hidden="true" tabindex="-1"></a>        analysis_data <span class="op">=</span> []</span>
<span id="cb8-185"><a href="#cb8-185" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.all_messages <span class="op">=</span> []</span>
<span id="cb8-186"><a href="#cb8-186" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-187"><a href="#cb8-187" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, conv <span class="kw">in</span> <span class="bu">enumerate</span>(<span class="va">self</span>.conversations):</span>
<span id="cb8-188"><a href="#cb8-188" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(conv, <span class="bu">dict</span>):</span>
<span id="cb8-189"><a href="#cb8-189" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span></span>
<span id="cb8-190"><a href="#cb8-190" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb8-191"><a href="#cb8-191" aria-hidden="true" tabindex="-1"></a>            conversation_data <span class="op">=</span> conv.get(<span class="st">&#39;conversation&#39;</span>, {})</span>
<span id="cb8-192"><a href="#cb8-192" aria-hidden="true" tabindex="-1"></a>            conv_id <span class="op">=</span> conversation_data.get(<span class="st">&#39;id&#39;</span>, <span class="ss">f&#39;conv_</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb8-193"><a href="#cb8-193" aria-hidden="true" tabindex="-1"></a>            title <span class="op">=</span> conversation_data.get(<span class="st">&#39;title&#39;</span>, <span class="ss">f&#39;Conversa </span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb8-194"><a href="#cb8-194" aria-hidden="true" tabindex="-1"></a>            created_at <span class="op">=</span> conversation_data.get(<span class="st">&#39;create_time&#39;</span>, <span class="st">&#39;&#39;</span>)</span>
<span id="cb8-195"><a href="#cb8-195" aria-hidden="true" tabindex="-1"></a>            updated_at <span class="op">=</span> conversation_data.get(<span class="st">&#39;modify_time&#39;</span>, <span class="st">&#39;&#39;</span>)</span>
<span id="cb8-196"><a href="#cb8-196" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb8-197"><a href="#cb8-197" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Parse datas para ordena√ß√£o</span></span>
<span id="cb8-198"><a href="#cb8-198" aria-hidden="true" tabindex="-1"></a>            created_dt <span class="op">=</span> <span class="va">self</span>.parse_datetime(created_at)</span>
<span id="cb8-199"><a href="#cb8-199" aria-hidden="true" tabindex="-1"></a>            updated_dt <span class="op">=</span> <span class="va">self</span>.parse_datetime(updated_at)</span>
<span id="cb8-200"><a href="#cb8-200" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb8-201"><a href="#cb8-201" aria-hidden="true" tabindex="-1"></a>            messages <span class="op">=</span> <span class="va">self</span>.extract_messages(conv)</span>
<span id="cb8-202"><a href="#cb8-202" aria-hidden="true" tabindex="-1"></a>            num_messages <span class="op">=</span> <span class="bu">len</span>(messages)</span>
<span id="cb8-203"><a href="#cb8-203" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb8-204"><a href="#cb8-204" aria-hidden="true" tabindex="-1"></a>            <span class="co"># M√©tricas</span></span>
<span id="cb8-205"><a href="#cb8-205" aria-hidden="true" tabindex="-1"></a>            total_words <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb8-206"><a href="#cb8-206" aria-hidden="true" tabindex="-1"></a>            user_words <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb8-207"><a href="#cb8-207" aria-hidden="true" tabindex="-1"></a>            assistant_words <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb8-208"><a href="#cb8-208" aria-hidden="true" tabindex="-1"></a>            user_messages <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb8-209"><a href="#cb8-209" aria-hidden="true" tabindex="-1"></a>            assistant_messages <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb8-210"><a href="#cb8-210" aria-hidden="true" tabindex="-1"></a>            total_chars <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb8-211"><a href="#cb8-211" aria-hidden="true" tabindex="-1"></a>            preview_content <span class="op">=</span> <span class="st">&quot;&quot;</span></span>
<span id="cb8-212"><a href="#cb8-212" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb8-213"><a href="#cb8-213" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> j, msg <span class="kw">in</span> <span class="bu">enumerate</span>(messages):</span>
<span id="cb8-214"><a href="#cb8-214" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="bu">isinstance</span>(msg, <span class="bu">dict</span>):</span>
<span id="cb8-215"><a href="#cb8-215" aria-hidden="true" tabindex="-1"></a>                    content <span class="op">=</span> msg.get(<span class="st">&#39;content&#39;</span>, <span class="st">&#39;&#39;</span>)</span>
<span id="cb8-216"><a href="#cb8-216" aria-hidden="true" tabindex="-1"></a>                    sender <span class="op">=</span> msg.get(<span class="st">&#39;sender&#39;</span>, <span class="st">&#39;&#39;</span>)</span>
<span id="cb8-217"><a href="#cb8-217" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb8-218"><a href="#cb8-218" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> content <span class="kw">and</span> <span class="bu">len</span>(content.strip()) <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb8-219"><a href="#cb8-219" aria-hidden="true" tabindex="-1"></a>                        words <span class="op">=</span> <span class="bu">len</span>(content.split())</span>
<span id="cb8-220"><a href="#cb8-220" aria-hidden="true" tabindex="-1"></a>                        chars <span class="op">=</span> <span class="bu">len</span>(content)</span>
<span id="cb8-221"><a href="#cb8-221" aria-hidden="true" tabindex="-1"></a>                        total_words <span class="op">+=</span> words</span>
<span id="cb8-222"><a href="#cb8-222" aria-hidden="true" tabindex="-1"></a>                        total_chars <span class="op">+=</span> chars</span>
<span id="cb8-223"><a href="#cb8-223" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb8-224"><a href="#cb8-224" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">if</span> j <span class="op">==</span> <span class="dv">0</span> <span class="kw">and</span> content:</span>
<span id="cb8-225"><a href="#cb8-225" aria-hidden="true" tabindex="-1"></a>                            preview_content <span class="op">=</span> content[:<span class="dv">150</span>] <span class="op">+</span> <span class="st">&quot;...&quot;</span> <span class="cf">if</span> <span class="bu">len</span>(content) <span class="op">&gt;</span> <span class="dv">150</span> <span class="cf">else</span> content</span>
<span id="cb8-226"><a href="#cb8-226" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb8-227"><a href="#cb8-227" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">if</span> sender <span class="op">==</span> <span class="st">&#39;human&#39;</span>:</span>
<span id="cb8-228"><a href="#cb8-228" aria-hidden="true" tabindex="-1"></a>                            user_words <span class="op">+=</span> words</span>
<span id="cb8-229"><a href="#cb8-229" aria-hidden="true" tabindex="-1"></a>                            user_messages <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb8-230"><a href="#cb8-230" aria-hidden="true" tabindex="-1"></a>                            role <span class="op">=</span> <span class="st">&#39;user&#39;</span></span>
<span id="cb8-231"><a href="#cb8-231" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">elif</span> sender <span class="kw">in</span> [<span class="st">&#39;assistant&#39;</span>, <span class="st">&#39;grok&#39;</span>, <span class="st">&#39;model&#39;</span>]:</span>
<span id="cb8-232"><a href="#cb8-232" aria-hidden="true" tabindex="-1"></a>                            assistant_words <span class="op">+=</span> words</span>
<span id="cb8-233"><a href="#cb8-233" aria-hidden="true" tabindex="-1"></a>                            assistant_messages <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb8-234"><a href="#cb8-234" aria-hidden="true" tabindex="-1"></a>                            role <span class="op">=</span> <span class="st">&#39;assistant&#39;</span></span>
<span id="cb8-235"><a href="#cb8-235" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">else</span>:</span>
<span id="cb8-236"><a href="#cb8-236" aria-hidden="true" tabindex="-1"></a>                            role <span class="op">=</span> sender</span>
<span id="cb8-237"><a href="#cb8-237" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb8-238"><a href="#cb8-238" aria-hidden="true" tabindex="-1"></a>                        <span class="va">self</span>.all_messages.append({</span>
<span id="cb8-239"><a href="#cb8-239" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&#39;conversation_id&#39;</span>: conv_id,</span>
<span id="cb8-240"><a href="#cb8-240" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&#39;conversation_title&#39;</span>: title,</span>
<span id="cb8-241"><a href="#cb8-241" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&#39;message_index&#39;</span>: j,</span>
<span id="cb8-242"><a href="#cb8-242" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&#39;role&#39;</span>: role,</span>
<span id="cb8-243"><a href="#cb8-243" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&#39;sender&#39;</span>: sender,</span>
<span id="cb8-244"><a href="#cb8-244" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&#39;content&#39;</span>: content,</span>
<span id="cb8-245"><a href="#cb8-245" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&#39;word_count&#39;</span>: words,</span>
<span id="cb8-246"><a href="#cb8-246" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&#39;char_count&#39;</span>: chars,</span>
<span id="cb8-247"><a href="#cb8-247" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&#39;model&#39;</span>: msg.get(<span class="st">&#39;model&#39;</span>, <span class="st">&#39;&#39;</span>),</span>
<span id="cb8-248"><a href="#cb8-248" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&#39;response_id&#39;</span>: msg.get(<span class="st">&#39;response_id&#39;</span>, <span class="st">&#39;&#39;</span>),</span>
<span id="cb8-249"><a href="#cb8-249" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&#39;timestamp&#39;</span>: created_dt</span>
<span id="cb8-250"><a href="#cb8-250" aria-hidden="true" tabindex="-1"></a>                        })</span>
<span id="cb8-251"><a href="#cb8-251" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb8-252"><a href="#cb8-252" aria-hidden="true" tabindex="-1"></a>            analysis_data.append({</span>
<span id="cb8-253"><a href="#cb8-253" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;conversation_id&#39;</span>: conv_id,</span>
<span id="cb8-254"><a href="#cb8-254" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;title&#39;</span>: title,</span>
<span id="cb8-255"><a href="#cb8-255" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;created_at&#39;</span>: created_at,</span>
<span id="cb8-256"><a href="#cb8-256" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;created_dt&#39;</span>: created_dt,  <span class="co"># Para ordena√ß√£o</span></span>
<span id="cb8-257"><a href="#cb8-257" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;updated_at&#39;</span>: updated_at,</span>
<span id="cb8-258"><a href="#cb8-258" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;updated_dt&#39;</span>: updated_dt,</span>
<span id="cb8-259"><a href="#cb8-259" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;num_messages&#39;</span>: num_messages,</span>
<span id="cb8-260"><a href="#cb8-260" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;total_words&#39;</span>: total_words,</span>
<span id="cb8-261"><a href="#cb8-261" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;total_chars&#39;</span>: total_chars,</span>
<span id="cb8-262"><a href="#cb8-262" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;user_words&#39;</span>: user_words,</span>
<span id="cb8-263"><a href="#cb8-263" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;assistant_words&#39;</span>: assistant_words,</span>
<span id="cb8-264"><a href="#cb8-264" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;user_messages&#39;</span>: user_messages,</span>
<span id="cb8-265"><a href="#cb8-265" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;assistant_messages&#39;</span>: assistant_messages,</span>
<span id="cb8-266"><a href="#cb8-266" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;preview_content&#39;</span>: preview_content,</span>
<span id="cb8-267"><a href="#cb8-267" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;avg_words_per_message&#39;</span>: total_words <span class="op">/</span> <span class="bu">max</span>(num_messages, <span class="dv">1</span>),</span>
<span id="cb8-268"><a href="#cb8-268" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;category&#39;</span>: <span class="va">self</span>.categorize_conversation(title)</span>
<span id="cb8-269"><a href="#cb8-269" aria-hidden="true" tabindex="-1"></a>            })</span>
<span id="cb8-270"><a href="#cb8-270" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-271"><a href="#cb8-271" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Ordenar por data (mais recente primeiro)</span></span>
<span id="cb8-272"><a href="#cb8-272" aria-hidden="true" tabindex="-1"></a>        analysis_data.sort(key<span class="op">=</span><span class="kw">lambda</span> x: x[<span class="st">&#39;created_dt&#39;</span>], reverse<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb8-273"><a href="#cb8-273" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-274"><a href="#cb8-274" aria-hidden="true" tabindex="-1"></a>        df <span class="op">=</span> pd.DataFrame(analysis_data)</span>
<span id="cb8-275"><a href="#cb8-275" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-276"><a href="#cb8-276" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> df.empty:</span>
<span id="cb8-277"><a href="#cb8-277" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;üìà Total de conversas analisadas: </span><span class="sc">{</span><span class="bu">len</span>(df)<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb8-278"><a href="#cb8-278" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;üí¨ Total de mensagens: </span><span class="sc">{</span>df[<span class="st">&#39;num_messages&#39;</span>]<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb8-279"><a href="#cb8-279" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;üìù Total de palavras: </span><span class="sc">{</span>df[<span class="st">&#39;total_words&#39;</span>]<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb8-280"><a href="#cb8-280" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;üìÖ Ordena√ß√£o: Mais recente ‚Üí Mais antiga&quot;</span>)</span>
<span id="cb8-281"><a href="#cb8-281" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-282"><a href="#cb8-282" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> df, <span class="va">self</span>.all_messages</span>
<span id="cb8-283"><a href="#cb8-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-284"><a href="#cb8-284" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> categorize_conversation(<span class="va">self</span>, title):</span>
<span id="cb8-285"><a href="#cb8-285" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Categoriza conversas de forma inteligente&quot;&quot;&quot;</span></span>
<span id="cb8-286"><a href="#cb8-286" aria-hidden="true" tabindex="-1"></a>        title_lower <span class="op">=</span> title.lower()</span>
<span id="cb8-287"><a href="#cb8-287" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-288"><a href="#cb8-288" aria-hidden="true" tabindex="-1"></a>        categories <span class="op">=</span> {</span>
<span id="cb8-289"><a href="#cb8-289" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Programa√ß√£o&#39;</span>: [<span class="st">&#39;python&#39;</span>, <span class="st">&#39;programming&#39;</span>, <span class="st">&#39;code&#39;</span>, <span class="st">&#39;script&#39;</span>, <span class="st">&#39;api&#39;</span>, <span class="st">&#39;function&#39;</span>, <span class="st">&#39;class&#39;</span>, <span class="st">&#39;java&#39;</span>, <span class="st">&#39;javascript&#39;</span>, <span class="st">&#39;html&#39;</span>, <span class="st">&#39;css&#39;</span>],</span>
<span id="cb8-290"><a href="#cb8-290" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Sistemas&#39;</span>: [<span class="st">&#39;linux&#39;</span>, <span class="st">&#39;ubuntu&#39;</span>, <span class="st">&#39;windows&#39;</span>, <span class="st">&#39;install&#39;</span>, <span class="st">&#39;os&#39;</span>, <span class="st">&#39;system&#39;</span>, <span class="st">&#39;server&#39;</span>, <span class="st">&#39;terminal&#39;</span>],</span>
<span id="cb8-291"><a href="#cb8-291" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Ambientes&#39;</span>: [<span class="st">&#39;conda&#39;</span>, <span class="st">&#39;anaconda&#39;</span>, <span class="st">&#39;virtualenv&#39;</span>, <span class="st">&#39;package&#39;</span>, <span class="st">&#39;environment&#39;</span>, <span class="st">&#39;venv&#39;</span>, <span class="st">&#39;pip&#39;</span>],</span>
<span id="cb8-292"><a href="#cb8-292" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Exporta√ß√£o&#39;</span>: [<span class="st">&#39;markdown&#39;</span>, <span class="st">&#39;pdf&#39;</span>, <span class="st">&#39;export&#39;</span>, <span class="st">&#39;convert&#39;</span>, <span class="st">&#39;conversion&#39;</span>, <span class="st">&#39;exportar&#39;</span>],</span>
<span id="cb8-293"><a href="#cb8-293" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Terminal&#39;</span>: [<span class="st">&#39;msys2&#39;</span>, <span class="st">&#39;terminal&#39;</span>, <span class="st">&#39;command&#39;</span>, <span class="st">&#39;shell&#39;</span>, <span class="st">&#39;bash&#39;</span>, <span class="st">&#39;cmd&#39;</span>, <span class="st">&#39;prompt&#39;</span>],</span>
<span id="cb8-294"><a href="#cb8-294" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;IA&#39;</span>: [<span class="st">&#39;ai&#39;</span>, <span class="st">&#39;gpt&#39;</span>, <span class="st">&#39;model&#39;</span>, <span class="st">&#39;neural&#39;</span>, <span class="st">&#39;machine learning&#39;</span>, <span class="st">&#39;deep learning&#39;</span>, <span class="st">&#39;llm&#39;</span>],</span>
<span id="cb8-295"><a href="#cb8-295" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Dados&#39;</span>: [<span class="st">&#39;data&#39;</span>, <span class="st">&#39;analysis&#39;</span>, <span class="st">&#39;pandas&#39;</span>, <span class="st">&#39;dataframe&#39;</span>, <span class="st">&#39;csv&#39;</span>, <span class="st">&#39;excel&#39;</span>, <span class="st">&#39;database&#39;</span>],</span>
<span id="cb8-296"><a href="#cb8-296" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Web&#39;</span>: [<span class="st">&#39;web&#39;</span>, <span class="st">&#39;browser&#39;</span>, <span class="st">&#39;http&#39;</span>, <span class="st">&#39;website&#39;</span>, <span class="st">&#39;url&#39;</span>, <span class="st">&#39;internet&#39;</span>],</span>
<span id="cb8-297"><a href="#cb8-297" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Configura√ß√£o&#39;</span>: [<span class="st">&#39;config&#39;</span>, <span class="st">&#39;setup&#39;</span>, <span class="st">&#39;install&#39;</span>, <span class="st">&#39;configure&#39;</span>, <span class="st">&#39;settings&#39;</span>],</span>
<span id="cb8-298"><a href="#cb8-298" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Ajuda&#39;</span>: [<span class="st">&#39;help&#39;</span>, <span class="st">&#39;ajuda&#39;</span>, <span class="st">&#39;como&#39;</span>, <span class="st">&#39;tutorial&#39;</span>, <span class="st">&#39;guide&#39;</span>, <span class="st">&#39;manual&#39;</span>]</span>
<span id="cb8-299"><a href="#cb8-299" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb8-300"><a href="#cb8-300" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-301"><a href="#cb8-301" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> category, keywords <span class="kw">in</span> categories.items():</span>
<span id="cb8-302"><a href="#cb8-302" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">any</span>(keyword <span class="kw">in</span> title_lower <span class="cf">for</span> keyword <span class="kw">in</span> keywords):</span>
<span id="cb8-303"><a href="#cb8-303" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> category</span>
<span id="cb8-304"><a href="#cb8-304" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-305"><a href="#cb8-305" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">&#39;Geral&#39;</span></span>
<span id="cb8-306"><a href="#cb8-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-307"><a href="#cb8-307" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_markdown_files(<span class="va">self</span>, df):</span>
<span id="cb8-308"><a href="#cb8-308" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Cria arquivos Markdown otimizados&quot;&quot;&quot;</span></span>
<span id="cb8-309"><a href="#cb8-309" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;üìù Criando arquivos Markdown...&quot;</span>)</span>
<span id="cb8-310"><a href="#cb8-310" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-311"><a href="#cb8-311" aria-hidden="true" tabindex="-1"></a>        created_files <span class="op">=</span> []</span>
<span id="cb8-312"><a href="#cb8-312" aria-hidden="true" tabindex="-1"></a>        skipped_generic <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb8-313"><a href="#cb8-313" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-314"><a href="#cb8-314" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> _, row <span class="kw">in</span> df.iterrows():</span>
<span id="cb8-315"><a href="#cb8-315" aria-hidden="true" tabindex="-1"></a>            safe_title <span class="op">=</span> <span class="va">self</span>.create_safe_filename(row[<span class="st">&#39;title&#39;</span>])</span>
<span id="cb8-316"><a href="#cb8-316" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb8-317"><a href="#cb8-317" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Pular t√≠tulos gen√©ricos</span></span>
<span id="cb8-318"><a href="#cb8-318" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="va">self</span>.is_generic_title(safe_title):</span>
<span id="cb8-319"><a href="#cb8-319" aria-hidden="true" tabindex="-1"></a>                skipped_generic <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb8-320"><a href="#cb8-320" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span></span>
<span id="cb8-321"><a href="#cb8-321" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb8-322"><a href="#cb8-322" aria-hidden="true" tabindex="-1"></a>            conv_messages <span class="op">=</span> [msg <span class="cf">for</span> msg <span class="kw">in</span> <span class="va">self</span>.all_messages </span>
<span id="cb8-323"><a href="#cb8-323" aria-hidden="true" tabindex="-1"></a>                           <span class="cf">if</span> msg[<span class="st">&#39;conversation_id&#39;</span>] <span class="op">==</span> row[<span class="st">&#39;conversation_id&#39;</span>]]</span>
<span id="cb8-324"><a href="#cb8-324" aria-hidden="true" tabindex="-1"></a>            conv_messages.sort(key<span class="op">=</span><span class="kw">lambda</span> x: x[<span class="st">&#39;message_index&#39;</span>])</span>
<span id="cb8-325"><a href="#cb8-325" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb8-326"><a href="#cb8-326" aria-hidden="true" tabindex="-1"></a>            md_content <span class="op">=</span> <span class="va">self</span>.generate_markdown_content(row, conv_messages)</span>
<span id="cb8-327"><a href="#cb8-327" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb8-328"><a href="#cb8-328" aria-hidden="true" tabindex="-1"></a>            md_filename <span class="op">=</span> <span class="ss">f&quot;</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>markdown_folder<span class="sc">}</span><span class="ss">/</span><span class="sc">{</span>safe_title<span class="sc">}</span><span class="ss">.md&quot;</span></span>
<span id="cb8-329"><a href="#cb8-329" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(md_filename, <span class="st">&#39;w&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb8-330"><a href="#cb8-330" aria-hidden="true" tabindex="-1"></a>                f.write(md_content)</span>
<span id="cb8-331"><a href="#cb8-331" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb8-332"><a href="#cb8-332" aria-hidden="true" tabindex="-1"></a>            created_files.append(md_filename)</span>
<span id="cb8-333"><a href="#cb8-333" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-334"><a href="#cb8-334" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ </span><span class="sc">{</span><span class="bu">len</span>(created_files)<span class="sc">}</span><span class="ss"> arquivos Markdown criados&quot;</span>)</span>
<span id="cb8-335"><a href="#cb8-335" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> skipped_generic <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb8-336"><a href="#cb8-336" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚ö†Ô∏è  </span><span class="sc">{</span>skipped_generic<span class="sc">}</span><span class="ss"> conversas com t√≠tulos gen√©ricos ignoradas&quot;</span>)</span>
<span id="cb8-337"><a href="#cb8-337" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> created_files</span>
<span id="cb8-338"><a href="#cb8-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-339"><a href="#cb8-339" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_safe_filename(<span class="va">self</span>, title):</span>
<span id="cb8-340"><a href="#cb8-340" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Cria nome de arquivo seguro&quot;&quot;&quot;</span></span>
<span id="cb8-341"><a href="#cb8-341" aria-hidden="true" tabindex="-1"></a>        safe <span class="op">=</span> <span class="st">&quot;&quot;</span>.join(c <span class="cf">for</span> c <span class="kw">in</span> title <span class="cf">if</span> c.isalnum() <span class="kw">or</span> c <span class="kw">in</span> (<span class="st">&#39; &#39;</span>, <span class="st">&#39;-&#39;</span>, <span class="st">&#39;_&#39;</span>)).rstrip()</span>
<span id="cb8-342"><a href="#cb8-342" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> safe[:<span class="dv">50</span>] <span class="cf">if</span> safe <span class="cf">else</span> <span class="ss">f&quot;conversa_</span><span class="sc">{</span><span class="bu">int</span>(datetime.now().timestamp())<span class="sc">}</span><span class="ss">&quot;</span></span>
<span id="cb8-343"><a href="#cb8-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-344"><a href="#cb8-344" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> is_generic_title(<span class="va">self</span>, title):</span>
<span id="cb8-345"><a href="#cb8-345" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Verifica se o t√≠tulo √© gen√©rico&quot;&quot;&quot;</span></span>
<span id="cb8-346"><a href="#cb8-346" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">bool</span>(re.match(<span class="vs">r&#39;</span><span class="dv">^</span><span class="kw">(</span><span class="vs">conversa</span><span class="cf">|</span><span class="vs">conv</span><span class="cf">|</span><span class="vs">chat</span><span class="kw">)</span><span class="dv">\s</span><span class="op">*</span><span class="dv">\d</span><span class="op">+</span><span class="dv">$</span><span class="vs">&#39;</span>, title.lower()))</span>
<span id="cb8-347"><a href="#cb8-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-348"><a href="#cb8-348" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> generate_markdown_content(<span class="va">self</span>, row, messages):</span>
<span id="cb8-349"><a href="#cb8-349" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Gera conte√∫do Markdown formatado&quot;&quot;&quot;</span></span>
<span id="cb8-350"><a href="#cb8-350" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Formatar data para exibi√ß√£o</span></span>
<span id="cb8-351"><a href="#cb8-351" aria-hidden="true" tabindex="-1"></a>        created_date <span class="op">=</span> <span class="st">&quot;&quot;</span></span>
<span id="cb8-352"><a href="#cb8-352" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> pd.notna(row.get(<span class="st">&#39;created_at&#39;</span>)):</span>
<span id="cb8-353"><a href="#cb8-353" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb8-354"><a href="#cb8-354" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="bu">hasattr</span>(row[<span class="st">&#39;created_at&#39;</span>], <span class="st">&#39;strftime&#39;</span>):</span>
<span id="cb8-355"><a href="#cb8-355" aria-hidden="true" tabindex="-1"></a>                    created_date <span class="op">=</span> row[<span class="st">&#39;created_at&#39;</span>].strftime(<span class="st">&#39;%Y-%m-</span><span class="sc">%d</span><span class="st"> %H:%M:%S&#39;</span>)</span>
<span id="cb8-356"><a href="#cb8-356" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb8-357"><a href="#cb8-357" aria-hidden="true" tabindex="-1"></a>                    created_date <span class="op">=</span> <span class="bu">str</span>(row[<span class="st">&#39;created_at&#39;</span>])</span>
<span id="cb8-358"><a href="#cb8-358" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span>:</span>
<span id="cb8-359"><a href="#cb8-359" aria-hidden="true" tabindex="-1"></a>                created_date <span class="op">=</span> <span class="bu">str</span>(row[<span class="st">&#39;created_at&#39;</span>])</span>
<span id="cb8-360"><a href="#cb8-360" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-361"><a href="#cb8-361" aria-hidden="true" tabindex="-1"></a>        content <span class="op">=</span> <span class="ss">f&quot;&quot;&quot;# </span><span class="sc">{</span>row[<span class="st">&#39;title&#39;</span>]<span class="sc">}</span></span>
<span id="cb8-362"><a href="#cb8-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-363"><a href="#cb8-363" aria-hidden="true" tabindex="-1"></a><span class="ss">**ID**: </span><span class="sc">{</span>row[<span class="st">&#39;conversation_id&#39;</span>]<span class="sc">}</span><span class="ss">  </span></span>
<span id="cb8-364"><a href="#cb8-364" aria-hidden="true" tabindex="-1"></a><span class="ss">**Categoria**: </span><span class="sc">{</span>row[<span class="st">&#39;category&#39;</span>]<span class="sc">}</span><span class="ss">  </span></span>
<span id="cb8-365"><a href="#cb8-365" aria-hidden="true" tabindex="-1"></a><span class="ss">**Data**: </span><span class="sc">{</span>created_date<span class="sc">}</span><span class="ss">  </span></span>
<span id="cb8-366"><a href="#cb8-366" aria-hidden="true" tabindex="-1"></a><span class="ss">**Total de Mensagens**: </span><span class="sc">{</span>row[<span class="st">&#39;num_messages&#39;</span>]<span class="sc">}</span><span class="ss">  </span></span>
<span id="cb8-367"><a href="#cb8-367" aria-hidden="true" tabindex="-1"></a><span class="ss">**Total de Palavras**: </span><span class="sc">{</span>row[<span class="st">&#39;total_words&#39;</span>]<span class="sc">}</span><span class="ss">  </span></span>
<span id="cb8-368"><a href="#cb8-368" aria-hidden="true" tabindex="-1"></a><span class="ss">**Total de Caracteres**: </span><span class="sc">{</span>row[<span class="st">&#39;total_chars&#39;</span>]<span class="sc">}</span><span class="ss">  </span></span>
<span id="cb8-369"><a href="#cb8-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-370"><a href="#cb8-370" aria-hidden="true" tabindex="-1"></a><span class="ss">---</span></span>
<span id="cb8-371"><a href="#cb8-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-372"><a href="#cb8-372" aria-hidden="true" tabindex="-1"></a><span class="ss">&quot;&quot;&quot;</span></span>
<span id="cb8-373"><a href="#cb8-373" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-374"><a href="#cb8-374" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> msg <span class="kw">in</span> messages:</span>
<span id="cb8-375"><a href="#cb8-375" aria-hidden="true" tabindex="-1"></a>            role_emoji <span class="op">=</span> <span class="st">&quot;üë§&quot;</span> <span class="cf">if</span> msg[<span class="st">&#39;role&#39;</span>] <span class="op">==</span> <span class="st">&#39;user&#39;</span> <span class="cf">else</span> <span class="st">&quot;ü§ñ&quot;</span></span>
<span id="cb8-376"><a href="#cb8-376" aria-hidden="true" tabindex="-1"></a>            role_name <span class="op">=</span> <span class="st">&quot;Usu√°rio&quot;</span> <span class="cf">if</span> msg[<span class="st">&#39;role&#39;</span>] <span class="op">==</span> <span class="st">&#39;user&#39;</span> <span class="cf">else</span> <span class="st">&quot;Grok&quot;</span></span>
<span id="cb8-377"><a href="#cb8-377" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb8-378"><a href="#cb8-378" aria-hidden="true" tabindex="-1"></a>            content <span class="op">+=</span> <span class="ss">f&quot;&quot;&quot;</span></span>
<span id="cb8-379"><a href="#cb8-379" aria-hidden="true" tabindex="-1"></a><span class="ss">## </span><span class="sc">{</span>role_emoji<span class="sc">}</span><span class="ss"> </span><span class="sc">{</span>role_name<span class="sc">}</span></span>
<span id="cb8-380"><a href="#cb8-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-381"><a href="#cb8-381" aria-hidden="true" tabindex="-1"></a><span class="sc">{</span>msg[<span class="st">&#39;content&#39;</span>]<span class="sc">}</span></span>
<span id="cb8-382"><a href="#cb8-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-383"><a href="#cb8-383" aria-hidden="true" tabindex="-1"></a><span class="ss">---</span></span>
<span id="cb8-384"><a href="#cb8-384" aria-hidden="true" tabindex="-1"></a><span class="ss">&quot;&quot;&quot;</span></span>
<span id="cb8-385"><a href="#cb8-385" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-386"><a href="#cb8-386" aria-hidden="true" tabindex="-1"></a>        content <span class="op">+=</span> <span class="ss">f&quot;&quot;&quot;</span></span>
<span id="cb8-387"><a href="#cb8-387" aria-hidden="true" tabindex="-1"></a><span class="ss">## üìä Estat√≠sticas Detalhadas</span></span>
<span id="cb8-388"><a href="#cb8-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-389"><a href="#cb8-389" aria-hidden="true" tabindex="-1"></a><span class="ss">- **Mensagens do usu√°rio**: </span><span class="sc">{</span>row[<span class="st">&#39;user_messages&#39;</span>]<span class="sc">}</span></span>
<span id="cb8-390"><a href="#cb8-390" aria-hidden="true" tabindex="-1"></a><span class="ss">- **Mensagens do Grok**: </span><span class="sc">{</span>row[<span class="st">&#39;assistant_messages&#39;</span>]<span class="sc">}</span><span class="ss"> </span></span>
<span id="cb8-391"><a href="#cb8-391" aria-hidden="true" tabindex="-1"></a><span class="ss">- **Palavras do usu√°rio**: </span><span class="sc">{</span>row[<span class="st">&#39;user_words&#39;</span>]<span class="sc">}</span></span>
<span id="cb8-392"><a href="#cb8-392" aria-hidden="true" tabindex="-1"></a><span class="ss">- **Palavras do Grok**: </span><span class="sc">{</span>row[<span class="st">&#39;assistant_words&#39;</span>]<span class="sc">}</span></span>
<span id="cb8-393"><a href="#cb8-393" aria-hidden="true" tabindex="-1"></a><span class="ss">- **Palavras por mensagem (m√©dia)**: </span><span class="sc">{</span>row[<span class="st">&#39;avg_words_per_message&#39;</span>]<span class="sc">:.1f}</span></span>
<span id="cb8-394"><a href="#cb8-394" aria-hidden="true" tabindex="-1"></a><span class="ss">- **Categoria**: </span><span class="sc">{</span>row[<span class="st">&#39;category&#39;</span>]<span class="sc">}</span></span>
<span id="cb8-395"><a href="#cb8-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-396"><a href="#cb8-396" aria-hidden="true" tabindex="-1"></a><span class="ss">*Exportado automaticamente em </span><span class="sc">{</span>datetime<span class="sc">.</span>now()<span class="sc">.</span>strftime(<span class="st">&#39;</span><span class="sc">%d</span><span class="st">/%m/%Y √†s %H:%M&#39;</span>)<span class="sc">}</span><span class="ss">*</span></span>
<span id="cb8-397"><a href="#cb8-397" aria-hidden="true" tabindex="-1"></a><span class="ss">&quot;&quot;&quot;</span></span>
<span id="cb8-398"><a href="#cb8-398" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> content</span>
<span id="cb8-399"><a href="#cb8-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-400"><a href="#cb8-400" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_searchable_index(<span class="va">self</span>, df):</span>
<span id="cb8-401"><a href="#cb8-401" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Cria √≠ndice pesquis√°vel em HTML semelhante ao ChatGPT&quot;&quot;&quot;</span></span>
<span id="cb8-402"><a href="#cb8-402" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;üéØ Criando √≠ndice pesquis√°vel...&quot;</span>)</span>
<span id="cb8-403"><a href="#cb8-403" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-404"><a href="#cb8-404" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Filtrar conversas n√£o gen√©ricas para o √≠ndice</span></span>
<span id="cb8-405"><a href="#cb8-405" aria-hidden="true" tabindex="-1"></a>        saved_conversations <span class="op">=</span> []</span>
<span id="cb8-406"><a href="#cb8-406" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> _, row <span class="kw">in</span> df.iterrows():</span>
<span id="cb8-407"><a href="#cb8-407" aria-hidden="true" tabindex="-1"></a>            safe_title <span class="op">=</span> <span class="va">self</span>.create_safe_filename(row[<span class="st">&#39;title&#39;</span>])</span>
<span id="cb8-408"><a href="#cb8-408" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.is_generic_title(safe_title):</span>
<span id="cb8-409"><a href="#cb8-409" aria-hidden="true" tabindex="-1"></a>                saved_conversations.append((_, row))</span>
<span id="cb8-410"><a href="#cb8-410" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-411"><a href="#cb8-411" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Estat√≠sticas</span></span>
<span id="cb8-412"><a href="#cb8-412" aria-hidden="true" tabindex="-1"></a>        total_conv <span class="op">=</span> <span class="bu">len</span>(saved_conversations)</span>
<span id="cb8-413"><a href="#cb8-413" aria-hidden="true" tabindex="-1"></a>        total_msgs <span class="op">=</span> <span class="bu">sum</span>(row[<span class="st">&#39;num_messages&#39;</span>] <span class="cf">for</span> _, row <span class="kw">in</span> saved_conversations)</span>
<span id="cb8-414"><a href="#cb8-414" aria-hidden="true" tabindex="-1"></a>        total_words <span class="op">=</span> <span class="bu">sum</span>(row[<span class="st">&#39;total_words&#39;</span>] <span class="cf">for</span> _, row <span class="kw">in</span> saved_conversations)</span>
<span id="cb8-415"><a href="#cb8-415" aria-hidden="true" tabindex="-1"></a>        total_chars <span class="op">=</span> <span class="bu">sum</span>(row[<span class="st">&#39;total_chars&#39;</span>] <span class="cf">for</span> _, row <span class="kw">in</span> saved_conversations)</span>
<span id="cb8-416"><a href="#cb8-416" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-417"><a href="#cb8-417" aria-hidden="true" tabindex="-1"></a>        html_content <span class="op">=</span> <span class="va">self</span>.generate_index_html(saved_conversations, total_conv, total_msgs, total_words, total_chars)</span>
<span id="cb8-418"><a href="#cb8-418" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-419"><a href="#cb8-419" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> <span class="bu">open</span>(<span class="va">self</span>.index_file, <span class="st">&quot;w&quot;</span>, encoding<span class="op">=</span><span class="st">&quot;utf-8&quot;</span>) <span class="im">as</span> f:</span>
<span id="cb8-420"><a href="#cb8-420" aria-hidden="true" tabindex="-1"></a>            f.write(html_content)</span>
<span id="cb8-421"><a href="#cb8-421" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-422"><a href="#cb8-422" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ √çndice pesquis√°vel criado: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>index_file<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb8-423"><a href="#cb8-423" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.index_file</span>
<span id="cb8-424"><a href="#cb8-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-425"><a href="#cb8-425" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> generate_index_html(<span class="va">self</span>, conversations, total_conv, total_msgs, total_words, total_chars):</span>
<span id="cb8-426"><a href="#cb8-426" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Gera HTML do √≠ndice pesquis√°vel&quot;&quot;&quot;</span></span>
<span id="cb8-427"><a href="#cb8-427" aria-hidden="true" tabindex="-1"></a>        current_date <span class="op">=</span> datetime.now().strftime(<span class="st">&#39;</span><span class="sc">%d</span><span class="st">/%m/%Y √†s %H:%M&#39;</span>)</span>
<span id="cb8-428"><a href="#cb8-428" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-429"><a href="#cb8-429" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="ss">f&quot;&quot;&quot;</span></span>
<span id="cb8-430"><a href="#cb8-430" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;!DOCTYPE html&gt;</span></span>
<span id="cb8-431"><a href="#cb8-431" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;html lang=&quot;pt&quot;&gt;</span></span>
<span id="cb8-432"><a href="#cb8-432" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;head&gt;</span></span>
<span id="cb8-433"><a href="#cb8-433" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span></span>
<span id="cb8-434"><a href="#cb8-434" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span></span>
<span id="cb8-435"><a href="#cb8-435" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;title&gt;ü§ñ Grok - Hist√≥rico Completo&lt;/title&gt;</span></span>
<span id="cb8-436"><a href="#cb8-436" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;style&gt;</span></span>
<span id="cb8-437"><a href="#cb8-437" aria-hidden="true" tabindex="-1"></a><span class="ss">        * </span><span class="ch">{{</span></span>
<span id="cb8-438"><a href="#cb8-438" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin: 0;</span></span>
<span id="cb8-439"><a href="#cb8-439" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 0;</span></span>
<span id="cb8-440"><a href="#cb8-440" aria-hidden="true" tabindex="-1"></a><span class="ss">            box-sizing: border-box;</span></span>
<span id="cb8-441"><a href="#cb8-441" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb8-442"><a href="#cb8-442" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb8-443"><a href="#cb8-443" aria-hidden="true" tabindex="-1"></a><span class="ss">        body </span><span class="ch">{{</span></span>
<span id="cb8-444"><a href="#cb8-444" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-family: &#39;Segoe UI&#39;, Tahoma, Geneva, Verdana, sans-serif;</span></span>
<span id="cb8-445"><a href="#cb8-445" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);</span></span>
<span id="cb8-446"><a href="#cb8-446" aria-hidden="true" tabindex="-1"></a><span class="ss">            min-height: 100vh;</span></span>
<span id="cb8-447"><a href="#cb8-447" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 20px;</span></span>
<span id="cb8-448"><a href="#cb8-448" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb8-449"><a href="#cb8-449" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb8-450"><a href="#cb8-450" aria-hidden="true" tabindex="-1"></a><span class="ss">        .container </span><span class="ch">{{</span></span>
<span id="cb8-451"><a href="#cb8-451" aria-hidden="true" tabindex="-1"></a><span class="ss">            max-width: 1400px;</span></span>
<span id="cb8-452"><a href="#cb8-452" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin: 0 auto;</span></span>
<span id="cb8-453"><a href="#cb8-453" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: white;</span></span>
<span id="cb8-454"><a href="#cb8-454" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 15px;</span></span>
<span id="cb8-455"><a href="#cb8-455" aria-hidden="true" tabindex="-1"></a><span class="ss">            box-shadow: 0 20px 40px rgba(0,0,0,0.1);</span></span>
<span id="cb8-456"><a href="#cb8-456" aria-hidden="true" tabindex="-1"></a><span class="ss">            overflow: hidden;</span></span>
<span id="cb8-457"><a href="#cb8-457" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb8-458"><a href="#cb8-458" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb8-459"><a href="#cb8-459" aria-hidden="true" tabindex="-1"></a><span class="ss">        .header </span><span class="ch">{{</span></span>
<span id="cb8-460"><a href="#cb8-460" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: linear-gradient(135deg, #2c3e50, #34495e);</span></span>
<span id="cb8-461"><a href="#cb8-461" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: white;</span></span>
<span id="cb8-462"><a href="#cb8-462" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 40px;</span></span>
<span id="cb8-463"><a href="#cb8-463" aria-hidden="true" tabindex="-1"></a><span class="ss">            text-align: center;</span></span>
<span id="cb8-464"><a href="#cb8-464" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb8-465"><a href="#cb8-465" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb8-466"><a href="#cb8-466" aria-hidden="true" tabindex="-1"></a><span class="ss">        .header h1 </span><span class="ch">{{</span></span>
<span id="cb8-467"><a href="#cb8-467" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 2.8em;</span></span>
<span id="cb8-468"><a href="#cb8-468" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-bottom: 10px;</span></span>
<span id="cb8-469"><a href="#cb8-469" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb8-470"><a href="#cb8-470" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb8-471"><a href="#cb8-471" aria-hidden="true" tabindex="-1"></a><span class="ss">        .stats </span><span class="ch">{{</span></span>
<span id="cb8-472"><a href="#cb8-472" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: flex;</span></span>
<span id="cb8-473"><a href="#cb8-473" aria-hidden="true" tabindex="-1"></a><span class="ss">            justify-content: center;</span></span>
<span id="cb8-474"><a href="#cb8-474" aria-hidden="true" tabindex="-1"></a><span class="ss">            gap: 30px;</span></span>
<span id="cb8-475"><a href="#cb8-475" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-top: 25px;</span></span>
<span id="cb8-476"><a href="#cb8-476" aria-hidden="true" tabindex="-1"></a><span class="ss">            flex-wrap: wrap;</span></span>
<span id="cb8-477"><a href="#cb8-477" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb8-478"><a href="#cb8-478" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb8-479"><a href="#cb8-479" aria-hidden="true" tabindex="-1"></a><span class="ss">        .stat-item </span><span class="ch">{{</span></span>
<span id="cb8-480"><a href="#cb8-480" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: rgba(255,255,255,0.15);</span></span>
<span id="cb8-481"><a href="#cb8-481" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 20px 30px;</span></span>
<span id="cb8-482"><a href="#cb8-482" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 12px;</span></span>
<span id="cb8-483"><a href="#cb8-483" aria-hidden="true" tabindex="-1"></a><span class="ss">            backdrop-filter: blur(10px);</span></span>
<span id="cb8-484"><a href="#cb8-484" aria-hidden="true" tabindex="-1"></a><span class="ss">            text-align: center;</span></span>
<span id="cb8-485"><a href="#cb8-485" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb8-486"><a href="#cb8-486" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb8-487"><a href="#cb8-487" aria-hidden="true" tabindex="-1"></a><span class="ss">        .stat-number </span><span class="ch">{{</span></span>
<span id="cb8-488"><a href="#cb8-488" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 2em;</span></span>
<span id="cb8-489"><a href="#cb8-489" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-weight: bold;</span></span>
<span id="cb8-490"><a href="#cb8-490" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: block;</span></span>
<span id="cb8-491"><a href="#cb8-491" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-bottom: 5px;</span></span>
<span id="cb8-492"><a href="#cb8-492" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb8-493"><a href="#cb8-493" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb8-494"><a href="#cb8-494" aria-hidden="true" tabindex="-1"></a><span class="ss">        .stat-label </span><span class="ch">{{</span></span>
<span id="cb8-495"><a href="#cb8-495" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.9em;</span></span>
<span id="cb8-496"><a href="#cb8-496" aria-hidden="true" tabindex="-1"></a><span class="ss">            opacity: 0.9;</span></span>
<span id="cb8-497"><a href="#cb8-497" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb8-498"><a href="#cb8-498" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb8-499"><a href="#cb8-499" aria-hidden="true" tabindex="-1"></a><span class="ss">        .search-section </span><span class="ch">{{</span></span>
<span id="cb8-500"><a href="#cb8-500" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 30px;</span></span>
<span id="cb8-501"><a href="#cb8-501" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #f8f9fa;</span></span>
<span id="cb8-502"><a href="#cb8-502" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-bottom: 1px solid #e9ecef;</span></span>
<span id="cb8-503"><a href="#cb8-503" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb8-504"><a href="#cb8-504" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb8-505"><a href="#cb8-505" aria-hidden="true" tabindex="-1"></a><span class="ss">        .search-box </span><span class="ch">{{</span></span>
<span id="cb8-506"><a href="#cb8-506" aria-hidden="true" tabindex="-1"></a><span class="ss">            width: 100%;</span></span>
<span id="cb8-507"><a href="#cb8-507" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 18px 25px;</span></span>
<span id="cb8-508"><a href="#cb8-508" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 16px;</span></span>
<span id="cb8-509"><a href="#cb8-509" aria-hidden="true" tabindex="-1"></a><span class="ss">            border: 2px solid #e9ecef;</span></span>
<span id="cb8-510"><a href="#cb8-510" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 25px;</span></span>
<span id="cb8-511"><a href="#cb8-511" aria-hidden="true" tabindex="-1"></a><span class="ss">            outline: none;</span></span>
<span id="cb8-512"><a href="#cb8-512" aria-hidden="true" tabindex="-1"></a><span class="ss">            transition: all 0.3s ease;</span></span>
<span id="cb8-513"><a href="#cb8-513" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 1.1em;</span></span>
<span id="cb8-514"><a href="#cb8-514" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb8-515"><a href="#cb8-515" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb8-516"><a href="#cb8-516" aria-hidden="true" tabindex="-1"></a><span class="ss">        .search-box:focus </span><span class="ch">{{</span></span>
<span id="cb8-517"><a href="#cb8-517" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-color: #667eea;</span></span>
<span id="cb8-518"><a href="#cb8-518" aria-hidden="true" tabindex="-1"></a><span class="ss">            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);</span></span>
<span id="cb8-519"><a href="#cb8-519" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb8-520"><a href="#cb8-520" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb8-521"><a href="#cb8-521" aria-hidden="true" tabindex="-1"></a><span class="ss">        .filters </span><span class="ch">{{</span></span>
<span id="cb8-522"><a href="#cb8-522" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: flex;</span></span>
<span id="cb8-523"><a href="#cb8-523" aria-hidden="true" tabindex="-1"></a><span class="ss">            gap: 12px;</span></span>
<span id="cb8-524"><a href="#cb8-524" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-top: 20px;</span></span>
<span id="cb8-525"><a href="#cb8-525" aria-hidden="true" tabindex="-1"></a><span class="ss">            flex-wrap: wrap;</span></span>
<span id="cb8-526"><a href="#cb8-526" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb8-527"><a href="#cb8-527" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb8-528"><a href="#cb8-528" aria-hidden="true" tabindex="-1"></a><span class="ss">        .filter-btn </span><span class="ch">{{</span></span>
<span id="cb8-529"><a href="#cb8-529" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 10px 20px;</span></span>
<span id="cb8-530"><a href="#cb8-530" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: white;</span></span>
<span id="cb8-531"><a href="#cb8-531" aria-hidden="true" tabindex="-1"></a><span class="ss">            border: 2px solid #e9ecef;</span></span>
<span id="cb8-532"><a href="#cb8-532" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 20px;</span></span>
<span id="cb8-533"><a href="#cb8-533" aria-hidden="true" tabindex="-1"></a><span class="ss">            cursor: pointer;</span></span>
<span id="cb8-534"><a href="#cb8-534" aria-hidden="true" tabindex="-1"></a><span class="ss">            transition: all 0.3s ease;</span></span>
<span id="cb8-535"><a href="#cb8-535" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-weight: 500;</span></span>
<span id="cb8-536"><a href="#cb8-536" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb8-537"><a href="#cb8-537" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb8-538"><a href="#cb8-538" aria-hidden="true" tabindex="-1"></a><span class="ss">        .filter-btn:hover, .filter-btn.active </span><span class="ch">{{</span></span>
<span id="cb8-539"><a href="#cb8-539" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #667eea;</span></span>
<span id="cb8-540"><a href="#cb8-540" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: white;</span></span>
<span id="cb8-541"><a href="#cb8-541" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-color: #667eea;</span></span>
<span id="cb8-542"><a href="#cb8-542" aria-hidden="true" tabindex="-1"></a><span class="ss">            transform: translateY(-2px);</span></span>
<span id="cb8-543"><a href="#cb8-543" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb8-544"><a href="#cb8-544" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb8-545"><a href="#cb8-545" aria-hidden="true" tabindex="-1"></a><span class="ss">        .conversations-grid </span><span class="ch">{{</span></span>
<span id="cb8-546"><a href="#cb8-546" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: grid;</span></span>
<span id="cb8-547"><a href="#cb8-547" aria-hidden="true" tabindex="-1"></a><span class="ss">            grid-template-columns: repeat(auto-fill, minmax(400px, 1fr));</span></span>
<span id="cb8-548"><a href="#cb8-548" aria-hidden="true" tabindex="-1"></a><span class="ss">            gap: 25px;</span></span>
<span id="cb8-549"><a href="#cb8-549" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 35px;</span></span>
<span id="cb8-550"><a href="#cb8-550" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb8-551"><a href="#cb8-551" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb8-552"><a href="#cb8-552" aria-hidden="true" tabindex="-1"></a><span class="ss">        .conversation-card </span><span class="ch">{{</span></span>
<span id="cb8-553"><a href="#cb8-553" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: white;</span></span>
<span id="cb8-554"><a href="#cb8-554" aria-hidden="true" tabindex="-1"></a><span class="ss">            border: 1px solid #e9ecef;</span></span>
<span id="cb8-555"><a href="#cb8-555" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 15px;</span></span>
<span id="cb8-556"><a href="#cb8-556" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 25px;</span></span>
<span id="cb8-557"><a href="#cb8-557" aria-hidden="true" tabindex="-1"></a><span class="ss">            transition: all 0.3s ease;</span></span>
<span id="cb8-558"><a href="#cb8-558" aria-hidden="true" tabindex="-1"></a><span class="ss">            cursor: pointer;</span></span>
<span id="cb8-559"><a href="#cb8-559" aria-hidden="true" tabindex="-1"></a><span class="ss">            position: relative;</span></span>
<span id="cb8-560"><a href="#cb8-560" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-left: 5px solid #667eea;</span></span>
<span id="cb8-561"><a href="#cb8-561" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb8-562"><a href="#cb8-562" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb8-563"><a href="#cb8-563" aria-hidden="true" tabindex="-1"></a><span class="ss">        .conversation-card:hover </span><span class="ch">{{</span></span>
<span id="cb8-564"><a href="#cb8-564" aria-hidden="true" tabindex="-1"></a><span class="ss">            transform: translateY(-8px);</span></span>
<span id="cb8-565"><a href="#cb8-565" aria-hidden="true" tabindex="-1"></a><span class="ss">            box-shadow: 0 15px 35px rgba(0,0,0,0.15);</span></span>
<span id="cb8-566"><a href="#cb8-566" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-left-color: #764ba2;</span></span>
<span id="cb8-567"><a href="#cb8-567" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb8-568"><a href="#cb8-568" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb8-569"><a href="#cb8-569" aria-hidden="true" tabindex="-1"></a><span class="ss">        .card-header </span><span class="ch">{{</span></span>
<span id="cb8-570"><a href="#cb8-570" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: flex;</span></span>
<span id="cb8-571"><a href="#cb8-571" aria-hidden="true" tabindex="-1"></a><span class="ss">            justify-content: space-between;</span></span>
<span id="cb8-572"><a href="#cb8-572" aria-hidden="true" tabindex="-1"></a><span class="ss">            align-items: flex-start;</span></span>
<span id="cb8-573"><a href="#cb8-573" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-bottom: 15px;</span></span>
<span id="cb8-574"><a href="#cb8-574" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb8-575"><a href="#cb8-575" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb8-576"><a href="#cb8-576" aria-hidden="true" tabindex="-1"></a><span class="ss">        .card-category </span><span class="ch">{{</span></span>
<span id="cb8-577"><a href="#cb8-577" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #667eea;</span></span>
<span id="cb8-578"><a href="#cb8-578" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: white;</span></span>
<span id="cb8-579"><a href="#cb8-579" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 6px 15px;</span></span>
<span id="cb8-580"><a href="#cb8-580" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 20px;</span></span>
<span id="cb8-581"><a href="#cb8-581" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.85em;</span></span>
<span id="cb8-582"><a href="#cb8-582" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-weight: 600;</span></span>
<span id="cb8-583"><a href="#cb8-583" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb8-584"><a href="#cb8-584" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb8-585"><a href="#cb8-585" aria-hidden="true" tabindex="-1"></a><span class="ss">        .card-number </span><span class="ch">{{</span></span>
<span id="cb8-586"><a href="#cb8-586" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 1.1em;</span></span>
<span id="cb8-587"><a href="#cb8-587" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-weight: bold;</span></span>
<span id="cb8-588"><a href="#cb8-588" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #868e96;</span></span>
<span id="cb8-589"><a href="#cb8-589" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb8-590"><a href="#cb8-590" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb8-591"><a href="#cb8-591" aria-hidden="true" tabindex="-1"></a><span class="ss">        .card-title </span><span class="ch">{{</span></span>
<span id="cb8-592"><a href="#cb8-592" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 1.3em;</span></span>
<span id="cb8-593"><a href="#cb8-593" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-weight: 700;</span></span>
<span id="cb8-594"><a href="#cb8-594" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #2c3e50;</span></span>
<span id="cb8-595"><a href="#cb8-595" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-bottom: 12px;</span></span>
<span id="cb8-596"><a href="#cb8-596" aria-hidden="true" tabindex="-1"></a><span class="ss">            line-height: 1.4;</span></span>
<span id="cb8-597"><a href="#cb8-597" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb8-598"><a href="#cb8-598" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb8-599"><a href="#cb8-599" aria-hidden="true" tabindex="-1"></a><span class="ss">        .card-preview </span><span class="ch">{{</span></span>
<span id="cb8-600"><a href="#cb8-600" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #6c757d;</span></span>
<span id="cb8-601"><a href="#cb8-601" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.95em;</span></span>
<span id="cb8-602"><a href="#cb8-602" aria-hidden="true" tabindex="-1"></a><span class="ss">            line-height: 1.5;</span></span>
<span id="cb8-603"><a href="#cb8-603" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-bottom: 20px;</span></span>
<span id="cb8-604"><a href="#cb8-604" aria-hidden="true" tabindex="-1"></a><span class="ss">            max-height: 80px;</span></span>
<span id="cb8-605"><a href="#cb8-605" aria-hidden="true" tabindex="-1"></a><span class="ss">            overflow: hidden;</span></span>
<span id="cb8-606"><a href="#cb8-606" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb8-607"><a href="#cb8-607" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb8-608"><a href="#cb8-608" aria-hidden="true" tabindex="-1"></a><span class="ss">        .card-stats </span><span class="ch">{{</span></span>
<span id="cb8-609"><a href="#cb8-609" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: grid;</span></span>
<span id="cb8-610"><a href="#cb8-610" aria-hidden="true" tabindex="-1"></a><span class="ss">            grid-template-columns: repeat(2, 1fr);</span></span>
<span id="cb8-611"><a href="#cb8-611" aria-hidden="true" tabindex="-1"></a><span class="ss">            gap: 10px;</span></span>
<span id="cb8-612"><a href="#cb8-612" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-bottom: 20px;</span></span>
<span id="cb8-613"><a href="#cb8-613" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb8-614"><a href="#cb8-614" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb8-615"><a href="#cb8-615" aria-hidden="true" tabindex="-1"></a><span class="ss">        .stat-box </span><span class="ch">{{</span></span>
<span id="cb8-616"><a href="#cb8-616" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #f8f9fa;</span></span>
<span id="cb8-617"><a href="#cb8-617" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 12px;</span></span>
<span id="cb8-618"><a href="#cb8-618" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 8px;</span></span>
<span id="cb8-619"><a href="#cb8-619" aria-hidden="true" tabindex="-1"></a><span class="ss">            text-align: center;</span></span>
<span id="cb8-620"><a href="#cb8-620" aria-hidden="true" tabindex="-1"></a><span class="ss">            border: 1px solid #e9ecef;</span></span>
<span id="cb8-621"><a href="#cb8-621" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb8-622"><a href="#cb8-622" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb8-623"><a href="#cb8-623" aria-hidden="true" tabindex="-1"></a><span class="ss">        .stat-value </span><span class="ch">{{</span></span>
<span id="cb8-624"><a href="#cb8-624" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 1.3em;</span></span>
<span id="cb8-625"><a href="#cb8-625" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-weight: bold;</span></span>
<span id="cb8-626"><a href="#cb8-626" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #2c3e50;</span></span>
<span id="cb8-627"><a href="#cb8-627" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: block;</span></span>
<span id="cb8-628"><a href="#cb8-628" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb8-629"><a href="#cb8-629" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb8-630"><a href="#cb8-630" aria-hidden="true" tabindex="-1"></a><span class="ss">        .stat-name </span><span class="ch">{{</span></span>
<span id="cb8-631"><a href="#cb8-631" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.8em;</span></span>
<span id="cb8-632"><a href="#cb8-632" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #7f8c8d;</span></span>
<span id="cb8-633"><a href="#cb8-633" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-top: 3px;</span></span>
<span id="cb8-634"><a href="#cb8-634" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb8-635"><a href="#cb8-635" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb8-636"><a href="#cb8-636" aria-hidden="true" tabindex="-1"></a><span class="ss">        .card-meta </span><span class="ch">{{</span></span>
<span id="cb8-637"><a href="#cb8-637" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: flex;</span></span>
<span id="cb8-638"><a href="#cb8-638" aria-hidden="true" tabindex="-1"></a><span class="ss">            justify-content: space-between;</span></span>
<span id="cb8-639"><a href="#cb8-639" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.85em;</span></span>
<span id="cb8-640"><a href="#cb8-640" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #868e96;</span></span>
<span id="cb8-641"><a href="#cb8-641" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-top: 1px solid #e9ecef;</span></span>
<span id="cb8-642"><a href="#cb8-642" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding-top: 15px;</span></span>
<span id="cb8-643"><a href="#cb8-643" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb8-644"><a href="#cb8-644" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb8-645"><a href="#cb8-645" aria-hidden="true" tabindex="-1"></a><span class="ss">        .card-actions </span><span class="ch">{{</span></span>
<span id="cb8-646"><a href="#cb8-646" aria-hidden="true" tabindex="-1"></a><span class="ss">            position: absolute;</span></span>
<span id="cb8-647"><a href="#cb8-647" aria-hidden="true" tabindex="-1"></a><span class="ss">            top: 20px;</span></span>
<span id="cb8-648"><a href="#cb8-648" aria-hidden="true" tabindex="-1"></a><span class="ss">            right: 20px;</span></span>
<span id="cb8-649"><a href="#cb8-649" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: flex;</span></span>
<span id="cb8-650"><a href="#cb8-650" aria-hidden="true" tabindex="-1"></a><span class="ss">            gap: 8px;</span></span>
<span id="cb8-651"><a href="#cb8-651" aria-hidden="true" tabindex="-1"></a><span class="ss">            opacity: 0;</span></span>
<span id="cb8-652"><a href="#cb8-652" aria-hidden="true" tabindex="-1"></a><span class="ss">            transition: opacity 0.3s ease;</span></span>
<span id="cb8-653"><a href="#cb8-653" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb8-654"><a href="#cb8-654" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb8-655"><a href="#cb8-655" aria-hidden="true" tabindex="-1"></a><span class="ss">        .conversation-card:hover .card-actions </span><span class="ch">{{</span></span>
<span id="cb8-656"><a href="#cb8-656" aria-hidden="true" tabindex="-1"></a><span class="ss">            opacity: 1;</span></span>
<span id="cb8-657"><a href="#cb8-657" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb8-658"><a href="#cb8-658" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb8-659"><a href="#cb8-659" aria-hidden="true" tabindex="-1"></a><span class="ss">        .action-btn </span><span class="ch">{{</span></span>
<span id="cb8-660"><a href="#cb8-660" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: white;</span></span>
<span id="cb8-661"><a href="#cb8-661" aria-hidden="true" tabindex="-1"></a><span class="ss">            border: 1px solid #e9ecef;</span></span>
<span id="cb8-662"><a href="#cb8-662" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 8px;</span></span>
<span id="cb8-663"><a href="#cb8-663" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 8px 12px;</span></span>
<span id="cb8-664"><a href="#cb8-664" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.85em;</span></span>
<span id="cb8-665"><a href="#cb8-665" aria-hidden="true" tabindex="-1"></a><span class="ss">            cursor: pointer;</span></span>
<span id="cb8-666"><a href="#cb8-666" aria-hidden="true" tabindex="-1"></a><span class="ss">            transition: all 0.3s ease;</span></span>
<span id="cb8-667"><a href="#cb8-667" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-weight: 600;</span></span>
<span id="cb8-668"><a href="#cb8-668" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb8-669"><a href="#cb8-669" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb8-670"><a href="#cb8-670" aria-hidden="true" tabindex="-1"></a><span class="ss">        .action-btn:hover </span><span class="ch">{{</span></span>
<span id="cb8-671"><a href="#cb8-671" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #667eea;</span></span>
<span id="cb8-672"><a href="#cb8-672" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: white;</span></span>
<span id="cb8-673"><a href="#cb8-673" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-color: #667eea;</span></span>
<span id="cb8-674"><a href="#cb8-674" aria-hidden="true" tabindex="-1"></a><span class="ss">            transform: scale(1.05);</span></span>
<span id="cb8-675"><a href="#cb8-675" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb8-676"><a href="#cb8-676" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb8-677"><a href="#cb8-677" aria-hidden="true" tabindex="-1"></a><span class="ss">        .btn-md </span><span class="ch">{{</span></span>
<span id="cb8-678"><a href="#cb8-678" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #27ae60;</span></span>
<span id="cb8-679"><a href="#cb8-679" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: white;</span></span>
<span id="cb8-680"><a href="#cb8-680" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-color: #27ae60;</span></span>
<span id="cb8-681"><a href="#cb8-681" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb8-682"><a href="#cb8-682" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb8-683"><a href="#cb8-683" aria-hidden="true" tabindex="-1"></a><span class="ss">        .btn-pdf </span><span class="ch">{{</span></span>
<span id="cb8-684"><a href="#cb8-684" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #e74c3c;</span></span>
<span id="cb8-685"><a href="#cb8-685" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: white;</span></span>
<span id="cb8-686"><a href="#cb8-686" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-color: #e74c3c;</span></span>
<span id="cb8-687"><a href="#cb8-687" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb8-688"><a href="#cb8-688" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb8-689"><a href="#cb8-689" aria-hidden="true" tabindex="-1"></a><span class="ss">        .no-results </span><span class="ch">{{</span></span>
<span id="cb8-690"><a href="#cb8-690" aria-hidden="true" tabindex="-1"></a><span class="ss">            grid-column: 1 / -1;</span></span>
<span id="cb8-691"><a href="#cb8-691" aria-hidden="true" tabindex="-1"></a><span class="ss">            text-align: center;</span></span>
<span id="cb8-692"><a href="#cb8-692" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 60px;</span></span>
<span id="cb8-693"><a href="#cb8-693" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #6c757d;</span></span>
<span id="cb8-694"><a href="#cb8-694" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 1.2em;</span></span>
<span id="cb8-695"><a href="#cb8-695" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb8-696"><a href="#cb8-696" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb8-697"><a href="#cb8-697" aria-hidden="true" tabindex="-1"></a><span class="ss">        .sort-info </span><span class="ch">{{</span></span>
<span id="cb8-698"><a href="#cb8-698" aria-hidden="true" tabindex="-1"></a><span class="ss">            text-align: center;</span></span>
<span id="cb8-699"><a href="#cb8-699" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 15px;</span></span>
<span id="cb8-700"><a href="#cb8-700" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #e8f4f8;</span></span>
<span id="cb8-701"><a href="#cb8-701" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #2c3e50;</span></span>
<span id="cb8-702"><a href="#cb8-702" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-weight: 500;</span></span>
<span id="cb8-703"><a href="#cb8-703" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-bottom: 1px solid #bdc3c7;</span></span>
<span id="cb8-704"><a href="#cb8-704" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb8-705"><a href="#cb8-705" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb8-706"><a href="#cb8-706" aria-hidden="true" tabindex="-1"></a><span class="ss">        .footer </span><span class="ch">{{</span></span>
<span id="cb8-707"><a href="#cb8-707" aria-hidden="true" tabindex="-1"></a><span class="ss">            text-align: center;</span></span>
<span id="cb8-708"><a href="#cb8-708" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 25px;</span></span>
<span id="cb8-709"><a href="#cb8-709" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #f8f9fa;</span></span>
<span id="cb8-710"><a href="#cb8-710" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #6c757d;</span></span>
<span id="cb8-711"><a href="#cb8-711" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-top: 1px solid #e9ecef;</span></span>
<span id="cb8-712"><a href="#cb8-712" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb8-713"><a href="#cb8-713" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb8-714"><a href="#cb8-714" aria-hidden="true" tabindex="-1"></a><span class="ss">        @media (max-width: 768px) </span><span class="ch">{{</span></span>
<span id="cb8-715"><a href="#cb8-715" aria-hidden="true" tabindex="-1"></a><span class="ss">            .conversations-grid </span><span class="ch">{{</span></span>
<span id="cb8-716"><a href="#cb8-716" aria-hidden="true" tabindex="-1"></a><span class="ss">                grid-template-columns: 1fr;</span></span>
<span id="cb8-717"><a href="#cb8-717" aria-hidden="true" tabindex="-1"></a><span class="ss">                padding: 20px;</span></span>
<span id="cb8-718"><a href="#cb8-718" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span><span class="ch">}}</span></span>
<span id="cb8-719"><a href="#cb8-719" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span></span>
<span id="cb8-720"><a href="#cb8-720" aria-hidden="true" tabindex="-1"></a><span class="ss">            .header h1 </span><span class="ch">{{</span></span>
<span id="cb8-721"><a href="#cb8-721" aria-hidden="true" tabindex="-1"></a><span class="ss">                font-size: 2.2em;</span></span>
<span id="cb8-722"><a href="#cb8-722" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span><span class="ch">}}</span></span>
<span id="cb8-723"><a href="#cb8-723" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span></span>
<span id="cb8-724"><a href="#cb8-724" aria-hidden="true" tabindex="-1"></a><span class="ss">            .stats </span><span class="ch">{{</span></span>
<span id="cb8-725"><a href="#cb8-725" aria-hidden="true" tabindex="-1"></a><span class="ss">                gap: 15px;</span></span>
<span id="cb8-726"><a href="#cb8-726" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span><span class="ch">}}</span></span>
<span id="cb8-727"><a href="#cb8-727" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span></span>
<span id="cb8-728"><a href="#cb8-728" aria-hidden="true" tabindex="-1"></a><span class="ss">            .stat-item </span><span class="ch">{{</span></span>
<span id="cb8-729"><a href="#cb8-729" aria-hidden="true" tabindex="-1"></a><span class="ss">                padding: 15px 20px;</span></span>
<span id="cb8-730"><a href="#cb8-730" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span><span class="ch">}}</span></span>
<span id="cb8-731"><a href="#cb8-731" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb8-732"><a href="#cb8-732" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;/style&gt;</span></span>
<span id="cb8-733"><a href="#cb8-733" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;/head&gt;</span></span>
<span id="cb8-734"><a href="#cb8-734" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;body&gt;</span></span>
<span id="cb8-735"><a href="#cb8-735" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;div class=&quot;container&quot;&gt;</span></span>
<span id="cb8-736"><a href="#cb8-736" aria-hidden="true" tabindex="-1"></a><span class="ss">        &lt;div class=&quot;header&quot;&gt;</span></span>
<span id="cb8-737"><a href="#cb8-737" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;h1&gt;ü§ñ Grok - Hist√≥rico Completo&lt;/h1&gt;</span></span>
<span id="cb8-738"><a href="#cb8-738" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;p&gt;Exporta√ß√£o completa com busca e categoriza√ß√£o&lt;/p&gt;</span></span>
<span id="cb8-739"><a href="#cb8-739" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;div class=&quot;stats&quot;&gt;</span></span>
<span id="cb8-740"><a href="#cb8-740" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;div class=&quot;stat-item&quot;&gt;</span></span>
<span id="cb8-741"><a href="#cb8-741" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;span class=&quot;stat-number&quot;&gt;</span><span class="sc">{</span>total_conv<span class="sc">}</span><span class="ss">&lt;/span&gt;</span></span>
<span id="cb8-742"><a href="#cb8-742" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;span class=&quot;stat-label&quot;&gt;Conversas&lt;/span&gt;</span></span>
<span id="cb8-743"><a href="#cb8-743" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;/div&gt;</span></span>
<span id="cb8-744"><a href="#cb8-744" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;div class=&quot;stat-item&quot;&gt;</span></span>
<span id="cb8-745"><a href="#cb8-745" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;span class=&quot;stat-number&quot;&gt;</span><span class="sc">{</span>total_msgs<span class="sc">}</span><span class="ss">&lt;/span&gt;</span></span>
<span id="cb8-746"><a href="#cb8-746" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;span class=&quot;stat-label&quot;&gt;Mensagens&lt;/span&gt;</span></span>
<span id="cb8-747"><a href="#cb8-747" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;/div&gt;</span></span>
<span id="cb8-748"><a href="#cb8-748" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;div class=&quot;stat-item&quot;&gt;</span></span>
<span id="cb8-749"><a href="#cb8-749" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;span class=&quot;stat-number&quot;&gt;</span><span class="sc">{</span>total_words<span class="sc">:,}</span><span class="ss">&lt;/span&gt;</span></span>
<span id="cb8-750"><a href="#cb8-750" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;span class=&quot;stat-label&quot;&gt;Palavras&lt;/span&gt;</span></span>
<span id="cb8-751"><a href="#cb8-751" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;/div&gt;</span></span>
<span id="cb8-752"><a href="#cb8-752" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;div class=&quot;stat-item&quot;&gt;</span></span>
<span id="cb8-753"><a href="#cb8-753" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;span class=&quot;stat-number&quot;&gt;</span><span class="sc">{</span>total_chars<span class="sc">:,}</span><span class="ss">&lt;/span&gt;</span></span>
<span id="cb8-754"><a href="#cb8-754" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;span class=&quot;stat-label&quot;&gt;Caracteres&lt;/span&gt;</span></span>
<span id="cb8-755"><a href="#cb8-755" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;/div&gt;</span></span>
<span id="cb8-756"><a href="#cb8-756" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;/div&gt;</span></span>
<span id="cb8-757"><a href="#cb8-757" aria-hidden="true" tabindex="-1"></a><span class="ss">        &lt;/div&gt;</span></span>
<span id="cb8-758"><a href="#cb8-758" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb8-759"><a href="#cb8-759" aria-hidden="true" tabindex="-1"></a><span class="ss">        &lt;div class=&quot;sort-info&quot;&gt;</span></span>
<span id="cb8-760"><a href="#cb8-760" aria-hidden="true" tabindex="-1"></a><span class="ss">            üìÖ Ordenado por: Mais Recente ‚Üí Mais Antigo</span></span>
<span id="cb8-761"><a href="#cb8-761" aria-hidden="true" tabindex="-1"></a><span class="ss">        &lt;/div&gt;</span></span>
<span id="cb8-762"><a href="#cb8-762" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb8-763"><a href="#cb8-763" aria-hidden="true" tabindex="-1"></a><span class="ss">        &lt;div class=&quot;search-section&quot;&gt;</span></span>
<span id="cb8-764"><a href="#cb8-764" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;input type=&quot;text&quot; id=&quot;searchInput&quot; class=&quot;search-box&quot; placeholder=&quot;üîç Pesquisar por t√≠tulo, conte√∫do, categoria...&quot;&gt;</span></span>
<span id="cb8-765"><a href="#cb8-765" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;div class=&quot;filters&quot;&gt;</span></span>
<span id="cb8-766"><a href="#cb8-766" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;button class=&quot;filter-btn active&quot; data-filter=&quot;all&quot;&gt;Todas&lt;/button&gt;</span></span>
<span id="cb8-767"><a href="#cb8-767" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;button class=&quot;filter-btn&quot; data-filter=&quot;Programa√ß√£o&quot;&gt;Programa√ß√£o&lt;/button&gt;</span></span>
<span id="cb8-768"><a href="#cb8-768" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;button class=&quot;filter-btn&quot; data-filter=&quot;Sistemas&quot;&gt;Sistemas&lt;/button&gt;</span></span>
<span id="cb8-769"><a href="#cb8-769" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;button class=&quot;filter-btn&quot; data-filter=&quot;IA&quot;&gt;IA&lt;/button&gt;</span></span>
<span id="cb8-770"><a href="#cb8-770" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;button class=&quot;filter-btn&quot; data-filter=&quot;Dados&quot;&gt;Dados&lt;/button&gt;</span></span>
<span id="cb8-771"><a href="#cb8-771" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;button class=&quot;filter-btn&quot; data-filter=&quot;Geral&quot;&gt;Geral&lt;/button&gt;</span></span>
<span id="cb8-772"><a href="#cb8-772" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;/div&gt;</span></span>
<span id="cb8-773"><a href="#cb8-773" aria-hidden="true" tabindex="-1"></a><span class="ss">        &lt;/div&gt;</span></span>
<span id="cb8-774"><a href="#cb8-774" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb8-775"><a href="#cb8-775" aria-hidden="true" tabindex="-1"></a><span class="ss">        &lt;div class=&quot;conversations-grid&quot; id=&quot;conversationsGrid&quot;&gt;</span></span>
<span id="cb8-776"><a href="#cb8-776" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span><span class="sc">{</span><span class="st">&quot;&quot;</span><span class="sc">.</span>join(<span class="va">self</span>.generate_conversation_cards(conversations))<span class="sc">}</span></span>
<span id="cb8-777"><a href="#cb8-777" aria-hidden="true" tabindex="-1"></a><span class="ss">        &lt;/div&gt;</span></span>
<span id="cb8-778"><a href="#cb8-778" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb8-779"><a href="#cb8-779" aria-hidden="true" tabindex="-1"></a><span class="ss">        &lt;div class=&quot;footer&quot;&gt;</span></span>
<span id="cb8-780"><a href="#cb8-780" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;p&gt;Dashboard gerado automaticamente em </span><span class="sc">{</span>current_date<span class="sc">}</span><span class="ss">&lt;/p&gt;</span></span>
<span id="cb8-781"><a href="#cb8-781" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;p&gt;Grok Analysis Tool ‚Ä¢ Total de </span><span class="sc">{</span>total_conv<span class="sc">}</span><span class="ss"> conversas processadas&lt;/p&gt;</span></span>
<span id="cb8-782"><a href="#cb8-782" aria-hidden="true" tabindex="-1"></a><span class="ss">        &lt;/div&gt;</span></span>
<span id="cb8-783"><a href="#cb8-783" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;/div&gt;</span></span>
<span id="cb8-784"><a href="#cb8-784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-785"><a href="#cb8-785" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;script&gt;</span></span>
<span id="cb8-786"><a href="#cb8-786" aria-hidden="true" tabindex="-1"></a><span class="ss">        // Fun√ß√£o de busca em tempo real</span></span>
<span id="cb8-787"><a href="#cb8-787" aria-hidden="true" tabindex="-1"></a><span class="ss">        document.getElementById(&#39;searchInput&#39;).addEventListener(&#39;input&#39;, function(e) </span><span class="ch">{{</span></span>
<span id="cb8-788"><a href="#cb8-788" aria-hidden="true" tabindex="-1"></a><span class="ss">            const searchTerm = e.target.value.toLowerCase();</span></span>
<span id="cb8-789"><a href="#cb8-789" aria-hidden="true" tabindex="-1"></a><span class="ss">            const cards = document.querySelectorAll(&#39;.conversation-card&#39;);</span></span>
<span id="cb8-790"><a href="#cb8-790" aria-hidden="true" tabindex="-1"></a><span class="ss">            let visibleCount = 0;</span></span>
<span id="cb8-791"><a href="#cb8-791" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span></span>
<span id="cb8-792"><a href="#cb8-792" aria-hidden="true" tabindex="-1"></a><span class="ss">            cards.forEach(card =&gt; </span><span class="ch">{{</span></span>
<span id="cb8-793"><a href="#cb8-793" aria-hidden="true" tabindex="-1"></a><span class="ss">                const title = card.getAttribute(&#39;data-title&#39;).toLowerCase();</span></span>
<span id="cb8-794"><a href="#cb8-794" aria-hidden="true" tabindex="-1"></a><span class="ss">                const content = card.getAttribute(&#39;data-content&#39;).toLowerCase();</span></span>
<span id="cb8-795"><a href="#cb8-795" aria-hidden="true" tabindex="-1"></a><span class="ss">                const category = card.getAttribute(&#39;data-category&#39;).toLowerCase();</span></span>
<span id="cb8-796"><a href="#cb8-796" aria-hidden="true" tabindex="-1"></a><span class="ss">                const number = card.getAttribute(&#39;data-number&#39;).toLowerCase();</span></span>
<span id="cb8-797"><a href="#cb8-797" aria-hidden="true" tabindex="-1"></a><span class="ss">                </span></span>
<span id="cb8-798"><a href="#cb8-798" aria-hidden="true" tabindex="-1"></a><span class="ss">                if (title.includes(searchTerm) || content.includes(searchTerm) || </span></span>
<span id="cb8-799"><a href="#cb8-799" aria-hidden="true" tabindex="-1"></a><span class="ss">                    category.includes(searchTerm) || number.includes(searchTerm)) </span><span class="ch">{{</span></span>
<span id="cb8-800"><a href="#cb8-800" aria-hidden="true" tabindex="-1"></a><span class="ss">                    card.style.display = &#39;block&#39;;</span></span>
<span id="cb8-801"><a href="#cb8-801" aria-hidden="true" tabindex="-1"></a><span class="ss">                    visibleCount++;</span></span>
<span id="cb8-802"><a href="#cb8-802" aria-hidden="true" tabindex="-1"></a><span class="ss">                </span><span class="ch">}}</span><span class="ss"> else </span><span class="ch">{{</span></span>
<span id="cb8-803"><a href="#cb8-803" aria-hidden="true" tabindex="-1"></a><span class="ss">                    card.style.display = &#39;none&#39;;</span></span>
<span id="cb8-804"><a href="#cb8-804" aria-hidden="true" tabindex="-1"></a><span class="ss">                </span><span class="ch">}}</span></span>
<span id="cb8-805"><a href="#cb8-805" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span><span class="ch">}}</span><span class="ss">);</span></span>
<span id="cb8-806"><a href="#cb8-806" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span></span>
<span id="cb8-807"><a href="#cb8-807" aria-hidden="true" tabindex="-1"></a><span class="ss">            // Atualizar contador</span></span>
<span id="cb8-808"><a href="#cb8-808" aria-hidden="true" tabindex="-1"></a><span class="ss">            document.querySelectorAll(&#39;.stat-item&#39;)[0].querySelector(&#39;.stat-number&#39;).textContent = visibleCount;</span></span>
<span id="cb8-809"><a href="#cb8-809" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span><span class="ss">);</span></span>
<span id="cb8-810"><a href="#cb8-810" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb8-811"><a href="#cb8-811" aria-hidden="true" tabindex="-1"></a><span class="ss">        // Filtros por categoria</span></span>
<span id="cb8-812"><a href="#cb8-812" aria-hidden="true" tabindex="-1"></a><span class="ss">        document.querySelectorAll(&#39;.filter-btn&#39;).forEach(btn =&gt; </span><span class="ch">{{</span></span>
<span id="cb8-813"><a href="#cb8-813" aria-hidden="true" tabindex="-1"></a><span class="ss">            btn.addEventListener(&#39;click&#39;, function() </span><span class="ch">{{</span></span>
<span id="cb8-814"><a href="#cb8-814" aria-hidden="true" tabindex="-1"></a><span class="ss">                document.querySelectorAll(&#39;.filter-btn&#39;).forEach(b =&gt; b.classList.remove(&#39;active&#39;));</span></span>
<span id="cb8-815"><a href="#cb8-815" aria-hidden="true" tabindex="-1"></a><span class="ss">                this.classList.add(&#39;active&#39;);</span></span>
<span id="cb8-816"><a href="#cb8-816" aria-hidden="true" tabindex="-1"></a><span class="ss">                </span></span>
<span id="cb8-817"><a href="#cb8-817" aria-hidden="true" tabindex="-1"></a><span class="ss">                const filter = this.getAttribute(&#39;data-filter&#39;);</span></span>
<span id="cb8-818"><a href="#cb8-818" aria-hidden="true" tabindex="-1"></a><span class="ss">                const cards = document.querySelectorAll(&#39;.conversation-card&#39;);</span></span>
<span id="cb8-819"><a href="#cb8-819" aria-hidden="true" tabindex="-1"></a><span class="ss">                </span></span>
<span id="cb8-820"><a href="#cb8-820" aria-hidden="true" tabindex="-1"></a><span class="ss">                cards.forEach(card =&gt; </span><span class="ch">{{</span></span>
<span id="cb8-821"><a href="#cb8-821" aria-hidden="true" tabindex="-1"></a><span class="ss">                    const category = card.getAttribute(&#39;data-category&#39;);</span></span>
<span id="cb8-822"><a href="#cb8-822" aria-hidden="true" tabindex="-1"></a><span class="ss">                    if (filter === &#39;all&#39; || category === filter) </span><span class="ch">{{</span></span>
<span id="cb8-823"><a href="#cb8-823" aria-hidden="true" tabindex="-1"></a><span class="ss">                        card.style.display = &#39;block&#39;;</span></span>
<span id="cb8-824"><a href="#cb8-824" aria-hidden="true" tabindex="-1"></a><span class="ss">                    </span><span class="ch">}}</span><span class="ss"> else </span><span class="ch">{{</span></span>
<span id="cb8-825"><a href="#cb8-825" aria-hidden="true" tabindex="-1"></a><span class="ss">                        card.style.display = &#39;none&#39;;</span></span>
<span id="cb8-826"><a href="#cb8-826" aria-hidden="true" tabindex="-1"></a><span class="ss">                    </span><span class="ch">}}</span></span>
<span id="cb8-827"><a href="#cb8-827" aria-hidden="true" tabindex="-1"></a><span class="ss">                </span><span class="ch">}}</span><span class="ss">);</span></span>
<span id="cb8-828"><a href="#cb8-828" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span><span class="ch">}}</span><span class="ss">);</span></span>
<span id="cb8-829"><a href="#cb8-829" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span><span class="ss">);</span></span>
<span id="cb8-830"><a href="#cb8-830" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb8-831"><a href="#cb8-831" aria-hidden="true" tabindex="-1"></a><span class="ss">        // Abrir arquivo MD</span></span>
<span id="cb8-832"><a href="#cb8-832" aria-hidden="true" tabindex="-1"></a><span class="ss">        function openMD(filename) </span><span class="ch">{{</span></span>
<span id="cb8-833"><a href="#cb8-833" aria-hidden="true" tabindex="-1"></a><span class="ss">            window.open(&#39;markdown/&#39; + filename, &#39;_blank&#39;);</span></span>
<span id="cb8-834"><a href="#cb8-834" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb8-835"><a href="#cb8-835" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb8-836"><a href="#cb8-836" aria-hidden="true" tabindex="-1"></a><span class="ss">        // Abrir arquivo PDF</span></span>
<span id="cb8-837"><a href="#cb8-837" aria-hidden="true" tabindex="-1"></a><span class="ss">        function openPDF(filename) </span><span class="ch">{{</span></span>
<span id="cb8-838"><a href="#cb8-838" aria-hidden="true" tabindex="-1"></a><span class="ss">            const pdfFile = filename.replace(&#39;.md&#39;, &#39;.pdf&#39;);</span></span>
<span id="cb8-839"><a href="#cb8-839" aria-hidden="true" tabindex="-1"></a><span class="ss">            window.open(&#39;pdf/conversas/&#39; + pdfFile, &#39;_blank&#39;);</span></span>
<span id="cb8-840"><a href="#cb8-840" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb8-841"><a href="#cb8-841" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb8-842"><a href="#cb8-842" aria-hidden="true" tabindex="-1"></a><span class="ss">        // Click no card abre o MD</span></span>
<span id="cb8-843"><a href="#cb8-843" aria-hidden="true" tabindex="-1"></a><span class="ss">        document.querySelectorAll(&#39;.conversation-card&#39;).forEach(card =&gt; </span><span class="ch">{{</span></span>
<span id="cb8-844"><a href="#cb8-844" aria-hidden="true" tabindex="-1"></a><span class="ss">            card.addEventListener(&#39;click&#39;, function(e) </span><span class="ch">{{</span></span>
<span id="cb8-845"><a href="#cb8-845" aria-hidden="true" tabindex="-1"></a><span class="ss">                if (!e.target.classList.contains(&#39;action-btn&#39;)) </span><span class="ch">{{</span></span>
<span id="cb8-846"><a href="#cb8-846" aria-hidden="true" tabindex="-1"></a><span class="ss">                    const filename = this.getAttribute(&#39;data-filename&#39;);</span></span>
<span id="cb8-847"><a href="#cb8-847" aria-hidden="true" tabindex="-1"></a><span class="ss">                    openMD(filename);</span></span>
<span id="cb8-848"><a href="#cb8-848" aria-hidden="true" tabindex="-1"></a><span class="ss">                </span><span class="ch">}}</span></span>
<span id="cb8-849"><a href="#cb8-849" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span><span class="ch">}}</span><span class="ss">);</span></span>
<span id="cb8-850"><a href="#cb8-850" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span><span class="ss">);</span></span>
<span id="cb8-851"><a href="#cb8-851" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb8-852"><a href="#cb8-852" aria-hidden="true" tabindex="-1"></a><span class="ss">        // Anima√ß√£o de entrada</span></span>
<span id="cb8-853"><a href="#cb8-853" aria-hidden="true" tabindex="-1"></a><span class="ss">        document.addEventListener(&#39;DOMContentLoaded&#39;, function() </span><span class="ch">{{</span></span>
<span id="cb8-854"><a href="#cb8-854" aria-hidden="true" tabindex="-1"></a><span class="ss">            const cards = document.querySelectorAll(&#39;.conversation-card&#39;);</span></span>
<span id="cb8-855"><a href="#cb8-855" aria-hidden="true" tabindex="-1"></a><span class="ss">            cards.forEach((card, index) =&gt; </span><span class="ch">{{</span></span>
<span id="cb8-856"><a href="#cb8-856" aria-hidden="true" tabindex="-1"></a><span class="ss">                card.style.animationDelay = (index * 0.1) + &#39;s&#39;;</span></span>
<span id="cb8-857"><a href="#cb8-857" aria-hidden="true" tabindex="-1"></a><span class="ss">                card.style.opacity = &#39;0&#39;;</span></span>
<span id="cb8-858"><a href="#cb8-858" aria-hidden="true" tabindex="-1"></a><span class="ss">                card.style.animation = &#39;fadeInUp 0.6s ease forwards&#39;;</span></span>
<span id="cb8-859"><a href="#cb8-859" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span><span class="ch">}}</span><span class="ss">);</span></span>
<span id="cb8-860"><a href="#cb8-860" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span><span class="ss">);</span></span>
<span id="cb8-861"><a href="#cb8-861" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb8-862"><a href="#cb8-862" aria-hidden="true" tabindex="-1"></a><span class="ss">        // Anima√ß√£o CSS</span></span>
<span id="cb8-863"><a href="#cb8-863" aria-hidden="true" tabindex="-1"></a><span class="ss">        const style = document.createElement(&#39;style&#39;);</span></span>
<span id="cb8-864"><a href="#cb8-864" aria-hidden="true" tabindex="-1"></a><span class="ss">        style.textContent = `</span></span>
<span id="cb8-865"><a href="#cb8-865" aria-hidden="true" tabindex="-1"></a><span class="ss">            @keyframes fadeInUp </span><span class="ch">{{</span></span>
<span id="cb8-866"><a href="#cb8-866" aria-hidden="true" tabindex="-1"></a><span class="ss">                from </span><span class="ch">{{</span></span>
<span id="cb8-867"><a href="#cb8-867" aria-hidden="true" tabindex="-1"></a><span class="ss">                    opacity: 0;</span></span>
<span id="cb8-868"><a href="#cb8-868" aria-hidden="true" tabindex="-1"></a><span class="ss">                    transform: translateY(30px);</span></span>
<span id="cb8-869"><a href="#cb8-869" aria-hidden="true" tabindex="-1"></a><span class="ss">                </span><span class="ch">}}</span></span>
<span id="cb8-870"><a href="#cb8-870" aria-hidden="true" tabindex="-1"></a><span class="ss">                to </span><span class="ch">{{</span></span>
<span id="cb8-871"><a href="#cb8-871" aria-hidden="true" tabindex="-1"></a><span class="ss">                    opacity: 1;</span></span>
<span id="cb8-872"><a href="#cb8-872" aria-hidden="true" tabindex="-1"></a><span class="ss">                    transform: translateY(0);</span></span>
<span id="cb8-873"><a href="#cb8-873" aria-hidden="true" tabindex="-1"></a><span class="ss">                </span><span class="ch">}}</span></span>
<span id="cb8-874"><a href="#cb8-874" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span><span class="ch">}}</span></span>
<span id="cb8-875"><a href="#cb8-875" aria-hidden="true" tabindex="-1"></a><span class="ss">        `;</span></span>
<span id="cb8-876"><a href="#cb8-876" aria-hidden="true" tabindex="-1"></a><span class="ss">        document.head.appendChild(style);</span></span>
<span id="cb8-877"><a href="#cb8-877" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;/script&gt;</span></span>
<span id="cb8-878"><a href="#cb8-878" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;/body&gt;</span></span>
<span id="cb8-879"><a href="#cb8-879" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;/html&gt;</span></span>
<span id="cb8-880"><a href="#cb8-880" aria-hidden="true" tabindex="-1"></a><span class="ss">&quot;&quot;&quot;</span></span>
<span id="cb8-881"><a href="#cb8-881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-882"><a href="#cb8-882" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> generate_conversation_cards(<span class="va">self</span>, conversations):</span>
<span id="cb8-883"><a href="#cb8-883" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Gera cards de conversa para o √≠ndice&quot;&quot;&quot;</span></span>
<span id="cb8-884"><a href="#cb8-884" aria-hidden="true" tabindex="-1"></a>        cards <span class="op">=</span> []</span>
<span id="cb8-885"><a href="#cb8-885" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> idx, (_, row) <span class="kw">in</span> <span class="bu">enumerate</span>(conversations, <span class="dv">1</span>):</span>
<span id="cb8-886"><a href="#cb8-886" aria-hidden="true" tabindex="-1"></a>            safe_title <span class="op">=</span> <span class="va">self</span>.create_safe_filename(row[<span class="st">&#39;title&#39;</span>])</span>
<span id="cb8-887"><a href="#cb8-887" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb8-888"><a href="#cb8-888" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Formatar data</span></span>
<span id="cb8-889"><a href="#cb8-889" aria-hidden="true" tabindex="-1"></a>            created_date <span class="op">=</span> <span class="st">&quot;&quot;</span></span>
<span id="cb8-890"><a href="#cb8-890" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> pd.notna(row.get(<span class="st">&#39;created_at&#39;</span>)):</span>
<span id="cb8-891"><a href="#cb8-891" aria-hidden="true" tabindex="-1"></a>                <span class="cf">try</span>:</span>
<span id="cb8-892"><a href="#cb8-892" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="bu">hasattr</span>(row[<span class="st">&#39;created_at&#39;</span>], <span class="st">&#39;strftime&#39;</span>):</span>
<span id="cb8-893"><a href="#cb8-893" aria-hidden="true" tabindex="-1"></a>                        created_date <span class="op">=</span> row[<span class="st">&#39;created_at&#39;</span>].strftime(<span class="st">&#39;</span><span class="sc">%d</span><span class="st">/%m/%Y %H:%M&#39;</span>)</span>
<span id="cb8-894"><a href="#cb8-894" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">else</span>:</span>
<span id="cb8-895"><a href="#cb8-895" aria-hidden="true" tabindex="-1"></a>                        created_date <span class="op">=</span> <span class="bu">str</span>(row[<span class="st">&#39;created_at&#39;</span>])</span>
<span id="cb8-896"><a href="#cb8-896" aria-hidden="true" tabindex="-1"></a>                <span class="cf">except</span>:</span>
<span id="cb8-897"><a href="#cb8-897" aria-hidden="true" tabindex="-1"></a>                    created_date <span class="op">=</span> <span class="bu">str</span>(row[<span class="st">&#39;created_at&#39;</span>])</span>
<span id="cb8-898"><a href="#cb8-898" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb8-899"><a href="#cb8-899" aria-hidden="true" tabindex="-1"></a>            cards.append(<span class="ss">f&quot;&quot;&quot;</span></span>
<span id="cb8-900"><a href="#cb8-900" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;div class=&quot;conversation-card&quot; </span></span>
<span id="cb8-901"><a href="#cb8-901" aria-hidden="true" tabindex="-1"></a><span class="ss">                 data-number=&quot;</span><span class="sc">{</span>idx<span class="sc">}</span><span class="ss">&quot; </span></span>
<span id="cb8-902"><a href="#cb8-902" aria-hidden="true" tabindex="-1"></a><span class="ss">                 data-title=&quot;</span><span class="sc">{</span>row[<span class="st">&#39;title&#39;</span>]<span class="sc">}</span><span class="ss">&quot; </span></span>
<span id="cb8-903"><a href="#cb8-903" aria-hidden="true" tabindex="-1"></a><span class="ss">                 data-content=&quot;</span><span class="sc">{</span>row<span class="sc">.</span>get(<span class="st">&#39;preview_content&#39;</span>, <span class="st">&#39;&#39;</span>)<span class="sc">}</span><span class="ss">&quot; </span></span>
<span id="cb8-904"><a href="#cb8-904" aria-hidden="true" tabindex="-1"></a><span class="ss">                 data-category=&quot;</span><span class="sc">{</span>row[<span class="st">&#39;category&#39;</span>]<span class="sc">}</span><span class="ss">&quot;</span></span>
<span id="cb8-905"><a href="#cb8-905" aria-hidden="true" tabindex="-1"></a><span class="ss">                 data-filename=&quot;</span><span class="sc">{</span>safe_title<span class="sc">}</span><span class="ss">.md&quot;&gt;</span></span>
<span id="cb8-906"><a href="#cb8-906" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;div class=&quot;card-header&quot;&gt;</span></span>
<span id="cb8-907"><a href="#cb8-907" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;span class=&quot;card-category&quot;&gt;</span><span class="sc">{</span>row[<span class="st">&#39;category&#39;</span>]<span class="sc">}</span><span class="ss">&lt;/span&gt;</span></span>
<span id="cb8-908"><a href="#cb8-908" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;span class=&quot;card-number&quot;&gt;#</span><span class="sc">{</span>idx<span class="sc">}</span><span class="ss">&lt;/span&gt;</span></span>
<span id="cb8-909"><a href="#cb8-909" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;/div&gt;</span></span>
<span id="cb8-910"><a href="#cb8-910" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;div class=&quot;card-title&quot;&gt;</span><span class="sc">{</span>row[<span class="st">&#39;title&#39;</span>]<span class="sc">}</span><span class="ss">&lt;/div&gt;</span></span>
<span id="cb8-911"><a href="#cb8-911" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;div class=&quot;card-preview&quot;&gt;</span><span class="sc">{</span>row<span class="sc">.</span>get(<span class="st">&#39;preview_content&#39;</span>, <span class="st">&#39;Clique para ver a conversa completa...&#39;</span>)<span class="sc">}</span><span class="ss">&lt;/div&gt;</span></span>
<span id="cb8-912"><a href="#cb8-912" aria-hidden="true" tabindex="-1"></a><span class="ss">                </span></span>
<span id="cb8-913"><a href="#cb8-913" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;div class=&quot;card-stats&quot;&gt;</span></span>
<span id="cb8-914"><a href="#cb8-914" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;div class=&quot;stat-box&quot;&gt;</span></span>
<span id="cb8-915"><a href="#cb8-915" aria-hidden="true" tabindex="-1"></a><span class="ss">                        &lt;span class=&quot;stat-value&quot;&gt;</span><span class="sc">{</span>row[<span class="st">&#39;num_messages&#39;</span>]<span class="sc">}</span><span class="ss">&lt;/span&gt;</span></span>
<span id="cb8-916"><a href="#cb8-916" aria-hidden="true" tabindex="-1"></a><span class="ss">                        &lt;span class=&quot;stat-name&quot;&gt;Mensagens&lt;/span&gt;</span></span>
<span id="cb8-917"><a href="#cb8-917" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;/div&gt;</span></span>
<span id="cb8-918"><a href="#cb8-918" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;div class=&quot;stat-box&quot;&gt;</span></span>
<span id="cb8-919"><a href="#cb8-919" aria-hidden="true" tabindex="-1"></a><span class="ss">                        &lt;span class=&quot;stat-value&quot;&gt;</span><span class="sc">{</span>row[<span class="st">&#39;total_words&#39;</span>]<span class="sc">}</span><span class="ss">&lt;/span&gt;</span></span>
<span id="cb8-920"><a href="#cb8-920" aria-hidden="true" tabindex="-1"></a><span class="ss">                        &lt;span class=&quot;stat-name&quot;&gt;Palavras&lt;/span&gt;</span></span>
<span id="cb8-921"><a href="#cb8-921" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;/div&gt;</span></span>
<span id="cb8-922"><a href="#cb8-922" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;div class=&quot;stat-box&quot;&gt;</span></span>
<span id="cb8-923"><a href="#cb8-923" aria-hidden="true" tabindex="-1"></a><span class="ss">                        &lt;span class=&quot;stat-value&quot;&gt;</span><span class="sc">{</span>row[<span class="st">&#39;user_messages&#39;</span>]<span class="sc">}</span><span class="ss">&lt;/span&gt;</span></span>
<span id="cb8-924"><a href="#cb8-924" aria-hidden="true" tabindex="-1"></a><span class="ss">                        &lt;span class=&quot;stat-name&quot;&gt;Perguntas&lt;/span&gt;</span></span>
<span id="cb8-925"><a href="#cb8-925" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;/div&gt;</span></span>
<span id="cb8-926"><a href="#cb8-926" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;div class=&quot;stat-box&quot;&gt;</span></span>
<span id="cb8-927"><a href="#cb8-927" aria-hidden="true" tabindex="-1"></a><span class="ss">                        &lt;span class=&quot;stat-value&quot;&gt;</span><span class="sc">{</span>row[<span class="st">&#39;assistant_messages&#39;</span>]<span class="sc">}</span><span class="ss">&lt;/span&gt;</span></span>
<span id="cb8-928"><a href="#cb8-928" aria-hidden="true" tabindex="-1"></a><span class="ss">                        &lt;span class=&quot;stat-name&quot;&gt;Respostas&lt;/span&gt;</span></span>
<span id="cb8-929"><a href="#cb8-929" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;/div&gt;</span></span>
<span id="cb8-930"><a href="#cb8-930" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;/div&gt;</span></span>
<span id="cb8-931"><a href="#cb8-931" aria-hidden="true" tabindex="-1"></a><span class="ss">                </span></span>
<span id="cb8-932"><a href="#cb8-932" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;div class=&quot;card-meta&quot;&gt;</span></span>
<span id="cb8-933"><a href="#cb8-933" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;span&gt;üìÖ </span><span class="sc">{</span>created_date<span class="sc">}</span><span class="ss">&lt;/span&gt;</span></span>
<span id="cb8-934"><a href="#cb8-934" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;span&gt;üë§ </span><span class="sc">{</span>row[<span class="st">&#39;user_messages&#39;</span>]<span class="sc">}</span><span class="ss"> / ü§ñ </span><span class="sc">{</span>row[<span class="st">&#39;assistant_messages&#39;</span>]<span class="sc">}</span><span class="ss">&lt;/span&gt;</span></span>
<span id="cb8-935"><a href="#cb8-935" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;/div&gt;</span></span>
<span id="cb8-936"><a href="#cb8-936" aria-hidden="true" tabindex="-1"></a><span class="ss">                </span></span>
<span id="cb8-937"><a href="#cb8-937" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;div class=&quot;card-actions&quot;&gt;</span></span>
<span id="cb8-938"><a href="#cb8-938" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;button class=&quot;action-btn btn-md&quot; onclick=&quot;openMD(&#39;</span><span class="sc">{</span>safe_title<span class="sc">}</span><span class="ss">.md&#39;)&quot;&gt;üìÑ MD&lt;/button&gt;</span></span>
<span id="cb8-939"><a href="#cb8-939" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;button class=&quot;action-btn btn-pdf&quot; onclick=&quot;openPDF(&#39;</span><span class="sc">{</span>safe_title<span class="sc">}</span><span class="ss">.md&#39;)&quot;&gt;üìä PDF&lt;/button&gt;</span></span>
<span id="cb8-940"><a href="#cb8-940" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;/div&gt;</span></span>
<span id="cb8-941"><a href="#cb8-941" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;/div&gt;</span></span>
<span id="cb8-942"><a href="#cb8-942" aria-hidden="true" tabindex="-1"></a><span class="ss">            &quot;&quot;&quot;</span>)</span>
<span id="cb8-943"><a href="#cb8-943" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> cards</span>
<span id="cb8-944"><a href="#cb8-944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-945"><a href="#cb8-945" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> save_data_files(<span class="va">self</span>, df):</span>
<span id="cb8-946"><a href="#cb8-946" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Salva arquivos de dados para an√°lise&quot;&quot;&quot;</span></span>
<span id="cb8-947"><a href="#cb8-947" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;üíæ Salvando arquivos de dados...&quot;</span>)</span>
<span id="cb8-948"><a href="#cb8-948" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-949"><a href="#cb8-949" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Salvar conversas processadas</span></span>
<span id="cb8-950"><a href="#cb8-950" aria-hidden="true" tabindex="-1"></a>        df.to_csv(<span class="ss">f&quot;</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>data_folder<span class="sc">}</span><span class="ss">/processed_conversations.csv&quot;</span>, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb8-951"><a href="#cb8-951" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-952"><a href="#cb8-952" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Salvar mensagens detalhadas</span></span>
<span id="cb8-953"><a href="#cb8-953" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.all_messages:</span>
<span id="cb8-954"><a href="#cb8-954" aria-hidden="true" tabindex="-1"></a>            messages_df <span class="op">=</span> pd.DataFrame(<span class="va">self</span>.all_messages)</span>
<span id="cb8-955"><a href="#cb8-955" aria-hidden="true" tabindex="-1"></a>            messages_df.to_csv(<span class="ss">f&quot;</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>data_folder<span class="sc">}</span><span class="ss">/all_messages.csv&quot;</span>, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb8-956"><a href="#cb8-956" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-957"><a href="#cb8-957" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ Dados salvos em: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>data_folder<span class="sc">}</span><span class="ss">/&quot;</span>)</span>
<span id="cb8-958"><a href="#cb8-958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-959"><a href="#cb8-959" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> open_index(<span class="va">self</span>):</span>
<span id="cb8-960"><a href="#cb8-960" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Abre o √≠ndice no navegador&quot;&quot;&quot;</span></span>
<span id="cb8-961"><a href="#cb8-961" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> os.path.exists(<span class="va">self</span>.index_file):</span>
<span id="cb8-962"><a href="#cb8-962" aria-hidden="true" tabindex="-1"></a>            webbrowser.<span class="bu">open</span>(<span class="ss">f&#39;file://</span><span class="sc">{</span>os<span class="sc">.</span>path<span class="sc">.</span>abspath(<span class="va">self</span>.index_file)<span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb8-963"><a href="#cb8-963" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;üåê √çndice aberto no navegador: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>index_file<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb8-964"><a href="#cb8-964" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb8-965"><a href="#cb8-965" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;‚ùå √çndice n√£o encontrado&quot;</span>)</span>
<span id="cb8-966"><a href="#cb8-966" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-967"><a href="#cb8-967" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> generate_complete_system(<span class="va">self</span>):</span>
<span id="cb8-968"><a href="#cb8-968" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Gera o sistema completo de uma vez&quot;&quot;&quot;</span></span>
<span id="cb8-969"><a href="#cb8-969" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;üöÄ GROK PROCESSOR OTIMIZADO - Iniciando&quot;</span>)</span>
<span id="cb8-970"><a href="#cb8-970" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;=&quot;</span> <span class="op">*</span> <span class="dv">60</span>)</span>
<span id="cb8-971"><a href="#cb8-971" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-972"><a href="#cb8-972" aria-hidden="true" tabindex="-1"></a>        start_time <span class="op">=</span> datetime.now()</span>
<span id="cb8-973"><a href="#cb8-973" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-974"><a href="#cb8-974" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Configurar pastas</span></span>
<span id="cb8-975"><a href="#cb8-975" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.setup_folders()</span>
<span id="cb8-976"><a href="#cb8-976" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-977"><a href="#cb8-977" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Carregar dados</span></span>
<span id="cb8-978"><a href="#cb8-978" aria-hidden="true" tabindex="-1"></a>        all_data <span class="op">=</span> <span class="va">self</span>.load_grok_data()</span>
<span id="cb8-979"><a href="#cb8-979" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> all_data:</span>
<span id="cb8-980"><a href="#cb8-980" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb8-981"><a href="#cb8-981" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-982"><a href="#cb8-982" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Extrair e analisar conversas</span></span>
<span id="cb8-983"><a href="#cb8-983" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.extract_conversations(all_data)</span>
<span id="cb8-984"><a href="#cb8-984" aria-hidden="true" tabindex="-1"></a>        df, all_messages <span class="op">=</span> <span class="va">self</span>.analyze_conversations()</span>
<span id="cb8-985"><a href="#cb8-985" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-986"><a href="#cb8-986" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> df.empty:</span>
<span id="cb8-987"><a href="#cb8-987" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;‚ùå Nenhuma conversa v√°lida encontrada!&quot;</span>)</span>
<span id="cb8-988"><a href="#cb8-988" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb8-989"><a href="#cb8-989" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-990"><a href="#cb8-990" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Criar arquivos Markdown</span></span>
<span id="cb8-991"><a href="#cb8-991" aria-hidden="true" tabindex="-1"></a>        md_files <span class="op">=</span> <span class="va">self</span>.create_markdown_files(df)</span>
<span id="cb8-992"><a href="#cb8-992" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-993"><a href="#cb8-993" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Criar √≠ndice pesquis√°vel</span></span>
<span id="cb8-994"><a href="#cb8-994" aria-hidden="true" tabindex="-1"></a>        index_file <span class="op">=</span> <span class="va">self</span>.create_searchable_index(df)</span>
<span id="cb8-995"><a href="#cb8-995" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-996"><a href="#cb8-996" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Salvar dados</span></span>
<span id="cb8-997"><a href="#cb8-997" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.save_data_files(df)</span>
<span id="cb8-998"><a href="#cb8-998" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-999"><a href="#cb8-999" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Abrir √≠ndice</span></span>
<span id="cb8-1000"><a href="#cb8-1000" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.open_index()</span>
<span id="cb8-1001"><a href="#cb8-1001" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-1002"><a href="#cb8-1002" aria-hidden="true" tabindex="-1"></a>        elapsed <span class="op">=</span> datetime.now() <span class="op">-</span> start_time</span>
<span id="cb8-1003"><a href="#cb8-1003" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-1004"><a href="#cb8-1004" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="ch">\n</span><span class="ss">&quot;</span> <span class="op">+</span> <span class="st">&quot;=&quot;</span> <span class="op">*</span> <span class="dv">60</span>)</span>
<span id="cb8-1005"><a href="#cb8-1005" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;üéâ SISTEMA COMPLETO GERADO!&quot;</span>)</span>
<span id="cb8-1006"><a href="#cb8-1006" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;=&quot;</span> <span class="op">*</span> <span class="dv">60</span>)</span>
<span id="cb8-1007"><a href="#cb8-1007" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;üìä RESUMO:&quot;</span>)</span>
<span id="cb8-1008"><a href="#cb8-1008" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;   üìÅ Conversas processadas: </span><span class="sc">{</span><span class="bu">len</span>(df)<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb8-1009"><a href="#cb8-1009" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;   üí¨ Mensagens totais: </span><span class="sc">{</span>df[<span class="st">&#39;num_messages&#39;</span>]<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb8-1010"><a href="#cb8-1010" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;   üìù Arquivos Markdown: </span><span class="sc">{</span><span class="bu">len</span>(md_files)<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb8-1011"><a href="#cb8-1011" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;   üåê √çndice HTML: </span><span class="sc">{</span>index_file<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb8-1012"><a href="#cb8-1012" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;   üìÖ Ordena√ß√£o: Mais recente primeiro&quot;</span>)</span>
<span id="cb8-1013"><a href="#cb8-1013" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;   ‚è±Ô∏è  Tempo total: </span><span class="sc">{</span>elapsed<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb8-1014"><a href="#cb8-1014" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="ch">\n</span><span class="ss">üìã PR√ìXIMO PASSO:&quot;</span>)</span>
<span id="cb8-1015"><a href="#cb8-1015" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;   Execute: python grok_pdf_converter_optimized.py&quot;</span>)</span>
<span id="cb8-1016"><a href="#cb8-1016" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;=&quot;</span> <span class="op">*</span> <span class="dv">60</span>)</span>
<span id="cb8-1017"><a href="#cb8-1017" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-1018"><a href="#cb8-1018" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb8-1019"><a href="#cb8-1019" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-1020"><a href="#cb8-1020" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> main():</span>
<span id="cb8-1021"><a href="#cb8-1021" aria-hidden="true" tabindex="-1"></a>    processor <span class="op">=</span> GrokProcessorOptimized()</span>
<span id="cb8-1022"><a href="#cb8-1022" aria-hidden="true" tabindex="-1"></a>    success <span class="op">=</span> processor.generate_complete_system()</span>
<span id="cb8-1023"><a href="#cb8-1023" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-1024"><a href="#cb8-1024" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> success:</span>
<span id="cb8-1025"><a href="#cb8-1025" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;‚ùå Processamento falhou!&quot;</span>)</span>
<span id="cb8-1026"><a href="#cb8-1026" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">1</span></span>
<span id="cb8-1027"><a href="#cb8-1027" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-1028"><a href="#cb8-1028" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span></span>
<span id="cb8-1029"><a href="#cb8-1029" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-1030"><a href="#cb8-1030" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&quot;__main__&quot;</span>:</span>
<span id="cb8-1031"><a href="#cb8-1031" aria-hidden="true" tabindex="-1"></a>    exit(main())</span></code></pre></div>
<h2 data-number="2.9" id="principais-melhorias-implementadas"><span class="header-section-number">2.9</span> Principais Melhorias
Implementadas:</h2>
<h3 data-number="2.9.1" id="estrutura-similar-ao-chatgpt-index-system"><span class="header-section-number">2.9.1</span> 1. <strong>Estrutura Similar
ao ChatGPT Index System</strong></h3>
<ul>
<li>Classe √∫nica e organizada</li>
<li>M√©todos bem definidos e especializados</li>
<li>Sistema completo em uma execu√ß√£o</li>
</ul>
<h3 data-number="2.9.2" id="ordena√ß√£o-por-data-mais-recente-primeiro"><span class="header-section-number">2.9.2</span> 2. <strong>Ordena√ß√£o por Data
(Mais Recente Primeiro)</strong></h3>
<ul>
<li>Parse inteligente de m√∫ltiplos formatos de data</li>
<li>Campo <code>created_dt</code> para ordena√ß√£o</li>
<li>Indicador visual no √≠ndice</li>
</ul>
<h3 data-number="2.9.3" id="√≠ndice-pesquis√°vel-avan√ßado"><span class="header-section-number">2.9.3</span> 3. <strong>√çndice Pesquis√°vel
Avan√ßado</strong></h3>
<ul>
<li>Busca em tempo real por t√≠tulo, conte√∫do e categoria</li>
<li>Filtros por categoria</li>
<li>Design moderno e responsivo</li>
<li>Anima√ß√µes CSS</li>
</ul>
<h3 data-number="2.9.4" id="categoriza√ß√£o-inteligente"><span class="header-section-number">2.9.4</span> 4. <strong>Categoriza√ß√£o
Inteligente</strong></h3>
<ul>
<li>10 categorias diferentes</li>
<li>Detec√ß√£o autom√°tica baseada em palavras-chave</li>
<li>Visualiza√ß√£o por cores no √≠ndice</li>
</ul>
<h3 data-number="2.9.5" id="estat√≠sticas-completas"><span class="header-section-number">2.9.5</span> 5. <strong>Estat√≠sticas
Completas</strong></h3>
<ul>
<li>Contadores em tempo real</li>
<li>M√©tricas detalhadas por conversa</li>
<li>Resumo executivo</li>
</ul>
<h3 data-number="2.9.6" id="fluxo-otimizado"><span class="header-section-number">2.9.6</span> 6. <strong>Fluxo
Otimizado</strong></h3>
<div class="sourceCode" id="cb9"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Uso simples</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> grok_processor_optimized.py</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Fluxo completo</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> grok_processor_optimized.py</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> grok_pdf_converter_optimized.py</span></code></pre></div>
<h3 data-number="2.9.7" id="feedback-visual-melhorado"><span class="header-section-number">2.9.7</span> 7. <strong>Feedback Visual
Melhorado</strong></h3>
<ul>
<li>Barra de progresso</li>
<li>Estat√≠sticas em tempo real</li>
<li>Relat√≥rio final detalhado</li>
</ul>
<p>Agora o sistema tem uma interface muito mais profissional e
funcional, similar ao ChatGPT Index System, com ordena√ß√£o por data e
busca avan√ßada!</p>
<hr />
<h3 data-number="2.9.8" id="utilizador-2025-11-02-014655-deepseek-chat"><span class="header-section-number">2.9.8</span> üë§ Utilizador <em>(2025-11-02
01:46:55)</em> <em>[deepseek-chat]</em></h3>
<p>ok Tudo bem. Pretendia que o grok_processor_optimized.py na gera√ß√£o
do markdown das conversas considera-se Utilizador e n√£o Usu√°rio.</p>
<hr />
<h3 data-number="2.9.9" id="deepseek-2025-11-02-014655-deepseek-chat"><span class="header-section-number">2.9.9</span> ü§ñ DeepSeek <em>(2025-11-02
01:46:55)</em> <em>[deepseek-chat]</em></h3>
<p>Perfeito! Vou corrigir para usar ‚ÄúUtilizador‚Äù em vez de ‚ÄúUsu√°rio‚Äù nos
arquivos Markdown. Aqui est√° a vers√£o atualizada:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># grok_processor_optimized.py</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> zipfile</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> Counter</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> webbrowser</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> glob</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> GrokProcessorOptimized:</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.conversations <span class="op">=</span> []</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.all_messages <span class="op">=</span> []</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.index_file <span class="op">=</span> <span class="st">&quot;grok_complete_dashboard/index.html&quot;</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.markdown_folder <span class="op">=</span> <span class="st">&quot;grok_complete_dashboard/markdown&quot;</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.pdf_folder <span class="op">=</span> <span class="st">&quot;grok_complete_dashboard/pdf/conversas&quot;</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.data_folder <span class="op">=</span> <span class="st">&quot;grok_complete_dashboard/data&quot;</span></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> setup_folders(<span class="va">self</span>):</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Cria estrutura de pastas necess√°ria&quot;&quot;&quot;</span></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>        folders <span class="op">=</span> [</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.markdown_folder,</span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.pdf_folder,</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.data_folder,</span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;grok_complete_dashboard/pdf&quot;</span></span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> folder <span class="kw">in</span> folders:</span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>            os.makedirs(folder, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;üìÅ Estrutura de pastas criada&quot;</span>)</span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> load_grok_data(<span class="va">self</span>):</span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Carrega e processa os dados do arquivo zip de forma otimizada&quot;&quot;&quot;</span></span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a>        zip_files <span class="op">=</span> [<span class="st">&quot;grok.zip&quot;</span>, <span class="st">&quot;gork.zip&quot;</span>]</span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a>        zip_path <span class="op">=</span> <span class="bu">next</span>((f <span class="cf">for</span> f <span class="kw">in</span> zip_files <span class="cf">if</span> os.path.exists(f)), <span class="va">None</span>)</span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> zip_path <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;‚ùå Nenhum arquivo zip encontrado!&quot;</span>)</span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;üìÇ Carregando dados do </span><span class="sc">{</span>zip_path<span class="sc">}</span><span class="ss">...&quot;</span>)</span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb10-50"><a href="#cb10-50" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> zipfile.ZipFile(zip_path, <span class="st">&#39;r&#39;</span>) <span class="im">as</span> zip_ref:</span>
<span id="cb10-51"><a href="#cb10-51" aria-hidden="true" tabindex="-1"></a>                json_files <span class="op">=</span> [f <span class="cf">for</span> f <span class="kw">in</span> zip_ref.namelist() <span class="cf">if</span> f.endswith(<span class="st">&#39;.json&#39;</span>)]</span>
<span id="cb10-52"><a href="#cb10-52" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;üîç Processando </span><span class="sc">{</span><span class="bu">len</span>(json_files)<span class="sc">}</span><span class="ss"> arquivos JSON...&quot;</span>)</span>
<span id="cb10-53"><a href="#cb10-53" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb10-54"><a href="#cb10-54" aria-hidden="true" tabindex="-1"></a>                all_data <span class="op">=</span> []</span>
<span id="cb10-55"><a href="#cb10-55" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> file_name <span class="kw">in</span> json_files:</span>
<span id="cb10-56"><a href="#cb10-56" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">try</span>:</span>
<span id="cb10-57"><a href="#cb10-57" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">with</span> zip_ref.<span class="bu">open</span>(file_name) <span class="im">as</span> f:</span>
<span id="cb10-58"><a href="#cb10-58" aria-hidden="true" tabindex="-1"></a>                            content <span class="op">=</span> f.read().decode(<span class="st">&#39;utf-8&#39;</span>)</span>
<span id="cb10-59"><a href="#cb10-59" aria-hidden="true" tabindex="-1"></a>                            data <span class="op">=</span> json.loads(content)</span>
<span id="cb10-60"><a href="#cb10-60" aria-hidden="true" tabindex="-1"></a>                            all_data.append({</span>
<span id="cb10-61"><a href="#cb10-61" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&#39;file_name&#39;</span>: file_name,</span>
<span id="cb10-62"><a href="#cb10-62" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&#39;data&#39;</span>: data,</span>
<span id="cb10-63"><a href="#cb10-63" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&#39;size&#39;</span>: <span class="bu">len</span>(content)</span>
<span id="cb10-64"><a href="#cb10-64" aria-hidden="true" tabindex="-1"></a>                            })</span>
<span id="cb10-65"><a href="#cb10-65" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb10-66"><a href="#cb10-66" aria-hidden="true" tabindex="-1"></a>                        <span class="bu">print</span>(<span class="ss">f&quot;‚ö†Ô∏è  </span><span class="sc">{</span>file_name<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb10-67"><a href="#cb10-67" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb10-68"><a href="#cb10-68" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ Dados brutos carregados: </span><span class="sc">{</span><span class="bu">len</span>(all_data)<span class="sc">}</span><span class="ss"> arquivos&quot;</span>)</span>
<span id="cb10-69"><a href="#cb10-69" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> all_data</span>
<span id="cb10-70"><a href="#cb10-70" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb10-71"><a href="#cb10-71" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb10-72"><a href="#cb10-72" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚ùå Erro ao processar </span><span class="sc">{</span>zip_path<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb10-73"><a href="#cb10-73" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb10-74"><a href="#cb10-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-75"><a href="#cb10-75" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> extract_conversations(<span class="va">self</span>, all_data):</span>
<span id="cb10-76"><a href="#cb10-76" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Extrai conversas dos dados brutos&quot;&quot;&quot;</span></span>
<span id="cb10-77"><a href="#cb10-77" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;üìä Extraindo conversas...&quot;</span>)</span>
<span id="cb10-78"><a href="#cb10-78" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-79"><a href="#cb10-79" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.conversations <span class="op">=</span> []</span>
<span id="cb10-80"><a href="#cb10-80" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-81"><a href="#cb10-81" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> item <span class="kw">in</span> all_data:</span>
<span id="cb10-82"><a href="#cb10-82" aria-hidden="true" tabindex="-1"></a>            data <span class="op">=</span> item[<span class="st">&#39;data&#39;</span>]</span>
<span id="cb10-83"><a href="#cb10-83" aria-hidden="true" tabindex="-1"></a>            file_name <span class="op">=</span> item[<span class="st">&#39;file_name&#39;</span>]</span>
<span id="cb10-84"><a href="#cb10-84" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb10-85"><a href="#cb10-85" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="st">&#39;prod-grok-backend.json&#39;</span> <span class="kw">in</span> file_name <span class="kw">and</span> <span class="bu">isinstance</span>(data, <span class="bu">dict</span>):</span>
<span id="cb10-86"><a href="#cb10-86" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="st">&#39;conversations&#39;</span> <span class="kw">in</span> data <span class="kw">and</span> <span class="bu">isinstance</span>(data[<span class="st">&#39;conversations&#39;</span>], <span class="bu">list</span>):</span>
<span id="cb10-87"><a href="#cb10-87" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ </span><span class="sc">{</span>file_name<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span><span class="bu">len</span>(data[<span class="st">&#39;conversations&#39;</span>])<span class="sc">}</span><span class="ss"> conversas encontradas&quot;</span>)</span>
<span id="cb10-88"><a href="#cb10-88" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.conversations.extend(data[<span class="st">&#39;conversations&#39;</span>])</span>
<span id="cb10-89"><a href="#cb10-89" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-90"><a href="#cb10-90" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;üéØ Total de conversas extra√≠das: </span><span class="sc">{</span><span class="bu">len</span>(<span class="va">self</span>.conversations)<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb10-91"><a href="#cb10-91" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.conversations</span>
<span id="cb10-92"><a href="#cb10-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-93"><a href="#cb10-93" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> extract_messages(<span class="va">self</span>, conv):</span>
<span id="cb10-94"><a href="#cb10-94" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Extrai mensagens de uma conversa&quot;&quot;&quot;</span></span>
<span id="cb10-95"><a href="#cb10-95" aria-hidden="true" tabindex="-1"></a>        messages <span class="op">=</span> []</span>
<span id="cb10-96"><a href="#cb10-96" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-97"><a href="#cb10-97" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">isinstance</span>(conv, <span class="bu">dict</span>) <span class="kw">and</span> <span class="st">&#39;responses&#39;</span> <span class="kw">in</span> conv <span class="kw">and</span> <span class="bu">isinstance</span>(conv[<span class="st">&#39;responses&#39;</span>], <span class="bu">list</span>):</span>
<span id="cb10-98"><a href="#cb10-98" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> response <span class="kw">in</span> conv[<span class="st">&#39;responses&#39;</span>]:</span>
<span id="cb10-99"><a href="#cb10-99" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="bu">isinstance</span>(response, <span class="bu">dict</span>) <span class="kw">and</span> <span class="st">&#39;response&#39;</span> <span class="kw">in</span> response:</span>
<span id="cb10-100"><a href="#cb10-100" aria-hidden="true" tabindex="-1"></a>                    response_data <span class="op">=</span> response[<span class="st">&#39;response&#39;</span>]</span>
<span id="cb10-101"><a href="#cb10-101" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="bu">isinstance</span>(response_data, <span class="bu">dict</span>):</span>
<span id="cb10-102"><a href="#cb10-102" aria-hidden="true" tabindex="-1"></a>                        message_content <span class="op">=</span> response_data.get(<span class="st">&#39;message&#39;</span>, <span class="st">&#39;&#39;</span>)</span>
<span id="cb10-103"><a href="#cb10-103" aria-hidden="true" tabindex="-1"></a>                        sender <span class="op">=</span> response_data.get(<span class="st">&#39;sender&#39;</span>, <span class="st">&#39;&#39;</span>)</span>
<span id="cb10-104"><a href="#cb10-104" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb10-105"><a href="#cb10-105" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">if</span> message_content <span class="kw">and</span> sender:</span>
<span id="cb10-106"><a href="#cb10-106" aria-hidden="true" tabindex="-1"></a>                            messages.append({</span>
<span id="cb10-107"><a href="#cb10-107" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&#39;content&#39;</span>: message_content,</span>
<span id="cb10-108"><a href="#cb10-108" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&#39;sender&#39;</span>: sender,</span>
<span id="cb10-109"><a href="#cb10-109" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&#39;response_id&#39;</span>: response_data.get(<span class="st">&#39;_id&#39;</span>, <span class="st">&#39;&#39;</span>),</span>
<span id="cb10-110"><a href="#cb10-110" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&#39;model&#39;</span>: response_data.get(<span class="st">&#39;model&#39;</span>, <span class="st">&#39;&#39;</span>),</span>
<span id="cb10-111"><a href="#cb10-111" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&#39;create_time&#39;</span>: response_data.get(<span class="st">&#39;create_time&#39;</span>, {})</span>
<span id="cb10-112"><a href="#cb10-112" aria-hidden="true" tabindex="-1"></a>                            })</span>
<span id="cb10-113"><a href="#cb10-113" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-114"><a href="#cb10-114" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> messages</span>
<span id="cb10-115"><a href="#cb10-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-116"><a href="#cb10-116" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> parse_datetime(<span class="va">self</span>, date_string):</span>
<span id="cb10-117"><a href="#cb10-117" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Converte string de data para objeto datetime para ordena√ß√£o&quot;&quot;&quot;</span></span>
<span id="cb10-118"><a href="#cb10-118" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> date_string:</span>
<span id="cb10-119"><a href="#cb10-119" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> datetime.<span class="bu">min</span></span>
<span id="cb10-120"><a href="#cb10-120" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-121"><a href="#cb10-121" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb10-122"><a href="#cb10-122" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Tenta v√°rios formatos de data</span></span>
<span id="cb10-123"><a href="#cb10-123" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">isinstance</span>(date_string, <span class="bu">dict</span>):</span>
<span id="cb10-124"><a href="#cb10-124" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Se for objeto, pega timestamp</span></span>
<span id="cb10-125"><a href="#cb10-125" aria-hidden="true" tabindex="-1"></a>                timestamp <span class="op">=</span> date_string.get(<span class="st">&#39;$date&#39;</span>, <span class="dv">0</span>)</span>
<span id="cb10-126"><a href="#cb10-126" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> timestamp:</span>
<span id="cb10-127"><a href="#cb10-127" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">return</span> datetime.fromtimestamp(timestamp <span class="op">/</span> <span class="dv">1000</span>)</span>
<span id="cb10-128"><a href="#cb10-128" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> datetime.<span class="bu">min</span></span>
<span id="cb10-129"><a href="#cb10-129" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb10-130"><a href="#cb10-130" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Tenta formato ISO</span></span>
<span id="cb10-131"><a href="#cb10-131" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="st">&#39;T&#39;</span> <span class="kw">in</span> <span class="bu">str</span>(date_string):</span>
<span id="cb10-132"><a href="#cb10-132" aria-hidden="true" tabindex="-1"></a>                date_str <span class="op">=</span> <span class="bu">str</span>(date_string).replace(<span class="st">&#39;Z&#39;</span>, <span class="st">&#39;+00:00&#39;</span>)</span>
<span id="cb10-133"><a href="#cb10-133" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> datetime.fromisoformat(date_str)</span>
<span id="cb10-134"><a href="#cb10-134" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb10-135"><a href="#cb10-135" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Tenta outros formatos</span></span>
<span id="cb10-136"><a href="#cb10-136" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> fmt <span class="kw">in</span> [<span class="st">&#39;%Y-%m-</span><span class="sc">%d</span><span class="st"> %H:%M:%S&#39;</span>, <span class="st">&#39;%Y-%m-</span><span class="sc">%d</span><span class="st">&#39;</span>, <span class="st">&#39;</span><span class="sc">%d</span><span class="st">/%m/%Y %H:%M:%S&#39;</span>]:</span>
<span id="cb10-137"><a href="#cb10-137" aria-hidden="true" tabindex="-1"></a>                <span class="cf">try</span>:</span>
<span id="cb10-138"><a href="#cb10-138" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">return</span> datetime.strptime(<span class="bu">str</span>(date_string), fmt)</span>
<span id="cb10-139"><a href="#cb10-139" aria-hidden="true" tabindex="-1"></a>                <span class="cf">except</span>:</span>
<span id="cb10-140"><a href="#cb10-140" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">continue</span></span>
<span id="cb10-141"><a href="#cb10-141" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb10-142"><a href="#cb10-142" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> datetime.<span class="bu">min</span></span>
<span id="cb10-143"><a href="#cb10-143" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span>:</span>
<span id="cb10-144"><a href="#cb10-144" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> datetime.<span class="bu">min</span></span>
<span id="cb10-145"><a href="#cb10-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-146"><a href="#cb10-146" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> analyze_conversations(<span class="va">self</span>):</span>
<span id="cb10-147"><a href="#cb10-147" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Analisa as conversas com m√©tricas completas&quot;&quot;&quot;</span></span>
<span id="cb10-148"><a href="#cb10-148" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;üìä Analisando conversas...&quot;</span>)</span>
<span id="cb10-149"><a href="#cb10-149" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-150"><a href="#cb10-150" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.conversations:</span>
<span id="cb10-151"><a href="#cb10-151" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;‚ùå Nenhuma conversa para analisar!&quot;</span>)</span>
<span id="cb10-152"><a href="#cb10-152" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> pd.DataFrame(), []</span>
<span id="cb10-153"><a href="#cb10-153" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-154"><a href="#cb10-154" aria-hidden="true" tabindex="-1"></a>        analysis_data <span class="op">=</span> []</span>
<span id="cb10-155"><a href="#cb10-155" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.all_messages <span class="op">=</span> []</span>
<span id="cb10-156"><a href="#cb10-156" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-157"><a href="#cb10-157" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, conv <span class="kw">in</span> <span class="bu">enumerate</span>(<span class="va">self</span>.conversations):</span>
<span id="cb10-158"><a href="#cb10-158" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(conv, <span class="bu">dict</span>):</span>
<span id="cb10-159"><a href="#cb10-159" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span></span>
<span id="cb10-160"><a href="#cb10-160" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb10-161"><a href="#cb10-161" aria-hidden="true" tabindex="-1"></a>            conversation_data <span class="op">=</span> conv.get(<span class="st">&#39;conversation&#39;</span>, {})</span>
<span id="cb10-162"><a href="#cb10-162" aria-hidden="true" tabindex="-1"></a>            conv_id <span class="op">=</span> conversation_data.get(<span class="st">&#39;id&#39;</span>, <span class="ss">f&#39;conv_</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb10-163"><a href="#cb10-163" aria-hidden="true" tabindex="-1"></a>            title <span class="op">=</span> conversation_data.get(<span class="st">&#39;title&#39;</span>, <span class="ss">f&#39;Conversa </span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb10-164"><a href="#cb10-164" aria-hidden="true" tabindex="-1"></a>            created_at <span class="op">=</span> conversation_data.get(<span class="st">&#39;create_time&#39;</span>, <span class="st">&#39;&#39;</span>)</span>
<span id="cb10-165"><a href="#cb10-165" aria-hidden="true" tabindex="-1"></a>            updated_at <span class="op">=</span> conversation_data.get(<span class="st">&#39;modify_time&#39;</span>, <span class="st">&#39;&#39;</span>)</span>
<span id="cb10-166"><a href="#cb10-166" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb10-167"><a href="#cb10-167" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Parse datas para ordena√ß√£o</span></span>
<span id="cb10-168"><a href="#cb10-168" aria-hidden="true" tabindex="-1"></a>            created_dt <span class="op">=</span> <span class="va">self</span>.parse_datetime(created_at)</span>
<span id="cb10-169"><a href="#cb10-169" aria-hidden="true" tabindex="-1"></a>            updated_dt <span class="op">=</span> <span class="va">self</span>.parse_datetime(updated_at)</span>
<span id="cb10-170"><a href="#cb10-170" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb10-171"><a href="#cb10-171" aria-hidden="true" tabindex="-1"></a>            messages <span class="op">=</span> <span class="va">self</span>.extract_messages(conv)</span>
<span id="cb10-172"><a href="#cb10-172" aria-hidden="true" tabindex="-1"></a>            num_messages <span class="op">=</span> <span class="bu">len</span>(messages)</span>
<span id="cb10-173"><a href="#cb10-173" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb10-174"><a href="#cb10-174" aria-hidden="true" tabindex="-1"></a>            <span class="co"># M√©tricas</span></span>
<span id="cb10-175"><a href="#cb10-175" aria-hidden="true" tabindex="-1"></a>            total_words <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb10-176"><a href="#cb10-176" aria-hidden="true" tabindex="-1"></a>            user_words <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb10-177"><a href="#cb10-177" aria-hidden="true" tabindex="-1"></a>            assistant_words <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb10-178"><a href="#cb10-178" aria-hidden="true" tabindex="-1"></a>            user_messages <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb10-179"><a href="#cb10-179" aria-hidden="true" tabindex="-1"></a>            assistant_messages <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb10-180"><a href="#cb10-180" aria-hidden="true" tabindex="-1"></a>            total_chars <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb10-181"><a href="#cb10-181" aria-hidden="true" tabindex="-1"></a>            preview_content <span class="op">=</span> <span class="st">&quot;&quot;</span></span>
<span id="cb10-182"><a href="#cb10-182" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb10-183"><a href="#cb10-183" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> j, msg <span class="kw">in</span> <span class="bu">enumerate</span>(messages):</span>
<span id="cb10-184"><a href="#cb10-184" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="bu">isinstance</span>(msg, <span class="bu">dict</span>):</span>
<span id="cb10-185"><a href="#cb10-185" aria-hidden="true" tabindex="-1"></a>                    content <span class="op">=</span> msg.get(<span class="st">&#39;content&#39;</span>, <span class="st">&#39;&#39;</span>)</span>
<span id="cb10-186"><a href="#cb10-186" aria-hidden="true" tabindex="-1"></a>                    sender <span class="op">=</span> msg.get(<span class="st">&#39;sender&#39;</span>, <span class="st">&#39;&#39;</span>)</span>
<span id="cb10-187"><a href="#cb10-187" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb10-188"><a href="#cb10-188" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> content <span class="kw">and</span> <span class="bu">len</span>(content.strip()) <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb10-189"><a href="#cb10-189" aria-hidden="true" tabindex="-1"></a>                        words <span class="op">=</span> <span class="bu">len</span>(content.split())</span>
<span id="cb10-190"><a href="#cb10-190" aria-hidden="true" tabindex="-1"></a>                        chars <span class="op">=</span> <span class="bu">len</span>(content)</span>
<span id="cb10-191"><a href="#cb10-191" aria-hidden="true" tabindex="-1"></a>                        total_words <span class="op">+=</span> words</span>
<span id="cb10-192"><a href="#cb10-192" aria-hidden="true" tabindex="-1"></a>                        total_chars <span class="op">+=</span> chars</span>
<span id="cb10-193"><a href="#cb10-193" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb10-194"><a href="#cb10-194" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">if</span> j <span class="op">==</span> <span class="dv">0</span> <span class="kw">and</span> content:</span>
<span id="cb10-195"><a href="#cb10-195" aria-hidden="true" tabindex="-1"></a>                            preview_content <span class="op">=</span> content[:<span class="dv">150</span>] <span class="op">+</span> <span class="st">&quot;...&quot;</span> <span class="cf">if</span> <span class="bu">len</span>(content) <span class="op">&gt;</span> <span class="dv">150</span> <span class="cf">else</span> content</span>
<span id="cb10-196"><a href="#cb10-196" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb10-197"><a href="#cb10-197" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">if</span> sender <span class="op">==</span> <span class="st">&#39;human&#39;</span>:</span>
<span id="cb10-198"><a href="#cb10-198" aria-hidden="true" tabindex="-1"></a>                            user_words <span class="op">+=</span> words</span>
<span id="cb10-199"><a href="#cb10-199" aria-hidden="true" tabindex="-1"></a>                            user_messages <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb10-200"><a href="#cb10-200" aria-hidden="true" tabindex="-1"></a>                            role <span class="op">=</span> <span class="st">&#39;user&#39;</span></span>
<span id="cb10-201"><a href="#cb10-201" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">elif</span> sender <span class="kw">in</span> [<span class="st">&#39;assistant&#39;</span>, <span class="st">&#39;grok&#39;</span>, <span class="st">&#39;model&#39;</span>]:</span>
<span id="cb10-202"><a href="#cb10-202" aria-hidden="true" tabindex="-1"></a>                            assistant_words <span class="op">+=</span> words</span>
<span id="cb10-203"><a href="#cb10-203" aria-hidden="true" tabindex="-1"></a>                            assistant_messages <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb10-204"><a href="#cb10-204" aria-hidden="true" tabindex="-1"></a>                            role <span class="op">=</span> <span class="st">&#39;assistant&#39;</span></span>
<span id="cb10-205"><a href="#cb10-205" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">else</span>:</span>
<span id="cb10-206"><a href="#cb10-206" aria-hidden="true" tabindex="-1"></a>                            role <span class="op">=</span> sender</span>
<span id="cb10-207"><a href="#cb10-207" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb10-208"><a href="#cb10-208" aria-hidden="true" tabindex="-1"></a>                        <span class="va">self</span>.all_messages.append({</span>
<span id="cb10-209"><a href="#cb10-209" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&#39;conversation_id&#39;</span>: conv_id,</span>
<span id="cb10-210"><a href="#cb10-210" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&#39;conversation_title&#39;</span>: title,</span>
<span id="cb10-211"><a href="#cb10-211" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&#39;message_index&#39;</span>: j,</span>
<span id="cb10-212"><a href="#cb10-212" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&#39;role&#39;</span>: role,</span>
<span id="cb10-213"><a href="#cb10-213" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&#39;sender&#39;</span>: sender,</span>
<span id="cb10-214"><a href="#cb10-214" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&#39;content&#39;</span>: content,</span>
<span id="cb10-215"><a href="#cb10-215" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&#39;word_count&#39;</span>: words,</span>
<span id="cb10-216"><a href="#cb10-216" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&#39;char_count&#39;</span>: chars,</span>
<span id="cb10-217"><a href="#cb10-217" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&#39;model&#39;</span>: msg.get(<span class="st">&#39;model&#39;</span>, <span class="st">&#39;&#39;</span>),</span>
<span id="cb10-218"><a href="#cb10-218" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&#39;response_id&#39;</span>: msg.get(<span class="st">&#39;response_id&#39;</span>, <span class="st">&#39;&#39;</span>),</span>
<span id="cb10-219"><a href="#cb10-219" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&#39;timestamp&#39;</span>: created_dt</span>
<span id="cb10-220"><a href="#cb10-220" aria-hidden="true" tabindex="-1"></a>                        })</span>
<span id="cb10-221"><a href="#cb10-221" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb10-222"><a href="#cb10-222" aria-hidden="true" tabindex="-1"></a>            analysis_data.append({</span>
<span id="cb10-223"><a href="#cb10-223" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;conversation_id&#39;</span>: conv_id,</span>
<span id="cb10-224"><a href="#cb10-224" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;title&#39;</span>: title,</span>
<span id="cb10-225"><a href="#cb10-225" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;created_at&#39;</span>: created_at,</span>
<span id="cb10-226"><a href="#cb10-226" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;created_dt&#39;</span>: created_dt,  <span class="co"># Para ordena√ß√£o</span></span>
<span id="cb10-227"><a href="#cb10-227" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;updated_at&#39;</span>: updated_at,</span>
<span id="cb10-228"><a href="#cb10-228" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;updated_dt&#39;</span>: updated_dt,</span>
<span id="cb10-229"><a href="#cb10-229" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;num_messages&#39;</span>: num_messages,</span>
<span id="cb10-230"><a href="#cb10-230" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;total_words&#39;</span>: total_words,</span>
<span id="cb10-231"><a href="#cb10-231" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;total_chars&#39;</span>: total_chars,</span>
<span id="cb10-232"><a href="#cb10-232" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;user_words&#39;</span>: user_words,</span>
<span id="cb10-233"><a href="#cb10-233" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;assistant_words&#39;</span>: assistant_words,</span>
<span id="cb10-234"><a href="#cb10-234" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;user_messages&#39;</span>: user_messages,</span>
<span id="cb10-235"><a href="#cb10-235" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;assistant_messages&#39;</span>: assistant_messages,</span>
<span id="cb10-236"><a href="#cb10-236" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;preview_content&#39;</span>: preview_content,</span>
<span id="cb10-237"><a href="#cb10-237" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;avg_words_per_message&#39;</span>: total_words <span class="op">/</span> <span class="bu">max</span>(num_messages, <span class="dv">1</span>),</span>
<span id="cb10-238"><a href="#cb10-238" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;category&#39;</span>: <span class="va">self</span>.categorize_conversation(title)</span>
<span id="cb10-239"><a href="#cb10-239" aria-hidden="true" tabindex="-1"></a>            })</span>
<span id="cb10-240"><a href="#cb10-240" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-241"><a href="#cb10-241" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Ordenar por data (mais recente primeiro)</span></span>
<span id="cb10-242"><a href="#cb10-242" aria-hidden="true" tabindex="-1"></a>        analysis_data.sort(key<span class="op">=</span><span class="kw">lambda</span> x: x[<span class="st">&#39;created_dt&#39;</span>], reverse<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb10-243"><a href="#cb10-243" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-244"><a href="#cb10-244" aria-hidden="true" tabindex="-1"></a>        df <span class="op">=</span> pd.DataFrame(analysis_data)</span>
<span id="cb10-245"><a href="#cb10-245" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-246"><a href="#cb10-246" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> df.empty:</span>
<span id="cb10-247"><a href="#cb10-247" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;üìà Total de conversas analisadas: </span><span class="sc">{</span><span class="bu">len</span>(df)<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb10-248"><a href="#cb10-248" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;üí¨ Total de mensagens: </span><span class="sc">{</span>df[<span class="st">&#39;num_messages&#39;</span>]<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb10-249"><a href="#cb10-249" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;üìù Total de palavras: </span><span class="sc">{</span>df[<span class="st">&#39;total_words&#39;</span>]<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb10-250"><a href="#cb10-250" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;üìÖ Ordena√ß√£o: Mais recente ‚Üí Mais antiga&quot;</span>)</span>
<span id="cb10-251"><a href="#cb10-251" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-252"><a href="#cb10-252" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> df, <span class="va">self</span>.all_messages</span>
<span id="cb10-253"><a href="#cb10-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-254"><a href="#cb10-254" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> categorize_conversation(<span class="va">self</span>, title):</span>
<span id="cb10-255"><a href="#cb10-255" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Categoriza conversas de forma inteligente&quot;&quot;&quot;</span></span>
<span id="cb10-256"><a href="#cb10-256" aria-hidden="true" tabindex="-1"></a>        title_lower <span class="op">=</span> title.lower()</span>
<span id="cb10-257"><a href="#cb10-257" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-258"><a href="#cb10-258" aria-hidden="true" tabindex="-1"></a>        categories <span class="op">=</span> {</span>
<span id="cb10-259"><a href="#cb10-259" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Programa√ß√£o&#39;</span>: [<span class="st">&#39;python&#39;</span>, <span class="st">&#39;programming&#39;</span>, <span class="st">&#39;code&#39;</span>, <span class="st">&#39;script&#39;</span>, <span class="st">&#39;api&#39;</span>, <span class="st">&#39;function&#39;</span>, <span class="st">&#39;class&#39;</span>, <span class="st">&#39;java&#39;</span>, <span class="st">&#39;javascript&#39;</span>, <span class="st">&#39;html&#39;</span>, <span class="st">&#39;css&#39;</span>],</span>
<span id="cb10-260"><a href="#cb10-260" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Sistemas&#39;</span>: [<span class="st">&#39;linux&#39;</span>, <span class="st">&#39;ubuntu&#39;</span>, <span class="st">&#39;windows&#39;</span>, <span class="st">&#39;install&#39;</span>, <span class="st">&#39;os&#39;</span>, <span class="st">&#39;system&#39;</span>, <span class="st">&#39;server&#39;</span>, <span class="st">&#39;terminal&#39;</span>],</span>
<span id="cb10-261"><a href="#cb10-261" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Ambientes&#39;</span>: [<span class="st">&#39;conda&#39;</span>, <span class="st">&#39;anaconda&#39;</span>, <span class="st">&#39;virtualenv&#39;</span>, <span class="st">&#39;package&#39;</span>, <span class="st">&#39;environment&#39;</span>, <span class="st">&#39;venv&#39;</span>, <span class="st">&#39;pip&#39;</span>],</span>
<span id="cb10-262"><a href="#cb10-262" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Exporta√ß√£o&#39;</span>: [<span class="st">&#39;markdown&#39;</span>, <span class="st">&#39;pdf&#39;</span>, <span class="st">&#39;export&#39;</span>, <span class="st">&#39;convert&#39;</span>, <span class="st">&#39;conversion&#39;</span>, <span class="st">&#39;exportar&#39;</span>],</span>
<span id="cb10-263"><a href="#cb10-263" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Terminal&#39;</span>: [<span class="st">&#39;msys2&#39;</span>, <span class="st">&#39;terminal&#39;</span>, <span class="st">&#39;command&#39;</span>, <span class="st">&#39;shell&#39;</span>, <span class="st">&#39;bash&#39;</span>, <span class="st">&#39;cmd&#39;</span>, <span class="st">&#39;prompt&#39;</span>],</span>
<span id="cb10-264"><a href="#cb10-264" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;IA&#39;</span>: [<span class="st">&#39;ai&#39;</span>, <span class="st">&#39;gpt&#39;</span>, <span class="st">&#39;model&#39;</span>, <span class="st">&#39;neural&#39;</span>, <span class="st">&#39;machine learning&#39;</span>, <span class="st">&#39;deep learning&#39;</span>, <span class="st">&#39;llm&#39;</span>],</span>
<span id="cb10-265"><a href="#cb10-265" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Dados&#39;</span>: [<span class="st">&#39;data&#39;</span>, <span class="st">&#39;analysis&#39;</span>, <span class="st">&#39;pandas&#39;</span>, <span class="st">&#39;dataframe&#39;</span>, <span class="st">&#39;csv&#39;</span>, <span class="st">&#39;excel&#39;</span>, <span class="st">&#39;database&#39;</span>],</span>
<span id="cb10-266"><a href="#cb10-266" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Web&#39;</span>: [<span class="st">&#39;web&#39;</span>, <span class="st">&#39;browser&#39;</span>, <span class="st">&#39;http&#39;</span>, <span class="st">&#39;website&#39;</span>, <span class="st">&#39;url&#39;</span>, <span class="st">&#39;internet&#39;</span>],</span>
<span id="cb10-267"><a href="#cb10-267" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Configura√ß√£o&#39;</span>: [<span class="st">&#39;config&#39;</span>, <span class="st">&#39;setup&#39;</span>, <span class="st">&#39;install&#39;</span>, <span class="st">&#39;configure&#39;</span>, <span class="st">&#39;settings&#39;</span>],</span>
<span id="cb10-268"><a href="#cb10-268" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Ajuda&#39;</span>: [<span class="st">&#39;help&#39;</span>, <span class="st">&#39;ajuda&#39;</span>, <span class="st">&#39;como&#39;</span>, <span class="st">&#39;tutorial&#39;</span>, <span class="st">&#39;guide&#39;</span>, <span class="st">&#39;manual&#39;</span>]</span>
<span id="cb10-269"><a href="#cb10-269" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb10-270"><a href="#cb10-270" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-271"><a href="#cb10-271" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> category, keywords <span class="kw">in</span> categories.items():</span>
<span id="cb10-272"><a href="#cb10-272" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">any</span>(keyword <span class="kw">in</span> title_lower <span class="cf">for</span> keyword <span class="kw">in</span> keywords):</span>
<span id="cb10-273"><a href="#cb10-273" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> category</span>
<span id="cb10-274"><a href="#cb10-274" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-275"><a href="#cb10-275" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">&#39;Geral&#39;</span></span>
<span id="cb10-276"><a href="#cb10-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-277"><a href="#cb10-277" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_markdown_files(<span class="va">self</span>, df):</span>
<span id="cb10-278"><a href="#cb10-278" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Cria arquivos Markdown otimizados&quot;&quot;&quot;</span></span>
<span id="cb10-279"><a href="#cb10-279" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;üìù Criando arquivos Markdown...&quot;</span>)</span>
<span id="cb10-280"><a href="#cb10-280" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-281"><a href="#cb10-281" aria-hidden="true" tabindex="-1"></a>        created_files <span class="op">=</span> []</span>
<span id="cb10-282"><a href="#cb10-282" aria-hidden="true" tabindex="-1"></a>        skipped_generic <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb10-283"><a href="#cb10-283" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-284"><a href="#cb10-284" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> _, row <span class="kw">in</span> df.iterrows():</span>
<span id="cb10-285"><a href="#cb10-285" aria-hidden="true" tabindex="-1"></a>            safe_title <span class="op">=</span> <span class="va">self</span>.create_safe_filename(row[<span class="st">&#39;title&#39;</span>])</span>
<span id="cb10-286"><a href="#cb10-286" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb10-287"><a href="#cb10-287" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Pular t√≠tulos gen√©ricos</span></span>
<span id="cb10-288"><a href="#cb10-288" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="va">self</span>.is_generic_title(safe_title):</span>
<span id="cb10-289"><a href="#cb10-289" aria-hidden="true" tabindex="-1"></a>                skipped_generic <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb10-290"><a href="#cb10-290" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span></span>
<span id="cb10-291"><a href="#cb10-291" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb10-292"><a href="#cb10-292" aria-hidden="true" tabindex="-1"></a>            conv_messages <span class="op">=</span> [msg <span class="cf">for</span> msg <span class="kw">in</span> <span class="va">self</span>.all_messages </span>
<span id="cb10-293"><a href="#cb10-293" aria-hidden="true" tabindex="-1"></a>                           <span class="cf">if</span> msg[<span class="st">&#39;conversation_id&#39;</span>] <span class="op">==</span> row[<span class="st">&#39;conversation_id&#39;</span>]]</span>
<span id="cb10-294"><a href="#cb10-294" aria-hidden="true" tabindex="-1"></a>            conv_messages.sort(key<span class="op">=</span><span class="kw">lambda</span> x: x[<span class="st">&#39;message_index&#39;</span>])</span>
<span id="cb10-295"><a href="#cb10-295" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb10-296"><a href="#cb10-296" aria-hidden="true" tabindex="-1"></a>            md_content <span class="op">=</span> <span class="va">self</span>.generate_markdown_content(row, conv_messages)</span>
<span id="cb10-297"><a href="#cb10-297" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb10-298"><a href="#cb10-298" aria-hidden="true" tabindex="-1"></a>            md_filename <span class="op">=</span> <span class="ss">f&quot;</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>markdown_folder<span class="sc">}</span><span class="ss">/</span><span class="sc">{</span>safe_title<span class="sc">}</span><span class="ss">.md&quot;</span></span>
<span id="cb10-299"><a href="#cb10-299" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(md_filename, <span class="st">&#39;w&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb10-300"><a href="#cb10-300" aria-hidden="true" tabindex="-1"></a>                f.write(md_content)</span>
<span id="cb10-301"><a href="#cb10-301" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb10-302"><a href="#cb10-302" aria-hidden="true" tabindex="-1"></a>            created_files.append(md_filename)</span>
<span id="cb10-303"><a href="#cb10-303" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-304"><a href="#cb10-304" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ </span><span class="sc">{</span><span class="bu">len</span>(created_files)<span class="sc">}</span><span class="ss"> arquivos Markdown criados&quot;</span>)</span>
<span id="cb10-305"><a href="#cb10-305" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> skipped_generic <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb10-306"><a href="#cb10-306" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚ö†Ô∏è  </span><span class="sc">{</span>skipped_generic<span class="sc">}</span><span class="ss"> conversas com t√≠tulos gen√©ricos ignoradas&quot;</span>)</span>
<span id="cb10-307"><a href="#cb10-307" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> created_files</span>
<span id="cb10-308"><a href="#cb10-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-309"><a href="#cb10-309" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_safe_filename(<span class="va">self</span>, title):</span>
<span id="cb10-310"><a href="#cb10-310" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Cria nome de arquivo seguro&quot;&quot;&quot;</span></span>
<span id="cb10-311"><a href="#cb10-311" aria-hidden="true" tabindex="-1"></a>        safe <span class="op">=</span> <span class="st">&quot;&quot;</span>.join(c <span class="cf">for</span> c <span class="kw">in</span> title <span class="cf">if</span> c.isalnum() <span class="kw">or</span> c <span class="kw">in</span> (<span class="st">&#39; &#39;</span>, <span class="st">&#39;-&#39;</span>, <span class="st">&#39;_&#39;</span>)).rstrip()</span>
<span id="cb10-312"><a href="#cb10-312" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> safe[:<span class="dv">50</span>] <span class="cf">if</span> safe <span class="cf">else</span> <span class="ss">f&quot;conversa_</span><span class="sc">{</span><span class="bu">int</span>(datetime.now().timestamp())<span class="sc">}</span><span class="ss">&quot;</span></span>
<span id="cb10-313"><a href="#cb10-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-314"><a href="#cb10-314" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> is_generic_title(<span class="va">self</span>, title):</span>
<span id="cb10-315"><a href="#cb10-315" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Verifica se o t√≠tulo √© gen√©rico&quot;&quot;&quot;</span></span>
<span id="cb10-316"><a href="#cb10-316" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">bool</span>(re.match(<span class="vs">r&#39;</span><span class="dv">^</span><span class="kw">(</span><span class="vs">conversa</span><span class="cf">|</span><span class="vs">conv</span><span class="cf">|</span><span class="vs">chat</span><span class="kw">)</span><span class="dv">\s</span><span class="op">*</span><span class="dv">\d</span><span class="op">+</span><span class="dv">$</span><span class="vs">&#39;</span>, title.lower()))</span>
<span id="cb10-317"><a href="#cb10-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-318"><a href="#cb10-318" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> generate_markdown_content(<span class="va">self</span>, row, messages):</span>
<span id="cb10-319"><a href="#cb10-319" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Gera conte√∫do Markdown formatado usando &#39;Utilizador&#39; em vez de &#39;Usu√°rio&#39;&quot;&quot;&quot;</span></span>
<span id="cb10-320"><a href="#cb10-320" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Formatar data para exibi√ß√£o</span></span>
<span id="cb10-321"><a href="#cb10-321" aria-hidden="true" tabindex="-1"></a>        created_date <span class="op">=</span> <span class="st">&quot;&quot;</span></span>
<span id="cb10-322"><a href="#cb10-322" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> pd.notna(row.get(<span class="st">&#39;created_at&#39;</span>)):</span>
<span id="cb10-323"><a href="#cb10-323" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb10-324"><a href="#cb10-324" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="bu">hasattr</span>(row[<span class="st">&#39;created_at&#39;</span>], <span class="st">&#39;strftime&#39;</span>):</span>
<span id="cb10-325"><a href="#cb10-325" aria-hidden="true" tabindex="-1"></a>                    created_date <span class="op">=</span> row[<span class="st">&#39;created_at&#39;</span>].strftime(<span class="st">&#39;%Y-%m-</span><span class="sc">%d</span><span class="st"> %H:%M:%S&#39;</span>)</span>
<span id="cb10-326"><a href="#cb10-326" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb10-327"><a href="#cb10-327" aria-hidden="true" tabindex="-1"></a>                    created_date <span class="op">=</span> <span class="bu">str</span>(row[<span class="st">&#39;created_at&#39;</span>])</span>
<span id="cb10-328"><a href="#cb10-328" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span>:</span>
<span id="cb10-329"><a href="#cb10-329" aria-hidden="true" tabindex="-1"></a>                created_date <span class="op">=</span> <span class="bu">str</span>(row[<span class="st">&#39;created_at&#39;</span>])</span>
<span id="cb10-330"><a href="#cb10-330" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-331"><a href="#cb10-331" aria-hidden="true" tabindex="-1"></a>        content <span class="op">=</span> <span class="ss">f&quot;&quot;&quot;# </span><span class="sc">{</span>row[<span class="st">&#39;title&#39;</span>]<span class="sc">}</span></span>
<span id="cb10-332"><a href="#cb10-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-333"><a href="#cb10-333" aria-hidden="true" tabindex="-1"></a><span class="ss">**ID**: </span><span class="sc">{</span>row[<span class="st">&#39;conversation_id&#39;</span>]<span class="sc">}</span><span class="ss">  </span></span>
<span id="cb10-334"><a href="#cb10-334" aria-hidden="true" tabindex="-1"></a><span class="ss">**Categoria**: </span><span class="sc">{</span>row[<span class="st">&#39;category&#39;</span>]<span class="sc">}</span><span class="ss">  </span></span>
<span id="cb10-335"><a href="#cb10-335" aria-hidden="true" tabindex="-1"></a><span class="ss">**Data**: </span><span class="sc">{</span>created_date<span class="sc">}</span><span class="ss">  </span></span>
<span id="cb10-336"><a href="#cb10-336" aria-hidden="true" tabindex="-1"></a><span class="ss">**Total de Mensagens**: </span><span class="sc">{</span>row[<span class="st">&#39;num_messages&#39;</span>]<span class="sc">}</span><span class="ss">  </span></span>
<span id="cb10-337"><a href="#cb10-337" aria-hidden="true" tabindex="-1"></a><span class="ss">**Total de Palavras**: </span><span class="sc">{</span>row[<span class="st">&#39;total_words&#39;</span>]<span class="sc">}</span><span class="ss">  </span></span>
<span id="cb10-338"><a href="#cb10-338" aria-hidden="true" tabindex="-1"></a><span class="ss">**Total de Caracteres**: </span><span class="sc">{</span>row[<span class="st">&#39;total_chars&#39;</span>]<span class="sc">}</span><span class="ss">  </span></span>
<span id="cb10-339"><a href="#cb10-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-340"><a href="#cb10-340" aria-hidden="true" tabindex="-1"></a><span class="ss">---</span></span>
<span id="cb10-341"><a href="#cb10-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-342"><a href="#cb10-342" aria-hidden="true" tabindex="-1"></a><span class="ss">&quot;&quot;&quot;</span></span>
<span id="cb10-343"><a href="#cb10-343" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-344"><a href="#cb10-344" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> msg <span class="kw">in</span> messages:</span>
<span id="cb10-345"><a href="#cb10-345" aria-hidden="true" tabindex="-1"></a>            role_emoji <span class="op">=</span> <span class="st">&quot;üë§&quot;</span> <span class="cf">if</span> msg[<span class="st">&#39;role&#39;</span>] <span class="op">==</span> <span class="st">&#39;user&#39;</span> <span class="cf">else</span> <span class="st">&quot;ü§ñ&quot;</span></span>
<span id="cb10-346"><a href="#cb10-346" aria-hidden="true" tabindex="-1"></a>            <span class="co"># CORRE√á√ÉO: Usar &quot;Utilizador&quot; em vez de &quot;Usu√°rio&quot;</span></span>
<span id="cb10-347"><a href="#cb10-347" aria-hidden="true" tabindex="-1"></a>            role_name <span class="op">=</span> <span class="st">&quot;Utilizador&quot;</span> <span class="cf">if</span> msg[<span class="st">&#39;role&#39;</span>] <span class="op">==</span> <span class="st">&#39;user&#39;</span> <span class="cf">else</span> <span class="st">&quot;Grok&quot;</span></span>
<span id="cb10-348"><a href="#cb10-348" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb10-349"><a href="#cb10-349" aria-hidden="true" tabindex="-1"></a>            content <span class="op">+=</span> <span class="ss">f&quot;&quot;&quot;</span></span>
<span id="cb10-350"><a href="#cb10-350" aria-hidden="true" tabindex="-1"></a><span class="ss">## </span><span class="sc">{</span>role_emoji<span class="sc">}</span><span class="ss"> </span><span class="sc">{</span>role_name<span class="sc">}</span></span>
<span id="cb10-351"><a href="#cb10-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-352"><a href="#cb10-352" aria-hidden="true" tabindex="-1"></a><span class="sc">{</span>msg[<span class="st">&#39;content&#39;</span>]<span class="sc">}</span></span>
<span id="cb10-353"><a href="#cb10-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-354"><a href="#cb10-354" aria-hidden="true" tabindex="-1"></a><span class="ss">---</span></span>
<span id="cb10-355"><a href="#cb10-355" aria-hidden="true" tabindex="-1"></a><span class="ss">&quot;&quot;&quot;</span></span>
<span id="cb10-356"><a href="#cb10-356" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-357"><a href="#cb10-357" aria-hidden="true" tabindex="-1"></a>        content <span class="op">+=</span> <span class="ss">f&quot;&quot;&quot;</span></span>
<span id="cb10-358"><a href="#cb10-358" aria-hidden="true" tabindex="-1"></a><span class="ss">## üìä Estat√≠sticas Detalhadas</span></span>
<span id="cb10-359"><a href="#cb10-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-360"><a href="#cb10-360" aria-hidden="true" tabindex="-1"></a><span class="ss">- **Mensagens do utilizador**: </span><span class="sc">{</span>row[<span class="st">&#39;user_messages&#39;</span>]<span class="sc">}</span></span>
<span id="cb10-361"><a href="#cb10-361" aria-hidden="true" tabindex="-1"></a><span class="ss">- **Mensagens do Grok**: </span><span class="sc">{</span>row[<span class="st">&#39;assistant_messages&#39;</span>]<span class="sc">}</span><span class="ss"> </span></span>
<span id="cb10-362"><a href="#cb10-362" aria-hidden="true" tabindex="-1"></a><span class="ss">- **Palavras do utilizador**: </span><span class="sc">{</span>row[<span class="st">&#39;user_words&#39;</span>]<span class="sc">}</span></span>
<span id="cb10-363"><a href="#cb10-363" aria-hidden="true" tabindex="-1"></a><span class="ss">- **Palavras do Grok**: </span><span class="sc">{</span>row[<span class="st">&#39;assistant_words&#39;</span>]<span class="sc">}</span></span>
<span id="cb10-364"><a href="#cb10-364" aria-hidden="true" tabindex="-1"></a><span class="ss">- **Palavras por mensagem (m√©dia)**: </span><span class="sc">{</span>row[<span class="st">&#39;avg_words_per_message&#39;</span>]<span class="sc">:.1f}</span></span>
<span id="cb10-365"><a href="#cb10-365" aria-hidden="true" tabindex="-1"></a><span class="ss">- **Categoria**: </span><span class="sc">{</span>row[<span class="st">&#39;category&#39;</span>]<span class="sc">}</span></span>
<span id="cb10-366"><a href="#cb10-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-367"><a href="#cb10-367" aria-hidden="true" tabindex="-1"></a><span class="ss">*Exportado automaticamente em </span><span class="sc">{</span>datetime<span class="sc">.</span>now()<span class="sc">.</span>strftime(<span class="st">&#39;</span><span class="sc">%d</span><span class="st">/%m/%Y √†s %H:%M&#39;</span>)<span class="sc">}</span><span class="ss">*</span></span>
<span id="cb10-368"><a href="#cb10-368" aria-hidden="true" tabindex="-1"></a><span class="ss">&quot;&quot;&quot;</span></span>
<span id="cb10-369"><a href="#cb10-369" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> content</span>
<span id="cb10-370"><a href="#cb10-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-371"><a href="#cb10-371" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_searchable_index(<span class="va">self</span>, df):</span>
<span id="cb10-372"><a href="#cb10-372" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Cria √≠ndice pesquis√°vel em HTML semelhante ao ChatGPT&quot;&quot;&quot;</span></span>
<span id="cb10-373"><a href="#cb10-373" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;üéØ Criando √≠ndice pesquis√°vel...&quot;</span>)</span>
<span id="cb10-374"><a href="#cb10-374" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-375"><a href="#cb10-375" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Filtrar conversas n√£o gen√©ricas para o √≠ndice</span></span>
<span id="cb10-376"><a href="#cb10-376" aria-hidden="true" tabindex="-1"></a>        saved_conversations <span class="op">=</span> []</span>
<span id="cb10-377"><a href="#cb10-377" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> _, row <span class="kw">in</span> df.iterrows():</span>
<span id="cb10-378"><a href="#cb10-378" aria-hidden="true" tabindex="-1"></a>            safe_title <span class="op">=</span> <span class="va">self</span>.create_safe_filename(row[<span class="st">&#39;title&#39;</span>])</span>
<span id="cb10-379"><a href="#cb10-379" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.is_generic_title(safe_title):</span>
<span id="cb10-380"><a href="#cb10-380" aria-hidden="true" tabindex="-1"></a>                saved_conversations.append((_, row))</span>
<span id="cb10-381"><a href="#cb10-381" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-382"><a href="#cb10-382" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Estat√≠sticas</span></span>
<span id="cb10-383"><a href="#cb10-383" aria-hidden="true" tabindex="-1"></a>        total_conv <span class="op">=</span> <span class="bu">len</span>(saved_conversations)</span>
<span id="cb10-384"><a href="#cb10-384" aria-hidden="true" tabindex="-1"></a>        total_msgs <span class="op">=</span> <span class="bu">sum</span>(row[<span class="st">&#39;num_messages&#39;</span>] <span class="cf">for</span> _, row <span class="kw">in</span> saved_conversations)</span>
<span id="cb10-385"><a href="#cb10-385" aria-hidden="true" tabindex="-1"></a>        total_words <span class="op">=</span> <span class="bu">sum</span>(row[<span class="st">&#39;total_words&#39;</span>] <span class="cf">for</span> _, row <span class="kw">in</span> saved_conversations)</span>
<span id="cb10-386"><a href="#cb10-386" aria-hidden="true" tabindex="-1"></a>        total_chars <span class="op">=</span> <span class="bu">sum</span>(row[<span class="st">&#39;total_chars&#39;</span>] <span class="cf">for</span> _, row <span class="kw">in</span> saved_conversations)</span>
<span id="cb10-387"><a href="#cb10-387" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-388"><a href="#cb10-388" aria-hidden="true" tabindex="-1"></a>        html_content <span class="op">=</span> <span class="va">self</span>.generate_index_html(saved_conversations, total_conv, total_msgs, total_words, total_chars)</span>
<span id="cb10-389"><a href="#cb10-389" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-390"><a href="#cb10-390" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> <span class="bu">open</span>(<span class="va">self</span>.index_file, <span class="st">&quot;w&quot;</span>, encoding<span class="op">=</span><span class="st">&quot;utf-8&quot;</span>) <span class="im">as</span> f:</span>
<span id="cb10-391"><a href="#cb10-391" aria-hidden="true" tabindex="-1"></a>            f.write(html_content)</span>
<span id="cb10-392"><a href="#cb10-392" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-393"><a href="#cb10-393" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ √çndice pesquis√°vel criado: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>index_file<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb10-394"><a href="#cb10-394" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.index_file</span>
<span id="cb10-395"><a href="#cb10-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-396"><a href="#cb10-396" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> generate_index_html(<span class="va">self</span>, conversations, total_conv, total_msgs, total_words, total_chars):</span>
<span id="cb10-397"><a href="#cb10-397" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Gera HTML do √≠ndice pesquis√°vel&quot;&quot;&quot;</span></span>
<span id="cb10-398"><a href="#cb10-398" aria-hidden="true" tabindex="-1"></a>        current_date <span class="op">=</span> datetime.now().strftime(<span class="st">&#39;</span><span class="sc">%d</span><span class="st">/%m/%Y √†s %H:%M&#39;</span>)</span>
<span id="cb10-399"><a href="#cb10-399" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-400"><a href="#cb10-400" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="ss">f&quot;&quot;&quot;</span></span>
<span id="cb10-401"><a href="#cb10-401" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;!DOCTYPE html&gt;</span></span>
<span id="cb10-402"><a href="#cb10-402" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;html lang=&quot;pt&quot;&gt;</span></span>
<span id="cb10-403"><a href="#cb10-403" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;head&gt;</span></span>
<span id="cb10-404"><a href="#cb10-404" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span></span>
<span id="cb10-405"><a href="#cb10-405" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span></span>
<span id="cb10-406"><a href="#cb10-406" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;title&gt;ü§ñ Grok - Hist√≥rico Completo&lt;/title&gt;</span></span>
<span id="cb10-407"><a href="#cb10-407" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;style&gt;</span></span>
<span id="cb10-408"><a href="#cb10-408" aria-hidden="true" tabindex="-1"></a><span class="ss">        * </span><span class="ch">{{</span></span>
<span id="cb10-409"><a href="#cb10-409" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin: 0;</span></span>
<span id="cb10-410"><a href="#cb10-410" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 0;</span></span>
<span id="cb10-411"><a href="#cb10-411" aria-hidden="true" tabindex="-1"></a><span class="ss">            box-sizing: border-box;</span></span>
<span id="cb10-412"><a href="#cb10-412" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-413"><a href="#cb10-413" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb10-414"><a href="#cb10-414" aria-hidden="true" tabindex="-1"></a><span class="ss">        body </span><span class="ch">{{</span></span>
<span id="cb10-415"><a href="#cb10-415" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-family: &#39;Segoe UI&#39;, Tahoma, Geneva, Verdana, sans-serif;</span></span>
<span id="cb10-416"><a href="#cb10-416" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);</span></span>
<span id="cb10-417"><a href="#cb10-417" aria-hidden="true" tabindex="-1"></a><span class="ss">            min-height: 100vh;</span></span>
<span id="cb10-418"><a href="#cb10-418" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 20px;</span></span>
<span id="cb10-419"><a href="#cb10-419" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-420"><a href="#cb10-420" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb10-421"><a href="#cb10-421" aria-hidden="true" tabindex="-1"></a><span class="ss">        .container </span><span class="ch">{{</span></span>
<span id="cb10-422"><a href="#cb10-422" aria-hidden="true" tabindex="-1"></a><span class="ss">            max-width: 1400px;</span></span>
<span id="cb10-423"><a href="#cb10-423" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin: 0 auto;</span></span>
<span id="cb10-424"><a href="#cb10-424" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: white;</span></span>
<span id="cb10-425"><a href="#cb10-425" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 15px;</span></span>
<span id="cb10-426"><a href="#cb10-426" aria-hidden="true" tabindex="-1"></a><span class="ss">            box-shadow: 0 20px 40px rgba(0,0,0,0.1);</span></span>
<span id="cb10-427"><a href="#cb10-427" aria-hidden="true" tabindex="-1"></a><span class="ss">            overflow: hidden;</span></span>
<span id="cb10-428"><a href="#cb10-428" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-429"><a href="#cb10-429" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb10-430"><a href="#cb10-430" aria-hidden="true" tabindex="-1"></a><span class="ss">        .header </span><span class="ch">{{</span></span>
<span id="cb10-431"><a href="#cb10-431" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: linear-gradient(135deg, #2c3e50, #34495e);</span></span>
<span id="cb10-432"><a href="#cb10-432" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: white;</span></span>
<span id="cb10-433"><a href="#cb10-433" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 40px;</span></span>
<span id="cb10-434"><a href="#cb10-434" aria-hidden="true" tabindex="-1"></a><span class="ss">            text-align: center;</span></span>
<span id="cb10-435"><a href="#cb10-435" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-436"><a href="#cb10-436" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb10-437"><a href="#cb10-437" aria-hidden="true" tabindex="-1"></a><span class="ss">        .header h1 </span><span class="ch">{{</span></span>
<span id="cb10-438"><a href="#cb10-438" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 2.8em;</span></span>
<span id="cb10-439"><a href="#cb10-439" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-bottom: 10px;</span></span>
<span id="cb10-440"><a href="#cb10-440" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-441"><a href="#cb10-441" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb10-442"><a href="#cb10-442" aria-hidden="true" tabindex="-1"></a><span class="ss">        .stats </span><span class="ch">{{</span></span>
<span id="cb10-443"><a href="#cb10-443" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: flex;</span></span>
<span id="cb10-444"><a href="#cb10-444" aria-hidden="true" tabindex="-1"></a><span class="ss">            justify-content: center;</span></span>
<span id="cb10-445"><a href="#cb10-445" aria-hidden="true" tabindex="-1"></a><span class="ss">            gap: 30px;</span></span>
<span id="cb10-446"><a href="#cb10-446" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-top: 25px;</span></span>
<span id="cb10-447"><a href="#cb10-447" aria-hidden="true" tabindex="-1"></a><span class="ss">            flex-wrap: wrap;</span></span>
<span id="cb10-448"><a href="#cb10-448" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-449"><a href="#cb10-449" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb10-450"><a href="#cb10-450" aria-hidden="true" tabindex="-1"></a><span class="ss">        .stat-item </span><span class="ch">{{</span></span>
<span id="cb10-451"><a href="#cb10-451" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: rgba(255,255,255,0.15);</span></span>
<span id="cb10-452"><a href="#cb10-452" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 20px 30px;</span></span>
<span id="cb10-453"><a href="#cb10-453" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 12px;</span></span>
<span id="cb10-454"><a href="#cb10-454" aria-hidden="true" tabindex="-1"></a><span class="ss">            backdrop-filter: blur(10px);</span></span>
<span id="cb10-455"><a href="#cb10-455" aria-hidden="true" tabindex="-1"></a><span class="ss">            text-align: center;</span></span>
<span id="cb10-456"><a href="#cb10-456" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-457"><a href="#cb10-457" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb10-458"><a href="#cb10-458" aria-hidden="true" tabindex="-1"></a><span class="ss">        .stat-number </span><span class="ch">{{</span></span>
<span id="cb10-459"><a href="#cb10-459" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 2em;</span></span>
<span id="cb10-460"><a href="#cb10-460" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-weight: bold;</span></span>
<span id="cb10-461"><a href="#cb10-461" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: block;</span></span>
<span id="cb10-462"><a href="#cb10-462" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-bottom: 5px;</span></span>
<span id="cb10-463"><a href="#cb10-463" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-464"><a href="#cb10-464" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb10-465"><a href="#cb10-465" aria-hidden="true" tabindex="-1"></a><span class="ss">        .stat-label </span><span class="ch">{{</span></span>
<span id="cb10-466"><a href="#cb10-466" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.9em;</span></span>
<span id="cb10-467"><a href="#cb10-467" aria-hidden="true" tabindex="-1"></a><span class="ss">            opacity: 0.9;</span></span>
<span id="cb10-468"><a href="#cb10-468" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-469"><a href="#cb10-469" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb10-470"><a href="#cb10-470" aria-hidden="true" tabindex="-1"></a><span class="ss">        .search-section </span><span class="ch">{{</span></span>
<span id="cb10-471"><a href="#cb10-471" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 30px;</span></span>
<span id="cb10-472"><a href="#cb10-472" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #f8f9fa;</span></span>
<span id="cb10-473"><a href="#cb10-473" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-bottom: 1px solid #e9ecef;</span></span>
<span id="cb10-474"><a href="#cb10-474" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-475"><a href="#cb10-475" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb10-476"><a href="#cb10-476" aria-hidden="true" tabindex="-1"></a><span class="ss">        .search-box </span><span class="ch">{{</span></span>
<span id="cb10-477"><a href="#cb10-477" aria-hidden="true" tabindex="-1"></a><span class="ss">            width: 100%;</span></span>
<span id="cb10-478"><a href="#cb10-478" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 18px 25px;</span></span>
<span id="cb10-479"><a href="#cb10-479" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 16px;</span></span>
<span id="cb10-480"><a href="#cb10-480" aria-hidden="true" tabindex="-1"></a><span class="ss">            border: 2px solid #e9ecef;</span></span>
<span id="cb10-481"><a href="#cb10-481" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 25px;</span></span>
<span id="cb10-482"><a href="#cb10-482" aria-hidden="true" tabindex="-1"></a><span class="ss">            outline: none;</span></span>
<span id="cb10-483"><a href="#cb10-483" aria-hidden="true" tabindex="-1"></a><span class="ss">            transition: all 0.3s ease;</span></span>
<span id="cb10-484"><a href="#cb10-484" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 1.1em;</span></span>
<span id="cb10-485"><a href="#cb10-485" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-486"><a href="#cb10-486" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb10-487"><a href="#cb10-487" aria-hidden="true" tabindex="-1"></a><span class="ss">        .search-box:focus </span><span class="ch">{{</span></span>
<span id="cb10-488"><a href="#cb10-488" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-color: #667eea;</span></span>
<span id="cb10-489"><a href="#cb10-489" aria-hidden="true" tabindex="-1"></a><span class="ss">            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);</span></span>
<span id="cb10-490"><a href="#cb10-490" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-491"><a href="#cb10-491" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb10-492"><a href="#cb10-492" aria-hidden="true" tabindex="-1"></a><span class="ss">        .filters </span><span class="ch">{{</span></span>
<span id="cb10-493"><a href="#cb10-493" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: flex;</span></span>
<span id="cb10-494"><a href="#cb10-494" aria-hidden="true" tabindex="-1"></a><span class="ss">            gap: 12px;</span></span>
<span id="cb10-495"><a href="#cb10-495" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-top: 20px;</span></span>
<span id="cb10-496"><a href="#cb10-496" aria-hidden="true" tabindex="-1"></a><span class="ss">            flex-wrap: wrap;</span></span>
<span id="cb10-497"><a href="#cb10-497" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-498"><a href="#cb10-498" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb10-499"><a href="#cb10-499" aria-hidden="true" tabindex="-1"></a><span class="ss">        .filter-btn </span><span class="ch">{{</span></span>
<span id="cb10-500"><a href="#cb10-500" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 10px 20px;</span></span>
<span id="cb10-501"><a href="#cb10-501" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: white;</span></span>
<span id="cb10-502"><a href="#cb10-502" aria-hidden="true" tabindex="-1"></a><span class="ss">            border: 2px solid #e9ecef;</span></span>
<span id="cb10-503"><a href="#cb10-503" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 20px;</span></span>
<span id="cb10-504"><a href="#cb10-504" aria-hidden="true" tabindex="-1"></a><span class="ss">            cursor: pointer;</span></span>
<span id="cb10-505"><a href="#cb10-505" aria-hidden="true" tabindex="-1"></a><span class="ss">            transition: all 0.3s ease;</span></span>
<span id="cb10-506"><a href="#cb10-506" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-weight: 500;</span></span>
<span id="cb10-507"><a href="#cb10-507" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-508"><a href="#cb10-508" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb10-509"><a href="#cb10-509" aria-hidden="true" tabindex="-1"></a><span class="ss">        .filter-btn:hover, .filter-btn.active </span><span class="ch">{{</span></span>
<span id="cb10-510"><a href="#cb10-510" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #667eea;</span></span>
<span id="cb10-511"><a href="#cb10-511" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: white;</span></span>
<span id="cb10-512"><a href="#cb10-512" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-color: #667eea;</span></span>
<span id="cb10-513"><a href="#cb10-513" aria-hidden="true" tabindex="-1"></a><span class="ss">            transform: translateY(-2px);</span></span>
<span id="cb10-514"><a href="#cb10-514" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-515"><a href="#cb10-515" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb10-516"><a href="#cb10-516" aria-hidden="true" tabindex="-1"></a><span class="ss">        .conversations-grid </span><span class="ch">{{</span></span>
<span id="cb10-517"><a href="#cb10-517" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: grid;</span></span>
<span id="cb10-518"><a href="#cb10-518" aria-hidden="true" tabindex="-1"></a><span class="ss">            grid-template-columns: repeat(auto-fill, minmax(400px, 1fr));</span></span>
<span id="cb10-519"><a href="#cb10-519" aria-hidden="true" tabindex="-1"></a><span class="ss">            gap: 25px;</span></span>
<span id="cb10-520"><a href="#cb10-520" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 35px;</span></span>
<span id="cb10-521"><a href="#cb10-521" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-522"><a href="#cb10-522" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb10-523"><a href="#cb10-523" aria-hidden="true" tabindex="-1"></a><span class="ss">        .conversation-card </span><span class="ch">{{</span></span>
<span id="cb10-524"><a href="#cb10-524" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: white;</span></span>
<span id="cb10-525"><a href="#cb10-525" aria-hidden="true" tabindex="-1"></a><span class="ss">            border: 1px solid #e9ecef;</span></span>
<span id="cb10-526"><a href="#cb10-526" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 15px;</span></span>
<span id="cb10-527"><a href="#cb10-527" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 25px;</span></span>
<span id="cb10-528"><a href="#cb10-528" aria-hidden="true" tabindex="-1"></a><span class="ss">            transition: all 0.3s ease;</span></span>
<span id="cb10-529"><a href="#cb10-529" aria-hidden="true" tabindex="-1"></a><span class="ss">            cursor: pointer;</span></span>
<span id="cb10-530"><a href="#cb10-530" aria-hidden="true" tabindex="-1"></a><span class="ss">            position: relative;</span></span>
<span id="cb10-531"><a href="#cb10-531" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-left: 5px solid #667eea;</span></span>
<span id="cb10-532"><a href="#cb10-532" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-533"><a href="#cb10-533" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb10-534"><a href="#cb10-534" aria-hidden="true" tabindex="-1"></a><span class="ss">        .conversation-card:hover </span><span class="ch">{{</span></span>
<span id="cb10-535"><a href="#cb10-535" aria-hidden="true" tabindex="-1"></a><span class="ss">            transform: translateY(-8px);</span></span>
<span id="cb10-536"><a href="#cb10-536" aria-hidden="true" tabindex="-1"></a><span class="ss">            box-shadow: 0 15px 35px rgba(0,0,0,0.15);</span></span>
<span id="cb10-537"><a href="#cb10-537" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-left-color: #764ba2;</span></span>
<span id="cb10-538"><a href="#cb10-538" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-539"><a href="#cb10-539" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb10-540"><a href="#cb10-540" aria-hidden="true" tabindex="-1"></a><span class="ss">        .card-header </span><span class="ch">{{</span></span>
<span id="cb10-541"><a href="#cb10-541" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: flex;</span></span>
<span id="cb10-542"><a href="#cb10-542" aria-hidden="true" tabindex="-1"></a><span class="ss">            justify-content: space-between;</span></span>
<span id="cb10-543"><a href="#cb10-543" aria-hidden="true" tabindex="-1"></a><span class="ss">            align-items: flex-start;</span></span>
<span id="cb10-544"><a href="#cb10-544" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-bottom: 15px;</span></span>
<span id="cb10-545"><a href="#cb10-545" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-546"><a href="#cb10-546" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb10-547"><a href="#cb10-547" aria-hidden="true" tabindex="-1"></a><span class="ss">        .card-category </span><span class="ch">{{</span></span>
<span id="cb10-548"><a href="#cb10-548" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #667eea;</span></span>
<span id="cb10-549"><a href="#cb10-549" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: white;</span></span>
<span id="cb10-550"><a href="#cb10-550" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 6px 15px;</span></span>
<span id="cb10-551"><a href="#cb10-551" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 20px;</span></span>
<span id="cb10-552"><a href="#cb10-552" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.85em;</span></span>
<span id="cb10-553"><a href="#cb10-553" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-weight: 600;</span></span>
<span id="cb10-554"><a href="#cb10-554" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-555"><a href="#cb10-555" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb10-556"><a href="#cb10-556" aria-hidden="true" tabindex="-1"></a><span class="ss">        .card-number </span><span class="ch">{{</span></span>
<span id="cb10-557"><a href="#cb10-557" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 1.1em;</span></span>
<span id="cb10-558"><a href="#cb10-558" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-weight: bold;</span></span>
<span id="cb10-559"><a href="#cb10-559" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #868e96;</span></span>
<span id="cb10-560"><a href="#cb10-560" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-561"><a href="#cb10-561" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb10-562"><a href="#cb10-562" aria-hidden="true" tabindex="-1"></a><span class="ss">        .card-title </span><span class="ch">{{</span></span>
<span id="cb10-563"><a href="#cb10-563" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 1.3em;</span></span>
<span id="cb10-564"><a href="#cb10-564" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-weight: 700;</span></span>
<span id="cb10-565"><a href="#cb10-565" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #2c3e50;</span></span>
<span id="cb10-566"><a href="#cb10-566" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-bottom: 12px;</span></span>
<span id="cb10-567"><a href="#cb10-567" aria-hidden="true" tabindex="-1"></a><span class="ss">            line-height: 1.4;</span></span>
<span id="cb10-568"><a href="#cb10-568" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-569"><a href="#cb10-569" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb10-570"><a href="#cb10-570" aria-hidden="true" tabindex="-1"></a><span class="ss">        .card-preview </span><span class="ch">{{</span></span>
<span id="cb10-571"><a href="#cb10-571" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #6c757d;</span></span>
<span id="cb10-572"><a href="#cb10-572" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.95em;</span></span>
<span id="cb10-573"><a href="#cb10-573" aria-hidden="true" tabindex="-1"></a><span class="ss">            line-height: 1.5;</span></span>
<span id="cb10-574"><a href="#cb10-574" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-bottom: 20px;</span></span>
<span id="cb10-575"><a href="#cb10-575" aria-hidden="true" tabindex="-1"></a><span class="ss">            max-height: 80px;</span></span>
<span id="cb10-576"><a href="#cb10-576" aria-hidden="true" tabindex="-1"></a><span class="ss">            overflow: hidden;</span></span>
<span id="cb10-577"><a href="#cb10-577" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-578"><a href="#cb10-578" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb10-579"><a href="#cb10-579" aria-hidden="true" tabindex="-1"></a><span class="ss">        .card-stats </span><span class="ch">{{</span></span>
<span id="cb10-580"><a href="#cb10-580" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: grid;</span></span>
<span id="cb10-581"><a href="#cb10-581" aria-hidden="true" tabindex="-1"></a><span class="ss">            grid-template-columns: repeat(2, 1fr);</span></span>
<span id="cb10-582"><a href="#cb10-582" aria-hidden="true" tabindex="-1"></a><span class="ss">            gap: 10px;</span></span>
<span id="cb10-583"><a href="#cb10-583" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-bottom: 20px;</span></span>
<span id="cb10-584"><a href="#cb10-584" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-585"><a href="#cb10-585" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb10-586"><a href="#cb10-586" aria-hidden="true" tabindex="-1"></a><span class="ss">        .stat-box </span><span class="ch">{{</span></span>
<span id="cb10-587"><a href="#cb10-587" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #f8f9fa;</span></span>
<span id="cb10-588"><a href="#cb10-588" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 12px;</span></span>
<span id="cb10-589"><a href="#cb10-589" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 8px;</span></span>
<span id="cb10-590"><a href="#cb10-590" aria-hidden="true" tabindex="-1"></a><span class="ss">            text-align: center;</span></span>
<span id="cb10-591"><a href="#cb10-591" aria-hidden="true" tabindex="-1"></a><span class="ss">            border: 1px solid #e9ecef;</span></span>
<span id="cb10-592"><a href="#cb10-592" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-593"><a href="#cb10-593" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb10-594"><a href="#cb10-594" aria-hidden="true" tabindex="-1"></a><span class="ss">        .stat-value </span><span class="ch">{{</span></span>
<span id="cb10-595"><a href="#cb10-595" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 1.3em;</span></span>
<span id="cb10-596"><a href="#cb10-596" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-weight: bold;</span></span>
<span id="cb10-597"><a href="#cb10-597" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #2c3e50;</span></span>
<span id="cb10-598"><a href="#cb10-598" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: block;</span></span>
<span id="cb10-599"><a href="#cb10-599" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-600"><a href="#cb10-600" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb10-601"><a href="#cb10-601" aria-hidden="true" tabindex="-1"></a><span class="ss">        .stat-name </span><span class="ch">{{</span></span>
<span id="cb10-602"><a href="#cb10-602" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.8em;</span></span>
<span id="cb10-603"><a href="#cb10-603" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #7f8c8d;</span></span>
<span id="cb10-604"><a href="#cb10-604" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-top: 3px;</span></span>
<span id="cb10-605"><a href="#cb10-605" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-606"><a href="#cb10-606" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb10-607"><a href="#cb10-607" aria-hidden="true" tabindex="-1"></a><span class="ss">        .card-meta </span><span class="ch">{{</span></span>
<span id="cb10-608"><a href="#cb10-608" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: flex;</span></span>
<span id="cb10-609"><a href="#cb10-609" aria-hidden="true" tabindex="-1"></a><span class="ss">            justify-content: space-between;</span></span>
<span id="cb10-610"><a href="#cb10-610" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.85em;</span></span>
<span id="cb10-611"><a href="#cb10-611" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #868e96;</span></span>
<span id="cb10-612"><a href="#cb10-612" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-top: 1px solid #e9ecef;</span></span>
<span id="cb10-613"><a href="#cb10-613" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding-top: 15px;</span></span>
<span id="cb10-614"><a href="#cb10-614" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-615"><a href="#cb10-615" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb10-616"><a href="#cb10-616" aria-hidden="true" tabindex="-1"></a><span class="ss">        .card-actions </span><span class="ch">{{</span></span>
<span id="cb10-617"><a href="#cb10-617" aria-hidden="true" tabindex="-1"></a><span class="ss">            position: absolute;</span></span>
<span id="cb10-618"><a href="#cb10-618" aria-hidden="true" tabindex="-1"></a><span class="ss">            top: 20px;</span></span>
<span id="cb10-619"><a href="#cb10-619" aria-hidden="true" tabindex="-1"></a><span class="ss">            right: 20px;</span></span>
<span id="cb10-620"><a href="#cb10-620" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: flex;</span></span>
<span id="cb10-621"><a href="#cb10-621" aria-hidden="true" tabindex="-1"></a><span class="ss">            gap: 8px;</span></span>
<span id="cb10-622"><a href="#cb10-622" aria-hidden="true" tabindex="-1"></a><span class="ss">            opacity: 0;</span></span>
<span id="cb10-623"><a href="#cb10-623" aria-hidden="true" tabindex="-1"></a><span class="ss">            transition: opacity 0.3s ease;</span></span>
<span id="cb10-624"><a href="#cb10-624" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-625"><a href="#cb10-625" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb10-626"><a href="#cb10-626" aria-hidden="true" tabindex="-1"></a><span class="ss">        .conversation-card:hover .card-actions </span><span class="ch">{{</span></span>
<span id="cb10-627"><a href="#cb10-627" aria-hidden="true" tabindex="-1"></a><span class="ss">            opacity: 1;</span></span>
<span id="cb10-628"><a href="#cb10-628" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-629"><a href="#cb10-629" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb10-630"><a href="#cb10-630" aria-hidden="true" tabindex="-1"></a><span class="ss">        .action-btn </span><span class="ch">{{</span></span>
<span id="cb10-631"><a href="#cb10-631" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: white;</span></span>
<span id="cb10-632"><a href="#cb10-632" aria-hidden="true" tabindex="-1"></a><span class="ss">            border: 1px solid #e9ecef;</span></span>
<span id="cb10-633"><a href="#cb10-633" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 8px;</span></span>
<span id="cb10-634"><a href="#cb10-634" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 8px 12px;</span></span>
<span id="cb10-635"><a href="#cb10-635" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.85em;</span></span>
<span id="cb10-636"><a href="#cb10-636" aria-hidden="true" tabindex="-1"></a><span class="ss">            cursor: pointer;</span></span>
<span id="cb10-637"><a href="#cb10-637" aria-hidden="true" tabindex="-1"></a><span class="ss">            transition: all 0.3s ease;</span></span>
<span id="cb10-638"><a href="#cb10-638" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-weight: 600;</span></span>
<span id="cb10-639"><a href="#cb10-639" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-640"><a href="#cb10-640" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb10-641"><a href="#cb10-641" aria-hidden="true" tabindex="-1"></a><span class="ss">        .action-btn:hover </span><span class="ch">{{</span></span>
<span id="cb10-642"><a href="#cb10-642" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #667eea;</span></span>
<span id="cb10-643"><a href="#cb10-643" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: white;</span></span>
<span id="cb10-644"><a href="#cb10-644" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-color: #667eea;</span></span>
<span id="cb10-645"><a href="#cb10-645" aria-hidden="true" tabindex="-1"></a><span class="ss">            transform: scale(1.05);</span></span>
<span id="cb10-646"><a href="#cb10-646" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-647"><a href="#cb10-647" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb10-648"><a href="#cb10-648" aria-hidden="true" tabindex="-1"></a><span class="ss">        .btn-md </span><span class="ch">{{</span></span>
<span id="cb10-649"><a href="#cb10-649" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #27ae60;</span></span>
<span id="cb10-650"><a href="#cb10-650" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: white;</span></span>
<span id="cb10-651"><a href="#cb10-651" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-color: #27ae60;</span></span>
<span id="cb10-652"><a href="#cb10-652" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-653"><a href="#cb10-653" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb10-654"><a href="#cb10-654" aria-hidden="true" tabindex="-1"></a><span class="ss">        .btn-pdf </span><span class="ch">{{</span></span>
<span id="cb10-655"><a href="#cb10-655" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #e74c3c;</span></span>
<span id="cb10-656"><a href="#cb10-656" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: white;</span></span>
<span id="cb10-657"><a href="#cb10-657" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-color: #e74c3c;</span></span>
<span id="cb10-658"><a href="#cb10-658" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-659"><a href="#cb10-659" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb10-660"><a href="#cb10-660" aria-hidden="true" tabindex="-1"></a><span class="ss">        .no-results </span><span class="ch">{{</span></span>
<span id="cb10-661"><a href="#cb10-661" aria-hidden="true" tabindex="-1"></a><span class="ss">            grid-column: 1 / -1;</span></span>
<span id="cb10-662"><a href="#cb10-662" aria-hidden="true" tabindex="-1"></a><span class="ss">            text-align: center;</span></span>
<span id="cb10-663"><a href="#cb10-663" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 60px;</span></span>
<span id="cb10-664"><a href="#cb10-664" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #6c757d;</span></span>
<span id="cb10-665"><a href="#cb10-665" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 1.2em;</span></span>
<span id="cb10-666"><a href="#cb10-666" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-667"><a href="#cb10-667" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb10-668"><a href="#cb10-668" aria-hidden="true" tabindex="-1"></a><span class="ss">        .sort-info </span><span class="ch">{{</span></span>
<span id="cb10-669"><a href="#cb10-669" aria-hidden="true" tabindex="-1"></a><span class="ss">            text-align: center;</span></span>
<span id="cb10-670"><a href="#cb10-670" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 15px;</span></span>
<span id="cb10-671"><a href="#cb10-671" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #e8f4f8;</span></span>
<span id="cb10-672"><a href="#cb10-672" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #2c3e50;</span></span>
<span id="cb10-673"><a href="#cb10-673" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-weight: 500;</span></span>
<span id="cb10-674"><a href="#cb10-674" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-bottom: 1px solid #bdc3c7;</span></span>
<span id="cb10-675"><a href="#cb10-675" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-676"><a href="#cb10-676" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb10-677"><a href="#cb10-677" aria-hidden="true" tabindex="-1"></a><span class="ss">        .footer </span><span class="ch">{{</span></span>
<span id="cb10-678"><a href="#cb10-678" aria-hidden="true" tabindex="-1"></a><span class="ss">            text-align: center;</span></span>
<span id="cb10-679"><a href="#cb10-679" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 25px;</span></span>
<span id="cb10-680"><a href="#cb10-680" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #f8f9fa;</span></span>
<span id="cb10-681"><a href="#cb10-681" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #6c757d;</span></span>
<span id="cb10-682"><a href="#cb10-682" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-top: 1px solid #e9ecef;</span></span>
<span id="cb10-683"><a href="#cb10-683" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-684"><a href="#cb10-684" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb10-685"><a href="#cb10-685" aria-hidden="true" tabindex="-1"></a><span class="ss">        @media (max-width: 768px) </span><span class="ch">{{</span></span>
<span id="cb10-686"><a href="#cb10-686" aria-hidden="true" tabindex="-1"></a><span class="ss">            .conversations-grid </span><span class="ch">{{</span></span>
<span id="cb10-687"><a href="#cb10-687" aria-hidden="true" tabindex="-1"></a><span class="ss">                grid-template-columns: 1fr;</span></span>
<span id="cb10-688"><a href="#cb10-688" aria-hidden="true" tabindex="-1"></a><span class="ss">                padding: 20px;</span></span>
<span id="cb10-689"><a href="#cb10-689" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span><span class="ch">}}</span></span>
<span id="cb10-690"><a href="#cb10-690" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span></span>
<span id="cb10-691"><a href="#cb10-691" aria-hidden="true" tabindex="-1"></a><span class="ss">            .header h1 </span><span class="ch">{{</span></span>
<span id="cb10-692"><a href="#cb10-692" aria-hidden="true" tabindex="-1"></a><span class="ss">                font-size: 2.2em;</span></span>
<span id="cb10-693"><a href="#cb10-693" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span><span class="ch">}}</span></span>
<span id="cb10-694"><a href="#cb10-694" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span></span>
<span id="cb10-695"><a href="#cb10-695" aria-hidden="true" tabindex="-1"></a><span class="ss">            .stats </span><span class="ch">{{</span></span>
<span id="cb10-696"><a href="#cb10-696" aria-hidden="true" tabindex="-1"></a><span class="ss">                gap: 15px;</span></span>
<span id="cb10-697"><a href="#cb10-697" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span><span class="ch">}}</span></span>
<span id="cb10-698"><a href="#cb10-698" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span></span>
<span id="cb10-699"><a href="#cb10-699" aria-hidden="true" tabindex="-1"></a><span class="ss">            .stat-item </span><span class="ch">{{</span></span>
<span id="cb10-700"><a href="#cb10-700" aria-hidden="true" tabindex="-1"></a><span class="ss">                padding: 15px 20px;</span></span>
<span id="cb10-701"><a href="#cb10-701" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span><span class="ch">}}</span></span>
<span id="cb10-702"><a href="#cb10-702" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-703"><a href="#cb10-703" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;/style&gt;</span></span>
<span id="cb10-704"><a href="#cb10-704" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;/head&gt;</span></span>
<span id="cb10-705"><a href="#cb10-705" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;body&gt;</span></span>
<span id="cb10-706"><a href="#cb10-706" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;div class=&quot;container&quot;&gt;</span></span>
<span id="cb10-707"><a href="#cb10-707" aria-hidden="true" tabindex="-1"></a><span class="ss">        &lt;div class=&quot;header&quot;&gt;</span></span>
<span id="cb10-708"><a href="#cb10-708" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;h1&gt;ü§ñ Grok - Hist√≥rico Completo&lt;/h1&gt;</span></span>
<span id="cb10-709"><a href="#cb10-709" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;p&gt;Exporta√ß√£o completa com busca e categoriza√ß√£o&lt;/p&gt;</span></span>
<span id="cb10-710"><a href="#cb10-710" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;div class=&quot;stats&quot;&gt;</span></span>
<span id="cb10-711"><a href="#cb10-711" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;div class=&quot;stat-item&quot;&gt;</span></span>
<span id="cb10-712"><a href="#cb10-712" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;span class=&quot;stat-number&quot;&gt;</span><span class="sc">{</span>total_conv<span class="sc">}</span><span class="ss">&lt;/span&gt;</span></span>
<span id="cb10-713"><a href="#cb10-713" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;span class=&quot;stat-label&quot;&gt;Conversas&lt;/span&gt;</span></span>
<span id="cb10-714"><a href="#cb10-714" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;/div&gt;</span></span>
<span id="cb10-715"><a href="#cb10-715" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;div class=&quot;stat-item&quot;&gt;</span></span>
<span id="cb10-716"><a href="#cb10-716" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;span class=&quot;stat-number&quot;&gt;</span><span class="sc">{</span>total_msgs<span class="sc">}</span><span class="ss">&lt;/span&gt;</span></span>
<span id="cb10-717"><a href="#cb10-717" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;span class=&quot;stat-label&quot;&gt;Mensagens&lt;/span&gt;</span></span>
<span id="cb10-718"><a href="#cb10-718" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;/div&gt;</span></span>
<span id="cb10-719"><a href="#cb10-719" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;div class=&quot;stat-item&quot;&gt;</span></span>
<span id="cb10-720"><a href="#cb10-720" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;span class=&quot;stat-number&quot;&gt;</span><span class="sc">{</span>total_words<span class="sc">:,}</span><span class="ss">&lt;/span&gt;</span></span>
<span id="cb10-721"><a href="#cb10-721" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;span class=&quot;stat-label&quot;&gt;Palavras&lt;/span&gt;</span></span>
<span id="cb10-722"><a href="#cb10-722" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;/div&gt;</span></span>
<span id="cb10-723"><a href="#cb10-723" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;div class=&quot;stat-item&quot;&gt;</span></span>
<span id="cb10-724"><a href="#cb10-724" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;span class=&quot;stat-number&quot;&gt;</span><span class="sc">{</span>total_chars<span class="sc">:,}</span><span class="ss">&lt;/span&gt;</span></span>
<span id="cb10-725"><a href="#cb10-725" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;span class=&quot;stat-label&quot;&gt;Caracteres&lt;/span&gt;</span></span>
<span id="cb10-726"><a href="#cb10-726" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;/div&gt;</span></span>
<span id="cb10-727"><a href="#cb10-727" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;/div&gt;</span></span>
<span id="cb10-728"><a href="#cb10-728" aria-hidden="true" tabindex="-1"></a><span class="ss">        &lt;/div&gt;</span></span>
<span id="cb10-729"><a href="#cb10-729" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb10-730"><a href="#cb10-730" aria-hidden="true" tabindex="-1"></a><span class="ss">        &lt;div class=&quot;sort-info&quot;&gt;</span></span>
<span id="cb10-731"><a href="#cb10-731" aria-hidden="true" tabindex="-1"></a><span class="ss">            üìÖ Ordenado por: Mais Recente ‚Üí Mais Antigo</span></span>
<span id="cb10-732"><a href="#cb10-732" aria-hidden="true" tabindex="-1"></a><span class="ss">        &lt;/div&gt;</span></span>
<span id="cb10-733"><a href="#cb10-733" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb10-734"><a href="#cb10-734" aria-hidden="true" tabindex="-1"></a><span class="ss">        &lt;div class=&quot;search-section&quot;&gt;</span></span>
<span id="cb10-735"><a href="#cb10-735" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;input type=&quot;text&quot; id=&quot;searchInput&quot; class=&quot;search-box&quot; placeholder=&quot;üîç Pesquisar por t√≠tulo, conte√∫do, categoria...&quot;&gt;</span></span>
<span id="cb10-736"><a href="#cb10-736" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;div class=&quot;filters&quot;&gt;</span></span>
<span id="cb10-737"><a href="#cb10-737" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;button class=&quot;filter-btn active&quot; data-filter=&quot;all&quot;&gt;Todas&lt;/button&gt;</span></span>
<span id="cb10-738"><a href="#cb10-738" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;button class=&quot;filter-btn&quot; data-filter=&quot;Programa√ß√£o&quot;&gt;Programa√ß√£o&lt;/button&gt;</span></span>
<span id="cb10-739"><a href="#cb10-739" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;button class=&quot;filter-btn&quot; data-filter=&quot;Sistemas&quot;&gt;Sistemas&lt;/button&gt;</span></span>
<span id="cb10-740"><a href="#cb10-740" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;button class=&quot;filter-btn&quot; data-filter=&quot;IA&quot;&gt;IA&lt;/button&gt;</span></span>
<span id="cb10-741"><a href="#cb10-741" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;button class=&quot;filter-btn&quot; data-filter=&quot;Dados&quot;&gt;Dados&lt;/button&gt;</span></span>
<span id="cb10-742"><a href="#cb10-742" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;button class=&quot;filter-btn&quot; data-filter=&quot;Geral&quot;&gt;Geral&lt;/button&gt;</span></span>
<span id="cb10-743"><a href="#cb10-743" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;/div&gt;</span></span>
<span id="cb10-744"><a href="#cb10-744" aria-hidden="true" tabindex="-1"></a><span class="ss">        &lt;/div&gt;</span></span>
<span id="cb10-745"><a href="#cb10-745" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb10-746"><a href="#cb10-746" aria-hidden="true" tabindex="-1"></a><span class="ss">        &lt;div class=&quot;conversations-grid&quot; id=&quot;conversationsGrid&quot;&gt;</span></span>
<span id="cb10-747"><a href="#cb10-747" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span><span class="sc">{</span><span class="st">&quot;&quot;</span><span class="sc">.</span>join(<span class="va">self</span>.generate_conversation_cards(conversations))<span class="sc">}</span></span>
<span id="cb10-748"><a href="#cb10-748" aria-hidden="true" tabindex="-1"></a><span class="ss">        &lt;/div&gt;</span></span>
<span id="cb10-749"><a href="#cb10-749" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb10-750"><a href="#cb10-750" aria-hidden="true" tabindex="-1"></a><span class="ss">        &lt;div class=&quot;footer&quot;&gt;</span></span>
<span id="cb10-751"><a href="#cb10-751" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;p&gt;Dashboard gerado automaticamente em </span><span class="sc">{</span>current_date<span class="sc">}</span><span class="ss">&lt;/p&gt;</span></span>
<span id="cb10-752"><a href="#cb10-752" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;p&gt;Grok Analysis Tool ‚Ä¢ Total de </span><span class="sc">{</span>total_conv<span class="sc">}</span><span class="ss"> conversas processadas&lt;/p&gt;</span></span>
<span id="cb10-753"><a href="#cb10-753" aria-hidden="true" tabindex="-1"></a><span class="ss">        &lt;/div&gt;</span></span>
<span id="cb10-754"><a href="#cb10-754" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;/div&gt;</span></span>
<span id="cb10-755"><a href="#cb10-755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-756"><a href="#cb10-756" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;script&gt;</span></span>
<span id="cb10-757"><a href="#cb10-757" aria-hidden="true" tabindex="-1"></a><span class="ss">        // Fun√ß√£o de busca em tempo real</span></span>
<span id="cb10-758"><a href="#cb10-758" aria-hidden="true" tabindex="-1"></a><span class="ss">        document.getElementById(&#39;searchInput&#39;).addEventListener(&#39;input&#39;, function(e) </span><span class="ch">{{</span></span>
<span id="cb10-759"><a href="#cb10-759" aria-hidden="true" tabindex="-1"></a><span class="ss">            const searchTerm = e.target.value.toLowerCase();</span></span>
<span id="cb10-760"><a href="#cb10-760" aria-hidden="true" tabindex="-1"></a><span class="ss">            const cards = document.querySelectorAll(&#39;.conversation-card&#39;);</span></span>
<span id="cb10-761"><a href="#cb10-761" aria-hidden="true" tabindex="-1"></a><span class="ss">            let visibleCount = 0;</span></span>
<span id="cb10-762"><a href="#cb10-762" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span></span>
<span id="cb10-763"><a href="#cb10-763" aria-hidden="true" tabindex="-1"></a><span class="ss">            cards.forEach(card =&gt; </span><span class="ch">{{</span></span>
<span id="cb10-764"><a href="#cb10-764" aria-hidden="true" tabindex="-1"></a><span class="ss">                const title = card.getAttribute(&#39;data-title&#39;).toLowerCase();</span></span>
<span id="cb10-765"><a href="#cb10-765" aria-hidden="true" tabindex="-1"></a><span class="ss">                const content = card.getAttribute(&#39;data-content&#39;).toLowerCase();</span></span>
<span id="cb10-766"><a href="#cb10-766" aria-hidden="true" tabindex="-1"></a><span class="ss">                const category = card.getAttribute(&#39;data-category&#39;).toLowerCase();</span></span>
<span id="cb10-767"><a href="#cb10-767" aria-hidden="true" tabindex="-1"></a><span class="ss">                const number = card.getAttribute(&#39;data-number&#39;).toLowerCase();</span></span>
<span id="cb10-768"><a href="#cb10-768" aria-hidden="true" tabindex="-1"></a><span class="ss">                </span></span>
<span id="cb10-769"><a href="#cb10-769" aria-hidden="true" tabindex="-1"></a><span class="ss">                if (title.includes(searchTerm) || content.includes(searchTerm) || </span></span>
<span id="cb10-770"><a href="#cb10-770" aria-hidden="true" tabindex="-1"></a><span class="ss">                    category.includes(searchTerm) || number.includes(searchTerm)) </span><span class="ch">{{</span></span>
<span id="cb10-771"><a href="#cb10-771" aria-hidden="true" tabindex="-1"></a><span class="ss">                    card.style.display = &#39;block&#39;;</span></span>
<span id="cb10-772"><a href="#cb10-772" aria-hidden="true" tabindex="-1"></a><span class="ss">                    visibleCount++;</span></span>
<span id="cb10-773"><a href="#cb10-773" aria-hidden="true" tabindex="-1"></a><span class="ss">                </span><span class="ch">}}</span><span class="ss"> else </span><span class="ch">{{</span></span>
<span id="cb10-774"><a href="#cb10-774" aria-hidden="true" tabindex="-1"></a><span class="ss">                    card.style.display = &#39;none&#39;;</span></span>
<span id="cb10-775"><a href="#cb10-775" aria-hidden="true" tabindex="-1"></a><span class="ss">                </span><span class="ch">}}</span></span>
<span id="cb10-776"><a href="#cb10-776" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span><span class="ch">}}</span><span class="ss">);</span></span>
<span id="cb10-777"><a href="#cb10-777" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span></span>
<span id="cb10-778"><a href="#cb10-778" aria-hidden="true" tabindex="-1"></a><span class="ss">            // Atualizar contador</span></span>
<span id="cb10-779"><a href="#cb10-779" aria-hidden="true" tabindex="-1"></a><span class="ss">            document.querySelectorAll(&#39;.stat-item&#39;)[0].querySelector(&#39;.stat-number&#39;).textContent = visibleCount;</span></span>
<span id="cb10-780"><a href="#cb10-780" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span><span class="ss">);</span></span>
<span id="cb10-781"><a href="#cb10-781" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb10-782"><a href="#cb10-782" aria-hidden="true" tabindex="-1"></a><span class="ss">        // Filtros por categoria</span></span>
<span id="cb10-783"><a href="#cb10-783" aria-hidden="true" tabindex="-1"></a><span class="ss">        document.querySelectorAll(&#39;.filter-btn&#39;).forEach(btn =&gt; </span><span class="ch">{{</span></span>
<span id="cb10-784"><a href="#cb10-784" aria-hidden="true" tabindex="-1"></a><span class="ss">            btn.addEventListener(&#39;click&#39;, function() </span><span class="ch">{{</span></span>
<span id="cb10-785"><a href="#cb10-785" aria-hidden="true" tabindex="-1"></a><span class="ss">                document.querySelectorAll(&#39;.filter-btn&#39;).forEach(b =&gt; b.classList.remove(&#39;active&#39;));</span></span>
<span id="cb10-786"><a href="#cb10-786" aria-hidden="true" tabindex="-1"></a><span class="ss">                this.classList.add(&#39;active&#39;);</span></span>
<span id="cb10-787"><a href="#cb10-787" aria-hidden="true" tabindex="-1"></a><span class="ss">                </span></span>
<span id="cb10-788"><a href="#cb10-788" aria-hidden="true" tabindex="-1"></a><span class="ss">                const filter = this.getAttribute(&#39;data-filter&#39;);</span></span>
<span id="cb10-789"><a href="#cb10-789" aria-hidden="true" tabindex="-1"></a><span class="ss">                const cards = document.querySelectorAll(&#39;.conversation-card&#39;);</span></span>
<span id="cb10-790"><a href="#cb10-790" aria-hidden="true" tabindex="-1"></a><span class="ss">                </span></span>
<span id="cb10-791"><a href="#cb10-791" aria-hidden="true" tabindex="-1"></a><span class="ss">                cards.forEach(card =&gt; </span><span class="ch">{{</span></span>
<span id="cb10-792"><a href="#cb10-792" aria-hidden="true" tabindex="-1"></a><span class="ss">                    const category = card.getAttribute(&#39;data-category&#39;);</span></span>
<span id="cb10-793"><a href="#cb10-793" aria-hidden="true" tabindex="-1"></a><span class="ss">                    if (filter === &#39;all&#39; || category === filter) </span><span class="ch">{{</span></span>
<span id="cb10-794"><a href="#cb10-794" aria-hidden="true" tabindex="-1"></a><span class="ss">                        card.style.display = &#39;block&#39;;</span></span>
<span id="cb10-795"><a href="#cb10-795" aria-hidden="true" tabindex="-1"></a><span class="ss">                    </span><span class="ch">}}</span><span class="ss"> else </span><span class="ch">{{</span></span>
<span id="cb10-796"><a href="#cb10-796" aria-hidden="true" tabindex="-1"></a><span class="ss">                        card.style.display = &#39;none&#39;;</span></span>
<span id="cb10-797"><a href="#cb10-797" aria-hidden="true" tabindex="-1"></a><span class="ss">                    </span><span class="ch">}}</span></span>
<span id="cb10-798"><a href="#cb10-798" aria-hidden="true" tabindex="-1"></a><span class="ss">                </span><span class="ch">}}</span><span class="ss">);</span></span>
<span id="cb10-799"><a href="#cb10-799" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span><span class="ch">}}</span><span class="ss">);</span></span>
<span id="cb10-800"><a href="#cb10-800" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span><span class="ss">);</span></span>
<span id="cb10-801"><a href="#cb10-801" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb10-802"><a href="#cb10-802" aria-hidden="true" tabindex="-1"></a><span class="ss">        // Abrir arquivo MD</span></span>
<span id="cb10-803"><a href="#cb10-803" aria-hidden="true" tabindex="-1"></a><span class="ss">        function openMD(filename) </span><span class="ch">{{</span></span>
<span id="cb10-804"><a href="#cb10-804" aria-hidden="true" tabindex="-1"></a><span class="ss">            window.open(&#39;markdown/&#39; + filename, &#39;_blank&#39;);</span></span>
<span id="cb10-805"><a href="#cb10-805" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-806"><a href="#cb10-806" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb10-807"><a href="#cb10-807" aria-hidden="true" tabindex="-1"></a><span class="ss">        // Abrir arquivo PDF</span></span>
<span id="cb10-808"><a href="#cb10-808" aria-hidden="true" tabindex="-1"></a><span class="ss">        function openPDF(filename) </span><span class="ch">{{</span></span>
<span id="cb10-809"><a href="#cb10-809" aria-hidden="true" tabindex="-1"></a><span class="ss">            const pdfFile = filename.replace(&#39;.md&#39;, &#39;.pdf&#39;);</span></span>
<span id="cb10-810"><a href="#cb10-810" aria-hidden="true" tabindex="-1"></a><span class="ss">            window.open(&#39;pdf/conversas/&#39; + pdfFile, &#39;_blank&#39;);</span></span>
<span id="cb10-811"><a href="#cb10-811" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-812"><a href="#cb10-812" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb10-813"><a href="#cb10-813" aria-hidden="true" tabindex="-1"></a><span class="ss">        // Click no card abre o MD</span></span>
<span id="cb10-814"><a href="#cb10-814" aria-hidden="true" tabindex="-1"></a><span class="ss">        document.querySelectorAll(&#39;.conversation-card&#39;).forEach(card =&gt; </span><span class="ch">{{</span></span>
<span id="cb10-815"><a href="#cb10-815" aria-hidden="true" tabindex="-1"></a><span class="ss">            card.addEventListener(&#39;click&#39;, function(e) </span><span class="ch">{{</span></span>
<span id="cb10-816"><a href="#cb10-816" aria-hidden="true" tabindex="-1"></a><span class="ss">                if (!e.target.classList.contains(&#39;action-btn&#39;)) </span><span class="ch">{{</span></span>
<span id="cb10-817"><a href="#cb10-817" aria-hidden="true" tabindex="-1"></a><span class="ss">                    const filename = this.getAttribute(&#39;data-filename&#39;);</span></span>
<span id="cb10-818"><a href="#cb10-818" aria-hidden="true" tabindex="-1"></a><span class="ss">                    openMD(filename);</span></span>
<span id="cb10-819"><a href="#cb10-819" aria-hidden="true" tabindex="-1"></a><span class="ss">                </span><span class="ch">}}</span></span>
<span id="cb10-820"><a href="#cb10-820" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span><span class="ch">}}</span><span class="ss">);</span></span>
<span id="cb10-821"><a href="#cb10-821" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span><span class="ss">);</span></span>
<span id="cb10-822"><a href="#cb10-822" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb10-823"><a href="#cb10-823" aria-hidden="true" tabindex="-1"></a><span class="ss">        // Anima√ß√£o de entrada</span></span>
<span id="cb10-824"><a href="#cb10-824" aria-hidden="true" tabindex="-1"></a><span class="ss">        document.addEventListener(&#39;DOMContentLoaded&#39;, function() </span><span class="ch">{{</span></span>
<span id="cb10-825"><a href="#cb10-825" aria-hidden="true" tabindex="-1"></a><span class="ss">            const cards = document.querySelectorAll(&#39;.conversation-card&#39;);</span></span>
<span id="cb10-826"><a href="#cb10-826" aria-hidden="true" tabindex="-1"></a><span class="ss">            cards.forEach((card, index) =&gt; </span><span class="ch">{{</span></span>
<span id="cb10-827"><a href="#cb10-827" aria-hidden="true" tabindex="-1"></a><span class="ss">                card.style.animationDelay = (index * 0.1) + &#39;s&#39;;</span></span>
<span id="cb10-828"><a href="#cb10-828" aria-hidden="true" tabindex="-1"></a><span class="ss">                card.style.opacity = &#39;0&#39;;</span></span>
<span id="cb10-829"><a href="#cb10-829" aria-hidden="true" tabindex="-1"></a><span class="ss">                card.style.animation = &#39;fadeInUp 0.6s ease forwards&#39;;</span></span>
<span id="cb10-830"><a href="#cb10-830" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span><span class="ch">}}</span><span class="ss">);</span></span>
<span id="cb10-831"><a href="#cb10-831" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span><span class="ss">);</span></span>
<span id="cb10-832"><a href="#cb10-832" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb10-833"><a href="#cb10-833" aria-hidden="true" tabindex="-1"></a><span class="ss">        // Anima√ß√£o CSS</span></span>
<span id="cb10-834"><a href="#cb10-834" aria-hidden="true" tabindex="-1"></a><span class="ss">        const style = document.createElement(&#39;style&#39;);</span></span>
<span id="cb10-835"><a href="#cb10-835" aria-hidden="true" tabindex="-1"></a><span class="ss">        style.textContent = `</span></span>
<span id="cb10-836"><a href="#cb10-836" aria-hidden="true" tabindex="-1"></a><span class="ss">            @keyframes fadeInUp </span><span class="ch">{{</span></span>
<span id="cb10-837"><a href="#cb10-837" aria-hidden="true" tabindex="-1"></a><span class="ss">                from </span><span class="ch">{{</span></span>
<span id="cb10-838"><a href="#cb10-838" aria-hidden="true" tabindex="-1"></a><span class="ss">                    opacity: 0;</span></span>
<span id="cb10-839"><a href="#cb10-839" aria-hidden="true" tabindex="-1"></a><span class="ss">                    transform: translateY(30px);</span></span>
<span id="cb10-840"><a href="#cb10-840" aria-hidden="true" tabindex="-1"></a><span class="ss">                </span><span class="ch">}}</span></span>
<span id="cb10-841"><a href="#cb10-841" aria-hidden="true" tabindex="-1"></a><span class="ss">                to </span><span class="ch">{{</span></span>
<span id="cb10-842"><a href="#cb10-842" aria-hidden="true" tabindex="-1"></a><span class="ss">                    opacity: 1;</span></span>
<span id="cb10-843"><a href="#cb10-843" aria-hidden="true" tabindex="-1"></a><span class="ss">                    transform: translateY(0);</span></span>
<span id="cb10-844"><a href="#cb10-844" aria-hidden="true" tabindex="-1"></a><span class="ss">                </span><span class="ch">}}</span></span>
<span id="cb10-845"><a href="#cb10-845" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span><span class="ch">}}</span></span>
<span id="cb10-846"><a href="#cb10-846" aria-hidden="true" tabindex="-1"></a><span class="ss">        `;</span></span>
<span id="cb10-847"><a href="#cb10-847" aria-hidden="true" tabindex="-1"></a><span class="ss">        document.head.appendChild(style);</span></span>
<span id="cb10-848"><a href="#cb10-848" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;/script&gt;</span></span>
<span id="cb10-849"><a href="#cb10-849" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;/body&gt;</span></span>
<span id="cb10-850"><a href="#cb10-850" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;/html&gt;</span></span>
<span id="cb10-851"><a href="#cb10-851" aria-hidden="true" tabindex="-1"></a><span class="ss">&quot;&quot;&quot;</span></span>
<span id="cb10-852"><a href="#cb10-852" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-853"><a href="#cb10-853" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> generate_conversation_cards(<span class="va">self</span>, conversations):</span>
<span id="cb10-854"><a href="#cb10-854" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Gera cards de conversa para o √≠ndice&quot;&quot;&quot;</span></span>
<span id="cb10-855"><a href="#cb10-855" aria-hidden="true" tabindex="-1"></a>        cards <span class="op">=</span> []</span>
<span id="cb10-856"><a href="#cb10-856" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> idx, (_, row) <span class="kw">in</span> <span class="bu">enumerate</span>(conversations, <span class="dv">1</span>):</span>
<span id="cb10-857"><a href="#cb10-857" aria-hidden="true" tabindex="-1"></a>            safe_title <span class="op">=</span> <span class="va">self</span>.create_safe_filename(row[<span class="st">&#39;title&#39;</span>])</span>
<span id="cb10-858"><a href="#cb10-858" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb10-859"><a href="#cb10-859" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Formatar data</span></span>
<span id="cb10-860"><a href="#cb10-860" aria-hidden="true" tabindex="-1"></a>            created_date <span class="op">=</span> <span class="st">&quot;&quot;</span></span>
<span id="cb10-861"><a href="#cb10-861" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> pd.notna(row.get(<span class="st">&#39;created_at&#39;</span>)):</span>
<span id="cb10-862"><a href="#cb10-862" aria-hidden="true" tabindex="-1"></a>                <span class="cf">try</span>:</span>
<span id="cb10-863"><a href="#cb10-863" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="bu">hasattr</span>(row[<span class="st">&#39;created_at&#39;</span>], <span class="st">&#39;strftime&#39;</span>):</span>
<span id="cb10-864"><a href="#cb10-864" aria-hidden="true" tabindex="-1"></a>                        created_date <span class="op">=</span> row[<span class="st">&#39;created_at&#39;</span>].strftime(<span class="st">&#39;</span><span class="sc">%d</span><span class="st">/%m/%Y %H:%M&#39;</span>)</span>
<span id="cb10-865"><a href="#cb10-865" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">else</span>:</span>
<span id="cb10-866"><a href="#cb10-866" aria-hidden="true" tabindex="-1"></a>                        created_date <span class="op">=</span> <span class="bu">str</span>(row[<span class="st">&#39;created_at&#39;</span>])</span>
<span id="cb10-867"><a href="#cb10-867" aria-hidden="true" tabindex="-1"></a>                <span class="cf">except</span>:</span>
<span id="cb10-868"><a href="#cb10-868" aria-hidden="true" tabindex="-1"></a>                    created_date <span class="op">=</span> <span class="bu">str</span>(row[<span class="st">&#39;created_at&#39;</span>])</span>
<span id="cb10-869"><a href="#cb10-869" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb10-870"><a href="#cb10-870" aria-hidden="true" tabindex="-1"></a>            cards.append(<span class="ss">f&quot;&quot;&quot;</span></span>
<span id="cb10-871"><a href="#cb10-871" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;div class=&quot;conversation-card&quot; </span></span>
<span id="cb10-872"><a href="#cb10-872" aria-hidden="true" tabindex="-1"></a><span class="ss">                 data-number=&quot;</span><span class="sc">{</span>idx<span class="sc">}</span><span class="ss">&quot; </span></span>
<span id="cb10-873"><a href="#cb10-873" aria-hidden="true" tabindex="-1"></a><span class="ss">                 data-title=&quot;</span><span class="sc">{</span>row[<span class="st">&#39;title&#39;</span>]<span class="sc">}</span><span class="ss">&quot; </span></span>
<span id="cb10-874"><a href="#cb10-874" aria-hidden="true" tabindex="-1"></a><span class="ss">                 data-content=&quot;</span><span class="sc">{</span>row<span class="sc">.</span>get(<span class="st">&#39;preview_content&#39;</span>, <span class="st">&#39;&#39;</span>)<span class="sc">}</span><span class="ss">&quot; </span></span>
<span id="cb10-875"><a href="#cb10-875" aria-hidden="true" tabindex="-1"></a><span class="ss">                 data-category=&quot;</span><span class="sc">{</span>row[<span class="st">&#39;category&#39;</span>]<span class="sc">}</span><span class="ss">&quot;</span></span>
<span id="cb10-876"><a href="#cb10-876" aria-hidden="true" tabindex="-1"></a><span class="ss">                 data-filename=&quot;</span><span class="sc">{</span>safe_title<span class="sc">}</span><span class="ss">.md&quot;&gt;</span></span>
<span id="cb10-877"><a href="#cb10-877" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;div class=&quot;card-header&quot;&gt;</span></span>
<span id="cb10-878"><a href="#cb10-878" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;span class=&quot;card-category&quot;&gt;</span><span class="sc">{</span>row[<span class="st">&#39;category&#39;</span>]<span class="sc">}</span><span class="ss">&lt;/span&gt;</span></span>
<span id="cb10-879"><a href="#cb10-879" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;span class=&quot;card-number&quot;&gt;#</span><span class="sc">{</span>idx<span class="sc">}</span><span class="ss">&lt;/span&gt;</span></span>
<span id="cb10-880"><a href="#cb10-880" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;/div&gt;</span></span>
<span id="cb10-881"><a href="#cb10-881" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;div class=&quot;card-title&quot;&gt;</span><span class="sc">{</span>row[<span class="st">&#39;title&#39;</span>]<span class="sc">}</span><span class="ss">&lt;/div&gt;</span></span>
<span id="cb10-882"><a href="#cb10-882" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;div class=&quot;card-preview&quot;&gt;</span><span class="sc">{</span>row<span class="sc">.</span>get(<span class="st">&#39;preview_content&#39;</span>, <span class="st">&#39;Clique para ver a conversa completa...&#39;</span>)<span class="sc">}</span><span class="ss">&lt;/div&gt;</span></span>
<span id="cb10-883"><a href="#cb10-883" aria-hidden="true" tabindex="-1"></a><span class="ss">                </span></span>
<span id="cb10-884"><a href="#cb10-884" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;div class=&quot;card-stats&quot;&gt;</span></span>
<span id="cb10-885"><a href="#cb10-885" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;div class=&quot;stat-box&quot;&gt;</span></span>
<span id="cb10-886"><a href="#cb10-886" aria-hidden="true" tabindex="-1"></a><span class="ss">                        &lt;span class=&quot;stat-value&quot;&gt;</span><span class="sc">{</span>row[<span class="st">&#39;num_messages&#39;</span>]<span class="sc">}</span><span class="ss">&lt;/span&gt;</span></span>
<span id="cb10-887"><a href="#cb10-887" aria-hidden="true" tabindex="-1"></a><span class="ss">                        &lt;span class=&quot;stat-name&quot;&gt;Mensagens&lt;/span&gt;</span></span>
<span id="cb10-888"><a href="#cb10-888" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;/div&gt;</span></span>
<span id="cb10-889"><a href="#cb10-889" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;div class=&quot;stat-box&quot;&gt;</span></span>
<span id="cb10-890"><a href="#cb10-890" aria-hidden="true" tabindex="-1"></a><span class="ss">                        &lt;span class=&quot;stat-value&quot;&gt;</span><span class="sc">{</span>row[<span class="st">&#39;total_words&#39;</span>]<span class="sc">}</span><span class="ss">&lt;/span&gt;</span></span>
<span id="cb10-891"><a href="#cb10-891" aria-hidden="true" tabindex="-1"></a><span class="ss">                        &lt;span class=&quot;stat-name&quot;&gt;Palavras&lt;/span&gt;</span></span>
<span id="cb10-892"><a href="#cb10-892" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;/div&gt;</span></span>
<span id="cb10-893"><a href="#cb10-893" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;div class=&quot;stat-box&quot;&gt;</span></span>
<span id="cb10-894"><a href="#cb10-894" aria-hidden="true" tabindex="-1"></a><span class="ss">                        &lt;span class=&quot;stat-value&quot;&gt;</span><span class="sc">{</span>row[<span class="st">&#39;user_messages&#39;</span>]<span class="sc">}</span><span class="ss">&lt;/span&gt;</span></span>
<span id="cb10-895"><a href="#cb10-895" aria-hidden="true" tabindex="-1"></a><span class="ss">                        &lt;span class=&quot;stat-name&quot;&gt;Perguntas&lt;/span&gt;</span></span>
<span id="cb10-896"><a href="#cb10-896" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;/div&gt;</span></span>
<span id="cb10-897"><a href="#cb10-897" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;div class=&quot;stat-box&quot;&gt;</span></span>
<span id="cb10-898"><a href="#cb10-898" aria-hidden="true" tabindex="-1"></a><span class="ss">                        &lt;span class=&quot;stat-value&quot;&gt;</span><span class="sc">{</span>row[<span class="st">&#39;assistant_messages&#39;</span>]<span class="sc">}</span><span class="ss">&lt;/span&gt;</span></span>
<span id="cb10-899"><a href="#cb10-899" aria-hidden="true" tabindex="-1"></a><span class="ss">                        &lt;span class=&quot;stat-name&quot;&gt;Respostas&lt;/span&gt;</span></span>
<span id="cb10-900"><a href="#cb10-900" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;/div&gt;</span></span>
<span id="cb10-901"><a href="#cb10-901" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;/div&gt;</span></span>
<span id="cb10-902"><a href="#cb10-902" aria-hidden="true" tabindex="-1"></a><span class="ss">                </span></span>
<span id="cb10-903"><a href="#cb10-903" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;div class=&quot;card-meta&quot;&gt;</span></span>
<span id="cb10-904"><a href="#cb10-904" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;span&gt;üìÖ </span><span class="sc">{</span>created_date<span class="sc">}</span><span class="ss">&lt;/span&gt;</span></span>
<span id="cb10-905"><a href="#cb10-905" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;span&gt;üë§ </span><span class="sc">{</span>row[<span class="st">&#39;user_messages&#39;</span>]<span class="sc">}</span><span class="ss"> / ü§ñ </span><span class="sc">{</span>row[<span class="st">&#39;assistant_messages&#39;</span>]<span class="sc">}</span><span class="ss">&lt;/span&gt;</span></span>
<span id="cb10-906"><a href="#cb10-906" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;/div&gt;</span></span>
<span id="cb10-907"><a href="#cb10-907" aria-hidden="true" tabindex="-1"></a><span class="ss">                </span></span>
<span id="cb10-908"><a href="#cb10-908" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;div class=&quot;card-actions&quot;&gt;</span></span>
<span id="cb10-909"><a href="#cb10-909" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;button class=&quot;action-btn btn-md&quot; onclick=&quot;openMD(&#39;</span><span class="sc">{</span>safe_title<span class="sc">}</span><span class="ss">.md&#39;)&quot;&gt;üìÑ MD&lt;/button&gt;</span></span>
<span id="cb10-910"><a href="#cb10-910" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;button class=&quot;action-btn btn-pdf&quot; onclick=&quot;openPDF(&#39;</span><span class="sc">{</span>safe_title<span class="sc">}</span><span class="ss">.md&#39;)&quot;&gt;üìä PDF&lt;/button&gt;</span></span>
<span id="cb10-911"><a href="#cb10-911" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;/div&gt;</span></span>
<span id="cb10-912"><a href="#cb10-912" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;/div&gt;</span></span>
<span id="cb10-913"><a href="#cb10-913" aria-hidden="true" tabindex="-1"></a><span class="ss">            &quot;&quot;&quot;</span>)</span>
<span id="cb10-914"><a href="#cb10-914" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> cards</span>
<span id="cb10-915"><a href="#cb10-915" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-916"><a href="#cb10-916" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> save_data_files(<span class="va">self</span>, df):</span>
<span id="cb10-917"><a href="#cb10-917" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Salva arquivos de dados para an√°lise&quot;&quot;&quot;</span></span>
<span id="cb10-918"><a href="#cb10-918" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;üíæ Salvando arquivos de dados...&quot;</span>)</span>
<span id="cb10-919"><a href="#cb10-919" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-920"><a href="#cb10-920" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Salvar conversas processadas</span></span>
<span id="cb10-921"><a href="#cb10-921" aria-hidden="true" tabindex="-1"></a>        df.to_csv(<span class="ss">f&quot;</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>data_folder<span class="sc">}</span><span class="ss">/processed_conversations.csv&quot;</span>, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb10-922"><a href="#cb10-922" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-923"><a href="#cb10-923" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Salvar mensagens detalhadas</span></span>
<span id="cb10-924"><a href="#cb10-924" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.all_messages:</span>
<span id="cb10-925"><a href="#cb10-925" aria-hidden="true" tabindex="-1"></a>            messages_df <span class="op">=</span> pd.DataFrame(<span class="va">self</span>.all_messages)</span>
<span id="cb10-926"><a href="#cb10-926" aria-hidden="true" tabindex="-1"></a>            messages_df.to_csv(<span class="ss">f&quot;</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>data_folder<span class="sc">}</span><span class="ss">/all_messages.csv&quot;</span>, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb10-927"><a href="#cb10-927" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-928"><a href="#cb10-928" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ Dados salvos em: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>data_folder<span class="sc">}</span><span class="ss">/&quot;</span>)</span>
<span id="cb10-929"><a href="#cb10-929" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-930"><a href="#cb10-930" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> open_index(<span class="va">self</span>):</span>
<span id="cb10-931"><a href="#cb10-931" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Abre o √≠ndice no navegador&quot;&quot;&quot;</span></span>
<span id="cb10-932"><a href="#cb10-932" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> os.path.exists(<span class="va">self</span>.index_file):</span>
<span id="cb10-933"><a href="#cb10-933" aria-hidden="true" tabindex="-1"></a>            webbrowser.<span class="bu">open</span>(<span class="ss">f&#39;file://</span><span class="sc">{</span>os<span class="sc">.</span>path<span class="sc">.</span>abspath(<span class="va">self</span>.index_file)<span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb10-934"><a href="#cb10-934" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;üåê √çndice aberto no navegador: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>index_file<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb10-935"><a href="#cb10-935" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb10-936"><a href="#cb10-936" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;‚ùå √çndice n√£o encontrado&quot;</span>)</span>
<span id="cb10-937"><a href="#cb10-937" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-938"><a href="#cb10-938" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> generate_complete_system(<span class="va">self</span>):</span>
<span id="cb10-939"><a href="#cb10-939" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Gera o sistema completo de uma vez&quot;&quot;&quot;</span></span>
<span id="cb10-940"><a href="#cb10-940" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;üöÄ GROK PROCESSOR OTIMIZADO - Iniciando&quot;</span>)</span>
<span id="cb10-941"><a href="#cb10-941" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;=&quot;</span> <span class="op">*</span> <span class="dv">60</span>)</span>
<span id="cb10-942"><a href="#cb10-942" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-943"><a href="#cb10-943" aria-hidden="true" tabindex="-1"></a>        start_time <span class="op">=</span> datetime.now()</span>
<span id="cb10-944"><a href="#cb10-944" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-945"><a href="#cb10-945" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Configurar pastas</span></span>
<span id="cb10-946"><a href="#cb10-946" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.setup_folders()</span>
<span id="cb10-947"><a href="#cb10-947" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-948"><a href="#cb10-948" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Carregar dados</span></span>
<span id="cb10-949"><a href="#cb10-949" aria-hidden="true" tabindex="-1"></a>        all_data <span class="op">=</span> <span class="va">self</span>.load_grok_data()</span>
<span id="cb10-950"><a href="#cb10-950" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> all_data:</span>
<span id="cb10-951"><a href="#cb10-951" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb10-952"><a href="#cb10-952" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-953"><a href="#cb10-953" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Extrair e analisar conversas</span></span>
<span id="cb10-954"><a href="#cb10-954" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.extract_conversations(all_data)</span>
<span id="cb10-955"><a href="#cb10-955" aria-hidden="true" tabindex="-1"></a>        df, all_messages <span class="op">=</span> <span class="va">self</span>.analyze_conversations()</span>
<span id="cb10-956"><a href="#cb10-956" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-957"><a href="#cb10-957" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> df.empty:</span>
<span id="cb10-958"><a href="#cb10-958" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;‚ùå Nenhuma conversa v√°lida encontrada!&quot;</span>)</span>
<span id="cb10-959"><a href="#cb10-959" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb10-960"><a href="#cb10-960" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-961"><a href="#cb10-961" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Criar arquivos Markdown</span></span>
<span id="cb10-962"><a href="#cb10-962" aria-hidden="true" tabindex="-1"></a>        md_files <span class="op">=</span> <span class="va">self</span>.create_markdown_files(df)</span>
<span id="cb10-963"><a href="#cb10-963" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-964"><a href="#cb10-964" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Criar √≠ndice pesquis√°vel</span></span>
<span id="cb10-965"><a href="#cb10-965" aria-hidden="true" tabindex="-1"></a>        index_file <span class="op">=</span> <span class="va">self</span>.create_searchable_index(df)</span>
<span id="cb10-966"><a href="#cb10-966" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-967"><a href="#cb10-967" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Salvar dados</span></span>
<span id="cb10-968"><a href="#cb10-968" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.save_data_files(df)</span>
<span id="cb10-969"><a href="#cb10-969" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-970"><a href="#cb10-970" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Abrir √≠ndice</span></span>
<span id="cb10-971"><a href="#cb10-971" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.open_index()</span>
<span id="cb10-972"><a href="#cb10-972" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-973"><a href="#cb10-973" aria-hidden="true" tabindex="-1"></a>        elapsed <span class="op">=</span> datetime.now() <span class="op">-</span> start_time</span>
<span id="cb10-974"><a href="#cb10-974" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-975"><a href="#cb10-975" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="ch">\n</span><span class="ss">&quot;</span> <span class="op">+</span> <span class="st">&quot;=&quot;</span> <span class="op">*</span> <span class="dv">60</span>)</span>
<span id="cb10-976"><a href="#cb10-976" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;üéâ SISTEMA COMPLETO GERADO!&quot;</span>)</span>
<span id="cb10-977"><a href="#cb10-977" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;=&quot;</span> <span class="op">*</span> <span class="dv">60</span>)</span>
<span id="cb10-978"><a href="#cb10-978" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;üìä RESUMO:&quot;</span>)</span>
<span id="cb10-979"><a href="#cb10-979" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;   üìÅ Conversas processadas: </span><span class="sc">{</span><span class="bu">len</span>(df)<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb10-980"><a href="#cb10-980" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;   üí¨ Mensagens totais: </span><span class="sc">{</span>df[<span class="st">&#39;num_messages&#39;</span>]<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb10-981"><a href="#cb10-981" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;   üìù Arquivos Markdown: </span><span class="sc">{</span><span class="bu">len</span>(md_files)<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb10-982"><a href="#cb10-982" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;   üåê √çndice HTML: </span><span class="sc">{</span>index_file<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb10-983"><a href="#cb10-983" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;   üìÖ Ordena√ß√£o: Mais recente primeiro&quot;</span>)</span>
<span id="cb10-984"><a href="#cb10-984" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;   ‚è±Ô∏è  Tempo total: </span><span class="sc">{</span>elapsed<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb10-985"><a href="#cb10-985" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="ch">\n</span><span class="ss">üìã PR√ìXIMO PASSO:&quot;</span>)</span>
<span id="cb10-986"><a href="#cb10-986" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;   Execute: python grok_pdf_converter_optimized.py&quot;</span>)</span>
<span id="cb10-987"><a href="#cb10-987" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;=&quot;</span> <span class="op">*</span> <span class="dv">60</span>)</span>
<span id="cb10-988"><a href="#cb10-988" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-989"><a href="#cb10-989" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb10-990"><a href="#cb10-990" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-991"><a href="#cb10-991" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> main():</span>
<span id="cb10-992"><a href="#cb10-992" aria-hidden="true" tabindex="-1"></a>    processor <span class="op">=</span> GrokProcessorOptimized()</span>
<span id="cb10-993"><a href="#cb10-993" aria-hidden="true" tabindex="-1"></a>    success <span class="op">=</span> processor.generate_complete_system()</span>
<span id="cb10-994"><a href="#cb10-994" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-995"><a href="#cb10-995" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> success:</span>
<span id="cb10-996"><a href="#cb10-996" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;‚ùå Processamento falhou!&quot;</span>)</span>
<span id="cb10-997"><a href="#cb10-997" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">1</span></span>
<span id="cb10-998"><a href="#cb10-998" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-999"><a href="#cb10-999" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span></span>
<span id="cb10-1000"><a href="#cb10-1000" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-1001"><a href="#cb10-1001" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&quot;__main__&quot;</span>:</span>
<span id="cb10-1002"><a href="#cb10-1002" aria-hidden="true" tabindex="-1"></a>    exit(main())</span></code></pre></div>
<h2 data-number="2.10" id="principais-corre√ß√µes-implementadas"><span class="header-section-number">2.10</span> Principais Corre√ß√µes
Implementadas:</h2>
<h3 data-number="2.10.1" id="utilizador-em-vez-de-usu√°rio-nos-markdowns"><span class="header-section-number">2.10.1</span> 1. <strong>‚ÄúUtilizador‚Äù em
vez de ‚ÄúUsu√°rio‚Äù nos Markdowns</strong></h3>
<ul>
<li><strong>Linha 312</strong>:
<code>role_name = &quot;Utilizador&quot; if msg[&#39;role&#39;] == &#39;user&#39; else &quot;Grok&quot;</code></li>
<li><strong>Linha 345</strong>:
<code>- **Mensagens do utilizador**: {row[&#39;user_messages&#39;]}</code></li>
<li><strong>Linha 347</strong>:
<code>- **Palavras do utilizador**: {row[&#39;user_words&#39;]}</code></li>
</ul>
<h3 data-number="2.10.2" id="mantido-usu√°rio-no-√≠ndice-html"><span class="header-section-number">2.10.2</span> 2. <strong>Mantido ‚ÄúUsu√°rio‚Äù
no √çndice HTML</strong></h3>
<ul>
<li>No √≠ndice HTML mantive ‚Äúüë§‚Äù que √© universalmente reconhecido</li>
<li>As estat√≠sticas mostram ‚ÄúPerguntas/Respostas‚Äù que √© mais neutro</li>
</ul>
<h3 data-number="2.10.3" id="exemplo-de-sa√≠da-nos-arquivos-markdown"><span class="header-section-number">2.10.3</span> 3. <strong>Exemplo de Sa√≠da
nos Arquivos Markdown:</strong></h3>
<div class="sourceCode" id="cb11"><pre class="sourceCode markdown"><code class="sourceCode markdown"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">## üë§ Utilizador</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>Ol√°, preciso de ajuda com Python...</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="fu">## ü§ñ Grok</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>Claro! Posso ajudar-te com Python...</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="fu">## üìä Estat√≠sticas Detalhadas</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Mensagens do utilizador**: 5</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Mensagens do Grok**: 4</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Palavras do utilizador**: 150</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Palavras do Grok**: 280</span></code></pre></div>
<h3 data-number="2.10.4" id="consist√™ncia-em-todo-o-sistema"><span class="header-section-number">2.10.4</span> 4. <strong>Consist√™ncia em
Todo o Sistema</strong></h3>
<ul>
<li>Markdown: ‚ÄúUtilizador‚Äù e ‚ÄúGrok‚Äù</li>
<li>√çndice HTML: ‚Äúüë§ Perguntas‚Äù e ‚Äúü§ñ Respostas‚Äù (visualmente
claro)</li>
<li>Estat√≠sticas: Termos consistentes</li>
</ul>
<p>Agora os arquivos Markdown usar√£o consistentemente ‚ÄúUtilizador‚Äù em
portugu√™s de Portugal, enquanto o √≠ndice mant√©m uma interface visual
clara com √≠cones universalmente reconhecidos!</p>
<hr />
<p><em>Conversa exportada do DeepSeek</em> <em>Processado em: 15/11/2025
22:27</em></p>

        <script id="fixed-toc-script">
        document.addEventListener('DOMContentLoaded', function() {
            const toc = document.getElementById('TOC');
            if (toc) {
                const tocTitle = toc.querySelector('h2');
                if (tocTitle) {
                    const toggleBtn = document.createElement('button');
                    toggleBtn.innerHTML = '‚ò∞';
                    toggleBtn.className = 'toc-toggle-btn';
                    toggleBtn.title = 'Minimizar/Expandir TOC';
                    let isMinimized = false;
                    toggleBtn.addEventListener('click', function(e) {
                        e.stopPropagation();
                        isMinimized = !isMinimized;
                        if (isMinimized) {
                            toc.classList.add('toc-minimized');
                        } else {
                            toc.classList.remove('toc-minimized');
                        }
                    });
                    tocTitle.appendChild(toggleBtn);
                }
            }
            
            // SCROLLSPY
            const sections = document.querySelectorAll('h1, h2, h3, h4, h5');
            const tocLinks = document.querySelectorAll('#TOC a');
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const id = entry.target.getAttribute('id');
                        tocLinks.forEach(link => {
                            link.classList.remove('active');
                            if (link.getAttribute('href') === '#' + id) {
                                link.classList.add('active');
                            }
                        });
                    }
                });
            }, { 
                rootMargin: '-20% 0px -60% 0px', 
                threshold: 0 
            });
            
            sections.forEach(section => {
                if (section.id) observer.observe(section);
            });
            
            // Scroll suave
            tocLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const targetId = link.getAttribute('href').substring(1);
                    const targetElement = document.getElementById(targetId);
                    if (targetElement) {
                        const offsetTop = targetElement.offsetTop - 80;
                        window.scrollTo({ top: offsetTop, behavior: 'smooth' });
                    }
                });
            });
            
            // BOT√ÉO VOLTAR AO TOPO
            const backToTopBtn = document.createElement('button');
            backToTopBtn.className = 'back-to-top-content';
            backToTopBtn.innerHTML = '‚Üë';
            backToTopBtn.title = 'Voltar ao Topo';
            document.body.appendChild(backToTopBtn);
            
            window.addEventListener('scroll', () => {
                if (window.pageYOffset > 300) {
                    backToTopBtn.classList.add('show');
                } else {
                    backToTopBtn.classList.remove('show');
                }
            });
            
            backToTopBtn.addEventListener('click', () => {
                window.scrollTo({ top: 0, behavior: 'smooth' });
            });
        });
        </script>
        
</body>
</html>
