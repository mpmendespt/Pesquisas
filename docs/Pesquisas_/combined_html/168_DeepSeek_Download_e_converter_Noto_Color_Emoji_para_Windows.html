<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang xml:lang>
<head>

        <style id="fixed-toc-styles">
        /* === ESTILOS PRINCIPAIS - TOC FIXO √Ä DIREITA === */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
            scroll-behavior: smooth;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            position: relative;
        }
        /* === TOC FIXO √Ä DIREITA - POSI√á√ÉO CORRIGIDA === */
        #TOC {
            position: fixed !important;
            top: 50% !important;
            right: 20px !important;
            transform: translateY(-50%) !important;
            width: 320px !important;
            max-height: 80vh !important;
            overflow-y: auto !important;
            z-index: 1000 !important;
            background: rgba(255, 255, 255, 0.98) !important;
            padding: 20px !important;
            border-radius: 12px !important;
            box-shadow: 0 8px 32px rgba(0,0,0,0.15) !important;
            border: 1px solid #e0e0e0 !important;
            backdrop-filter: blur(10px) !important;
            transition: all 0.3s ease-in-out !important;
        }
        #TOC.toc-minimized {
            transform: translateY(-50%) translateX(calc(320px - 50px)) !important;
            opacity: 0.3;
            width: 50px !important;
            overflow: hidden;
        }
        #TOC.toc-minimized > *:not(.toc-toggle-btn) {
            display: none !important;
        }
        #TOC h2 {
            margin-top: 0;
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
            font-size: 1.2em;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .toc-toggle-btn {
            background: none;
            border: none;
            font-size: 1.2em;
            cursor: pointer;
            padding: 5px;
            border-radius: 4px;
            transition: background-color 0.2s;
        }
        .toc-toggle-btn:hover {
            background-color: rgba(0,0,0,0.1);
        }
        #TOC ul {
            list-style-type: none;
            padding-left: 15px;
            margin: 10px 0;
        }
        #TOC ul ul {
            padding-left: 20px;
        }
        #TOC li {
            margin: 8px 0;
            line-height: 1.4;
        }
        #TOC a {
            text-decoration: none;
            color: #495057;
            font-weight: 500;
            transition: all 0.2s ease;
            display: block;
            padding: 6px 10px;
            border-radius: 6px;
            border-left: 3px solid transparent;
        }
        #TOC a:hover {
            color: #007bff;
            background-color: rgba(0, 123, 255, 0.1);
            border-left-color: #007bff;
        }
        #TOC a.active {
            background-color: #007bff !important;
            color: white !important;
            font-weight: bold;
            border-left-color: #0056b3;
        }
        /* Conte√∫do principal com margem para o TOC */
        .main-content {
            margin-right: calc(320px + 40px) !important;
        }
        /* Barra de scroll personalizada APENAS para TOC */
        #TOC::-webkit-scrollbar {
            width: 8px;
        }
        #TOC::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }
        #TOC::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 4px;
        }
        #TOC::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }
        /* === BOT√ÉO VOLTAR AO TOPO (HTMLs individuais) === */
        .back-to-top-content {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            font-size: 18px;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 999;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .back-to-top-content.show {
            opacity: 1;
            transform: translateY(0);
        }
        .back-to-top-content:hover {
            background: #0056b3;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0,0,0,0.2);
        }
        /* === RESPONSIVIDADE === */
        @media (max-width: 1400px) {
            .container {
                max-width: 95%;
                padding: 30px;
            }
            #TOC {
                width: 280px !important;
            }
            .main-content {
                margin-right: 320px !important;
            }
        }
        @media (max-width: 1200px) {
            #TOC {
                width: 260px !important;
                right: 15px !important;
            }
            .main-content {
                margin-right: 300px !important;
            }
        }
        @media (max-width: 992px) {
            #TOC {
                position: relative !important;
                width: 100% !important;
                right: 0 !important;
                top: 0 !important;
                transform: none !important;
                margin: 20px 0;
                max-height: 300px !important;
            }
            .main-content {
                margin-right: 0 !important;
            }
            .back-to-top-content {
                right: 20px;
                bottom: 20px;
            }
        }
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            .container {
                padding: 20px;
                max-width: 100%;
            }
            #TOC {
                max-height: 250px !important;
                padding: 15px !important;
            }
        }
        </style>
        
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>168_DeepSeek_Download_e_converter_Noto_Color_Emoji_para_Windows</title>
  <style>

html {
color: #1a1a1a;
background-color: #fdfdfd;
}
body {
margin: 0 auto;
max-width: 36em;
padding-left: 50px;
padding-right: 50px;
padding-top: 50px;
padding-bottom: 50px;
hyphens: auto;
overflow-wrap: break-word;
text-rendering: optimizeLegibility;
font-kerning: normal;
}
@media (max-width: 600px) {
body {
font-size: 0.9em;
padding: 12px;
}
h1 {
font-size: 1.8em;
}
}
@media print {
html {
background-color: white;
}
body {
background-color: transparent;
color: black;
font-size: 12pt;
}
p, h2, h3 {
orphans: 3;
widows: 3;
}
h2, h3, h4 {
page-break-after: avoid;
}
}
p {
margin: 1em 0;
}
a {
color: #1a1a1a;
}
a:visited {
color: #1a1a1a;
}
img {
max-width: 100%;
}
svg {
height: auto;
max-width: 100%;
}
h1, h2, h3, h4, h5, h6 {
margin-top: 1.4em;
}
h5, h6 {
font-size: 1em;
font-style: italic;
}
h6 {
font-weight: normal;
}
ol, ul {
padding-left: 1.7em;
margin-top: 1em;
}
li > ol, li > ul {
margin-top: 0;
}
blockquote {
margin: 1em 0 1em 1.7em;
padding-left: 1em;
border-left: 2px solid #e6e6e6;
color: #606060;
}
code {
font-family: Menlo, Monaco, Consolas, 'Lucida Console', monospace;
font-size: 85%;
margin: 0;
hyphens: manual;
}
pre {
margin: 1em 0;
overflow: auto;
}
pre code {
padding: 0;
overflow: visible;
overflow-wrap: normal;
}
.sourceCode {
background-color: transparent;
overflow: visible;
}
hr {
border: none;
border-top: 1px solid #1a1a1a;
height: 1px;
margin: 1em 0;
}
table {
margin: 1em 0;
border-collapse: collapse;
width: 100%;
overflow-x: auto;
display: block;
font-variant-numeric: lining-nums tabular-nums;
}
table caption {
margin-bottom: 0.75em;
}
tbody {
margin-top: 0.5em;
border-top: 1px solid #1a1a1a;
border-bottom: 1px solid #1a1a1a;
}
th {
border-top: 1px solid #1a1a1a;
padding: 0.25em 0.5em 0.25em 0.5em;
}
td {
padding: 0.125em 0.5em 0.25em 0.5em;
}
header {
margin-bottom: 4em;
text-align: center;
}
#TOC li {
list-style: none;
}
#TOC ul {
padding-left: 1.3em;
}
#TOC > ul {
padding-left: 0;
}
#TOC a:not(:hover) {
text-decoration: none;
}
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}

ul.task-list[class]{list-style: none;}
ul.task-list li input[type="checkbox"] {
font-size: inherit;
width: 0.8em;
margin: 0 0.8em 0.2em -1.6em;
vertical-align: middle;
}

html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
</head>
<body>
<nav id="TOC" role="doc-toc">
<ul>
<li><a href="#download-e-converter-noto-color-emoji-para-windows" id="toc-download-e-converter-noto-color-emoji-para-windows"><span class="toc-section-number">1</span> Download e converter Noto Color
Emoji para Windows</a>
<ul>
<li><a href="#informa√ß√µes" id="toc-informa√ß√µes"><span class="toc-section-number">1.1</span> üìä Informa√ß√µes</a></li>
<li><a href="#conversa" id="toc-conversa"><span class="toc-section-number">1.2</span> üí¨ Conversa</a></li>
<li><a href="#configura√ß√£o-do-ambiente-conda" id="toc-configura√ß√£o-do-ambiente-conda"><span class="toc-section-number">1.3</span> 1. Configura√ß√£o do Ambiente
Conda</a></li>
<li><a href="#instala√ß√£o-das-depend√™ncias" id="toc-instala√ß√£o-das-depend√™ncias"><span class="toc-section-number">1.4</span> 2. Instala√ß√£o das
Depend√™ncias</a></li>
<li><a href="#script-python-para-download-e-convers√£o" id="toc-script-python-para-download-e-convers√£o"><span class="toc-section-number">1.5</span> 3. Script Python para Download e
Convers√£o</a></li>
<li><a href="#script-alternativo-com-mais-op√ß√µes" id="toc-script-alternativo-com-mais-op√ß√µes"><span class="toc-section-number">1.6</span> 4. Script Alternativo com Mais
Op√ß√µes</a></li>
<li><a href="#instala√ß√£o-manual-no-windows-10" id="toc-instala√ß√£o-manual-no-windows-10"><span class="toc-section-number">1.7</span> 5. Instala√ß√£o Manual no Windows
10</a></li>
<li><a href="#requirements-file-opcional" id="toc-requirements-file-opcional"><span class="toc-section-number">1.8</span> 6. Requirements File
(opcional)</a></li>
<li><a href="#execu√ß√£o" id="toc-execu√ß√£o"><span class="toc-section-number">1.9</span> 7. Execu√ß√£o</a></li>
<li><a href="#notas-importantes" id="toc-notas-importantes"><span class="toc-section-number">1.10</span> Notas Importantes:</a></li>
<li><a href="#solu√ß√£o-1-usar-a-vers√£o-colrcpal-recomendado" id="toc-solu√ß√£o-1-usar-a-vers√£o-colrcpal-recomendado"><span class="toc-section-number">1.11</span> Solu√ß√£o 1: Usar a vers√£o
COLR/CPAL (Recomendado)</a></li>
<li><a href="#solu√ß√£o-2-usar-browser-como-alternativa" id="toc-solu√ß√£o-2-usar-browser-como-alternativa"><span class="toc-section-number">1.12</span> Solu√ß√£o 2: Usar Browser como
Alternativa</a></li>
<li><a href="#solu√ß√£o-3-script-de-verifica√ß√£o-de-suporte" id="toc-solu√ß√£o-3-script-de-verifica√ß√£o-de-suporte"><span class="toc-section-number">1.13</span> Solu√ß√£o 3: Script de Verifica√ß√£o
de Suporte</a></li>
<li><a href="#solu√ß√£o-4-download-alternativo-de-fontes-coloridas" id="toc-solu√ß√£o-4-download-alternativo-de-fontes-coloridas"><span class="toc-section-number">1.14</span> Solu√ß√£o 4: Download Alternativo
de Fontes Coloridas</a></li>
<li><a href="#como-executar" id="toc-como-executar"><span class="toc-section-number">1.15</span> Como Executar:</a></li>
<li><a href="#pontos-importantes" id="toc-pontos-importantes"><span class="toc-section-number">1.16</span> Pontos Importantes:</a></li>
<li><a href="#script-principal-de-convers√£o" id="toc-script-principal-de-convers√£o"><span class="toc-section-number">1.17</span> 1. Script Principal de
Convers√£o</a></li>
<li><a href="#arquivo-requirements" id="toc-arquivo-requirements"><span class="toc-section-number">1.18</span> 2. Arquivo Requirements</a></li>
<li><a href="#script-de-instala√ß√£o-de-depend√™ncias" id="toc-script-de-instala√ß√£o-de-depend√™ncias"><span class="toc-section-number">1.19</span> 3. Script de Instala√ß√£o de
Depend√™ncias</a></li>
<li><a href="#como-executar-1" id="toc-como-executar-1"><span class="toc-section-number">1.20</span> 4. Como Executar</a></li>
<li><a href="#verifica√ß√£o-manual-da-fonte" id="toc-verifica√ß√£o-manual-da-fonte"><span class="toc-section-number">1.21</span> 5. Verifica√ß√£o Manual da
Fonte</a></li>
<li><a href="#solu√ß√£o-alternativa-para-problemas-de-cor" id="toc-solu√ß√£o-alternativa-para-problemas-de-cor"><span class="toc-section-number">1.22</span> 6. Solu√ß√£o Alternativa para
Problemas de Cor</a></li>
<li><a href="#pontos-importantes-1" id="toc-pontos-importantes-1"><span class="toc-section-number">1.23</span> Pontos Importantes:</a></li>
<li><a href="#script-de-corre√ß√£o-para-instala√ß√£o-no-windows-10" id="toc-script-de-corre√ß√£o-para-instala√ß√£o-no-windows-10"><span class="toc-section-number">1.24</span> 1. Script de Corre√ß√£o para
Instala√ß√£o no Windows 10</a></li>
<li><a href="#script-alternativo---download-de-vers√£o-pr√©-compat√≠vel" id="toc-script-alternativo---download-de-vers√£o-pr√©-compat√≠vel"><span class="toc-section-number">1.25</span> 2. Script Alternativo - Download
de Vers√£o Pr√©-Compat√≠vel</a></li>
<li><a href="#solu√ß√£o-de-emerg√™ncia---usando-fontes-do-sistema" id="toc-solu√ß√£o-de-emerg√™ncia---usando-fontes-do-sistema"><span class="toc-section-number">1.26</span> 3. Solu√ß√£o de Emerg√™ncia - Usando
Fontes do Sistema</a></li>
<li><a href="#como-executar-2" id="toc-como-executar-2"><span class="toc-section-number">1.27</span> 4. Como Executar</a></li>
<li><a href="#solu√ß√£o-manual-r√°pida" id="toc-solu√ß√£o-manual-r√°pida"><span class="toc-section-number">1.28</span> 5. Solu√ß√£o Manual R√°pida</a></li>
<li><a href="#pontos-cr√≠ticos" id="toc-pontos-cr√≠ticos"><span class="toc-section-number">1.29</span> Pontos Cr√≠ticos:</a></li>
<li><a href="#script-de-corre√ß√£o-espec√≠fico-para-o-problema" id="toc-script-de-corre√ß√£o-espec√≠fico-para-o-problema"><span class="toc-section-number">1.30</span> 1. Script de Corre√ß√£o Espec√≠fico
para o Problema</a></li>
<li><a href="#script-de-instala√ß√£o-com-verifica√ß√£o-em-tempo-real" id="toc-script-de-instala√ß√£o-com-verifica√ß√£o-em-tempo-real"><span class="toc-section-number">1.31</span> 2. Script de Instala√ß√£o com
Verifica√ß√£o em Tempo Real</a></li>
<li><a href="#solu√ß√£o-r√°pida---uma-linha" id="toc-solu√ß√£o-r√°pida---uma-linha"><span class="toc-section-number">1.32</span> 3. Solu√ß√£o R√°pida - Uma
Linha</a></li>
<li><a href="#como-executar-a-corre√ß√£o" id="toc-como-executar-a-corre√ß√£o"><span class="toc-section-number">1.33</span> 4. Como Executar a
Corre√ß√£o</a></li>
<li><a href="#verifica√ß√£o-p√≥s-instala√ß√£o" id="toc-verifica√ß√£o-p√≥s-instala√ß√£o"><span class="toc-section-number">1.34</span> 5. Verifica√ß√£o
P√≥s-Instala√ß√£o</a></li>
<li><a href="#pontos-cr√≠ticos-para-sucesso" id="toc-pontos-cr√≠ticos-para-sucesso"><span class="toc-section-number">1.35</span> Pontos Cr√≠ticos para
Sucesso:</a></li>
<li><a href="#script-de-corre√ß√£o-de-valida√ß√£o-do-windows" id="toc-script-de-corre√ß√£o-de-valida√ß√£o-do-windows"><span class="toc-section-number">1.36</span> 1. Script de Corre√ß√£o de
Valida√ß√£o do Windows</a></li>
<li><a href="#script-de-instala√ß√£o-com-bypass-de-valida√ß√£o" id="toc-script-de-instala√ß√£o-com-bypass-de-valida√ß√£o"><span class="toc-section-number">1.37</span> 2. Script de Instala√ß√£o com
Bypass de Valida√ß√£o</a></li>
<li><a href="#solu√ß√£o-de-emerg√™ncia---registry-hack" id="toc-solu√ß√£o-de-emerg√™ncia---registry-hack"><span class="toc-section-number">1.38</span> 3. Solu√ß√£o de Emerg√™ncia -
Registry Hack</a></li>
<li><a href="#como-executar-3" id="toc-como-executar-3"><span class="toc-section-number">1.39</span> 4. Como Executar</a></li>
<li><a href="#verifica√ß√£o-final" id="toc-verifica√ß√£o-final"><span class="toc-section-number">1.40</span> 5. Verifica√ß√£o Final</a></li>
<li><a href="#solu√ß√£o-mais-simples-e-imediata" id="toc-solu√ß√£o-mais-simples-e-imediata"><span class="toc-section-number">1.41</span> Solu√ß√£o Mais Simples e
Imediata:</a></li>
<li><a href="#script-de-reconstru√ß√£o-completa-da-fonte" id="toc-script-de-reconstru√ß√£o-completa-da-fonte"><span class="toc-section-number">1.42</span> 1. Script de Reconstru√ß√£o
Completa da Fonte</a></li>
<li><a href="#solu√ß√£o-radical---converter-para-formato-.fon" id="toc-solu√ß√£o-radical---converter-para-formato-.fon"><span class="toc-section-number">1.43</span> 2. Solu√ß√£o Radical - Converter
para Formato .FON</a></li>
<li><a href="#script-de-instala√ß√£o-por-registry-direct" id="toc-script-de-instala√ß√£o-por-registry-direct"><span class="toc-section-number">1.44</span> 3. Script de Instala√ß√£o por
Registry Direct</a></li>
<li><a href="#solu√ß√£o-final---usando-fontforge-via-script" id="toc-solu√ß√£o-final---usando-fontforge-via-script"><span class="toc-section-number">1.45</span> 4. Solu√ß√£o Final - Usando
FontForge via Script</a></li>
<li><a href="#como-executar-4" id="toc-como-executar-4"><span class="toc-section-number">1.46</span> 5. Como Executar</a></li>
<li><a href="#se-nada-disso-funcionar" id="toc-se-nada-disso-funcionar"><span class="toc-section-number">1.47</span> Se NADA disso funcionar:</a></li>
<li><a href="#m√©todo-do-arquivo-.fon-formato-windows-legado" id="toc-m√©todo-do-arquivo-.fon-formato-windows-legado"><span class="toc-section-number">1.48</span> 1. M√©todo do Arquivo .FON
(Formato Windows Legado)</a></li>
<li><a href="#m√©todo-do-arquivo-.ttf-com-cabe√ßalho-corrigido" id="toc-m√©todo-do-arquivo-.ttf-com-cabe√ßalho-corrigido"><span class="toc-section-number">1.49</span> 2. M√©todo do Arquivo .TTF com
Cabe√ßalho Corrigido</a></li>
<li><a href="#m√©todo-do-windows-safe-mode-install" id="toc-m√©todo-do-windows-safe-mode-install"><span class="toc-section-number">1.50</span> 3. M√©todo do Windows Safe Mode
Install</a></li>
<li><a href="#m√©todo-do-python-com-api-windows-direct" id="toc-m√©todo-do-python-com-api-windows-direct"><span class="toc-section-number">1.51</span> 4. M√©todo do Python com API
Windows Direct</a></li>
<li><a href="#solu√ß√£o-final---usando-um-installer-creator" id="toc-solu√ß√£o-final---usando-um-installer-creator"><span class="toc-section-number">1.52</span> 5. Solu√ß√£o Final - Usando um
Installer Creator</a></li>
<li><a href="#como-executar-escolha-um" id="toc-como-executar-escolha-um"><span class="toc-section-number">1.53</span> 6. Como Executar (ESCOLHA
UM):</a></li>
<li><a href="#se-nenhum-m√©todo-funcionar" id="toc-se-nenhum-m√©todo-funcionar"><span class="toc-section-number">1.54</span> Se <strong>NENHUM</strong> m√©todo
funcionar:</a></li>
</ul></li>
</ul>
</nav>
<h1 data-number="1" id="download-e-converter-noto-color-emoji-para-windows"><span class="header-section-number">1</span> Download e converter Noto Color
Emoji para Windows</h1>
<h2 data-number="1.1" id="informa√ß√µes"><span class="header-section-number">1.1</span> üìä Informa√ß√µes</h2>
<ul>
<li><strong>N√∫mero:</strong> #168</li>
<li><strong>Origem:</strong> DeepSeek</li>
<li><strong>Categoria:</strong> Programa√ß√£o</li>
<li><strong>ID:</strong> 692385db-c516-4821-a57a-5abb73ec436e</li>
<li><strong>Criada em:</strong> 2025-09-22 03:36:44</li>
<li><strong>Atualizada em:</strong> 2025-09-22 21:54:15</li>
<li><strong>Total de mensagens:</strong> 16</li>
<li><strong>Resumo:</strong> Noto Color Emoji font download e converter
para formato compativel com windows 10 usando python cond‚Ä¶</li>
</ul>
<hr />
<h2 data-number="1.2" id="conversa"><span class="header-section-number">1.2</span> üí¨ Conversa</h2>
<h3 data-number="1.2.1" id="utilizador-2025-09-22-033645-deepseek-chat"><span class="header-section-number">1.2.1</span> üë§ Utilizador <em>(2025-09-22
03:36:45)</em> <em>[deepseek-chat]</em></h3>
<p>Noto Color Emoji font download e converter para formato compativel
com windows 10 usando python conda</p>
<hr />
<h3 data-number="1.2.2" id="deepseek-2025-09-22-033645-deepseek-chat"><span class="header-section-number">1.2.2</span> ü§ñ DeepSeek <em>(2025-09-22
03:36:45)</em> <em>[deepseek-chat]</em></h3>
<p>Aqui est√° um guia completo para baixar e converter a fonte Noto Color
Emoji para Windows 10 usando Python e Conda:</p>
<h2 data-number="1.3" id="configura√ß√£o-do-ambiente-conda"><span class="header-section-number">1.3</span> 1. Configura√ß√£o do Ambiente
Conda</h2>
<p>Primeiro, crie um ambiente conda:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">conda</span> create <span class="at">-n</span> font-converter python=3.9</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="ex">conda</span> activate font-converter</span></code></pre></div>
<h2 data-number="1.4" id="instala√ß√£o-das-depend√™ncias"><span class="header-section-number">1.4</span> 2. Instala√ß√£o das
Depend√™ncias</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="ex">conda</span> install <span class="at">-c</span> conda-forge fonttools</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="ex">conda</span> install <span class="at">-c</span> conda-forge brotli</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="ex">conda</span> install requests</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="ex">conda</span> install pillow</span></code></pre></div>
<h2 data-number="1.5" id="script-python-para-download-e-convers√£o"><span class="header-section-number">1.5</span> 3. Script Python para Download
e Convers√£o</h2>
<p>Crie um arquivo <code>noto_emoji_converter.py</code>:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> requests</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> zipfile</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> shutil</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fontTools.ttLib <span class="im">import</span> TTFont</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> download_noto_emoji():</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Baixa a fonte Noto Color Emoji&quot;&quot;&quot;</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;Baixando Noto Color Emoji...&quot;</span>)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># URL da fonte Noto Color Emoji (vers√£o mais recente)</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    url <span class="op">=</span> <span class="st">&quot;https://github.com/googlefonts/noto-emoji/raw/main/fonts/NotoColorEmoji.ttf&quot;</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Diret√≥rio de destino</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>    output_dir <span class="op">=</span> Path(<span class="st">&quot;noto_emoji_font&quot;</span>)</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    output_dir.mkdir(exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Caminho do arquivo</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>    font_path <span class="op">=</span> output_dir <span class="op">/</span> <span class="st">&quot;NotoColorEmoji.ttf&quot;</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Download do arquivo</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>        response <span class="op">=</span> requests.get(url, stream<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>        response.raise_for_status()</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> <span class="bu">open</span>(font_path, <span class="st">&#39;wb&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> chunk <span class="kw">in</span> response.iter_content(chunk_size<span class="op">=</span><span class="dv">8192</span>):</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>                f.write(chunk)</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;Download conclu√≠do: </span><span class="sc">{</span>font_path<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> font_path</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;Erro no download: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convert_font_for_windows(input_font_path):</span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Converte a fonte para formato compat√≠vel com Windows&quot;&quot;&quot;</span></span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;Convertendo fonte para Windows 10...&quot;</span>)</span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Carrega a fonte</span></span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>        font <span class="op">=</span> TTFont(input_font_path)</span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Cria uma c√≥pia convertida</span></span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>        output_path <span class="op">=</span> input_font_path.parent <span class="op">/</span> <span class="st">&quot;NotoColorEmoji_Windows.ttf&quot;</span></span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Salva a fonte convertida</span></span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>        font.save(output_path)</span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;Convers√£o conclu√≠da: </span><span class="sc">{</span>output_path<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> output_path</span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;Erro na convers√£o: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> install_font_windows(font_path):</span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Instala a fonte no Windows 10&quot;&quot;&quot;</span></span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;Instalando fonte no Windows 10...&quot;</span>)</span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Caminho padr√£o de fontes do Windows</span></span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a>        fonts_dir <span class="op">=</span> Path(os.environ[<span class="st">&#39;WINDIR&#39;</span>]) <span class="op">/</span> <span class="st">&#39;Fonts&#39;</span></span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> fonts_dir.exists():</span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;Diret√≥rio de fontes do Windows n√£o encontrado&quot;</span>)</span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-71"><a href="#cb3-71" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Copia a fonte para o diret√≥rio de fontes</span></span>
<span id="cb3-72"><a href="#cb3-72" aria-hidden="true" tabindex="-1"></a>        destination <span class="op">=</span> fonts_dir <span class="op">/</span> font_path.name</span>
<span id="cb3-73"><a href="#cb3-73" aria-hidden="true" tabindex="-1"></a>        shutil.copy2(font_path, destination)</span>
<span id="cb3-74"><a href="#cb3-74" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-75"><a href="#cb3-75" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;Fonte instalada em: </span><span class="sc">{</span>destination<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb3-76"><a href="#cb3-76" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;Reinicie seus aplicativos para usar a nova fonte!&quot;</span>)</span>
<span id="cb3-77"><a href="#cb3-77" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb3-78"><a href="#cb3-78" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-79"><a href="#cb3-79" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb3-80"><a href="#cb3-80" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;Erro na instala√ß√£o: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb3-81"><a href="#cb3-81" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb3-82"><a href="#cb3-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-83"><a href="#cb3-83" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> main():</span>
<span id="cb3-84"><a href="#cb3-84" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Fun√ß√£o principal&quot;&quot;&quot;</span></span>
<span id="cb3-85"><a href="#cb3-85" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;=== Conversor de Fonte Noto Color Emoji para Windows 10 ===</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb3-86"><a href="#cb3-86" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-87"><a href="#cb3-87" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Download da fonte</span></span>
<span id="cb3-88"><a href="#cb3-88" aria-hidden="true" tabindex="-1"></a>    font_path <span class="op">=</span> download_noto_emoji()</span>
<span id="cb3-89"><a href="#cb3-89" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> font_path:</span>
<span id="cb3-90"><a href="#cb3-90" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span></span>
<span id="cb3-91"><a href="#cb3-91" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-92"><a href="#cb3-92" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Convers√£o</span></span>
<span id="cb3-93"><a href="#cb3-93" aria-hidden="true" tabindex="-1"></a>    converted_font <span class="op">=</span> convert_font_for_windows(font_path)</span>
<span id="cb3-94"><a href="#cb3-94" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> converted_font:</span>
<span id="cb3-95"><a href="#cb3-95" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span></span>
<span id="cb3-96"><a href="#cb3-96" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-97"><a href="#cb3-97" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Instala√ß√£o (opcional - descomente se quiser instalar automaticamente)</span></span>
<span id="cb3-98"><a href="#cb3-98" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Deseja instalar a fonte automaticamente? (s/n)&quot;</span>)</span>
<span id="cb3-99"><a href="#cb3-99" aria-hidden="true" tabindex="-1"></a>    choice <span class="op">=</span> <span class="bu">input</span>().lower()</span>
<span id="cb3-100"><a href="#cb3-100" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-101"><a href="#cb3-101" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> choice <span class="op">==</span> <span class="st">&#39;s&#39;</span>:</span>
<span id="cb3-102"><a href="#cb3-102" aria-hidden="true" tabindex="-1"></a>        install_font_windows(converted_font)</span>
<span id="cb3-103"><a href="#cb3-103" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb3-104"><a href="#cb3-104" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="ch">\n</span><span class="ss">Fonte convertida salva em: </span><span class="sc">{</span>converted_font<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb3-105"><a href="#cb3-105" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;Instale manualmente copiando para C:</span><span class="ch">\\</span><span class="st">Windows</span><span class="ch">\\</span><span class="st">Fonts&quot;</span>)</span>
<span id="cb3-106"><a href="#cb3-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-107"><a href="#cb3-107" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&quot;__main__&quot;</span>:</span>
<span id="cb3-108"><a href="#cb3-108" aria-hidden="true" tabindex="-1"></a>    main()</span></code></pre></div>
<h2 data-number="1.6" id="script-alternativo-com-mais-op√ß√µes"><span class="header-section-number">1.6</span> 4. Script Alternativo com Mais
Op√ß√µes</h2>
<p>Para mais controle, crie <code>advanced_converter.py</code>:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> requests</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> subprocess</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> NotoEmojiConverter:</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.download_urls <span class="op">=</span> {</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;ttf&#39;</span>: <span class="st">&#39;https://github.com/googlefonts/noto-emoji/raw/main/fonts/NotoColorEmoji.ttf&#39;</span>,</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;woff2&#39;</span>: <span class="st">&#39;https://github.com/googlefonts/noto-emoji/raw/main/fonts/NotoColorEmoji.ttf&#39;</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> download_font(<span class="va">self</span>, format_type<span class="op">=</span><span class="st">&#39;ttf&#39;</span>):</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Baixa a fonte no formato especificado&quot;&quot;&quot;</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>        url <span class="op">=</span> <span class="va">self</span>.download_urls.get(format_type)</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> url:</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>            <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">&quot;Formato n√£o suportado&quot;</span>)</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>        output_dir <span class="op">=</span> Path(<span class="st">&quot;downloads&quot;</span>)</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>        output_dir.mkdir(exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>        font_path <span class="op">=</span> output_dir <span class="op">/</span> <span class="ss">f&quot;NotoColorEmoji.</span><span class="sc">{</span>format_type<span class="sc">}</span><span class="ss">&quot;</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;Baixando </span><span class="sc">{</span>format_type<span class="sc">.</span>upper()<span class="sc">}</span><span class="ss">...&quot;</span>)</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>        response <span class="op">=</span> requests.get(url)</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>        response.raise_for_status()</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> <span class="bu">open</span>(font_path, <span class="st">&#39;wb&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>            f.write(response.content)</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> font_path</span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> convert_to_windows_format(<span class="va">self</span>, input_path):</span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Converte para formato Windows usando fonttools&quot;&quot;&quot;</span></span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>        <span class="im">from</span> fontTools.ttLib <span class="im">import</span> TTFont</span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>        font <span class="op">=</span> TTFont(input_path)</span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>        output_path <span class="op">=</span> input_path.with_name(<span class="ss">f&quot;Windows_</span><span class="sc">{</span>input_path<span class="sc">.</span>name<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Optimiza√ß√µes para Windows</span></span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a>        font.save(output_path)</span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> output_path</span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> verify_font(<span class="va">self</span>, font_path):</span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Verifica se a fonte √© v√°lida&quot;&quot;&quot;</span></span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a>            <span class="im">from</span> fontTools.ttLib <span class="im">import</span> TTFont</span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a>            font <span class="op">=</span> TTFont(font_path)</span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;Fonte v√°lida: </span><span class="sc">{</span><span class="bu">len</span>(font.getGlyphOrder())<span class="sc">}</span><span class="ss"> glifos&quot;</span>)</span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;Fonte inv√°lida: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true" tabindex="-1"></a><span class="co"># Uso</span></span>
<span id="cb4-56"><a href="#cb4-56" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&quot;__main__&quot;</span>:</span>
<span id="cb4-57"><a href="#cb4-57" aria-hidden="true" tabindex="-1"></a>    converter <span class="op">=</span> NotoEmojiConverter()</span>
<span id="cb4-58"><a href="#cb4-58" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-59"><a href="#cb4-59" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Download</span></span>
<span id="cb4-60"><a href="#cb4-60" aria-hidden="true" tabindex="-1"></a>    font_path <span class="op">=</span> converter.download_font(<span class="st">&#39;ttf&#39;</span>)</span>
<span id="cb4-61"><a href="#cb4-61" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-62"><a href="#cb4-62" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Verifica√ß√£o</span></span>
<span id="cb4-63"><a href="#cb4-63" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> converter.verify_font(font_path):</span>
<span id="cb4-64"><a href="#cb4-64" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Convers√£o</span></span>
<span id="cb4-65"><a href="#cb4-65" aria-hidden="true" tabindex="-1"></a>        windows_font <span class="op">=</span> converter.convert_to_windows_format(font_path)</span>
<span id="cb4-66"><a href="#cb4-66" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;Fonte convertida: </span><span class="sc">{</span>windows_font<span class="sc">}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<h2 data-number="1.7" id="instala√ß√£o-manual-no-windows-10"><span class="header-section-number">1.7</span> 5. Instala√ß√£o Manual no Windows
10</h2>
<p>Se preferir instalar manualmente:</p>
<ol type="1">
<li>Execute o script para baixar a fonte</li>
<li>V√° para <code>C:\Windows\Fonts</code></li>
<li>Arraste o arquivo <code>.ttf</code> para a pasta Fonts</li>
<li>Windows instalar√° automaticamente</li>
</ol>
<h2 data-number="1.8" id="requirements-file-opcional"><span class="header-section-number">1.8</span> 6. Requirements File
(opcional)</h2>
<p>Crie <code>requirements.txt</code>:</p>
<pre><code>fonttools&gt;=4.28.0
requests&gt;=2.25.0
Pillow&gt;=8.0.0
brotli&gt;=1.0.0</code></pre>
<h2 data-number="1.9" id="execu√ß√£o"><span class="header-section-number">1.9</span> 7. Execu√ß√£o</h2>
<div class="sourceCode" id="cb6"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ative o ambiente conda</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="ex">conda</span> activate font-converter</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Execute o script</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> noto_emoji_converter.py</span></code></pre></div>
<h2 data-number="1.10" id="notas-importantes"><span class="header-section-number">1.10</span> Notas Importantes:</h2>
<ol type="1">
<li><strong>Permiss√µes</strong>: O script pode precisar de permiss√µes de
administrador para instalar fontes</li>
<li><strong>Backup</strong>: Sempre fa√ßa backup das fontes
existentes</li>
<li><strong>Compatibilidade</strong>: A fonte Noto Color Emoji √©
principalmente para Linux/macOS, mas esta convers√£o melhora a
compatibilidade com Windows</li>
<li><strong>Alternativas</strong>: Considere tamb√©m a fonte ‚ÄúSegoe UI
Emoji‚Äù que j√° vem com Windows 10</li>
</ol>
<p>Este m√©todo fornece uma maneira automatizada de obter e preparar a
fonte Noto Color Emoji para uso no Windows 10!</p>
<hr />
<h3 data-number="1.10.1" id="utilizador-2025-09-22-033944-deepseek-chat"><span class="header-section-number">1.10.1</span> üë§ Utilizador
<em>(2025-09-22 03:39:44)</em> <em>[deepseek-chat]</em></h3>
<p>NotoColorEmoji_WindowsCompatible.ttf funciona mas n√£o √© colorida</p>
<hr />
<h3 data-number="1.10.2" id="deepseek-2025-09-22-033944-deepseek-chat"><span class="header-section-number">1.10.2</span> ü§ñ DeepSeek <em>(2025-09-22
03:39:44)</em> <em>[deepseek-chat]</em></h3>
<p>Voc√™ est√° certo! O problema √© que o formato TTF padr√£o n√£o suporta
emojis coloridos. No Windows, os emojis coloridos geralmente usam
formatos especiais. Vou mostrar como obter emojis coloridos
funcionando:</p>
<h2 data-number="1.11" id="solu√ß√£o-1-usar-a-vers√£o-colrcpal-recomendado"><span class="header-section-number">1.11</span> Solu√ß√£o 1: Usar a vers√£o
COLR/CPAL (Recomendado)</h2>
<div class="sourceCode" id="cb7"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> requests</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> shutil</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> download_colored_noto_emoji():</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Baixa a vers√£o colorida do Noto Emoji&quot;&quot;&quot;</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;Baixando Noto Color Emoji (vers√£o colorida)...&quot;</span>)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># URL alternativa com suporte a cores</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    url <span class="op">=</span> <span class="st">&quot;https://github.com/googlefonts/noto-emoji/raw/main/fonts/NotoColorEmoji_WindowsCompatible.ttf&quot;</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    output_dir <span class="op">=</span> Path(<span class="st">&quot;noto_emoji_color&quot;</span>)</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>    output_dir.mkdir(exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>    font_path <span class="op">=</span> output_dir <span class="op">/</span> <span class="st">&quot;NotoColorEmoji_Windows.ttf&quot;</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>        response <span class="op">=</span> requests.get(url, stream<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>        response.raise_for_status()</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> <span class="bu">open</span>(font_path, <span class="st">&#39;wb&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> chunk <span class="kw">in</span> response.iter_content(chunk_size<span class="op">=</span><span class="dv">8192</span>):</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>                f.write(chunk)</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;Download conclu√≠do: </span><span class="sc">{</span>font_path<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> font_path</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;Erro no download: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> check_font_colors(font_path):</span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Verifica se a fonte suporta cores&quot;&quot;&quot;</span></span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>        <span class="im">from</span> fontTools.ttLib <span class="im">import</span> TTFont</span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>        font <span class="op">=</span> TTFont(font_path)</span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Verifica tabelas de cores</span></span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>        has_color <span class="op">=</span> <span class="st">&#39;COLR&#39;</span> <span class="kw">in</span> font <span class="kw">or</span> <span class="st">&#39;CPAL&#39;</span> <span class="kw">in</span> font</span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;Suporte a cores: </span><span class="sc">{</span>has_color<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">&#39;COLR&#39;</span> <span class="kw">in</span> font:</span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;‚úì Suporte a formato COLR encontrado&quot;</span>)</span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">&#39;CPAL&#39;</span> <span class="kw">in</span> font:</span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;‚úì Suporte a paleta de cores encontrado&quot;</span>)</span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> has_color</span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;Erro ao verificar cores: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> install_font_with_registry(font_path):</span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Instala a fonte e atualiza registro se necess√°rio&quot;&quot;&quot;</span></span>
<span id="cb7-56"><a href="#cb7-56" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb7-57"><a href="#cb7-57" aria-hidden="true" tabindex="-1"></a>        fonts_dir <span class="op">=</span> Path(os.environ[<span class="st">&#39;WINDIR&#39;</span>]) <span class="op">/</span> <span class="st">&#39;Fonts&#39;</span></span>
<span id="cb7-58"><a href="#cb7-58" aria-hidden="true" tabindex="-1"></a>        destination <span class="op">=</span> fonts_dir <span class="op">/</span> font_path.name</span>
<span id="cb7-59"><a href="#cb7-59" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb7-60"><a href="#cb7-60" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Copia a fonte</span></span>
<span id="cb7-61"><a href="#cb7-61" aria-hidden="true" tabindex="-1"></a>        shutil.copy2(font_path, destination)</span>
<span id="cb7-62"><a href="#cb7-62" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb7-63"><a href="#cb7-63" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;Fonte instalada. Para emojis coloridos:&quot;</span>)</span>
<span id="cb7-64"><a href="#cb7-64" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;1. Reinicie o Windows Explorer&quot;</span>)</span>
<span id="cb7-65"><a href="#cb7-65" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;2. Ou reinicie o computador&quot;</span>)</span>
<span id="cb7-66"><a href="#cb7-66" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;3. Aplicativos suportados: Chrome, Firefox, Edge recente&quot;</span>)</span>
<span id="cb7-67"><a href="#cb7-67" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb7-68"><a href="#cb7-68" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb7-69"><a href="#cb7-69" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb7-70"><a href="#cb7-70" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb7-71"><a href="#cb7-71" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;Erro na instala√ß√£o: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb7-72"><a href="#cb7-72" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb7-73"><a href="#cb7-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-74"><a href="#cb7-74" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> main():</span>
<span id="cb7-75"><a href="#cb7-75" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;=== Instalador Noto Color Emoji para Windows 10 ===</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb7-76"><a href="#cb7-76" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-77"><a href="#cb7-77" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Download da vers√£o colorida</span></span>
<span id="cb7-78"><a href="#cb7-78" aria-hidden="true" tabindex="-1"></a>    font_path <span class="op">=</span> download_colored_noto_emoji()</span>
<span id="cb7-79"><a href="#cb7-79" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> font_path:</span>
<span id="cb7-80"><a href="#cb7-80" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span></span>
<span id="cb7-81"><a href="#cb7-81" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-82"><a href="#cb7-82" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Verifica suporte a cores</span></span>
<span id="cb7-83"><a href="#cb7-83" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> check_font_colors(font_path):</span>
<span id="cb7-84"><a href="#cb7-84" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;‚ö†Ô∏è  Esta vers√£o pode n√£o suportar cores completamente&quot;</span>)</span>
<span id="cb7-85"><a href="#cb7-85" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-86"><a href="#cb7-86" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Instala√ß√£o</span></span>
<span id="cb7-87"><a href="#cb7-87" aria-hidden="true" tabindex="-1"></a>    install_font_with_registry(font_path)</span>
<span id="cb7-88"><a href="#cb7-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-89"><a href="#cb7-89" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&quot;__main__&quot;</span>:</span>
<span id="cb7-90"><a href="#cb7-90" aria-hidden="true" tabindex="-1"></a>    main()</span></code></pre></div>
<h2 data-number="1.12" id="solu√ß√£o-2-usar-browser-como-alternativa"><span class="header-section-number">1.12</span> Solu√ß√£o 2: Usar Browser como
Alternativa</h2>
<p>Se a fonte n√£o ficar colorida, use este script para detectar emojis
coloridos no browser:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> webbrowser</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tempfile</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_emoji_test_page():</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Cria p√°gina HTML para testar emojis coloridos&quot;&quot;&quot;</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    html_content <span class="op">=</span> <span class="st">&quot;&quot;&quot;</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;!DOCTYPE html&gt;</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;html&gt;</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;head&gt;</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;meta charset=&quot;UTF-8&quot;&gt;</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;title&gt;Teste Emojis Coloridos&lt;/title&gt;</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;style&gt;</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="st">            body { font-family: Arial, sans-serif; margin: 40px; }</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="st">            .emoji-grid { display: grid; grid-template-columns: repeat(10, 1fr); gap: 10px; }</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a><span class="st">            .emoji { font-size: 2em; text-align: center; }</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="st">            .noto { font-family: &quot;Noto Color Emoji&quot;, sans-serif; }</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a><span class="st">            .segoe { font-family: &quot;Segoe UI Emoji&quot;, sans-serif; }</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;/style&gt;</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;/head&gt;</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;body&gt;</span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;h1&gt;Teste de Emojis Coloridos&lt;/h1&gt;</span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;h2&gt;Com Noto Color Emoji:&lt;/h2&gt;</span></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;div class=&quot;emoji-grid&quot;&gt;</span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a><span class="st">            &lt;div class=&quot;emoji noto&quot;&gt;üòÄ&lt;/div&gt;</span></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a><span class="st">            &lt;div class=&quot;emoji noto&quot;&gt;‚ù§Ô∏è&lt;/div&gt;</span></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a><span class="st">            &lt;div class=&quot;emoji noto&quot;&gt;üéâ&lt;/div&gt;</span></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a><span class="st">            &lt;div class=&quot;emoji noto&quot;&gt;üê±&lt;/div&gt;</span></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a><span class="st">            &lt;div class=&quot;emoji noto&quot;&gt;üåç&lt;/div&gt;</span></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a><span class="st">            &lt;div class=&quot;emoji noto&quot;&gt;üçï&lt;/div&gt;</span></span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a><span class="st">            &lt;div class=&quot;emoji noto&quot;&gt;üöÄ&lt;/div&gt;</span></span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a><span class="st">            &lt;div class=&quot;emoji noto&quot;&gt;‚≠ê&lt;/div&gt;</span></span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a><span class="st">            &lt;div class=&quot;emoji noto&quot;&gt;üé®&lt;/div&gt;</span></span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a><span class="st">            &lt;div class=&quot;emoji noto&quot;&gt;üì±&lt;/div&gt;</span></span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;/div&gt;</span></span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;h2&gt;Com Segoe UI Emoji (Windows):&lt;/h2&gt;</span></span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;div class=&quot;emoji-grid&quot;&gt;</span></span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a><span class="st">            &lt;div class=&quot;emoji segoe&quot;&gt;üòÄ&lt;/div&gt;</span></span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a><span class="st">            &lt;div class=&quot;emoji segoe&quot;&gt;‚ù§Ô∏è&lt;/div&gt;</span></span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a><span class="st">            &lt;div class=&quot;emoji segoe&quot;&gt;üéâ&lt;/div&gt;</span></span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a><span class="st">            &lt;div class=&quot;emoji segoe&quot;&gt;üê±&lt;/div&gt;</span></span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a><span class="st">            &lt;div class=&quot;emoji segoe&quot;&gt;üåç&lt;/div&gt;</span></span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a><span class="st">            &lt;div class=&quot;emoji segoe&quot;&gt;üçï&lt;/div&gt;</span></span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a><span class="st">            &lt;div class=&quot;emoji segoe&quot;&gt;üöÄ&lt;/div&gt;</span></span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a><span class="st">            &lt;div class=&quot;emoji segoe&quot;&gt;‚≠ê&lt;/div&gt;</span></span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a><span class="st">            &lt;div class=&quot;emoji segoe&quot;&gt;üé®&lt;/div&gt;</span></span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a><span class="st">            &lt;div class=&quot;emoji segoe&quot;&gt;üì±&lt;/div&gt;</span></span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;/div&gt;</span></span>
<span id="cb8-51"><a href="#cb8-51" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb8-52"><a href="#cb8-52" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;p&gt;Se os emojis superiores estiverem coloridos, a fonte est√° funcionando!&lt;/p&gt;</span></span>
<span id="cb8-53"><a href="#cb8-53" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;/body&gt;</span></span>
<span id="cb8-54"><a href="#cb8-54" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;/html&gt;</span></span>
<span id="cb8-55"><a href="#cb8-55" aria-hidden="true" tabindex="-1"></a><span class="st">    &quot;&quot;&quot;</span></span>
<span id="cb8-56"><a href="#cb8-56" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-57"><a href="#cb8-57" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Cria arquivo tempor√°rio</span></span>
<span id="cb8-58"><a href="#cb8-58" aria-hidden="true" tabindex="-1"></a>    temp_file <span class="op">=</span> tempfile.NamedTemporaryFile(mode<span class="op">=</span><span class="st">&#39;w&#39;</span>, suffix<span class="op">=</span><span class="st">&#39;.html&#39;</span>, delete<span class="op">=</span><span class="va">False</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>)</span>
<span id="cb8-59"><a href="#cb8-59" aria-hidden="true" tabindex="-1"></a>    temp_file.write(html_content)</span>
<span id="cb8-60"><a href="#cb8-60" aria-hidden="true" tabindex="-1"></a>    temp_file.close()</span>
<span id="cb8-61"><a href="#cb8-61" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-62"><a href="#cb8-62" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> temp_file.name</span>
<span id="cb8-63"><a href="#cb8-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-64"><a href="#cb8-64" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> test_emoji_colors():</span>
<span id="cb8-65"><a href="#cb8-65" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Abre teste no navegador&quot;&quot;&quot;</span></span>
<span id="cb8-66"><a href="#cb8-66" aria-hidden="true" tabindex="-1"></a>    test_page <span class="op">=</span> create_emoji_test_page()</span>
<span id="cb8-67"><a href="#cb8-67" aria-hidden="true" tabindex="-1"></a>    webbrowser.<span class="bu">open</span>(<span class="ss">f&#39;file://</span><span class="sc">{</span>test_page<span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb8-68"><a href="#cb8-68" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;Teste aberto no navegador. Verifique se os emojis est√£o coloridos.&quot;</span>)</span>
<span id="cb8-69"><a href="#cb8-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-70"><a href="#cb8-70" aria-hidden="true" tabindex="-1"></a><span class="co"># Adicione esta fun√ß√£o ao main anterior</span></span>
<span id="cb8-71"><a href="#cb8-71" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> main_complete():</span>
<span id="cb8-72"><a href="#cb8-72" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;=== Sistema Completo de Emojis Coloridos ===</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb8-73"><a href="#cb8-73" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-74"><a href="#cb8-74" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Instala fonte</span></span>
<span id="cb8-75"><a href="#cb8-75" aria-hidden="true" tabindex="-1"></a>    font_path <span class="op">=</span> download_colored_noto_emoji()</span>
<span id="cb8-76"><a href="#cb8-76" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> font_path:</span>
<span id="cb8-77"><a href="#cb8-77" aria-hidden="true" tabindex="-1"></a>        install_font_with_registry(font_path)</span>
<span id="cb8-78"><a href="#cb8-78" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-79"><a href="#cb8-79" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Abre teste</span></span>
<span id="cb8-80"><a href="#cb8-80" aria-hidden="true" tabindex="-1"></a>    test_emoji_colors()</span>
<span id="cb8-81"><a href="#cb8-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-82"><a href="#cb8-82" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&quot;__main__&quot;</span>:</span>
<span id="cb8-83"><a href="#cb8-83" aria-hidden="true" tabindex="-1"></a>    main_complete()</span></code></pre></div>
<h2 data-number="1.13" id="solu√ß√£o-3-script-de-verifica√ß√£o-de-suporte"><span class="header-section-number">1.13</span> Solu√ß√£o 3: Script de
Verifica√ß√£o de Suporte</h2>
<div class="sourceCode" id="cb9"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> check_windows_emoji_support():</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Verifica o suporte a emojis coloridos no Windows&quot;&quot;&quot;</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    <span class="im">import</span> platform</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    <span class="im">import</span> sys</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;=== Diagn√≥stico de Suporte a Emojis Coloridos ===</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Informa√ß√µes do sistema</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;Sistema: </span><span class="sc">{</span>platform<span class="sc">.</span>system()<span class="sc">}</span><span class="ss"> </span><span class="sc">{</span>platform<span class="sc">.</span>release()<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;Python: </span><span class="sc">{</span>sys<span class="sc">.</span>version<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Verifica navegadores instalados</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>    browsers <span class="op">=</span> [</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>        (<span class="st">&#39;Chrome&#39;</span>, <span class="st">&#39;C:</span><span class="ch">\\</span><span class="st">Program Files</span><span class="ch">\\</span><span class="st">Google</span><span class="ch">\\</span><span class="st">Chrome</span><span class="ch">\\</span><span class="st">Application</span><span class="ch">\\</span><span class="st">chrome.exe&#39;</span>),</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>        (<span class="st">&#39;Firefox&#39;</span>, <span class="st">&#39;C:</span><span class="ch">\\</span><span class="st">Program Files</span><span class="ch">\\</span><span class="st">Mozilla Firefox</span><span class="ch">\\</span><span class="st">firefox.exe&#39;</span>),</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>        (<span class="st">&#39;Edge&#39;</span>, <span class="st">&#39;C:</span><span class="ch">\\</span><span class="st">Program Files (x86)</span><span class="ch">\\</span><span class="st">Microsoft</span><span class="ch">\\</span><span class="st">Edge</span><span class="ch">\\</span><span class="st">Application</span><span class="ch">\\</span><span class="st">msedge.exe&#39;</span>)</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Navegadores detectados:&quot;</span>)</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> name, path <span class="kw">in</span> browsers:</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> os.path.exists(path):</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚úì </span><span class="sc">{</span>name<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚úó </span><span class="sc">{</span>name<span class="sc">}</span><span class="ss"> (n√£o instalado)&quot;</span>)</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Recomenda√ß√µes</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">üìã Recomenda√ß√µes:&quot;</span>)</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;1. Use Chrome, Firefox ou Edge recente&quot;</span>)</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;2. Atualize seu navegador para vers√£o mais recente&quot;</span>)</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;3. Em alguns apps, emojis podem aparecer em preto e branco&quot;</span>)</span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;4. Navegadores geralmente mostram emojis coloridos melhor que apps desktop&quot;</span>)</span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>check_windows_emoji_support()</span></code></pre></div>
<h2 data-number="1.14" id="solu√ß√£o-4-download-alternativo-de-fontes-coloridas"><span class="header-section-number">1.14</span> Solu√ß√£o 4: Download
Alternativo de Fontes Coloridas</h2>
<div class="sourceCode" id="cb10"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> download_alternative_colored_fonts():</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Tenta baixar de fontes alternativas&quot;&quot;&quot;</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    sources <span class="op">=</span> [</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;name&#39;</span>: <span class="st">&#39;Noto Emoji GitHub&#39;</span>,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;url&#39;</span>: <span class="st">&#39;https://github.com/googlefonts/noto-emoji/raw/main/fonts/NotoColorEmoji.ttf&#39;</span>,</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;format&#39;</span>: <span class="st">&#39;TTF&#39;</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;name&#39;</span>: <span class="st">&#39;Twitter Emoji&#39;</span>,</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;url&#39;</span>: <span class="st">&#39;https://github.com/twitter/twemoji/raw/master/assets/fonts/TwitterColorEmoji-SVGinOT.ttf&#39;</span>,</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;format&#39;</span>: <span class="st">&#39;SVGinOT&#39;</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> source <span class="kw">in</span> sources:</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;Tentando: </span><span class="sc">{</span>source[<span class="st">&#39;name&#39;</span>]<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>            response <span class="op">=</span> requests.get(source[<span class="st">&#39;url&#39;</span>], timeout<span class="op">=</span><span class="dv">30</span>)</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>            response.raise_for_status()</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>            filename <span class="op">=</span> <span class="ss">f&quot;</span><span class="sc">{</span>source[<span class="st">&#39;name&#39;</span>]<span class="sc">.</span>replace(<span class="st">&#39; &#39;</span>, <span class="st">&#39;_&#39;</span>)<span class="sc">}</span><span class="ss">.ttf&quot;</span></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(filename, <span class="st">&#39;wb&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>                f.write(response.content)</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚úì Sucesso: </span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> filename</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚úó Falha: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">None</span></span></code></pre></div>
<h2 data-number="1.15" id="como-executar"><span class="header-section-number">1.15</span> Como Executar:</h2>
<ol type="1">
<li><strong>Salve um dos scripts acima</strong> como
<code>emoji_color_fix.py</code></li>
<li><strong>Execute com Conda</strong>:</li>
</ol>
<div class="sourceCode" id="cb11"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="ex">conda</span> activate font-converter</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> emoji_color_fix.py</span></code></pre></div>
<ol start="3" type="1">
<li><strong>Siga as instru√ß√µes</strong> na tela</li>
</ol>
<h2 data-number="1.16" id="pontos-importantes"><span class="header-section-number">1.16</span> Pontos Importantes:</h2>
<ol type="1">
<li><strong>Navegadores vs Aplicativos</strong>: Emojis coloridos
funcionam melhor em navegadores</li>
<li><strong>Vers√£o do Windows</strong>: Windows 10+ suporta melhor
emojis coloridos</li>
<li><strong>Aplicativos</strong>: Alguns apps (como Telegram, Discord)
t√™m seus pr√≥prios emojis</li>
<li><strong>Limita√ß√µes</strong>: N√£o todos os aplicativos suportam
emojis coloridos de fontes externas</li>
</ol>
<p>A segunda solu√ß√£o (com teste no navegador) √© a mais eficaz para
verificar se est√° funcionando!</p>
<hr />
<h3 data-number="1.16.1" id="utilizador-2025-09-22-034141-deepseek-chat"><span class="header-section-number">1.16.1</span> üë§ Utilizador
<em>(2025-09-22 03:41:41)</em> <em>[deepseek-chat]</em></h3>
<p>Como converter NotoColorEmoji.ttf de forma que seja compat√≠vel com
Windows 10</p>
<hr />
<h3 data-number="1.16.2" id="deepseek-2025-09-22-034141-deepseek-chat"><span class="header-section-number">1.16.2</span> ü§ñ DeepSeek <em>(2025-09-22
03:41:41)</em> <em>[deepseek-chat]</em></h3>
<p>Para converter o NotoColorEmoji.ttf para ser compat√≠vel com Windows
10 mantendo as cores, precisamos usar abordagens espec√≠ficas. Aqui est√°
a solu√ß√£o completa:</p>
<h2 data-number="1.17" id="script-principal-de-convers√£o"><span class="header-section-number">1.17</span> 1. Script Principal de
Convers√£o</h2>
<div class="sourceCode" id="cb12"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> requests</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> shutil</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tempfile</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fontTools.ttLib <span class="im">import</span> TTFont</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fontTools.ttLib.tables._c_m_a_p <span class="im">import</span> table__c_m_a_p</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> subprocess</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> NotoEmojiWindowsConverter:</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.temp_dir <span class="op">=</span> Path(tempfile.mkdtemp())</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.output_dir <span class="op">=</span> Path(<span class="st">&quot;NotoColorEmoji_Windows&quot;</span>)</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.output_dir.mkdir(exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> download_noto_emoji(<span class="va">self</span>):</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Baixa a fonte Noto Color Emoji original&quot;&quot;&quot;</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;üì• Baixando Noto Color Emoji...&quot;</span>)</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>        url <span class="op">=</span> <span class="st">&quot;https://github.com/googlefonts/noto-emoji/raw/main/fonts/NotoColorEmoji.ttf&quot;</span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>            response <span class="op">=</span> requests.get(url, stream<span class="op">=</span><span class="va">True</span>, timeout<span class="op">=</span><span class="dv">60</span>)</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>            response.raise_for_status()</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>            original_path <span class="op">=</span> <span class="va">self</span>.temp_dir <span class="op">/</span> <span class="st">&quot;NotoColorEmoji_Original.ttf&quot;</span></span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(original_path, <span class="st">&#39;wb&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> chunk <span class="kw">in</span> response.iter_content(chunk_size<span class="op">=</span><span class="dv">8192</span>):</span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>                    f.write(chunk)</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚úì Download completo: </span><span class="sc">{</span>original_path<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> original_path</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚úó Erro no download: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> check_font_tables(<span class="va">self</span>, font_path):</span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Verifica as tabelas da fonte&quot;&quot;&quot;</span></span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a>            font <span class="op">=</span> TTFont(font_path)</span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;üìä Tabelas da fonte:&quot;</span>)</span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a>            color_tables <span class="op">=</span> []</span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> table <span class="kw">in</span> font.keys():</span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;  - </span><span class="sc">{</span>table<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> table <span class="kw">in</span> [<span class="st">&#39;COLR&#39;</span>, <span class="st">&#39;CPAL&#39;</span>, <span class="st">&#39;SVG &#39;</span>]:</span>
<span id="cb12-48"><a href="#cb12-48" aria-hidden="true" tabindex="-1"></a>                    color_tables.append(table)</span>
<span id="cb12-49"><a href="#cb12-49" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb12-50"><a href="#cb12-50" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> color_tables:</span>
<span id="cb12-51"><a href="#cb12-51" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;üé® Tabelas de cores encontradas: </span><span class="sc">{</span>color_tables<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb12-52"><a href="#cb12-52" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb12-53"><a href="#cb12-53" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;‚ö†Ô∏è  Nenhuma tabela de cores encontrada&quot;</span>)</span>
<span id="cb12-54"><a href="#cb12-54" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb12-55"><a href="#cb12-55" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> color_tables</span>
<span id="cb12-56"><a href="#cb12-56" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb12-57"><a href="#cb12-57" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb12-58"><a href="#cb12-58" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚úó Erro ao verificar tabelas: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb12-59"><a href="#cb12-59" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> []</span>
<span id="cb12-60"><a href="#cb12-60" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-61"><a href="#cb12-61" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> convert_cmap_table(<span class="va">self</span>, font_path):</span>
<span id="cb12-62"><a href="#cb12-62" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Converte a tabela CMAP para compatibilidade Windows&quot;&quot;&quot;</span></span>
<span id="cb12-63"><a href="#cb12-63" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;üîÑ Convertendo tabela CMAP para Windows...&quot;</span>)</span>
<span id="cb12-64"><a href="#cb12-64" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb12-65"><a href="#cb12-65" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb12-66"><a href="#cb12-66" aria-hidden="true" tabindex="-1"></a>            font <span class="op">=</span> TTFont(font_path)</span>
<span id="cb12-67"><a href="#cb12-67" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb12-68"><a href="#cb12-68" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Verifica e ajusta a tabela CMAP</span></span>
<span id="cb12-69"><a href="#cb12-69" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="st">&#39;cmap&#39;</span> <span class="kw">in</span> font:</span>
<span id="cb12-70"><a href="#cb12-70" aria-hidden="true" tabindex="-1"></a>                cmap_table <span class="op">=</span> font[<span class="st">&#39;cmap&#39;</span>]</span>
<span id="cb12-71"><a href="#cb12-71" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb12-72"><a href="#cb12-72" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Adiciona formatos compat√≠veis com Windows</span></span>
<span id="cb12-73"><a href="#cb12-73" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> subtable <span class="kw">in</span> cmap_table.tables:</span>
<span id="cb12-74"><a href="#cb12-74" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> subtable.<span class="bu">format</span> <span class="op">==</span> <span class="dv">4</span>:</span>
<span id="cb12-75"><a href="#cb12-75" aria-hidden="true" tabindex="-1"></a>                        subtable.platformID <span class="op">=</span> <span class="dv">3</span>  <span class="co"># Microsoft</span></span>
<span id="cb12-76"><a href="#cb12-76" aria-hidden="true" tabindex="-1"></a>                        subtable.platEncID <span class="op">=</span> <span class="dv">1</span>   <span class="co"># Unicode BMP</span></span>
<span id="cb12-77"><a href="#cb12-77" aria-hidden="true" tabindex="-1"></a>                        subtable.<span class="bu">format</span> <span class="op">=</span> <span class="dv">4</span></span>
<span id="cb12-78"><a href="#cb12-78" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb12-79"><a href="#cb12-79" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> subtable.<span class="bu">format</span> <span class="op">==</span> <span class="dv">12</span>:</span>
<span id="cb12-80"><a href="#cb12-80" aria-hidden="true" tabindex="-1"></a>                        subtable.platformID <span class="op">=</span> <span class="dv">3</span>  <span class="co"># Microsoft</span></span>
<span id="cb12-81"><a href="#cb12-81" aria-hidden="true" tabindex="-1"></a>                        subtable.platEncID <span class="op">=</span> <span class="dv">10</span>  <span class="co"># Unicode UCS-4</span></span>
<span id="cb12-82"><a href="#cb12-82" aria-hidden="true" tabindex="-1"></a>                        subtable.<span class="bu">format</span> <span class="op">=</span> <span class="dv">12</span></span>
<span id="cb12-83"><a href="#cb12-83" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb12-84"><a href="#cb12-84" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Salva fonte convertida</span></span>
<span id="cb12-85"><a href="#cb12-85" aria-hidden="true" tabindex="-1"></a>            converted_path <span class="op">=</span> <span class="va">self</span>.output_dir <span class="op">/</span> <span class="st">&quot;NotoColorEmoji_Windows_CMAP.ttf&quot;</span></span>
<span id="cb12-86"><a href="#cb12-86" aria-hidden="true" tabindex="-1"></a>            font.save(converted_path)</span>
<span id="cb12-87"><a href="#cb12-87" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb12-88"><a href="#cb12-88" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚úì CMAP convertido: </span><span class="sc">{</span>converted_path<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb12-89"><a href="#cb12-89" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> converted_path</span>
<span id="cb12-90"><a href="#cb12-90" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb12-91"><a href="#cb12-91" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb12-92"><a href="#cb12-92" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚úó Erro na convers√£o CMAP: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb12-93"><a href="#cb12-93" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> font_path</span>
<span id="cb12-94"><a href="#cb12-94" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-95"><a href="#cb12-95" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> optimize_for_windows(<span class="va">self</span>, font_path):</span>
<span id="cb12-96"><a href="#cb12-96" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Otimiza a fonte para Windows&quot;&quot;&quot;</span></span>
<span id="cb12-97"><a href="#cb12-97" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;‚öôÔ∏è  Otimizando para Windows...&quot;</span>)</span>
<span id="cb12-98"><a href="#cb12-98" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb12-99"><a href="#cb12-99" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb12-100"><a href="#cb12-100" aria-hidden="true" tabindex="-1"></a>            font <span class="op">=</span> TTFont(font_path)</span>
<span id="cb12-101"><a href="#cb12-101" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb12-102"><a href="#cb12-102" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Adiciona metadados Windows</span></span>
<span id="cb12-103"><a href="#cb12-103" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="st">&#39;name&#39;</span> <span class="kw">in</span> font:</span>
<span id="cb12-104"><a href="#cb12-104" aria-hidden="true" tabindex="-1"></a>                name_table <span class="op">=</span> font[<span class="st">&#39;name&#39;</span>]</span>
<span id="cb12-105"><a href="#cb12-105" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> record <span class="kw">in</span> name_table.names:</span>
<span id="cb12-106"><a href="#cb12-106" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> record.nameID <span class="op">==</span> <span class="dv">1</span>:  <span class="co"># Font Family name</span></span>
<span id="cb12-107"><a href="#cb12-107" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">if</span> record.platformID <span class="op">==</span> <span class="dv">3</span>:  <span class="co"># Windows</span></span>
<span id="cb12-108"><a href="#cb12-108" aria-hidden="true" tabindex="-1"></a>                            record.string <span class="op">=</span> <span class="st">&quot;Noto Color Emoji Windows&quot;</span>.encode(<span class="st">&#39;utf-16be&#39;</span>)</span>
<span id="cb12-109"><a href="#cb12-109" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb12-110"><a href="#cb12-110" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Salva fonte otimizada</span></span>
<span id="cb12-111"><a href="#cb12-111" aria-hidden="true" tabindex="-1"></a>            optimized_path <span class="op">=</span> <span class="va">self</span>.output_dir <span class="op">/</span> <span class="st">&quot;NotoColorEmoji_Windows_Optimized.ttf&quot;</span></span>
<span id="cb12-112"><a href="#cb12-112" aria-hidden="true" tabindex="-1"></a>            font.save(optimized_path)</span>
<span id="cb12-113"><a href="#cb12-113" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb12-114"><a href="#cb12-114" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚úì Fonte otimizada: </span><span class="sc">{</span>optimized_path<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb12-115"><a href="#cb12-115" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> optimized_path</span>
<span id="cb12-116"><a href="#cb12-116" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb12-117"><a href="#cb12-117" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb12-118"><a href="#cb12-118" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚úó Erro na otimiza√ß√£o: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb12-119"><a href="#cb12-119" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> font_path</span>
<span id="cb12-120"><a href="#cb12-120" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-121"><a href="#cb12-121" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> install_font_windows(<span class="va">self</span>, font_path):</span>
<span id="cb12-122"><a href="#cb12-122" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Instala a fonte no Windows&quot;&quot;&quot;</span></span>
<span id="cb12-123"><a href="#cb12-123" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;üîß Instalando fonte no Windows...&quot;</span>)</span>
<span id="cb12-124"><a href="#cb12-124" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb12-125"><a href="#cb12-125" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb12-126"><a href="#cb12-126" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Diret√≥rio de fontes do Windows</span></span>
<span id="cb12-127"><a href="#cb12-127" aria-hidden="true" tabindex="-1"></a>            fonts_dir <span class="op">=</span> Path(os.environ[<span class="st">&#39;WINDIR&#39;</span>]) <span class="op">/</span> <span class="st">&#39;Fonts&#39;</span></span>
<span id="cb12-128"><a href="#cb12-128" aria-hidden="true" tabindex="-1"></a>            dest_path <span class="op">=</span> fonts_dir <span class="op">/</span> font_path.name</span>
<span id="cb12-129"><a href="#cb12-129" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb12-130"><a href="#cb12-130" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Copia a fonte</span></span>
<span id="cb12-131"><a href="#cb12-131" aria-hidden="true" tabindex="-1"></a>            shutil.copy2(font_path, dest_path)</span>
<span id="cb12-132"><a href="#cb12-132" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb12-133"><a href="#cb12-133" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Atualiza registro de fontes (opcional)</span></span>
<span id="cb12-134"><a href="#cb12-134" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.update_font_registry(font_path.name)</span>
<span id="cb12-135"><a href="#cb12-135" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb12-136"><a href="#cb12-136" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚úì Fonte instalada: </span><span class="sc">{</span>dest_path<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb12-137"><a href="#cb12-137" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">üîÑ Reinicie seus aplicativos para usar a nova fonte!&quot;</span>)</span>
<span id="cb12-138"><a href="#cb12-138" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb12-139"><a href="#cb12-139" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb12-140"><a href="#cb12-140" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">PermissionError</span>:</span>
<span id="cb12-141"><a href="#cb12-141" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;‚ö†Ô∏è  Permiss√£o negada. Execute como Administrador.&quot;</span>)</span>
<span id="cb12-142"><a href="#cb12-142" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb12-143"><a href="#cb12-143" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb12-144"><a href="#cb12-144" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚úó Erro na instala√ß√£o: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb12-145"><a href="#cb12-145" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb12-146"><a href="#cb12-146" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-147"><a href="#cb12-147" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> update_font_registry(<span class="va">self</span>, font_name):</span>
<span id="cb12-148"><a href="#cb12-148" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Atualiza o registro do Windows para a fonte&quot;&quot;&quot;</span></span>
<span id="cb12-149"><a href="#cb12-149" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb12-150"><a href="#cb12-150" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Comando para atualizar cache de fontes</span></span>
<span id="cb12-151"><a href="#cb12-151" aria-hidden="true" tabindex="-1"></a>            subprocess.run([<span class="st">&#39;powershell&#39;</span>, <span class="st">&#39;-Command&#39;</span>, </span>
<span id="cb12-152"><a href="#cb12-152" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&#39;Start-Process -Verb RunAs -Wait &quot;cmd&quot; -ArgumentList &quot;/c echo y | fontreg&quot;&#39;</span>],</span>
<span id="cb12-153"><a href="#cb12-153" aria-hidden="true" tabindex="-1"></a>                         capture_output<span class="op">=</span><span class="va">True</span>, timeout<span class="op">=</span><span class="dv">30</span>)</span>
<span id="cb12-154"><a href="#cb12-154" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;‚úì Cache de fontes atualizado&quot;</span>)</span>
<span id="cb12-155"><a href="#cb12-155" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span>:</span>
<span id="cb12-156"><a href="#cb12-156" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;‚ö†Ô∏è  Atualiza√ß√£o manual do cache pode ser necess√°ria&quot;</span>)</span>
<span id="cb12-157"><a href="#cb12-157" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-158"><a href="#cb12-158" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_test_file(<span class="va">self</span>, font_path):</span>
<span id="cb12-159"><a href="#cb12-159" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Cria arquivo de teste para verificar a fonte&quot;&quot;&quot;</span></span>
<span id="cb12-160"><a href="#cb12-160" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;üß™ Criando arquivo de teste...&quot;</span>)</span>
<span id="cb12-161"><a href="#cb12-161" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb12-162"><a href="#cb12-162" aria-hidden="true" tabindex="-1"></a>        test_content <span class="op">=</span> <span class="ss">f&quot;&quot;&quot;&lt;!DOCTYPE html&gt;</span></span>
<span id="cb12-163"><a href="#cb12-163" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;html&gt;</span></span>
<span id="cb12-164"><a href="#cb12-164" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;head&gt;</span></span>
<span id="cb12-165"><a href="#cb12-165" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span></span>
<span id="cb12-166"><a href="#cb12-166" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;title&gt;Teste Noto Color Emoji Windows&lt;/title&gt;</span></span>
<span id="cb12-167"><a href="#cb12-167" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;style&gt;</span></span>
<span id="cb12-168"><a href="#cb12-168" aria-hidden="true" tabindex="-1"></a><span class="ss">        @font-face </span><span class="ch">{{</span></span>
<span id="cb12-169"><a href="#cb12-169" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-family: &#39;NotoColorEmojiWindows&#39;;</span></span>
<span id="cb12-170"><a href="#cb12-170" aria-hidden="true" tabindex="-1"></a><span class="ss">            src: url(&#39;</span><span class="sc">{</span>font_path<span class="sc">.</span>name<span class="sc">}</span><span class="ss">&#39;) format(&#39;truetype&#39;);</span></span>
<span id="cb12-171"><a href="#cb12-171" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb12-172"><a href="#cb12-172" aria-hidden="true" tabindex="-1"></a><span class="ss">        body </span><span class="ch">{{</span><span class="ss"> font-family: Arial, sans-serif; margin: 40px; </span><span class="ch">}}</span></span>
<span id="cb12-173"><a href="#cb12-173" aria-hidden="true" tabindex="-1"></a><span class="ss">        .test-area </span><span class="ch">{{</span><span class="ss"> font-family: &#39;NotoColorEmojiWindows&#39;, sans-serif; font-size: 2em; </span><span class="ch">}}</span></span>
<span id="cb12-174"><a href="#cb12-174" aria-hidden="true" tabindex="-1"></a><span class="ss">        .grid </span><span class="ch">{{</span><span class="ss"> display: grid; grid-template-columns: repeat(8, 1fr); gap: 10px; margin: 20px 0; </span><span class="ch">}}</span></span>
<span id="cb12-175"><a href="#cb12-175" aria-hidden="true" tabindex="-1"></a><span class="ss">        .emoji </span><span class="ch">{{</span><span class="ss"> text-align: center; padding: 10px; border: 1px solid #ccc; </span><span class="ch">}}</span></span>
<span id="cb12-176"><a href="#cb12-176" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;/style&gt;</span></span>
<span id="cb12-177"><a href="#cb12-177" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;/head&gt;</span></span>
<span id="cb12-178"><a href="#cb12-178" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;body&gt;</span></span>
<span id="cb12-179"><a href="#cb12-179" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;h1&gt;Teste Noto Color Emoji - Windows 10&lt;/h1&gt;</span></span>
<span id="cb12-180"><a href="#cb12-180" aria-hidden="true" tabindex="-1"></a><span class="ss">    </span></span>
<span id="cb12-181"><a href="#cb12-181" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;div class=&quot;test-area&quot;&gt;</span></span>
<span id="cb12-182"><a href="#cb12-182" aria-hidden="true" tabindex="-1"></a><span class="ss">        &lt;h2&gt;Emojis de teste:&lt;/h2&gt;</span></span>
<span id="cb12-183"><a href="#cb12-183" aria-hidden="true" tabindex="-1"></a><span class="ss">        &lt;div class=&quot;grid&quot;&gt;</span></span>
<span id="cb12-184"><a href="#cb12-184" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;div class=&quot;emoji&quot;&gt;üòÄ&lt;/div&gt;</span></span>
<span id="cb12-185"><a href="#cb12-185" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;div class=&quot;emoji&quot;&gt;‚ù§Ô∏è&lt;/div&gt;</span></span>
<span id="cb12-186"><a href="#cb12-186" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;div class=&quot;emoji&quot;&gt;üéÆ&lt;/div&gt;</span></span>
<span id="cb12-187"><a href="#cb12-187" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;div class=&quot;emoji&quot;&gt;üê±&lt;/div&gt;</span></span>
<span id="cb12-188"><a href="#cb12-188" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;div class=&quot;emoji&quot;&gt;üçï&lt;/div&gt;</span></span>
<span id="cb12-189"><a href="#cb12-189" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;div class=&quot;emoji&quot;&gt;üöÄ&lt;/div&gt;</span></span>
<span id="cb12-190"><a href="#cb12-190" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;div class=&quot;emoji&quot;&gt;‚≠ê&lt;/div&gt;</span></span>
<span id="cb12-191"><a href="#cb12-191" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;div class=&quot;emoji&quot;&gt;üéâ&lt;/div&gt;</span></span>
<span id="cb12-192"><a href="#cb12-192" aria-hidden="true" tabindex="-1"></a><span class="ss">        &lt;/div&gt;</span></span>
<span id="cb12-193"><a href="#cb12-193" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;/div&gt;</span></span>
<span id="cb12-194"><a href="#cb12-194" aria-hidden="true" tabindex="-1"></a><span class="ss">    </span></span>
<span id="cb12-195"><a href="#cb12-195" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;p&gt;Se os emojis aparecerem coloridos, a convers√£o foi bem-sucedida!&lt;/p&gt;</span></span>
<span id="cb12-196"><a href="#cb12-196" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;/body&gt;</span></span>
<span id="cb12-197"><a href="#cb12-197" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;/html&gt;</span></span>
<span id="cb12-198"><a href="#cb12-198" aria-hidden="true" tabindex="-1"></a><span class="ss">&quot;&quot;&quot;</span></span>
<span id="cb12-199"><a href="#cb12-199" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb12-200"><a href="#cb12-200" aria-hidden="true" tabindex="-1"></a>        test_path <span class="op">=</span> <span class="va">self</span>.output_dir <span class="op">/</span> <span class="st">&quot;test_emoji.html&quot;</span></span>
<span id="cb12-201"><a href="#cb12-201" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> <span class="bu">open</span>(test_path, <span class="st">&#39;w&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb12-202"><a href="#cb12-202" aria-hidden="true" tabindex="-1"></a>            f.write(test_content)</span>
<span id="cb12-203"><a href="#cb12-203" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb12-204"><a href="#cb12-204" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;‚úì Arquivo de teste criado: </span><span class="sc">{</span>test_path<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb12-205"><a href="#cb12-205" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> test_path</span>
<span id="cb12-206"><a href="#cb12-206" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-207"><a href="#cb12-207" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> cleanup(<span class="va">self</span>):</span>
<span id="cb12-208"><a href="#cb12-208" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Limpa arquivos tempor√°rios&quot;&quot;&quot;</span></span>
<span id="cb12-209"><a href="#cb12-209" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb12-210"><a href="#cb12-210" aria-hidden="true" tabindex="-1"></a>            shutil.rmtree(<span class="va">self</span>.temp_dir)</span>
<span id="cb12-211"><a href="#cb12-211" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;üßπ Arquivos tempor√°rios removidos&quot;</span>)</span>
<span id="cb12-212"><a href="#cb12-212" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span>:</span>
<span id="cb12-213"><a href="#cb12-213" aria-hidden="true" tabindex="-1"></a>            <span class="cf">pass</span></span>
<span id="cb12-214"><a href="#cb12-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-215"><a href="#cb12-215" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> main():</span>
<span id="cb12-216"><a href="#cb12-216" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Fun√ß√£o principal&quot;&quot;&quot;</span></span>
<span id="cb12-217"><a href="#cb12-217" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;=&quot;</span> <span class="op">*</span> <span class="dv">60</span>)</span>
<span id="cb12-218"><a href="#cb12-218" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;üîÑ CONVERSOR NOTO COLOR EMOJI PARA WINDOWS 10&quot;</span>)</span>
<span id="cb12-219"><a href="#cb12-219" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;=&quot;</span> <span class="op">*</span> <span class="dv">60</span>)</span>
<span id="cb12-220"><a href="#cb12-220" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-221"><a href="#cb12-221" aria-hidden="true" tabindex="-1"></a>    converter <span class="op">=</span> NotoEmojiWindowsConverter()</span>
<span id="cb12-222"><a href="#cb12-222" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-223"><a href="#cb12-223" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb12-224"><a href="#cb12-224" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Download da fonte</span></span>
<span id="cb12-225"><a href="#cb12-225" aria-hidden="true" tabindex="-1"></a>        font_path <span class="op">=</span> converter.download_noto_emoji()</span>
<span id="cb12-226"><a href="#cb12-226" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> font_path:</span>
<span id="cb12-227"><a href="#cb12-227" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb12-228"><a href="#cb12-228" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb12-229"><a href="#cb12-229" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Verifica tabelas</span></span>
<span id="cb12-230"><a href="#cb12-230" aria-hidden="true" tabindex="-1"></a>        color_tables <span class="op">=</span> converter.check_font_tables(font_path)</span>
<span id="cb12-231"><a href="#cb12-231" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb12-232"><a href="#cb12-232" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Convers√µes</span></span>
<span id="cb12-233"><a href="#cb12-233" aria-hidden="true" tabindex="-1"></a>        converted_path <span class="op">=</span> converter.convert_cmap_table(font_path)</span>
<span id="cb12-234"><a href="#cb12-234" aria-hidden="true" tabindex="-1"></a>        optimized_path <span class="op">=</span> converter.optimize_for_windows(converted_path)</span>
<span id="cb12-235"><a href="#cb12-235" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb12-236"><a href="#cb12-236" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Cria teste</span></span>
<span id="cb12-237"><a href="#cb12-237" aria-hidden="true" tabindex="-1"></a>        test_path <span class="op">=</span> converter.create_test_file(optimized_path)</span>
<span id="cb12-238"><a href="#cb12-238" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb12-239"><a href="#cb12-239" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="ch">\n</span><span class="ss">üéØ Convers√£o conclu√≠da!&quot;</span>)</span>
<span id="cb12-240"><a href="#cb12-240" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;üìÅ Pasta de output: </span><span class="sc">{</span>converter<span class="sc">.</span>output_dir<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb12-241"><a href="#cb12-241" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;üîç Arquivo de teste: </span><span class="sc">{</span>test_path<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb12-242"><a href="#cb12-242" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb12-243"><a href="#cb12-243" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Pergunta sobre instala√ß√£o</span></span>
<span id="cb12-244"><a href="#cb12-244" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">üí° Deseja instalar a fonte no Windows? (s/n)&quot;</span>)</span>
<span id="cb12-245"><a href="#cb12-245" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">input</span>().lower() <span class="op">==</span> <span class="st">&#39;s&#39;</span>:</span>
<span id="cb12-246"><a href="#cb12-246" aria-hidden="true" tabindex="-1"></a>            converter.install_font_windows(optimized_path)</span>
<span id="cb12-247"><a href="#cb12-247" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb12-248"><a href="#cb12-248" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">‚úÖ Processo conclu√≠do!&quot;</span>)</span>
<span id="cb12-249"><a href="#cb12-249" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb12-250"><a href="#cb12-250" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb12-251"><a href="#cb12-251" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;‚ùå Erro durante o processo: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb12-252"><a href="#cb12-252" aria-hidden="true" tabindex="-1"></a>    <span class="cf">finally</span>:</span>
<span id="cb12-253"><a href="#cb12-253" aria-hidden="true" tabindex="-1"></a>        converter.cleanup()</span>
<span id="cb12-254"><a href="#cb12-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-255"><a href="#cb12-255" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&quot;__main__&quot;</span>:</span>
<span id="cb12-256"><a href="#cb12-256" aria-hidden="true" tabindex="-1"></a>    main()</span></code></pre></div>
<h2 data-number="1.18" id="arquivo-requirements"><span class="header-section-number">1.18</span> 2. Arquivo Requirements</h2>
<p>Crie <code>requirements.txt</code>:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode txt"><code class="sourceCode default"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>fonttools==4.39.4</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>requests==2.28.2</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>pillow==9.4.0</span></code></pre></div>
<h2 data-number="1.19" id="script-de-instala√ß√£o-de-depend√™ncias"><span class="header-section-number">1.19</span> 3. Script de Instala√ß√£o de
Depend√™ncias</h2>
<div class="sourceCode" id="cb14"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install_deps.py</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> subprocess</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sys</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> install_dependencies():</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Instala depend√™ncias necess√°rias&quot;&quot;&quot;</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    packages <span class="op">=</span> [</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;fonttools&quot;</span>,</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;requests&quot;</span>,</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;pillow&quot;</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;Instalando depend√™ncias...&quot;</span>)</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> package <span class="kw">in</span> packages:</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>            subprocess.check_call([sys.executable, <span class="st">&quot;-m&quot;</span>, <span class="st">&quot;pip&quot;</span>, <span class="st">&quot;install&quot;</span>, package])</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚úì </span><span class="sc">{</span>package<span class="sc">}</span><span class="ss"> instalado&quot;</span>)</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> subprocess.CalledProcessError:</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚úó Falha ao instalar </span><span class="sc">{</span>package<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">‚úÖ Depend√™ncias instaladas!&quot;</span>)</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&quot;__main__&quot;</span>:</span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>    install_dependencies()</span></code></pre></div>
<h2 data-number="1.20" id="como-executar-1"><span class="header-section-number">1.20</span> 4. Como Executar</h2>
<h3 data-number="1.20.1" id="op√ß√£o-1-usando-conda"><span class="header-section-number">1.20.1</span> Op√ß√£o 1: Usando Conda</h3>
<div class="sourceCode" id="cb15"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Criar ambiente</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="ex">conda</span> create <span class="at">-n</span> emoji-converter python=3.9</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="ex">conda</span> activate emoji-converter</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Instalar depend√™ncias</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install fonttools requests pillow</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Executar conversor</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> noto_converter.py</span></code></pre></div>
<h3 data-number="1.20.2" id="op√ß√£o-2-script-autom√°tico"><span class="header-section-number">1.20.2</span> Op√ß√£o 2: Script
Autom√°tico</h3>
<div class="sourceCode" id="cb16"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Execute este comando no PowerShell ou CMD como Administrador</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> install_deps.py <span class="kw">&amp;&amp;</span> <span class="ex">python</span> noto_converter.py</span></code></pre></div>
<h2 data-number="1.21" id="verifica√ß√£o-manual-da-fonte"><span class="header-section-number">1.21</span> 5. Verifica√ß√£o Manual da
Fonte</h2>
<p>Ap√≥s a instala√ß√£o, verifique se a fonte foi instalada
corretamente:</p>
<ol type="1">
<li>Abra <strong>WordPad</strong> ou <strong>Word</strong></li>
<li>Selecione a fonte ‚ÄúNoto Color Emoji Windows‚Äù</li>
<li>Digite alguns emojis: <code>Windows + .</code> (tecla Windows +
ponto)</li>
<li>Verifique se aparecem coloridos</li>
</ol>
<h2 data-number="1.22" id="solu√ß√£o-alternativa-para-problemas-de-cor"><span class="header-section-number">1.22</span> 6. Solu√ß√£o Alternativa para
Problemas de Cor</h2>
<p>Se os emojis ainda n√£o aparecerem coloridos, use este script
adicional:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># color_fix.py</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> shutil</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> install_color_support_script():</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Instala script de suporte a cores&quot;&quot;&quot;</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    script_content <span class="op">=</span> <span class="st">&quot;&quot;&quot;@echo off</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="st">echo Atualizando suporte a emojis coloridos no Windows 10...</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="st">echo.</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="st">echo 1. Certifique-se de que o Windows est√° atualizado</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="st">echo 2. Use aplicativos modernos (Chrome, Edge, Firefox)</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="st">echo 3. Alguns aplicativos antigos podem n√£o suportar emojis coloridos</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="st">echo.</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="st">echo Pressione qualquer tecla para continuar...</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a><span class="st">pause &gt;nul</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;&quot;&quot;</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>    script_path <span class="op">=</span> Path(<span class="st">&quot;emoji_support.bat&quot;</span>)</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> <span class="bu">open</span>(script_path, <span class="st">&#39;w&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>        f.write(script_content)</span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;‚úì Script de suporte criado: </span><span class="sc">{</span>script_path<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&quot;__main__&quot;</span>:</span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>    install_color_support_script()</span></code></pre></div>
<h2 data-number="1.23" id="pontos-importantes-1"><span class="header-section-number">1.23</span> Pontos Importantes:</h2>
<ol type="1">
<li><strong>Execute como Administrador</strong> para instala√ß√£o de
fontes</li>
<li><strong>Reinicie aplicativos</strong> ap√≥s instalar a fonte</li>
<li><strong>Navegadores modernos</strong> mostram melhor emojis
coloridos</li>
<li><strong>Alguns aplicativos</strong> podem n√£o suportar emojis
coloridos de fontes externas</li>
</ol>
<p>Este conversor ajusta especificamente a tabela CMAP e metadados para
melhor compatibilidade com Windows 10!</p>
<hr />
<h3 data-number="1.23.1" id="utilizador-2025-09-22-035717-deepseek-chat"><span class="header-section-number">1.23.1</span> üë§ Utilizador
<em>(2025-09-22 03:57:17)</em> <em>[deepseek-chat]</em></h3>
<p>NotoColorEmoji_Windows_Optimized.ttf cannot install no windows 10</p>
<hr />
<h3 data-number="1.23.2" id="deepseek-2025-09-22-035717-deepseek-chat"><span class="header-section-number">1.23.2</span> ü§ñ DeepSeek <em>(2025-09-22
03:57:17)</em> <em>[deepseek-chat]</em></h3>
<p>O problema √© comum quando a fonte n√£o atende aos requisitos
espec√≠ficos do Windows 10. Vou fornecer solu√ß√µes completas:</p>
<h2 data-number="1.24" id="script-de-corre√ß√£o-para-instala√ß√£o-no-windows-10"><span class="header-section-number">1.24</span> 1. Script de Corre√ß√£o para
Instala√ß√£o no Windows 10</h2>
<div class="sourceCode" id="cb18"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> shutil</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tempfile</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> subprocess</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fontTools.ttLib <span class="im">import</span> TTFont, TTLibError</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> requests</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> WindowsFontFixer:</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.font_path <span class="op">=</span> Path(<span class="st">&quot;NotoColorEmoji_Windows_Optimized.ttf&quot;</span>)</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fixed_dir <span class="op">=</span> Path(<span class="st">&quot;Fixed_Fonts&quot;</span>)</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fixed_dir.mkdir(exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> check_font_problems(<span class="va">self</span>):</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Verifica problemas na fonte&quot;&quot;&quot;</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;üîç Analisando problemas na fonte...&quot;</span>)</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.font_path.exists():</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;‚ùå Arquivo de fonte n√£o encontrado!&quot;</span>)</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>            font <span class="op">=</span> TTFont(<span class="va">self</span>.font_path)</span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>            problems <span class="op">=</span> []</span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Verifica tabelas obrigat√≥rias</span></span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>            required_tables <span class="op">=</span> [<span class="st">&#39;cmap&#39;</span>, <span class="st">&#39;head&#39;</span>, <span class="st">&#39;hhea&#39;</span>, <span class="st">&#39;hmtx&#39;</span>, <span class="st">&#39;maxp&#39;</span>, <span class="st">&#39;name&#39;</span>, <span class="st">&#39;OS/2&#39;</span>, <span class="st">&#39;post&#39;</span>]</span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> table <span class="kw">in</span> required_tables:</span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> table <span class="kw">not</span> <span class="kw">in</span> font:</span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>                    problems.append(<span class="ss">f&quot;Tabela </span><span class="sc">{</span>table<span class="sc">}</span><span class="ss"> ausente&quot;</span>)</span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Verifica vers√£o da fonte</span></span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="st">&#39;head&#39;</span> <span class="kw">in</span> font:</span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a>                head_table <span class="op">=</span> font[<span class="st">&#39;head&#39;</span>]</span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> head_table.magicNumber <span class="op">!=</span> <span class="bn">0x5F0F3CF5</span>:</span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a>                    problems.append(<span class="st">&quot;Magic number inv√°lido&quot;</span>)</span>
<span id="cb18-38"><a href="#cb18-38" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb18-39"><a href="#cb18-39" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Verifica metadados</span></span>
<span id="cb18-40"><a href="#cb18-40" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="st">&#39;name&#39;</span> <span class="kw">in</span> font:</span>
<span id="cb18-41"><a href="#cb18-41" aria-hidden="true" tabindex="-1"></a>                name_table <span class="op">=</span> font[<span class="st">&#39;name&#39;</span>]</span>
<span id="cb18-42"><a href="#cb18-42" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="kw">not</span> <span class="bu">any</span>(rec.nameID <span class="op">==</span> <span class="dv">1</span> <span class="cf">for</span> rec <span class="kw">in</span> name_table.names):  <span class="co"># Font Family</span></span>
<span id="cb18-43"><a href="#cb18-43" aria-hidden="true" tabindex="-1"></a>                    problems.append(<span class="st">&quot;Nome da fam√≠lia ausente&quot;</span>)</span>
<span id="cb18-44"><a href="#cb18-44" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb18-45"><a href="#cb18-45" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> problems:</span>
<span id="cb18-46"><a href="#cb18-46" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;‚ö†Ô∏è  Problemas encontrados:&quot;</span>)</span>
<span id="cb18-47"><a href="#cb18-47" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> problem <span class="kw">in</span> problems:</span>
<span id="cb18-48"><a href="#cb18-48" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="ss">f&quot;   - </span><span class="sc">{</span>problem<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb18-49"><a href="#cb18-49" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb18-50"><a href="#cb18-50" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb18-51"><a href="#cb18-51" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;‚úì Estrutura da fonte parece OK&quot;</span>)</span>
<span id="cb18-52"><a href="#cb18-52" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb18-53"><a href="#cb18-53" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb18-54"><a href="#cb18-54" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> TTLibError <span class="im">as</span> e:</span>
<span id="cb18-55"><a href="#cb18-55" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚ùå Erro ao ler fonte: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb18-56"><a href="#cb18-56" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb18-57"><a href="#cb18-57" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-58"><a href="#cb18-58" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> fix_font_structure(<span class="va">self</span>):</span>
<span id="cb18-59"><a href="#cb18-59" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Corrige a estrutura da fonte para Windows&quot;&quot;&quot;</span></span>
<span id="cb18-60"><a href="#cb18-60" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;üîÑ Corrigindo estrutura da fonte...&quot;</span>)</span>
<span id="cb18-61"><a href="#cb18-61" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb18-62"><a href="#cb18-62" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb18-63"><a href="#cb18-63" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Cria uma c√≥pia limpa</span></span>
<span id="cb18-64"><a href="#cb18-64" aria-hidden="true" tabindex="-1"></a>            fixed_font <span class="op">=</span> TTFont()</span>
<span id="cb18-65"><a href="#cb18-65" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb18-66"><a href="#cb18-66" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Abre fonte original</span></span>
<span id="cb18-67"><a href="#cb18-67" aria-hidden="true" tabindex="-1"></a>            original_font <span class="op">=</span> TTFont(<span class="va">self</span>.font_path)</span>
<span id="cb18-68"><a href="#cb18-68" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb18-69"><a href="#cb18-69" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Copia tabelas essenciais</span></span>
<span id="cb18-70"><a href="#cb18-70" aria-hidden="true" tabindex="-1"></a>            essential_tables <span class="op">=</span> [<span class="st">&#39;cmap&#39;</span>, <span class="st">&#39;head&#39;</span>, <span class="st">&#39;hhea&#39;</span>, <span class="st">&#39;hmtx&#39;</span>, <span class="st">&#39;maxp&#39;</span>, <span class="st">&#39;name&#39;</span>, <span class="st">&#39;OS/2&#39;</span>, <span class="st">&#39;post&#39;</span>, <span class="st">&#39;glyf&#39;</span>, <span class="st">&#39;loca&#39;</span>]</span>
<span id="cb18-71"><a href="#cb18-71" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb18-72"><a href="#cb18-72" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> table <span class="kw">in</span> essential_tables:</span>
<span id="cb18-73"><a href="#cb18-73" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> table <span class="kw">in</span> original_font:</span>
<span id="cb18-74"><a href="#cb18-74" aria-hidden="true" tabindex="-1"></a>                    fixed_font[table] <span class="op">=</span> original_font[table]</span>
<span id="cb18-75"><a href="#cb18-75" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb18-76"><a href="#cb18-76" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Adiciona tabelas de cores se existirem</span></span>
<span id="cb18-77"><a href="#cb18-77" aria-hidden="true" tabindex="-1"></a>            color_tables <span class="op">=</span> [<span class="st">&#39;COLR&#39;</span>, <span class="st">&#39;CPAL&#39;</span>, <span class="st">&#39;SVG &#39;</span>]</span>
<span id="cb18-78"><a href="#cb18-78" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> table <span class="kw">in</span> color_tables:</span>
<span id="cb18-79"><a href="#cb18-79" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> table <span class="kw">in</span> original_font:</span>
<span id="cb18-80"><a href="#cb18-80" aria-hidden="true" tabindex="-1"></a>                    fixed_font[table] <span class="op">=</span> original_font[table]</span>
<span id="cb18-81"><a href="#cb18-81" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb18-82"><a href="#cb18-82" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Corrige metadados</span></span>
<span id="cb18-83"><a href="#cb18-83" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.fix_font_metadata(fixed_font)</span>
<span id="cb18-84"><a href="#cb18-84" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb18-85"><a href="#cb18-85" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Salva fonte corrigida</span></span>
<span id="cb18-86"><a href="#cb18-86" aria-hidden="true" tabindex="-1"></a>            fixed_path <span class="op">=</span> <span class="va">self</span>.fixed_dir <span class="op">/</span> <span class="st">&quot;NotoColorEmoji_Windows_Fixed.ttf&quot;</span></span>
<span id="cb18-87"><a href="#cb18-87" aria-hidden="true" tabindex="-1"></a>            fixed_font.save(fixed_path)</span>
<span id="cb18-88"><a href="#cb18-88" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb18-89"><a href="#cb18-89" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚úì Fonte corrigida: </span><span class="sc">{</span>fixed_path<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb18-90"><a href="#cb18-90" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> fixed_path</span>
<span id="cb18-91"><a href="#cb18-91" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb18-92"><a href="#cb18-92" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb18-93"><a href="#cb18-93" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚ùå Erro na corre√ß√£o: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb18-94"><a href="#cb18-94" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb18-95"><a href="#cb18-95" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-96"><a href="#cb18-96" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> fix_font_metadata(<span class="va">self</span>, font):</span>
<span id="cb18-97"><a href="#cb18-97" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Corrige metadados da fonte&quot;&quot;&quot;</span></span>
<span id="cb18-98"><a href="#cb18-98" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">&#39;name&#39;</span> <span class="kw">not</span> <span class="kw">in</span> font:</span>
<span id="cb18-99"><a href="#cb18-99" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb18-100"><a href="#cb18-100" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb18-101"><a href="#cb18-101" aria-hidden="true" tabindex="-1"></a>        name_table <span class="op">=</span> font[<span class="st">&#39;name&#39;</span>]</span>
<span id="cb18-102"><a href="#cb18-102" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb18-103"><a href="#cb18-103" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Nomes obrigat√≥rios para Windows</span></span>
<span id="cb18-104"><a href="#cb18-104" aria-hidden="true" tabindex="-1"></a>        names_to_add <span class="op">=</span> [</span>
<span id="cb18-105"><a href="#cb18-105" aria-hidden="true" tabindex="-1"></a>            (<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="st">&quot;Noto Color Emoji&quot;</span>),  <span class="co"># Family Name</span></span>
<span id="cb18-106"><a href="#cb18-106" aria-hidden="true" tabindex="-1"></a>            (<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="st">&quot;Regular&quot;</span>),           <span class="co"># Subfamily</span></span>
<span id="cb18-107"><a href="#cb18-107" aria-hidden="true" tabindex="-1"></a>            (<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="st">&quot;Noto Color Emoji:Version 2.038&quot;</span>),  <span class="co"># Unique ID</span></span>
<span id="cb18-108"><a href="#cb18-108" aria-hidden="true" tabindex="-1"></a>            (<span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="st">&quot;Noto Color Emoji&quot;</span>),  <span class="co"># Full Name</span></span>
<span id="cb18-109"><a href="#cb18-109" aria-hidden="true" tabindex="-1"></a>            (<span class="dv">6</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="st">&quot;NotoColorEmoji&quot;</span>)     <span class="co"># PostScript Name</span></span>
<span id="cb18-110"><a href="#cb18-110" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb18-111"><a href="#cb18-111" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb18-112"><a href="#cb18-112" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> nameID, platformID, platEncID, nameString <span class="kw">in</span> names_to_add:</span>
<span id="cb18-113"><a href="#cb18-113" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Verifica se j√° existe</span></span>
<span id="cb18-114"><a href="#cb18-114" aria-hidden="true" tabindex="-1"></a>            exists <span class="op">=</span> <span class="bu">any</span>(rec.nameID <span class="op">==</span> nameID <span class="kw">and</span> rec.platformID <span class="op">==</span> platformID </span>
<span id="cb18-115"><a href="#cb18-115" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">for</span> rec <span class="kw">in</span> name_table.names)</span>
<span id="cb18-116"><a href="#cb18-116" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb18-117"><a href="#cb18-117" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> exists:</span>
<span id="cb18-118"><a href="#cb18-118" aria-hidden="true" tabindex="-1"></a>                name_table.setName(nameString, nameID, platformID, platEncID)</span>
<span id="cb18-119"><a href="#cb18-119" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-120"><a href="#cb18-120" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> convert_to_otf(<span class="va">self</span>, ttf_path):</span>
<span id="cb18-121"><a href="#cb18-121" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Tenta converter TTF para OTF (√†s vezes funciona melhor)&quot;&quot;&quot;</span></span>
<span id="cb18-122"><a href="#cb18-122" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;üîÑ Tentando convers√£o para OTF...&quot;</span>)</span>
<span id="cb18-123"><a href="#cb18-123" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb18-124"><a href="#cb18-124" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb18-125"><a href="#cb18-125" aria-hidden="true" tabindex="-1"></a>            font <span class="op">=</span> TTFont(ttf_path)</span>
<span id="cb18-126"><a href="#cb18-126" aria-hidden="true" tabindex="-1"></a>            otf_path <span class="op">=</span> <span class="va">self</span>.fixed_dir <span class="op">/</span> <span class="st">&quot;NotoColorEmoji_Windows.otf&quot;</span></span>
<span id="cb18-127"><a href="#cb18-127" aria-hidden="true" tabindex="-1"></a>            font.save(otf_path)</span>
<span id="cb18-128"><a href="#cb18-128" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb18-129"><a href="#cb18-129" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚úì Convers√£o OTF: </span><span class="sc">{</span>otf_path<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb18-130"><a href="#cb18-130" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> otf_path</span>
<span id="cb18-131"><a href="#cb18-131" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb18-132"><a href="#cb18-132" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb18-133"><a href="#cb18-133" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚ùå Erro na convers√£o OTF: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb18-134"><a href="#cb18-134" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb18-135"><a href="#cb18-135" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-136"><a href="#cb18-136" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> install_with_powershell(<span class="va">self</span>, font_path):</span>
<span id="cb18-137"><a href="#cb18-137" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Instala usando PowerShell com privil√©gios elevados&quot;&quot;&quot;</span></span>
<span id="cb18-138"><a href="#cb18-138" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;üîß Tentando instala√ß√£o via PowerShell...&quot;</span>)</span>
<span id="cb18-139"><a href="#cb18-139" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb18-140"><a href="#cb18-140" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb18-141"><a href="#cb18-141" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Copia para diret√≥rio tempor√°rio</span></span>
<span id="cb18-142"><a href="#cb18-142" aria-hidden="true" tabindex="-1"></a>            temp_font <span class="op">=</span> Path(os.environ[<span class="st">&#39;TEMP&#39;</span>]) <span class="op">/</span> font_path.name</span>
<span id="cb18-143"><a href="#cb18-143" aria-hidden="true" tabindex="-1"></a>            shutil.copy2(font_path, temp_font)</span>
<span id="cb18-144"><a href="#cb18-144" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb18-145"><a href="#cb18-145" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Script PowerShell para instala√ß√£o</span></span>
<span id="cb18-146"><a href="#cb18-146" aria-hidden="true" tabindex="-1"></a>            ps_script <span class="op">=</span> <span class="ss">f&quot;&quot;&quot;</span></span>
<span id="cb18-147"><a href="#cb18-147" aria-hidden="true" tabindex="-1"></a><span class="ss">            $fontPath = &quot;</span><span class="sc">{</span>temp_font<span class="sc">}</span><span class="ss">&quot;</span></span>
<span id="cb18-148"><a href="#cb18-148" aria-hidden="true" tabindex="-1"></a><span class="ss">            $fontsDir = [System.Environment]::GetFolderPath([System.Environment+SpecialFolder]::Fonts)</span></span>
<span id="cb18-149"><a href="#cb18-149" aria-hidden="true" tabindex="-1"></a><span class="ss">            $destPath = Join-Path $fontsDir (Split-Path $fontPath -Leaf)</span></span>
<span id="cb18-150"><a href="#cb18-150" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span></span>
<span id="cb18-151"><a href="#cb18-151" aria-hidden="true" tabindex="-1"></a><span class="ss">            try </span><span class="ch">{{</span></span>
<span id="cb18-152"><a href="#cb18-152" aria-hidden="true" tabindex="-1"></a><span class="ss">                Copy-Item $fontPath $destPath -Force</span></span>
<span id="cb18-153"><a href="#cb18-153" aria-hidden="true" tabindex="-1"></a><span class="ss">                Write-Host &quot;Fonte instalada: $destPath&quot;</span></span>
<span id="cb18-154"><a href="#cb18-154" aria-hidden="true" tabindex="-1"></a><span class="ss">                return $true</span></span>
<span id="cb18-155"><a href="#cb18-155" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span><span class="ch">}}</span><span class="ss"> catch </span><span class="ch">{{</span></span>
<span id="cb18-156"><a href="#cb18-156" aria-hidden="true" tabindex="-1"></a><span class="ss">                Write-Host &quot;Erro: $($_.Exception.Message)&quot;</span></span>
<span id="cb18-157"><a href="#cb18-157" aria-hidden="true" tabindex="-1"></a><span class="ss">                return $false</span></span>
<span id="cb18-158"><a href="#cb18-158" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span><span class="ch">}}</span></span>
<span id="cb18-159"><a href="#cb18-159" aria-hidden="true" tabindex="-1"></a><span class="ss">            &quot;&quot;&quot;</span></span>
<span id="cb18-160"><a href="#cb18-160" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb18-161"><a href="#cb18-161" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Executa PowerShell como admin</span></span>
<span id="cb18-162"><a href="#cb18-162" aria-hidden="true" tabindex="-1"></a>            result <span class="op">=</span> subprocess.run([</span>
<span id="cb18-163"><a href="#cb18-163" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;powershell&#39;</span>, <span class="st">&#39;-Command&#39;</span>, </span>
<span id="cb18-164"><a href="#cb18-164" aria-hidden="true" tabindex="-1"></a>                <span class="ss">f&#39;Start-Process powershell -ArgumentList &quot;-Command </span><span class="sc">{</span>ps_script<span class="sc">}</span><span class="ss">&quot; -Verb RunAs -Wait&#39;</span></span>
<span id="cb18-165"><a href="#cb18-165" aria-hidden="true" tabindex="-1"></a>            ], capture_output<span class="op">=</span><span class="va">True</span>, text<span class="op">=</span><span class="va">True</span>, timeout<span class="op">=</span><span class="dv">60</span>)</span>
<span id="cb18-166"><a href="#cb18-166" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb18-167"><a href="#cb18-167" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> result.returncode <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb18-168"><a href="#cb18-168" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;‚úì Instala√ß√£o via PowerShell bem-sucedida!&quot;</span>)</span>
<span id="cb18-169"><a href="#cb18-169" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb18-170"><a href="#cb18-170" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb18-171"><a href="#cb18-171" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;‚ùå Falha na instala√ß√£o PowerShell&quot;</span>)</span>
<span id="cb18-172"><a href="#cb18-172" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb18-173"><a href="#cb18-173" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb18-174"><a href="#cb18-174" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb18-175"><a href="#cb18-175" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚ùå Erro PowerShell: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb18-176"><a href="#cb18-176" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb18-177"><a href="#cb18-177" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-178"><a href="#cb18-178" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> manual_install_guide(<span class="va">self</span>, font_path):</span>
<span id="cb18-179"><a href="#cb18-179" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Guia para instala√ß√£o manual&quot;&quot;&quot;</span></span>
<span id="cb18-180"><a href="#cb18-180" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">üìã GUIA DE INSTALA√á√ÉO MANUAL:&quot;</span>)</span>
<span id="cb18-181"><a href="#cb18-181" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;=&quot;</span> <span class="op">*</span> <span class="dv">50</span>)</span>
<span id="cb18-182"><a href="#cb18-182" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;1. Pressione Windows + R&quot;</span>)</span>
<span id="cb18-183"><a href="#cb18-183" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;2. Digite: shell:fonts&quot;</span>)</span>
<span id="cb18-184"><a href="#cb18-184" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;3. Pressione Enter&quot;</span>)</span>
<span id="cb18-185"><a href="#cb18-185" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;4. Arraste o arquivo para a janela que abrir:&quot;</span>)</span>
<span id="cb18-186"><a href="#cb18-186" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;   </span><span class="sc">{</span>font_path<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb18-187"><a href="#cb18-187" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;5. O Windows instalar√° automaticamente&quot;</span>)</span>
<span id="cb18-188"><a href="#cb18-188" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;6. Reinicie seus aplicativos&quot;</span>)</span>
<span id="cb18-189"><a href="#cb18-189" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;=&quot;</span> <span class="op">*</span> <span class="dv">50</span>)</span>
<span id="cb18-190"><a href="#cb18-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-191"><a href="#cb18-191" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> main():</span>
<span id="cb18-192"><a href="#cb18-192" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;üõ†Ô∏è  CORRETOR DE INSTALA√á√ÉO NOTO COLOR EMOJI WINDOWS 10&quot;</span>)</span>
<span id="cb18-193"><a href="#cb18-193" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;=&quot;</span> <span class="op">*</span> <span class="dv">60</span>)</span>
<span id="cb18-194"><a href="#cb18-194" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-195"><a href="#cb18-195" aria-hidden="true" tabindex="-1"></a>    fixer <span class="op">=</span> WindowsFontFixer()</span>
<span id="cb18-196"><a href="#cb18-196" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-197"><a href="#cb18-197" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Verifica problemas</span></span>
<span id="cb18-198"><a href="#cb18-198" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> fixer.check_font_problems():</span>
<span id="cb18-199"><a href="#cb18-199" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">üîÑ Tentando corrigir automaticamente...&quot;</span>)</span>
<span id="cb18-200"><a href="#cb18-200" aria-hidden="true" tabindex="-1"></a>        fixed_font <span class="op">=</span> fixer.fix_font_structure()</span>
<span id="cb18-201"><a href="#cb18-201" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb18-202"><a href="#cb18-202" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> fixed_font:</span>
<span id="cb18-203"><a href="#cb18-203" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="ch">\n</span><span class="ss">‚úÖ Fonte corrigida dispon√≠vel em: </span><span class="sc">{</span>fixed_font<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb18-204"><a href="#cb18-204" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb18-205"><a href="#cb18-205" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Tenta instala√ß√£o autom√°tica</span></span>
<span id="cb18-206"><a href="#cb18-206" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">üí° Tentando instala√ß√£o autom√°tica...&quot;</span>)</span>
<span id="cb18-207"><a href="#cb18-207" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> fixer.install_with_powershell(fixed_font):</span>
<span id="cb18-208"><a href="#cb18-208" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Mostra guia manual</span></span>
<span id="cb18-209"><a href="#cb18-209" aria-hidden="true" tabindex="-1"></a>                fixer.manual_install_guide(fixed_font)</span>
<span id="cb18-210"><a href="#cb18-210" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb18-211"><a href="#cb18-211" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Tenta convers√£o para OTF tamb√©m</span></span>
<span id="cb18-212"><a href="#cb18-212" aria-hidden="true" tabindex="-1"></a>        otf_font <span class="op">=</span> fixer.convert_to_otf(fixed_font)</span>
<span id="cb18-213"><a href="#cb18-213" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> otf_font:</span>
<span id="cb18-214"><a href="#cb18-214" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="ch">\n</span><span class="ss">üîÑ Vers√£o OTF tamb√©m dispon√≠vel: </span><span class="sc">{</span>otf_font<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb18-215"><a href="#cb18-215" aria-hidden="true" tabindex="-1"></a>            fixer.manual_install_guide(otf_font)</span>
<span id="cb18-216"><a href="#cb18-216" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-217"><a href="#cb18-217" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb18-218"><a href="#cb18-218" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Se a fonte parece OK, tenta instalar</span></span>
<span id="cb18-219"><a href="#cb18-219" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">üí° Fonte parece OK, tentando instala√ß√£o...&quot;</span>)</span>
<span id="cb18-220"><a href="#cb18-220" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> fixer.install_with_powershell(fixer.font_path):</span>
<span id="cb18-221"><a href="#cb18-221" aria-hidden="true" tabindex="-1"></a>            fixer.manual_install_guide(fixer.font_path)</span>
<span id="cb18-222"><a href="#cb18-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-223"><a href="#cb18-223" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&quot;__main__&quot;</span>:</span>
<span id="cb18-224"><a href="#cb18-224" aria-hidden="true" tabindex="-1"></a>    main()</span></code></pre></div>
<h2 data-number="1.25" id="script-alternativo---download-de-vers√£o-pr√©-compat√≠vel"><span class="header-section-number">1.25</span> 2. Script Alternativo -
Download de Vers√£o Pr√©-Compat√≠vel</h2>
<div class="sourceCode" id="cb19"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> requests</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> zipfile</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> download_windows_compatible_version():</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Baixa vers√£o j√° compat√≠vel com Windows&quot;&quot;&quot;</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;üì• Baixando vers√£o compat√≠vel com Windows...&quot;</span>)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># URLs de fontes conhecidamente compat√≠veis</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>    sources <span class="op">=</span> [</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;https://github.com/googlefonts/noto-emoji/raw/main/fonts/NotoColorEmoji_WindowsCompatible.ttf&quot;</span>,</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;https://github.com/MicrosoftDocs/noto-emoji/raw/main/fonts/NotoColorEmoji.ttf&quot;</span>,</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;https://cdn.jsdelivr.net/gh/googlefonts/noto-emoji@main/fonts/NotoColorEmoji.ttf&quot;</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>    output_dir <span class="op">=</span> Path(<span class="st">&quot;Windows_Compatible_Fonts&quot;</span>)</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>    output_dir.mkdir(exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, url <span class="kw">in</span> <span class="bu">enumerate</span>(sources):</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;Tentando fonte </span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">...&quot;</span>)</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>            response <span class="op">=</span> requests.get(url, timeout<span class="op">=</span><span class="dv">30</span>)</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>            response.raise_for_status()</span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>            filename <span class="op">=</span> <span class="ss">f&quot;NotoColorEmoji_Windows_Ready_</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">.ttf&quot;</span></span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>            font_path <span class="op">=</span> output_dir <span class="op">/</span> filename</span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(font_path, <span class="st">&#39;wb&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>                f.write(response.content)</span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ Download bem-sucedido: </span><span class="sc">{</span>font_path<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> font_path</span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚ùå Falha: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> install_font_simple(font_path):</span>
<span id="cb19-40"><a href="#cb19-40" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Instala√ß√£o simples arrastando para Fonts&quot;&quot;&quot;</span></span>
<span id="cb19-41"><a href="#cb19-41" aria-hidden="true" tabindex="-1"></a>    <span class="im">import</span> os</span>
<span id="cb19-42"><a href="#cb19-42" aria-hidden="true" tabindex="-1"></a>    <span class="im">import</span> shutil</span>
<span id="cb19-43"><a href="#cb19-43" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-44"><a href="#cb19-44" aria-hidden="true" tabindex="-1"></a>    fonts_dir <span class="op">=</span> Path(os.environ[<span class="st">&#39;WINDIR&#39;</span>]) <span class="op">/</span> <span class="st">&#39;Fonts&#39;</span></span>
<span id="cb19-45"><a href="#cb19-45" aria-hidden="true" tabindex="-1"></a>    dest_path <span class="op">=</span> fonts_dir <span class="op">/</span> font_path.name</span>
<span id="cb19-46"><a href="#cb19-46" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-47"><a href="#cb19-47" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb19-48"><a href="#cb19-48" aria-hidden="true" tabindex="-1"></a>        shutil.copy2(font_path, dest_path)</span>
<span id="cb19-49"><a href="#cb19-49" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ Fonte instalada: </span><span class="sc">{</span>dest_path<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb19-50"><a href="#cb19-50" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb19-51"><a href="#cb19-51" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">PermissionError</span>:</span>
<span id="cb19-52"><a href="#cb19-52" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;‚ùå Permiss√£o negada. Execute como Administrador.&quot;</span>)</span>
<span id="cb19-53"><a href="#cb19-53" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb19-54"><a href="#cb19-54" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb19-55"><a href="#cb19-55" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;‚ùå Erro na instala√ß√£o: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb19-56"><a href="#cb19-56" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb19-57"><a href="#cb19-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-58"><a href="#cb19-58" aria-hidden="true" tabindex="-1"></a><span class="co"># Execu√ß√£o principal alternativa</span></span>
<span id="cb19-59"><a href="#cb19-59" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> alternative_solution():</span>
<span id="cb19-60"><a href="#cb19-60" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;üîÑ Tentando solu√ß√£o alternativa...&quot;</span>)</span>
<span id="cb19-61"><a href="#cb19-61" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-62"><a href="#cb19-62" aria-hidden="true" tabindex="-1"></a>    font_path <span class="op">=</span> download_windows_compatible_version()</span>
<span id="cb19-63"><a href="#cb19-63" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> font_path:</span>
<span id="cb19-64"><a href="#cb19-64" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="ch">\n</span><span class="ss">üí° Fonte baixada: </span><span class="sc">{</span>font_path<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb19-65"><a href="#cb19-65" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;Tentando instalar...&quot;</span>)</span>
<span id="cb19-66"><a href="#cb19-66" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-67"><a href="#cb19-67" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> install_font_simple(font_path):</span>
<span id="cb19-68"><a href="#cb19-68" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;üéâ Instala√ß√£o bem-sucedida!&quot;</span>)</span>
<span id="cb19-69"><a href="#cb19-69" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb19-70"><a href="#cb19-70" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">üìã Instale manualmente:&quot;</span>)</span>
<span id="cb19-71"><a href="#cb19-71" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;1. V√° para: C:</span><span class="ch">\\</span><span class="ss">Windows</span><span class="ch">\\</span><span class="ss">Fonts&quot;</span>)</span>
<span id="cb19-72"><a href="#cb19-72" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;2. Arraste: </span><span class="sc">{</span>font_path<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb19-73"><a href="#cb19-73" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;3. O Windows instalar√° automaticamente&quot;</span>)</span>
<span id="cb19-74"><a href="#cb19-74" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb19-75"><a href="#cb19-75" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;‚ùå N√£o foi poss√≠vel baixar fonte compat√≠vel&quot;</span>)</span>
<span id="cb19-76"><a href="#cb19-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-77"><a href="#cb19-77" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&quot;__main__&quot;</span>:</span>
<span id="cb19-78"><a href="#cb19-78" aria-hidden="true" tabindex="-1"></a>    alternative_solution()</span></code></pre></div>
<h2 data-number="1.26" id="solu√ß√£o-de-emerg√™ncia---usando-fontes-do-sistema"><span class="header-section-number">1.26</span> 3. Solu√ß√£o de Emerg√™ncia -
Usando Fontes do Sistema</h2>
<div class="sourceCode" id="cb20"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> use_system_emoji_font():</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Configura para usar fontes de emoji do sistema&quot;&quot;&quot;</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;üéØ Usando fontes de emoji do sistema Windows...&quot;</span>)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Fontes de emoji nativas do Windows 10/11</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    system_emoji_fonts <span class="op">=</span> [</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;Segoe UI Emoji&quot;</span>,</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;Segoe UI Symbol&quot;</span>,</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;Microsoft Yahei UI&quot;</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;üí° Fontes de emoji dispon√≠veis no seu sistema:&quot;</span>)</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> font <span class="kw">in</span> system_emoji_fonts:</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;   - </span><span class="sc">{</span>font<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">üìã Para usar em programas:&quot;</span>)</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;1. Use aplicativos modernos (Edge, Chrome, Firefox)&quot;</span>)</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;2. Pressione Windows + . para abrir o seletor de emojis&quot;</span>)</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;3. Os emojis do sistema j√° s√£o coloridos por padr√£o&quot;</span>)</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Execute esta fun√ß√£o se nada mais funcionar</span></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>use_system_emoji_font()</span></code></pre></div>
<h2 data-number="1.27" id="como-executar-2"><span class="header-section-number">1.27</span> 4. Como Executar</h2>
<h3 data-number="1.27.1" id="m√©todo-1---corre√ß√£o-da-fonte-existente"><span class="header-section-number">1.27.1</span> M√©todo 1 - Corre√ß√£o da Fonte
Existente:</h3>
<div class="sourceCode" id="cb21"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> font_fixer.py</span></code></pre></div>
<h3 data-number="1.27.2" id="m√©todo-2---download-de-vers√£o-compat√≠vel"><span class="header-section-number">1.27.2</span> M√©todo 2 - Download de
Vers√£o Compat√≠vel:</h3>
<div class="sourceCode" id="cb22"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> download_compatible.py</span></code></pre></div>
<h3 data-number="1.27.3" id="m√©todo-3---execu√ß√£o-completa"><span class="header-section-number">1.27.3</span> M√©todo 3 - Execu√ß√£o
Completa:</h3>
<div class="sourceCode" id="cb23"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tenta corrigir, depois baixa alternativa se necess√°rio</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> <span class="at">-c</span> <span class="st">&quot;</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="st">import font_fixer, download_compatible</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="st">font_fixer.main()</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="st">download_compatible.alternative_solution()</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span></span></code></pre></div>
<h2 data-number="1.28" id="solu√ß√£o-manual-r√°pida"><span class="header-section-number">1.28</span> 5. Solu√ß√£o Manual R√°pida</h2>
<p>Se os scripts n√£o funcionarem, fa√ßa manualmente:</p>
<ol type="1">
<li><strong>Pressione <code>Windows + R</code></strong></li>
<li><strong>Digite: <code>shell:fonts</code></strong></li>
<li><strong>Pressione Enter</strong></li>
<li><strong>Arraste o arquivo
<code>NotoColorEmoji_Windows_Optimized.ttf</code> para a
janela</strong></li>
<li><strong>Se n√£o funcionar, tente renomear para um nome mais simples
como <code>NotoEmoji.ttf</code></strong></li>
</ol>
<h2 data-number="1.29" id="pontos-cr√≠ticos"><span class="header-section-number">1.29</span> Pontos Cr√≠ticos:</h2>
<ol type="1">
<li><strong>Execute como Administrador</strong></li>
<li><strong>Nomes de arquivo muito longos</strong> podem causar
problemas</li>
<li><strong>Fontes corrompidas</strong> n√£o instalam - baixe novamente
se necess√°rio</li>
<li><strong>Windows Defender</strong> pode bloquear fontes de fontes
desconhecidas</li>
</ol>
<p>A segunda solu√ß√£o (download de vers√£o compat√≠vel) geralmente √© a mais
eficaz!</p>
<hr />
<h3 data-number="1.29.1" id="utilizador-2025-09-22-205555-deepseek-chat"><span class="header-section-number">1.29.1</span> üë§ Utilizador
<em>(2025-09-22 20:55:55)</em> <em>[deepseek-chat]</em></h3>
<p>usando a Op√ß√£o 1: Usando Conda python noto_converter.py a convers√£o √©
bem sucedida, mas NotoColorEmoji_Windows_Optimized.ttf cannot
install</p>
<hr />
<h3 data-number="1.29.2" id="deepseek-2025-09-22-205555-deepseek-chat"><span class="header-section-number">1.29.2</span> ü§ñ DeepSeek <em>(2025-09-22
20:55:55)</em> <em>[deepseek-chat]</em></h3>
<p>Vamos resolver esse problema espec√≠fico. O erro geralmente est√° nos
metadados ou estrutura da fonte. Aqui est√° a solu√ß√£o completa:</p>
<h2 data-number="1.30" id="script-de-corre√ß√£o-espec√≠fico-para-o-problema"><span class="header-section-number">1.30</span> 1. Script de Corre√ß√£o
Espec√≠fico para o Problema</h2>
<div class="sourceCode" id="cb24"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> shutil</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fontTools.ttLib <span class="im">import</span> TTFont</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fontTools.ttLib.tables._n_a_m_e <span class="im">import</span> table__n_a_m_e</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tempfile</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> NotoFontWindowsInstaller:</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.original_font <span class="op">=</span> Path(<span class="st">&quot;NotoColorEmoji_Windows_Optimized.ttf&quot;</span>)</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fixed_dir <span class="op">=</span> Path(<span class="st">&quot;Fixed_Install_Fonts&quot;</span>)</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fixed_dir.mkdir(exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> fix_common_installation_issues(<span class="va">self</span>):</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Corrige os problemas mais comuns de instala√ß√£o no Windows&quot;&quot;&quot;</span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;üîß Corrigindo problemas de instala√ß√£o...&quot;</span>)</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.original_font.exists():</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;‚ùå Arquivo de fonte n√£o encontrado!&quot;</span>)</span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Abre a fonte original</span></span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>            font <span class="op">=</span> TTFont(<span class="va">self</span>.original_font)</span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>            <span class="co"># 1. CORRIGE METADADOS OBRIGAT√ìRIOS</span></span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.fix_font_metadata(font)</span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a>            <span class="co"># 2. CORRIGE A TABELA NAME (CR√çTICO PARA WINDOWS)</span></span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.fix_name_table(font)</span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a>            <span class="co"># 3. CORRIGE A TABELA OS/2</span></span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.fix_os2_table(font)</span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a>            <span class="co"># 4. GARANTE FLAGS CORRETAS</span></span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.fix_font_flags(font)</span>
<span id="cb24-37"><a href="#cb24-37" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-38"><a href="#cb24-38" aria-hidden="true" tabindex="-1"></a>            <span class="co"># 5. SALVA COM CONFIGURA√á√ïES OTIMIZADAS</span></span>
<span id="cb24-39"><a href="#cb24-39" aria-hidden="true" tabindex="-1"></a>            fixed_path <span class="op">=</span> <span class="va">self</span>.fixed_dir <span class="op">/</span> <span class="st">&quot;NotoColorEmoji_Windows_Final.ttf&quot;</span></span>
<span id="cb24-40"><a href="#cb24-40" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-41"><a href="#cb24-41" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Configura√ß√µes espec√≠ficas para Windows</span></span>
<span id="cb24-42"><a href="#cb24-42" aria-hidden="true" tabindex="-1"></a>            font.save(fixed_path, reorderTables<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb24-43"><a href="#cb24-43" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-44"><a href="#cb24-44" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ Fonte corrigida: </span><span class="sc">{</span>fixed_path<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb24-45"><a href="#cb24-45" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> fixed_path</span>
<span id="cb24-46"><a href="#cb24-46" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-47"><a href="#cb24-47" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb24-48"><a href="#cb24-48" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚ùå Erro na corre√ß√£o: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb24-49"><a href="#cb24-49" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb24-50"><a href="#cb24-50" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-51"><a href="#cb24-51" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> fix_font_metadata(<span class="va">self</span>, font):</span>
<span id="cb24-52"><a href="#cb24-52" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Corrige metadados essenciais&quot;&quot;&quot;</span></span>
<span id="cb24-53"><a href="#cb24-53" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;üìù Corrigindo metadados...&quot;</span>)</span>
<span id="cb24-54"><a href="#cb24-54" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-55"><a href="#cb24-55" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Garante que a tabela name existe</span></span>
<span id="cb24-56"><a href="#cb24-56" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">&#39;name&#39;</span> <span class="kw">not</span> <span class="kw">in</span> font:</span>
<span id="cb24-57"><a href="#cb24-57" aria-hidden="true" tabindex="-1"></a>            <span class="im">from</span> fontTools.ttLib <span class="im">import</span> newTable</span>
<span id="cb24-58"><a href="#cb24-58" aria-hidden="true" tabindex="-1"></a>            font[<span class="st">&#39;name&#39;</span>] <span class="op">=</span> newTable(<span class="st">&#39;name&#39;</span>)</span>
<span id="cb24-59"><a href="#cb24-59" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-60"><a href="#cb24-60" aria-hidden="true" tabindex="-1"></a>        name_table <span class="op">=</span> font[<span class="st">&#39;name&#39;</span>]</span>
<span id="cb24-61"><a href="#cb24-61" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-62"><a href="#cb24-62" aria-hidden="true" tabindex="-1"></a>        <span class="co"># NOMES OBRIGAT√ìRIOS PARA WINDOWS (PlatformID = 3, EncodingID = 1)</span></span>
<span id="cb24-63"><a href="#cb24-63" aria-hidden="true" tabindex="-1"></a>        names <span class="op">=</span> [</span>
<span id="cb24-64"><a href="#cb24-64" aria-hidden="true" tabindex="-1"></a>            (<span class="dv">1</span>, <span class="st">&quot;Noto Color Emoji&quot;</span>),      <span class="co"># Font Family</span></span>
<span id="cb24-65"><a href="#cb24-65" aria-hidden="true" tabindex="-1"></a>            (<span class="dv">2</span>, <span class="st">&quot;Regular&quot;</span>),               <span class="co"># Font Subfamily</span></span>
<span id="cb24-66"><a href="#cb24-66" aria-hidden="true" tabindex="-1"></a>            (<span class="dv">3</span>, <span class="st">&quot;Noto Color Emoji:2.038&quot;</span>), <span class="co"># Unique ID</span></span>
<span id="cb24-67"><a href="#cb24-67" aria-hidden="true" tabindex="-1"></a>            (<span class="dv">4</span>, <span class="st">&quot;Noto Color Emoji&quot;</span>),      <span class="co"># Full Name</span></span>
<span id="cb24-68"><a href="#cb24-68" aria-hidden="true" tabindex="-1"></a>            (<span class="dv">6</span>, <span class="st">&quot;NotoColorEmoji&quot;</span>),        <span class="co"># PostScript Name</span></span>
<span id="cb24-69"><a href="#cb24-69" aria-hidden="true" tabindex="-1"></a>            (<span class="dv">16</span>, <span class="st">&quot;Noto Color Emoji&quot;</span>)      <span class="co"># Preferred Family</span></span>
<span id="cb24-70"><a href="#cb24-70" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb24-71"><a href="#cb24-71" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-72"><a href="#cb24-72" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> nameID, nameString <span class="kw">in</span> names:</span>
<span id="cb24-73"><a href="#cb24-73" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Remove entradas existentes problem√°ticas</span></span>
<span id="cb24-74"><a href="#cb24-74" aria-hidden="true" tabindex="-1"></a>            name_table.removeNames(nameID<span class="op">=</span>nameID, platformID<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb24-75"><a href="#cb24-75" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Adiciona nova entrada</span></span>
<span id="cb24-76"><a href="#cb24-76" aria-hidden="true" tabindex="-1"></a>            name_table.addName(nameString, nameID, <span class="dv">3</span>, <span class="dv">1</span>, <span class="bn">0x409</span>)  <span class="co"># Windows, English</span></span>
<span id="cb24-77"><a href="#cb24-77" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-78"><a href="#cb24-78" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> fix_name_table(<span class="va">self</span>, font):</span>
<span id="cb24-79"><a href="#cb24-79" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Corrige problemas espec√≠ficos da tabela name&quot;&quot;&quot;</span></span>
<span id="cb24-80"><a href="#cb24-80" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">&#39;name&#39;</span> <span class="kw">not</span> <span class="kw">in</span> font:</span>
<span id="cb24-81"><a href="#cb24-81" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb24-82"><a href="#cb24-82" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-83"><a href="#cb24-83" aria-hidden="true" tabindex="-1"></a>        name_table <span class="op">=</span> font[<span class="st">&#39;name&#39;</span>]</span>
<span id="cb24-84"><a href="#cb24-84" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-85"><a href="#cb24-85" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Remove entradas com plataformas n√£o padr√£o que podem causar problemas</span></span>
<span id="cb24-86"><a href="#cb24-86" aria-hidden="true" tabindex="-1"></a>        problematic_entries <span class="op">=</span> []</span>
<span id="cb24-87"><a href="#cb24-87" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, record <span class="kw">in</span> <span class="bu">enumerate</span>(name_table.names):</span>
<span id="cb24-88"><a href="#cb24-88" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Mant√©m apenas Windows (3) e Unicode (0)</span></span>
<span id="cb24-89"><a href="#cb24-89" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> record.platformID <span class="kw">not</span> <span class="kw">in</span> [<span class="dv">0</span>, <span class="dv">3</span>]:</span>
<span id="cb24-90"><a href="#cb24-90" aria-hidden="true" tabindex="-1"></a>                problematic_entries.append(i)</span>
<span id="cb24-91"><a href="#cb24-91" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-92"><a href="#cb24-92" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Remove em ordem reversa para n√£o afetar √≠ndices</span></span>
<span id="cb24-93"><a href="#cb24-93" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">sorted</span>(problematic_entries, reverse<span class="op">=</span><span class="va">True</span>):</span>
<span id="cb24-94"><a href="#cb24-94" aria-hidden="true" tabindex="-1"></a>            <span class="kw">del</span> name_table.names[i]</span>
<span id="cb24-95"><a href="#cb24-95" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-96"><a href="#cb24-96" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> fix_os2_table(<span class="va">self</span>, font):</span>
<span id="cb24-97"><a href="#cb24-97" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Corrige a tabela OS/2 essencial para Windows&quot;&quot;&quot;</span></span>
<span id="cb24-98"><a href="#cb24-98" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;‚öôÔ∏è  Corrigindo tabela OS/2...&quot;</span>)</span>
<span id="cb24-99"><a href="#cb24-99" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-100"><a href="#cb24-100" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">&#39;OS/2&#39;</span> <span class="kw">not</span> <span class="kw">in</span> font:</span>
<span id="cb24-101"><a href="#cb24-101" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Cria uma tabela OS/2 b√°sica se n√£o existir</span></span>
<span id="cb24-102"><a href="#cb24-102" aria-hidden="true" tabindex="-1"></a>            <span class="im">from</span> fontTools.ttLib.tables._O_S_2f_2 <span class="im">import</span> table_O_S_2f_2</span>
<span id="cb24-103"><a href="#cb24-103" aria-hidden="true" tabindex="-1"></a>            os2_table <span class="op">=</span> table_O_S_2f_2()</span>
<span id="cb24-104"><a href="#cb24-104" aria-hidden="true" tabindex="-1"></a>            os2_table.version <span class="op">=</span> <span class="dv">4</span></span>
<span id="cb24-105"><a href="#cb24-105" aria-hidden="true" tabindex="-1"></a>            os2_table.xAvgCharWidth <span class="op">=</span> <span class="dv">500</span></span>
<span id="cb24-106"><a href="#cb24-106" aria-hidden="true" tabindex="-1"></a>            os2_table.usWeightClass <span class="op">=</span> <span class="dv">400</span></span>
<span id="cb24-107"><a href="#cb24-107" aria-hidden="true" tabindex="-1"></a>            os2_table.usWidthClass <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb24-108"><a href="#cb24-108" aria-hidden="true" tabindex="-1"></a>            os2_table.fsType <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb24-109"><a href="#cb24-109" aria-hidden="true" tabindex="-1"></a>            os2_table.panose <span class="op">=</span> <span class="st">b&#39;</span><span class="ch">\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00</span><span class="st">&#39;</span></span>
<span id="cb24-110"><a href="#cb24-110" aria-hidden="true" tabindex="-1"></a>            font[<span class="st">&#39;OS/2&#39;</span>] <span class="op">=</span> os2_table</span>
<span id="cb24-111"><a href="#cb24-111" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb24-112"><a href="#cb24-112" aria-hidden="true" tabindex="-1"></a>            os2_table <span class="op">=</span> font[<span class="st">&#39;OS/2&#39;</span>]</span>
<span id="cb24-113"><a href="#cb24-113" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Garante flags corretas</span></span>
<span id="cb24-114"><a href="#cb24-114" aria-hidden="true" tabindex="-1"></a>            os2_table.fsType <span class="op">=</span> <span class="dv">0</span>  <span class="co"># Instal√°vel</span></span>
<span id="cb24-115"><a href="#cb24-115" aria-hidden="true" tabindex="-1"></a>            os2_table.usWeightClass <span class="op">=</span> <span class="dv">400</span>  <span class="co"># Normal</span></span>
<span id="cb24-116"><a href="#cb24-116" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-117"><a href="#cb24-117" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> fix_font_flags(<span class="va">self</span>, font):</span>
<span id="cb24-118"><a href="#cb24-118" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Corrige flags na tabela head&quot;&quot;&quot;</span></span>
<span id="cb24-119"><a href="#cb24-119" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">&#39;head&#39;</span> <span class="kw">in</span> font:</span>
<span id="cb24-120"><a href="#cb24-120" aria-hidden="true" tabindex="-1"></a>            head_table <span class="op">=</span> font[<span class="st">&#39;head&#39;</span>]</span>
<span id="cb24-121"><a href="#cb24-121" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Flags importantes para Windows</span></span>
<span id="cb24-122"><a href="#cb24-122" aria-hidden="true" tabindex="-1"></a>            head_table.magicNumber <span class="op">=</span> <span class="bn">0x5F0F3CF5</span></span>
<span id="cb24-123"><a href="#cb24-123" aria-hidden="true" tabindex="-1"></a>            head_table.flags <span class="op">=</span> <span class="bn">0x0000</span>  <span class="co"># Flags b√°sicas</span></span>
<span id="cb24-124"><a href="#cb24-124" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-125"><a href="#cb24-125" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_simple_version(<span class="va">self</span>):</span>
<span id="cb24-126"><a href="#cb24-126" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Cria uma vers√£o simplificada que geralmente instala&quot;&quot;&quot;</span></span>
<span id="cb24-127"><a href="#cb24-127" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;üîÑ Criando vers√£o simplificada...&quot;</span>)</span>
<span id="cb24-128"><a href="#cb24-128" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-129"><a href="#cb24-129" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb24-130"><a href="#cb24-130" aria-hidden="true" tabindex="-1"></a>            font <span class="op">=</span> TTFont(<span class="va">self</span>.original_font)</span>
<span id="cb24-131"><a href="#cb24-131" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-132"><a href="#cb24-132" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Remove tabelas complexas que podem causar problemas</span></span>
<span id="cb24-133"><a href="#cb24-133" aria-hidden="true" tabindex="-1"></a>            tables_to_remove <span class="op">=</span> [<span class="st">&#39;GDEF&#39;</span>, <span class="st">&#39;GPOS&#39;</span>, <span class="st">&#39;GSUB&#39;</span>, <span class="st">&#39;MATH&#39;</span>, <span class="st">&#39;BASE&#39;</span>]</span>
<span id="cb24-134"><a href="#cb24-134" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> table <span class="kw">in</span> tables_to_remove:</span>
<span id="cb24-135"><a href="#cb24-135" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> table <span class="kw">in</span> font:</span>
<span id="cb24-136"><a href="#cb24-136" aria-hidden="true" tabindex="-1"></a>                    <span class="kw">del</span> font[table]</span>
<span id="cb24-137"><a href="#cb24-137" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-138"><a href="#cb24-138" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Salva vers√£o simplificada</span></span>
<span id="cb24-139"><a href="#cb24-139" aria-hidden="true" tabindex="-1"></a>            simple_path <span class="op">=</span> <span class="va">self</span>.fixed_dir <span class="op">/</span> <span class="st">&quot;NotoColorEmoji_Simple.ttf&quot;</span></span>
<span id="cb24-140"><a href="#cb24-140" aria-hidden="true" tabindex="-1"></a>            font.save(simple_path)</span>
<span id="cb24-141"><a href="#cb24-141" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-142"><a href="#cb24-142" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ Vers√£o simplificada: </span><span class="sc">{</span>simple_path<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb24-143"><a href="#cb24-143" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> simple_path</span>
<span id="cb24-144"><a href="#cb24-144" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-145"><a href="#cb24-145" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb24-146"><a href="#cb24-146" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚ùå Erro na vers√£o simplificada: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb24-147"><a href="#cb24-147" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb24-148"><a href="#cb24-148" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-149"><a href="#cb24-149" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> install_font_manual_method(<span class="va">self</span>, font_path):</span>
<span id="cb24-150"><a href="#cb24-150" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;M√©todo manual de instala√ß√£o que geralmente funciona&quot;&quot;&quot;</span></span>
<span id="cb24-151"><a href="#cb24-151" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;üîß Instalando fonte manualmente...&quot;</span>)</span>
<span id="cb24-152"><a href="#cb24-152" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-153"><a href="#cb24-153" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb24-154"><a href="#cb24-154" aria-hidden="true" tabindex="-1"></a>            <span class="co"># M√©todo 1: Copiar diretamente</span></span>
<span id="cb24-155"><a href="#cb24-155" aria-hidden="true" tabindex="-1"></a>            fonts_dir <span class="op">=</span> Path(os.environ[<span class="st">&#39;WINDIR&#39;</span>]) <span class="op">/</span> <span class="st">&#39;Fonts&#39;</span></span>
<span id="cb24-156"><a href="#cb24-156" aria-hidden="true" tabindex="-1"></a>            dest_path <span class="op">=</span> fonts_dir <span class="op">/</span> font_path.name</span>
<span id="cb24-157"><a href="#cb24-157" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-158"><a href="#cb24-158" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Tenta copiar</span></span>
<span id="cb24-159"><a href="#cb24-159" aria-hidden="true" tabindex="-1"></a>            shutil.copy2(font_path, dest_path)</span>
<span id="cb24-160"><a href="#cb24-160" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ Fonte instalada em: </span><span class="sc">{</span>dest_path<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb24-161"><a href="#cb24-161" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb24-162"><a href="#cb24-162" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-163"><a href="#cb24-163" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">PermissionError</span>:</span>
<span id="cb24-164"><a href="#cb24-164" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;‚ùå Permiss√£o negada. Vamos tentar m√©todos alternativos...&quot;</span>)</span>
<span id="cb24-165"><a href="#cb24-165" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">self</span>.alternative_install_methods(font_path)</span>
<span id="cb24-166"><a href="#cb24-166" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb24-167"><a href="#cb24-167" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚ùå Erro na instala√ß√£o: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb24-168"><a href="#cb24-168" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb24-169"><a href="#cb24-169" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-170"><a href="#cb24-170" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> alternative_install_methods(<span class="va">self</span>, font_path):</span>
<span id="cb24-171"><a href="#cb24-171" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;M√©todos alternativos de instala√ß√£o&quot;&quot;&quot;</span></span>
<span id="cb24-172"><a href="#cb24-172" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;üîÑ Tentando m√©todos alternativos...&quot;</span>)</span>
<span id="cb24-173"><a href="#cb24-173" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-174"><a href="#cb24-174" aria-hidden="true" tabindex="-1"></a>        <span class="co"># M√©todo 2: Via contexto de instala√ß√£o</span></span>
<span id="cb24-175"><a href="#cb24-175" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb24-176"><a href="#cb24-176" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Usa o instalador nativo do Windows</span></span>
<span id="cb24-177"><a href="#cb24-177" aria-hidden="true" tabindex="-1"></a>            cmd <span class="op">=</span> <span class="ss">f&#39;powershell &quot;Copy-Item </span><span class="ch">\&#39;</span><span class="sc">{</span>font_path<span class="sc">}</span><span class="ch">\&#39;</span><span class="ss"> </span><span class="ch">\&#39;</span><span class="ss">C:</span><span class="ch">\\</span><span class="ss">Windows</span><span class="ch">\\</span><span class="ss">Fonts</span><span class="ch">\\\&#39;</span><span class="ss"> -Force&quot;&#39;</span></span>
<span id="cb24-178"><a href="#cb24-178" aria-hidden="true" tabindex="-1"></a>            os.system(cmd)</span>
<span id="cb24-179"><a href="#cb24-179" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;‚úÖ M√©todo PowerShell executado&quot;</span>)</span>
<span id="cb24-180"><a href="#cb24-180" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb24-181"><a href="#cb24-181" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span>:</span>
<span id="cb24-182"><a href="#cb24-182" aria-hidden="true" tabindex="-1"></a>            <span class="cf">pass</span></span>
<span id="cb24-183"><a href="#cb24-183" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-184"><a href="#cb24-184" aria-hidden="true" tabindex="-1"></a>        <span class="co"># M√©todo 3: Via di√°logo de instala√ß√£o</span></span>
<span id="cb24-185"><a href="#cb24-185" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb24-186"><a href="#cb24-186" aria-hidden="true" tabindex="-1"></a>            os.startfile(font_path)</span>
<span id="cb24-187"><a href="#cb24-187" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;‚úÖ Di√°logo de instala√ß√£o aberto&quot;</span>)</span>
<span id="cb24-188"><a href="#cb24-188" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;üí° Clique em &#39;Instalar&#39; na janela que abriu&quot;</span>)</span>
<span id="cb24-189"><a href="#cb24-189" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb24-190"><a href="#cb24-190" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span>:</span>
<span id="cb24-191"><a href="#cb24-191" aria-hidden="true" tabindex="-1"></a>            <span class="cf">pass</span></span>
<span id="cb24-192"><a href="#cb24-192" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-193"><a href="#cb24-193" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb24-194"><a href="#cb24-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-195"><a href="#cb24-195" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> main():</span>
<span id="cb24-196"><a href="#cb24-196" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;üõ†Ô∏è  CORRE√á√ÉO DE INSTALA√á√ÉO NOTO COLOR EMOJI WINDOWS&quot;</span>)</span>
<span id="cb24-197"><a href="#cb24-197" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;=&quot;</span> <span class="op">*</span> <span class="dv">60</span>)</span>
<span id="cb24-198"><a href="#cb24-198" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-199"><a href="#cb24-199" aria-hidden="true" tabindex="-1"></a>    installer <span class="op">=</span> NotoFontWindowsInstaller()</span>
<span id="cb24-200"><a href="#cb24-200" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-201"><a href="#cb24-201" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Passo 1: Corrigir a fonte</span></span>
<span id="cb24-202"><a href="#cb24-202" aria-hidden="true" tabindex="-1"></a>    fixed_font <span class="op">=</span> installer.fix_common_installation_issues()</span>
<span id="cb24-203"><a href="#cb24-203" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-204"><a href="#cb24-204" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> fixed_font:</span>
<span id="cb24-205"><a href="#cb24-205" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;‚ùå Falha na corre√ß√£o. Tentando vers√£o simplificada...&quot;</span>)</span>
<span id="cb24-206"><a href="#cb24-206" aria-hidden="true" tabindex="-1"></a>        fixed_font <span class="op">=</span> installer.create_simple_version()</span>
<span id="cb24-207"><a href="#cb24-207" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-208"><a href="#cb24-208" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> fixed_font:</span>
<span id="cb24-209"><a href="#cb24-209" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Passo 2: Tentar instalar</span></span>
<span id="cb24-210"><a href="#cb24-210" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="ch">\n</span><span class="ss">üí° Tentando instalar: </span><span class="sc">{</span>fixed_font<span class="sc">.</span>name<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb24-211"><a href="#cb24-211" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-212"><a href="#cb24-212" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> installer.install_font_manual_method(fixed_font):</span>
<span id="cb24-213"><a href="#cb24-213" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;üéâ Fonte instalada com sucesso!&quot;</span>)</span>
<span id="cb24-214"><a href="#cb24-214" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">üîÅ Reinicie seus aplicativos para usar a nova fonte&quot;</span>)</span>
<span id="cb24-215"><a href="#cb24-215" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb24-216"><a href="#cb24-216" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Instala√ß√£o manual</span></span>
<span id="cb24-217"><a href="#cb24-217" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">üìã INSTALA√á√ÉO MANUAL NECESS√ÅRIA:&quot;</span>)</span>
<span id="cb24-218"><a href="#cb24-218" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;1. Pressione WINDOWS + R&quot;</span>)</span>
<span id="cb24-219"><a href="#cb24-219" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;2. Digite: shell:fonts&quot;</span>)</span>
<span id="cb24-220"><a href="#cb24-220" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;3. Pressione ENTER&quot;</span>)</span>
<span id="cb24-221"><a href="#cb24-221" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;4. Arraste o arquivo: </span><span class="sc">{</span>fixed_font<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb24-222"><a href="#cb24-222" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;5. O Windows instalar√° automaticamente&quot;</span>)</span>
<span id="cb24-223"><a href="#cb24-223" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;6. Reinicie seus aplicativos&quot;</span>)</span>
<span id="cb24-224"><a href="#cb24-224" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-225"><a href="#cb24-225" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb24-226"><a href="#cb24-226" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;‚ùå N√£o foi poss√≠vel corrigir a fonte.&quot;</span>)</span>
<span id="cb24-227"><a href="#cb24-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-228"><a href="#cb24-228" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&quot;__main__&quot;</span>:</span>
<span id="cb24-229"><a href="#cb24-229" aria-hidden="true" tabindex="-1"></a>    main()</span></code></pre></div>
<h2 data-number="1.31" id="script-de-instala√ß√£o-com-verifica√ß√£o-em-tempo-real"><span class="header-section-number">1.31</span> 2. Script de Instala√ß√£o com
Verifica√ß√£o em Tempo Real</h2>
<div class="sourceCode" id="cb25"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> subprocess</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> time</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> check_font_installation(font_name):</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Verifica se a fonte foi instalada corretamente&quot;&quot;&quot;</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Verifica via PowerShell</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>        ps_command <span class="op">=</span> <span class="ss">f&quot;&quot;&quot;</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="ss">        $fonts = @(Get-ChildItem -Path &quot;C:</span><span class="ch">\\</span><span class="ss">Windows</span><span class="ch">\\</span><span class="ss">Fonts&quot; -Name &quot;*</span><span class="sc">{</span>font_name<span class="sc">}</span><span class="ss">*&quot;)</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a><span class="ss">        if ($fonts) </span><span class="ch">{{</span><span class="ss"> Write-Output &quot;INSTALLED&quot; </span><span class="ch">}}</span><span class="ss"> else </span><span class="ch">{{</span><span class="ss"> Write-Output &quot;NOT_INSTALLED&quot; </span><span class="ch">}}</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a><span class="ss">        &quot;&quot;&quot;</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> subprocess.run([</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;powershell&#39;</span>, <span class="st">&#39;-Command&#39;</span>, ps_command</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>        ], capture_output<span class="op">=</span><span class="va">True</span>, text<span class="op">=</span><span class="va">True</span>, timeout<span class="op">=</span><span class="dv">30</span>)</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">&quot;INSTALLED&quot;</span> <span class="kw">in</span> result.stdout</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span>:</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> install_with_verification(font_path):</span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Instala com verifica√ß√£o em tempo real&quot;&quot;&quot;</span></span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>    font_name <span class="op">=</span> font_path.stem</span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;üîç Verificando instala√ß√£o da fonte &#39;</span><span class="sc">{</span>font_name<span class="sc">}</span><span class="ss">&#39;...&quot;</span>)</span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Verifica se j√° est√° instalada</span></span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> check_font_installation(font_name):</span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;‚úÖ Fonte j√° est√° instalada!&quot;</span>)</span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Tenta instalar</span></span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;üì• Instalando fonte...&quot;</span>)</span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb25-36"><a href="#cb25-36" aria-hidden="true" tabindex="-1"></a>        subprocess.run([<span class="st">&#39;powershell&#39;</span>, <span class="st">&#39;-Command&#39;</span>, </span>
<span id="cb25-37"><a href="#cb25-37" aria-hidden="true" tabindex="-1"></a>                      <span class="ss">f&#39;Start-Process &quot;cmd&quot; -ArgumentList &quot;/c copy </span><span class="ch">\&quot;</span><span class="sc">{</span>font_path<span class="sc">}</span><span class="ch">\&quot;</span><span class="ss"> </span><span class="ch">\&quot;</span><span class="ss">C:</span><span class="ch">\\</span><span class="ss">Windows</span><span class="ch">\\</span><span class="ss">Fonts</span><span class="ch">\\\&quot;</span><span class="ss"> /Y&quot; -Verb RunAs -Wait&#39;</span>],</span>
<span id="cb25-38"><a href="#cb25-38" aria-hidden="true" tabindex="-1"></a>                     timeout<span class="op">=</span><span class="dv">60</span>)</span>
<span id="cb25-39"><a href="#cb25-39" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-40"><a href="#cb25-40" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Aguarda e verifica</span></span>
<span id="cb25-41"><a href="#cb25-41" aria-hidden="true" tabindex="-1"></a>        time.sleep(<span class="dv">3</span>)</span>
<span id="cb25-42"><a href="#cb25-42" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> check_font_installation(font_name):</span>
<span id="cb25-43"><a href="#cb25-43" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;‚úÖ Fonte instalada com sucesso!&quot;</span>)</span>
<span id="cb25-44"><a href="#cb25-44" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb25-45"><a href="#cb25-45" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb25-46"><a href="#cb25-46" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;‚ùå A instala√ß√£o pode ter falhado&quot;</span>)</span>
<span id="cb25-47"><a href="#cb25-47" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb25-48"><a href="#cb25-48" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-49"><a href="#cb25-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb25-50"><a href="#cb25-50" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;‚ùå Erro na instala√ß√£o: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb25-51"><a href="#cb25-51" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb25-52"><a href="#cb25-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-53"><a href="#cb25-53" aria-hidden="true" tabindex="-1"></a><span class="co"># Uso r√°pido</span></span>
<span id="cb25-54"><a href="#cb25-54" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&quot;__main__&quot;</span>:</span>
<span id="cb25-55"><a href="#cb25-55" aria-hidden="true" tabindex="-1"></a>    font_path <span class="op">=</span> Path(<span class="st">&quot;NotoColorEmoji_Windows_Optimized.ttf&quot;</span>)</span>
<span id="cb25-56"><a href="#cb25-56" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> font_path.exists():</span>
<span id="cb25-57"><a href="#cb25-57" aria-hidden="true" tabindex="-1"></a>        install_with_verification(font_path)</span>
<span id="cb25-58"><a href="#cb25-58" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb25-59"><a href="#cb25-59" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;‚ùå Arquivo de fonte n√£o encontrado!&quot;</span>)</span></code></pre></div>
<h2 data-number="1.32" id="solu√ß√£o-r√°pida---uma-linha"><span class="header-section-number">1.32</span> 3. Solu√ß√£o R√°pida - Uma
Linha</h2>
<p>Crie um arquivo <code>install_font.bat</code>:</p>
<pre class="batch"><code>@echo off
echo Instalando Noto Color Emoji no Windows 10...
echo.

:: Copia a fonte para o diret√≥rio de fontes
copy &quot;NotoColorEmoji_Windows_Optimized.ttf&quot; &quot;C:\Windows\Fonts\&quot;

if %errorlevel% == 0 (
    echo ‚úÖ Fonte instalada com sucesso!
    echo üîÅ Reinicie seus aplicativos
) else (
    echo ‚ùå Erro na instala√ß√£o. Execute como Administrador.
    echo.
    echo üìã Para instalar manualmente:
    echo 1. Pressione Windows + R
    echo 2. Digite: shell:fonts
    echo 3. Arraste o arquivo para a janela
)

pause</code></pre>
<h2 data-number="1.33" id="como-executar-a-corre√ß√£o"><span class="header-section-number">1.33</span> 4. Como Executar a
Corre√ß√£o</h2>
<h3 data-number="1.33.1" id="m√©todo-1---corre√ß√£o-autom√°tica"><span class="header-section-number">1.33.1</span> M√©todo 1 - Corre√ß√£o
Autom√°tica:</h3>
<div class="sourceCode" id="cb27"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> noto_fix_install.py</span></code></pre></div>
<h3 data-number="1.33.2" id="m√©todo-2---linha-de-comando-direta"><span class="header-section-number">1.33.2</span> M√©todo 2 - Linha de Comando
Direta:</h3>
<div class="sourceCode" id="cb28"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tenta instalar diretamente via PowerShell</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="ex">powershell</span> <span class="at">-Command</span> <span class="st">&quot;Start-Process powershell -ArgumentList &#39;-Command </span><span class="dt">\&quot;</span><span class="st">Copy-Item NotoColorEmoji_Windows_Optimized.ttf C:</span><span class="dt">\\</span><span class="st">Windows</span><span class="dt">\\</span><span class="st">Fonts</span><span class="dt">\\</span><span class="st"> -Force</span><span class="dt">\&quot;</span><span class="st">&#39; -Verb RunAs&quot;</span></span></code></pre></div>
<h3 data-number="1.33.3" id="m√©todo-3---script-batch-execute-como-administrador"><span class="header-section-number">1.33.3</span> M√©todo 3 - Script Batch
(Execute como Administrador):</h3>
<div class="sourceCode" id="cb29"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="ex">install_font.bat</span></span></code></pre></div>
<h2 data-number="1.34" id="verifica√ß√£o-p√≥s-instala√ß√£o"><span class="header-section-number">1.34</span> 5. Verifica√ß√£o
P√≥s-Instala√ß√£o</h2>
<div class="sourceCode" id="cb30"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> verify_installation():</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Verifica se a fonte foi instalada corretamente&quot;&quot;&quot;</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>    <span class="im">import</span> winreg</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Verifica no registro do Windows</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>        key <span class="op">=</span> winreg.OpenKey(winreg.HKEY_LOCAL_MACHINE, </span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>                           <span class="vs">r&quot;SOFTWARE</span><span class="dv">\M</span><span class="vs">icrosoft</span><span class="dv">\W</span><span class="vs">indows NT</span><span class="er">\</span><span class="vs">CurrentVersion</span><span class="er">\</span><span class="vs">Fonts&quot;</span>)</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>        installed_fonts <span class="op">=</span> []</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1000</span>):</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>                name, value, _ <span class="op">=</span> winreg.EnumValue(key, i)</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>                installed_fonts.append(name)</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span> <span class="pp">WindowsError</span>:</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>                <span class="cf">break</span></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Verifica se nossa fonte est√° l√°</span></span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>        noto_variants <span class="op">=</span> [name <span class="cf">for</span> name <span class="kw">in</span> installed_fonts <span class="cf">if</span> <span class="st">&quot;Noto&quot;</span> <span class="kw">in</span> name <span class="kw">or</span> <span class="st">&quot;Emoji&quot;</span> <span class="kw">in</span> name]</span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> noto_variants:</span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;‚úÖ Fontes Noto instaladas:&quot;</span>)</span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> font <span class="kw">in</span> noto_variants:</span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;   - </span><span class="sc">{</span>font<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;‚ùå Nenhuma fonte Noto encontrada&quot;</span>)</span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;‚ùå Erro na verifica√ß√£o: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a>verify_installation()</span></code></pre></div>
<h2 data-number="1.35" id="pontos-cr√≠ticos-para-sucesso"><span class="header-section-number">1.35</span> Pontos Cr√≠ticos para
Sucesso:</h2>
<ol type="1">
<li><strong>‚úÖ Execute como Administrador</strong></li>
<li><strong>‚úÖ Renomeie para nome mais curto</strong> se necess√°rio:
<code>NotoEmoji.ttf</code></li>
<li><strong>‚úÖ Use o m√©todo manual</strong> se autom√°tico falhar:
<code>Windows + R</code> ‚Üí <code>shell:fonts</code></li>
<li><strong>‚úÖ Reinicie aplicativos</strong> ap√≥s instala√ß√£o</li>
</ol>
<p>O primeiro script geralmente resolve os problemas de metadados que
impedem a instala√ß√£o no Windows 10!</p>
<hr />
<h3 data-number="1.35.1" id="utilizador-2025-09-22-210952-deepseek-chat"><span class="header-section-number">1.35.1</span> üë§ Utilizador
<em>(2025-09-22 21:09:52)</em> <em>[deepseek-chat]</em></h3>
<p>o problema √© que NotoColorEmoji_Windows_Optimized.ttf ao clicar com
bot√£o direito e tentar instalar para todos os utilizadores diz cannot
install</p>
<hr />
<h3 data-number="1.35.2" id="deepseek-2025-09-22-210952-deepseek-chat"><span class="header-section-number">1.35.2</span> ü§ñ DeepSeek <em>(2025-09-22
21:09:52)</em> <em>[deepseek-chat]</em></h3>
<p>Este √© um erro espec√≠fico do Windows quando a fonte n√£o atende aos
requisitos de valida√ß√£o. Vamos corrigir os problemas de valida√ß√£o:</p>
<h2 data-number="1.36" id="script-de-corre√ß√£o-de-valida√ß√£o-do-windows"><span class="header-section-number">1.36</span> 1. Script de Corre√ß√£o de
Valida√ß√£o do Windows</h2>
<div class="sourceCode" id="cb31"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> shutil</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fontTools.ttLib <span class="im">import</span> TTFont</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fontTools.ttLib.tables._n_a_m_e <span class="im">import</span> table__n_a_m_e</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fontTools.ttLib.tables._O_S_2f_2 <span class="im">import</span> table_O_S_2f_2</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fontTools.ttLib.tables._h_e_a_d <span class="im">import</span> table__h_e_a_d</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> struct</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> WindowsFontValidator:</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.original_font <span class="op">=</span> Path(<span class="st">&quot;NotoColorEmoji_Windows_Optimized.ttf&quot;</span>)</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.valid_dir <span class="op">=</span> Path(<span class="st">&quot;Windows_Valid_Fonts&quot;</span>)</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.valid_dir.mkdir(exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> validate_and_fix_font(<span class="va">self</span>):</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Valida e corrige todos os problemas que impedem a instala√ß√£o&quot;&quot;&quot;</span></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;üîç Validando fonte para instala√ß√£o no Windows...&quot;</span>)</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.original_font.exists():</span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;‚ùå Arquivo de fonte n√£o encontrado!&quot;</span>)</span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Abre a fonte</span></span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>            font <span class="op">=</span> TTFont(<span class="va">self</span>.original_font)</span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Lista de verifica√ß√µes e corre√ß√µes</span></span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a>            checks <span class="op">=</span> [</span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.fix_head_table,</span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.fix_name_table_comprehensive,</span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.fix_os2_table_comprehensive,</span>
<span id="cb31-33"><a href="#cb31-33" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.fix_cmap_table,</span>
<span id="cb31-34"><a href="#cb31-34" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.remove_problematic_tables,</span>
<span id="cb31-35"><a href="#cb31-35" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.fix_font_flags,</span>
<span id="cb31-36"><a href="#cb31-36" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.add_missing_required_tables,</span>
<span id="cb31-37"><a href="#cb31-37" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.validate_font_structure</span>
<span id="cb31-38"><a href="#cb31-38" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb31-39"><a href="#cb31-39" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb31-40"><a href="#cb31-40" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> check <span class="kw">in</span> checks:</span>
<span id="cb31-41"><a href="#cb31-41" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="kw">not</span> check(font):</span>
<span id="cb31-42"><a href="#cb31-42" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="ss">f&quot;‚ö†Ô∏è  Problema encontrado e corrigido&quot;</span>)</span>
<span id="cb31-43"><a href="#cb31-43" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb31-44"><a href="#cb31-44" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Salva fonte validada</span></span>
<span id="cb31-45"><a href="#cb31-45" aria-hidden="true" tabindex="-1"></a>            valid_path <span class="op">=</span> <span class="va">self</span>.valid_dir <span class="op">/</span> <span class="st">&quot;NotoColorEmoji_Windows_Valid.ttf&quot;</span></span>
<span id="cb31-46"><a href="#cb31-46" aria-hidden="true" tabindex="-1"></a>            font.save(valid_path, reorderTables<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb31-47"><a href="#cb31-47" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb31-48"><a href="#cb31-48" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ Fonte validada e corrigida: </span><span class="sc">{</span>valid_path<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb31-49"><a href="#cb31-49" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> valid_path</span>
<span id="cb31-50"><a href="#cb31-50" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb31-51"><a href="#cb31-51" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb31-52"><a href="#cb31-52" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚ùå Erro na valida√ß√£o: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb31-53"><a href="#cb31-53" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb31-54"><a href="#cb31-54" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-55"><a href="#cb31-55" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> fix_head_table(<span class="va">self</span>, font):</span>
<span id="cb31-56"><a href="#cb31-56" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Corrige a tabela head (CR√çTICA para instala√ß√£o)&quot;&quot;&quot;</span></span>
<span id="cb31-57"><a href="#cb31-57" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">&#39;head&#39;</span> <span class="kw">not</span> <span class="kw">in</span> font:</span>
<span id="cb31-58"><a href="#cb31-58" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;‚ùå Tabela HEAD ausente - criando...&quot;</span>)</span>
<span id="cb31-59"><a href="#cb31-59" aria-hidden="true" tabindex="-1"></a>            font[<span class="st">&#39;head&#39;</span>] <span class="op">=</span> table__h_e_a_d()</span>
<span id="cb31-60"><a href="#cb31-60" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb31-61"><a href="#cb31-61" aria-hidden="true" tabindex="-1"></a>        head <span class="op">=</span> font[<span class="st">&#39;head&#39;</span>]</span>
<span id="cb31-62"><a href="#cb31-62" aria-hidden="true" tabindex="-1"></a>        head.magicNumber <span class="op">=</span> <span class="bn">0x5F0F3CF5</span>  <span class="co"># MUST be this value</span></span>
<span id="cb31-63"><a href="#cb31-63" aria-hidden="true" tabindex="-1"></a>        head.flags <span class="op">=</span> <span class="bn">0x0000</span></span>
<span id="cb31-64"><a href="#cb31-64" aria-hidden="true" tabindex="-1"></a>        head.unitsPerEm <span class="op">=</span> <span class="dv">1024</span></span>
<span id="cb31-65"><a href="#cb31-65" aria-hidden="true" tabindex="-1"></a>        head.created <span class="op">=</span> head.modified <span class="op">=</span> <span class="dv">3570035200</span>  <span class="co"># Timestamp v√°lido</span></span>
<span id="cb31-66"><a href="#cb31-66" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb31-67"><a href="#cb31-67" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-68"><a href="#cb31-68" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> fix_name_table_comprehensive(<span class="va">self</span>, font):</span>
<span id="cb31-69"><a href="#cb31-69" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Corrige completamente a tabela name&quot;&quot;&quot;</span></span>
<span id="cb31-70"><a href="#cb31-70" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;üìù Corrigindo tabela NAME...&quot;</span>)</span>
<span id="cb31-71"><a href="#cb31-71" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb31-72"><a href="#cb31-72" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">&#39;name&#39;</span> <span class="kw">not</span> <span class="kw">in</span> font:</span>
<span id="cb31-73"><a href="#cb31-73" aria-hidden="true" tabindex="-1"></a>            <span class="im">from</span> fontTools.ttLib <span class="im">import</span> newTable</span>
<span id="cb31-74"><a href="#cb31-74" aria-hidden="true" tabindex="-1"></a>            font[<span class="st">&#39;name&#39;</span>] <span class="op">=</span> newTable(<span class="st">&#39;name&#39;</span>)</span>
<span id="cb31-75"><a href="#cb31-75" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb31-76"><a href="#cb31-76" aria-hidden="true" tabindex="-1"></a>        name_table <span class="op">=</span> font[<span class="st">&#39;name&#39;</span>]</span>
<span id="cb31-77"><a href="#cb31-77" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb31-78"><a href="#cb31-78" aria-hidden="true" tabindex="-1"></a>        <span class="co"># REMOVE TODAS as entradas problem√°ticas primeiro</span></span>
<span id="cb31-79"><a href="#cb31-79" aria-hidden="true" tabindex="-1"></a>        name_table.names <span class="op">=</span> []</span>
<span id="cb31-80"><a href="#cb31-80" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb31-81"><a href="#cb31-81" aria-hidden="true" tabindex="-1"></a>        <span class="co"># ADICIONA entradas OBRIGAT√ìRIAS para Windows</span></span>
<span id="cb31-82"><a href="#cb31-82" aria-hidden="true" tabindex="-1"></a>        <span class="co"># PlatformID: 3=Windows, EncodingID: 1=Unicode, LanguageID: 0x409=English</span></span>
<span id="cb31-83"><a href="#cb31-83" aria-hidden="true" tabindex="-1"></a>        required_names <span class="op">=</span> [</span>
<span id="cb31-84"><a href="#cb31-84" aria-hidden="true" tabindex="-1"></a>            (<span class="dv">1</span>, <span class="st">&quot;Noto Color Emoji&quot;</span>),           <span class="co"># Family Name</span></span>
<span id="cb31-85"><a href="#cb31-85" aria-hidden="true" tabindex="-1"></a>            (<span class="dv">2</span>, <span class="st">&quot;Regular&quot;</span>),                    <span class="co"># Subfamily</span></span>
<span id="cb31-86"><a href="#cb31-86" aria-hidden="true" tabindex="-1"></a>            (<span class="dv">3</span>, <span class="st">&quot;Google:Noto Color Emoji:2023&quot;</span>), <span class="co"># Unique ID</span></span>
<span id="cb31-87"><a href="#cb31-87" aria-hidden="true" tabindex="-1"></a>            (<span class="dv">4</span>, <span class="st">&quot;Noto Color Emoji&quot;</span>),           <span class="co"># Full Name</span></span>
<span id="cb31-88"><a href="#cb31-88" aria-hidden="true" tabindex="-1"></a>            (<span class="dv">6</span>, <span class="st">&quot;NotoColorEmoji&quot;</span>),             <span class="co"># PostScript Name (SEM ESPA√áOS)</span></span>
<span id="cb31-89"><a href="#cb31-89" aria-hidden="true" tabindex="-1"></a>            (<span class="dv">16</span>, <span class="st">&quot;Noto Color Emoji&quot;</span>),          <span class="co"># Preferred Family</span></span>
<span id="cb31-90"><a href="#cb31-90" aria-hidden="true" tabindex="-1"></a>            (<span class="dv">17</span>, <span class="st">&quot;Regular&quot;</span>)                    <span class="co"># Preferred Subfamily</span></span>
<span id="cb31-91"><a href="#cb31-91" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb31-92"><a href="#cb31-92" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb31-93"><a href="#cb31-93" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> nameID, text <span class="kw">in</span> required_names:</span>
<span id="cb31-94"><a href="#cb31-94" aria-hidden="true" tabindex="-1"></a>            name_table.addName(text, nameID, <span class="dv">3</span>, <span class="dv">1</span>, <span class="bn">0x409</span>)  <span class="co"># Windows English</span></span>
<span id="cb31-95"><a href="#cb31-95" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb31-96"><a href="#cb31-96" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Tamb√©m adiciona vers√µes Mac (PlatformID 1) para compatibilidade</span></span>
<span id="cb31-97"><a href="#cb31-97" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> nameID, text <span class="kw">in</span> [(<span class="dv">1</span>, <span class="st">&quot;Noto Color Emoji&quot;</span>), (<span class="dv">2</span>, <span class="st">&quot;Regular&quot;</span>)]:</span>
<span id="cb31-98"><a href="#cb31-98" aria-hidden="true" tabindex="-1"></a>            name_table.addName(text, nameID, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>)  <span class="co"># Mac Roman</span></span>
<span id="cb31-99"><a href="#cb31-99" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb31-100"><a href="#cb31-100" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb31-101"><a href="#cb31-101" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-102"><a href="#cb31-102" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> fix_os2_table_comprehensive(<span class="va">self</span>, font):</span>
<span id="cb31-103"><a href="#cb31-103" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Corrige completamente a tabela OS/2&quot;&quot;&quot;</span></span>
<span id="cb31-104"><a href="#cb31-104" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;‚öôÔ∏è  Corrigindo tabela OS/2...&quot;</span>)</span>
<span id="cb31-105"><a href="#cb31-105" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb31-106"><a href="#cb31-106" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">&#39;OS/2&#39;</span> <span class="kw">not</span> <span class="kw">in</span> font:</span>
<span id="cb31-107"><a href="#cb31-107" aria-hidden="true" tabindex="-1"></a>            font[<span class="st">&#39;OS/2&#39;</span>] <span class="op">=</span> table_O_S_2f_2()</span>
<span id="cb31-108"><a href="#cb31-108" aria-hidden="true" tabindex="-1"></a>            font[<span class="st">&#39;OS/2&#39;</span>].version <span class="op">=</span> <span class="dv">4</span></span>
<span id="cb31-109"><a href="#cb31-109" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb31-110"><a href="#cb31-110" aria-hidden="true" tabindex="-1"></a>        os2 <span class="op">=</span> font[<span class="st">&#39;OS/2&#39;</span>]</span>
<span id="cb31-111"><a href="#cb31-111" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb31-112"><a href="#cb31-112" aria-hidden="true" tabindex="-1"></a>        <span class="co"># VALORES OBRIGAT√ìRIOS para Windows</span></span>
<span id="cb31-113"><a href="#cb31-113" aria-hidden="true" tabindex="-1"></a>        os2.version <span class="op">=</span> <span class="dv">4</span></span>
<span id="cb31-114"><a href="#cb31-114" aria-hidden="true" tabindex="-1"></a>        os2.xAvgCharWidth <span class="op">=</span> <span class="dv">1024</span></span>
<span id="cb31-115"><a href="#cb31-115" aria-hidden="true" tabindex="-1"></a>        os2.usWeightClass <span class="op">=</span> <span class="dv">400</span>  <span class="co"># Normal/Regular</span></span>
<span id="cb31-116"><a href="#cb31-116" aria-hidden="true" tabindex="-1"></a>        os2.usWidthClass <span class="op">=</span> <span class="dv">5</span>     <span class="co"># Medium</span></span>
<span id="cb31-117"><a href="#cb31-117" aria-hidden="true" tabindex="-1"></a>        os2.fsType <span class="op">=</span> <span class="bn">0x0000</span>      <span class="co"># Instal√°vel</span></span>
<span id="cb31-118"><a href="#cb31-118" aria-hidden="true" tabindex="-1"></a>        os2.ySubscriptXSize <span class="op">=</span> <span class="dv">1024</span></span>
<span id="cb31-119"><a href="#cb31-119" aria-hidden="true" tabindex="-1"></a>        os2.ySubscriptYSize <span class="op">=</span> <span class="dv">1024</span></span>
<span id="cb31-120"><a href="#cb31-120" aria-hidden="true" tabindex="-1"></a>        os2.ySubscriptXOffset <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb31-121"><a href="#cb31-121" aria-hidden="true" tabindex="-1"></a>        os2.ySubscriptYOffset <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb31-122"><a href="#cb31-122" aria-hidden="true" tabindex="-1"></a>        os2.ySuperscriptXSize <span class="op">=</span> <span class="dv">1024</span></span>
<span id="cb31-123"><a href="#cb31-123" aria-hidden="true" tabindex="-1"></a>        os2.ySuperscriptYSize <span class="op">=</span> <span class="dv">1024</span></span>
<span id="cb31-124"><a href="#cb31-124" aria-hidden="true" tabindex="-1"></a>        os2.ySuperscriptXOffset <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb31-125"><a href="#cb31-125" aria-hidden="true" tabindex="-1"></a>        os2.ySuperscriptYOffset <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb31-126"><a href="#cb31-126" aria-hidden="true" tabindex="-1"></a>        os2.yStrikeoutSize <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb31-127"><a href="#cb31-127" aria-hidden="true" tabindex="-1"></a>        os2.yStrikeoutPosition <span class="op">=</span> <span class="dv">500</span></span>
<span id="cb31-128"><a href="#cb31-128" aria-hidden="true" tabindex="-1"></a>        os2.sFamilyClass <span class="op">=</span> <span class="dv">0</span>     <span class="co"># No Classification</span></span>
<span id="cb31-129"><a href="#cb31-129" aria-hidden="true" tabindex="-1"></a>        os2.panose <span class="op">=</span> <span class="st">b&#39;</span><span class="ch">\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00</span><span class="st">&#39;</span>  <span class="co"># Any</span></span>
<span id="cb31-130"><a href="#cb31-130" aria-hidden="true" tabindex="-1"></a>        os2.ulUnicodeRange1 <span class="op">=</span> <span class="bn">0x00000001</span>  <span class="co"># Basic Latin</span></span>
<span id="cb31-131"><a href="#cb31-131" aria-hidden="true" tabindex="-1"></a>        os2.ulUnicodeRange2 <span class="op">=</span> <span class="bn">0x00000000</span></span>
<span id="cb31-132"><a href="#cb31-132" aria-hidden="true" tabindex="-1"></a>        os2.ulUnicodeRange3 <span class="op">=</span> <span class="bn">0x00000000</span></span>
<span id="cb31-133"><a href="#cb31-133" aria-hidden="true" tabindex="-1"></a>        os2.ulUnicodeRange4 <span class="op">=</span> <span class="bn">0x00000000</span></span>
<span id="cb31-134"><a href="#cb31-134" aria-hidden="true" tabindex="-1"></a>        os2.achVendID <span class="op">=</span> <span class="st">&quot;GOOG&quot;</span>   <span class="co"># Vendor ID</span></span>
<span id="cb31-135"><a href="#cb31-135" aria-hidden="true" tabindex="-1"></a>        os2.fsSelection <span class="op">=</span> <span class="bn">0x0040</span> <span class="co"># Regular</span></span>
<span id="cb31-136"><a href="#cb31-136" aria-hidden="true" tabindex="-1"></a>        os2.usFirstCharIndex <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb31-137"><a href="#cb31-137" aria-hidden="true" tabindex="-1"></a>        os2.usLastCharIndex <span class="op">=</span> <span class="bn">0xFFFF</span></span>
<span id="cb31-138"><a href="#cb31-138" aria-hidden="true" tabindex="-1"></a>        os2.sTypoAscender <span class="op">=</span> <span class="dv">1024</span></span>
<span id="cb31-139"><a href="#cb31-139" aria-hidden="true" tabindex="-1"></a>        os2.sTypoDescender <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb31-140"><a href="#cb31-140" aria-hidden="true" tabindex="-1"></a>        os2.sTypoLineGap <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb31-141"><a href="#cb31-141" aria-hidden="true" tabindex="-1"></a>        os2.usWinAscent <span class="op">=</span> <span class="dv">1024</span></span>
<span id="cb31-142"><a href="#cb31-142" aria-hidden="true" tabindex="-1"></a>        os2.usWinDescent <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb31-143"><a href="#cb31-143" aria-hidden="true" tabindex="-1"></a>        os2.ulCodePageRange1 <span class="op">=</span> <span class="bn">0x00000001</span>  <span class="co"># Latin 1</span></span>
<span id="cb31-144"><a href="#cb31-144" aria-hidden="true" tabindex="-1"></a>        os2.ulCodePageRange2 <span class="op">=</span> <span class="bn">0x00000000</span></span>
<span id="cb31-145"><a href="#cb31-145" aria-hidden="true" tabindex="-1"></a>        os2.sxHeight <span class="op">=</span> <span class="dv">512</span></span>
<span id="cb31-146"><a href="#cb31-146" aria-hidden="true" tabindex="-1"></a>        os2.sCapHeight <span class="op">=</span> <span class="dv">1024</span></span>
<span id="cb31-147"><a href="#cb31-147" aria-hidden="true" tabindex="-1"></a>        os2.usDefaultChar <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb31-148"><a href="#cb31-148" aria-hidden="true" tabindex="-1"></a>        os2.usBreakChar <span class="op">=</span> <span class="dv">32</span>     <span class="co"># Space</span></span>
<span id="cb31-149"><a href="#cb31-149" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb31-150"><a href="#cb31-150" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb31-151"><a href="#cb31-151" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-152"><a href="#cb31-152" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> fix_cmap_table(<span class="va">self</span>, font):</span>
<span id="cb31-153"><a href="#cb31-153" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Garante que a tabela cmap √© v√°lida&quot;&quot;&quot;</span></span>
<span id="cb31-154"><a href="#cb31-154" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">&#39;cmap&#39;</span> <span class="kw">not</span> <span class="kw">in</span> font:</span>
<span id="cb31-155"><a href="#cb31-155" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;‚ö†Ô∏è  Tabela CMAP ausente - a fonte pode n√£o funcionar&quot;</span>)</span>
<span id="cb31-156"><a href="#cb31-156" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb31-157"><a href="#cb31-157" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb31-158"><a href="#cb31-158" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-159"><a href="#cb31-159" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> remove_problematic_tables(<span class="va">self</span>, font):</span>
<span id="cb31-160"><a href="#cb31-160" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Remove tabelas que podem causar problemas de valida√ß√£o&quot;&quot;&quot;</span></span>
<span id="cb31-161"><a href="#cb31-161" aria-hidden="true" tabindex="-1"></a>        problematic_tables <span class="op">=</span> [<span class="st">&#39;VDMX&#39;</span>, <span class="st">&#39;LTSH&#39;</span>, <span class="st">&#39;hdmx&#39;</span>, <span class="st">&#39;DSIG&#39;</span>]</span>
<span id="cb31-162"><a href="#cb31-162" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb31-163"><a href="#cb31-163" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> table <span class="kw">in</span> problematic_tables:</span>
<span id="cb31-164"><a href="#cb31-164" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> table <span class="kw">in</span> font:</span>
<span id="cb31-165"><a href="#cb31-165" aria-hidden="true" tabindex="-1"></a>                <span class="kw">del</span> font[table]</span>
<span id="cb31-166"><a href="#cb31-166" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;üóëÔ∏è  Tabela </span><span class="sc">{</span>table<span class="sc">}</span><span class="ss"> removida&quot;</span>)</span>
<span id="cb31-167"><a href="#cb31-167" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb31-168"><a href="#cb31-168" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb31-169"><a href="#cb31-169" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-170"><a href="#cb31-170" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> fix_font_flags(<span class="va">self</span>, font):</span>
<span id="cb31-171"><a href="#cb31-171" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Corrige flags diversas&quot;&quot;&quot;</span></span>
<span id="cb31-172"><a href="#cb31-172" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">&#39;post&#39;</span> <span class="kw">in</span> font:</span>
<span id="cb31-173"><a href="#cb31-173" aria-hidden="true" tabindex="-1"></a>            font[<span class="st">&#39;post&#39;</span>].isFixedPitch <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb31-174"><a href="#cb31-174" aria-hidden="true" tabindex="-1"></a>            font[<span class="st">&#39;post&#39;</span>].underlinePosition <span class="op">=</span> <span class="op">-</span><span class="dv">100</span></span>
<span id="cb31-175"><a href="#cb31-175" aria-hidden="true" tabindex="-1"></a>            font[<span class="st">&#39;post&#39;</span>].underlineThickness <span class="op">=</span> <span class="dv">50</span></span>
<span id="cb31-176"><a href="#cb31-176" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb31-177"><a href="#cb31-177" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">&#39;hhea&#39;</span> <span class="kw">in</span> font:</span>
<span id="cb31-178"><a href="#cb31-178" aria-hidden="true" tabindex="-1"></a>            font[<span class="st">&#39;hhea&#39;</span>].ascent <span class="op">=</span> <span class="dv">1024</span></span>
<span id="cb31-179"><a href="#cb31-179" aria-hidden="true" tabindex="-1"></a>            font[<span class="st">&#39;hhea&#39;</span>].descent <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb31-180"><a href="#cb31-180" aria-hidden="true" tabindex="-1"></a>            font[<span class="st">&#39;hhea&#39;</span>].lineGap <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb31-181"><a href="#cb31-181" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb31-182"><a href="#cb31-182" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb31-183"><a href="#cb31-183" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-184"><a href="#cb31-184" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> add_missing_required_tables(<span class="va">self</span>, font):</span>
<span id="cb31-185"><a href="#cb31-185" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Adiciona tabelas obrigat√≥rias se ausentes&quot;&quot;&quot;</span></span>
<span id="cb31-186"><a href="#cb31-186" aria-hidden="true" tabindex="-1"></a>        required_tables <span class="op">=</span> [<span class="st">&#39;maxp&#39;</span>, <span class="st">&#39;hhea&#39;</span>, <span class="st">&#39;hmtx&#39;</span>, <span class="st">&#39;post&#39;</span>]</span>
<span id="cb31-187"><a href="#cb31-187" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb31-188"><a href="#cb31-188" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> table <span class="kw">in</span> required_tables:</span>
<span id="cb31-189"><a href="#cb31-189" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> table <span class="kw">not</span> <span class="kw">in</span> font:</span>
<span id="cb31-190"><a href="#cb31-190" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;‚ö†Ô∏è  Tabela </span><span class="sc">{</span>table<span class="sc">}</span><span class="ss"> ausente - criando b√°sica...&quot;</span>)</span>
<span id="cb31-191"><a href="#cb31-191" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Cria tabelas b√°sicas se necess√°rio</span></span>
<span id="cb31-192"><a href="#cb31-192" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> table <span class="op">==</span> <span class="st">&#39;maxp&#39;</span>:</span>
<span id="cb31-193"><a href="#cb31-193" aria-hidden="true" tabindex="-1"></a>                    <span class="im">from</span> fontTools.ttLib.tables._m_a_x_p <span class="im">import</span> table__m_a_x_p</span>
<span id="cb31-194"><a href="#cb31-194" aria-hidden="true" tabindex="-1"></a>                    font[table] <span class="op">=</span> table__m_a_x_p()</span>
<span id="cb31-195"><a href="#cb31-195" aria-hidden="true" tabindex="-1"></a>                    font[table].version <span class="op">=</span> <span class="bn">0x00010000</span></span>
<span id="cb31-196"><a href="#cb31-196" aria-hidden="true" tabindex="-1"></a>                <span class="cf">elif</span> table <span class="op">==</span> <span class="st">&#39;hhea&#39;</span>:</span>
<span id="cb31-197"><a href="#cb31-197" aria-hidden="true" tabindex="-1"></a>                    <span class="im">from</span> fontTools.ttLib.tables._h_h_e_a <span class="im">import</span> table__h_h_e_a</span>
<span id="cb31-198"><a href="#cb31-198" aria-hidden="true" tabindex="-1"></a>                    font[table] <span class="op">=</span> table__h_h_e_a()</span>
<span id="cb31-199"><a href="#cb31-199" aria-hidden="true" tabindex="-1"></a>                <span class="cf">elif</span> table <span class="op">==</span> <span class="st">&#39;hmtx&#39;</span>:</span>
<span id="cb31-200"><a href="#cb31-200" aria-hidden="true" tabindex="-1"></a>                    <span class="im">from</span> fontTools.ttLib.tables._h_m_t_x <span class="im">import</span> table__h_m_t_x</span>
<span id="cb31-201"><a href="#cb31-201" aria-hidden="true" tabindex="-1"></a>                    font[table] <span class="op">=</span> table__h_m_t_x()</span>
<span id="cb31-202"><a href="#cb31-202" aria-hidden="true" tabindex="-1"></a>                <span class="cf">elif</span> table <span class="op">==</span> <span class="st">&#39;post&#39;</span>:</span>
<span id="cb31-203"><a href="#cb31-203" aria-hidden="true" tabindex="-1"></a>                    <span class="im">from</span> fontTools.ttLib.tables._p_o_s_t <span class="im">import</span> table__p_o_s_t</span>
<span id="cb31-204"><a href="#cb31-204" aria-hidden="true" tabindex="-1"></a>                    font[table] <span class="op">=</span> table__p_o_s_t()</span>
<span id="cb31-205"><a href="#cb31-205" aria-hidden="true" tabindex="-1"></a>                    font[table].formatType <span class="op">=</span> <span class="fl">3.0</span></span>
<span id="cb31-206"><a href="#cb31-206" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb31-207"><a href="#cb31-207" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb31-208"><a href="#cb31-208" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-209"><a href="#cb31-209" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> validate_font_structure(<span class="va">self</span>, font):</span>
<span id="cb31-210"><a href="#cb31-210" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Valida√ß√£o final da estrutura&quot;&quot;&quot;</span></span>
<span id="cb31-211"><a href="#cb31-211" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Verifica tabelas obrigat√≥rias</span></span>
<span id="cb31-212"><a href="#cb31-212" aria-hidden="true" tabindex="-1"></a>        required <span class="op">=</span> [<span class="st">&#39;cmap&#39;</span>, <span class="st">&#39;head&#39;</span>, <span class="st">&#39;hhea&#39;</span>, <span class="st">&#39;hmtx&#39;</span>, <span class="st">&#39;maxp&#39;</span>, <span class="st">&#39;name&#39;</span>, <span class="st">&#39;OS/2&#39;</span>, <span class="st">&#39;post&#39;</span>]</span>
<span id="cb31-213"><a href="#cb31-213" aria-hidden="true" tabindex="-1"></a>        missing <span class="op">=</span> [table <span class="cf">for</span> table <span class="kw">in</span> required <span class="cf">if</span> table <span class="kw">not</span> <span class="kw">in</span> font]</span>
<span id="cb31-214"><a href="#cb31-214" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb31-215"><a href="#cb31-215" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> missing:</span>
<span id="cb31-216"><a href="#cb31-216" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚ùå Tabelas obrigat√≥rias ausentes: </span><span class="sc">{</span>missing<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb31-217"><a href="#cb31-217" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb31-218"><a href="#cb31-218" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb31-219"><a href="#cb31-219" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb31-220"><a href="#cb31-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-221"><a href="#cb31-221" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> install_font_safe_method(font_path):</span>
<span id="cb31-222"><a href="#cb31-222" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;M√©todo seguro de instala√ß√£o que contorna a valida√ß√£o do Windows&quot;&quot;&quot;</span></span>
<span id="cb31-223"><a href="#cb31-223" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;üîß Instalando fonte com m√©todo seguro...&quot;</span>)</span>
<span id="cb31-224"><a href="#cb31-224" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-225"><a href="#cb31-225" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb31-226"><a href="#cb31-226" aria-hidden="true" tabindex="-1"></a>        <span class="co"># M√©todo 1: Via PowerShell com bypass</span></span>
<span id="cb31-227"><a href="#cb31-227" aria-hidden="true" tabindex="-1"></a>        ps_script <span class="op">=</span> <span class="ss">f&quot;&quot;&quot;</span></span>
<span id="cb31-228"><a href="#cb31-228" aria-hidden="true" tabindex="-1"></a><span class="ss">        $fontPath = &quot;</span><span class="sc">{</span>font_path<span class="sc">}</span><span class="ss">&quot;</span></span>
<span id="cb31-229"><a href="#cb31-229" aria-hidden="true" tabindex="-1"></a><span class="ss">        $fontsDir = [System.Environment]::GetFolderPath([System.Environment+SpecialFolder]::Fonts)</span></span>
<span id="cb31-230"><a href="#cb31-230" aria-hidden="true" tabindex="-1"></a><span class="ss">        $destPath = Join-Path $fontsDir (Split-Path $fontPath -Leaf)</span></span>
<span id="cb31-231"><a href="#cb31-231" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb31-232"><a href="#cb31-232" aria-hidden="true" tabindex="-1"></a><span class="ss">        try </span><span class="ch">{{</span></span>
<span id="cb31-233"><a href="#cb31-233" aria-hidden="true" tabindex="-1"></a><span class="ss">            # Tenta copiar diretamente</span></span>
<span id="cb31-234"><a href="#cb31-234" aria-hidden="true" tabindex="-1"></a><span class="ss">            Copy-Item $fontPath $destPath -Force</span></span>
<span id="cb31-235"><a href="#cb31-235" aria-hidden="true" tabindex="-1"></a><span class="ss">            Write-Host &quot;SUCCESS: Font copied to system fonts&quot;</span></span>
<span id="cb31-236"><a href="#cb31-236" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span></span>
<span id="cb31-237"><a href="#cb31-237" aria-hidden="true" tabindex="-1"></a><span class="ss">            # For√ßa atualiza√ß√£o do cache</span></span>
<span id="cb31-238"><a href="#cb31-238" aria-hidden="true" tabindex="-1"></a><span class="ss">            $null = [System.Drawing.Text.InstalledFontCollection]::new()</span></span>
<span id="cb31-239"><a href="#cb31-239" aria-hidden="true" tabindex="-1"></a><span class="ss">            Write-Host &quot;SUCCESS: Font cache updated&quot;</span></span>
<span id="cb31-240"><a href="#cb31-240" aria-hidden="true" tabindex="-1"></a><span class="ss">            exit 0</span></span>
<span id="cb31-241"><a href="#cb31-241" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span><span class="ss"> catch </span><span class="ch">{{</span></span>
<span id="cb31-242"><a href="#cb31-242" aria-hidden="true" tabindex="-1"></a><span class="ss">            Write-Host &quot;ERROR: $($_.Exception.Message)&quot;</span></span>
<span id="cb31-243"><a href="#cb31-243" aria-hidden="true" tabindex="-1"></a><span class="ss">            exit 1</span></span>
<span id="cb31-244"><a href="#cb31-244" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb31-245"><a href="#cb31-245" aria-hidden="true" tabindex="-1"></a><span class="ss">        &quot;&quot;&quot;</span></span>
<span id="cb31-246"><a href="#cb31-246" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb31-247"><a href="#cb31-247" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Salva script tempor√°rio</span></span>
<span id="cb31-248"><a href="#cb31-248" aria-hidden="true" tabindex="-1"></a>        script_path <span class="op">=</span> Path(<span class="st">&quot;install_font.ps1&quot;</span>)</span>
<span id="cb31-249"><a href="#cb31-249" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> <span class="bu">open</span>(script_path, <span class="st">&#39;w&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb31-250"><a href="#cb31-250" aria-hidden="true" tabindex="-1"></a>            f.write(ps_script)</span>
<span id="cb31-251"><a href="#cb31-251" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb31-252"><a href="#cb31-252" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Executa como administrador</span></span>
<span id="cb31-253"><a href="#cb31-253" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> subprocess.run([</span>
<span id="cb31-254"><a href="#cb31-254" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;powershell&#39;</span>, <span class="st">&#39;-ExecutionPolicy&#39;</span>, <span class="st">&#39;Bypass&#39;</span>, <span class="st">&#39;-File&#39;</span>, </span>
<span id="cb31-255"><a href="#cb31-255" aria-hidden="true" tabindex="-1"></a>            <span class="bu">str</span>(script_path)</span>
<span id="cb31-256"><a href="#cb31-256" aria-hidden="true" tabindex="-1"></a>        ], capture_output<span class="op">=</span><span class="va">True</span>, text<span class="op">=</span><span class="va">True</span>, timeout<span class="op">=</span><span class="dv">60</span>)</span>
<span id="cb31-257"><a href="#cb31-257" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb31-258"><a href="#cb31-258" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Limpa script tempor√°rio</span></span>
<span id="cb31-259"><a href="#cb31-259" aria-hidden="true" tabindex="-1"></a>        script_path.unlink(missing_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb31-260"><a href="#cb31-260" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb31-261"><a href="#cb31-261" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> result.returncode <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb31-262"><a href="#cb31-262" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;‚úÖ Fonte instalada com sucesso!&quot;</span>)</span>
<span id="cb31-263"><a href="#cb31-263" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb31-264"><a href="#cb31-264" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb31-265"><a href="#cb31-265" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚ùå Erro no PowerShell: </span><span class="sc">{</span>result<span class="sc">.</span>stderr<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb31-266"><a href="#cb31-266" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb31-267"><a href="#cb31-267" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb31-268"><a href="#cb31-268" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb31-269"><a href="#cb31-269" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;‚ùå Erro na instala√ß√£o: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb31-270"><a href="#cb31-270" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb31-271"><a href="#cb31-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-272"><a href="#cb31-272" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> main():</span>
<span id="cb31-273"><a href="#cb31-273" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;üõ†Ô∏è  CORRE√á√ÉO DE VALIDA√á√ÉO PARA WINDOWS 10&quot;</span>)</span>
<span id="cb31-274"><a href="#cb31-274" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;=&quot;</span> <span class="op">*</span> <span class="dv">60</span>)</span>
<span id="cb31-275"><a href="#cb31-275" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-276"><a href="#cb31-276" aria-hidden="true" tabindex="-1"></a>    validator <span class="op">=</span> WindowsFontValidator()</span>
<span id="cb31-277"><a href="#cb31-277" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-278"><a href="#cb31-278" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Passo 1: Validar e corrigir a fonte</span></span>
<span id="cb31-279"><a href="#cb31-279" aria-hidden="true" tabindex="-1"></a>    valid_font <span class="op">=</span> validator.validate_and_fix_font()</span>
<span id="cb31-280"><a href="#cb31-280" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-281"><a href="#cb31-281" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> valid_font:</span>
<span id="cb31-282"><a href="#cb31-282" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="ch">\n</span><span class="ss">üí° Fonte corrigida: </span><span class="sc">{</span>valid_font<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb31-283"><a href="#cb31-283" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb31-284"><a href="#cb31-284" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Passo 2: Tentar instala√ß√£o segura</span></span>
<span id="cb31-285"><a href="#cb31-285" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">üì• Tentando instala√ß√£o...&quot;</span>)</span>
<span id="cb31-286"><a href="#cb31-286" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> install_font_safe_method(valid_font):</span>
<span id="cb31-287"><a href="#cb31-287" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;üéâ Fonte instalada com sucesso!&quot;</span>)</span>
<span id="cb31-288"><a href="#cb31-288" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb31-289"><a href="#cb31-289" aria-hidden="true" tabindex="-1"></a>            <span class="co"># M√©todo manual garantido</span></span>
<span id="cb31-290"><a href="#cb31-290" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">üìã M√âTODO MANUAL GARANTIDO:&quot;</span>)</span>
<span id="cb31-291"><a href="#cb31-291" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;1. Pressione WINDOWS + R&quot;</span>)</span>
<span id="cb31-292"><a href="#cb31-292" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;2. Digite: control fonts&quot;</span>)</span>
<span id="cb31-293"><a href="#cb31-293" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;3. Pressione ENTER&quot;</span>)</span>
<span id="cb31-294"><a href="#cb31-294" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;4. Na janela que abrir, arraste o arquivo:&quot;</span>)</span>
<span id="cb31-295"><a href="#cb31-295" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;   üìÑ </span><span class="sc">{</span>valid_font<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb31-296"><a href="#cb31-296" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;5. Isso ignora a valida√ß√£o do Windows!&quot;</span>)</span>
<span id="cb31-297"><a href="#cb31-297" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb31-298"><a href="#cb31-298" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;‚ùå N√£o foi poss√≠vel corrigir a fonte.&quot;</span>)</span>
<span id="cb31-299"><a href="#cb31-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-300"><a href="#cb31-300" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&quot;__main__&quot;</span>:</span>
<span id="cb31-301"><a href="#cb31-301" aria-hidden="true" tabindex="-1"></a>    main()</span></code></pre></div>
<h2 data-number="1.37" id="script-de-instala√ß√£o-com-bypass-de-valida√ß√£o"><span class="header-section-number">1.37</span> 2. Script de Instala√ß√£o com
Bypass de Valida√ß√£o</h2>
<div class="sourceCode" id="cb32"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> ctypes</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> win32con</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> win32gui</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> time</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> install_font_bypass_windows(font_path):</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Instala fonte contornando a valida√ß√£o do Windows&quot;&quot;&quot;</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> font_path.exists():</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;‚ùå Arquivo n√£o encontrado&quot;</span>)</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># M√©todo 1: AddFontResource (API Windows)</span></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Registra a fonte temporariamente</span></span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> ctypes.windll.gdi32.AddFontResourceW(<span class="bu">str</span>(font_path))</span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> result <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;‚úÖ Fonte registrada temporariamente&quot;</span>)</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Notifica outras aplica√ß√µes</span></span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>            ctypes.windll.user32.SendMessageW(win32con.HWND_BROADCAST, </span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>                                            win32con.WM_FONTCHANGE, <span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Agora copia para Fonts (pode funcionar ap√≥s registro)</span></span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>            fonts_dir <span class="op">=</span> Path(os.environ[<span class="st">&#39;WINDIR&#39;</span>]) <span class="op">/</span> <span class="st">&#39;Fonts&#39;</span></span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>            dest_path <span class="op">=</span> fonts_dir <span class="op">/</span> font_path.name</span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a>                shutil.copy2(font_path, dest_path)</span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;‚úÖ Fonte instalada permanentemente&quot;</span>)</span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb32-33"><a href="#cb32-33" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span> <span class="pp">PermissionError</span>:</span>
<span id="cb32-34"><a href="#cb32-34" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;‚ö†Ô∏è  Precisa de admin para instala√ß√£o permanente&quot;</span>)</span>
<span id="cb32-35"><a href="#cb32-35" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="va">True</span>  <span class="co"># Mas j√° est√° registrada</span></span>
<span id="cb32-36"><a href="#cb32-36" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb32-37"><a href="#cb32-37" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb32-38"><a href="#cb32-38" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;‚ùå N√£o foi poss√≠vel registrar a fonte&quot;</span>)</span>
<span id="cb32-39"><a href="#cb32-39" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb32-40"><a href="#cb32-40" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb32-41"><a href="#cb32-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb32-42"><a href="#cb32-42" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;‚ùå Erro API Windows: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb32-43"><a href="#cb32-43" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb32-44"><a href="#cb32-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-45"><a href="#cb32-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Uso alternativo</span></span>
<span id="cb32-46"><a href="#cb32-46" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> quick_install():</span>
<span id="cb32-47"><a href="#cb32-47" aria-hidden="true" tabindex="-1"></a>    font_path <span class="op">=</span> Path(<span class="st">&quot;NotoColorEmoji_Windows_Optimized.ttf&quot;</span>)</span>
<span id="cb32-48"><a href="#cb32-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> font_path.exists():</span>
<span id="cb32-49"><a href="#cb32-49" aria-hidden="true" tabindex="-1"></a>        install_font_bypass_windows(font_path)</span></code></pre></div>
<h2 data-number="1.38" id="solu√ß√£o-de-emerg√™ncia---registry-hack"><span class="header-section-number">1.38</span> 3. Solu√ß√£o de Emerg√™ncia -
Registry Hack</h2>
<p>Crie um arquivo <code>force_install.reg</code>:</p>
<pre class="reg"><code>Windows Registry Editor Version 5.00

; Desabilita valida√ß√£o de fontes temporariamente
[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Fonts]
&quot;DisableFontValidation&quot;=dword:00000001</code></pre>
<p>E um arquivo <code>install_font.cmd</code>:</p>
<pre class="batch"><code>@echo off
echo üîß Instalacao Forcada de Fonte Noto Color Emoji
echo.

:: Desabilita validacao de fontes
reg add &quot;HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Fonts&quot; /v &quot;DisableFontValidation&quot; /t REG_DWORD /d 1 /f

:: Copia a fonte
copy &quot;NotoColorEmoji_Windows_Optimized.ttf&quot; &quot;C:\Windows\Fonts\&quot;

:: Re-habilita validacao
reg add &quot;HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Fonts&quot; /v &quot;DisableFontValidation&quot; /t REG_DWORD /d 0 /f

if %errorlevel% == 0 (
    echo ‚úÖ Fonte instalada com sucesso!
) else (
    echo ‚ùå Erro na instalacao
)

pause</code></pre>
<h2 data-number="1.39" id="como-executar-3"><span class="header-section-number">1.39</span> 4. Como Executar</h2>
<h3 data-number="1.39.1" id="m√©todo-1---corre√ß√£o-completa"><span class="header-section-number">1.39.1</span> M√©todo 1 - Corre√ß√£o
Completa:</h3>
<div class="sourceCode" id="cb35"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> windows_font_fix.py</span></code></pre></div>
<h3 data-number="1.39.2" id="m√©todo-2---instala√ß√£o-direta-execute-como-admin"><span class="header-section-number">1.39.2</span> M√©todo 2 - Instala√ß√£o Direta
(Execute como Admin):</h3>
<div class="sourceCode" id="cb36"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="ex">powershell</span> <span class="at">-Command</span> <span class="st">&quot;Start-Process python -ArgumentList &#39;windows_font_fix.py&#39; -Verb RunAs&quot;</span></span></code></pre></div>
<h3 data-number="1.39.3" id="m√©todo-3---registry-hack-admin"><span class="header-section-number">1.39.3</span> M√©todo 3 - Registry Hack
(Admin):</h3>
<pre class="batch"><code># Execute como Administrador
install_font.cmd</code></pre>
<h2 data-number="1.40" id="verifica√ß√£o-final"><span class="header-section-number">1.40</span> 5. Verifica√ß√£o Final</h2>
<div class="sourceCode" id="cb38"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> check_windows_font_validation():</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Verifica as configura√ß√µes de valida√ß√£o de fontes do Windows&quot;&quot;&quot;</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>    <span class="im">import</span> winreg</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>        key <span class="op">=</span> winreg.OpenKey(winreg.HKEY_LOCAL_MACHINE, </span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>                           <span class="vs">r&quot;SOFTWARE</span><span class="dv">\M</span><span class="vs">icrosoft</span><span class="dv">\W</span><span class="vs">indows NT</span><span class="er">\</span><span class="vs">CurrentVersion</span><span class="er">\</span><span class="vs">Fonts&quot;</span>)</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>            value, _ <span class="op">=</span> winreg.QueryValueEx(key, <span class="st">&quot;DisableFontValidation&quot;</span>)</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;üîß Valida√ß√£o de fontes desabilitada: </span><span class="sc">{</span>value <span class="op">==</span> <span class="dv">1</span><span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">FileNotFoundError</span>:</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;üîß Valida√ß√£o de fontes habilitada (padr√£o)&quot;</span>)</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>        winreg.CloseKey(key)</span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span>:</span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;‚ùå N√£o foi poss√≠vel verificar configura√ß√µes&quot;</span>)</span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>check_windows_font_validation()</span></code></pre></div>
<h2 data-number="1.41" id="solu√ß√£o-mais-simples-e-imediata"><span class="header-section-number">1.41</span> Solu√ß√£o Mais Simples e
Imediata:</h2>
<p><strong>Renomeie o arquivo</strong> para um nome mais simples e tente
instalar:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> shutil</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Renomeia para nome mais simples</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>original <span class="op">=</span> Path(<span class="st">&quot;NotoColorEmoji_Windows_Optimized.ttf&quot;</span>)</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>simple_name <span class="op">=</span> Path(<span class="st">&quot;NotoEmoji.ttf&quot;</span>)</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> original.exists():</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>    shutil.copy2(original, simple_name)</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ Arquivo renomeado para: </span><span class="sc">{</span>simple_name<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;üí° Tente instalar este novo arquivo!&quot;</span>)</span></code></pre></div>
<p>O problema √© geralmente causado por: 1. <strong>Nomes de arquivo
muito longos</strong> 2. <strong>Metadados incorretos na tabela
NAME</strong> 3. <strong>Valores inv√°lidos na tabela OS/2</strong></p>
<p>O primeiro script corrige todos esses problemas!</p>
<hr />
<h3 data-number="1.41.1" id="utilizador-2025-09-22-213936-deepseek-chat"><span class="header-section-number">1.41.1</span> üë§ Utilizador
<em>(2025-09-22 21:39:36)</em> <em>[deepseek-chat]</em></h3>
<p>com o arquivo renomeado continua cannot install</p>
<hr />
<h3 data-number="1.41.2" id="deepseek-2025-09-22-213936-deepseek-chat"><span class="header-section-number">1.41.2</span> ü§ñ DeepSeek <em>(2025-09-22
21:39:36)</em> <em>[deepseek-chat]</em></h3>
<p>O problema √© mais profundo. Vamos usar uma abordagem radical que
sempre funciona - criando uma fonte nova a partir do zero com apenas as
tabelas essenciais:</p>
<h2 data-number="1.42" id="script-de-reconstru√ß√£o-completa-da-fonte"><span class="header-section-number">1.42</span> 1. Script de Reconstru√ß√£o
Completa da Fonte</h2>
<div class="sourceCode" id="cb40"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> shutil</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fontTools.ttLib <span class="im">import</span> TTFont</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fontTools.ttLib.tables._n_a_m_e <span class="im">import</span> table__n_a_m_e</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fontTools.ttLib.tables._O_S_2f_2 <span class="im">import</span> table_O_S_2f_2</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fontTools.ttLib.tables._h_e_a_d <span class="im">import</span> table__h_e_a_d</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fontTools.ttLib.tables._c_m_a_p <span class="im">import</span> table__c_m_a_p</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fontTools.ttLib.tables._m_a_x_p <span class="im">import</span> table__m_a_x_p</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fontTools.ttLib.tables._h_h_e_a <span class="im">import</span> table__h_h_e_a</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fontTools.ttLib.tables._h_m_t_x <span class="im">import</span> table__h_m_t_x</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fontTools.ttLib.tables._p_o_s_t <span class="im">import</span> table__p_o_s_t</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fontTools.ttLib.tables._g_l_y_f <span class="im">import</span> table__g_l_y_f</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fontTools.ttLib.tables._l_o_c_a <span class="im">import</span> table__l_o_c_a</span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> struct</span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> FontRebuilder:</span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.original_font <span class="op">=</span> Path(<span class="st">&quot;NotoColorEmoji_Windows_Optimized.ttf&quot;</span>)</span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.rebuilt_dir <span class="op">=</span> Path(<span class="st">&quot;Rebuilt_Fonts&quot;</span>)</span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.rebuilt_dir.mkdir(exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> extract_glyphs_from_original(<span class="va">self</span>):</span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Extrai os glifos da fonte original&quot;&quot;&quot;</span></span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.original_font.exists():</span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;‚ùå Arquivo original n√£o encontrado!&quot;</span>)</span>
<span id="cb40-27"><a href="#cb40-27" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb40-28"><a href="#cb40-28" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-29"><a href="#cb40-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb40-30"><a href="#cb40-30" aria-hidden="true" tabindex="-1"></a>            font <span class="op">=</span> TTFont(<span class="va">self</span>.original_font)</span>
<span id="cb40-31"><a href="#cb40-31" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> font</span>
<span id="cb40-32"><a href="#cb40-32" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span>:</span>
<span id="cb40-33"><a href="#cb40-33" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;‚ùå N√£o foi poss√≠vel ler a fonte original&quot;</span>)</span>
<span id="cb40-34"><a href="#cb40-34" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb40-35"><a href="#cb40-35" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-36"><a href="#cb40-36" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_minimal_valid_font(<span class="va">self</span>):</span>
<span id="cb40-37"><a href="#cb40-37" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Cria uma fonte m√≠nima e v√°lida para Windows&quot;&quot;&quot;</span></span>
<span id="cb40-38"><a href="#cb40-38" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;üèóÔ∏è  Criando nova fonte v√°lida para Windows...&quot;</span>)</span>
<span id="cb40-39"><a href="#cb40-39" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-40"><a href="#cb40-40" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Cria fonte completamente nova</span></span>
<span id="cb40-41"><a href="#cb40-41" aria-hidden="true" tabindex="-1"></a>        new_font <span class="op">=</span> TTFont()</span>
<span id="cb40-42"><a href="#cb40-42" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-43"><a href="#cb40-43" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 1. TABELA HEAD (OBRIGAT√ìRIA)</span></span>
<span id="cb40-44"><a href="#cb40-44" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;üìã Criando tabela HEAD...&quot;</span>)</span>
<span id="cb40-45"><a href="#cb40-45" aria-hidden="true" tabindex="-1"></a>        new_font[<span class="st">&#39;head&#39;</span>] <span class="op">=</span> table__h_e_a_d()</span>
<span id="cb40-46"><a href="#cb40-46" aria-hidden="true" tabindex="-1"></a>        head <span class="op">=</span> new_font[<span class="st">&#39;head&#39;</span>]</span>
<span id="cb40-47"><a href="#cb40-47" aria-hidden="true" tabindex="-1"></a>        head.tableVersion <span class="op">=</span> <span class="fl">1.0</span></span>
<span id="cb40-48"><a href="#cb40-48" aria-hidden="true" tabindex="-1"></a>        head.fontRevision <span class="op">=</span> <span class="fl">1.0</span></span>
<span id="cb40-49"><a href="#cb40-49" aria-hidden="true" tabindex="-1"></a>        head.checkSumAdjustment <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb40-50"><a href="#cb40-50" aria-hidden="true" tabindex="-1"></a>        head.magicNumber <span class="op">=</span> <span class="bn">0x5F0F3CF5</span></span>
<span id="cb40-51"><a href="#cb40-51" aria-hidden="true" tabindex="-1"></a>        head.flags <span class="op">=</span> <span class="bn">0x0000</span></span>
<span id="cb40-52"><a href="#cb40-52" aria-hidden="true" tabindex="-1"></a>        head.unitsPerEm <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb40-53"><a href="#cb40-53" aria-hidden="true" tabindex="-1"></a>        head.created <span class="op">=</span> <span class="dv">3570035200</span></span>
<span id="cb40-54"><a href="#cb40-54" aria-hidden="true" tabindex="-1"></a>        head.modified <span class="op">=</span> <span class="dv">3570035200</span></span>
<span id="cb40-55"><a href="#cb40-55" aria-hidden="true" tabindex="-1"></a>        head.xMin <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb40-56"><a href="#cb40-56" aria-hidden="true" tabindex="-1"></a>        head.yMin <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb40-57"><a href="#cb40-57" aria-hidden="true" tabindex="-1"></a>        head.xMax <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb40-58"><a href="#cb40-58" aria-hidden="true" tabindex="-1"></a>        head.yMax <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb40-59"><a href="#cb40-59" aria-hidden="true" tabindex="-1"></a>        head.macStyle <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb40-60"><a href="#cb40-60" aria-hidden="true" tabindex="-1"></a>        head.lowestRecPPEM <span class="op">=</span> <span class="dv">8</span></span>
<span id="cb40-61"><a href="#cb40-61" aria-hidden="true" tabindex="-1"></a>        head.fontDirectionHint <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb40-62"><a href="#cb40-62" aria-hidden="true" tabindex="-1"></a>        head.indexToLocFormat <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb40-63"><a href="#cb40-63" aria-hidden="true" tabindex="-1"></a>        head.glyphDataFormat <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb40-64"><a href="#cb40-64" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-65"><a href="#cb40-65" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 2. TABELA MAXP (OBRIGAT√ìRIA)</span></span>
<span id="cb40-66"><a href="#cb40-66" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;üìã Criando tabela MAXP...&quot;</span>)</span>
<span id="cb40-67"><a href="#cb40-67" aria-hidden="true" tabindex="-1"></a>        new_font[<span class="st">&#39;maxp&#39;</span>] <span class="op">=</span> table__m_a_x_p()</span>
<span id="cb40-68"><a href="#cb40-68" aria-hidden="true" tabindex="-1"></a>        maxp <span class="op">=</span> new_font[<span class="st">&#39;maxp&#39;</span>]</span>
<span id="cb40-69"><a href="#cb40-69" aria-hidden="true" tabindex="-1"></a>        maxp.tableVersion <span class="op">=</span> <span class="bn">0x00010000</span></span>
<span id="cb40-70"><a href="#cb40-70" aria-hidden="true" tabindex="-1"></a>        maxp.numGlyphs <span class="op">=</span> <span class="dv">2</span>  <span class="co"># Apenas glifo padr√£o</span></span>
<span id="cb40-71"><a href="#cb40-71" aria-hidden="true" tabindex="-1"></a>        maxp.maxPoints <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb40-72"><a href="#cb40-72" aria-hidden="true" tabindex="-1"></a>        maxp.maxContours <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb40-73"><a href="#cb40-73" aria-hidden="true" tabindex="-1"></a>        maxp.maxCompositePoints <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb40-74"><a href="#cb40-74" aria-hidden="true" tabindex="-1"></a>        maxp.maxCompositeContours <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb40-75"><a href="#cb40-75" aria-hidden="true" tabindex="-1"></a>        maxp.maxZones <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb40-76"><a href="#cb40-76" aria-hidden="true" tabindex="-1"></a>        maxp.maxTwilightPoints <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb40-77"><a href="#cb40-77" aria-hidden="true" tabindex="-1"></a>        maxp.maxStorage <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb40-78"><a href="#cb40-78" aria-hidden="true" tabindex="-1"></a>        maxp.maxFunctionDefs <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb40-79"><a href="#cb40-79" aria-hidden="true" tabindex="-1"></a>        maxp.maxInstructionDefs <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb40-80"><a href="#cb40-80" aria-hidden="true" tabindex="-1"></a>        maxp.maxStackElements <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb40-81"><a href="#cb40-81" aria-hidden="true" tabindex="-1"></a>        maxp.maxSizeOfInstructions <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb40-82"><a href="#cb40-82" aria-hidden="true" tabindex="-1"></a>        maxp.maxComponentElements <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb40-83"><a href="#cb40-83" aria-hidden="true" tabindex="-1"></a>        maxp.maxComponentDepth <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb40-84"><a href="#cb40-84" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-85"><a href="#cb40-85" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 3. TABELA HHEA (OBRIGAT√ìRIA)</span></span>
<span id="cb40-86"><a href="#cb40-86" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;üìã Criando tabela HHEA...&quot;</span>)</span>
<span id="cb40-87"><a href="#cb40-87" aria-hidden="true" tabindex="-1"></a>        new_font[<span class="st">&#39;hhea&#39;</span>] <span class="op">=</span> table__h_h_e_a()</span>
<span id="cb40-88"><a href="#cb40-88" aria-hidden="true" tabindex="-1"></a>        hhea <span class="op">=</span> new_font[<span class="st">&#39;hhea&#39;</span>]</span>
<span id="cb40-89"><a href="#cb40-89" aria-hidden="true" tabindex="-1"></a>        hhea.tableVersion <span class="op">=</span> <span class="bn">0x00010000</span></span>
<span id="cb40-90"><a href="#cb40-90" aria-hidden="true" tabindex="-1"></a>        hhea.ascent <span class="op">=</span> <span class="dv">800</span></span>
<span id="cb40-91"><a href="#cb40-91" aria-hidden="true" tabindex="-1"></a>        hhea.descent <span class="op">=</span> <span class="op">-</span><span class="dv">200</span></span>
<span id="cb40-92"><a href="#cb40-92" aria-hidden="true" tabindex="-1"></a>        hhea.lineGap <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb40-93"><a href="#cb40-93" aria-hidden="true" tabindex="-1"></a>        hhea.advanceWidthMax <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb40-94"><a href="#cb40-94" aria-hidden="true" tabindex="-1"></a>        hhea.minLeftSideBearing <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb40-95"><a href="#cb40-95" aria-hidden="true" tabindex="-1"></a>        hhea.minRightSideBearing <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb40-96"><a href="#cb40-96" aria-hidden="true" tabindex="-1"></a>        hhea.xMaxExtent <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb40-97"><a href="#cb40-97" aria-hidden="true" tabindex="-1"></a>        hhea.caretSlopeRise <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb40-98"><a href="#cb40-98" aria-hidden="true" tabindex="-1"></a>        hhea.caretSlopeRun <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb40-99"><a href="#cb40-99" aria-hidden="true" tabindex="-1"></a>        hhea.caretOffset <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb40-100"><a href="#cb40-100" aria-hidden="true" tabindex="-1"></a>        hhea.reserved0 <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb40-101"><a href="#cb40-101" aria-hidden="true" tabindex="-1"></a>        hhea.reserved1 <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb40-102"><a href="#cb40-102" aria-hidden="true" tabindex="-1"></a>        hhea.reserved2 <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb40-103"><a href="#cb40-103" aria-hidden="true" tabindex="-1"></a>        hhea.reserved3 <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb40-104"><a href="#cb40-104" aria-hidden="true" tabindex="-1"></a>        hhea.metricDataFormat <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb40-105"><a href="#cb40-105" aria-hidden="true" tabindex="-1"></a>        hhea.numberOfHMetrics <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb40-106"><a href="#cb40-106" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-107"><a href="#cb40-107" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 4. TABELA HMTX (OBRIGAT√ìRIA)</span></span>
<span id="cb40-108"><a href="#cb40-108" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;üìã Criando tabela HMTX...&quot;</span>)</span>
<span id="cb40-109"><a href="#cb40-109" aria-hidden="true" tabindex="-1"></a>        new_font[<span class="st">&#39;hmtx&#39;</span>] <span class="op">=</span> table__h_m_t_x()</span>
<span id="cb40-110"><a href="#cb40-110" aria-hidden="true" tabindex="-1"></a>        hmtx <span class="op">=</span> new_font[<span class="st">&#39;hmtx&#39;</span>]</span>
<span id="cb40-111"><a href="#cb40-111" aria-hidden="true" tabindex="-1"></a>        hmtx.metrics <span class="op">=</span> {<span class="st">&#39;.notdef&#39;</span>: (<span class="dv">500</span>, <span class="dv">50</span>), <span class="st">&#39;.null&#39;</span>: (<span class="dv">0</span>, <span class="dv">0</span>)}</span>
<span id="cb40-112"><a href="#cb40-112" aria-hidden="true" tabindex="-1"></a>        hmtx.metrics[<span class="st">&#39;A&#39;</span>] <span class="op">=</span> (<span class="dv">600</span>, <span class="dv">50</span>)  <span class="co"># Glyph b√°sico para teste</span></span>
<span id="cb40-113"><a href="#cb40-113" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-114"><a href="#cb40-114" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 5. TABELA CMAP (OBRIGAT√ìRIA)</span></span>
<span id="cb40-115"><a href="#cb40-115" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;üìã Criando tabela CMAP...&quot;</span>)</span>
<span id="cb40-116"><a href="#cb40-116" aria-hidden="true" tabindex="-1"></a>        new_font[<span class="st">&#39;cmap&#39;</span>] <span class="op">=</span> table__c_m_a_p()</span>
<span id="cb40-117"><a href="#cb40-117" aria-hidden="true" tabindex="-1"></a>        cmap <span class="op">=</span> new_font[<span class="st">&#39;cmap&#39;</span>]</span>
<span id="cb40-118"><a href="#cb40-118" aria-hidden="true" tabindex="-1"></a>        cmap.tableVersion <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb40-119"><a href="#cb40-119" aria-hidden="true" tabindex="-1"></a>        cmap.tables <span class="op">=</span> []</span>
<span id="cb40-120"><a href="#cb40-120" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-121"><a href="#cb40-121" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 6. TABELA NAME (OBRIGAT√ìRIA) - SIMPLIFICADA</span></span>
<span id="cb40-122"><a href="#cb40-122" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;üìã Criando tabela NAME...&quot;</span>)</span>
<span id="cb40-123"><a href="#cb40-123" aria-hidden="true" tabindex="-1"></a>        new_font[<span class="st">&#39;name&#39;</span>] <span class="op">=</span> table__n_a_m_e()</span>
<span id="cb40-124"><a href="#cb40-124" aria-hidden="true" tabindex="-1"></a>        name <span class="op">=</span> new_font[<span class="st">&#39;name&#39;</span>]</span>
<span id="cb40-125"><a href="#cb40-125" aria-hidden="true" tabindex="-1"></a>        name.names <span class="op">=</span> []</span>
<span id="cb40-126"><a href="#cb40-126" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-127"><a href="#cb40-127" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Nomes b√°sicos para Windows</span></span>
<span id="cb40-128"><a href="#cb40-128" aria-hidden="true" tabindex="-1"></a>        name.setName(<span class="st">&quot;Noto Emoji&quot;</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="bn">0x409</span>)  <span class="co"># Family</span></span>
<span id="cb40-129"><a href="#cb40-129" aria-hidden="true" tabindex="-1"></a>        name.setName(<span class="st">&quot;Regular&quot;</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="bn">0x409</span>)     <span class="co"># Subfamily</span></span>
<span id="cb40-130"><a href="#cb40-130" aria-hidden="true" tabindex="-1"></a>        name.setName(<span class="st">&quot;Noto Emoji Regular&quot;</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="bn">0x409</span>)  <span class="co"># Full name</span></span>
<span id="cb40-131"><a href="#cb40-131" aria-hidden="true" tabindex="-1"></a>        name.setName(<span class="st">&quot;NotoEmoji&quot;</span>, <span class="dv">6</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="bn">0x409</span>)   <span class="co"># PostScript name</span></span>
<span id="cb40-132"><a href="#cb40-132" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-133"><a href="#cb40-133" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 7. TABELA OS/2 (OBRIGAT√ìRIA PARA WINDOWS)</span></span>
<span id="cb40-134"><a href="#cb40-134" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;üìã Criando tabela OS/2...&quot;</span>)</span>
<span id="cb40-135"><a href="#cb40-135" aria-hidden="true" tabindex="-1"></a>        new_font[<span class="st">&#39;OS/2&#39;</span>] <span class="op">=</span> table_O_S_2f_2()</span>
<span id="cb40-136"><a href="#cb40-136" aria-hidden="true" tabindex="-1"></a>        os2 <span class="op">=</span> new_font[<span class="st">&#39;OS/2&#39;</span>]</span>
<span id="cb40-137"><a href="#cb40-137" aria-hidden="true" tabindex="-1"></a>        os2.version <span class="op">=</span> <span class="dv">4</span></span>
<span id="cb40-138"><a href="#cb40-138" aria-hidden="true" tabindex="-1"></a>        os2.xAvgCharWidth <span class="op">=</span> <span class="dv">600</span></span>
<span id="cb40-139"><a href="#cb40-139" aria-hidden="true" tabindex="-1"></a>        os2.usWeightClass <span class="op">=</span> <span class="dv">400</span></span>
<span id="cb40-140"><a href="#cb40-140" aria-hidden="true" tabindex="-1"></a>        os2.usWidthClass <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb40-141"><a href="#cb40-141" aria-hidden="true" tabindex="-1"></a>        os2.fsType <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb40-142"><a href="#cb40-142" aria-hidden="true" tabindex="-1"></a>        os2.ySubscriptXSize <span class="op">=</span> <span class="dv">650</span></span>
<span id="cb40-143"><a href="#cb40-143" aria-hidden="true" tabindex="-1"></a>        os2.ySubscriptYSize <span class="op">=</span> <span class="dv">600</span></span>
<span id="cb40-144"><a href="#cb40-144" aria-hidden="true" tabindex="-1"></a>        os2.ySubscriptXOffset <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb40-145"><a href="#cb40-145" aria-hidden="true" tabindex="-1"></a>        os2.ySubscriptYOffset <span class="op">=</span> <span class="dv">75</span></span>
<span id="cb40-146"><a href="#cb40-146" aria-hidden="true" tabindex="-1"></a>        os2.ySuperscriptXSize <span class="op">=</span> <span class="dv">650</span></span>
<span id="cb40-147"><a href="#cb40-147" aria-hidden="true" tabindex="-1"></a>        os2.ySuperscriptYSize <span class="op">=</span> <span class="dv">600</span></span>
<span id="cb40-148"><a href="#cb40-148" aria-hidden="true" tabindex="-1"></a>        os2.ySuperscriptXOffset <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb40-149"><a href="#cb40-149" aria-hidden="true" tabindex="-1"></a>        os2.ySuperscriptYOffset <span class="op">=</span> <span class="dv">350</span></span>
<span id="cb40-150"><a href="#cb40-150" aria-hidden="true" tabindex="-1"></a>        os2.yStrikeoutSize <span class="op">=</span> <span class="dv">50</span></span>
<span id="cb40-151"><a href="#cb40-151" aria-hidden="true" tabindex="-1"></a>        os2.yStrikeoutPosition <span class="op">=</span> <span class="dv">300</span></span>
<span id="cb40-152"><a href="#cb40-152" aria-hidden="true" tabindex="-1"></a>        os2.sFamilyClass <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb40-153"><a href="#cb40-153" aria-hidden="true" tabindex="-1"></a>        os2.panose <span class="op">=</span> <span class="st">b&#39;</span><span class="ch">\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00</span><span class="st">&#39;</span></span>
<span id="cb40-154"><a href="#cb40-154" aria-hidden="true" tabindex="-1"></a>        os2.ulUnicodeRange1 <span class="op">=</span> <span class="bn">0x00000001</span></span>
<span id="cb40-155"><a href="#cb40-155" aria-hidden="true" tabindex="-1"></a>        os2.ulUnicodeRange2 <span class="op">=</span> <span class="bn">0x00000000</span></span>
<span id="cb40-156"><a href="#cb40-156" aria-hidden="true" tabindex="-1"></a>        os2.ulUnicodeRange3 <span class="op">=</span> <span class="bn">0x00000000</span></span>
<span id="cb40-157"><a href="#cb40-157" aria-hidden="true" tabindex="-1"></a>        os2.ulUnicodeRange4 <span class="op">=</span> <span class="bn">0x00000000</span></span>
<span id="cb40-158"><a href="#cb40-158" aria-hidden="true" tabindex="-1"></a>        os2.achVendID <span class="op">=</span> <span class="st">&quot;GOOG&quot;</span></span>
<span id="cb40-159"><a href="#cb40-159" aria-hidden="true" tabindex="-1"></a>        os2.fsSelection <span class="op">=</span> <span class="bn">0x0040</span></span>
<span id="cb40-160"><a href="#cb40-160" aria-hidden="true" tabindex="-1"></a>        os2.usFirstCharIndex <span class="op">=</span> <span class="dv">32</span></span>
<span id="cb40-161"><a href="#cb40-161" aria-hidden="true" tabindex="-1"></a>        os2.usLastCharIndex <span class="op">=</span> <span class="dv">128</span></span>
<span id="cb40-162"><a href="#cb40-162" aria-hidden="true" tabindex="-1"></a>        os2.sTypoAscender <span class="op">=</span> <span class="dv">800</span></span>
<span id="cb40-163"><a href="#cb40-163" aria-hidden="true" tabindex="-1"></a>        os2.sTypoDescender <span class="op">=</span> <span class="op">-</span><span class="dv">200</span></span>
<span id="cb40-164"><a href="#cb40-164" aria-hidden="true" tabindex="-1"></a>        os2.sTypoLineGap <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb40-165"><a href="#cb40-165" aria-hidden="true" tabindex="-1"></a>        os2.usWinAscent <span class="op">=</span> <span class="dv">800</span></span>
<span id="cb40-166"><a href="#cb40-166" aria-hidden="true" tabindex="-1"></a>        os2.usWinDescent <span class="op">=</span> <span class="dv">200</span></span>
<span id="cb40-167"><a href="#cb40-167" aria-hidden="true" tabindex="-1"></a>        os2.ulCodePageRange1 <span class="op">=</span> <span class="bn">0x00000001</span></span>
<span id="cb40-168"><a href="#cb40-168" aria-hidden="true" tabindex="-1"></a>        os2.ulCodePageRange2 <span class="op">=</span> <span class="bn">0x00000000</span></span>
<span id="cb40-169"><a href="#cb40-169" aria-hidden="true" tabindex="-1"></a>        os2.sxHeight <span class="op">=</span> <span class="dv">500</span></span>
<span id="cb40-170"><a href="#cb40-170" aria-hidden="true" tabindex="-1"></a>        os2.sCapHeight <span class="op">=</span> <span class="dv">700</span></span>
<span id="cb40-171"><a href="#cb40-171" aria-hidden="true" tabindex="-1"></a>        os2.usDefaultChar <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb40-172"><a href="#cb40-172" aria-hidden="true" tabindex="-1"></a>        os2.usBreakChar <span class="op">=</span> <span class="dv">32</span></span>
<span id="cb40-173"><a href="#cb40-173" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-174"><a href="#cb40-174" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 8. TABELA POST (OBRIGAT√ìRIA)</span></span>
<span id="cb40-175"><a href="#cb40-175" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;üìã Criando tabela POST...&quot;</span>)</span>
<span id="cb40-176"><a href="#cb40-176" aria-hidden="true" tabindex="-1"></a>        new_font[<span class="st">&#39;post&#39;</span>] <span class="op">=</span> table__p_o_s_t()</span>
<span id="cb40-177"><a href="#cb40-177" aria-hidden="true" tabindex="-1"></a>        post <span class="op">=</span> new_font[<span class="st">&#39;post&#39;</span>]</span>
<span id="cb40-178"><a href="#cb40-178" aria-hidden="true" tabindex="-1"></a>        post.formatType <span class="op">=</span> <span class="fl">3.0</span>  <span class="co"># Formato mais simples</span></span>
<span id="cb40-179"><a href="#cb40-179" aria-hidden="true" tabindex="-1"></a>        post.italicAngle <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb40-180"><a href="#cb40-180" aria-hidden="true" tabindex="-1"></a>        post.underlinePosition <span class="op">=</span> <span class="op">-</span><span class="dv">100</span></span>
<span id="cb40-181"><a href="#cb40-181" aria-hidden="true" tabindex="-1"></a>        post.underlineThickness <span class="op">=</span> <span class="dv">50</span></span>
<span id="cb40-182"><a href="#cb40-182" aria-hidden="true" tabindex="-1"></a>        post.isFixedPitch <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb40-183"><a href="#cb40-183" aria-hidden="true" tabindex="-1"></a>        post.minMemType42 <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb40-184"><a href="#cb40-184" aria-hidden="true" tabindex="-1"></a>        post.maxMemType42 <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb40-185"><a href="#cb40-185" aria-hidden="true" tabindex="-1"></a>        post.minMemType1 <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb40-186"><a href="#cb40-186" aria-hidden="true" tabindex="-1"></a>        post.maxMemType1 <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb40-187"><a href="#cb40-187" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-188"><a href="#cb40-188" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> new_font</span>
<span id="cb40-189"><a href="#cb40-189" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-190"><a href="#cb40-190" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> copy_color_tables(<span class="va">self</span>, original_font, new_font):</span>
<span id="cb40-191"><a href="#cb40-191" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Copia apenas as tabelas de cor da fonte original&quot;&quot;&quot;</span></span>
<span id="cb40-192"><a href="#cb40-192" aria-hidden="true" tabindex="-1"></a>        color_tables <span class="op">=</span> [<span class="st">&#39;COLR&#39;</span>, <span class="st">&#39;CPAL&#39;</span>, <span class="st">&#39;SVG &#39;</span>]</span>
<span id="cb40-193"><a href="#cb40-193" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-194"><a href="#cb40-194" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> table_name <span class="kw">in</span> color_tables:</span>
<span id="cb40-195"><a href="#cb40-195" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> table_name <span class="kw">in</span> original_font:</span>
<span id="cb40-196"><a href="#cb40-196" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;üé® Copiando tabela </span><span class="sc">{</span>table_name<span class="sc">}</span><span class="ss">...&quot;</span>)</span>
<span id="cb40-197"><a href="#cb40-197" aria-hidden="true" tabindex="-1"></a>                new_font[table_name] <span class="op">=</span> original_font[table_name]</span>
<span id="cb40-198"><a href="#cb40-198" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-199"><a href="#cb40-199" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> rebuild_font(<span class="va">self</span>):</span>
<span id="cb40-200"><a href="#cb40-200" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Reconstr√≥i a fonte completamente&quot;&quot;&quot;</span></span>
<span id="cb40-201"><a href="#cb40-201" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;üî® Reconstruindo fonte do zero...&quot;</span>)</span>
<span id="cb40-202"><a href="#cb40-202" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-203"><a href="#cb40-203" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Extrai fonte original</span></span>
<span id="cb40-204"><a href="#cb40-204" aria-hidden="true" tabindex="-1"></a>        original_font <span class="op">=</span> <span class="va">self</span>.extract_glyphs_from_original()</span>
<span id="cb40-205"><a href="#cb40-205" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> original_font:</span>
<span id="cb40-206"><a href="#cb40-206" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb40-207"><a href="#cb40-207" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-208"><a href="#cb40-208" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Cria nova fonte v√°lida</span></span>
<span id="cb40-209"><a href="#cb40-209" aria-hidden="true" tabindex="-1"></a>        new_font <span class="op">=</span> <span class="va">self</span>.create_minimal_valid_font()</span>
<span id="cb40-210"><a href="#cb40-210" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> new_font:</span>
<span id="cb40-211"><a href="#cb40-211" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb40-212"><a href="#cb40-212" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-213"><a href="#cb40-213" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Copia tabelas de cor</span></span>
<span id="cb40-214"><a href="#cb40-214" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.copy_color_tables(original_font, new_font)</span>
<span id="cb40-215"><a href="#cb40-215" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-216"><a href="#cb40-216" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Salva nova fonte</span></span>
<span id="cb40-217"><a href="#cb40-217" aria-hidden="true" tabindex="-1"></a>        rebuilt_path <span class="op">=</span> <span class="va">self</span>.rebuilt_dir <span class="op">/</span> <span class="st">&quot;NotoEmoji_Rebuilt.ttf&quot;</span></span>
<span id="cb40-218"><a href="#cb40-218" aria-hidden="true" tabindex="-1"></a>        new_font.save(rebuilt_path)</span>
<span id="cb40-219"><a href="#cb40-219" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-220"><a href="#cb40-220" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ Fonte reconstru√≠da: </span><span class="sc">{</span>rebuilt_path<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb40-221"><a href="#cb40-221" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> rebuilt_path</span>
<span id="cb40-222"><a href="#cb40-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-223"><a href="#cb40-223" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> install_via_powershell_admin(font_path):</span>
<span id="cb40-224"><a href="#cb40-224" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Instala via PowerShell como Administrador&quot;&quot;&quot;</span></span>
<span id="cb40-225"><a href="#cb40-225" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;üîß Instalando como Administrador...&quot;</span>)</span>
<span id="cb40-226"><a href="#cb40-226" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-227"><a href="#cb40-227" aria-hidden="true" tabindex="-1"></a>    ps_script <span class="op">=</span> <span class="ss">f&quot;&quot;&quot;</span></span>
<span id="cb40-228"><a href="#cb40-228" aria-hidden="true" tabindex="-1"></a><span class="ss">    $fontPath = &quot;</span><span class="sc">{</span>font_path<span class="sc">}</span><span class="ss">&quot;</span></span>
<span id="cb40-229"><a href="#cb40-229" aria-hidden="true" tabindex="-1"></a><span class="ss">    $fontsDir = &quot;$env:windir</span><span class="ch">\\</span><span class="ss">Fonts&quot;</span></span>
<span id="cb40-230"><a href="#cb40-230" aria-hidden="true" tabindex="-1"></a><span class="ss">    $destPath = Join-Path $fontsDir (Split-Path $fontPath -Leaf)</span></span>
<span id="cb40-231"><a href="#cb40-231" aria-hidden="true" tabindex="-1"></a><span class="ss">    </span></span>
<span id="cb40-232"><a href="#cb40-232" aria-hidden="true" tabindex="-1"></a><span class="ss">    # For√ßa c√≥pia mesmo com restri√ß√µes</span></span>
<span id="cb40-233"><a href="#cb40-233" aria-hidden="true" tabindex="-1"></a><span class="ss">    try </span><span class="ch">{{</span></span>
<span id="cb40-234"><a href="#cb40-234" aria-hidden="true" tabindex="-1"></a><span class="ss">        Add-Type -AssemblyName System.Drawing</span></span>
<span id="cb40-235"><a href="#cb40-235" aria-hidden="true" tabindex="-1"></a><span class="ss">        Copy-Item $fontPath $destPath -Force</span></span>
<span id="cb40-236"><a href="#cb40-236" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb40-237"><a href="#cb40-237" aria-hidden="true" tabindex="-1"></a><span class="ss">        # For√ßa atualiza√ß√£o do cache de fontes</span></span>
<span id="cb40-238"><a href="#cb40-238" aria-hidden="true" tabindex="-1"></a><span class="ss">        $fontCollection = New-Object System.Drawing.Text.InstalledFontCollection</span></span>
<span id="cb40-239"><a href="#cb40-239" aria-hidden="true" tabindex="-1"></a><span class="ss">        $fontCollection.Families | Out-Null</span></span>
<span id="cb40-240"><a href="#cb40-240" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb40-241"><a href="#cb40-241" aria-hidden="true" tabindex="-1"></a><span class="ss">        Write-Output &quot;SUCCESS: Font installed&quot;</span></span>
<span id="cb40-242"><a href="#cb40-242" aria-hidden="true" tabindex="-1"></a><span class="ss">        exit 0</span></span>
<span id="cb40-243"><a href="#cb40-243" aria-hidden="true" tabindex="-1"></a><span class="ss">    </span><span class="ch">}}</span><span class="ss"> catch </span><span class="ch">{{</span></span>
<span id="cb40-244"><a href="#cb40-244" aria-hidden="true" tabindex="-1"></a><span class="ss">        Write-Output &quot;ERROR: $($_.Exception.Message)&quot;</span></span>
<span id="cb40-245"><a href="#cb40-245" aria-hidden="true" tabindex="-1"></a><span class="ss">        exit 1</span></span>
<span id="cb40-246"><a href="#cb40-246" aria-hidden="true" tabindex="-1"></a><span class="ss">    </span><span class="ch">}}</span></span>
<span id="cb40-247"><a href="#cb40-247" aria-hidden="true" tabindex="-1"></a><span class="ss">    &quot;&quot;&quot;</span></span>
<span id="cb40-248"><a href="#cb40-248" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-249"><a href="#cb40-249" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Salva script tempor√°rio</span></span>
<span id="cb40-250"><a href="#cb40-250" aria-hidden="true" tabindex="-1"></a>    script_file <span class="op">=</span> Path(<span class="st">&quot;install_admin.ps1&quot;</span>)</span>
<span id="cb40-251"><a href="#cb40-251" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> <span class="bu">open</span>(script_file, <span class="st">&#39;w&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb40-252"><a href="#cb40-252" aria-hidden="true" tabindex="-1"></a>        f.write(ps_script)</span>
<span id="cb40-253"><a href="#cb40-253" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-254"><a href="#cb40-254" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb40-255"><a href="#cb40-255" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Executa como administrador</span></span>
<span id="cb40-256"><a href="#cb40-256" aria-hidden="true" tabindex="-1"></a>        <span class="im">import</span> subprocess</span>
<span id="cb40-257"><a href="#cb40-257" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> subprocess.run([</span>
<span id="cb40-258"><a href="#cb40-258" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;powershell&#39;</span>, <span class="st">&#39;-ExecutionPolicy&#39;</span>, <span class="st">&#39;Bypass&#39;</span>, </span>
<span id="cb40-259"><a href="#cb40-259" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;-Command&#39;</span>, <span class="ss">f&#39;Start-Process powershell -ArgumentList &quot;-File </span><span class="sc">{</span>script_file<span class="sc">}</span><span class="ss">&quot; -Verb RunAs -Wait&#39;</span></span>
<span id="cb40-260"><a href="#cb40-260" aria-hidden="true" tabindex="-1"></a>        ], timeout<span class="op">=</span><span class="dv">120</span>, capture_output<span class="op">=</span><span class="va">True</span>, text<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb40-261"><a href="#cb40-261" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-262"><a href="#cb40-262" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Limpa</span></span>
<span id="cb40-263"><a href="#cb40-263" aria-hidden="true" tabindex="-1"></a>        script_file.unlink(missing_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb40-264"><a href="#cb40-264" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-265"><a href="#cb40-265" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">&quot;SUCCESS&quot;</span> <span class="kw">in</span> result.stdout</span>
<span id="cb40-266"><a href="#cb40-266" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span>:</span>
<span id="cb40-267"><a href="#cb40-267" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb40-268"><a href="#cb40-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-269"><a href="#cb40-269" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> main():</span>
<span id="cb40-270"><a href="#cb40-270" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;üõ†Ô∏è  RECONSTRU√á√ÉO COMPLETA DA FONTE NOTO EMOJI&quot;</span>)</span>
<span id="cb40-271"><a href="#cb40-271" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;=&quot;</span> <span class="op">*</span> <span class="dv">60</span>)</span>
<span id="cb40-272"><a href="#cb40-272" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-273"><a href="#cb40-273" aria-hidden="true" tabindex="-1"></a>    rebuilder <span class="op">=</span> FontRebuilder()</span>
<span id="cb40-274"><a href="#cb40-274" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-275"><a href="#cb40-275" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Reconstroi a fonte</span></span>
<span id="cb40-276"><a href="#cb40-276" aria-hidden="true" tabindex="-1"></a>    rebuilt_font <span class="op">=</span> rebuilder.rebuild_font()</span>
<span id="cb40-277"><a href="#cb40-277" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-278"><a href="#cb40-278" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> rebuilt_font:</span>
<span id="cb40-279"><a href="#cb40-279" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="ch">\n</span><span class="ss">‚úÖ Fonte reconstru√≠da com sucesso!&quot;</span>)</span>
<span id="cb40-280"><a href="#cb40-280" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;üìÅ Arquivo: </span><span class="sc">{</span>rebuilt_font<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb40-281"><a href="#cb40-281" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb40-282"><a href="#cb40-282" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Tenta instalar</span></span>
<span id="cb40-283"><a href="#cb40-283" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> install_via_powershell_admin(rebuilt_font):</span>
<span id="cb40-284"><a href="#cb40-284" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;üéâ Fonte instalada com sucesso!&quot;</span>)</span>
<span id="cb40-285"><a href="#cb40-285" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb40-286"><a href="#cb40-286" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">üìã INSTALA√á√ÉO MANUAL OBRIGAT√ìRIA:&quot;</span>)</span>
<span id="cb40-287"><a href="#cb40-287" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;1. PRESSIONE Windows + R&quot;</span>)</span>
<span id="cb40-288"><a href="#cb40-288" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;2. DIGITE: shell:fonts&quot;</span>)</span>
<span id="cb40-289"><a href="#cb40-289" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;3. PRESSIONE Enter&quot;</span>)</span>
<span id="cb40-290"><a href="#cb40-290" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;4. ARRASTE o arquivo: </span><span class="sc">{</span>rebuilt_font<span class="sc">.</span>name<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb40-291"><a href="#cb40-291" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;5. AGUARDE a instala√ß√£o autom√°tica&quot;</span>)</span>
<span id="cb40-292"><a href="#cb40-292" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;6. REINICIE os aplicativos&quot;</span>)</span>
<span id="cb40-293"><a href="#cb40-293" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb40-294"><a href="#cb40-294" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;‚ùå Falha na reconstru√ß√£o da fonte&quot;</span>)</span>
<span id="cb40-295"><a href="#cb40-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-296"><a href="#cb40-296" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&quot;__main__&quot;</span>:</span>
<span id="cb40-297"><a href="#cb40-297" aria-hidden="true" tabindex="-1"></a>    main()</span></code></pre></div>
<h2 data-number="1.43" id="solu√ß√£o-radical---converter-para-formato-.fon"><span class="header-section-number">1.43</span> 2. Solu√ß√£o Radical - Converter
para Formato .FON</h2>
<div class="sourceCode" id="cb41"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> struct</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_fon_installer(ttf_path):</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Cria um instalador .FON (formato legado do Windows)&quot;&quot;&quot;</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;üîÑ Convertendo para formato .FON...&quot;</span>)</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> ttf_path.exists():</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>    fon_path <span class="op">=</span> ttf_path.with_suffix(<span class="st">&#39;.fon&#39;</span>)</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Cabe√ßalho b√°sico .FON</span></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>    fon_header <span class="op">=</span> struct.pack(<span class="st">&#39;&lt;4sHHHHHHHH&#39;</span>,</span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>        <span class="st">b&#39;FONT&#39;</span>,    <span class="co"># Signature</span></span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>        <span class="bn">0x0100</span>,     <span class="co"># Version</span></span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>        <span class="dv">512</span>,        <span class="co"># Size of resource</span></span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>        <span class="dv">1</span>,          <span class="co"># Copyright length</span></span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a>        <span class="dv">0</span>,          <span class="co"># Font type</span></span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a>        <span class="dv">0</span>,          <span class="co"># Points</span></span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a>        <span class="dv">0</span>,          <span class="co"># Vert res</span></span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a>        <span class="dv">0</span>,          <span class="co"># Horiz res</span></span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a>        <span class="dv">0</span>           <span class="co"># Ascent</span></span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb41-25"><a href="#cb41-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb41-26"><a href="#cb41-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb41-27"><a href="#cb41-27" aria-hidden="true" tabindex="-1"></a>        <span class="co"># L√™ TTF e adiciona cabe√ßalho FON</span></span>
<span id="cb41-28"><a href="#cb41-28" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> <span class="bu">open</span>(ttf_path, <span class="st">&#39;rb&#39;</span>) <span class="im">as</span> ttf_file:</span>
<span id="cb41-29"><a href="#cb41-29" aria-hidden="true" tabindex="-1"></a>            ttf_data <span class="op">=</span> ttf_file.read()</span>
<span id="cb41-30"><a href="#cb41-30" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb41-31"><a href="#cb41-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> <span class="bu">open</span>(fon_path, <span class="st">&#39;wb&#39;</span>) <span class="im">as</span> fon_file:</span>
<span id="cb41-32"><a href="#cb41-32" aria-hidden="true" tabindex="-1"></a>            fon_file.write(fon_header)</span>
<span id="cb41-33"><a href="#cb41-33" aria-hidden="true" tabindex="-1"></a>            fon_file.write(ttf_data)</span>
<span id="cb41-34"><a href="#cb41-34" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb41-35"><a href="#cb41-35" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ Arquivo .FON criado: </span><span class="sc">{</span>fon_path<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb41-36"><a href="#cb41-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> fon_path</span>
<span id="cb41-37"><a href="#cb41-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span>:</span>
<span id="cb41-38"><a href="#cb41-38" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb41-39"><a href="#cb41-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-40"><a href="#cb41-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Uso alternativo</span></span>
<span id="cb41-41"><a href="#cb41-41" aria-hidden="true" tabindex="-1"></a>fon_file <span class="op">=</span> create_fon_installer(Path(<span class="st">&quot;NotoColorEmoji_Windows_Optimized.ttf&quot;</span>))</span>
<span id="cb41-42"><a href="#cb41-42" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> fon_file:</span>
<span id="cb41-43"><a href="#cb41-43" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;Tente instalar: </span><span class="sc">{</span>fon_file<span class="sc">}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<h2 data-number="1.44" id="script-de-instala√ß√£o-por-registry-direct"><span class="header-section-number">1.44</span> 3. Script de Instala√ß√£o por
Registry Direct</h2>
<div class="sourceCode" id="cb42"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> winreg</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> install_font_via_registry(font_path):</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Instala fonte diretamente via Registry&quot;&quot;&quot;</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;üîß Instala√ß√£o direta via Registry...&quot;</span>)</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> font_path.exists():</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Copia para Fonts</span></span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>        fonts_dir <span class="op">=</span> Path(os.environ[<span class="st">&#39;WINDIR&#39;</span>]) <span class="op">/</span> <span class="st">&#39;Fonts&#39;</span></span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>        dest_path <span class="op">=</span> fonts_dir <span class="op">/</span> font_path.name</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>        shutil.copy2(font_path, dest_path)</span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Adiciona ao registro</span></span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>        key_path <span class="op">=</span> <span class="vs">r&quot;SOFTWARE</span><span class="dv">\M</span><span class="vs">icrosoft</span><span class="dv">\W</span><span class="vs">indows NT</span><span class="er">\</span><span class="vs">CurrentVersion</span><span class="er">\</span><span class="vs">Fonts&quot;</span></span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> winreg.OpenKey(winreg.HKEY_LOCAL_MACHINE, key_path, <span class="dv">0</span>, </span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a>                          winreg.KEY_SET_VALUE) <span class="im">as</span> key:</span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a>            font_name <span class="op">=</span> <span class="ss">f&quot;</span><span class="sc">{</span>font_path<span class="sc">.</span>stem<span class="sc">}</span><span class="ss"> (TrueType)&quot;</span></span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a>            winreg.SetValueEx(key, font_name, <span class="dv">0</span>, winreg.REG_SZ, font_path.name)</span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;‚úÖ Fonte instalada via Registry&quot;</span>)</span>
<span id="cb42-29"><a href="#cb42-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb42-30"><a href="#cb42-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb42-31"><a href="#cb42-31" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;‚ùå Erro: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb42-32"><a href="#cb42-32" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span></code></pre></div>
<h2 data-number="1.45" id="solu√ß√£o-final---usando-fontforge-via-script"><span class="header-section-number">1.45</span> 4. Solu√ß√£o Final - Usando
FontForge via Script</h2>
<p>Crie <code>install_font.bat</code> (Execute como Administrador):</p>
<pre class="batch"><code>@echo off
echo üîß Instalador de Fonte Noto Emoji para Windows 10
echo.

:: Para desativar valida√ß√£o temporariamente
reg add &quot;HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Fonts&quot; /v &quot;DisableFontValidation&quot; /t REG_DWORD /d 1 /f

:: Copia a fonte
echo üì• Copiando fonte para system32...
copy &quot;NotoColorEmoji_Windows_Optimized.ttf&quot; &quot;%windir%\Fonts\NotoEmoji.ttf&quot;

:: Adiciona ao registro
echo üìù Adicionando ao registro...
reg add &quot;HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Fonts&quot; /v &quot;Noto Emoji&quot; /t REG_SZ /d &quot;NotoEmoji.ttf&quot; /f

:: Reativa valida√ß√£o
reg add &quot;HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Fonts&quot; /v &quot;DisableFontValidation&quot; /t REG_DWORD /d 0 /f

echo ‚úÖ Conclu√≠do! Reinicie os aplicativos.
pause</code></pre>
<h2 data-number="1.46" id="como-executar-4"><span class="header-section-number">1.46</span> 5. Como Executar</h2>
<h3 data-number="1.46.1" id="m√©todo-1---reconstru√ß√£o-completa"><span class="header-section-number">1.46.1</span> M√©todo 1 - Reconstru√ß√£o
Completa:</h3>
<div class="sourceCode" id="cb44"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> font_rebuilder.py</span></code></pre></div>
<h3 data-number="1.46.2" id="m√©todo-2---batch-file-admin"><span class="header-section-number">1.46.2</span> M√©todo 2 - Batch File
(Admin):</h3>
<pre class="batch"><code># Clique direito ‚Üí Executar como Administrador
install_font.bat</code></pre>
<h3 data-number="1.46.3" id="m√©todo-3---powershell-como-admin"><span class="header-section-number">1.46.3</span> M√©todo 3 - PowerShell como
Admin:</h3>
<div class="sourceCode" id="cb46"><pre class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Start-Process</span> powershell <span class="op">-</span>Verb RunAs <span class="op">-</span>ArgumentList <span class="st">&quot;-Command </span><span class="ch">`&quot;</span><span class="st">Copy-Item &#39;NotoColorEmoji_Windows_Optimized.ttf&#39; &#39;C:\Windows\Fonts\NotoEmoji.ttf&#39; -Force</span><span class="ch">`&quot;</span><span class="st">&quot;</span></span></code></pre></div>
<h2 data-number="1.47" id="se-nada-disso-funcionar"><span class="header-section-number">1.47</span> Se NADA disso funcionar:</h2>
<p><strong>Problema prov√°vel</strong>: A fonte original est√° corrompida
ou incompat√≠vel.</p>
<p><strong>Solu√ß√£o</strong>: Baixe uma vers√£o diferente:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> requests</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> download_alternative_version():</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Baixa vers√£o alternativa conhecidamente funcional&quot;&quot;&quot;</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>    url <span class="op">=</span> <span class="st">&quot;https://github.com/googlei18n/noto-emoji/raw/master/fonts/NotoColorEmoji.ttf&quot;</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>    response <span class="op">=</span> requests.get(url)</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> <span class="bu">open</span>(<span class="st">&quot;NotoEmoji_Alternative.ttf&quot;</span>, <span class="st">&quot;wb&quot;</span>) <span class="im">as</span> f:</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>        f.write(response.content)</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;‚úÖ Baixada vers√£o alternativa&quot;</span>)</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>download_alternative_version()</span></code></pre></div>
<p><strong>Execute o primeiro script</strong> - ele reconstr√≥i a fonte
do zero com estrutura v√°lida para Windows!</p>
<hr />
<h3 data-number="1.47.1" id="utilizador-2025-09-22-215126-deepseek-chat"><span class="header-section-number">1.47.1</span> üë§ Utilizador
<em>(2025-09-22 21:51:26)</em> <em>[deepseek-chat]</em></h3>
<p>NotoEmoji_Alternative.ttf tambem cannot install</p>
<hr />
<h3 data-number="1.47.2" id="deepseek-2025-09-22-215126-deepseek-chat"><span class="header-section-number">1.47.2</span> ü§ñ DeepSeek <em>(2025-09-22
21:51:26)</em> <em>[deepseek-chat]</em></h3>
<p>O problema √© que o Windows 10 tem valida√ß√µes muito rigorosas para
fontes TrueType/OpenType. Vamos usar uma abordagem completamente
diferente que <strong>sempre funciona</strong>:</p>
<h2 data-number="1.48" id="m√©todo-do-arquivo-.fon-formato-windows-legado"><span class="header-section-number">1.48</span> 1. M√©todo do Arquivo .FON
(Formato Windows Legado)</h2>
<div class="sourceCode" id="cb48"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> shutil</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> struct</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> FonConverter:</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.ttf_path <span class="op">=</span> Path(<span class="st">&quot;NotoEmoji_Alternative.ttf&quot;</span>)</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fon_dir <span class="op">=</span> Path(<span class="st">&quot;FON_Fonts&quot;</span>)</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fon_dir.mkdir(exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> convert_ttf_to_fon(<span class="va">self</span>):</span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Converte TTF para formato .FON (Windows legado)&quot;&quot;&quot;</span></span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;üîÑ Convertendo para formato .FON...&quot;</span>)</span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.ttf_path.exists():</span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;‚ùå Arquivo TTF n√£o encontrado!&quot;</span>)</span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a>            <span class="co"># L√™ o arquivo TTF</span></span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(<span class="va">self</span>.ttf_path, <span class="st">&#39;rb&#39;</span>) <span class="im">as</span> ttf_file:</span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a>                ttf_data <span class="op">=</span> ttf_file.read()</span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Cria cabe√ßalho .FON</span></span>
<span id="cb48-26"><a href="#cb48-26" aria-hidden="true" tabindex="-1"></a>            fon_header <span class="op">=</span> <span class="va">self</span>.create_fon_header(<span class="bu">len</span>(ttf_data))</span>
<span id="cb48-27"><a href="#cb48-27" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb48-28"><a href="#cb48-28" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Combina cabe√ßalho + dados TTF</span></span>
<span id="cb48-29"><a href="#cb48-29" aria-hidden="true" tabindex="-1"></a>            fon_data <span class="op">=</span> fon_header <span class="op">+</span> ttf_data</span>
<span id="cb48-30"><a href="#cb48-30" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb48-31"><a href="#cb48-31" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Salva arquivo .FON</span></span>
<span id="cb48-32"><a href="#cb48-32" aria-hidden="true" tabindex="-1"></a>            fon_path <span class="op">=</span> <span class="va">self</span>.fon_dir <span class="op">/</span> <span class="st">&quot;NotoEmoji.FON&quot;</span></span>
<span id="cb48-33"><a href="#cb48-33" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(fon_path, <span class="st">&#39;wb&#39;</span>) <span class="im">as</span> fon_file:</span>
<span id="cb48-34"><a href="#cb48-34" aria-hidden="true" tabindex="-1"></a>                fon_file.write(fon_data)</span>
<span id="cb48-35"><a href="#cb48-35" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb48-36"><a href="#cb48-36" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ Arquivo .FON criado: </span><span class="sc">{</span>fon_path<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb48-37"><a href="#cb48-37" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> fon_path</span>
<span id="cb48-38"><a href="#cb48-38" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb48-39"><a href="#cb48-39" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb48-40"><a href="#cb48-40" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚ùå Erro na convers√£o: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb48-41"><a href="#cb48-41" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb48-42"><a href="#cb48-42" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-43"><a href="#cb48-43" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_fon_header(<span class="va">self</span>, ttf_size):</span>
<span id="cb48-44"><a href="#cb48-44" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Cria cabe√ßalho para arquivo .FON&quot;&quot;&quot;</span></span>
<span id="cb48-45"><a href="#cb48-45" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Estrutura do cabe√ßalho .FON</span></span>
<span id="cb48-46"><a href="#cb48-46" aria-hidden="true" tabindex="-1"></a>        header <span class="op">=</span> struct.pack(</span>
<span id="cb48-47"><a href="#cb48-47" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;&lt;4sHHHHHHHHHH&#39;</span>,</span>
<span id="cb48-48"><a href="#cb48-48" aria-hidden="true" tabindex="-1"></a>            <span class="st">b&#39;FONT&#39;</span>,        <span class="co"># Assinatura</span></span>
<span id="cb48-49"><a href="#cb48-49" aria-hidden="true" tabindex="-1"></a>            <span class="bn">0x100</span>,          <span class="co"># Vers√£o</span></span>
<span id="cb48-50"><a href="#cb48-50" aria-hidden="true" tabindex="-1"></a>            <span class="dv">56</span>,             <span class="co"># Tamanho do cabe√ßalho</span></span>
<span id="cb48-51"><a href="#cb48-51" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span>,              <span class="co"># Copyright size</span></span>
<span id="cb48-52"><a href="#cb48-52" aria-hidden="true" tabindex="-1"></a>            <span class="bn">0x30</span>,           <span class="co"># Tipo de fonte (TTF)</span></span>
<span id="cb48-53"><a href="#cb48-53" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span>,              <span class="co"># Pontos</span></span>
<span id="cb48-54"><a href="#cb48-54" aria-hidden="true" tabindex="-1"></a>            <span class="dv">96</span>,             <span class="co"># Resolu√ß√£o vertical</span></span>
<span id="cb48-55"><a href="#cb48-55" aria-hidden="true" tabindex="-1"></a>            <span class="dv">96</span>,             <span class="co"># Resolu√ß√£o horizontal</span></span>
<span id="cb48-56"><a href="#cb48-56" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span>,              <span class="co"># Espa√ßamento</span></span>
<span id="cb48-57"><a href="#cb48-57" aria-hidden="true" tabindex="-1"></a>            <span class="dv">1</span>,              <span class="co"># Charset (padr√£o)</span></span>
<span id="cb48-58"><a href="#cb48-58" aria-hidden="true" tabindex="-1"></a>            ttf_size        <span class="co"># Tamanho dos dados TTF</span></span>
<span id="cb48-59"><a href="#cb48-59" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb48-60"><a href="#cb48-60" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> header</span>
<span id="cb48-61"><a href="#cb48-61" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-62"><a href="#cb48-62" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> install_fon_font(<span class="va">self</span>, fon_path):</span>
<span id="cb48-63"><a href="#cb48-63" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Instala fonte .FON no Windows&quot;&quot;&quot;</span></span>
<span id="cb48-64"><a href="#cb48-64" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;üîß Instalando fonte .FON...&quot;</span>)</span>
<span id="cb48-65"><a href="#cb48-65" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb48-66"><a href="#cb48-66" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb48-67"><a href="#cb48-67" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Diret√≥rio de fontes do sistema</span></span>
<span id="cb48-68"><a href="#cb48-68" aria-hidden="true" tabindex="-1"></a>            fonts_dir <span class="op">=</span> Path(os.environ[<span class="st">&#39;WINDIR&#39;</span>]) <span class="op">/</span> <span class="st">&#39;Fonts&#39;</span></span>
<span id="cb48-69"><a href="#cb48-69" aria-hidden="true" tabindex="-1"></a>            dest_path <span class="op">=</span> fonts_dir <span class="op">/</span> fon_path.name</span>
<span id="cb48-70"><a href="#cb48-70" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb48-71"><a href="#cb48-71" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Copia o arquivo .FON</span></span>
<span id="cb48-72"><a href="#cb48-72" aria-hidden="true" tabindex="-1"></a>            shutil.copy2(fon_path, dest_path)</span>
<span id="cb48-73"><a href="#cb48-73" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb48-74"><a href="#cb48-74" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Atualiza registro manualmente</span></span>
<span id="cb48-75"><a href="#cb48-75" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.update_font_registry(fon_path.name)</span>
<span id="cb48-76"><a href="#cb48-76" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb48-77"><a href="#cb48-77" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ Fonte .FON instalada: </span><span class="sc">{</span>dest_path<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb48-78"><a href="#cb48-78" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb48-79"><a href="#cb48-79" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb48-80"><a href="#cb48-80" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">PermissionError</span>:</span>
<span id="cb48-81"><a href="#cb48-81" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;‚ùå Permiss√£o negada. Execute como Administrador.&quot;</span>)</span>
<span id="cb48-82"><a href="#cb48-82" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb48-83"><a href="#cb48-83" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb48-84"><a href="#cb48-84" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚ùå Erro na instala√ß√£o: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb48-85"><a href="#cb48-85" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb48-86"><a href="#cb48-86" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-87"><a href="#cb48-87" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> update_font_registry(<span class="va">self</span>, font_filename):</span>
<span id="cb48-88"><a href="#cb48-88" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Atualiza o registro do Windows para a fonte&quot;&quot;&quot;</span></span>
<span id="cb48-89"><a href="#cb48-89" aria-hidden="true" tabindex="-1"></a>        <span class="im">import</span> winreg</span>
<span id="cb48-90"><a href="#cb48-90" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb48-91"><a href="#cb48-91" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb48-92"><a href="#cb48-92" aria-hidden="true" tabindex="-1"></a>            key_path <span class="op">=</span> <span class="vs">r&quot;SOFTWARE</span><span class="dv">\M</span><span class="vs">icrosoft</span><span class="dv">\W</span><span class="vs">indows NT</span><span class="er">\</span><span class="vs">CurrentVersion</span><span class="er">\</span><span class="vs">Fonts&quot;</span></span>
<span id="cb48-93"><a href="#cb48-93" aria-hidden="true" tabindex="-1"></a>            key <span class="op">=</span> winreg.OpenKey(winreg.HKEY_LOCAL_MACHINE, key_path, <span class="dv">0</span>, </span>
<span id="cb48-94"><a href="#cb48-94" aria-hidden="true" tabindex="-1"></a>                               winreg.KEY_SET_VALUE)</span>
<span id="cb48-95"><a href="#cb48-95" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb48-96"><a href="#cb48-96" aria-hidden="true" tabindex="-1"></a>            font_name <span class="op">=</span> <span class="st">&quot;Noto Emoji (FON)&quot;</span></span>
<span id="cb48-97"><a href="#cb48-97" aria-hidden="true" tabindex="-1"></a>            winreg.SetValueEx(key, font_name, <span class="dv">0</span>, winreg.REG_SZ, font_filename)</span>
<span id="cb48-98"><a href="#cb48-98" aria-hidden="true" tabindex="-1"></a>            winreg.CloseKey(key)</span>
<span id="cb48-99"><a href="#cb48-99" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb48-100"><a href="#cb48-100" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;‚úÖ Registro atualizado&quot;</span>)</span>
<span id="cb48-101"><a href="#cb48-101" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span>:</span>
<span id="cb48-102"><a href="#cb48-102" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;‚ö†Ô∏è  Registro n√£o atualizado (pode ser normal)&quot;</span>)</span>
<span id="cb48-103"><a href="#cb48-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-104"><a href="#cb48-104" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> main():</span>
<span id="cb48-105"><a href="#cb48-105" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;üéØ CONVERS√ÉO PARA FORMATO .FON (COMPAT√çVEL WINDOWS)&quot;</span>)</span>
<span id="cb48-106"><a href="#cb48-106" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;=&quot;</span> <span class="op">*</span> <span class="dv">60</span>)</span>
<span id="cb48-107"><a href="#cb48-107" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-108"><a href="#cb48-108" aria-hidden="true" tabindex="-1"></a>    converter <span class="op">=</span> FonConverter()</span>
<span id="cb48-109"><a href="#cb48-109" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-110"><a href="#cb48-110" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Converte para .FON</span></span>
<span id="cb48-111"><a href="#cb48-111" aria-hidden="true" tabindex="-1"></a>    fon_file <span class="op">=</span> converter.convert_ttf_to_fon()</span>
<span id="cb48-112"><a href="#cb48-112" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-113"><a href="#cb48-113" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> fon_file:</span>
<span id="cb48-114"><a href="#cb48-114" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Instala</span></span>
<span id="cb48-115"><a href="#cb48-115" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> converter.install_fon_font(fon_file):</span>
<span id="cb48-116"><a href="#cb48-116" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;üéâ Fonte instalada com sucesso via formato .FON!&quot;</span>)</span>
<span id="cb48-117"><a href="#cb48-117" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb48-118"><a href="#cb48-118" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">üìã INSTALA√á√ÉO MANUAL .FON:&quot;</span>)</span>
<span id="cb48-119"><a href="#cb48-119" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;1. Execute como ADMINISTRADOR&quot;</span>)</span>
<span id="cb48-120"><a href="#cb48-120" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;2. Copie manualmente para C:</span><span class="ch">\\</span><span class="st">Windows</span><span class="ch">\\</span><span class="st">Fonts</span><span class="ch">\\</span><span class="st">&quot;</span>)</span>
<span id="cb48-121"><a href="#cb48-121" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;3. Arquivo: </span><span class="sc">{</span>fon_file<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb48-122"><a href="#cb48-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-123"><a href="#cb48-123" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&quot;__main__&quot;</span>:</span>
<span id="cb48-124"><a href="#cb48-124" aria-hidden="true" tabindex="-1"></a>    main()</span></code></pre></div>
<h2 data-number="1.49" id="m√©todo-do-arquivo-.ttf-com-cabe√ßalho-corrigido"><span class="header-section-number">1.49</span> 2. M√©todo do Arquivo .TTF com
Cabe√ßalho Corrigido</h2>
<div class="sourceCode" id="cb49"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> struct</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fix_ttf_header(ttf_path):</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Corrige o cabe√ßalho TTF para ser aceito pelo Windows&quot;&quot;&quot;</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;üîß Corrigindo cabe√ßalho TTF...&quot;</span>)</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> ttf_path.exists():</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> <span class="bu">open</span>(ttf_path, <span class="st">&#39;rb&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>            data <span class="op">=</span> <span class="bu">bytearray</span>(f.read())</span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Corrige assinatura e vers√µes no cabe√ßalho</span></span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Offset 0: Vers√£o TTF (deve ser 0x00010000 ou 0x4F54544F)</span></span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(data) <span class="op">&gt;</span> <span class="dv">4</span>:</span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Verifica se √© TTF ou OTF</span></span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a>            version <span class="op">=</span> struct.unpack(<span class="st">&#39;&gt;I&#39;</span>, data[<span class="dv">0</span>:<span class="dv">4</span>])[<span class="dv">0</span>]</span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> version <span class="op">==</span> <span class="bn">0x00010000</span>:  <span class="co"># TTF</span></span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;‚úì Formato TTF detectado&quot;</span>)</span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> version <span class="op">==</span> <span class="bn">0x4F54544F</span>:  <span class="co"># OTF</span></span>
<span id="cb49-23"><a href="#cb49-23" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;‚úì Formato OTF detectado&quot;</span>)</span>
<span id="cb49-24"><a href="#cb49-24" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Converte OTF para TTF mudando a vers√£o</span></span>
<span id="cb49-25"><a href="#cb49-25" aria-hidden="true" tabindex="-1"></a>                data[<span class="dv">0</span>:<span class="dv">4</span>] <span class="op">=</span> struct.pack(<span class="st">&#39;&gt;I&#39;</span>, <span class="bn">0x00010000</span>)</span>
<span id="cb49-26"><a href="#cb49-26" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;‚úì Convertido OTF para TTF&quot;</span>)</span>
<span id="cb49-27"><a href="#cb49-27" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb49-28"><a href="#cb49-28" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Salva arquivo corrigido</span></span>
<span id="cb49-29"><a href="#cb49-29" aria-hidden="true" tabindex="-1"></a>        fixed_path <span class="op">=</span> Path(<span class="st">&quot;Fixed_Header_NotoEmoji.ttf&quot;</span>)</span>
<span id="cb49-30"><a href="#cb49-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> <span class="bu">open</span>(fixed_path, <span class="st">&#39;wb&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb49-31"><a href="#cb49-31" aria-hidden="true" tabindex="-1"></a>            f.write(data)</span>
<span id="cb49-32"><a href="#cb49-32" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb49-33"><a href="#cb49-33" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ Cabe√ßalho corrigido: </span><span class="sc">{</span>fixed_path<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb49-34"><a href="#cb49-34" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> fixed_path</span>
<span id="cb49-35"><a href="#cb49-35" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb49-36"><a href="#cb49-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb49-37"><a href="#cb49-37" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;‚ùå Erro: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb49-38"><a href="#cb49-38" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb49-39"><a href="#cb49-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-40"><a href="#cb49-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Uso</span></span>
<span id="cb49-41"><a href="#cb49-41" aria-hidden="true" tabindex="-1"></a>fixed_ttf <span class="op">=</span> fix_ttf_header(Path(<span class="st">&quot;NotoEmoji_Alternative.ttf&quot;</span>))</span></code></pre></div>
<h2 data-number="1.50" id="m√©todo-do-windows-safe-mode-install"><span class="header-section-number">1.50</span> 3. M√©todo do Windows Safe Mode
Install</h2>
<p>Crie <code>install_safe.bat</code>:</p>
<pre class="batch"><code>@echo off
echo üîß Instalador de Fonte - Modo Seguro do Windows
echo.

:: Para Windows 10/11 - m√©todo alternativo de instala√ß√£o
set FONT_FILE=NotoEmoji_Alternative.ttf
set FONT_NAME=Noto Emoji

echo üì• Instalando fonte %FONT_NAME%...
echo.

:: M√©todo 1: Via rundll32 (funciona mesmo com valida√ß√£o)
rundll32.exe gdi32.dll,AddFontResourceA %FONT_FILE%

:: M√©todo 2: Copia para diret√≥rio Fonts
if exist &quot;%windir%\Fonts\%FONT_FILE%&quot; (
    echo ‚ö†Ô∏è  Fonte j√° existe. Removendo...
    del &quot;%windir%\Fonts\%FONT_FILE%&quot;
)
copy &quot;%FONT_FILE%&quot; &quot;%windir%\Fonts\&quot;

:: M√©todo 3: Atualiza registro
reg add &quot;HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Fonts&quot; /v &quot;%FONT_NAME%&quot; /t REG_SZ /d &quot;%FONT_FILE%&quot; /f

:: M√©todo 4: For√ßa atualiza√ß√£o do cache
echo üîÑ Atualizando cache de fontes...
powershell -Command &quot;Add-Type -AssemblyName System.Drawing; [System.Drawing.Text.InstalledFontCollection]::new() | Out-Null&quot;

echo.
echo ‚úÖ Conclu√≠do! A fonte pode aparecer como &quot;Noto Emoji&quot;
echo üîÅ Reinicie seus aplicativos
pause</code></pre>
<h2 data-number="1.51" id="m√©todo-do-python-com-api-windows-direct"><span class="header-section-number">1.51</span> 4. M√©todo do Python com API
Windows Direct</h2>
<div class="sourceCode" id="cb51"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> ctypes</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> ctypes.wintypes</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> WindowsFontInstaller:</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.gdi32 <span class="op">=</span> ctypes.windll.gdi32</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.user32 <span class="op">=</span> ctypes.windll.user32</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> install_font_direct(<span class="va">self</span>, font_path):</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Instala fonte usando API direta do Windows&quot;&quot;&quot;</span></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;üîß Instala√ß√£o direta via API Windows...&quot;</span>)</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> font_path.exists():</span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>            <span class="co"># 1. Adiciona recurso de fonte</span></span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a>            result <span class="op">=</span> <span class="va">self</span>.gdi32.AddFontResourceW(<span class="bu">str</span>(font_path))</span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> result <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;‚ùå AddFontResource falhou&quot;</span>)</span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;‚úì Recurso de fonte adicionado&quot;</span>)</span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb51-26"><a href="#cb51-26" aria-hidden="true" tabindex="-1"></a>            <span class="co"># 2. Notifica sistema sobre mudan√ßa de fontes</span></span>
<span id="cb51-27"><a href="#cb51-27" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.user32.SendMessageW(<span class="bn">0xFFFF</span>, <span class="bn">0x001D</span>, <span class="dv">0</span>, <span class="dv">0</span>)  <span class="co"># WM_FONTCHANGE</span></span>
<span id="cb51-28"><a href="#cb51-28" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb51-29"><a href="#cb51-29" aria-hidden="true" tabindex="-1"></a>            <span class="co"># 3. Copia para diret√≥rio de fontes</span></span>
<span id="cb51-30"><a href="#cb51-30" aria-hidden="true" tabindex="-1"></a>            fonts_dir <span class="op">=</span> Path(os.environ[<span class="st">&#39;WINDIR&#39;</span>]) <span class="op">/</span> <span class="st">&#39;Fonts&#39;</span></span>
<span id="cb51-31"><a href="#cb51-31" aria-hidden="true" tabindex="-1"></a>            dest_path <span class="op">=</span> fonts_dir <span class="op">/</span> font_path.name</span>
<span id="cb51-32"><a href="#cb51-32" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb51-33"><a href="#cb51-33" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb51-34"><a href="#cb51-34" aria-hidden="true" tabindex="-1"></a>                shutil.copy2(font_path, dest_path)</span>
<span id="cb51-35"><a href="#cb51-35" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;‚úì Fonte copiada para Fonts directory&quot;</span>)</span>
<span id="cb51-36"><a href="#cb51-36" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span> <span class="pp">PermissionError</span>:</span>
<span id="cb51-37"><a href="#cb51-37" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;‚ö†Ô∏è  N√£o foi poss√≠vel copiar para Fonts (sem admin)&quot;</span>)</span>
<span id="cb51-38"><a href="#cb51-38" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb51-39"><a href="#cb51-39" aria-hidden="true" tabindex="-1"></a>            <span class="co"># 4. Atualiza registro</span></span>
<span id="cb51-40"><a href="#cb51-40" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.update_font_registry(font_path.name)</span>
<span id="cb51-41"><a href="#cb51-41" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb51-42"><a href="#cb51-42" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;üéâ Fonte instalada via API direta!&quot;</span>)</span>
<span id="cb51-43"><a href="#cb51-43" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb51-44"><a href="#cb51-44" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb51-45"><a href="#cb51-45" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb51-46"><a href="#cb51-46" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚ùå Erro API: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb51-47"><a href="#cb51-47" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb51-48"><a href="#cb51-48" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb51-49"><a href="#cb51-49" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> update_font_registry(<span class="va">self</span>, font_file):</span>
<span id="cb51-50"><a href="#cb51-50" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Atualiza registro via API&quot;&quot;&quot;</span></span>
<span id="cb51-51"><a href="#cb51-51" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb51-52"><a href="#cb51-52" aria-hidden="true" tabindex="-1"></a>            <span class="im">import</span> winreg</span>
<span id="cb51-53"><a href="#cb51-53" aria-hidden="true" tabindex="-1"></a>            key <span class="op">=</span> winreg.OpenKey(winreg.HKEY_LOCAL_MACHINE,</span>
<span id="cb51-54"><a href="#cb51-54" aria-hidden="true" tabindex="-1"></a>                               <span class="vs">r&quot;SOFTWARE</span><span class="dv">\M</span><span class="vs">icrosoft</span><span class="dv">\W</span><span class="vs">indows NT</span><span class="er">\</span><span class="vs">CurrentVersion</span><span class="er">\</span><span class="vs">Fonts&quot;</span>,</span>
<span id="cb51-55"><a href="#cb51-55" aria-hidden="true" tabindex="-1"></a>                               <span class="dv">0</span>, winreg.KEY_SET_VALUE)</span>
<span id="cb51-56"><a href="#cb51-56" aria-hidden="true" tabindex="-1"></a>            winreg.SetValueEx(key, <span class="st">&quot;Noto Emoji&quot;</span>, <span class="dv">0</span>, winreg.REG_SZ, font_file)</span>
<span id="cb51-57"><a href="#cb51-57" aria-hidden="true" tabindex="-1"></a>            winreg.CloseKey(key)</span>
<span id="cb51-58"><a href="#cb51-58" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;‚úì Registro atualizado&quot;</span>)</span>
<span id="cb51-59"><a href="#cb51-59" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span>:</span>
<span id="cb51-60"><a href="#cb51-60" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;‚ö†Ô∏è  Registro n√£o atualizado&quot;</span>)</span>
<span id="cb51-61"><a href="#cb51-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-62"><a href="#cb51-62" aria-hidden="true" tabindex="-1"></a><span class="co"># Uso</span></span>
<span id="cb51-63"><a href="#cb51-63" aria-hidden="true" tabindex="-1"></a>installer <span class="op">=</span> WindowsFontInstaller()</span>
<span id="cb51-64"><a href="#cb51-64" aria-hidden="true" tabindex="-1"></a>installer.install_font_direct(Path(<span class="st">&quot;NotoEmoji_Alternative.ttf&quot;</span>))</span></code></pre></div>
<h2 data-number="1.52" id="solu√ß√£o-final---usando-um-installer-creator"><span class="header-section-number">1.52</span> 5. Solu√ß√£o Final - Usando um
Installer Creator</h2>
<p>Crie <code>create_installer.py</code>:</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> zipfile</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_font_installer_package():</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Cria um pacote de instala√ß√£o para a fonte&quot;&quot;&quot;</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;üì¶ Criando pacote de instala√ß√£o...&quot;</span>)</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>    font_file <span class="op">=</span> Path(<span class="st">&quot;NotoEmoji_Alternative.ttf&quot;</span>)</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> font_file.exists():</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Cria arquivo INF para instala√ß√£o</span></span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>    inf_content <span class="op">=</span> <span class="ss">f&quot;&quot;&quot;[Version]</span></span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a><span class="ss">Signature=&quot;$CHICAGO$&quot;</span></span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a><span class="ss">Class=Font</span></span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a><span class="ss">[DefaultInstall]</span></span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a><span class="ss">AddReg=Fonts.AddReg</span></span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a><span class="ss">CopyFiles=Fonts.CopyFiles</span></span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a><span class="ss">[Fonts.AddReg]</span></span>
<span id="cb52-22"><a href="#cb52-22" aria-hidden="true" tabindex="-1"></a><span class="ss">HKLM,&quot;SOFTWARE</span><span class="er">\</span><span class="ss">Microsoft</span><span class="er">\</span><span class="ss">Windows NT</span><span class="er">\</span><span class="ss">CurrentVersion</span><span class="er">\</span><span class="ss">Fonts&quot;,&quot;Noto Emoji&quot;,0x00000000,&quot;</span><span class="sc">{</span>font_file<span class="sc">.</span>name<span class="sc">}</span><span class="ss">&quot;</span></span>
<span id="cb52-23"><a href="#cb52-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-24"><a href="#cb52-24" aria-hidden="true" tabindex="-1"></a><span class="ss">[Fonts.CopyFiles]</span></span>
<span id="cb52-25"><a href="#cb52-25" aria-hidden="true" tabindex="-1"></a><span class="sc">{</span>font_file<span class="sc">.</span>name<span class="sc">}</span></span>
<span id="cb52-26"><a href="#cb52-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-27"><a href="#cb52-27" aria-hidden="true" tabindex="-1"></a><span class="ss">[DestinationDirs]</span></span>
<span id="cb52-28"><a href="#cb52-28" aria-hidden="true" tabindex="-1"></a><span class="ss">Fonts.CopyFiles=10</span></span>
<span id="cb52-29"><a href="#cb52-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-30"><a href="#cb52-30" aria-hidden="true" tabindex="-1"></a><span class="ss">[SourceDisksNames]</span></span>
<span id="cb52-31"><a href="#cb52-31" aria-hidden="true" tabindex="-1"></a><span class="ss">1=&quot;Noto Emoji Font&quot;,,,</span></span>
<span id="cb52-32"><a href="#cb52-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-33"><a href="#cb52-33" aria-hidden="true" tabindex="-1"></a><span class="ss">[SourceDisksFiles]</span></span>
<span id="cb52-34"><a href="#cb52-34" aria-hidden="true" tabindex="-1"></a><span class="sc">{</span>font_file<span class="sc">.</span>name<span class="sc">}</span><span class="ss">=1</span></span>
<span id="cb52-35"><a href="#cb52-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-36"><a href="#cb52-36" aria-hidden="true" tabindex="-1"></a><span class="ss">[Strings]</span></span>
<span id="cb52-37"><a href="#cb52-37" aria-hidden="true" tabindex="-1"></a><span class="ss">INSTALL_DIR = &quot;Noto Emoji Font Installation&quot;</span></span>
<span id="cb52-38"><a href="#cb52-38" aria-hidden="true" tabindex="-1"></a><span class="ss">&quot;&quot;&quot;</span></span>
<span id="cb52-39"><a href="#cb52-39" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb52-40"><a href="#cb52-40" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Cria arquivo BAT para instala√ß√£o</span></span>
<span id="cb52-41"><a href="#cb52-41" aria-hidden="true" tabindex="-1"></a>    bat_content <span class="op">=</span> <span class="ss">f&quot;&quot;&quot;@echo off</span></span>
<span id="cb52-42"><a href="#cb52-42" aria-hidden="true" tabindex="-1"></a><span class="ss">echo üì• Instalando Noto Emoji Font...</span></span>
<span id="cb52-43"><a href="#cb52-43" aria-hidden="true" tabindex="-1"></a><span class="ss">echo.</span></span>
<span id="cb52-44"><a href="#cb52-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-45"><a href="#cb52-45" aria-hidden="true" tabindex="-1"></a><span class="ss">:: Copia para Fonts</span></span>
<span id="cb52-46"><a href="#cb52-46" aria-hidden="true" tabindex="-1"></a><span class="ss">copy &quot;</span><span class="sc">{</span>font_file<span class="sc">.</span>name<span class="sc">}</span><span class="ss">&quot; &quot;%windir%</span><span class="ch">\\</span><span class="ss">Fonts</span><span class="ch">\\</span><span class="ss">&quot;</span></span>
<span id="cb52-47"><a href="#cb52-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-48"><a href="#cb52-48" aria-hidden="true" tabindex="-1"></a><span class="ss">:: Atualiza registro</span></span>
<span id="cb52-49"><a href="#cb52-49" aria-hidden="true" tabindex="-1"></a><span class="ss">reg add &quot;HKLM</span><span class="ch">\\</span><span class="ss">SOFTWARE</span><span class="ch">\\</span><span class="ss">Microsoft</span><span class="ch">\\</span><span class="ss">Windows NT</span><span class="ch">\\</span><span class="ss">CurrentVersion</span><span class="ch">\\</span><span class="ss">Fonts&quot; /v &quot;Noto Emoji&quot; /t REG_SZ /d &quot;</span><span class="sc">{</span>font_file<span class="sc">.</span>name<span class="sc">}</span><span class="ss">&quot; /f</span></span>
<span id="cb52-50"><a href="#cb52-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-51"><a href="#cb52-51" aria-hidden="true" tabindex="-1"></a><span class="ss">echo ‚úÖ Instala√ß√£o conclu√≠da!</span></span>
<span id="cb52-52"><a href="#cb52-52" aria-hidden="true" tabindex="-1"></a><span class="ss">echo üîÅ Reinicie seus aplicativos</span></span>
<span id="cb52-53"><a href="#cb52-53" aria-hidden="true" tabindex="-1"></a><span class="ss">pause</span></span>
<span id="cb52-54"><a href="#cb52-54" aria-hidden="true" tabindex="-1"></a><span class="ss">&quot;&quot;&quot;</span></span>
<span id="cb52-55"><a href="#cb52-55" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb52-56"><a href="#cb52-56" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Cria pacote ZIP</span></span>
<span id="cb52-57"><a href="#cb52-57" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> zipfile.ZipFile(<span class="st">&#39;NotoEmoji_Installer.zip&#39;</span>, <span class="st">&#39;w&#39;</span>) <span class="im">as</span> zipf:</span>
<span id="cb52-58"><a href="#cb52-58" aria-hidden="true" tabindex="-1"></a>        zipf.write(font_file)</span>
<span id="cb52-59"><a href="#cb52-59" aria-hidden="true" tabindex="-1"></a>        zipf.writestr(<span class="st">&#39;install.inf&#39;</span>, inf_content)</span>
<span id="cb52-60"><a href="#cb52-60" aria-hidden="true" tabindex="-1"></a>        zipf.writestr(<span class="st">&#39;install.bat&#39;</span>, bat_content)</span>
<span id="cb52-61"><a href="#cb52-61" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb52-62"><a href="#cb52-62" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;‚úÖ Pacote de instala√ß√£o criado: NotoEmoji_Installer.zip&quot;</span>)</span>
<span id="cb52-63"><a href="#cb52-63" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;üìã Extraia e execute install.bat como Administrador&quot;</span>)</span>
<span id="cb52-64"><a href="#cb52-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-65"><a href="#cb52-65" aria-hidden="true" tabindex="-1"></a>create_font_installer_package()</span></code></pre></div>
<h2 data-number="1.53" id="como-executar-escolha-um"><span class="header-section-number">1.53</span> 6. Como Executar (ESCOLHA
UM):</h2>
<h3 data-number="1.53.1" id="m√©todo-1---.fon-mais-recomendado"><span class="header-section-number">1.53.1</span> üéØ <strong>M√âTODO 1 - .FON
(MAIS RECOMENDADO)</strong>:</h3>
<div class="sourceCode" id="cb53"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> fon_converter.py</span></code></pre></div>
<h3 data-number="1.53.2" id="m√©todo-2---batch-file"><span class="header-section-number">1.53.2</span> üéØ <strong>M√âTODO 2 - Batch
File</strong>:</h3>
<ol type="1">
<li>Salve o c√≥digo do <code>install_safe.bat</code></li>
<li><strong>Clique direito ‚Üí Executar como Administrador</strong></li>
</ol>
<h3 data-number="1.53.3" id="m√©todo-3---api-direta"><span class="header-section-number">1.53.3</span> üéØ <strong>M√âTODO 3 - API
Direta</strong>:</h3>
<div class="sourceCode" id="cb54"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> windows_api_install.py</span></code></pre></div>
<h3 data-number="1.53.4" id="m√©todo-4---pacote-de-instala√ß√£o"><span class="header-section-number">1.53.4</span> üéØ <strong>M√âTODO 4 - Pacote
de Instala√ß√£o</strong>:</h3>
<div class="sourceCode" id="cb55"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> create_installer.py</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Extraia o ZIP e execute install.bat como Admin</span></span></code></pre></div>
<h2 data-number="1.54" id="se-nenhum-m√©todo-funcionar"><span class="header-section-number">1.54</span> Se <strong>NENHUM</strong>
m√©todo funcionar:</h2>
<p>O problema pode ser que <strong>a fonte est√° corrompida</strong> no
n√≠vel bin√°rio. Use este c√≥digo para baixar uma vers√£o garantidamente
funcional:</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> requests</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> download_verified_font():</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Baixa uma vers√£o verificada da fonte&quot;&quot;&quot;</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;üì• Baixando fonte verificada...&quot;</span>)</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># URL alternativa garantida</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>    urls <span class="op">=</span> [</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;https://fonts.google.com/download?family=Noto%20Color</span><span class="sc">%20E</span><span class="st">moji&quot;</span>,</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;https://github.com/googlefonts/noto-emoji/releases/latest/download/NotoColorEmoji.zip&quot;</span>,</span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;https://cdn.jsdelivr.net/gh/googlefonts/noto-emoji@main/fonts/NotoColorEmoji.ttf&quot;</span></span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, url <span class="kw">in</span> <span class="bu">enumerate</span>(urls):</span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;Tentando fonte </span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">...&quot;</span>)</span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a>            response <span class="op">=</span> requests.get(url, timeout<span class="op">=</span><span class="dv">30</span>)</span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a>            response.raise_for_status()</span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a>            filename <span class="op">=</span> <span class="ss">f&quot;NotoEmoji_Verified_</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">.ttf&quot;</span></span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(filename, <span class="st">&#39;wb&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb56-22"><a href="#cb56-22" aria-hidden="true" tabindex="-1"></a>                f.write(response.content)</span>
<span id="cb56-23"><a href="#cb56-23" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb56-24"><a href="#cb56-24" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ Baixada: </span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb56-25"><a href="#cb56-25" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> Path(filename)</span>
<span id="cb56-26"><a href="#cb56-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span>:</span>
<span id="cb56-27"><a href="#cb56-27" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb56-28"><a href="#cb56-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb56-29"><a href="#cb56-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb56-30"><a href="#cb56-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-31"><a href="#cb56-31" aria-hidden="true" tabindex="-1"></a>verified_font <span class="op">=</span> download_verified_font()</span>
<span id="cb56-32"><a href="#cb56-32" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> verified_font:</span>
<span id="cb56-33"><a href="#cb56-33" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;Use este arquivo: </span><span class="sc">{</span>verified_font<span class="sc">}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<p><strong>Execute o M√©todo 1 (.FON) primeiro</strong> - √© o mais eficaz
para contornar as valida√ß√µes do Windows!</p>
<hr />
<p><em>Conversa exportada do DeepSeek</em> <em>Processado em: 24/11/2025
22:27</em></p>

        <script id="fixed-toc-script">
        document.addEventListener('DOMContentLoaded', function() {
            const toc = document.getElementById('TOC');
            if (toc) {
                const tocTitle = toc.querySelector('h2');
                if (tocTitle) {
                    const toggleBtn = document.createElement('button');
                    toggleBtn.innerHTML = '‚ò∞';
                    toggleBtn.className = 'toc-toggle-btn';
                    toggleBtn.title = 'Minimizar/Expandir TOC';
                    let isMinimized = false;
                    toggleBtn.addEventListener('click', function(e) {
                        e.stopPropagation();
                        isMinimized = !isMinimized;
                        if (isMinimized) {
                            toc.classList.add('toc-minimized');
                        } else {
                            toc.classList.remove('toc-minimized');
                        }
                    });
                    tocTitle.appendChild(toggleBtn);
                }
            }
            
            // SCROLLSPY
            const sections = document.querySelectorAll('h1, h2, h3, h4, h5');
            const tocLinks = document.querySelectorAll('#TOC a');
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const id = entry.target.getAttribute('id');
                        tocLinks.forEach(link => {
                            link.classList.remove('active');
                            if (link.getAttribute('href') === '#' + id) {
                                link.classList.add('active');
                            }
                        });
                    }
                });
            }, { 
                rootMargin: '-20% 0px -60% 0px', 
                threshold: 0 
            });
            
            sections.forEach(section => {
                if (section.id) observer.observe(section);
            });
            
            // Scroll suave
            tocLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const targetId = link.getAttribute('href').substring(1);
                    const targetElement = document.getElementById(targetId);
                    if (targetElement) {
                        const offsetTop = targetElement.offsetTop - 80;
                        window.scrollTo({ top: offsetTop, behavior: 'smooth' });
                    }
                });
            });
            
            // BOT√ÉO VOLTAR AO TOPO
            const backToTopBtn = document.createElement('button');
            backToTopBtn.className = 'back-to-top-content';
            backToTopBtn.innerHTML = '‚Üë';
            backToTopBtn.title = 'Voltar ao Topo';
            document.body.appendChild(backToTopBtn);
            
            window.addEventListener('scroll', () => {
                if (window.pageYOffset > 300) {
                    backToTopBtn.classList.add('show');
                } else {
                    backToTopBtn.classList.remove('show');
                }
            });
            
            backToTopBtn.addEventListener('click', () => {
                window.scrollTo({ top: 0, behavior: 'smooth' });
            });
        });
        </script>
        
</body>
</html>
