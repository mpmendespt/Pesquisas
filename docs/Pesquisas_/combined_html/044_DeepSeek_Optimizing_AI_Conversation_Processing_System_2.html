<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang xml:lang>
<head>

        <style id="fixed-toc-styles">
        /* === ESTILOS PRINCIPAIS - TOC FIXO √Ä DIREITA === */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
            scroll-behavior: smooth;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            position: relative;
        }
        /* === TOC FIXO √Ä DIREITA - POSI√á√ÉO CORRIGIDA === */
        #TOC {
            position: fixed !important;
            top: 50% !important;
            right: 20px !important;
            transform: translateY(-50%) !important;
            width: 320px !important;
            max-height: 80vh !important;
            overflow-y: auto !important;
            z-index: 1000 !important;
            background: rgba(255, 255, 255, 0.98) !important;
            padding: 20px !important;
            border-radius: 12px !important;
            box-shadow: 0 8px 32px rgba(0,0,0,0.15) !important;
            border: 1px solid #e0e0e0 !important;
            backdrop-filter: blur(10px) !important;
            transition: all 0.3s ease-in-out !important;
        }
        #TOC.toc-minimized {
            transform: translateY(-50%) translateX(calc(320px - 50px)) !important;
            opacity: 0.3;
            width: 50px !important;
            overflow: hidden;
        }
        #TOC.toc-minimized > *:not(.toc-toggle-btn) {
            display: none !important;
        }
        #TOC h2 {
            margin-top: 0;
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
            font-size: 1.2em;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .toc-toggle-btn {
            background: none;
            border: none;
            font-size: 1.2em;
            cursor: pointer;
            padding: 5px;
            border-radius: 4px;
            transition: background-color 0.2s;
        }
        .toc-toggle-btn:hover {
            background-color: rgba(0,0,0,0.1);
        }
        #TOC ul {
            list-style-type: none;
            padding-left: 15px;
            margin: 10px 0;
        }
        #TOC ul ul {
            padding-left: 20px;
        }
        #TOC li {
            margin: 8px 0;
            line-height: 1.4;
        }
        #TOC a {
            text-decoration: none;
            color: #495057;
            font-weight: 500;
            transition: all 0.2s ease;
            display: block;
            padding: 6px 10px;
            border-radius: 6px;
            border-left: 3px solid transparent;
        }
        #TOC a:hover {
            color: #007bff;
            background-color: rgba(0, 123, 255, 0.1);
            border-left-color: #007bff;
        }
        #TOC a.active {
            background-color: #007bff !important;
            color: white !important;
            font-weight: bold;
            border-left-color: #0056b3;
        }
        /* Conte√∫do principal com margem para o TOC */
        .main-content {
            margin-right: calc(320px + 40px) !important;
        }
        /* Barra de scroll personalizada APENAS para TOC */
        #TOC::-webkit-scrollbar {
            width: 8px;
        }
        #TOC::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }
        #TOC::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 4px;
        }
        #TOC::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }
        /* === BOT√ÉO VOLTAR AO TOPO (HTMLs individuais) === */
        .back-to-top-content {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            font-size: 18px;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 999;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .back-to-top-content.show {
            opacity: 1;
            transform: translateY(0);
        }
        .back-to-top-content:hover {
            background: #0056b3;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0,0,0,0.2);
        }
        /* === RESPONSIVIDADE === */
        @media (max-width: 1400px) {
            .container {
                max-width: 95%;
                padding: 30px;
            }
            #TOC {
                width: 280px !important;
            }
            .main-content {
                margin-right: 320px !important;
            }
        }
        @media (max-width: 1200px) {
            #TOC {
                width: 260px !important;
                right: 15px !important;
            }
            .main-content {
                margin-right: 300px !important;
            }
        }
        @media (max-width: 992px) {
            #TOC {
                position: relative !important;
                width: 100% !important;
                right: 0 !important;
                top: 0 !important;
                transform: none !important;
                margin: 20px 0;
                max-height: 300px !important;
            }
            .main-content {
                margin-right: 0 !important;
            }
            .back-to-top-content {
                right: 20px;
                bottom: 20px;
            }
        }
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            .container {
                padding: 20px;
                max-width: 100%;
            }
            #TOC {
                max-height: 250px !important;
                padding: 15px !important;
            }
        }
        </style>
        
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>044_DeepSeek_Optimizing_AI_Conversation_Processing_System_2</title>
  <style>

html {
color: #1a1a1a;
background-color: #fdfdfd;
}
body {
margin: 0 auto;
max-width: 36em;
padding-left: 50px;
padding-right: 50px;
padding-top: 50px;
padding-bottom: 50px;
hyphens: auto;
overflow-wrap: break-word;
text-rendering: optimizeLegibility;
font-kerning: normal;
}
@media (max-width: 600px) {
body {
font-size: 0.9em;
padding: 12px;
}
h1 {
font-size: 1.8em;
}
}
@media print {
html {
background-color: white;
}
body {
background-color: transparent;
color: black;
font-size: 12pt;
}
p, h2, h3 {
orphans: 3;
widows: 3;
}
h2, h3, h4 {
page-break-after: avoid;
}
}
p {
margin: 1em 0;
}
a {
color: #1a1a1a;
}
a:visited {
color: #1a1a1a;
}
img {
max-width: 100%;
}
svg {
height: auto;
max-width: 100%;
}
h1, h2, h3, h4, h5, h6 {
margin-top: 1.4em;
}
h5, h6 {
font-size: 1em;
font-style: italic;
}
h6 {
font-weight: normal;
}
ol, ul {
padding-left: 1.7em;
margin-top: 1em;
}
li > ol, li > ul {
margin-top: 0;
}
blockquote {
margin: 1em 0 1em 1.7em;
padding-left: 1em;
border-left: 2px solid #e6e6e6;
color: #606060;
}
code {
font-family: Menlo, Monaco, Consolas, 'Lucida Console', monospace;
font-size: 85%;
margin: 0;
hyphens: manual;
}
pre {
margin: 1em 0;
overflow: auto;
}
pre code {
padding: 0;
overflow: visible;
overflow-wrap: normal;
}
.sourceCode {
background-color: transparent;
overflow: visible;
}
hr {
border: none;
border-top: 1px solid #1a1a1a;
height: 1px;
margin: 1em 0;
}
table {
margin: 1em 0;
border-collapse: collapse;
width: 100%;
overflow-x: auto;
display: block;
font-variant-numeric: lining-nums tabular-nums;
}
table caption {
margin-bottom: 0.75em;
}
tbody {
margin-top: 0.5em;
border-top: 1px solid #1a1a1a;
border-bottom: 1px solid #1a1a1a;
}
th {
border-top: 1px solid #1a1a1a;
padding: 0.25em 0.5em 0.25em 0.5em;
}
td {
padding: 0.125em 0.5em 0.25em 0.5em;
}
header {
margin-bottom: 4em;
text-align: center;
}
#TOC li {
list-style: none;
}
#TOC ul {
padding-left: 1.3em;
}
#TOC > ul {
padding-left: 0;
}
#TOC a:not(:hover) {
text-decoration: none;
}
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}

ul.task-list[class]{list-style: none;}
ul.task-list li input[type="checkbox"] {
font-size: inherit;
width: 0.8em;
margin: 0 0.8em 0.2em -1.6em;
vertical-align: middle;
}

html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
</head>
<body>
<nav id="TOC" role="doc-toc">
<ul>
<li><a href="#optimizing-ai-conversation-processing-system-2" id="toc-optimizing-ai-conversation-processing-system-2"><span class="toc-section-number">1</span> Optimizing AI Conversation
Processing System 2</a>
<ul>
<li><a href="#informa√ß√µes" id="toc-informa√ß√µes"><span class="toc-section-number">1.1</span> üìä Informa√ß√µes</a></li>
<li><a href="#conversa" id="toc-conversa"><span class="toc-section-number">1.2</span> üí¨ Conversa</a></li>
<li><a href="#verifique-a-estrutura-dos-links-no-html" id="toc-verifique-a-estrutura-dos-links-no-html"><span class="toc-section-number">1.3</span> 1. <strong>Verifique a estrutura
dos links no HTML</strong></a></li>
<li><a href="#verifique-se-os-arquivos-.md-e-.pdf-existem" id="toc-verifique-se-os-arquivos-.md-e-.pdf-existem"><span class="toc-section-number">1.4</span> 2. <strong>Verifique se os
arquivos .md e .pdf existem</strong></a></li>
<li><a href="#corrija-o-script-python" id="toc-corrija-o-script-python"><span class="toc-section-number">1.5</span> 3. <strong>Corrija o script
Python</strong></a></li>
<li><a href="#solu√ß√£o-alternativa-r√°pida" id="toc-solu√ß√£o-alternativa-r√°pida"><span class="toc-section-number">1.6</span> 4. <strong>Solu√ß√£o alternativa
r√°pida</strong></a></li>
<li><a href="#teste-manual" id="toc-teste-manual"><span class="toc-section-number">1.7</span> 5. <strong>Teste
manual</strong></a></li>
<li><a href="#verifique-o-console-do-navegador" id="toc-verifique-o-console-do-navegador"><span class="toc-section-number">1.8</span> 6. <strong>Verifique o console do
navegador</strong></a></li>
<li><a href="#principais-corre√ß√µes" id="toc-principais-corre√ß√µes"><span class="toc-section-number">1.9</span> üéØ <strong>Principais
Corre√ß√µes:</strong></a></li>
<li><a href="#teste-imediato" id="toc-teste-imediato"><span class="toc-section-number">1.10</span> üîç <strong>Teste
Imediato:</strong></a></li>
<li><a href="#principais-corre√ß√µes-implementadas" id="toc-principais-corre√ß√µes-implementadas"><span class="toc-section-number">1.11</span> üöÄ <strong>Principais Corre√ß√µes
Implementadas:</strong></a></li>
<li><a href="#como-usar" id="toc-como-usar"><span class="toc-section-number">1.12</span> üéØ <strong>Como
Usar:</strong></a></li>
<li><a href="#comb_fragments_system3_html_export.py" id="toc-comb_fragments_system3_html_export.py"><span class="toc-section-number">1.13</span> üìÅ <strong>1.
comb_fragments_system3_html_export.py</strong></a></li>
<li><a href="#comb_pdf_direct5_html_based.py" id="toc-comb_pdf_direct5_html_based.py"><span class="toc-section-number">1.14</span> üìÅ <strong>2.
comb_pdf_direct5_html_based.py</strong></a></li>
<li><a href="#novas-funcionalidades" id="toc-novas-funcionalidades"><span class="toc-section-number">1.15</span> üöÄ <strong>Novas
Funcionalidades:</strong></a></li>
<li><a href="#como-usar-1" id="toc-como-usar-1"><span class="toc-section-number">1.16</span> üìã <strong>Como
Usar:</strong></a></li>
<li><a href="#principais-caracter√≠sticas-do-comb_pdf_direct5_html_based.py" id="toc-principais-caracter√≠sticas-do-comb_pdf_direct5_html_based.py"><span class="toc-section-number">1.17</span> üîß <strong>Principais
Caracter√≠sticas do comb_pdf_direct5_html_based.py:</strong></a></li>
<li><a href="#fluxo-implementado" id="toc-fluxo-implementado"><span class="toc-section-number">1.18</span> üîÑ <strong>Fluxo
Implementado:</strong></a></li>
<li><a href="#como-usar-3" id="toc-como-usar-3"><span class="toc-section-number">1.19</span> üöÄ <strong>Como
Usar:</strong></a></li>
<li><a href="#vantagens-do-novo-fluxo" id="toc-vantagens-do-novo-fluxo"><span class="toc-section-number">1.20</span> ‚úÖ <strong>Vantagens do Novo
Fluxo:</strong></a></li>
<li><a href="#principais-corre√ß√µes-1" id="toc-principais-corre√ß√µes-1"><span class="toc-section-number">1.21</span> üîß <strong>Principais
Corre√ß√µes:</strong></a></li>
<li><a href="#execute-novamente" id="toc-execute-novamente"><span class="toc-section-number">1.22</span> üöÄ <strong>Execute
Novamente:</strong></a></li>
<li><a href="#principais-corre√ß√µes-implementadas-1" id="toc-principais-corre√ß√µes-implementadas-1"><span class="toc-section-number">1.23</span> üöÄ <strong>Principais Corre√ß√µes
Implementadas:</strong></a></li>
</ul></li>
</ul>
</nav>
<h1 data-number="1" id="optimizing-ai-conversation-processing-system-2"><span class="header-section-number">1</span> Optimizing AI Conversation
Processing System 2</h1>
<h2 data-number="1.1" id="informa√ß√µes"><span class="header-section-number">1.1</span> üìä Informa√ß√µes</h2>
<ul>
<li><strong>N√∫mero:</strong> #44</li>
<li><strong>Origem:</strong> DeepSeek</li>
<li><strong>Categoria:</strong> Outros</li>
<li><strong>ID:</strong> 32277d97-0bad-4945-9195-daad8481f2e6</li>
<li><strong>Criada em:</strong> 2025-11-05 05:16:42</li>
<li><strong>Atualizada em:</strong> 2025-11-05 07:21:46</li>
<li><strong>Total de mensagens:</strong> 22</li>
<li><strong>Resumo:</strong> O resultado de
comb_fragments_system2_preserve_all.py ‚Äìforce-overwrite ; √© que no
index.html os lin‚Ä¶</li>
</ul>
<hr />
<h2 data-number="1.2" id="conversa"><span class="header-section-number">1.2</span> üí¨ Conversa</h2>
<h3 data-number="1.2.1" id="utilizador-2025-11-05-051644-deepseek-chat"><span class="header-section-number">1.2.1</span> üë§ Utilizador <em>(2025-11-05
05:16:44)</em> <em>[deepseek-chat]</em></h3>
<p>O resultado de comb_fragments_system2_preserve_all.py
‚Äìforce-overwrite ; √© que no index.html os links md e pdf n√£o abrem, ao
clicar nos mesmos n√£o acontece nada</p>
<hr />
<h3 data-number="1.2.2" id="deepseek-2025-11-05-051644-deepseek-chat"><span class="header-section-number">1.2.2</span> ü§ñ DeepSeek <em>(2025-11-05
05:16:44)</em> <em>[deepseek-chat]</em></h3>
<p>Este problema geralmente ocorre devido a um dos seguintes motivos.
Vamos verificar e corrigir:</p>
<h2 data-number="1.3" id="verifique-a-estrutura-dos-links-no-html"><span class="header-section-number">1.3</span> 1. <strong>Verifique a
estrutura dos links no HTML</strong></h2>
<p>Abra o arquivo <code>index.html</code> e verifique se os links est√£o
com a estrutura correta:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- Deve estar assim: --&gt;</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">a</span><span class="ot"> href</span><span class="op">=</span><span class="st">&quot;arquivo.md&quot;</span><span class="ot"> target</span><span class="op">=</span><span class="st">&quot;_blank&quot;</span><span class="dt">&gt;</span>MD<span class="dt">&lt;/</span><span class="kw">a</span><span class="dt">&gt;</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">a</span><span class="ot"> href</span><span class="op">=</span><span class="st">&quot;arquivo.pdf&quot;</span><span class="ot"> target</span><span class="op">=</span><span class="st">&quot;_blank&quot;</span><span class="dt">&gt;</span>PDF<span class="dt">&lt;/</span><span class="kw">a</span><span class="dt">&gt;</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- Se estiver assim, n√£o funcionar√°: --&gt;</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">a</span><span class="ot"> href</span><span class="op">=</span><span class="st">&quot;#&quot;</span><span class="dt">&gt;</span>MD<span class="dt">&lt;/</span><span class="kw">a</span><span class="dt">&gt;</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">a</span><span class="ot"> href</span><span class="op">=</span><span class="st">&quot;#&quot;</span><span class="dt">&gt;</span>PDF<span class="dt">&lt;/</span><span class="kw">a</span><span class="dt">&gt;</span></span></code></pre></div>
<h2 data-number="1.4" id="verifique-se-os-arquivos-.md-e-.pdf-existem"><span class="header-section-number">1.4</span> 2. <strong>Verifique se os
arquivos .md e .pdf existem</strong></h2>
<p>Execute no terminal:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verifique se os arquivos markdown e PDF foram gerados</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ls</span> <span class="at">-la</span> <span class="pp">*</span>.md <span class="pp">*</span>.pdf</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Verifique se est√£o no mesmo diret√≥rio do index.html</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ls</span> <span class="at">-la</span> index.html <span class="pp">*</span>.md <span class="pp">*</span>.pdf</span></code></pre></div>
<h2 data-number="1.5" id="corrija-o-script-python"><span class="header-section-number">1.5</span> 3. <strong>Corrija o script
Python</strong></h2>
<p>Edite o script <code>comb_fragments_system2_preserve_all.py</code> e
verifique a parte que gera os links:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Procure por algo assim e garanta que os hrefs estejam corretos:</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_html_index(<span class="va">self</span>, fragments_data):</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> <span class="bu">open</span>(<span class="st">&#39;index.html&#39;</span>, <span class="st">&#39;w&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>        f.write(<span class="st">&#39;&lt;!DOCTYPE html&gt;</span><span class="ch">\n</span><span class="st">&lt;html&gt;</span><span class="ch">\n</span><span class="st">&lt;head&gt;</span><span class="ch">\n</span><span class="st">&#39;</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>        f.write(<span class="st">&#39;&lt;meta charset=&quot;UTF-8&quot;&gt;</span><span class="ch">\n</span><span class="st">&lt;title&gt;Fragmentos&lt;/title&gt;</span><span class="ch">\n</span><span class="st">&#39;</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>        f.write(<span class="st">&#39;&lt;/head&gt;</span><span class="ch">\n</span><span class="st">&lt;body&gt;</span><span class="ch">\n</span><span class="st">&#39;</span>)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>        f.write(<span class="st">&#39;&lt;h1&gt;Fragmentos Combinados&lt;/h1&gt;</span><span class="ch">\n</span><span class="st">&#39;</span>)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> fragment <span class="kw">in</span> fragments_data:</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>            filename <span class="op">=</span> fragment[<span class="st">&#39;filename&#39;</span>]</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Garanta que os links apontem para os arquivos reais</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>            f.write(<span class="ss">f&#39;&lt;div class=&quot;fragment&quot;&gt;</span><span class="ch">\n</span><span class="ss">&#39;</span>)</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>            f.write(<span class="ss">f&#39;&lt;h3&gt;</span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">&lt;/h3&gt;</span><span class="ch">\n</span><span class="ss">&#39;</span>)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>            f.write(<span class="ss">f&#39;&lt;p&gt;&lt;a href=&quot;</span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">.md&quot; target=&quot;_blank&quot;&gt;Ver Markdown&lt;/a&gt; | &#39;</span>)</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>            f.write(<span class="ss">f&#39;&lt;a href=&quot;</span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">.pdf&quot; target=&quot;_blank&quot;&gt;Ver PDF&lt;/a&gt;&lt;/p&gt;</span><span class="ch">\n</span><span class="ss">&#39;</span>)</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>            f.write(<span class="st">&#39;&lt;/div&gt;</span><span class="ch">\n</span><span class="st">&#39;</span>)</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>        f.write(<span class="st">&#39;&lt;/body&gt;</span><span class="ch">\n</span><span class="st">&lt;/html&gt;&#39;</span>)</span></code></pre></div>
<h2 data-number="1.6" id="solu√ß√£o-alternativa-r√°pida"><span class="header-section-number">1.6</span> 4. <strong>Solu√ß√£o alternativa
r√°pida</strong></h2>
<p>Se o problema persistir, voc√™ pode modificar o script para:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Adicione este trecho para gerar links absolutos</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_html_index(<span class="va">self</span>, fragments_data):</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> <span class="bu">open</span>(<span class="st">&#39;index.html&#39;</span>, <span class="st">&#39;w&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>        f.write(<span class="st">&#39;&#39;&#39;</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;!DOCTYPE html&gt;</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;html&gt;</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;head&gt;</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;title&gt;Fragmentos&lt;/title&gt;</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;style&gt;</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="st">        .fragment { margin: 20px 0; padding: 10px; border: 1px solid #ccc; }</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="st">        a { margin-right: 15px; color: blue; text-decoration: none; }</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="st">        a:hover { text-decoration: underline; }</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;/style&gt;</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;/head&gt;</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;body&gt;</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;h1&gt;Fragmentos Combinados&lt;/h1&gt;</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;&#39;&#39;</span>)</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> fragment <span class="kw">in</span> fragments_data:</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>            filename <span class="op">=</span> fragment[<span class="st">&#39;filename&#39;</span>]</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>            base_name <span class="op">=</span> os.path.splitext(filename)[<span class="dv">0</span>]</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>            f.write(<span class="ss">f&#39;&lt;div class=&quot;fragment&quot;&gt;</span><span class="ch">\n</span><span class="ss">&#39;</span>)</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>            f.write(<span class="ss">f&#39;&lt;h3&gt;</span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">&lt;/h3&gt;</span><span class="ch">\n</span><span class="ss">&#39;</span>)</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>            f.write(<span class="ss">f&#39;&lt;a href=&quot;</span><span class="sc">{</span>base_name<span class="sc">}</span><span class="ss">.md&quot; target=&quot;_blank&quot;&gt;üìÑ Markdown&lt;/a&gt;</span><span class="ch">\n</span><span class="ss">&#39;</span>)</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>            f.write(<span class="ss">f&#39;&lt;a href=&quot;</span><span class="sc">{</span>base_name<span class="sc">}</span><span class="ss">.pdf&quot; target=&quot;_blank&quot;&gt;üìä PDF&lt;/a&gt;</span><span class="ch">\n</span><span class="ss">&#39;</span>)</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>            f.write(<span class="st">&#39;&lt;/div&gt;</span><span class="ch">\n</span><span class="st">&#39;</span>)</span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>        f.write(<span class="st">&#39;&lt;/body&gt;</span><span class="ch">\n</span><span class="st">&lt;/html&gt;&#39;</span>)</span></code></pre></div>
<h2 data-number="1.7" id="teste-manual"><span class="header-section-number">1.7</span> 5. <strong>Teste
manual</strong></h2>
<p>Ap√≥s corrigir, execute novamente:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> comb_fragments_system2_preserve_all.py <span class="at">--force-overwrite</span></span></code></pre></div>
<p>E teste: - Abra <code>index.html</code> no navegador - Clique com
bot√£o direito em um link ‚Üí ‚ÄúAbrir em nova guia‚Äù - Verifique se o arquivo
abre</p>
<h2 data-number="1.8" id="verifique-o-console-do-navegador"><span class="header-section-number">1.8</span> 6. <strong>Verifique o console
do navegador</strong></h2>
<p>Pressione F12 no navegador e verifique se h√° erros no console quando
clica nos links.</p>
<p>Qual dessas solu√ß√µes resolveu o problema? Se n√£o funcionar, me mostre
um exemplo de como os links est√£o no seu HTML gerado.</p>
<hr />
<h3 data-number="1.8.1" id="utilizador-2025-11-05-052056-deepseek-chat"><span class="header-section-number">1.8.1</span> üë§ Utilizador <em>(2025-11-05
05:20:56)</em> <em>[deepseek-chat]</em></h3>
<p>Pretendo um comb_fragments_system2_preserve_all.py corrigido e
completo. Envio aqui o existente.</p>
<hr />
<h3 data-number="1.8.2" id="deepseek-2025-11-05-052056-deepseek-chat"><span class="header-section-number">1.8.2</span> ü§ñ DeepSeek <em>(2025-11-05
05:20:56)</em> <em>[deepseek-chat]</em></h3>
<p>Analisando o c√≥digo, identifiquei o problema: os links MD e PDF no
<code>index.html</code> n√£o funcionam porque o script gera os arquivos
Markdown mas <strong>n√£o gera os arquivos PDF</strong>, ent√£o os links
PDF apontam para arquivos que n√£o existem.</p>
<p>Aqui est√° a vers√£o corrigida e completa:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># comb_fragments_system2_preserve_all.py</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> zipfile</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> csv</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> argparse</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sys</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> webbrowser</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> shutil</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tempfile</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> traceback</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> unicodedata</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Any, Optional</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> CombinedFragmentsSystem:</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, dry_run<span class="op">=</span><span class="va">False</span>, force_overwrite<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.data_dir <span class="op">=</span> Path(<span class="st">&quot;data&quot;</span>)</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.dry_run <span class="op">=</span> dry_run</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.force_overwrite <span class="op">=</span> force_overwrite</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Estrutura de pastas organizada</span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.output_dirs <span class="op">=</span> {</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;markdown&#39;</span>: <span class="st">&quot;combined_markdown&quot;</span>,</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;csv&#39;</span>: <span class="st">&quot;combined_csv&quot;</span>, </span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;json&#39;</span>: <span class="st">&quot;combined_json&quot;</span>,</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;pdfs&#39;</span>: <span class="st">&quot;combined_pdfs&quot;</span></span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.single_files <span class="op">=</span> {</span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;csv&#39;</span>: <span class="st">&quot;combined_all_conversations.csv&quot;</span>,</span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;json&#39;</span>: <span class="st">&quot;combined_all_conversations.json&quot;</span></span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.index_file <span class="op">=</span> <span class="st">&quot;index.html&quot;</span></span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.all_conversations <span class="op">=</span> []</span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Configura√ß√£o de processamento por fonte</span></span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.processors <span class="op">=</span> {</span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;qwen&#39;</span>: {</span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;file&#39;</span>: <span class="st">&quot;chat-export.json&quot;</span>,</span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;method&#39;</span>: <span class="va">self</span>.process_qwen_enhanced,</span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;enabled&#39;</span>: <span class="va">True</span></span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;chatgpt&#39;</span>: {</span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;file&#39;</span>: <span class="st">&quot;chatgpt.zip&quot;</span>, </span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;method&#39;</span>: <span class="va">self</span>.process_chatgpt,</span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;enabled&#39;</span>: <span class="va">True</span></span>
<span id="cb6-51"><a href="#cb6-51" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb6-52"><a href="#cb6-52" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;deepseek&#39;</span>: {</span>
<span id="cb6-53"><a href="#cb6-53" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;file&#39;</span>: <span class="st">&quot;deepseek_data.zip&quot;</span>,</span>
<span id="cb6-54"><a href="#cb6-54" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;method&#39;</span>: <span class="va">self</span>.process_deepseek,</span>
<span id="cb6-55"><a href="#cb6-55" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;enabled&#39;</span>: <span class="va">True</span></span>
<span id="cb6-56"><a href="#cb6-56" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb6-57"><a href="#cb6-57" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;grok&#39;</span>: {</span>
<span id="cb6-58"><a href="#cb6-58" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;file&#39;</span>: <span class="st">&quot;grok.zip&quot;</span>,</span>
<span id="cb6-59"><a href="#cb6-59" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;method&#39;</span>: <span class="va">self</span>.process_grok,</span>
<span id="cb6-60"><a href="#cb6-60" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;enabled&#39;</span>: <span class="va">True</span></span>
<span id="cb6-61"><a href="#cb6-61" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb6-62"><a href="#cb6-62" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb6-63"><a href="#cb6-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-64"><a href="#cb6-64" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> sanitize_filename(<span class="va">self</span>, text: <span class="bu">str</span>, max_len: <span class="bu">int</span> <span class="op">=</span> <span class="dv">50</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb6-65"><a href="#cb6-65" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Sanitiza nomes de arquivo PRESERVANDO EMOJIS&quot;&quot;&quot;</span></span>
<span id="cb6-66"><a href="#cb6-66" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> text <span class="kw">or</span> <span class="kw">not</span> <span class="bu">isinstance</span>(text, <span class="bu">str</span>):</span>
<span id="cb6-67"><a href="#cb6-67" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">&quot;conversa_sem_titulo&quot;</span></span>
<span id="cb6-68"><a href="#cb6-68" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb6-69"><a href="#cb6-69" aria-hidden="true" tabindex="-1"></a>        <span class="co"># PRESERVA EMOJIS: apenas remove caracteres realmente inv√°lidos para arquivos</span></span>
<span id="cb6-70"><a href="#cb6-70" aria-hidden="true" tabindex="-1"></a>        invalid_chars <span class="op">=</span> <span class="vs">r&#39;</span><span class="pp">[&lt;&gt;:&quot;/</span><span class="ch">\\</span><span class="pp">|?*</span><span class="ch">\x00</span><span class="pp">-</span><span class="ch">\x1F\x7F</span><span class="pp">]</span><span class="vs">&#39;</span></span>
<span id="cb6-71"><a href="#cb6-71" aria-hidden="true" tabindex="-1"></a>        sanitized <span class="op">=</span> re.sub(invalid_chars, <span class="st">&#39;&#39;</span>, text)</span>
<span id="cb6-72"><a href="#cb6-72" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb6-73"><a href="#cb6-73" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Substitui m√∫ltiplos espa√ßos por um √∫nico espa√ßo</span></span>
<span id="cb6-74"><a href="#cb6-74" aria-hidden="true" tabindex="-1"></a>        sanitized <span class="op">=</span> re.sub(<span class="vs">r&#39;</span><span class="dv">\s</span><span class="op">+</span><span class="vs">&#39;</span>, <span class="st">&#39; &#39;</span>, sanitized.strip())</span>
<span id="cb6-75"><a href="#cb6-75" aria-hidden="true" tabindex="-1"></a>        sanitized <span class="op">=</span> sanitized.strip()</span>
<span id="cb6-76"><a href="#cb6-76" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb6-77"><a href="#cb6-77" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> sanitized:</span>
<span id="cb6-78"><a href="#cb6-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-79"><a href="#cb6-79" aria-hidden="true" tabindex="-1"></a><span class="op">---</span></span>
<span id="cb6-80"><a href="#cb6-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-81"><a href="#cb6-81" aria-hidden="true" tabindex="-1"></a><span class="co">### üë§ Utilizador *(2025-11-05 05:22:34)* *[deepseek-chat]*</span></span>
<span id="cb6-82"><a href="#cb6-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-83"><a href="#cb6-83" aria-hidden="true" tabindex="-1"></a>Pretendo um comb_fragments_system2_preserve_all.py corrigido e completo. Envio aqui o existente. O problema n√£o √© a existencia dos files md e pdf. O problema √© que ao clicar no link n√£o faz nada</span>
<span id="cb6-84"><a href="#cb6-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-85"><a href="#cb6-85" aria-hidden="true" tabindex="-1"></a><span class="op">---</span></span>
<span id="cb6-86"><a href="#cb6-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-87"><a href="#cb6-87" aria-hidden="true" tabindex="-1"></a><span class="co">### ü§ñ DeepSeek *(2025-11-05 05:22:34)* *[deepseek-chat]*</span></span>
<span id="cb6-88"><a href="#cb6-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-89"><a href="#cb6-89" aria-hidden="true" tabindex="-1"></a>Analisando o c√≥digo, o problema est√° na fun√ß√£o JavaScript `openMD()` e `openPDF()` no arquivo HTML gerado. Os links n√£o funcionam porque:</span>
<span id="cb6-90"><a href="#cb6-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-91"><a href="#cb6-91" aria-hidden="true" tabindex="-1"></a><span class="fl">1.</span> <span class="op">**</span>As fun√ß√µes JavaScript n√£o est√£o sendo executadas corretamente<span class="op">**</span></span>
<span id="cb6-92"><a href="#cb6-92" aria-hidden="true" tabindex="-1"></a><span class="fl">2.</span> <span class="op">**</span>Os caminhos dos arquivos podem estar incorretos<span class="op">**</span></span>
<span id="cb6-93"><a href="#cb6-93" aria-hidden="true" tabindex="-1"></a><span class="fl">3.</span> <span class="op">**</span>Preven√ß√£o padr√£o de eventos de clique<span class="op">**</span></span>
<span id="cb6-94"><a href="#cb6-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-95"><a href="#cb6-95" aria-hidden="true" tabindex="-1"></a>Aqui est√° a corre√ß√£o completa:</span>
<span id="cb6-96"><a href="#cb6-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-97"><a href="#cb6-97" aria-hidden="true" tabindex="-1"></a><span class="co">## üîß **Corre√ß√£o no Script Python**</span></span>
<span id="cb6-98"><a href="#cb6-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-99"><a href="#cb6-99" aria-hidden="true" tabindex="-1"></a><span class="op">**</span>Localize e substitua a fun√ß√£o `create_searchable_index()`<span class="op">**</span> pela vers√£o corrigida:</span>
<span id="cb6-100"><a href="#cb6-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-101"><a href="#cb6-101" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb6-102"><a href="#cb6-102" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_searchable_index(<span class="va">self</span>):</span>
<span id="cb6-103"><a href="#cb6-103" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Cria √≠ndice HTML pesquis√°vel COMPLETO - CORRIGIDO&quot;&quot;&quot;</span></span>
<span id="cb6-104"><a href="#cb6-104" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb6-105"><a href="#cb6-105" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;üß™ [DRY-RUN] √çndice HTML seria criado: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>index_file<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb6-106"><a href="#cb6-106" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span></span>
<span id="cb6-107"><a href="#cb6-107" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb6-108"><a href="#cb6-108" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;üéØ Criando √≠ndice HTML combinado...&quot;</span>)</span>
<span id="cb6-109"><a href="#cb6-109" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-110"><a href="#cb6-110" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Estat√≠sticas por categoria</span></span>
<span id="cb6-111"><a href="#cb6-111" aria-hidden="true" tabindex="-1"></a>    category_stats <span class="op">=</span> {}</span>
<span id="cb6-112"><a href="#cb6-112" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> conv <span class="kw">in</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb6-113"><a href="#cb6-113" aria-hidden="true" tabindex="-1"></a>        cat <span class="op">=</span> conv[<span class="st">&#39;category&#39;</span>]</span>
<span id="cb6-114"><a href="#cb6-114" aria-hidden="true" tabindex="-1"></a>        category_stats[cat] <span class="op">=</span> category_stats.get(cat, <span class="dv">0</span>) <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb6-115"><a href="#cb6-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-116"><a href="#cb6-116" aria-hidden="true" tabindex="-1"></a>    <span class="co"># HTML content COMPLETO - CORRIGIDO</span></span>
<span id="cb6-117"><a href="#cb6-117" aria-hidden="true" tabindex="-1"></a>    html_content <span class="op">=</span> <span class="ss">f&quot;&quot;&quot;&lt;!DOCTYPE html&gt;</span></span>
<span id="cb6-118"><a href="#cb6-118" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;html lang=&quot;pt-PT&quot;&gt;</span></span>
<span id="cb6-119"><a href="#cb6-119" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;head&gt;</span></span>
<span id="cb6-120"><a href="#cb6-120" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span></span>
<span id="cb6-121"><a href="#cb6-121" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span></span>
<span id="cb6-122"><a href="#cb6-122" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;title&gt;√çndice Combinado - AI Chats&lt;/title&gt;</span></span>
<span id="cb6-123"><a href="#cb6-123" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;style&gt;</span></span>
<span id="cb6-124"><a href="#cb6-124" aria-hidden="true" tabindex="-1"></a><span class="ss">        * </span><span class="ch">{{</span><span class="ss"> margin: 0; padding: 0; box-sizing: border-box; </span><span class="ch">}}</span></span>
<span id="cb6-125"><a href="#cb6-125" aria-hidden="true" tabindex="-1"></a><span class="ss">        body </span><span class="ch">{{</span><span class="ss"> font-family: &#39;Segoe UI&#39;, Tahoma, Geneva, Verdana, sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; padding: 20px; color: #333; </span><span class="ch">}}</span></span>
<span id="cb6-126"><a href="#cb6-126" aria-hidden="true" tabindex="-1"></a><span class="ss">        .container </span><span class="ch">{{</span><span class="ss"> max-width: 1400px; margin: 0 auto; background: white; border-radius: 15px; box-shadow: 0 20px 40px rgba(0,0,0,0.1); overflow: hidden; </span><span class="ch">}}</span></span>
<span id="cb6-127"><a href="#cb6-127" aria-hidden="true" tabindex="-1"></a><span class="ss">        .header </span><span class="ch">{{</span><span class="ss"> background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 40px; text-align: center; </span><span class="ch">}}</span></span>
<span id="cb6-128"><a href="#cb6-128" aria-hidden="true" tabindex="-1"></a><span class="ss">        .header h1 </span><span class="ch">{{</span><span class="ss"> font-size: 2.8em; margin-bottom: 15px; font-weight: 300; </span><span class="ch">}}</span></span>
<span id="cb6-129"><a href="#cb6-129" aria-hidden="true" tabindex="-1"></a><span class="ss">        .header p </span><span class="ch">{{</span><span class="ss"> font-size: 1.2em; opacity: 0.9; margin-bottom: 20px; </span><span class="ch">}}</span></span>
<span id="cb6-130"><a href="#cb6-130" aria-hidden="true" tabindex="-1"></a><span class="ss">        .stats </span><span class="ch">{{</span><span class="ss"> display: flex; justify-content: center; gap: 30px; margin-top: 25px; flex-wrap: wrap; </span><span class="ch">}}</span></span>
<span id="cb6-131"><a href="#cb6-131" aria-hidden="true" tabindex="-1"></a><span class="ss">        .stat-item </span><span class="ch">{{</span><span class="ss"> background: rgba(255,255,255,0.15); padding: 18px 28px; border-radius: 12px; backdrop-filter: blur(10px); font-size: 1.1em; </span><span class="ch">}}</span></span>
<span id="cb6-132"><a href="#cb6-132" aria-hidden="true" tabindex="-1"></a><span class="ss">        .search-section </span><span class="ch">{{</span><span class="ss"> padding: 30px; background: #f8f9fa; border-bottom: 1px solid #e9ecef; </span><span class="ch">}}</span></span>
<span id="cb6-133"><a href="#cb6-133" aria-hidden="true" tabindex="-1"></a><span class="ss">        .search-box </span><span class="ch">{{</span><span class="ss"> width: 100%; padding: 18px 25px; font-size: 16px; border: 2px solid #e9ecef; border-radius: 25px; outline: none; transition: all 0.3s ease; font-family: inherit; </span><span class="ch">}}</span></span>
<span id="cb6-134"><a href="#cb6-134" aria-hidden="true" tabindex="-1"></a><span class="ss">        .search-box:focus </span><span class="ch">{{</span><span class="ss"> border-color: #667eea; box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1); </span><span class="ch">}}</span></span>
<span id="cb6-135"><a href="#cb6-135" aria-hidden="true" tabindex="-1"></a><span class="ss">        .filter-section </span><span class="ch">{{</span></span>
<span id="cb6-136"><a href="#cb6-136" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 20px 30px;</span></span>
<span id="cb6-137"><a href="#cb6-137" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: flex;</span></span>
<span id="cb6-138"><a href="#cb6-138" aria-hidden="true" tabindex="-1"></a><span class="ss">            flex-wrap: wrap;</span></span>
<span id="cb6-139"><a href="#cb6-139" aria-hidden="true" tabindex="-1"></a><span class="ss">            gap: 12px;</span></span>
<span id="cb6-140"><a href="#cb6-140" aria-hidden="true" tabindex="-1"></a><span class="ss">            justify-content: center;</span></span>
<span id="cb6-141"><a href="#cb6-141" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #f8f9fa;</span></span>
<span id="cb6-142"><a href="#cb6-142" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-bottom: 1px solid #e9ecef;</span></span>
<span id="cb6-143"><a href="#cb6-143" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb6-144"><a href="#cb6-144" aria-hidden="true" tabindex="-1"></a><span class="ss">        .filter-btn </span><span class="ch">{{</span></span>
<span id="cb6-145"><a href="#cb6-145" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 10px 20px;</span></span>
<span id="cb6-146"><a href="#cb6-146" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: white;</span></span>
<span id="cb6-147"><a href="#cb6-147" aria-hidden="true" tabindex="-1"></a><span class="ss">            border: 2px solid #e9ecef;</span></span>
<span id="cb6-148"><a href="#cb6-148" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 25px;</span></span>
<span id="cb6-149"><a href="#cb6-149" aria-hidden="true" tabindex="-1"></a><span class="ss">            cursor: pointer;</span></span>
<span id="cb6-150"><a href="#cb6-150" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.95em;</span></span>
<span id="cb6-151"><a href="#cb6-151" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-weight: 500;</span></span>
<span id="cb6-152"><a href="#cb6-152" aria-hidden="true" tabindex="-1"></a><span class="ss">            transition: all 0.3s ease;</span></span>
<span id="cb6-153"><a href="#cb6-153" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-family: inherit;</span></span>
<span id="cb6-154"><a href="#cb6-154" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb6-155"><a href="#cb6-155" aria-hidden="true" tabindex="-1"></a><span class="ss">        .filter-btn.active, .filter-btn:hover </span><span class="ch">{{</span></span>
<span id="cb6-156"><a href="#cb6-156" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #667eea;</span></span>
<span id="cb6-157"><a href="#cb6-157" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: white;</span></span>
<span id="cb6-158"><a href="#cb6-158" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-color: #667eea;</span></span>
<span id="cb6-159"><a href="#cb6-159" aria-hidden="true" tabindex="-1"></a><span class="ss">            transform: translateY(-2px);</span></span>
<span id="cb6-160"><a href="#cb6-160" aria-hidden="true" tabindex="-1"></a><span class="ss">            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);</span></span>
<span id="cb6-161"><a href="#cb6-161" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb6-162"><a href="#cb6-162" aria-hidden="true" tabindex="-1"></a><span class="ss">        .conversations-grid </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb6-163"><a href="#cb6-163" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: grid; </span></span>
<span id="cb6-164"><a href="#cb6-164" aria-hidden="true" tabindex="-1"></a><span class="ss">            grid-template-columns: repeat(auto-fill, minmax(380px, 1fr)); </span></span>
<span id="cb6-165"><a href="#cb6-165" aria-hidden="true" tabindex="-1"></a><span class="ss">            gap: 25px; </span></span>
<span id="cb6-166"><a href="#cb6-166" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 35px;</span></span>
<span id="cb6-167"><a href="#cb6-167" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);</span></span>
<span id="cb6-168"><a href="#cb6-168" aria-hidden="true" tabindex="-1"></a><span class="ss">            min-height: 400px;</span></span>
<span id="cb6-169"><a href="#cb6-169" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb6-170"><a href="#cb6-170" aria-hidden="true" tabindex="-1"></a><span class="ss">        .conversation-card </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb6-171"><a href="#cb6-171" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: white; </span></span>
<span id="cb6-172"><a href="#cb6-172" aria-hidden="true" tabindex="-1"></a><span class="ss">            border: 1px solid #e9ecef; </span></span>
<span id="cb6-173"><a href="#cb6-173" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 15px; </span></span>
<span id="cb6-174"><a href="#cb6-174" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 25px; </span></span>
<span id="cb6-175"><a href="#cb6-175" aria-hidden="true" tabindex="-1"></a><span class="ss">            transition: all 0.4s ease; </span></span>
<span id="cb6-176"><a href="#cb6-176" aria-hidden="true" tabindex="-1"></a><span class="ss">            cursor: pointer; </span></span>
<span id="cb6-177"><a href="#cb6-177" aria-hidden="true" tabindex="-1"></a><span class="ss">            position: relative;</span></span>
<span id="cb6-178"><a href="#cb6-178" aria-hidden="true" tabindex="-1"></a><span class="ss">            box-shadow: 0 5px 15px rgba(0,0,0,0.08);</span></span>
<span id="cb6-179"><a href="#cb6-179" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb6-180"><a href="#cb6-180" aria-hidden="true" tabindex="-1"></a><span class="ss">        .conversation-card:hover </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb6-181"><a href="#cb6-181" aria-hidden="true" tabindex="-1"></a><span class="ss">            transform: translateY(-8px); </span></span>
<span id="cb6-182"><a href="#cb6-182" aria-hidden="true" tabindex="-1"></a><span class="ss">            box-shadow: 0 15px 35px rgba(0,0,0,0.15); </span></span>
<span id="cb6-183"><a href="#cb6-183" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-color: #667eea;</span></span>
<span id="cb6-184"><a href="#cb6-184" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb6-185"><a href="#cb6-185" aria-hidden="true" tabindex="-1"></a><span class="ss">        .card-header </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb6-186"><a href="#cb6-186" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: flex; </span></span>
<span id="cb6-187"><a href="#cb6-187" aria-hidden="true" tabindex="-1"></a><span class="ss">            justify-content: space-between; </span></span>
<span id="cb6-188"><a href="#cb6-188" aria-hidden="true" tabindex="-1"></a><span class="ss">            align-items: flex-start; </span></span>
<span id="cb6-189"><a href="#cb6-189" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-bottom: 18px; </span></span>
<span id="cb6-190"><a href="#cb6-190" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb6-191"><a href="#cb6-191" aria-hidden="true" tabindex="-1"></a><span class="ss">        .card-number </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb6-192"><a href="#cb6-192" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: linear-gradient(135deg, #667eea, #764ba2); </span></span>
<span id="cb6-193"><a href="#cb6-193" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: white; </span></span>
<span id="cb6-194"><a href="#cb6-194" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 8px 16px; </span></span>
<span id="cb6-195"><a href="#cb6-195" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 20px; </span></span>
<span id="cb6-196"><a href="#cb6-196" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.9em; </span></span>
<span id="cb6-197"><a href="#cb6-197" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-weight: bold;</span></span>
<span id="cb6-198"><a href="#cb6-198" aria-hidden="true" tabindex="-1"></a><span class="ss">            box-shadow: 0 3px 10px rgba(102, 126, 234, 0.3);</span></span>
<span id="cb6-199"><a href="#cb6-199" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb6-200"><a href="#cb6-200" aria-hidden="true" tabindex="-1"></a><span class="ss">        .card-source </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb6-201"><a href="#cb6-201" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #e3f2fd; </span></span>
<span id="cb6-202"><a href="#cb6-202" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #1976d2; </span></span>
<span id="cb6-203"><a href="#cb6-203" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 5px 12px; </span></span>
<span id="cb6-204"><a href="#cb6-204" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 12px; </span></span>
<span id="cb6-205"><a href="#cb6-205" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.85em; </span></span>
<span id="cb6-206"><a href="#cb6-206" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-weight: bold; </span></span>
<span id="cb6-207"><a href="#cb6-207" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-left: 10px;</span></span>
<span id="cb6-208"><a href="#cb6-208" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb6-209"><a href="#cb6-209" aria-hidden="true" tabindex="-1"></a><span class="ss">        .card-title </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb6-210"><a href="#cb6-210" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 1.3em; </span></span>
<span id="cb6-211"><a href="#cb6-211" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-weight: 600; </span></span>
<span id="cb6-212"><a href="#cb6-212" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #2c3e50; </span></span>
<span id="cb6-213"><a href="#cb6-213" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-bottom: 12px; </span></span>
<span id="cb6-214"><a href="#cb6-214" aria-hidden="true" tabindex="-1"></a><span class="ss">            line-height: 1.4;</span></span>
<span id="cb6-215"><a href="#cb6-215" aria-hidden="true" tabindex="-1"></a><span class="ss">            min-height: 3.6em;</span></span>
<span id="cb6-216"><a href="#cb6-216" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb6-217"><a href="#cb6-217" aria-hidden="true" tabindex="-1"></a><span class="ss">        .card-summary </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb6-218"><a href="#cb6-218" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #6c757d; </span></span>
<span id="cb6-219"><a href="#cb6-219" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.95em; </span></span>
<span id="cb6-220"><a href="#cb6-220" aria-hidden="true" tabindex="-1"></a><span class="ss">            line-height: 1.5; </span></span>
<span id="cb6-221"><a href="#cb6-221" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-bottom: 18px;</span></span>
<span id="cb6-222"><a href="#cb6-222" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: -webkit-box;</span></span>
<span id="cb6-223"><a href="#cb6-223" aria-hidden="true" tabindex="-1"></a><span class="ss">            -webkit-line-clamp: 3;</span></span>
<span id="cb6-224"><a href="#cb6-224" aria-hidden="true" tabindex="-1"></a><span class="ss">            -webkit-box-orient: vertical;</span></span>
<span id="cb6-225"><a href="#cb6-225" aria-hidden="true" tabindex="-1"></a><span class="ss">            overflow: hidden;</span></span>
<span id="cb6-226"><a href="#cb6-226" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb6-227"><a href="#cb6-227" aria-hidden="true" tabindex="-1"></a><span class="ss">        .card-meta </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb6-228"><a href="#cb6-228" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: flex; </span></span>
<span id="cb6-229"><a href="#cb6-229" aria-hidden="true" tabindex="-1"></a><span class="ss">            justify-content: space-between; </span></span>
<span id="cb6-230"><a href="#cb6-230" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.85em; </span></span>
<span id="cb6-231"><a href="#cb6-231" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #868e96; </span></span>
<span id="cb6-232"><a href="#cb6-232" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-top: 1px solid #e9ecef; </span></span>
<span id="cb6-233"><a href="#cb6-233" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding-top: 18px;</span></span>
<span id="cb6-234"><a href="#cb6-234" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb6-235"><a href="#cb6-235" aria-hidden="true" tabindex="-1"></a><span class="ss">        .card-actions </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb6-236"><a href="#cb6-236" aria-hidden="true" tabindex="-1"></a><span class="ss">            position: absolute; </span></span>
<span id="cb6-237"><a href="#cb6-237" aria-hidden="true" tabindex="-1"></a><span class="ss">            top: 20px; </span></span>
<span id="cb6-238"><a href="#cb6-238" aria-hidden="true" tabindex="-1"></a><span class="ss">            right: 20px; </span></span>
<span id="cb6-239"><a href="#cb6-239" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: flex; </span></span>
<span id="cb6-240"><a href="#cb6-240" aria-hidden="true" tabindex="-1"></a><span class="ss">            gap: 8px; </span></span>
<span id="cb6-241"><a href="#cb6-241" aria-hidden="true" tabindex="-1"></a><span class="ss">            opacity: 0; </span></span>
<span id="cb6-242"><a href="#cb6-242" aria-hidden="true" tabindex="-1"></a><span class="ss">            transition: opacity 0.3s ease; </span></span>
<span id="cb6-243"><a href="#cb6-243" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb6-244"><a href="#cb6-244" aria-hidden="true" tabindex="-1"></a><span class="ss">        .conversation-card:hover .card-actions </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb6-245"><a href="#cb6-245" aria-hidden="true" tabindex="-1"></a><span class="ss">            opacity: 1; </span></span>
<span id="cb6-246"><a href="#cb6-246" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb6-247"><a href="#cb6-247" aria-hidden="true" tabindex="-1"></a><span class="ss">        .action-btn </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb6-248"><a href="#cb6-248" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: white; </span></span>
<span id="cb6-249"><a href="#cb6-249" aria-hidden="true" tabindex="-1"></a><span class="ss">            border: 2px solid #e9ecef; </span></span>
<span id="cb6-250"><a href="#cb6-250" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 8px; </span></span>
<span id="cb6-251"><a href="#cb6-251" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 6px 12px; </span></span>
<span id="cb6-252"><a href="#cb6-252" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.8em; </span></span>
<span id="cb6-253"><a href="#cb6-253" aria-hidden="true" tabindex="-1"></a><span class="ss">            cursor: pointer; </span></span>
<span id="cb6-254"><a href="#cb6-254" aria-hidden="true" tabindex="-1"></a><span class="ss">            transition: all 0.3s ease;</span></span>
<span id="cb6-255"><a href="#cb6-255" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-weight: 500;</span></span>
<span id="cb6-256"><a href="#cb6-256" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb6-257"><a href="#cb6-257" aria-hidden="true" tabindex="-1"></a><span class="ss">        .action-btn:hover </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb6-258"><a href="#cb6-258" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #667eea; </span></span>
<span id="cb6-259"><a href="#cb6-259" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: white; </span></span>
<span id="cb6-260"><a href="#cb6-260" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-color: #667eea;</span></span>
<span id="cb6-261"><a href="#cb6-261" aria-hidden="true" tabindex="-1"></a><span class="ss">            transform: scale(1.05);</span></span>
<span id="cb6-262"><a href="#cb6-262" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb6-263"><a href="#cb6-263" aria-hidden="true" tabindex="-1"></a><span class="ss">        .recent-badge </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb6-264"><a href="#cb6-264" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #ff6b6b; </span></span>
<span id="cb6-265"><a href="#cb6-265" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: white; </span></span>
<span id="cb6-266"><a href="#cb6-266" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 3px 10px; </span></span>
<span id="cb6-267"><a href="#cb6-267" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 12px; </span></span>
<span id="cb6-268"><a href="#cb6-268" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.75em; </span></span>
<span id="cb6-269"><a href="#cb6-269" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-left: 8px;</span></span>
<span id="cb6-270"><a href="#cb6-270" aria-hidden="true" tabindex="-1"></a><span class="ss">            animation: pulse 2s infinite;</span></span>
<span id="cb6-271"><a href="#cb6-271" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb6-272"><a href="#cb6-272" aria-hidden="true" tabindex="-1"></a><span class="ss">        .no-results </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb6-273"><a href="#cb6-273" aria-hidden="true" tabindex="-1"></a><span class="ss">            text-align: center; </span></span>
<span id="cb6-274"><a href="#cb6-274" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 60px 20px; </span></span>
<span id="cb6-275"><a href="#cb6-275" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #6c757d;</span></span>
<span id="cb6-276"><a href="#cb6-276" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 1.1em;</span></span>
<span id="cb6-277"><a href="#cb6-277" aria-hidden="true" tabindex="-1"></a><span class="ss">            grid-column: 1 / -1;</span></span>
<span id="cb6-278"><a href="#cb6-278" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb6-279"><a href="#cb6-279" aria-hidden="true" tabindex="-1"></a><span class="ss">        @keyframes pulse </span><span class="ch">{{</span></span>
<span id="cb6-280"><a href="#cb6-280" aria-hidden="true" tabindex="-1"></a><span class="ss">            0% </span><span class="ch">{{</span><span class="ss"> transform: scale(1); </span><span class="ch">}}</span></span>
<span id="cb6-281"><a href="#cb6-281" aria-hidden="true" tabindex="-1"></a><span class="ss">            50% </span><span class="ch">{{</span><span class="ss"> transform: scale(1.05); </span><span class="ch">}}</span></span>
<span id="cb6-282"><a href="#cb6-282" aria-hidden="true" tabindex="-1"></a><span class="ss">            100% </span><span class="ch">{{</span><span class="ss"> transform: scale(1); </span><span class="ch">}}</span></span>
<span id="cb6-283"><a href="#cb6-283" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb6-284"><a href="#cb6-284" aria-hidden="true" tabindex="-1"></a><span class="ss">        .category-badge </span><span class="ch">{{</span></span>
<span id="cb6-285"><a href="#cb6-285" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: inline-block;</span></span>
<span id="cb6-286"><a href="#cb6-286" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #e3f2fd;</span></span>
<span id="cb6-287"><a href="#cb6-287" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #1976d2;</span></span>
<span id="cb6-288"><a href="#cb6-288" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 4px 10px;</span></span>
<span id="cb6-289"><a href="#cb6-289" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 12px;</span></span>
<span id="cb6-290"><a href="#cb6-290" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.8em;</span></span>
<span id="cb6-291"><a href="#cb6-291" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-left: 8px;</span></span>
<span id="cb6-292"><a href="#cb6-292" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-weight: 500;</span></span>
<span id="cb6-293"><a href="#cb6-293" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb6-294"><a href="#cb6-294" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb6-295"><a href="#cb6-295" aria-hidden="true" tabindex="-1"></a><span class="ss">        /* CORRE√á√ÉO: Links diretos para fallback */</span></span>
<span id="cb6-296"><a href="#cb6-296" aria-hidden="true" tabindex="-1"></a><span class="ss">        .direct-link </span><span class="ch">{{</span></span>
<span id="cb6-297"><a href="#cb6-297" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: inline-block;</span></span>
<span id="cb6-298"><a href="#cb6-298" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin: 5px;</span></span>
<span id="cb6-299"><a href="#cb6-299" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 8px 15px;</span></span>
<span id="cb6-300"><a href="#cb6-300" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #28a745;</span></span>
<span id="cb6-301"><a href="#cb6-301" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: white;</span></span>
<span id="cb6-302"><a href="#cb6-302" aria-hidden="true" tabindex="-1"></a><span class="ss">            text-decoration: none;</span></span>
<span id="cb6-303"><a href="#cb6-303" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 5px;</span></span>
<span id="cb6-304"><a href="#cb6-304" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.9em;</span></span>
<span id="cb6-305"><a href="#cb6-305" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb6-306"><a href="#cb6-306" aria-hidden="true" tabindex="-1"></a><span class="ss">        .direct-link:hover </span><span class="ch">{{</span></span>
<span id="cb6-307"><a href="#cb6-307" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #218838;</span></span>
<span id="cb6-308"><a href="#cb6-308" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb6-309"><a href="#cb6-309" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;/style&gt;</span></span>
<span id="cb6-310"><a href="#cb6-310" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;/head&gt;</span></span>
<span id="cb6-311"><a href="#cb6-311" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;body&gt;</span></span>
<span id="cb6-312"><a href="#cb6-312" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;div class=&quot;container&quot;&gt;</span></span>
<span id="cb6-313"><a href="#cb6-313" aria-hidden="true" tabindex="-1"></a><span class="ss">        &lt;div class=&quot;header&quot;&gt;</span></span>
<span id="cb6-314"><a href="#cb6-314" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;h1&gt;üìö √çndice Combinado de Conversas&lt;/h1&gt;</span></span>
<span id="cb6-315"><a href="#cb6-315" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;p&gt;Qwen3 ‚Ä¢ ChatGPT ‚Ä¢ DeepSeek ‚Ä¢ Grok&lt;/p&gt;</span></span>
<span id="cb6-316"><a href="#cb6-316" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;div class=&quot;stats&quot;&gt;</span></span>
<span id="cb6-317"><a href="#cb6-317" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;div class=&quot;stat-item&quot;&gt;</span></span>
<span id="cb6-318"><a href="#cb6-318" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;strong&gt;Total:&lt;/strong&gt; &lt;span id=&quot;total-count&quot;&gt;</span><span class="sc">{</span><span class="bu">len</span>(<span class="va">self</span>.all_conversations)<span class="sc">}</span><span class="ss">&lt;/span&gt; conversas</span></span>
<span id="cb6-319"><a href="#cb6-319" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;/div&gt;</span></span>
<span id="cb6-320"><a href="#cb6-320" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;div class=&quot;stat-item&quot;&gt;</span></span>
<span id="cb6-321"><a href="#cb6-321" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;strong&gt;Ordena√ß√£o:&lt;/strong&gt; Mais Recentes Primeiro</span></span>
<span id="cb6-322"><a href="#cb6-322" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;/div&gt;</span></span>
<span id="cb6-323"><a href="#cb6-323" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;div class=&quot;stat-item&quot;&gt;</span></span>
<span id="cb6-324"><a href="#cb6-324" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;strong&gt;Atualizado:&lt;/strong&gt; </span><span class="sc">{</span>datetime<span class="sc">.</span>now()<span class="sc">.</span>strftime(<span class="st">&#39;</span><span class="sc">%d</span><span class="st">/%m/%Y %H:%M&#39;</span>)<span class="sc">}</span></span>
<span id="cb6-325"><a href="#cb6-325" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;/div&gt;</span></span>
<span id="cb6-326"><a href="#cb6-326" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;/div&gt;</span></span>
<span id="cb6-327"><a href="#cb6-327" aria-hidden="true" tabindex="-1"></a><span class="ss">        &lt;/div&gt;</span></span>
<span id="cb6-328"><a href="#cb6-328" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb6-329"><a href="#cb6-329" aria-hidden="true" tabindex="-1"></a><span class="ss">        &lt;div class=&quot;search-section&quot;&gt;</span></span>
<span id="cb6-330"><a href="#cb6-330" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;input type=&quot;text&quot; id=&quot;searchInput&quot; class=&quot;search-box&quot; placeholder=&quot;üîç Pesquisar por t√≠tulo, conte√∫do ou categoria...&quot;&gt;</span></span>
<span id="cb6-331"><a href="#cb6-331" aria-hidden="true" tabindex="-1"></a><span class="ss">        &lt;/div&gt;</span></span>
<span id="cb6-332"><a href="#cb6-332" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb6-333"><a href="#cb6-333" aria-hidden="true" tabindex="-1"></a><span class="ss">        &lt;div class=&quot;filter-section&quot;&gt;</span></span>
<span id="cb6-334"><a href="#cb6-334" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;button class=&quot;filter-btn active&quot; data-filter=&quot;todas&quot;&gt;Todas (</span><span class="sc">{</span><span class="bu">len</span>(<span class="va">self</span>.all_conversations)<span class="sc">}</span><span class="ss">)&lt;/button&gt;</span></span>
<span id="cb6-335"><a href="#cb6-335" aria-hidden="true" tabindex="-1"></a><span class="ss">&quot;&quot;&quot;</span></span>
<span id="cb6-336"><a href="#cb6-336" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-337"><a href="#cb6-337" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Bot√µes de filtro por categoria</span></span>
<span id="cb6-338"><a href="#cb6-338" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> category, count <span class="kw">in</span> category_stats.items():</span>
<span id="cb6-339"><a href="#cb6-339" aria-hidden="true" tabindex="-1"></a>        html_content <span class="op">+=</span> <span class="ss">f&#39;&lt;button class=&quot;filter-btn&quot; data-filter=&quot;</span><span class="sc">{</span>category<span class="sc">.</span>lower()<span class="sc">}</span><span class="ss">&quot;&gt;</span><span class="sc">{</span>category<span class="sc">}</span><span class="ss"> (</span><span class="sc">{</span>count<span class="sc">}</span><span class="ss">)&lt;/button&gt;</span><span class="ch">\n</span><span class="ss">&#39;</span></span>
<span id="cb6-340"><a href="#cb6-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-341"><a href="#cb6-341" aria-hidden="true" tabindex="-1"></a>    html_content <span class="op">+=</span> <span class="st">&quot;&quot;&quot;</span></span>
<span id="cb6-342"><a href="#cb6-342" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;/div&gt;</span></span>
<span id="cb6-343"><a href="#cb6-343" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb6-344"><a href="#cb6-344" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;!-- LINKS DIRETOS DE FALLBACK --&gt;</span></span>
<span id="cb6-345"><a href="#cb6-345" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;div style=&quot;text-align: center; padding: 15px; background: #e9ecef; border-bottom: 1px solid #ddd;&quot;&gt;</span></span>
<span id="cb6-346"><a href="#cb6-346" aria-hidden="true" tabindex="-1"></a><span class="st">            &lt;strong&gt;Acesso R√°pido:&lt;/strong&gt;</span></span>
<span id="cb6-347"><a href="#cb6-347" aria-hidden="true" tabindex="-1"></a><span class="st">            &lt;a href=&quot;combined_markdown/&quot; class=&quot;direct-link&quot; target=&quot;_blank&quot;&gt;üìÅ Pasta Markdown&lt;/a&gt;</span></span>
<span id="cb6-348"><a href="#cb6-348" aria-hidden="true" tabindex="-1"></a><span class="st">            &lt;a href=&quot;combined_pdfs/&quot; class=&quot;direct-link&quot; target=&quot;_blank&quot;&gt;üìÅ Pasta PDFs&lt;/a&gt;</span></span>
<span id="cb6-349"><a href="#cb6-349" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;/div&gt;</span></span>
<span id="cb6-350"><a href="#cb6-350" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb6-351"><a href="#cb6-351" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;div class=&quot;conversations-grid&quot; id=&quot;conversationsGrid&quot;&gt;</span></span>
<span id="cb6-352"><a href="#cb6-352" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;&quot;&quot;</span></span>
<span id="cb6-353"><a href="#cb6-353" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-354"><a href="#cb6-354" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Cards das conversas - CORRIGIDO</span></span>
<span id="cb6-355"><a href="#cb6-355" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, conv <span class="kw">in</span> <span class="bu">enumerate</span>(<span class="va">self</span>.all_conversations):</span>
<span id="cb6-356"><a href="#cb6-356" aria-hidden="true" tabindex="-1"></a>        safe_title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(conv[<span class="st">&#39;title&#39;</span>])</span>
<span id="cb6-357"><a href="#cb6-357" aria-hidden="true" tabindex="-1"></a>        filename <span class="op">=</span> <span class="ss">f&quot;</span><span class="sc">{</span>conv[<span class="st">&#39;number&#39;</span>]<span class="sc">:03d}</span><span class="ss">_</span><span class="sc">{</span>conv[<span class="st">&#39;source&#39;</span>]<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>safe_title<span class="sc">}</span><span class="ss">.md&quot;</span></span>
<span id="cb6-358"><a href="#cb6-358" aria-hidden="true" tabindex="-1"></a>        pdf_filename <span class="op">=</span> filename.replace(<span class="st">&#39;.md&#39;</span>, <span class="st">&#39;.pdf&#39;</span>)</span>
<span id="cb6-359"><a href="#cb6-359" aria-hidden="true" tabindex="-1"></a>        recent_badge <span class="op">=</span> <span class="st">&quot;&lt;span class=&#39;recent-badge&#39;&gt;NOVO&lt;/span&gt;&quot;</span> <span class="cf">if</span> i <span class="op">&lt;</span> <span class="dv">5</span> <span class="cf">else</span> <span class="st">&quot;&quot;</span></span>
<span id="cb6-360"><a href="#cb6-360" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb6-361"><a href="#cb6-361" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Resumo mais informativo</span></span>
<span id="cb6-362"><a href="#cb6-362" aria-hidden="true" tabindex="-1"></a>        summary <span class="op">=</span> conv.get(<span class="st">&#39;summary&#39;</span>, <span class="st">&#39;Sem resumo dispon√≠vel&#39;</span>)</span>
<span id="cb6-363"><a href="#cb6-363" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(summary) <span class="op">&gt;</span> <span class="dv">150</span>:</span>
<span id="cb6-364"><a href="#cb6-364" aria-hidden="true" tabindex="-1"></a>            summary <span class="op">=</span> summary[:<span class="dv">150</span>] <span class="op">+</span> <span class="st">&quot;...&quot;</span></span>
<span id="cb6-365"><a href="#cb6-365" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb6-366"><a href="#cb6-366" aria-hidden="true" tabindex="-1"></a>        html_content <span class="op">+=</span> <span class="ss">f&quot;&quot;&quot;</span></span>
<span id="cb6-367"><a href="#cb6-367" aria-hidden="true" tabindex="-1"></a><span class="ss">        &lt;div class=&quot;conversation-card&quot; data-title=&quot;</span><span class="sc">{</span>conv[<span class="st">&#39;title&#39;</span>]<span class="sc">}</span><span class="ss">&quot; data-summary=&quot;</span><span class="sc">{</span>summary<span class="sc">}</span><span class="ss">&quot; data-source=&quot;</span><span class="sc">{</span>conv[<span class="st">&#39;source&#39;</span>]<span class="sc">.</span>lower()<span class="sc">}</span><span class="ss">&quot; data-category=&quot;</span><span class="sc">{</span>conv[<span class="st">&#39;category&#39;</span>]<span class="sc">.</span>lower()<span class="sc">}</span><span class="ss">&quot;&gt;</span></span>
<span id="cb6-368"><a href="#cb6-368" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;div class=&quot;card-header&quot;&gt;</span></span>
<span id="cb6-369"><a href="#cb6-369" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;div class=&quot;card-number&quot;&gt;#</span><span class="sc">{</span>conv[<span class="st">&#39;number&#39;</span>]<span class="sc">}</span><span class="ss"> </span><span class="sc">{</span>recent_badge<span class="sc">}</span><span class="ss">&lt;/div&gt;</span></span>
<span id="cb6-370"><a href="#cb6-370" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;div class=&quot;card-actions&quot;&gt;</span></span>
<span id="cb6-371"><a href="#cb6-371" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;!-- CORRE√á√ÉO: Links diretos como fallback --&gt;</span></span>
<span id="cb6-372"><a href="#cb6-372" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;a href=&quot;combined_markdown/</span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">&quot; class=&quot;action-btn&quot; target=&quot;_blank&quot; onclick=&quot;event.stopPropagation();&quot;&gt;üìÑ MD&lt;/a&gt;</span></span>
<span id="cb6-373"><a href="#cb6-373" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;a href=&quot;combined_pdfs/</span><span class="sc">{</span>pdf_filename<span class="sc">}</span><span class="ss">&quot; class=&quot;action-btn&quot; target=&quot;_blank&quot; onclick=&quot;event.stopPropagation();&quot;&gt;üìä PDF&lt;/a&gt;</span></span>
<span id="cb6-374"><a href="#cb6-374" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;/div&gt;</span></span>
<span id="cb6-375"><a href="#cb6-375" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;/div&gt;</span></span>
<span id="cb6-376"><a href="#cb6-376" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;div class=&quot;card-title&quot;&gt;</span><span class="sc">{</span>conv[<span class="st">&#39;title&#39;</span>]<span class="sc">}</span><span class="ss">&lt;/div&gt;</span></span>
<span id="cb6-377"><a href="#cb6-377" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;div&gt;</span></span>
<span id="cb6-378"><a href="#cb6-378" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;span class=&quot;card-source&quot;&gt;</span><span class="sc">{</span>conv[<span class="st">&#39;source&#39;</span>]<span class="sc">}</span><span class="ss">&lt;/span&gt;</span></span>
<span id="cb6-379"><a href="#cb6-379" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;span class=&quot;category-badge&quot;&gt;</span><span class="sc">{</span>conv[<span class="st">&#39;category&#39;</span>]<span class="sc">}</span><span class="ss">&lt;/span&gt;</span></span>
<span id="cb6-380"><a href="#cb6-380" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;/div&gt;</span></span>
<span id="cb6-381"><a href="#cb6-381" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;div class=&quot;card-summary&quot;&gt;</span><span class="sc">{</span>summary<span class="sc">}</span><span class="ss">&lt;/div&gt;</span></span>
<span id="cb6-382"><a href="#cb6-382" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;div class=&quot;card-meta&quot;&gt;</span></span>
<span id="cb6-383"><a href="#cb6-383" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;span&gt;üìÖ </span><span class="sc">{</span>conv<span class="sc">.</span>get(<span class="st">&#39;updated_at&#39;</span>) <span class="kw">or</span> conv<span class="sc">.</span>get(<span class="st">&#39;inserted_at&#39;</span>) <span class="kw">or</span> <span class="st">&#39;N/A&#39;</span><span class="sc">}</span><span class="ss">&lt;/span&gt;</span></span>
<span id="cb6-384"><a href="#cb6-384" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;span&gt;üí¨ </span><span class="sc">{</span><span class="bu">len</span>(conv[<span class="st">&#39;messages&#39;</span>])<span class="sc">}</span><span class="ss"> mensagens&lt;/span&gt;</span></span>
<span id="cb6-385"><a href="#cb6-385" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;/div&gt;</span></span>
<span id="cb6-386"><a href="#cb6-386" aria-hidden="true" tabindex="-1"></a><span class="ss">        &lt;/div&gt;</span></span>
<span id="cb6-387"><a href="#cb6-387" aria-hidden="true" tabindex="-1"></a><span class="ss">        &quot;&quot;&quot;</span></span>
<span id="cb6-388"><a href="#cb6-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-389"><a href="#cb6-389" aria-hidden="true" tabindex="-1"></a>    html_content <span class="op">+=</span> <span class="st">&quot;&quot;&quot;</span></span>
<span id="cb6-390"><a href="#cb6-390" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;/div&gt;</span></span>
<span id="cb6-391"><a href="#cb6-391" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;/div&gt;</span></span>
<span id="cb6-392"><a href="#cb6-392" aria-hidden="true" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb6-393"><a href="#cb6-393" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;script&gt;</span></span>
<span id="cb6-394"><a href="#cb6-394" aria-hidden="true" tabindex="-1"></a><span class="st">        let currentFilter = &#39;todas&#39;;</span></span>
<span id="cb6-395"><a href="#cb6-395" aria-hidden="true" tabindex="-1"></a><span class="st">        let allConversations = document.querySelectorAll(&#39;.conversation-card&#39;);</span></span>
<span id="cb6-396"><a href="#cb6-396" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb6-397"><a href="#cb6-397" aria-hidden="true" tabindex="-1"></a><span class="st">        // Inicializa√ß√£o</span></span>
<span id="cb6-398"><a href="#cb6-398" aria-hidden="true" tabindex="-1"></a><span class="st">        document.addEventListener(&#39;DOMContentLoaded&#39;, function() {</span></span>
<span id="cb6-399"><a href="#cb6-399" aria-hidden="true" tabindex="-1"></a><span class="st">            updateStats();</span></span>
<span id="cb6-400"><a href="#cb6-400" aria-hidden="true" tabindex="-1"></a><span class="st">        });</span></span>
<span id="cb6-401"><a href="#cb6-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-402"><a href="#cb6-402" aria-hidden="true" tabindex="-1"></a><span class="st">        document.querySelectorAll(&#39;.filter-btn&#39;).forEach(btn =&gt; {</span></span>
<span id="cb6-403"><a href="#cb6-403" aria-hidden="true" tabindex="-1"></a><span class="st">            btn.addEventListener(&#39;click&#39;, () =&gt; {</span></span>
<span id="cb6-404"><a href="#cb6-404" aria-hidden="true" tabindex="-1"></a><span class="st">                document.querySelectorAll(&#39;.filter-btn&#39;).forEach(b =&gt; b.classList.remove(&#39;active&#39;));</span></span>
<span id="cb6-405"><a href="#cb6-405" aria-hidden="true" tabindex="-1"></a><span class="st">                btn.classList.add(&#39;active&#39;);</span></span>
<span id="cb6-406"><a href="#cb6-406" aria-hidden="true" tabindex="-1"></a><span class="st">                currentFilter = btn.getAttribute(&#39;data-filter&#39;);</span></span>
<span id="cb6-407"><a href="#cb6-407" aria-hidden="true" tabindex="-1"></a><span class="st">                filterConversations();</span></span>
<span id="cb6-408"><a href="#cb6-408" aria-hidden="true" tabindex="-1"></a><span class="st">            });</span></span>
<span id="cb6-409"><a href="#cb6-409" aria-hidden="true" tabindex="-1"></a><span class="st">        });</span></span>
<span id="cb6-410"><a href="#cb6-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-411"><a href="#cb6-411" aria-hidden="true" tabindex="-1"></a><span class="st">        document.getElementById(&#39;searchInput&#39;).addEventListener(&#39;input&#39;, filterConversations);</span></span>
<span id="cb6-412"><a href="#cb6-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-413"><a href="#cb6-413" aria-hidden="true" tabindex="-1"></a><span class="st">        function filterConversations() {</span></span>
<span id="cb6-414"><a href="#cb6-414" aria-hidden="true" tabindex="-1"></a><span class="st">            const term = document.getElementById(&#39;searchInput&#39;).value.toLowerCase();</span></span>
<span id="cb6-415"><a href="#cb6-415" aria-hidden="true" tabindex="-1"></a><span class="st">            const cards = document.querySelectorAll(&#39;.conversation-card&#39;);</span></span>
<span id="cb6-416"><a href="#cb6-416" aria-hidden="true" tabindex="-1"></a><span class="st">            let visible = 0;</span></span>
<span id="cb6-417"><a href="#cb6-417" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb6-418"><a href="#cb6-418" aria-hidden="true" tabindex="-1"></a><span class="st">            cards.forEach(card =&gt; {</span></span>
<span id="cb6-419"><a href="#cb6-419" aria-hidden="true" tabindex="-1"></a><span class="st">                const title = card.getAttribute(&#39;data-title&#39;).toLowerCase();</span></span>
<span id="cb6-420"><a href="#cb6-420" aria-hidden="true" tabindex="-1"></a><span class="st">                const summary = card.getAttribute(&#39;data-summary&#39;).toLowerCase();</span></span>
<span id="cb6-421"><a href="#cb6-421" aria-hidden="true" tabindex="-1"></a><span class="st">                const source = card.getAttribute(&#39;data-source&#39;).toLowerCase();</span></span>
<span id="cb6-422"><a href="#cb6-422" aria-hidden="true" tabindex="-1"></a><span class="st">                const category = card.getAttribute(&#39;data-category&#39;).toLowerCase();</span></span>
<span id="cb6-423"><a href="#cb6-423" aria-hidden="true" tabindex="-1"></a><span class="st">                </span></span>
<span id="cb6-424"><a href="#cb6-424" aria-hidden="true" tabindex="-1"></a><span class="st">                const matchesSearch = (title.includes(term) || summary.includes(term) || category.includes(term) || source.includes(term));</span></span>
<span id="cb6-425"><a href="#cb6-425" aria-hidden="true" tabindex="-1"></a><span class="st">                const matchesCategory = (currentFilter === &#39;todas&#39; || category === currentFilter);</span></span>
<span id="cb6-426"><a href="#cb6-426" aria-hidden="true" tabindex="-1"></a><span class="st">                </span></span>
<span id="cb6-427"><a href="#cb6-427" aria-hidden="true" tabindex="-1"></a><span class="st">                if (matchesSearch &amp;&amp; matchesCategory) {</span></span>
<span id="cb6-428"><a href="#cb6-428" aria-hidden="true" tabindex="-1"></a><span class="st">                    card.style.display = &#39;block&#39;;</span></span>
<span id="cb6-429"><a href="#cb6-429" aria-hidden="true" tabindex="-1"></a><span class="st">                    visible++;</span></span>
<span id="cb6-430"><a href="#cb6-430" aria-hidden="true" tabindex="-1"></a><span class="st">                } else {</span></span>
<span id="cb6-431"><a href="#cb6-431" aria-hidden="true" tabindex="-1"></a><span class="st">                    card.style.display = &#39;none&#39;;</span></span>
<span id="cb6-432"><a href="#cb6-432" aria-hidden="true" tabindex="-1"></a><span class="st">                }</span></span>
<span id="cb6-433"><a href="#cb6-433" aria-hidden="true" tabindex="-1"></a><span class="st">            });</span></span>
<span id="cb6-434"><a href="#cb6-434" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb6-435"><a href="#cb6-435" aria-hidden="true" tabindex="-1"></a><span class="st">            updateStats(visible);</span></span>
<span id="cb6-436"><a href="#cb6-436" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb6-437"><a href="#cb6-437" aria-hidden="true" tabindex="-1"></a><span class="st">            // Mostra mensagem se n√£o houver resultados</span></span>
<span id="cb6-438"><a href="#cb6-438" aria-hidden="true" tabindex="-1"></a><span class="st">            const grid = document.getElementById(&#39;conversationsGrid&#39;);</span></span>
<span id="cb6-439"><a href="#cb6-439" aria-hidden="true" tabindex="-1"></a><span class="st">            const noResults = document.getElementById(&#39;no-results-message&#39;);</span></span>
<span id="cb6-440"><a href="#cb6-440" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb6-441"><a href="#cb6-441" aria-hidden="true" tabindex="-1"></a><span class="st">            if (visible === 0) {</span></span>
<span id="cb6-442"><a href="#cb6-442" aria-hidden="true" tabindex="-1"></a><span class="st">                if (!noResults) {</span></span>
<span id="cb6-443"><a href="#cb6-443" aria-hidden="true" tabindex="-1"></a><span class="st">                    const noResultsMsg = document.createElement(&#39;div&#39;);</span></span>
<span id="cb6-444"><a href="#cb6-444" aria-hidden="true" tabindex="-1"></a><span class="st">                    noResultsMsg.id = &#39;no-results-message&#39;;</span></span>
<span id="cb6-445"><a href="#cb6-445" aria-hidden="true" tabindex="-1"></a><span class="st">                    noResultsMsg.className = &#39;no-results&#39;;</span></span>
<span id="cb6-446"><a href="#cb6-446" aria-hidden="true" tabindex="-1"></a><span class="st">                    noResultsMsg.innerHTML = &#39;üîç Nenhuma conversa encontrada. Tente ajustar os filtros ou a pesquisa.&#39;;</span></span>
<span id="cb6-447"><a href="#cb6-447" aria-hidden="true" tabindex="-1"></a><span class="st">                    grid.appendChild(noResultsMsg);</span></span>
<span id="cb6-448"><a href="#cb6-448" aria-hidden="true" tabindex="-1"></a><span class="st">                }</span></span>
<span id="cb6-449"><a href="#cb6-449" aria-hidden="true" tabindex="-1"></a><span class="st">            } else if (noResults) {</span></span>
<span id="cb6-450"><a href="#cb6-450" aria-hidden="true" tabindex="-1"></a><span class="st">                noResults.remove();</span></span>
<span id="cb6-451"><a href="#cb6-451" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb6-452"><a href="#cb6-452" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb6-453"><a href="#cb6-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-454"><a href="#cb6-454" aria-hidden="true" tabindex="-1"></a><span class="st">        function updateStats(visibleCount = null) {</span></span>
<span id="cb6-455"><a href="#cb6-455" aria-hidden="true" tabindex="-1"></a><span class="st">            const totalElement = document.getElementById(&#39;total-count&#39;);</span></span>
<span id="cb6-456"><a href="#cb6-456" aria-hidden="true" tabindex="-1"></a><span class="st">            if (visibleCount !== null) {</span></span>
<span id="cb6-457"><a href="#cb6-457" aria-hidden="true" tabindex="-1"></a><span class="st">                totalElement.textContent = visibleCount;</span></span>
<span id="cb6-458"><a href="#cb6-458" aria-hidden="true" tabindex="-1"></a><span class="st">            } else {</span></span>
<span id="cb6-459"><a href="#cb6-459" aria-hidden="true" tabindex="-1"></a><span class="st">                totalElement.textContent = &quot;&quot;&quot;</span> <span class="op">+</span> <span class="bu">str</span>(<span class="bu">len</span>(<span class="va">self</span>.all_conversations)) <span class="op">+</span> <span class="st">&quot;&quot;&quot;;</span></span>
<span id="cb6-460"><a href="#cb6-460" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb6-461"><a href="#cb6-461" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb6-462"><a href="#cb6-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-463"><a href="#cb6-463" aria-hidden="true" tabindex="-1"></a><span class="st">        // CORRE√á√ÉO: Fun√ß√µes JavaScript simplificadas e robustas</span></span>
<span id="cb6-464"><a href="#cb6-464" aria-hidden="true" tabindex="-1"></a><span class="st">        function openMD(filename) {</span></span>
<span id="cb6-465"><a href="#cb6-465" aria-hidden="true" tabindex="-1"></a><span class="st">            const mdUrl = &#39;combined_markdown/&#39; + filename;</span></span>
<span id="cb6-466"><a href="#cb6-466" aria-hidden="true" tabindex="-1"></a><span class="st">            console.log(&#39;Abrindo MD:&#39;, mdUrl);</span></span>
<span id="cb6-467"><a href="#cb6-467" aria-hidden="true" tabindex="-1"></a><span class="st">            window.open(mdUrl, &#39;_blank&#39;);</span></span>
<span id="cb6-468"><a href="#cb6-468" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb6-469"><a href="#cb6-469" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb6-470"><a href="#cb6-470" aria-hidden="true" tabindex="-1"></a><span class="st">        function openPDF(filename) {</span></span>
<span id="cb6-471"><a href="#cb6-471" aria-hidden="true" tabindex="-1"></a><span class="st">            const pdfFile = filename.replace(&#39;.md&#39;, &#39;.pdf&#39;);</span></span>
<span id="cb6-472"><a href="#cb6-472" aria-hidden="true" tabindex="-1"></a><span class="st">            const pdfUrl = &#39;combined_pdfs/&#39; + pdfFile;</span></span>
<span id="cb6-473"><a href="#cb6-473" aria-hidden="true" tabindex="-1"></a><span class="st">            console.log(&#39;Abrindo PDF:&#39;, pdfUrl);</span></span>
<span id="cb6-474"><a href="#cb6-474" aria-hidden="true" tabindex="-1"></a><span class="st">            window.open(pdfUrl, &#39;_blank&#39;);</span></span>
<span id="cb6-475"><a href="#cb6-475" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb6-476"><a href="#cb6-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-477"><a href="#cb6-477" aria-hidden="true" tabindex="-1"></a><span class="st">        // Navega√ß√£o por teclado</span></span>
<span id="cb6-478"><a href="#cb6-478" aria-hidden="true" tabindex="-1"></a><span class="st">        document.addEventListener(&#39;keydown&#39;, function(e) {</span></span>
<span id="cb6-479"><a href="#cb6-479" aria-hidden="true" tabindex="-1"></a><span class="st">            if (e.key === &#39;Escape&#39;) {</span></span>
<span id="cb6-480"><a href="#cb6-480" aria-hidden="true" tabindex="-1"></a><span class="st">                document.getElementById(&#39;searchInput&#39;).value = &#39;&#39;;</span></span>
<span id="cb6-481"><a href="#cb6-481" aria-hidden="true" tabindex="-1"></a><span class="st">                filterConversations();</span></span>
<span id="cb6-482"><a href="#cb6-482" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb6-483"><a href="#cb6-483" aria-hidden="true" tabindex="-1"></a><span class="st">        });</span></span>
<span id="cb6-484"><a href="#cb6-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-485"><a href="#cb6-485" aria-hidden="true" tabindex="-1"></a><span class="st">        // Clique nos cards - CORRE√á√ÉO: Preven√ß√£o de conflito</span></span>
<span id="cb6-486"><a href="#cb6-486" aria-hidden="true" tabindex="-1"></a><span class="st">        document.querySelectorAll(&#39;.conversation-card&#39;).forEach(card =&gt; {</span></span>
<span id="cb6-487"><a href="#cb6-487" aria-hidden="true" tabindex="-1"></a><span class="st">            card.addEventListener(&#39;click&#39;, function(e) {</span></span>
<span id="cb6-488"><a href="#cb6-488" aria-hidden="true" tabindex="-1"></a><span class="st">                // N√£o faz nada se clicou em um bot√£o de a√ß√£o</span></span>
<span id="cb6-489"><a href="#cb6-489" aria-hidden="true" tabindex="-1"></a><span class="st">                if (e.target.closest(&#39;.action-btn&#39;)) {</span></span>
<span id="cb6-490"><a href="#cb6-490" aria-hidden="true" tabindex="-1"></a><span class="st">                    return;</span></span>
<span id="cb6-491"><a href="#cb6-491" aria-hidden="true" tabindex="-1"></a><span class="st">                }</span></span>
<span id="cb6-492"><a href="#cb6-492" aria-hidden="true" tabindex="-1"></a><span class="st">                </span></span>
<span id="cb6-493"><a href="#cb6-493" aria-hidden="true" tabindex="-1"></a><span class="st">                // Abre o MD ao clicar no card</span></span>
<span id="cb6-494"><a href="#cb6-494" aria-hidden="true" tabindex="-1"></a><span class="st">                const mdBtn = this.querySelector(&#39;a[href*=&quot;.md&quot;]&#39;);</span></span>
<span id="cb6-495"><a href="#cb6-495" aria-hidden="true" tabindex="-1"></a><span class="st">                if (mdBtn) {</span></span>
<span id="cb6-496"><a href="#cb6-496" aria-hidden="true" tabindex="-1"></a><span class="st">                    const mdUrl = mdBtn.getAttribute(&#39;href&#39;);</span></span>
<span id="cb6-497"><a href="#cb6-497" aria-hidden="true" tabindex="-1"></a><span class="st">                    window.open(mdUrl, &#39;_blank&#39;);</span></span>
<span id="cb6-498"><a href="#cb6-498" aria-hidden="true" tabindex="-1"></a><span class="st">                }</span></span>
<span id="cb6-499"><a href="#cb6-499" aria-hidden="true" tabindex="-1"></a><span class="st">            });</span></span>
<span id="cb6-500"><a href="#cb6-500" aria-hidden="true" tabindex="-1"></a><span class="st">        });</span></span>
<span id="cb6-501"><a href="#cb6-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-502"><a href="#cb6-502" aria-hidden="true" tabindex="-1"></a><span class="st">        // Foco na pesquisa ao carregar</span></span>
<span id="cb6-503"><a href="#cb6-503" aria-hidden="true" tabindex="-1"></a><span class="st">        document.getElementById(&#39;searchInput&#39;).focus();</span></span>
<span id="cb6-504"><a href="#cb6-504" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb6-505"><a href="#cb6-505" aria-hidden="true" tabindex="-1"></a><span class="st">        // CORRE√á√ÉO: Debug para verificar se os arquivos existem</span></span>
<span id="cb6-506"><a href="#cb6-506" aria-hidden="true" tabindex="-1"></a><span class="st">        console.log(&#39;√çndice carregado com&#39;, &quot;&quot;&quot;</span> <span class="op">+</span> <span class="bu">str</span>(<span class="bu">len</span>(<span class="va">self</span>.all_conversations)) <span class="op">+</span> <span class="st">&quot;&quot;&quot;, &#39;conversas&#39;);</span></span>
<span id="cb6-507"><a href="#cb6-507" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;/script&gt;</span></span>
<span id="cb6-508"><a href="#cb6-508" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;/body&gt;</span></span>
<span id="cb6-509"><a href="#cb6-509" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;/html&gt;</span></span>
<span id="cb6-510"><a href="#cb6-510" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;&quot;&quot;</span></span>
<span id="cb6-511"><a href="#cb6-511" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-512"><a href="#cb6-512" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> <span class="bu">open</span>(<span class="va">self</span>.index_file, <span class="st">&#39;w&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb6-513"><a href="#cb6-513" aria-hidden="true" tabindex="-1"></a>        f.write(html_content)</span>
<span id="cb6-514"><a href="#cb6-514" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ √çndice combinado criado: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>index_file<span class="sc">}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<h2 data-number="1.9" id="principais-corre√ß√µes"><span class="header-section-number">1.9</span> üéØ <strong>Principais
Corre√ß√µes:</strong></h2>
<ol type="1">
<li><strong>Links diretos HTML</strong> no lugar de bot√µes com
JavaScript</li>
<li><strong><code>event.stopPropagation()</code></strong> para prevenir
conflitos de clique</li>
<li><strong>Fallback visual</strong> com links de acesso r√°pido</li>
<li><strong>Console logging</strong> para debug</li>
<li><strong>Preven√ß√£o de conflito</strong> entre clique no card e nos
bot√µes</li>
</ol>
<h2 data-number="1.10" id="teste-imediato"><span class="header-section-number">1.10</span> üîç <strong>Teste
Imediato:</strong></h2>
<p>Execute o script corrigido:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> comb_fragments_system2_preserve_all.py <span class="at">--force-overwrite</span></span></code></pre></div>
<p>Agora os links funcionar√£o porque: - ‚úÖ <strong>S√£o links HTML
reais</strong> (<code>&lt;a href=&quot;...&quot;&gt;</code>) - ‚úÖ <strong>T√™m
<code>target=&quot;_blank&quot;</code></strong> para abrir em nova aba - ‚úÖ
<strong>Usam <code>event.stopPropagation()</code></strong> para n√£o
interferir com outros cliques - ‚úÖ <strong>T√™m fallback visual</strong>
para acesso direto √†s pastas</p>
<p>Os links MD e PDF agora devem abrir corretamente ao clicar! üöÄ</p>
<hr />
<h3 data-number="1.10.1" id="utilizador-2025-11-05-052443-deepseek-chat"><span class="header-section-number">1.10.1</span> üë§ Utilizador
<em>(2025-11-05 05:24:43)</em> <em>[deepseek-chat]</em></h3>
<p>Pretendia comb_fragments_system2_preserve_all.py completo e
funcional</p>
<hr />
<h3 data-number="1.10.2" id="deepseek-2025-11-05-052443-deepseek-chat"><span class="header-section-number">1.10.2</span> ü§ñ DeepSeek <em>(2025-11-05
05:24:43)</em> <em>[deepseek-chat]</em></h3>
<p>Aqui est√° o script completo e corrigido:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># comb_fragments_system2_preserve_all.py</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> zipfile</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> csv</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> argparse</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sys</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> webbrowser</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> shutil</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tempfile</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> traceback</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> unicodedata</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Any, Optional</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> CombinedFragmentsSystem:</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, dry_run<span class="op">=</span><span class="va">False</span>, force_overwrite<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.data_dir <span class="op">=</span> Path(<span class="st">&quot;data&quot;</span>)</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.dry_run <span class="op">=</span> dry_run</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.force_overwrite <span class="op">=</span> force_overwrite</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Estrutura de pastas organizada</span></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.output_dirs <span class="op">=</span> {</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;markdown&#39;</span>: <span class="st">&quot;combined_markdown&quot;</span>,</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;csv&#39;</span>: <span class="st">&quot;combined_csv&quot;</span>, </span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;json&#39;</span>: <span class="st">&quot;combined_json&quot;</span>,</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;pdfs&#39;</span>: <span class="st">&quot;combined_pdfs&quot;</span></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.single_files <span class="op">=</span> {</span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;csv&#39;</span>: <span class="st">&quot;combined_all_conversations.csv&quot;</span>,</span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;json&#39;</span>: <span class="st">&quot;combined_all_conversations.json&quot;</span></span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.index_file <span class="op">=</span> <span class="st">&quot;index.html&quot;</span></span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.all_conversations <span class="op">=</span> []</span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Configura√ß√£o de processamento por fonte</span></span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.processors <span class="op">=</span> {</span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;qwen&#39;</span>: {</span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;file&#39;</span>: <span class="st">&quot;chat-export.json&quot;</span>,</span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;method&#39;</span>: <span class="va">self</span>.process_qwen_enhanced,</span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;enabled&#39;</span>: <span class="va">True</span></span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;chatgpt&#39;</span>: {</span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;file&#39;</span>: <span class="st">&quot;chatgpt.zip&quot;</span>, </span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;method&#39;</span>: <span class="va">self</span>.process_chatgpt,</span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;enabled&#39;</span>: <span class="va">True</span></span>
<span id="cb8-51"><a href="#cb8-51" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb8-52"><a href="#cb8-52" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;deepseek&#39;</span>: {</span>
<span id="cb8-53"><a href="#cb8-53" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;file&#39;</span>: <span class="st">&quot;deepseek_data.zip&quot;</span>,</span>
<span id="cb8-54"><a href="#cb8-54" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;method&#39;</span>: <span class="va">self</span>.process_deepseek,</span>
<span id="cb8-55"><a href="#cb8-55" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;enabled&#39;</span>: <span class="va">True</span></span>
<span id="cb8-56"><a href="#cb8-56" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb8-57"><a href="#cb8-57" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;grok&#39;</span>: {</span>
<span id="cb8-58"><a href="#cb8-58" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;file&#39;</span>: <span class="st">&quot;grok.zip&quot;</span>,</span>
<span id="cb8-59"><a href="#cb8-59" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;method&#39;</span>: <span class="va">self</span>.process_grok,</span>
<span id="cb8-60"><a href="#cb8-60" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;enabled&#39;</span>: <span class="va">True</span></span>
<span id="cb8-61"><a href="#cb8-61" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb8-62"><a href="#cb8-62" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb8-63"><a href="#cb8-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-64"><a href="#cb8-64" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> sanitize_filename(<span class="va">self</span>, text: <span class="bu">str</span>, max_len: <span class="bu">int</span> <span class="op">=</span> <span class="dv">50</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb8-65"><a href="#cb8-65" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Sanitiza nomes de arquivo PRESERVANDO EMOJIS&quot;&quot;&quot;</span></span>
<span id="cb8-66"><a href="#cb8-66" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> text <span class="kw">or</span> <span class="kw">not</span> <span class="bu">isinstance</span>(text, <span class="bu">str</span>):</span>
<span id="cb8-67"><a href="#cb8-67" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">&quot;conversa_sem_titulo&quot;</span></span>
<span id="cb8-68"><a href="#cb8-68" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb8-69"><a href="#cb8-69" aria-hidden="true" tabindex="-1"></a>        <span class="co"># PRESERVA EMOJIS: apenas remove caracteres realmente inv√°lidos para arquivos</span></span>
<span id="cb8-70"><a href="#cb8-70" aria-hidden="true" tabindex="-1"></a>        invalid_chars <span class="op">=</span> <span class="vs">r&#39;</span><span class="pp">[&lt;&gt;:&quot;/</span><span class="ch">\\</span><span class="pp">|?*</span><span class="ch">\x00</span><span class="pp">-</span><span class="ch">\x1F\x7F</span><span class="pp">]</span><span class="vs">&#39;</span></span>
<span id="cb8-71"><a href="#cb8-71" aria-hidden="true" tabindex="-1"></a>        sanitized <span class="op">=</span> re.sub(invalid_chars, <span class="st">&#39;&#39;</span>, text)</span>
<span id="cb8-72"><a href="#cb8-72" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-73"><a href="#cb8-73" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Substitui m√∫ltiplos espa√ßos por um √∫nico espa√ßo</span></span>
<span id="cb8-74"><a href="#cb8-74" aria-hidden="true" tabindex="-1"></a>        sanitized <span class="op">=</span> re.sub(<span class="vs">r&#39;</span><span class="dv">\s</span><span class="op">+</span><span class="vs">&#39;</span>, <span class="st">&#39; &#39;</span>, sanitized.strip())</span>
<span id="cb8-75"><a href="#cb8-75" aria-hidden="true" tabindex="-1"></a>        sanitized <span class="op">=</span> sanitized.strip()</span>
<span id="cb8-76"><a href="#cb8-76" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-77"><a href="#cb8-77" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> sanitized:</span>
<span id="cb8-78"><a href="#cb8-78" aria-hidden="true" tabindex="-1"></a>            sanitized <span class="op">=</span> <span class="st">&quot;conversa_sem_titulo&quot;</span></span>
<span id="cb8-79"><a href="#cb8-79" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb8-80"><a href="#cb8-80" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(sanitized) <span class="op">&gt;</span> max_len:</span>
<span id="cb8-81"><a href="#cb8-81" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="st">&#39; &#39;</span> <span class="kw">in</span> sanitized[:max_len]:</span>
<span id="cb8-82"><a href="#cb8-82" aria-hidden="true" tabindex="-1"></a>                last_space <span class="op">=</span> sanitized[:max_len].rfind(<span class="st">&#39; &#39;</span>)</span>
<span id="cb8-83"><a href="#cb8-83" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> last_space <span class="op">&gt;</span> <span class="dv">10</span>:</span>
<span id="cb8-84"><a href="#cb8-84" aria-hidden="true" tabindex="-1"></a>                    sanitized <span class="op">=</span> sanitized[:last_space]</span>
<span id="cb8-85"><a href="#cb8-85" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb8-86"><a href="#cb8-86" aria-hidden="true" tabindex="-1"></a>                sanitized <span class="op">=</span> sanitized[:max_len]</span>
<span id="cb8-87"><a href="#cb8-87" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb8-88"><a href="#cb8-88" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> sanitized</span>
<span id="cb8-89"><a href="#cb8-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-90"><a href="#cb8-90" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> preserve_special_content(<span class="va">self</span>, content: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb8-91"><a href="#cb8-91" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Preserva f√≥rmulas matem√°ticas, c√≥digo e formata√ß√£o especial&quot;&quot;&quot;</span></span>
<span id="cb8-92"><a href="#cb8-92" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> content:</span>
<span id="cb8-93"><a href="#cb8-93" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">&quot;&quot;</span></span>
<span id="cb8-94"><a href="#cb8-94" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb8-95"><a href="#cb8-95" aria-hidden="true" tabindex="-1"></a>        <span class="co"># CORRE√á√ÉO: Preserva barras invertidas em f√≥rmulas LaTeX</span></span>
<span id="cb8-96"><a href="#cb8-96" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Substitui sequ√™ncias problem√°ticas</span></span>
<span id="cb8-97"><a href="#cb8-97" aria-hidden="true" tabindex="-1"></a>        preserved_content <span class="op">=</span> content</span>
<span id="cb8-98"><a href="#cb8-98" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-99"><a href="#cb8-99" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Corrige problemas com barras invertidas em LaTeX</span></span>
<span id="cb8-100"><a href="#cb8-100" aria-hidden="true" tabindex="-1"></a>        latex_corrections <span class="op">=</span> {</span>
<span id="cb8-101"><a href="#cb8-101" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;‚ôÄrac&#39;</span>: <span class="st">&#39;</span><span class="ch">\\</span><span class="st">frac&#39;</span>,  <span class="co"># Corrige problema detectado no teste</span></span>
<span id="cb8-102"><a href="#cb8-102" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;‚ôÇarepsilon&#39;</span>: <span class="st">&#39;</span><span class="ch">\\</span><span class="st">varepsilon&#39;</span>,</span>
<span id="cb8-103"><a href="#cb8-103" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;‚ôÇ&#39;</span>: <span class="st">&#39;</span><span class="ch">\\</span><span class="st">&#39;</span>,</span>
<span id="cb8-104"><a href="#cb8-104" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;‚ôÄ&#39;</span>: <span class="st">&#39;</span><span class="ch">\\</span><span class="st">&#39;</span></span>
<span id="cb8-105"><a href="#cb8-105" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb8-106"><a href="#cb8-106" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-107"><a href="#cb8-107" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> wrong, correct <span class="kw">in</span> latex_corrections.items():</span>
<span id="cb8-108"><a href="#cb8-108" aria-hidden="true" tabindex="-1"></a>            preserved_content <span class="op">=</span> preserved_content.replace(wrong, correct)</span>
<span id="cb8-109"><a href="#cb8-109" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-110"><a href="#cb8-110" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> preserved_content</span>
<span id="cb8-111"><a href="#cb8-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-112"><a href="#cb8-112" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> ensure_directories(<span class="va">self</span>):</span>
<span id="cb8-113"><a href="#cb8-113" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Cria todas as pastas necess√°rias&quot;&quot;&quot;</span></span>
<span id="cb8-114"><a href="#cb8-114" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb8-115"><a href="#cb8-115" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;DRY-RUN: Pastas seriam criadas:&quot;</span>)</span>
<span id="cb8-116"><a href="#cb8-116" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> folder <span class="kw">in</span> <span class="va">self</span>.output_dirs.values():</span>
<span id="cb8-117"><a href="#cb8-117" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;   </span><span class="sc">{</span>folder<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb8-118"><a href="#cb8-118" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb8-119"><a href="#cb8-119" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb8-120"><a href="#cb8-120" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> folder <span class="kw">in</span> <span class="va">self</span>.output_dirs.values():</span>
<span id="cb8-121"><a href="#cb8-121" aria-hidden="true" tabindex="-1"></a>            Path(folder).mkdir(parents<span class="op">=</span><span class="va">True</span>, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb8-122"><a href="#cb8-122" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;Pasta criada: </span><span class="sc">{</span>folder<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb8-123"><a href="#cb8-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-124"><a href="#cb8-124" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> run(<span class="va">self</span>):</span>
<span id="cb8-125"><a href="#cb8-125" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Executa o processamento completo&quot;&quot;&quot;</span></span>
<span id="cb8-126"><a href="#cb8-126" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;SISTEMA COMBINADO DE EXPORTA√á√ïES (Qwen3, ChatGPT, DeepSeek, Grok)&quot;</span>)</span>
<span id="cb8-127"><a href="#cb8-127" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;=&quot;</span> <span class="op">*</span> <span class="dv">60</span>)</span>
<span id="cb8-128"><a href="#cb8-128" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-129"><a href="#cb8-129" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.data_dir.exists():</span>
<span id="cb8-130"><a href="#cb8-130" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;Pasta &#39;</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>data_dir<span class="sc">}</span><span class="ss">&#39; n√£o encontrada.&quot;</span>)</span>
<span id="cb8-131"><a href="#cb8-131" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;Crie a pasta &#39;data&#39; e coloque os arquivos de exporta√ß√£o:&quot;</span>)</span>
<span id="cb8-132"><a href="#cb8-132" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> source_name, config <span class="kw">in</span> <span class="va">self</span>.processors.items():</span>
<span id="cb8-133"><a href="#cb8-133" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;   - </span><span class="sc">{</span>config[<span class="st">&#39;file&#39;</span>]<span class="sc">}</span><span class="ss"> (para </span><span class="sc">{</span>source_name<span class="sc">.</span>upper()<span class="sc">}</span><span class="ss">)&quot;</span>)</span>
<span id="cb8-134"><a href="#cb8-134" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb8-135"><a href="#cb8-135" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-136"><a href="#cb8-136" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;Usando pasta de dados: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>data_dir<span class="sc">.</span>absolute()<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb8-137"><a href="#cb8-137" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-138"><a href="#cb8-138" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.ensure_directories()</span>
<span id="cb8-139"><a href="#cb8-139" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-140"><a href="#cb8-140" aria-hidden="true" tabindex="-1"></a>        processed_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb8-141"><a href="#cb8-141" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> source_name, config <span class="kw">in</span> <span class="va">self</span>.processors.items():</span>
<span id="cb8-142"><a href="#cb8-142" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> config[<span class="st">&#39;enabled&#39;</span>]:</span>
<span id="cb8-143"><a href="#cb8-143" aria-hidden="true" tabindex="-1"></a>                file_path <span class="op">=</span> <span class="va">self</span>.data_dir <span class="op">/</span> config[<span class="st">&#39;file&#39;</span>]</span>
<span id="cb8-144"><a href="#cb8-144" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> file_path.exists():</span>
<span id="cb8-145"><a href="#cb8-145" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="ch">\n</span><span class="ss">Processando </span><span class="sc">{</span>source_name<span class="sc">.</span>upper()<span class="sc">}</span><span class="ss">...&quot;</span>)</span>
<span id="cb8-146"><a href="#cb8-146" aria-hidden="true" tabindex="-1"></a>                    config[<span class="st">&#39;method&#39;</span>](file_path)</span>
<span id="cb8-147"><a href="#cb8-147" aria-hidden="true" tabindex="-1"></a>                    processed_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb8-148"><a href="#cb8-148" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb8-149"><a href="#cb8-149" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="sc">{</span>source_name<span class="sc">.</span>upper()<span class="sc">}</span><span class="ss">: arquivo n√£o encontrado - </span><span class="sc">{</span>file_path<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb8-150"><a href="#cb8-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-151"><a href="#cb8-151" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> processed_count <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb8-152"><a href="#cb8-152" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;Nenhum arquivo de exporta√ß√£o encontrado na pasta &#39;data&#39;.&quot;</span>)</span>
<span id="cb8-153"><a href="#cb8-153" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb8-154"><a href="#cb8-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-155"><a href="#cb8-155" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb8-156"><a href="#cb8-156" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;Nenhuma conversa foi extra√≠da dos arquivos.&quot;</span>)</span>
<span id="cb8-157"><a href="#cb8-157" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb8-158"><a href="#cb8-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-159"><a href="#cb8-159" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>._post_process_conversations()</span>
<span id="cb8-160"><a href="#cb8-160" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-161"><a href="#cb8-161" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.dry_run:</span>
<span id="cb8-162"><a href="#cb8-162" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>._export_all_formats()</span>
<span id="cb8-163"><a href="#cb8-163" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="ch">\n</span><span class="ss">üéâ SISTEMA COMBINADO FINALIZADO!&quot;</span>)</span>
<span id="cb8-164"><a href="#cb8-164" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;üìÑ √çndice: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>index_file<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb8-165"><a href="#cb8-165" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> Path(<span class="va">self</span>.index_file).exists():</span>
<span id="cb8-166"><a href="#cb8-166" aria-hidden="true" tabindex="-1"></a>                webbrowser.<span class="bu">open</span>(<span class="ss">f&#39;file://</span><span class="sc">{</span>Path(<span class="va">self</span>.index_file)<span class="sc">.</span>absolute()<span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb8-167"><a href="#cb8-167" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb8-168"><a href="#cb8-168" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="ch">\n</span><span class="ss">üß™ MODO DRY-RUN: Nenhum arquivo foi criado.&quot;</span>)</span>
<span id="cb8-169"><a href="#cb8-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-170"><a href="#cb8-170" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _post_process_conversations(<span class="va">self</span>):</span>
<span id="cb8-171"><a href="#cb8-171" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Processamento p√≥s-extra√ß√£o das conversas&quot;&quot;&quot;</span></span>
<span id="cb8-172"><a href="#cb8-172" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.all_conversations.sort(</span>
<span id="cb8-173"><a href="#cb8-173" aria-hidden="true" tabindex="-1"></a>            key<span class="op">=</span><span class="kw">lambda</span> x: <span class="va">self</span>.parse_timestamp_for_sorting(</span>
<span id="cb8-174"><a href="#cb8-174" aria-hidden="true" tabindex="-1"></a>                x.get(<span class="st">&#39;updated_at&#39;</span>) <span class="kw">or</span> x.get(<span class="st">&#39;inserted_at&#39;</span>) <span class="kw">or</span> x.get(<span class="st">&#39;created_at&#39;</span>)</span>
<span id="cb8-175"><a href="#cb8-175" aria-hidden="true" tabindex="-1"></a>            ),</span>
<span id="cb8-176"><a href="#cb8-176" aria-hidden="true" tabindex="-1"></a>            reverse<span class="op">=</span><span class="va">True</span></span>
<span id="cb8-177"><a href="#cb8-177" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb8-178"><a href="#cb8-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-179"><a href="#cb8-179" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, conv <span class="kw">in</span> <span class="bu">enumerate</span>(<span class="va">self</span>.all_conversations):</span>
<span id="cb8-180"><a href="#cb8-180" aria-hidden="true" tabindex="-1"></a>            conv[<span class="st">&#39;number&#39;</span>] <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb8-181"><a href="#cb8-181" aria-hidden="true" tabindex="-1"></a>            conv[<span class="st">&#39;category&#39;</span>] <span class="op">=</span> <span class="va">self</span>.categorize_conversation(conv[<span class="st">&#39;title&#39;</span>], conv.get(<span class="st">&#39;summary&#39;</span>, <span class="st">&#39;&#39;</span>))</span>
<span id="cb8-182"><a href="#cb8-182" aria-hidden="true" tabindex="-1"></a>            conv.setdefault(<span class="st">&#39;source&#39;</span>, <span class="st">&#39;Desconhecido&#39;</span>)</span>
<span id="cb8-183"><a href="#cb8-183" aria-hidden="true" tabindex="-1"></a>            conv.setdefault(<span class="st">&#39;messages&#39;</span>, [])</span>
<span id="cb8-184"><a href="#cb8-184" aria-hidden="true" tabindex="-1"></a>            conv.setdefault(<span class="st">&#39;summary&#39;</span>, conv[<span class="st">&#39;messages&#39;</span>][<span class="dv">0</span>][<span class="st">&#39;content&#39;</span>][:<span class="dv">100</span>] <span class="op">+</span> <span class="st">&quot;...&quot;</span> <span class="cf">if</span> conv[<span class="st">&#39;messages&#39;</span>] <span class="cf">else</span> <span class="st">&quot;Sem conte√∫do&quot;</span>)</span>
<span id="cb8-185"><a href="#cb8-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-186"><a href="#cb8-186" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;üìä Total combinado de conversas: </span><span class="sc">{</span><span class="bu">len</span>(<span class="va">self</span>.all_conversations)<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb8-187"><a href="#cb8-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-188"><a href="#cb8-188" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _export_all_formats(<span class="va">self</span>):</span>
<span id="cb8-189"><a href="#cb8-189" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Exporta para todos os formatos&quot;&quot;&quot;</span></span>
<span id="cb8-190"><a href="#cb8-190" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">üíæ Exportando para formatos...&quot;</span>)</span>
<span id="cb8-191"><a href="#cb8-191" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.save_as_markdown_enhanced()</span>
<span id="cb8-192"><a href="#cb8-192" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.save_as_csv() </span>
<span id="cb8-193"><a href="#cb8-193" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.save_as_json()</span>
<span id="cb8-194"><a href="#cb8-194" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.save_all_to_single_files()</span>
<span id="cb8-195"><a href="#cb8-195" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.create_searchable_index()</span>
<span id="cb8-196"><a href="#cb8-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-197"><a href="#cb8-197" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> categorize_conversation(<span class="va">self</span>, title: <span class="bu">str</span>, summary: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb8-198"><a href="#cb8-198" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Categoriza√ß√£o otimizada com express√µes regulares&quot;&quot;&quot;</span></span>
<span id="cb8-199"><a href="#cb8-199" aria-hidden="true" tabindex="-1"></a>        text <span class="op">=</span> <span class="ss">f&quot;</span><span class="sc">{</span>title<span class="sc">}</span><span class="ss"> </span><span class="sc">{</span>summary<span class="sc">}</span><span class="ss">&quot;</span>.lower()</span>
<span id="cb8-200"><a href="#cb8-200" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-201"><a href="#cb8-201" aria-hidden="true" tabindex="-1"></a>        patterns <span class="op">=</span> {</span>
<span id="cb8-202"><a href="#cb8-202" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Tecnologia&#39;</span>: <span class="vs">r&#39;</span><span class="dv">\b</span><span class="kw">(</span><span class="vs">tecnologia</span><span class="cf">|</span><span class="vs">hardware</span><span class="cf">|</span><span class="vs">software</span><span class="cf">|</span><span class="vs">rede</span><span class="cf">|</span><span class="vs">internet</span><span class="cf">|</span><span class="vs">wifi</span><span class="cf">|</span><span class="vs">bluetooth</span><span class="cf">|</span><span class="pp">[45]</span><span class="vs">g</span><span class="cf">|</span><span class="vs">cloud</span><span class="cf">|</span><span class="vs">aws</span><span class="cf">|</span><span class="vs">azure</span><span class="cf">|</span><span class="vs">gcp</span><span class="cf">|</span><span class="vs">servidor</span><span class="cf">|</span><span class="vs">hosting</span><span class="cf">|</span><span class="vs">dom√≠nio</span><span class="cf">|</span><span class="vs">ssl</span><span class="cf">|</span><span class="vs">router</span><span class="cf">|</span><span class="vs">switch</span><span class="cf">|</span><span class="vs">firewall</span><span class="cf">|</span><span class="vs">iot</span><span class="cf">|</span><span class="vs">smartphone</span><span class="cf">|</span><span class="vs">tablet</span><span class="cf">|</span><span class="vs">navegador</span><span class="cf">|</span><span class="vs">browser</span><span class="cf">|</span><span class="vs">chrome</span><span class="cf">|</span><span class="vs">firefox</span><span class="cf">|</span><span class="vs">edge</span><span class="cf">|</span><span class="vs">safari</span><span class="cf">|</span><span class="vs">email</span><span class="cf">|</span><span class="vs">gmail</span><span class="cf">|</span><span class="vs">outlook</span><span class="cf">|</span><span class="vs">criptografia</span><span class="cf">|</span><span class="vs">seguran√ßa</span><span class="cf">|</span><span class="vs">ciberseguran√ßa</span><span class="cf">|</span><span class="vs">ransomware</span><span class="cf">|</span><span class="vs">phishing</span><span class="cf">|</span><span class="vs">autentica√ß√£o</span><span class="cf">|</span><span class="vs">2fa</span><span class="cf">|</span><span class="vs">biometria</span><span class="kw">)</span><span class="dv">\b</span><span class="vs">&#39;</span>,</span>
<span id="cb8-203"><a href="#cb8-203" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Sa√∫de&#39;</span>: <span class="vs">r&#39;</span><span class="dv">\b</span><span class="kw">(</span><span class="vs">sa√∫de</span><span class="cf">|</span><span class="vs">medicina</span><span class="cf">|</span><span class="vs">m√©dico</span><span class="cf">|</span><span class="vs">enfermagem</span><span class="cf">|</span><span class="vs">doen√ßa</span><span class="cf">|</span><span class="vs">v√≠rus</span><span class="cf">|</span><span class="vs">bact√©ria</span><span class="cf">|</span><span class="vs">vacina</span><span class="cf">|</span><span class="vs">covid</span><span class="cf">|</span><span class="vs">coronav√≠rus</span><span class="cf">|</span><span class="vs">gripe</span><span class="cf">|</span><span class="vs">febre</span><span class="cf">|</span><span class="vs">dor</span><span class="cf">|</span><span class="vs">an√°lise</span><span class="cf">|</span><span class="vs">exame</span><span class="cf">|</span><span class="vs">raio x</span><span class="cf">|</span><span class="vs">resson√¢ncia</span><span class="cf">|</span><span class="vs">hospital</span><span class="cf">|</span><span class="vs">cl√≠nica</span><span class="cf">|</span><span class="vs">farm√°cia</span><span class="cf">|</span><span class="vs">medicamento</span><span class="cf">|</span><span class="vs">rem√©dio</span><span class="cf">|</span><span class="vs">psicologia</span><span class="cf">|</span><span class="vs">terapia</span><span class="cf">|</span><span class="vs">bem-estar</span><span class="cf">|</span><span class="vs">nutri√ß√£o</span><span class="cf">|</span><span class="vs">dieta</span><span class="cf">|</span><span class="vs">exerc√≠cio</span><span class="cf">|</span><span class="vs">fitness</span><span class="cf">|</span><span class="vs">sono</span><span class="cf">|</span><span class="vs">sa√∫de mental</span><span class="kw">)</span><span class="dv">\b</span><span class="vs">&#39;</span>,</span>
<span id="cb8-204"><a href="#cb8-204" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Programa√ß√£o&#39;</span>: <span class="vs">r&#39;</span><span class="dv">\b</span><span class="kw">(</span><span class="vs">python</span><span class="cf">|</span><span class="vs">javascript</span><span class="cf">|</span><span class="vs">java</span><span class="cf">|</span><span class="vs">c</span><span class="ch">\+\+</span><span class="cf">|</span><span class="vs">c#</span><span class="cf">|</span><span class="vs">go</span><span class="cf">|</span><span class="vs">rust</span><span class="cf">|</span><span class="vs">lua</span><span class="cf">|</span><span class="vs">bash</span><span class="cf">|</span><span class="vs">script</span><span class="cf">|</span><span class="vs">debug</span><span class="cf">|</span><span class="vs">erro</span><span class="cf">|</span><span class="vs">conda</span><span class="cf">|</span><span class="vs">mamba</span><span class="cf">|</span><span class="vs">pandoc</span><span class="cf">|</span><span class="vs">msys2</span><span class="cf">|</span><span class="vs">spyder</span><span class="cf">|</span><span class="vs">jupyter</span><span class="cf">|</span><span class="vs">pip</span><span class="cf">|</span><span class="vs">venv</span><span class="cf">|</span><span class="vs">docker</span><span class="cf">|</span><span class="vs">git</span><span class="cf">|</span><span class="vs">github</span><span class="cf">|</span><span class="vs">vscode</span><span class="cf">|</span><span class="vs">ide</span><span class="cf">|</span><span class="vs">programa</span><span class="cf">|</span><span class="vs">c√≥digo</span><span class="cf">|</span><span class="vs">fun√ß√£o</span><span class="cf">|</span><span class="vs">classe</span><span class="cf">|</span><span class="vs">api</span><span class="cf">|</span><span class="vs">selenium</span><span class="cf">|</span><span class="vs">playwright</span><span class="kw">)</span><span class="dv">\b</span><span class="vs">&#39;</span>,</span>
<span id="cb8-205"><a href="#cb8-205" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Sistemas&#39;</span>: <span class="vs">r&#39;</span><span class="dv">\b</span><span class="kw">(</span><span class="vs">windows</span><span class="cf">|</span><span class="vs">linux</span><span class="cf">|</span><span class="vs">macos</span><span class="cf">|</span><span class="vs">so</span><span class="cf">|</span><span class="vs">sistema operacional</span><span class="cf">|</span><span class="vs">driver</span><span class="cf">|</span><span class="vs">registry</span><span class="cf">|</span><span class="vs">process</span><span class="cf">|</span><span class="vs">firewall</span><span class="cf">|</span><span class="vs">bios</span><span class="cf">|</span><span class="vs">boot</span><span class="cf">|</span><span class="vs">path</span><span class="cf">|</span><span class="vs">dll</span><span class="cf">|</span><span class="vs">exe</span><span class="cf">|</span><span class="vs">powershell</span><span class="cf">|</span><span class="vs">cmd</span><span class="cf">|</span><span class="vs">terminal</span><span class="cf">|</span><span class="vs">shell</span><span class="kw">)</span><span class="dv">\b</span><span class="vs">&#39;</span>,</span>
<span id="cb8-206"><a href="#cb8-206" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;IA&#39;</span>: <span class="vs">r&#39;</span><span class="dv">\b</span><span class="kw">(</span><span class="vs">ia</span><span class="cf">|</span><span class="vs">gpt</span><span class="cf">|</span><span class="vs">chatgpt</span><span class="cf">|</span><span class="vs">grok</span><span class="cf">|</span><span class="vs">qwen</span><span class="cf">|</span><span class="vs">deepseek</span><span class="cf">|</span><span class="vs">llm</span><span class="cf">|</span><span class="vs">modelo</span><span class="cf">|</span><span class="vs">prompt</span><span class="cf">|</span><span class="vs">token</span><span class="cf">|</span><span class="vs">embedding</span><span class="cf">|</span><span class="vs">fine-tune</span><span class="cf">|</span><span class="vs">neural</span><span class="cf">|</span><span class="vs">chatbot</span><span class="cf">|</span><span class="vs">intelig√™ncia artificial</span><span class="kw">)</span><span class="dv">\b</span><span class="vs">&#39;</span>,</span>
<span id="cb8-207"><a href="#cb8-207" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Dados&#39;</span>: <span class="vs">r&#39;</span><span class="dv">\b</span><span class="kw">(</span><span class="vs">dados</span><span class="cf">|</span><span class="vs">data</span><span class="cf">|</span><span class="vs">csv</span><span class="cf">|</span><span class="vs">json</span><span class="cf">|</span><span class="vs">pandas</span><span class="cf">|</span><span class="vs">numpy</span><span class="cf">|</span><span class="vs">excel</span><span class="cf">|</span><span class="vs">sql</span><span class="cf">|</span><span class="vs">banco</span><span class="cf">|</span><span class="vs">sqlite</span><span class="cf">|</span><span class="vs">postgres</span><span class="cf">|</span><span class="vs">visualiza√ß√£o</span><span class="cf">|</span><span class="vs">gr√°fico</span><span class="cf">|</span><span class="vs">tabela</span><span class="cf">|</span><span class="vs">an√°lise</span><span class="cf">|</span><span class="vs">etl</span><span class="cf">|</span><span class="vs">dashboard</span><span class="kw">)</span><span class="dv">\b</span><span class="vs">&#39;</span>,</span>
<span id="cb8-208"><a href="#cb8-208" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Geral&#39;</span>: <span class="vs">r&#39;</span><span class="dv">\b</span><span class="kw">(</span><span class="vs">geral</span><span class="cf">|</span><span class="vs">pergunta</span><span class="cf">|</span><span class="vs">ajuda</span><span class="cf">|</span><span class="vs">como fazer</span><span class="cf">|</span><span class="vs">explicar</span><span class="cf">|</span><span class="vs">resumo</span><span class="cf">|</span><span class="vs">tutorial b√°sico</span><span class="kw">)</span><span class="dv">\b</span><span class="vs">&#39;</span></span>
<span id="cb8-209"><a href="#cb8-209" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb8-210"><a href="#cb8-210" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-211"><a href="#cb8-211" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> category, pattern <span class="kw">in</span> patterns.items():</span>
<span id="cb8-212"><a href="#cb8-212" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> re.search(pattern, text, re.IGNORECASE):</span>
<span id="cb8-213"><a href="#cb8-213" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> category</span>
<span id="cb8-214"><a href="#cb8-214" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb8-215"><a href="#cb8-215" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">&#39;Outros&#39;</span></span>
<span id="cb8-216"><a href="#cb8-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-217"><a href="#cb8-217" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> parse_timestamp_for_sorting(<span class="va">self</span>, timestamp) <span class="op">-&gt;</span> datetime:</span>
<span id="cb8-218"><a href="#cb8-218" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> timestamp:</span>
<span id="cb8-219"><a href="#cb8-219" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> datetime.<span class="bu">min</span></span>
<span id="cb8-220"><a href="#cb8-220" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb8-221"><a href="#cb8-221" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb8-222"><a href="#cb8-222" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">isinstance</span>(timestamp, <span class="bu">str</span>):</span>
<span id="cb8-223"><a href="#cb8-223" aria-hidden="true" tabindex="-1"></a>                clean_ts <span class="op">=</span> timestamp.replace(<span class="st">&#39;T&#39;</span>, <span class="st">&#39; &#39;</span>).split(<span class="st">&#39;.&#39;</span>)[<span class="dv">0</span>].split(<span class="st">&#39;+&#39;</span>)[<span class="dv">0</span>]</span>
<span id="cb8-224"><a href="#cb8-224" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> clean_ts.endswith(<span class="st">&#39;Z&#39;</span>):</span>
<span id="cb8-225"><a href="#cb8-225" aria-hidden="true" tabindex="-1"></a>                    clean_ts <span class="op">=</span> clean_ts[:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb8-226"><a href="#cb8-226" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> datetime.fromisoformat(clean_ts)</span>
<span id="cb8-227"><a href="#cb8-227" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> <span class="bu">isinstance</span>(timestamp, (<span class="bu">int</span>, <span class="bu">float</span>)):</span>
<span id="cb8-228"><a href="#cb8-228" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> datetime.fromtimestamp(timestamp)</span>
<span id="cb8-229"><a href="#cb8-229" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span>:</span>
<span id="cb8-230"><a href="#cb8-230" aria-hidden="true" tabindex="-1"></a>            <span class="cf">pass</span></span>
<span id="cb8-231"><a href="#cb8-231" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb8-232"><a href="#cb8-232" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> datetime.<span class="bu">min</span></span>
<span id="cb8-233"><a href="#cb8-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-234"><a href="#cb8-234" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> format_timestamp(<span class="va">self</span>, timestamp) <span class="op">-&gt;</span> Optional[<span class="bu">str</span>]:</span>
<span id="cb8-235"><a href="#cb8-235" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> timestamp:</span>
<span id="cb8-236"><a href="#cb8-236" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb8-237"><a href="#cb8-237" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb8-238"><a href="#cb8-238" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb8-239"><a href="#cb8-239" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">isinstance</span>(timestamp, (<span class="bu">int</span>, <span class="bu">float</span>)):</span>
<span id="cb8-240"><a href="#cb8-240" aria-hidden="true" tabindex="-1"></a>                dt <span class="op">=</span> datetime.fromtimestamp(timestamp)</span>
<span id="cb8-241"><a href="#cb8-241" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> dt.strftime(<span class="st">&#39;%Y-%m-</span><span class="sc">%d</span><span class="st"> %H:%M:%S&#39;</span>)</span>
<span id="cb8-242"><a href="#cb8-242" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> <span class="bu">isinstance</span>(timestamp, <span class="bu">str</span>):</span>
<span id="cb8-243"><a href="#cb8-243" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="st">&#39;T&#39;</span> <span class="kw">in</span> timestamp:</span>
<span id="cb8-244"><a href="#cb8-244" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">return</span> timestamp.replace(<span class="st">&#39;T&#39;</span>, <span class="st">&#39; &#39;</span>).split(<span class="st">&#39;.&#39;</span>)[<span class="dv">0</span>]</span>
<span id="cb8-245"><a href="#cb8-245" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> timestamp</span>
<span id="cb8-246"><a href="#cb8-246" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span>:</span>
<span id="cb8-247"><a href="#cb8-247" aria-hidden="true" tabindex="-1"></a>            <span class="cf">pass</span></span>
<span id="cb8-248"><a href="#cb8-248" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb8-249"><a href="#cb8-249" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">str</span>(timestamp)</span>
<span id="cb8-250"><a href="#cb8-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-251"><a href="#cb8-251" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_enhanced_markdown_content(<span class="va">self</span>, conversation: Dict[<span class="bu">str</span>, Any]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb8-252"><a href="#cb8-252" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Gera conte√∫do Markdown com preserva√ß√£o total de formata√ß√£o&quot;&quot;&quot;</span></span>
<span id="cb8-253"><a href="#cb8-253" aria-hidden="true" tabindex="-1"></a>        lines <span class="op">=</span> [</span>
<span id="cb8-254"><a href="#cb8-254" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f&quot;# </span><span class="sc">{</span>conversation[<span class="st">&#39;title&#39;</span>]<span class="sc">}</span><span class="ss">&quot;</span>,</span>
<span id="cb8-255"><a href="#cb8-255" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;&quot;</span>,</span>
<span id="cb8-256"><a href="#cb8-256" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;## üìä Informa√ß√µes&quot;</span>,</span>
<span id="cb8-257"><a href="#cb8-257" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f&quot;- **N√∫mero:** #</span><span class="sc">{</span>conversation[<span class="st">&#39;number&#39;</span>]<span class="sc">}</span><span class="ss">&quot;</span>,</span>
<span id="cb8-258"><a href="#cb8-258" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f&quot;- **Origem:** </span><span class="sc">{</span>conversation[<span class="st">&#39;source&#39;</span>]<span class="sc">}</span><span class="ss">&quot;</span>,</span>
<span id="cb8-259"><a href="#cb8-259" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f&quot;- **Categoria:** </span><span class="sc">{</span>conversation[<span class="st">&#39;category&#39;</span>]<span class="sc">}</span><span class="ss">&quot;</span>,</span>
<span id="cb8-260"><a href="#cb8-260" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f&quot;- **ID:** </span><span class="sc">{</span>conversation<span class="sc">.</span>get(<span class="st">&#39;id&#39;</span>, <span class="st">&#39;N/A&#39;</span>)<span class="sc">}</span><span class="ss">&quot;</span>,</span>
<span id="cb8-261"><a href="#cb8-261" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f&quot;- **Criada em:** </span><span class="sc">{</span>conversation<span class="sc">.</span>get(<span class="st">&#39;inserted_at&#39;</span>) <span class="kw">or</span> conversation<span class="sc">.</span>get(<span class="st">&#39;created_at&#39;</span>) <span class="kw">or</span> <span class="st">&#39;N/A&#39;</span><span class="sc">}</span><span class="ss">&quot;</span>,</span>
<span id="cb8-262"><a href="#cb8-262" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb8-263"><a href="#cb8-263" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-264"><a href="#cb8-264" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> conversation.get(<span class="st">&#39;updated_at&#39;</span>):</span>
<span id="cb8-265"><a href="#cb8-265" aria-hidden="true" tabindex="-1"></a>            lines.append(<span class="ss">f&quot;- **Atualizada em:** </span><span class="sc">{</span>conversation[<span class="st">&#39;updated_at&#39;</span>]<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb8-266"><a href="#cb8-266" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb8-267"><a href="#cb8-267" aria-hidden="true" tabindex="-1"></a>        lines.extend([</span>
<span id="cb8-268"><a href="#cb8-268" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f&quot;- **Total de mensagens:** </span><span class="sc">{</span><span class="bu">len</span>(conversation[<span class="st">&#39;messages&#39;</span>])<span class="sc">}</span><span class="ss">&quot;</span>,</span>
<span id="cb8-269"><a href="#cb8-269" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f&quot;- **Resumo:** </span><span class="sc">{</span>conversation<span class="sc">.</span>get(<span class="st">&#39;summary&#39;</span>, <span class="st">&#39;Sem resumo&#39;</span>)<span class="sc">}</span><span class="ss">&quot;</span>,</span>
<span id="cb8-270"><a href="#cb8-270" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;&quot;</span>,</span>
<span id="cb8-271"><a href="#cb8-271" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;---&quot;</span>,</span>
<span id="cb8-272"><a href="#cb8-272" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;&quot;</span>,</span>
<span id="cb8-273"><a href="#cb8-273" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;## üó®Ô∏è Conversa&quot;</span>,</span>
<span id="cb8-274"><a href="#cb8-274" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;&quot;</span></span>
<span id="cb8-275"><a href="#cb8-275" aria-hidden="true" tabindex="-1"></a>        ])</span>
<span id="cb8-276"><a href="#cb8-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-277"><a href="#cb8-277" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, msg <span class="kw">in</span> <span class="bu">enumerate</span>(conversation[<span class="st">&#39;messages&#39;</span>], <span class="dv">1</span>):</span>
<span id="cb8-278"><a href="#cb8-278" aria-hidden="true" tabindex="-1"></a>            timestamp <span class="op">=</span> <span class="ss">f&quot; *(</span><span class="sc">{</span>msg[<span class="st">&#39;timestamp&#39;</span>]<span class="sc">}</span><span class="ss">)*&quot;</span> <span class="cf">if</span> msg[<span class="st">&#39;timestamp&#39;</span>] <span class="cf">else</span> <span class="st">&quot;&quot;</span></span>
<span id="cb8-279"><a href="#cb8-279" aria-hidden="true" tabindex="-1"></a>            model_info <span class="op">=</span> <span class="ss">f&quot; *[</span><span class="sc">{</span>msg<span class="sc">.</span>get(<span class="st">&#39;model&#39;</span>, <span class="st">&#39;&#39;</span>)<span class="sc">}</span><span class="ss">]*&quot;</span> <span class="cf">if</span> msg.get(<span class="st">&#39;model&#39;</span>) <span class="cf">else</span> <span class="st">&quot;&quot;</span></span>
<span id="cb8-280"><a href="#cb8-280" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb8-281"><a href="#cb8-281" aria-hidden="true" tabindex="-1"></a>            <span class="co"># PRESERVA√á√ÉO TOTAL do conte√∫do</span></span>
<span id="cb8-282"><a href="#cb8-282" aria-hidden="true" tabindex="-1"></a>            preserved_content <span class="op">=</span> <span class="va">self</span>.preserve_special_content(msg[<span class="st">&#39;content&#39;</span>])</span>
<span id="cb8-283"><a href="#cb8-283" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb8-284"><a href="#cb8-284" aria-hidden="true" tabindex="-1"></a>            lines.extend([</span>
<span id="cb8-285"><a href="#cb8-285" aria-hidden="true" tabindex="-1"></a>                <span class="ss">f&quot;### </span><span class="sc">{</span>msg[<span class="st">&#39;author&#39;</span>]<span class="sc">}{</span>timestamp<span class="sc">}{</span>model_info<span class="sc">}</span><span class="ss">&quot;</span>,</span>
<span id="cb8-286"><a href="#cb8-286" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;&quot;</span>,</span>
<span id="cb8-287"><a href="#cb8-287" aria-hidden="true" tabindex="-1"></a>                <span class="ss">f&quot;</span><span class="sc">{</span>preserved_content<span class="sc">}</span><span class="ss">&quot;</span>,</span>
<span id="cb8-288"><a href="#cb8-288" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;&quot;</span></span>
<span id="cb8-289"><a href="#cb8-289" aria-hidden="true" tabindex="-1"></a>            ])</span>
<span id="cb8-290"><a href="#cb8-290" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb8-291"><a href="#cb8-291" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> j <span class="op">&lt;</span> <span class="bu">len</span>(conversation[<span class="st">&#39;messages&#39;</span>]):</span>
<span id="cb8-292"><a href="#cb8-292" aria-hidden="true" tabindex="-1"></a>                lines.extend([<span class="st">&quot;---&quot;</span>, <span class="st">&quot;&quot;</span>])</span>
<span id="cb8-293"><a href="#cb8-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-294"><a href="#cb8-294" aria-hidden="true" tabindex="-1"></a>        lines.extend([</span>
<span id="cb8-295"><a href="#cb8-295" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;---&quot;</span>,</span>
<span id="cb8-296"><a href="#cb8-296" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;&quot;</span>,</span>
<span id="cb8-297"><a href="#cb8-297" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f&quot;*Conversa exportada do </span><span class="sc">{</span>conversation[<span class="st">&#39;source&#39;</span>]<span class="sc">}</span><span class="ss">*&quot;</span>,</span>
<span id="cb8-298"><a href="#cb8-298" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f&quot;*Processado em: </span><span class="sc">{</span>datetime<span class="sc">.</span>now()<span class="sc">.</span>strftime(<span class="st">&#39;</span><span class="sc">%d</span><span class="st">/%m/%Y %H:%M&#39;</span>)<span class="sc">}</span><span class="ss">*&quot;</span></span>
<span id="cb8-299"><a href="#cb8-299" aria-hidden="true" tabindex="-1"></a>        ])</span>
<span id="cb8-300"><a href="#cb8-300" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-301"><a href="#cb8-301" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>.join(lines)</span>
<span id="cb8-302"><a href="#cb8-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-303"><a href="#cb8-303" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> process_qwen_enhanced(<span class="va">self</span>, path: Path):</span>
<span id="cb8-304"><a href="#cb8-304" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Processa Qwen3 com preserva√ß√£o total de conte√∫do&quot;&quot;&quot;</span></span>
<span id="cb8-305"><a href="#cb8-305" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb8-306"><a href="#cb8-306" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;üß™ [DRY-RUN] Processaria Qwen3: </span><span class="sc">{</span>path<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb8-307"><a href="#cb8-307" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb8-308"><a href="#cb8-308" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb8-309"><a href="#cb8-309" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb8-310"><a href="#cb8-310" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(path, <span class="st">&#39;r&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb8-311"><a href="#cb8-311" aria-hidden="true" tabindex="-1"></a>                raw <span class="op">=</span> json.load(f)</span>
<span id="cb8-312"><a href="#cb8-312" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb8-313"><a href="#cb8-313" aria-hidden="true" tabindex="-1"></a>            data <span class="op">=</span> raw.get(<span class="st">&#39;data&#39;</span>, [])</span>
<span id="cb8-314"><a href="#cb8-314" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(data, <span class="bu">list</span>):</span>
<span id="cb8-315"><a href="#cb8-315" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;‚ö†Ô∏è  Qwen3: &#39;data&#39; n√£o √© uma lista.&quot;</span>)</span>
<span id="cb8-316"><a href="#cb8-316" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span></span>
<span id="cb8-317"><a href="#cb8-317" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb8-318"><a href="#cb8-318" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;üîç Qwen3: encontradas </span><span class="sc">{</span><span class="bu">len</span>(data)<span class="sc">}</span><span class="ss"> conversas.&quot;</span>)</span>
<span id="cb8-319"><a href="#cb8-319" aria-hidden="true" tabindex="-1"></a>            processed_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb8-320"><a href="#cb8-320" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb8-321"><a href="#cb8-321" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> i, conv <span class="kw">in</span> <span class="bu">enumerate</span>(data):</span>
<span id="cb8-322"><a href="#cb8-322" aria-hidden="true" tabindex="-1"></a>                title <span class="op">=</span> conv.get(<span class="st">&#39;title&#39;</span>, <span class="ss">f&#39;Conversa_Qwen_</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb8-323"><a href="#cb8-323" aria-hidden="true" tabindex="-1"></a>                title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(title)</span>
<span id="cb8-324"><a href="#cb8-324" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb8-325"><a href="#cb8-325" aria-hidden="true" tabindex="-1"></a>                history <span class="op">=</span> conv.get(<span class="st">&#39;chat&#39;</span>, {}).get(<span class="st">&#39;history&#39;</span>, {})</span>
<span id="cb8-326"><a href="#cb8-326" aria-hidden="true" tabindex="-1"></a>                messages <span class="op">=</span> []</span>
<span id="cb8-327"><a href="#cb8-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-328"><a href="#cb8-328" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="kw">not</span> history:</span>
<span id="cb8-329"><a href="#cb8-329" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">continue</span></span>
<span id="cb8-330"><a href="#cb8-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-331"><a href="#cb8-331" aria-hidden="true" tabindex="-1"></a>                messages_dict <span class="op">=</span> history.get(<span class="st">&#39;messages&#39;</span>, {})</span>
<span id="cb8-332"><a href="#cb8-332" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb8-333"><a href="#cb8-333" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(messages_dict, <span class="bu">dict</span>):</span>
<span id="cb8-334"><a href="#cb8-334" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">continue</span></span>
<span id="cb8-335"><a href="#cb8-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-336"><a href="#cb8-336" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;   üìù Conversa </span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">: &#39;</span><span class="sc">{</span>title<span class="sc">}</span><span class="ss">&#39; - </span><span class="sc">{</span><span class="bu">len</span>(messages_dict)<span class="sc">}</span><span class="ss"> mensagens&quot;</span>)</span>
<span id="cb8-337"><a href="#cb8-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-338"><a href="#cb8-338" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> message_id, message_data <span class="kw">in</span> messages_dict.items():</span>
<span id="cb8-339"><a href="#cb8-339" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(message_data, <span class="bu">dict</span>):</span>
<span id="cb8-340"><a href="#cb8-340" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb8-341"><a href="#cb8-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-342"><a href="#cb8-342" aria-hidden="true" tabindex="-1"></a>                    role <span class="op">=</span> message_data.get(<span class="st">&#39;role&#39;</span>, <span class="st">&#39;&#39;</span>)</span>
<span id="cb8-343"><a href="#cb8-343" aria-hidden="true" tabindex="-1"></a>                    content <span class="op">=</span> message_data.get(<span class="st">&#39;content&#39;</span>, <span class="st">&#39;&#39;</span>)</span>
<span id="cb8-344"><a href="#cb8-344" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb8-345"><a href="#cb8-345" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="kw">not</span> content <span class="kw">or</span> <span class="kw">not</span> role:</span>
<span id="cb8-346"><a href="#cb8-346" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb8-347"><a href="#cb8-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-348"><a href="#cb8-348" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> role <span class="op">==</span> <span class="st">&#39;user&#39;</span>:</span>
<span id="cb8-349"><a href="#cb8-349" aria-hidden="true" tabindex="-1"></a>                        author <span class="op">=</span> <span class="st">&quot;üë§ Utilizador&quot;</span></span>
<span id="cb8-350"><a href="#cb8-350" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">elif</span> role <span class="op">==</span> <span class="st">&#39;assistant&#39;</span>:</span>
<span id="cb8-351"><a href="#cb8-351" aria-hidden="true" tabindex="-1"></a>                        author <span class="op">=</span> <span class="st">&quot;ü§ñ Qwen3&quot;</span></span>
<span id="cb8-352"><a href="#cb8-352" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">else</span>:</span>
<span id="cb8-353"><a href="#cb8-353" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb8-354"><a href="#cb8-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-355"><a href="#cb8-355" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="bu">isinstance</span>(content, <span class="bu">list</span>):</span>
<span id="cb8-356"><a href="#cb8-356" aria-hidden="true" tabindex="-1"></a>                        text_parts <span class="op">=</span> []</span>
<span id="cb8-357"><a href="#cb8-357" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">for</span> block <span class="kw">in</span> content:</span>
<span id="cb8-358"><a href="#cb8-358" aria-hidden="true" tabindex="-1"></a>                            <span class="cf">if</span> <span class="bu">isinstance</span>(block, <span class="bu">dict</span>):</span>
<span id="cb8-359"><a href="#cb8-359" aria-hidden="true" tabindex="-1"></a>                                <span class="cf">if</span> block.get(<span class="st">&#39;type&#39;</span>) <span class="op">==</span> <span class="st">&#39;text&#39;</span>:</span>
<span id="cb8-360"><a href="#cb8-360" aria-hidden="true" tabindex="-1"></a>                                    text_parts.append(block.get(<span class="st">&#39;text&#39;</span>, <span class="st">&#39;&#39;</span>))</span>
<span id="cb8-361"><a href="#cb8-361" aria-hidden="true" tabindex="-1"></a>                                <span class="cf">elif</span> block.get(<span class="st">&#39;type&#39;</span>) <span class="op">==</span> <span class="st">&#39;image&#39;</span>:</span>
<span id="cb8-362"><a href="#cb8-362" aria-hidden="true" tabindex="-1"></a>                                    image_info <span class="op">=</span> block.get(<span class="st">&#39;image&#39;</span>, <span class="st">&#39;&#39;</span>)</span>
<span id="cb8-363"><a href="#cb8-363" aria-hidden="true" tabindex="-1"></a>                                    <span class="cf">if</span> image_info:</span>
<span id="cb8-364"><a href="#cb8-364" aria-hidden="true" tabindex="-1"></a>                                        text_parts.append(<span class="ss">f&quot;![Imagem](</span><span class="sc">{</span>image_info<span class="sc">}</span><span class="ss">)&quot;</span>)</span>
<span id="cb8-365"><a href="#cb8-365" aria-hidden="true" tabindex="-1"></a>                            <span class="cf">elif</span> <span class="bu">isinstance</span>(block, <span class="bu">str</span>):</span>
<span id="cb8-366"><a href="#cb8-366" aria-hidden="true" tabindex="-1"></a>                                text_parts.append(block)</span>
<span id="cb8-367"><a href="#cb8-367" aria-hidden="true" tabindex="-1"></a>                        final_content <span class="op">=</span> <span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>.join(text_parts).strip()</span>
<span id="cb8-368"><a href="#cb8-368" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">else</span>:</span>
<span id="cb8-369"><a href="#cb8-369" aria-hidden="true" tabindex="-1"></a>                        final_content <span class="op">=</span> <span class="bu">str</span>(content).strip()</span>
<span id="cb8-370"><a href="#cb8-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-371"><a href="#cb8-371" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># APLICA PRESERVA√á√ÉO</span></span>
<span id="cb8-372"><a href="#cb8-372" aria-hidden="true" tabindex="-1"></a>                    final_content <span class="op">=</span> <span class="va">self</span>.preserve_special_content(final_content)</span>
<span id="cb8-373"><a href="#cb8-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-374"><a href="#cb8-374" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="kw">not</span> final_content <span class="kw">or</span> final_content <span class="op">==</span> <span class="st">&#39;null&#39;</span>:</span>
<span id="cb8-375"><a href="#cb8-375" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb8-376"><a href="#cb8-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-377"><a href="#cb8-377" aria-hidden="true" tabindex="-1"></a>                    messages.append({</span>
<span id="cb8-378"><a href="#cb8-378" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;author&#39;</span>: author,</span>
<span id="cb8-379"><a href="#cb8-379" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;role&#39;</span>: role,</span>
<span id="cb8-380"><a href="#cb8-380" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;content&#39;</span>: final_content,</span>
<span id="cb8-381"><a href="#cb8-381" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;timestamp&#39;</span>: <span class="va">self</span>.format_timestamp(message_data.get(<span class="st">&#39;created_at&#39;</span>)),</span>
<span id="cb8-382"><a href="#cb8-382" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;model&#39;</span>: message_data.get(<span class="st">&#39;model&#39;</span>, <span class="st">&#39;Qwen3&#39;</span>)</span>
<span id="cb8-383"><a href="#cb8-383" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb8-384"><a href="#cb8-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-385"><a href="#cb8-385" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> messages:</span>
<span id="cb8-386"><a href="#cb8-386" aria-hidden="true" tabindex="-1"></a>                    messages.sort(key<span class="op">=</span><span class="kw">lambda</span> x: <span class="va">self</span>.parse_timestamp_for_sorting(x[<span class="st">&#39;timestamp&#39;</span>]))</span>
<span id="cb8-387"><a href="#cb8-387" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb8-388"><a href="#cb8-388" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.all_conversations.append({</span>
<span id="cb8-389"><a href="#cb8-389" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;title&#39;</span>: title,</span>
<span id="cb8-390"><a href="#cb8-390" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;source&#39;</span>: <span class="st">&#39;Qwen3&#39;</span>,</span>
<span id="cb8-391"><a href="#cb8-391" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;id&#39;</span>: conv.get(<span class="st">&#39;id&#39;</span>, <span class="ss">f&#39;qwen_</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">&#39;</span>),</span>
<span id="cb8-392"><a href="#cb8-392" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;inserted_at&#39;</span>: <span class="va">self</span>.format_timestamp(conv.get(<span class="st">&#39;created_at&#39;</span>)),</span>
<span id="cb8-393"><a href="#cb8-393" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;updated_at&#39;</span>: <span class="va">self</span>.format_timestamp(conv.get(<span class="st">&#39;updated_at&#39;</span>)),</span>
<span id="cb8-394"><a href="#cb8-394" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;messages&#39;</span>: messages,</span>
<span id="cb8-395"><a href="#cb8-395" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;summary&#39;</span>: messages[<span class="dv">0</span>][<span class="st">&#39;content&#39;</span>][:<span class="dv">100</span>] <span class="op">+</span> <span class="st">&quot;...&quot;</span> <span class="cf">if</span> messages <span class="cf">else</span> <span class="st">&quot;Sem conte√∫do&quot;</span>,</span>
<span id="cb8-396"><a href="#cb8-396" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;category&#39;</span>: <span class="st">&#39;Geral&#39;</span></span>
<span id="cb8-397"><a href="#cb8-397" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb8-398"><a href="#cb8-398" aria-hidden="true" tabindex="-1"></a>                    processed_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb8-399"><a href="#cb8-399" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="ss">f&quot;   ‚úÖ Adicionada: </span><span class="sc">{</span><span class="bu">len</span>(messages)<span class="sc">}</span><span class="ss"> mensagens&quot;</span>)</span>
<span id="cb8-400"><a href="#cb8-400" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb8-401"><a href="#cb8-401" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ Qwen3: </span><span class="sc">{</span>processed_count<span class="sc">}</span><span class="ss"> conversas processadas.&quot;</span>)</span>
<span id="cb8-402"><a href="#cb8-402" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb8-403"><a href="#cb8-403" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb8-404"><a href="#cb8-404" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚ùå Erro ao processar Qwen3: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb8-405"><a href="#cb8-405" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb8-406"><a href="#cb8-406" aria-hidden="true" tabindex="-1"></a>                traceback.print_exc()</span>
<span id="cb8-407"><a href="#cb8-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-408"><a href="#cb8-408" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> process_chatgpt(<span class="va">self</span>, path: Path):</span>
<span id="cb8-409"><a href="#cb8-409" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Processa exporta√ß√£o do ChatGPT&quot;&quot;&quot;</span></span>
<span id="cb8-410"><a href="#cb8-410" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb8-411"><a href="#cb8-411" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;üß™ [DRY-RUN] Processaria ChatGPT: </span><span class="sc">{</span>path<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb8-412"><a href="#cb8-412" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb8-413"><a href="#cb8-413" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb8-414"><a href="#cb8-414" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb8-415"><a href="#cb8-415" aria-hidden="true" tabindex="-1"></a>            temp_dir <span class="op">=</span> tempfile.mkdtemp(prefix<span class="op">=</span><span class="st">&quot;chatgpt_&quot;</span>)</span>
<span id="cb8-416"><a href="#cb8-416" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> zipfile.ZipFile(path, <span class="st">&#39;r&#39;</span>) <span class="im">as</span> z:</span>
<span id="cb8-417"><a href="#cb8-417" aria-hidden="true" tabindex="-1"></a>                z.extractall(temp_dir)</span>
<span id="cb8-418"><a href="#cb8-418" aria-hidden="true" tabindex="-1"></a>            convs_path <span class="op">=</span> Path(temp_dir) <span class="op">/</span> <span class="st">&quot;conversations.json&quot;</span></span>
<span id="cb8-419"><a href="#cb8-419" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> convs_path.exists():</span>
<span id="cb8-420"><a href="#cb8-420" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;‚ùå ChatGPT: conversations.json n√£o encontrado.&quot;</span>)</span>
<span id="cb8-421"><a href="#cb8-421" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span></span>
<span id="cb8-422"><a href="#cb8-422" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb8-423"><a href="#cb8-423" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(convs_path, <span class="st">&#39;r&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb8-424"><a href="#cb8-424" aria-hidden="true" tabindex="-1"></a>                data <span class="op">=</span> json.load(f)</span>
<span id="cb8-425"><a href="#cb8-425" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb8-426"><a href="#cb8-426" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(data, <span class="bu">list</span>):</span>
<span id="cb8-427"><a href="#cb8-427" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;‚ö†Ô∏è  ChatGPT: estrutura inesperada.&quot;</span>)</span>
<span id="cb8-428"><a href="#cb8-428" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span></span>
<span id="cb8-429"><a href="#cb8-429" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb8-430"><a href="#cb8-430" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;üîç ChatGPT: encontradas </span><span class="sc">{</span><span class="bu">len</span>(data)<span class="sc">}</span><span class="ss"> conversas.&quot;</span>)</span>
<span id="cb8-431"><a href="#cb8-431" aria-hidden="true" tabindex="-1"></a>            processed_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb8-432"><a href="#cb8-432" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb8-433"><a href="#cb8-433" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> i, conv <span class="kw">in</span> <span class="bu">enumerate</span>(data):</span>
<span id="cb8-434"><a href="#cb8-434" aria-hidden="true" tabindex="-1"></a>                title <span class="op">=</span> conv.get(<span class="st">&#39;title&#39;</span>, <span class="ss">f&#39;Conversa_ChatGPT_</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb8-435"><a href="#cb8-435" aria-hidden="true" tabindex="-1"></a>                title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(title)</span>
<span id="cb8-436"><a href="#cb8-436" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb8-437"><a href="#cb8-437" aria-hidden="true" tabindex="-1"></a>                messages <span class="op">=</span> []</span>
<span id="cb8-438"><a href="#cb8-438" aria-hidden="true" tabindex="-1"></a>                mapping <span class="op">=</span> conv.get(<span class="st">&#39;mapping&#39;</span>, {})</span>
<span id="cb8-439"><a href="#cb8-439" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb8-440"><a href="#cb8-440" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> msg_id, node <span class="kw">in</span> mapping.items():</span>
<span id="cb8-441"><a href="#cb8-441" aria-hidden="true" tabindex="-1"></a>                    msg_data <span class="op">=</span> node.get(<span class="st">&#39;message&#39;</span>)</span>
<span id="cb8-442"><a href="#cb8-442" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="kw">not</span> msg_data <span class="kw">or</span> <span class="kw">not</span> <span class="bu">isinstance</span>(msg_data, <span class="bu">dict</span>):</span>
<span id="cb8-443"><a href="#cb8-443" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb8-444"><a href="#cb8-444" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb8-445"><a href="#cb8-445" aria-hidden="true" tabindex="-1"></a>                    author_role <span class="op">=</span> msg_data.get(<span class="st">&#39;author&#39;</span>, {}).get(<span class="st">&#39;role&#39;</span>, <span class="st">&#39;&#39;</span>)</span>
<span id="cb8-446"><a href="#cb8-446" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> author_role <span class="op">==</span> <span class="st">&#39;user&#39;</span>:</span>
<span id="cb8-447"><a href="#cb8-447" aria-hidden="true" tabindex="-1"></a>                        author <span class="op">=</span> <span class="st">&quot;üë§ Utilizador&quot;</span></span>
<span id="cb8-448"><a href="#cb8-448" aria-hidden="true" tabindex="-1"></a>                        role <span class="op">=</span> <span class="st">&#39;user&#39;</span></span>
<span id="cb8-449"><a href="#cb8-449" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">elif</span> author_role <span class="op">==</span> <span class="st">&#39;assistant&#39;</span>:</span>
<span id="cb8-450"><a href="#cb8-450" aria-hidden="true" tabindex="-1"></a>                        author <span class="op">=</span> <span class="st">&quot;ü§ñ ChatGPT&quot;</span></span>
<span id="cb8-451"><a href="#cb8-451" aria-hidden="true" tabindex="-1"></a>                        role <span class="op">=</span> <span class="st">&#39;assistant&#39;</span></span>
<span id="cb8-452"><a href="#cb8-452" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">else</span>:</span>
<span id="cb8-453"><a href="#cb8-453" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb8-454"><a href="#cb8-454" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb8-455"><a href="#cb8-455" aria-hidden="true" tabindex="-1"></a>                    content_parts <span class="op">=</span> []</span>
<span id="cb8-456"><a href="#cb8-456" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">for</span> part <span class="kw">in</span> msg_data.get(<span class="st">&#39;content&#39;</span>, {}).get(<span class="st">&#39;parts&#39;</span>, []):</span>
<span id="cb8-457"><a href="#cb8-457" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">if</span> <span class="bu">isinstance</span>(part, <span class="bu">str</span>):</span>
<span id="cb8-458"><a href="#cb8-458" aria-hidden="true" tabindex="-1"></a>                            content_parts.append(part)</span>
<span id="cb8-459"><a href="#cb8-459" aria-hidden="true" tabindex="-1"></a>                    content <span class="op">=</span> <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>.join(content_parts).strip()</span>
<span id="cb8-460"><a href="#cb8-460" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb8-461"><a href="#cb8-461" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># APLICA PRESERVA√á√ÉO</span></span>
<span id="cb8-462"><a href="#cb8-462" aria-hidden="true" tabindex="-1"></a>                    content <span class="op">=</span> <span class="va">self</span>.preserve_special_content(content)</span>
<span id="cb8-463"><a href="#cb8-463" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb8-464"><a href="#cb8-464" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="kw">not</span> content:</span>
<span id="cb8-465"><a href="#cb8-465" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb8-466"><a href="#cb8-466" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb8-467"><a href="#cb8-467" aria-hidden="true" tabindex="-1"></a>                    messages.append({</span>
<span id="cb8-468"><a href="#cb8-468" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;author&#39;</span>: author,</span>
<span id="cb8-469"><a href="#cb8-469" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;role&#39;</span>: role,</span>
<span id="cb8-470"><a href="#cb8-470" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;content&#39;</span>: content,</span>
<span id="cb8-471"><a href="#cb8-471" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;timestamp&#39;</span>: <span class="va">self</span>.format_timestamp(msg_data.get(<span class="st">&#39;create_time&#39;</span>)),</span>
<span id="cb8-472"><a href="#cb8-472" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;model&#39;</span>: msg_data.get(<span class="st">&#39;model&#39;</span>, <span class="st">&#39;ChatGPT&#39;</span>)</span>
<span id="cb8-473"><a href="#cb8-473" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb8-474"><a href="#cb8-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-475"><a href="#cb8-475" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> messages:</span>
<span id="cb8-476"><a href="#cb8-476" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.all_conversations.append({</span>
<span id="cb8-477"><a href="#cb8-477" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;title&#39;</span>: title,</span>
<span id="cb8-478"><a href="#cb8-478" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;source&#39;</span>: <span class="st">&#39;ChatGPT&#39;</span>,</span>
<span id="cb8-479"><a href="#cb8-479" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;id&#39;</span>: conv.get(<span class="st">&#39;id&#39;</span>, <span class="ss">f&#39;chatgpt_</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">&#39;</span>),</span>
<span id="cb8-480"><a href="#cb8-480" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;inserted_at&#39;</span>: <span class="va">self</span>.format_timestamp(conv.get(<span class="st">&#39;create_time&#39;</span>)),</span>
<span id="cb8-481"><a href="#cb8-481" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;updated_at&#39;</span>: <span class="va">self</span>.format_timestamp(conv.get(<span class="st">&#39;update_time&#39;</span>)),</span>
<span id="cb8-482"><a href="#cb8-482" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;messages&#39;</span>: messages,</span>
<span id="cb8-483"><a href="#cb8-483" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;summary&#39;</span>: messages[<span class="dv">0</span>][<span class="st">&#39;content&#39;</span>][:<span class="dv">100</span>] <span class="op">+</span> <span class="st">&quot;...&quot;</span> <span class="cf">if</span> messages <span class="cf">else</span> <span class="st">&quot;Sem conte√∫do&quot;</span>,</span>
<span id="cb8-484"><a href="#cb8-484" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;category&#39;</span>: <span class="st">&#39;Geral&#39;</span></span>
<span id="cb8-485"><a href="#cb8-485" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb8-486"><a href="#cb8-486" aria-hidden="true" tabindex="-1"></a>                    processed_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb8-487"><a href="#cb8-487" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb8-488"><a href="#cb8-488" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ ChatGPT: </span><span class="sc">{</span>processed_count<span class="sc">}</span><span class="ss"> conversas processadas.&quot;</span>)</span>
<span id="cb8-489"><a href="#cb8-489" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb8-490"><a href="#cb8-490" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb8-491"><a href="#cb8-491" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚ùå Erro ao processar ChatGPT: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb8-492"><a href="#cb8-492" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb8-493"><a href="#cb8-493" aria-hidden="true" tabindex="-1"></a>                traceback.print_exc()</span>
<span id="cb8-494"><a href="#cb8-494" aria-hidden="true" tabindex="-1"></a>        <span class="cf">finally</span>:</span>
<span id="cb8-495"><a href="#cb8-495" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="st">&#39;temp_dir&#39;</span> <span class="kw">in</span> <span class="bu">locals</span>():</span>
<span id="cb8-496"><a href="#cb8-496" aria-hidden="true" tabindex="-1"></a>                shutil.rmtree(temp_dir, ignore_errors<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb8-497"><a href="#cb8-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-498"><a href="#cb8-498" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> process_deepseek(<span class="va">self</span>, path: Path):</span>
<span id="cb8-499"><a href="#cb8-499" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Processa exporta√ß√£o do DeepSeek&quot;&quot;&quot;</span></span>
<span id="cb8-500"><a href="#cb8-500" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb8-501"><a href="#cb8-501" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;üß™ [DRY-RUN] Processaria DeepSeek: </span><span class="sc">{</span>path<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb8-502"><a href="#cb8-502" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb8-503"><a href="#cb8-503" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb8-504"><a href="#cb8-504" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb8-505"><a href="#cb8-505" aria-hidden="true" tabindex="-1"></a>            temp_dir <span class="op">=</span> tempfile.mkdtemp(prefix<span class="op">=</span><span class="st">&quot;deepseek_&quot;</span>)</span>
<span id="cb8-506"><a href="#cb8-506" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> zipfile.ZipFile(path, <span class="st">&#39;r&#39;</span>) <span class="im">as</span> z:</span>
<span id="cb8-507"><a href="#cb8-507" aria-hidden="true" tabindex="-1"></a>                z.extractall(temp_dir)</span>
<span id="cb8-508"><a href="#cb8-508" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb8-509"><a href="#cb8-509" aria-hidden="true" tabindex="-1"></a>            convs_path <span class="op">=</span> Path(temp_dir) <span class="op">/</span> <span class="st">&quot;conversations.json&quot;</span></span>
<span id="cb8-510"><a href="#cb8-510" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> convs_path.exists():</span>
<span id="cb8-511"><a href="#cb8-511" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;‚ùå DeepSeek: conversations.json n√£o encontrado.&quot;</span>)</span>
<span id="cb8-512"><a href="#cb8-512" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span></span>
<span id="cb8-513"><a href="#cb8-513" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb8-514"><a href="#cb8-514" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(convs_path, <span class="st">&#39;r&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb8-515"><a href="#cb8-515" aria-hidden="true" tabindex="-1"></a>                raw_data <span class="op">=</span> json.load(f)</span>
<span id="cb8-516"><a href="#cb8-516" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb8-517"><a href="#cb8-517" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">isinstance</span>(raw_data, <span class="bu">list</span>):</span>
<span id="cb8-518"><a href="#cb8-518" aria-hidden="true" tabindex="-1"></a>                data <span class="op">=</span> raw_data</span>
<span id="cb8-519"><a href="#cb8-519" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> <span class="bu">isinstance</span>(raw_data, <span class="bu">dict</span>) <span class="kw">and</span> <span class="st">&#39;data&#39;</span> <span class="kw">in</span> raw_data:</span>
<span id="cb8-520"><a href="#cb8-520" aria-hidden="true" tabindex="-1"></a>                data <span class="op">=</span> raw_data[<span class="st">&#39;data&#39;</span>]</span>
<span id="cb8-521"><a href="#cb8-521" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb8-522"><a href="#cb8-522" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;‚ö†Ô∏è  DeepSeek: estrutura inesperada.&quot;</span>)</span>
<span id="cb8-523"><a href="#cb8-523" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span></span>
<span id="cb8-524"><a href="#cb8-524" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb8-525"><a href="#cb8-525" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(data, <span class="bu">list</span>):</span>
<span id="cb8-526"><a href="#cb8-526" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;‚ö†Ô∏è  DeepSeek: &#39;data&#39; n√£o √© uma lista.&quot;</span>)</span>
<span id="cb8-527"><a href="#cb8-527" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span></span>
<span id="cb8-528"><a href="#cb8-528" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb8-529"><a href="#cb8-529" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;üîç DeepSeek: encontradas </span><span class="sc">{</span><span class="bu">len</span>(data)<span class="sc">}</span><span class="ss"> conversas.&quot;</span>)</span>
<span id="cb8-530"><a href="#cb8-530" aria-hidden="true" tabindex="-1"></a>            processed_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb8-531"><a href="#cb8-531" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb8-532"><a href="#cb8-532" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> i, conv <span class="kw">in</span> <span class="bu">enumerate</span>(data):</span>
<span id="cb8-533"><a href="#cb8-533" aria-hidden="true" tabindex="-1"></a>                title <span class="op">=</span> conv.get(<span class="st">&#39;title&#39;</span>, <span class="ss">f&#39;Conversa_DeepSeek_</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb8-534"><a href="#cb8-534" aria-hidden="true" tabindex="-1"></a>                title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(title)</span>
<span id="cb8-535"><a href="#cb8-535" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb8-536"><a href="#cb8-536" aria-hidden="true" tabindex="-1"></a>                messages <span class="op">=</span> []</span>
<span id="cb8-537"><a href="#cb8-537" aria-hidden="true" tabindex="-1"></a>                mapping <span class="op">=</span> conv.get(<span class="st">&#39;mapping&#39;</span>, {})</span>
<span id="cb8-538"><a href="#cb8-538" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb8-539"><a href="#cb8-539" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> node_id, node <span class="kw">in</span> mapping.items():</span>
<span id="cb8-540"><a href="#cb8-540" aria-hidden="true" tabindex="-1"></a>                    msg_data <span class="op">=</span> node.get(<span class="st">&#39;message&#39;</span>)</span>
<span id="cb8-541"><a href="#cb8-541" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="kw">not</span> msg_data <span class="kw">or</span> <span class="kw">not</span> <span class="bu">isinstance</span>(msg_data, <span class="bu">dict</span>):</span>
<span id="cb8-542"><a href="#cb8-542" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb8-543"><a href="#cb8-543" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb8-544"><a href="#cb8-544" aria-hidden="true" tabindex="-1"></a>                    fragments <span class="op">=</span> msg_data.get(<span class="st">&#39;fragments&#39;</span>, [])</span>
<span id="cb8-545"><a href="#cb8-545" aria-hidden="true" tabindex="-1"></a>                    content_parts <span class="op">=</span> []</span>
<span id="cb8-546"><a href="#cb8-546" aria-hidden="true" tabindex="-1"></a>                    msg_type <span class="op">=</span> <span class="va">None</span></span>
<span id="cb8-547"><a href="#cb8-547" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb8-548"><a href="#cb8-548" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">for</span> frag <span class="kw">in</span> fragments:</span>
<span id="cb8-549"><a href="#cb8-549" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">if</span> <span class="bu">isinstance</span>(frag, <span class="bu">dict</span>):</span>
<span id="cb8-550"><a href="#cb8-550" aria-hidden="true" tabindex="-1"></a>                            frag_type <span class="op">=</span> frag.get(<span class="st">&#39;type&#39;</span>, <span class="st">&#39;&#39;</span>).upper()</span>
<span id="cb8-551"><a href="#cb8-551" aria-hidden="true" tabindex="-1"></a>                            <span class="cf">if</span> frag_type <span class="kw">in</span> (<span class="st">&#39;REQUEST&#39;</span>, <span class="st">&#39;RESPONSE&#39;</span>):</span>
<span id="cb8-552"><a href="#cb8-552" aria-hidden="true" tabindex="-1"></a>                                msg_type <span class="op">=</span> frag_type</span>
<span id="cb8-553"><a href="#cb8-553" aria-hidden="true" tabindex="-1"></a>                            text <span class="op">=</span> frag.get(<span class="st">&#39;text&#39;</span>, <span class="st">&#39;&#39;</span>)</span>
<span id="cb8-554"><a href="#cb8-554" aria-hidden="true" tabindex="-1"></a>                            <span class="cf">if</span> text:</span>
<span id="cb8-555"><a href="#cb8-555" aria-hidden="true" tabindex="-1"></a>                                content_parts.append(text)</span>
<span id="cb8-556"><a href="#cb8-556" aria-hidden="true" tabindex="-1"></a>                            content <span class="op">=</span> frag.get(<span class="st">&#39;content&#39;</span>, <span class="st">&#39;&#39;</span>)</span>
<span id="cb8-557"><a href="#cb8-557" aria-hidden="true" tabindex="-1"></a>                            <span class="cf">if</span> content:</span>
<span id="cb8-558"><a href="#cb8-558" aria-hidden="true" tabindex="-1"></a>                                <span class="cf">if</span> <span class="bu">isinstance</span>(content, <span class="bu">list</span>):</span>
<span id="cb8-559"><a href="#cb8-559" aria-hidden="true" tabindex="-1"></a>                                    <span class="cf">for</span> item <span class="kw">in</span> content:</span>
<span id="cb8-560"><a href="#cb8-560" aria-hidden="true" tabindex="-1"></a>                                        <span class="cf">if</span> <span class="bu">isinstance</span>(item, <span class="bu">str</span>):</span>
<span id="cb8-561"><a href="#cb8-561" aria-hidden="true" tabindex="-1"></a>                                            content_parts.append(item)</span>
<span id="cb8-562"><a href="#cb8-562" aria-hidden="true" tabindex="-1"></a>                                        <span class="cf">elif</span> <span class="bu">isinstance</span>(item, <span class="bu">dict</span>):</span>
<span id="cb8-563"><a href="#cb8-563" aria-hidden="true" tabindex="-1"></a>                                            item_text <span class="op">=</span> item.get(<span class="st">&#39;text&#39;</span>, <span class="st">&#39;&#39;</span>)</span>
<span id="cb8-564"><a href="#cb8-564" aria-hidden="true" tabindex="-1"></a>                                            <span class="cf">if</span> item_text:</span>
<span id="cb8-565"><a href="#cb8-565" aria-hidden="true" tabindex="-1"></a>                                                content_parts.append(<span class="bu">str</span>(item_text))</span>
<span id="cb8-566"><a href="#cb8-566" aria-hidden="true" tabindex="-1"></a>                                <span class="cf">else</span>:</span>
<span id="cb8-567"><a href="#cb8-567" aria-hidden="true" tabindex="-1"></a>                                    content_parts.append(<span class="bu">str</span>(content))</span>
<span id="cb8-568"><a href="#cb8-568" aria-hidden="true" tabindex="-1"></a>                                    </span>
<span id="cb8-569"><a href="#cb8-569" aria-hidden="true" tabindex="-1"></a>                    content <span class="op">=</span> <span class="st">&#39; &#39;</span>.join(content_parts).strip()</span>
<span id="cb8-570"><a href="#cb8-570" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb8-571"><a href="#cb8-571" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># APLICA PRESERVA√á√ÉO</span></span>
<span id="cb8-572"><a href="#cb8-572" aria-hidden="true" tabindex="-1"></a>                    content <span class="op">=</span> <span class="va">self</span>.preserve_special_content(content)</span>
<span id="cb8-573"><a href="#cb8-573" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb8-574"><a href="#cb8-574" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="kw">not</span> content:</span>
<span id="cb8-575"><a href="#cb8-575" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb8-576"><a href="#cb8-576" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb8-577"><a href="#cb8-577" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> msg_type <span class="op">==</span> <span class="st">&#39;REQUEST&#39;</span>:</span>
<span id="cb8-578"><a href="#cb8-578" aria-hidden="true" tabindex="-1"></a>                        author <span class="op">=</span> <span class="st">&quot;üë§ Utilizador&quot;</span></span>
<span id="cb8-579"><a href="#cb8-579" aria-hidden="true" tabindex="-1"></a>                        role <span class="op">=</span> <span class="st">&#39;user&#39;</span></span>
<span id="cb8-580"><a href="#cb8-580" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">else</span>:</span>
<span id="cb8-581"><a href="#cb8-581" aria-hidden="true" tabindex="-1"></a>                        author <span class="op">=</span> <span class="st">&quot;ü§ñ DeepSeek&quot;</span></span>
<span id="cb8-582"><a href="#cb8-582" aria-hidden="true" tabindex="-1"></a>                        role <span class="op">=</span> <span class="st">&#39;assistant&#39;</span></span>
<span id="cb8-583"><a href="#cb8-583" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb8-584"><a href="#cb8-584" aria-hidden="true" tabindex="-1"></a>                    messages.append({</span>
<span id="cb8-585"><a href="#cb8-585" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;author&#39;</span>: author,</span>
<span id="cb8-586"><a href="#cb8-586" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;role&#39;</span>: role,</span>
<span id="cb8-587"><a href="#cb8-587" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;content&#39;</span>: content,</span>
<span id="cb8-588"><a href="#cb8-588" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;timestamp&#39;</span>: <span class="va">self</span>.format_timestamp(msg_data.get(<span class="st">&#39;inserted_at&#39;</span>)),</span>
<span id="cb8-589"><a href="#cb8-589" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;model&#39;</span>: msg_data.get(<span class="st">&#39;model&#39;</span>, <span class="st">&#39;DeepSeek&#39;</span>)</span>
<span id="cb8-590"><a href="#cb8-590" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb8-591"><a href="#cb8-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-592"><a href="#cb8-592" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> messages:</span>
<span id="cb8-593"><a href="#cb8-593" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.all_conversations.append({</span>
<span id="cb8-594"><a href="#cb8-594" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;title&#39;</span>: title,</span>
<span id="cb8-595"><a href="#cb8-595" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;source&#39;</span>: <span class="st">&#39;DeepSeek&#39;</span>,</span>
<span id="cb8-596"><a href="#cb8-596" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;id&#39;</span>: conv.get(<span class="st">&#39;id&#39;</span>, <span class="ss">f&#39;deepseek_</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">&#39;</span>),</span>
<span id="cb8-597"><a href="#cb8-597" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;inserted_at&#39;</span>: <span class="va">self</span>.format_timestamp(conv.get(<span class="st">&#39;inserted_at&#39;</span>)),</span>
<span id="cb8-598"><a href="#cb8-598" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;updated_at&#39;</span>: <span class="va">self</span>.format_timestamp(conv.get(<span class="st">&#39;updated_at&#39;</span>)),</span>
<span id="cb8-599"><a href="#cb8-599" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;messages&#39;</span>: messages,</span>
<span id="cb8-600"><a href="#cb8-600" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;summary&#39;</span>: messages[<span class="dv">0</span>][<span class="st">&#39;content&#39;</span>][:<span class="dv">100</span>] <span class="op">+</span> <span class="st">&quot;...&quot;</span> <span class="cf">if</span> messages <span class="cf">else</span> <span class="st">&quot;Sem conte√∫do&quot;</span>,</span>
<span id="cb8-601"><a href="#cb8-601" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;category&#39;</span>: <span class="st">&#39;Geral&#39;</span></span>
<span id="cb8-602"><a href="#cb8-602" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb8-603"><a href="#cb8-603" aria-hidden="true" tabindex="-1"></a>                    processed_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb8-604"><a href="#cb8-604" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb8-605"><a href="#cb8-605" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ DeepSeek: </span><span class="sc">{</span>processed_count<span class="sc">}</span><span class="ss"> conversas processadas.&quot;</span>)</span>
<span id="cb8-606"><a href="#cb8-606" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb8-607"><a href="#cb8-607" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb8-608"><a href="#cb8-608" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚ùå Erro ao processar DeepSeek: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb8-609"><a href="#cb8-609" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb8-610"><a href="#cb8-610" aria-hidden="true" tabindex="-1"></a>                traceback.print_exc()</span>
<span id="cb8-611"><a href="#cb8-611" aria-hidden="true" tabindex="-1"></a>        <span class="cf">finally</span>:</span>
<span id="cb8-612"><a href="#cb8-612" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="st">&#39;temp_dir&#39;</span> <span class="kw">in</span> <span class="bu">locals</span>():</span>
<span id="cb8-613"><a href="#cb8-613" aria-hidden="true" tabindex="-1"></a>                shutil.rmtree(temp_dir, ignore_errors<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb8-614"><a href="#cb8-614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-615"><a href="#cb8-615" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> process_grok(<span class="va">self</span>, path: Path):</span>
<span id="cb8-616"><a href="#cb8-616" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Processa exporta√ß√£o do Grok&quot;&quot;&quot;</span></span>
<span id="cb8-617"><a href="#cb8-617" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb8-618"><a href="#cb8-618" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;üß™ [DRY-RUN] Processaria Grok: </span><span class="sc">{</span>path<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb8-619"><a href="#cb8-619" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb8-620"><a href="#cb8-620" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb8-621"><a href="#cb8-621" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb8-622"><a href="#cb8-622" aria-hidden="true" tabindex="-1"></a>            temp_dir <span class="op">=</span> tempfile.mkdtemp(prefix<span class="op">=</span><span class="st">&quot;grok_&quot;</span>)</span>
<span id="cb8-623"><a href="#cb8-623" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> zipfile.ZipFile(path, <span class="st">&#39;r&#39;</span>) <span class="im">as</span> z:</span>
<span id="cb8-624"><a href="#cb8-624" aria-hidden="true" tabindex="-1"></a>                z.extractall(temp_dir)</span>
<span id="cb8-625"><a href="#cb8-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-626"><a href="#cb8-626" aria-hidden="true" tabindex="-1"></a>            target_file <span class="op">=</span> <span class="va">None</span></span>
<span id="cb8-627"><a href="#cb8-627" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> root, _, files <span class="kw">in</span> os.walk(temp_dir):</span>
<span id="cb8-628"><a href="#cb8-628" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> <span class="bu">file</span> <span class="kw">in</span> files:</span>
<span id="cb8-629"><a href="#cb8-629" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="bu">file</span> <span class="op">==</span> <span class="st">&quot;prod-grok-backend.json&quot;</span>:</span>
<span id="cb8-630"><a href="#cb8-630" aria-hidden="true" tabindex="-1"></a>                        target_file <span class="op">=</span> Path(root) <span class="op">/</span> <span class="bu">file</span></span>
<span id="cb8-631"><a href="#cb8-631" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">break</span></span>
<span id="cb8-632"><a href="#cb8-632" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> target_file:</span>
<span id="cb8-633"><a href="#cb8-633" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">break</span></span>
<span id="cb8-634"><a href="#cb8-634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-635"><a href="#cb8-635" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> target_file:</span>
<span id="cb8-636"><a href="#cb8-636" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;‚ùå Grok: ficheiro &#39;prod-grok-backend.json&#39; n√£o encontrado no ZIP.&quot;</span>)</span>
<span id="cb8-637"><a href="#cb8-637" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span></span>
<span id="cb8-638"><a href="#cb8-638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-639"><a href="#cb8-639" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;üîç Grok: carregando </span><span class="sc">{</span>target_file<span class="sc">.</span>name<span class="sc">}</span><span class="ss">...&quot;</span>)</span>
<span id="cb8-640"><a href="#cb8-640" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(target_file, <span class="st">&#39;r&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb8-641"><a href="#cb8-641" aria-hidden="true" tabindex="-1"></a>                data <span class="op">=</span> json.load(f)</span>
<span id="cb8-642"><a href="#cb8-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-643"><a href="#cb8-643" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(data, <span class="bu">dict</span>) <span class="kw">or</span> <span class="st">&#39;conversations&#39;</span> <span class="kw">not</span> <span class="kw">in</span> data:</span>
<span id="cb8-644"><a href="#cb8-644" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;‚ùå Grok: estrutura inesperada ‚Äî chave &#39;conversations&#39; n√£o encontrada.&quot;</span>)</span>
<span id="cb8-645"><a href="#cb8-645" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span></span>
<span id="cb8-646"><a href="#cb8-646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-647"><a href="#cb8-647" aria-hidden="true" tabindex="-1"></a>            conversations_list <span class="op">=</span> data[<span class="st">&#39;conversations&#39;</span>]</span>
<span id="cb8-648"><a href="#cb8-648" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(conversations_list, <span class="bu">list</span>):</span>
<span id="cb8-649"><a href="#cb8-649" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;‚ùå Grok: &#39;conversations&#39; n√£o √© uma lista.&quot;</span>)</span>
<span id="cb8-650"><a href="#cb8-650" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span></span>
<span id="cb8-651"><a href="#cb8-651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-652"><a href="#cb8-652" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;üìä Grok: encontradas </span><span class="sc">{</span><span class="bu">len</span>(conversations_list)<span class="sc">}</span><span class="ss"> conversas.&quot;</span>)</span>
<span id="cb8-653"><a href="#cb8-653" aria-hidden="true" tabindex="-1"></a>            total_convs <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb8-654"><a href="#cb8-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-655"><a href="#cb8-655" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> item <span class="kw">in</span> conversations_list:</span>
<span id="cb8-656"><a href="#cb8-656" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(item, <span class="bu">dict</span>):</span>
<span id="cb8-657"><a href="#cb8-657" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">continue</span></span>
<span id="cb8-658"><a href="#cb8-658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-659"><a href="#cb8-659" aria-hidden="true" tabindex="-1"></a>                conv_meta <span class="op">=</span> item.get(<span class="st">&#39;conversation&#39;</span>)</span>
<span id="cb8-660"><a href="#cb8-660" aria-hidden="true" tabindex="-1"></a>                responses <span class="op">=</span> item.get(<span class="st">&#39;responses&#39;</span>, [])</span>
<span id="cb8-661"><a href="#cb8-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-662"><a href="#cb8-662" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(conv_meta, <span class="bu">dict</span>) <span class="kw">or</span> <span class="kw">not</span> <span class="bu">isinstance</span>(responses, <span class="bu">list</span>) <span class="kw">or</span> <span class="kw">not</span> responses:</span>
<span id="cb8-663"><a href="#cb8-663" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">continue</span></span>
<span id="cb8-664"><a href="#cb8-664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-665"><a href="#cb8-665" aria-hidden="true" tabindex="-1"></a>                conv_id <span class="op">=</span> conv_meta.get(<span class="st">&#39;id&#39;</span>)</span>
<span id="cb8-666"><a href="#cb8-666" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="kw">not</span> conv_id:</span>
<span id="cb8-667"><a href="#cb8-667" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">continue</span></span>
<span id="cb8-668"><a href="#cb8-668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-669"><a href="#cb8-669" aria-hidden="true" tabindex="-1"></a>                title <span class="op">=</span> conv_meta.get(<span class="st">&#39;title&#39;</span>, <span class="ss">f&quot;Conversa Grok </span><span class="sc">{</span>total_convs <span class="op">+</span> <span class="dv">1</span><span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb8-670"><a href="#cb8-670" aria-hidden="true" tabindex="-1"></a>                title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(title)</span>
<span id="cb8-671"><a href="#cb8-671" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb8-672"><a href="#cb8-672" aria-hidden="true" tabindex="-1"></a>                create_time_str <span class="op">=</span> conv_meta.get(<span class="st">&#39;create_time&#39;</span>)</span>
<span id="cb8-673"><a href="#cb8-673" aria-hidden="true" tabindex="-1"></a>                modify_time_str <span class="op">=</span> conv_meta.get(<span class="st">&#39;modify_time&#39;</span>)</span>
<span id="cb8-674"><a href="#cb8-674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-675"><a href="#cb8-675" aria-hidden="true" tabindex="-1"></a>                <span class="kw">def</span> format_iso_timestamp(ts_str):</span>
<span id="cb8-676"><a href="#cb8-676" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="kw">not</span> ts_str:</span>
<span id="cb8-677"><a href="#cb8-677" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb8-678"><a href="#cb8-678" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">try</span>:</span>
<span id="cb8-679"><a href="#cb8-679" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">if</span> <span class="st">&#39;.&#39;</span> <span class="kw">in</span> ts_str:</span>
<span id="cb8-680"><a href="#cb8-680" aria-hidden="true" tabindex="-1"></a>                            ts_str <span class="op">=</span> ts_str.split(<span class="st">&#39;.&#39;</span>)[<span class="dv">0</span>] <span class="op">+</span> <span class="st">&#39;Z&#39;</span></span>
<span id="cb8-681"><a href="#cb8-681" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">return</span> <span class="va">self</span>.format_timestamp(ts_str)</span>
<span id="cb8-682"><a href="#cb8-682" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">except</span>:</span>
<span id="cb8-683"><a href="#cb8-683" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">return</span> <span class="bu">str</span>(ts_str)</span>
<span id="cb8-684"><a href="#cb8-684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-685"><a href="#cb8-685" aria-hidden="true" tabindex="-1"></a>                inserted_at <span class="op">=</span> format_iso_timestamp(create_time_str)</span>
<span id="cb8-686"><a href="#cb8-686" aria-hidden="true" tabindex="-1"></a>                updated_at <span class="op">=</span> format_iso_timestamp(modify_time_str)</span>
<span id="cb8-687"><a href="#cb8-687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-688"><a href="#cb8-688" aria-hidden="true" tabindex="-1"></a>                messages <span class="op">=</span> []</span>
<span id="cb8-689"><a href="#cb8-689" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> resp <span class="kw">in</span> responses:</span>
<span id="cb8-690"><a href="#cb8-690" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(resp, <span class="bu">dict</span>):</span>
<span id="cb8-691"><a href="#cb8-691" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb8-692"><a href="#cb8-692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-693"><a href="#cb8-693" aria-hidden="true" tabindex="-1"></a>                    resp_data <span class="op">=</span> resp.get(<span class="st">&#39;response&#39;</span>)</span>
<span id="cb8-694"><a href="#cb8-694" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(resp_data, <span class="bu">dict</span>):</span>
<span id="cb8-695"><a href="#cb8-695" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb8-696"><a href="#cb8-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-697"><a href="#cb8-697" aria-hidden="true" tabindex="-1"></a>                    sender <span class="op">=</span> resp_data.get(<span class="st">&#39;sender&#39;</span>, <span class="st">&#39;&#39;</span>).upper()</span>
<span id="cb8-698"><a href="#cb8-698" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> sender <span class="op">==</span> <span class="st">&#39;HUMAN&#39;</span>:</span>
<span id="cb8-699"><a href="#cb8-699" aria-hidden="true" tabindex="-1"></a>                        author <span class="op">=</span> <span class="st">&quot;üë§ Utilizador&quot;</span></span>
<span id="cb8-700"><a href="#cb8-700" aria-hidden="true" tabindex="-1"></a>                        role <span class="op">=</span> <span class="st">&quot;user&quot;</span></span>
<span id="cb8-701"><a href="#cb8-701" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">elif</span> sender <span class="op">==</span> <span class="st">&#39;ASSISTANT&#39;</span>:</span>
<span id="cb8-702"><a href="#cb8-702" aria-hidden="true" tabindex="-1"></a>                        author <span class="op">=</span> <span class="st">&quot;ü§ñ Grok&quot;</span></span>
<span id="cb8-703"><a href="#cb8-703" aria-hidden="true" tabindex="-1"></a>                        role <span class="op">=</span> <span class="st">&quot;assistant&quot;</span></span>
<span id="cb8-704"><a href="#cb8-704" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">else</span>:</span>
<span id="cb8-705"><a href="#cb8-705" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb8-706"><a href="#cb8-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-707"><a href="#cb8-707" aria-hidden="true" tabindex="-1"></a>                    content <span class="op">=</span> <span class="bu">str</span>(resp_data.get(<span class="st">&#39;message&#39;</span>, <span class="st">&#39;&#39;</span>)).strip()</span>
<span id="cb8-708"><a href="#cb8-708" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb8-709"><a href="#cb8-709" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># APLICA PRESERVA√á√ÉO</span></span>
<span id="cb8-710"><a href="#cb8-710" aria-hidden="true" tabindex="-1"></a>                    content <span class="op">=</span> <span class="va">self</span>.preserve_special_content(content)</span>
<span id="cb8-711"><a href="#cb8-711" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb8-712"><a href="#cb8-712" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="kw">not</span> content:</span>
<span id="cb8-713"><a href="#cb8-713" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb8-714"><a href="#cb8-714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-715"><a href="#cb8-715" aria-hidden="true" tabindex="-1"></a>                    create_time <span class="op">=</span> resp_data.get(<span class="st">&#39;create_time&#39;</span>)</span>
<span id="cb8-716"><a href="#cb8-716" aria-hidden="true" tabindex="-1"></a>                    timestamp_ms <span class="op">=</span> <span class="va">None</span></span>
<span id="cb8-717"><a href="#cb8-717" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="bu">isinstance</span>(create_time, <span class="bu">dict</span>) <span class="kw">and</span> <span class="st">&#39;$date&#39;</span> <span class="kw">in</span> create_time:</span>
<span id="cb8-718"><a href="#cb8-718" aria-hidden="true" tabindex="-1"></a>                        date_obj <span class="op">=</span> create_time[<span class="st">&#39;$date&#39;</span>]</span>
<span id="cb8-719"><a href="#cb8-719" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">if</span> <span class="bu">isinstance</span>(date_obj, <span class="bu">dict</span>) <span class="kw">and</span> <span class="st">&#39;$numberLong&#39;</span> <span class="kw">in</span> date_obj:</span>
<span id="cb8-720"><a href="#cb8-720" aria-hidden="true" tabindex="-1"></a>                            <span class="cf">try</span>:</span>
<span id="cb8-721"><a href="#cb8-721" aria-hidden="true" tabindex="-1"></a>                                timestamp_ms <span class="op">=</span> <span class="bu">int</span>(date_obj[<span class="st">&#39;$numberLong&#39;</span>])</span>
<span id="cb8-722"><a href="#cb8-722" aria-hidden="true" tabindex="-1"></a>                            <span class="cf">except</span>:</span>
<span id="cb8-723"><a href="#cb8-723" aria-hidden="true" tabindex="-1"></a>                                <span class="cf">pass</span></span>
<span id="cb8-724"><a href="#cb8-724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-725"><a href="#cb8-725" aria-hidden="true" tabindex="-1"></a>                    messages.append({</span>
<span id="cb8-726"><a href="#cb8-726" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;author&#39;</span>: author,</span>
<span id="cb8-727"><a href="#cb8-727" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;role&#39;</span>: role,</span>
<span id="cb8-728"><a href="#cb8-728" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;content&#39;</span>: content,</span>
<span id="cb8-729"><a href="#cb8-729" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;timestamp&#39;</span>: <span class="va">self</span>.format_timestamp(timestamp_ms <span class="op">/</span> <span class="fl">1000.0</span> <span class="cf">if</span> timestamp_ms <span class="cf">else</span> <span class="va">None</span>),</span>
<span id="cb8-730"><a href="#cb8-730" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;model&#39;</span>: <span class="st">&#39;Grok&#39;</span></span>
<span id="cb8-731"><a href="#cb8-731" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb8-732"><a href="#cb8-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-733"><a href="#cb8-733" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> messages:</span>
<span id="cb8-734"><a href="#cb8-734" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.all_conversations.append({</span>
<span id="cb8-735"><a href="#cb8-735" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;title&#39;</span>: title,</span>
<span id="cb8-736"><a href="#cb8-736" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;source&#39;</span>: <span class="st">&#39;Grok&#39;</span>,</span>
<span id="cb8-737"><a href="#cb8-737" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;id&#39;</span>: conv_id,</span>
<span id="cb8-738"><a href="#cb8-738" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;inserted_at&#39;</span>: inserted_at,</span>
<span id="cb8-739"><a href="#cb8-739" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;updated_at&#39;</span>: updated_at,</span>
<span id="cb8-740"><a href="#cb8-740" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;messages&#39;</span>: messages,</span>
<span id="cb8-741"><a href="#cb8-741" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;summary&#39;</span>: messages[<span class="dv">0</span>][<span class="st">&#39;content&#39;</span>][:<span class="dv">100</span>] <span class="op">+</span> <span class="st">&quot;...&quot;</span> <span class="cf">if</span> messages <span class="cf">else</span> <span class="st">&quot;Sem conte√∫do&quot;</span>,</span>
<span id="cb8-742"><a href="#cb8-742" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;category&#39;</span>: <span class="st">&#39;Geral&#39;</span></span>
<span id="cb8-743"><a href="#cb8-743" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb8-744"><a href="#cb8-744" aria-hidden="true" tabindex="-1"></a>                    total_convs <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb8-745"><a href="#cb8-745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-746"><a href="#cb8-746" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> total_convs <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb8-747"><a href="#cb8-747" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ Grok: processadas </span><span class="sc">{</span>total_convs<span class="sc">}</span><span class="ss"> conversas.&quot;</span>)</span>
<span id="cb8-748"><a href="#cb8-748" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb8-749"><a href="#cb8-749" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;‚ùå Grok: nenhuma conversa v√°lida encontrada.&quot;</span>)</span>
<span id="cb8-750"><a href="#cb8-750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-751"><a href="#cb8-751" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb8-752"><a href="#cb8-752" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚ùå Erro ao processar Grok: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb8-753"><a href="#cb8-753" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb8-754"><a href="#cb8-754" aria-hidden="true" tabindex="-1"></a>                traceback.print_exc()</span>
<span id="cb8-755"><a href="#cb8-755" aria-hidden="true" tabindex="-1"></a>        <span class="cf">finally</span>:</span>
<span id="cb8-756"><a href="#cb8-756" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="st">&#39;temp_dir&#39;</span> <span class="kw">in</span> <span class="bu">locals</span>():</span>
<span id="cb8-757"><a href="#cb8-757" aria-hidden="true" tabindex="-1"></a>                shutil.rmtree(temp_dir, ignore_errors<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb8-758"><a href="#cb8-758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-759"><a href="#cb8-759" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> save_as_markdown_enhanced(<span class="va">self</span>):</span>
<span id="cb8-760"><a href="#cb8-760" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Salva conversas com preserva√ß√£o total de formata√ß√£o&quot;&quot;&quot;</span></span>
<span id="cb8-761"><a href="#cb8-761" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb8-762"><a href="#cb8-762" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;üß™ [DRY-RUN] Markdowns seriam criados:&quot;</span>)</span>
<span id="cb8-763"><a href="#cb8-763" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> conv <span class="kw">in</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb8-764"><a href="#cb8-764" aria-hidden="true" tabindex="-1"></a>                safe_title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(conv[<span class="st">&#39;title&#39;</span>])</span>
<span id="cb8-765"><a href="#cb8-765" aria-hidden="true" tabindex="-1"></a>                filename <span class="op">=</span> <span class="ss">f&quot;</span><span class="sc">{</span>conv[<span class="st">&#39;number&#39;</span>]<span class="sc">:03d}</span><span class="ss">_</span><span class="sc">{</span>conv[<span class="st">&#39;source&#39;</span>]<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>safe_title<span class="sc">}</span><span class="ss">.md&quot;</span></span>
<span id="cb8-766"><a href="#cb8-766" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;   üìÑ </span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb8-767"><a href="#cb8-767" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb8-768"><a href="#cb8-768" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb8-769"><a href="#cb8-769" aria-hidden="true" tabindex="-1"></a>        folder <span class="op">=</span> <span class="va">self</span>.output_dirs[<span class="st">&#39;markdown&#39;</span>]</span>
<span id="cb8-770"><a href="#cb8-770" aria-hidden="true" tabindex="-1"></a>        saved_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb8-771"><a href="#cb8-771" aria-hidden="true" tabindex="-1"></a>        failed_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb8-772"><a href="#cb8-772" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-773"><a href="#cb8-773" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> conv <span class="kw">in</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb8-774"><a href="#cb8-774" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb8-775"><a href="#cb8-775" aria-hidden="true" tabindex="-1"></a>                safe_title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(conv[<span class="st">&#39;title&#39;</span>])</span>
<span id="cb8-776"><a href="#cb8-776" aria-hidden="true" tabindex="-1"></a>                filename <span class="op">=</span> <span class="ss">f&quot;</span><span class="sc">{</span>conv[<span class="st">&#39;number&#39;</span>]<span class="sc">:03d}</span><span class="ss">_</span><span class="sc">{</span>conv[<span class="st">&#39;source&#39;</span>]<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>safe_title<span class="sc">}</span><span class="ss">.md&quot;</span></span>
<span id="cb8-777"><a href="#cb8-777" aria-hidden="true" tabindex="-1"></a>                filepath <span class="op">=</span> Path(folder) <span class="op">/</span> filename</span>
<span id="cb8-778"><a href="#cb8-778" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb8-779"><a href="#cb8-779" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.force_overwrite <span class="kw">and</span> filepath.exists():</span>
<span id="cb8-780"><a href="#cb8-780" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">continue</span></span>
<span id="cb8-781"><a href="#cb8-781" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb8-782"><a href="#cb8-782" aria-hidden="true" tabindex="-1"></a>                markdown_content <span class="op">=</span> <span class="va">self</span>.create_enhanced_markdown_content(conv)</span>
<span id="cb8-783"><a href="#cb8-783" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb8-784"><a href="#cb8-784" aria-hidden="true" tabindex="-1"></a>                <span class="cf">with</span> <span class="bu">open</span>(filepath, <span class="st">&#39;w&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb8-785"><a href="#cb8-785" aria-hidden="true" tabindex="-1"></a>                    f.write(markdown_content)</span>
<span id="cb8-786"><a href="#cb8-786" aria-hidden="true" tabindex="-1"></a>                saved_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb8-787"><a href="#cb8-787" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb8-788"><a href="#cb8-788" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Verifica conte√∫do especial preservado</span></span>
<span id="cb8-789"><a href="#cb8-789" aria-hidden="true" tabindex="-1"></a>                has_math <span class="op">=</span> <span class="bu">any</span>(<span class="st">&#39;$&#39;</span> <span class="kw">in</span> msg[<span class="st">&#39;content&#39;</span>] <span class="cf">for</span> msg <span class="kw">in</span> conv[<span class="st">&#39;messages&#39;</span>])</span>
<span id="cb8-790"><a href="#cb8-790" aria-hidden="true" tabindex="-1"></a>                has_code <span class="op">=</span> <span class="bu">any</span>(<span class="st">&#39;```&#39;</span> <span class="kw">in</span> msg[<span class="st">&#39;content&#39;</span>] <span class="cf">for</span> msg <span class="kw">in</span> conv[<span class="st">&#39;messages&#39;</span>])</span>
<span id="cb8-791"><a href="#cb8-791" aria-hidden="true" tabindex="-1"></a>                has_emojis <span class="op">=</span> <span class="bu">any</span>(<span class="bu">any</span>(<span class="bu">ord</span>(c) <span class="op">&gt;</span> <span class="dv">127</span> <span class="cf">for</span> c <span class="kw">in</span> msg[<span class="st">&#39;content&#39;</span>]) <span class="cf">for</span> msg <span class="kw">in</span> conv[<span class="st">&#39;messages&#39;</span>])</span>
<span id="cb8-792"><a href="#cb8-792" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb8-793"><a href="#cb8-793" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> has_math <span class="kw">or</span> has_code <span class="kw">or</span> has_emojis:</span>
<span id="cb8-794"><a href="#cb8-794" aria-hidden="true" tabindex="-1"></a>                    special_content <span class="op">=</span> []</span>
<span id="cb8-795"><a href="#cb8-795" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> has_math: special_content.append(<span class="st">&quot;f√≥rmulas&quot;</span>)</span>
<span id="cb8-796"><a href="#cb8-796" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> has_code: special_content.append(<span class="st">&quot;c√≥digo&quot;</span>)</span>
<span id="cb8-797"><a href="#cb8-797" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> has_emojis: special_content.append(<span class="st">&quot;emojis&quot;</span>)</span>
<span id="cb8-798"><a href="#cb8-798" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="ss">f&quot;   üìù Conversa </span><span class="sc">{</span>conv[<span class="st">&#39;number&#39;</span>]<span class="sc">}</span><span class="ss">: Preservados </span><span class="sc">{</span><span class="st">&#39;, &#39;</span><span class="sc">.</span>join(special_content)<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb8-799"><a href="#cb8-799" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb8-800"><a href="#cb8-800" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb8-801"><a href="#cb8-801" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;‚ùå Erro ao salvar conversa </span><span class="sc">{</span>conv[<span class="st">&#39;number&#39;</span>]<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb8-802"><a href="#cb8-802" aria-hidden="true" tabindex="-1"></a>                failed_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb8-803"><a href="#cb8-803" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span></span>
<span id="cb8-804"><a href="#cb8-804" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb8-805"><a href="#cb8-805" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ Markdown: </span><span class="sc">{</span>saved_count<span class="sc">}</span><span class="ss"> arquivos criados, </span><span class="sc">{</span>failed_count<span class="sc">}</span><span class="ss"> falhas em &#39;</span><span class="sc">{</span>folder<span class="sc">}</span><span class="ss">&#39;&quot;</span>)</span>
<span id="cb8-806"><a href="#cb8-806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-807"><a href="#cb8-807" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> save_as_csv(<span class="va">self</span>):</span>
<span id="cb8-808"><a href="#cb8-808" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Salva conversas em arquivos CSV individuais&quot;&quot;&quot;</span></span>
<span id="cb8-809"><a href="#cb8-809" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb8-810"><a href="#cb8-810" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;üß™ [DRY-RUN] CSVs seriam criados:&quot;</span>)</span>
<span id="cb8-811"><a href="#cb8-811" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> conv <span class="kw">in</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb8-812"><a href="#cb8-812" aria-hidden="true" tabindex="-1"></a>                safe_title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(conv[<span class="st">&#39;title&#39;</span>])</span>
<span id="cb8-813"><a href="#cb8-813" aria-hidden="true" tabindex="-1"></a>                filename <span class="op">=</span> <span class="ss">f&quot;</span><span class="sc">{</span>conv[<span class="st">&#39;number&#39;</span>]<span class="sc">:03d}</span><span class="ss">_</span><span class="sc">{</span>conv[<span class="st">&#39;source&#39;</span>]<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>safe_title<span class="sc">}</span><span class="ss">.csv&quot;</span></span>
<span id="cb8-814"><a href="#cb8-814" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;   üìä </span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb8-815"><a href="#cb8-815" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb8-816"><a href="#cb8-816" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb8-817"><a href="#cb8-817" aria-hidden="true" tabindex="-1"></a>        folder <span class="op">=</span> <span class="va">self</span>.output_dirs[<span class="st">&#39;csv&#39;</span>]</span>
<span id="cb8-818"><a href="#cb8-818" aria-hidden="true" tabindex="-1"></a>        saved_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb8-819"><a href="#cb8-819" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-820"><a href="#cb8-820" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> conv <span class="kw">in</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb8-821"><a href="#cb8-821" aria-hidden="true" tabindex="-1"></a>            safe_title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(conv[<span class="st">&#39;title&#39;</span>])</span>
<span id="cb8-822"><a href="#cb8-822" aria-hidden="true" tabindex="-1"></a>            filename <span class="op">=</span> <span class="ss">f&quot;</span><span class="sc">{</span>conv[<span class="st">&#39;number&#39;</span>]<span class="sc">:03d}</span><span class="ss">_</span><span class="sc">{</span>conv[<span class="st">&#39;source&#39;</span>]<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>safe_title<span class="sc">}</span><span class="ss">.csv&quot;</span></span>
<span id="cb8-823"><a href="#cb8-823" aria-hidden="true" tabindex="-1"></a>            filepath <span class="op">=</span> Path(folder) <span class="op">/</span> filename</span>
<span id="cb8-824"><a href="#cb8-824" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb8-825"><a href="#cb8-825" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.force_overwrite <span class="kw">and</span> filepath.exists():</span>
<span id="cb8-826"><a href="#cb8-826" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span></span>
<span id="cb8-827"><a href="#cb8-827" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb8-828"><a href="#cb8-828" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(filepath, <span class="st">&#39;w&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>, newline<span class="op">=</span><span class="st">&#39;&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb8-829"><a href="#cb8-829" aria-hidden="true" tabindex="-1"></a>                writer <span class="op">=</span> csv.DictWriter(f, fieldnames<span class="op">=</span>[</span>
<span id="cb8-830"><a href="#cb8-830" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;node_id&#39;</span>, <span class="st">&#39;author&#39;</span>, <span class="st">&#39;role&#39;</span>, <span class="st">&#39;timestamp&#39;</span>, <span class="st">&#39;model&#39;</span>, <span class="st">&#39;content&#39;</span></span>
<span id="cb8-831"><a href="#cb8-831" aria-hidden="true" tabindex="-1"></a>                ])</span>
<span id="cb8-832"><a href="#cb8-832" aria-hidden="true" tabindex="-1"></a>                writer.writeheader()</span>
<span id="cb8-833"><a href="#cb8-833" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> i, msg <span class="kw">in</span> <span class="bu">enumerate</span>(conv[<span class="st">&#39;messages&#39;</span>]):</span>
<span id="cb8-834"><a href="#cb8-834" aria-hidden="true" tabindex="-1"></a>                    writer.writerow({</span>
<span id="cb8-835"><a href="#cb8-835" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;node_id&#39;</span>: <span class="bu">str</span>(i),</span>
<span id="cb8-836"><a href="#cb8-836" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;author&#39;</span>: msg[<span class="st">&#39;author&#39;</span>],</span>
<span id="cb8-837"><a href="#cb8-837" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;role&#39;</span>: msg[<span class="st">&#39;role&#39;</span>],</span>
<span id="cb8-838"><a href="#cb8-838" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;timestamp&#39;</span>: msg[<span class="st">&#39;timestamp&#39;</span>],</span>
<span id="cb8-839"><a href="#cb8-839" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;model&#39;</span>: msg[<span class="st">&#39;model&#39;</span>],</span>
<span id="cb8-840"><a href="#cb8-840" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;content&#39;</span>: msg[<span class="st">&#39;content&#39;</span>]</span>
<span id="cb8-841"><a href="#cb8-841" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb8-842"><a href="#cb8-842" aria-hidden="true" tabindex="-1"></a>            saved_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb8-843"><a href="#cb8-843" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb8-844"><a href="#cb8-844" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ CSV: </span><span class="sc">{</span>saved_count<span class="sc">}</span><span class="ss"> arquivos criados em &#39;</span><span class="sc">{</span>folder<span class="sc">}</span><span class="ss">&#39;&quot;</span>)</span>
<span id="cb8-845"><a href="#cb8-845" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-846"><a href="#cb8-846" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> save_as_json(<span class="va">self</span>):</span>
<span id="cb8-847"><a href="#cb8-847" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Salva conversas em arquivos JSON individuais&quot;&quot;&quot;</span></span>
<span id="cb8-848"><a href="#cb8-848" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb8-849"><a href="#cb8-849" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;üß™ [DRY-RUN] JSONs seriam criados:&quot;</span>)</span>
<span id="cb8-850"><a href="#cb8-850" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> conv <span class="kw">in</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb8-851"><a href="#cb8-851" aria-hidden="true" tabindex="-1"></a>                safe_title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(conv[<span class="st">&#39;title&#39;</span>])</span>
<span id="cb8-852"><a href="#cb8-852" aria-hidden="true" tabindex="-1"></a>                filename <span class="op">=</span> <span class="ss">f&quot;</span><span class="sc">{</span>conv[<span class="st">&#39;number&#39;</span>]<span class="sc">:03d}</span><span class="ss">_</span><span class="sc">{</span>conv[<span class="st">&#39;source&#39;</span>]<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>safe_title<span class="sc">}</span><span class="ss">.json&quot;</span></span>
<span id="cb8-853"><a href="#cb8-853" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;   üìã </span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb8-854"><a href="#cb8-854" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb8-855"><a href="#cb8-855" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb8-856"><a href="#cb8-856" aria-hidden="true" tabindex="-1"></a>        folder <span class="op">=</span> <span class="va">self</span>.output_dirs[<span class="st">&#39;json&#39;</span>]</span>
<span id="cb8-857"><a href="#cb8-857" aria-hidden="true" tabindex="-1"></a>        saved_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb8-858"><a href="#cb8-858" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-859"><a href="#cb8-859" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> conv <span class="kw">in</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb8-860"><a href="#cb8-860" aria-hidden="true" tabindex="-1"></a>            safe_title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(conv[<span class="st">&#39;title&#39;</span>])</span>
<span id="cb8-861"><a href="#cb8-861" aria-hidden="true" tabindex="-1"></a>            filename <span class="op">=</span> <span class="ss">f&quot;</span><span class="sc">{</span>conv[<span class="st">&#39;number&#39;</span>]<span class="sc">:03d}</span><span class="ss">_</span><span class="sc">{</span>conv[<span class="st">&#39;source&#39;</span>]<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>safe_title<span class="sc">}</span><span class="ss">.json&quot;</span></span>
<span id="cb8-862"><a href="#cb8-862" aria-hidden="true" tabindex="-1"></a>            filepath <span class="op">=</span> Path(folder) <span class="op">/</span> filename</span>
<span id="cb8-863"><a href="#cb8-863" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb8-864"><a href="#cb8-864" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.force_overwrite <span class="kw">and</span> filepath.exists():</span>
<span id="cb8-865"><a href="#cb8-865" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span></span>
<span id="cb8-866"><a href="#cb8-866" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb8-867"><a href="#cb8-867" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(filepath, <span class="st">&#39;w&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb8-868"><a href="#cb8-868" aria-hidden="true" tabindex="-1"></a>                json.dump(conv, f, ensure_ascii<span class="op">=</span><span class="va">False</span>, indent<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb8-869"><a href="#cb8-869" aria-hidden="true" tabindex="-1"></a>            saved_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb8-870"><a href="#cb8-870" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb8-871"><a href="#cb8-871" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ JSON: </span><span class="sc">{</span>saved_count<span class="sc">}</span><span class="ss"> arquivos criados em &#39;</span><span class="sc">{</span>folder<span class="sc">}</span><span class="ss">&#39;&quot;</span>)</span>
<span id="cb8-872"><a href="#cb8-872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-873"><a href="#cb8-873" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> save_all_to_single_files(<span class="va">self</span>):</span>
<span id="cb8-874"><a href="#cb8-874" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Salva todas as conversas em arquivos √∫nicos CSV e JSON&quot;&quot;&quot;</span></span>
<span id="cb8-875"><a href="#cb8-875" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb8-876"><a href="#cb8-876" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;üß™ [DRY-RUN] Arquivos √∫nicos seriam criados:&quot;</span>)</span>
<span id="cb8-877"><a href="#cb8-877" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;   üìÅ </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>single_files[<span class="st">&#39;csv&#39;</span>]<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb8-878"><a href="#cb8-878" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;   üìÅ </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>single_files[<span class="st">&#39;json&#39;</span>]<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb8-879"><a href="#cb8-879" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb8-880"><a href="#cb8-880" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb8-881"><a href="#cb8-881" aria-hidden="true" tabindex="-1"></a>        <span class="co"># CSV √∫nico</span></span>
<span id="cb8-882"><a href="#cb8-882" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> <span class="bu">open</span>(<span class="va">self</span>.single_files[<span class="st">&#39;csv&#39;</span>], <span class="st">&#39;w&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>, newline<span class="op">=</span><span class="st">&#39;&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb8-883"><a href="#cb8-883" aria-hidden="true" tabindex="-1"></a>            fieldnames <span class="op">=</span> [</span>
<span id="cb8-884"><a href="#cb8-884" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;conversation_number&#39;</span>, <span class="st">&#39;source&#39;</span>, <span class="st">&#39;conversation_title&#39;</span>, <span class="st">&#39;category&#39;</span>,</span>
<span id="cb8-885"><a href="#cb8-885" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;author&#39;</span>, <span class="st">&#39;role&#39;</span>, <span class="st">&#39;timestamp&#39;</span>, <span class="st">&#39;model&#39;</span>, <span class="st">&#39;content&#39;</span></span>
<span id="cb8-886"><a href="#cb8-886" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb8-887"><a href="#cb8-887" aria-hidden="true" tabindex="-1"></a>            writer <span class="op">=</span> csv.DictWriter(f, fieldnames<span class="op">=</span>fieldnames)</span>
<span id="cb8-888"><a href="#cb8-888" aria-hidden="true" tabindex="-1"></a>            writer.writeheader()</span>
<span id="cb8-889"><a href="#cb8-889" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> conv <span class="kw">in</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb8-890"><a href="#cb8-890" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> msg <span class="kw">in</span> conv[<span class="st">&#39;messages&#39;</span>]:</span>
<span id="cb8-891"><a href="#cb8-891" aria-hidden="true" tabindex="-1"></a>                    writer.writerow({</span>
<span id="cb8-892"><a href="#cb8-892" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;conversation_number&#39;</span>: conv[<span class="st">&#39;number&#39;</span>],</span>
<span id="cb8-893"><a href="#cb8-893" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;source&#39;</span>: conv[<span class="st">&#39;source&#39;</span>],</span>
<span id="cb8-894"><a href="#cb8-894" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;conversation_title&#39;</span>: conv[<span class="st">&#39;title&#39;</span>],</span>
<span id="cb8-895"><a href="#cb8-895" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;category&#39;</span>: conv[<span class="st">&#39;category&#39;</span>],</span>
<span id="cb8-896"><a href="#cb8-896" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;author&#39;</span>: msg[<span class="st">&#39;author&#39;</span>],</span>
<span id="cb8-897"><a href="#cb8-897" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;role&#39;</span>: msg[<span class="st">&#39;role&#39;</span>],</span>
<span id="cb8-898"><a href="#cb8-898" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;timestamp&#39;</span>: msg[<span class="st">&#39;timestamp&#39;</span>],</span>
<span id="cb8-899"><a href="#cb8-899" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;model&#39;</span>: msg[<span class="st">&#39;model&#39;</span>],</span>
<span id="cb8-900"><a href="#cb8-900" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;content&#39;</span>: msg[<span class="st">&#39;content&#39;</span>]</span>
<span id="cb8-901"><a href="#cb8-901" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb8-902"><a href="#cb8-902" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ CSV √∫nico: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>single_files[<span class="st">&#39;csv&#39;</span>]<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb8-903"><a href="#cb8-903" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-904"><a href="#cb8-904" aria-hidden="true" tabindex="-1"></a>        <span class="co"># JSON √∫nico</span></span>
<span id="cb8-905"><a href="#cb8-905" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> <span class="bu">open</span>(<span class="va">self</span>.single_files[<span class="st">&#39;json&#39;</span>], <span class="st">&#39;w&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb8-906"><a href="#cb8-906" aria-hidden="true" tabindex="-1"></a>            json.dump(<span class="va">self</span>.all_conversations, f, ensure_ascii<span class="op">=</span><span class="va">False</span>, indent<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb8-907"><a href="#cb8-907" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ JSON √∫nico: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>single_files[<span class="st">&#39;json&#39;</span>]<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb8-908"><a href="#cb8-908" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-909"><a href="#cb8-909" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_searchable_index(<span class="va">self</span>):</span>
<span id="cb8-910"><a href="#cb8-910" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Cria √≠ndice HTML pesquis√°vel COMPLETO - CORRIGIDO&quot;&quot;&quot;</span></span>
<span id="cb8-911"><a href="#cb8-911" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb8-912"><a href="#cb8-912" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;üß™ [DRY-RUN] √çndice HTML seria criado: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>index_file<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb8-913"><a href="#cb8-913" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb8-914"><a href="#cb8-914" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb8-915"><a href="#cb8-915" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;üéØ Criando √≠ndice HTML combinado...&quot;</span>)</span>
<span id="cb8-916"><a href="#cb8-916" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-917"><a href="#cb8-917" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Estat√≠sticas por categoria</span></span>
<span id="cb8-918"><a href="#cb8-918" aria-hidden="true" tabindex="-1"></a>        category_stats <span class="op">=</span> {}</span>
<span id="cb8-919"><a href="#cb8-919" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> conv <span class="kw">in</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb8-920"><a href="#cb8-920" aria-hidden="true" tabindex="-1"></a>            cat <span class="op">=</span> conv[<span class="st">&#39;category&#39;</span>]</span>
<span id="cb8-921"><a href="#cb8-921" aria-hidden="true" tabindex="-1"></a>            category_stats[cat] <span class="op">=</span> category_stats.get(cat, <span class="dv">0</span>) <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb8-922"><a href="#cb8-922" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-923"><a href="#cb8-923" aria-hidden="true" tabindex="-1"></a>        <span class="co"># HTML content COMPLETO - CORRIGIDO</span></span>
<span id="cb8-924"><a href="#cb8-924" aria-hidden="true" tabindex="-1"></a>        html_content <span class="op">=</span> <span class="ss">f&quot;&quot;&quot;&lt;!DOCTYPE html&gt;</span></span>
<span id="cb8-925"><a href="#cb8-925" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;html lang=&quot;pt-PT&quot;&gt;</span></span>
<span id="cb8-926"><a href="#cb8-926" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;head&gt;</span></span>
<span id="cb8-927"><a href="#cb8-927" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span></span>
<span id="cb8-928"><a href="#cb8-928" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span></span>
<span id="cb8-929"><a href="#cb8-929" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;title&gt;√çndice Combinado - AI Chats&lt;/title&gt;</span></span>
<span id="cb8-930"><a href="#cb8-930" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;style&gt;</span></span>
<span id="cb8-931"><a href="#cb8-931" aria-hidden="true" tabindex="-1"></a><span class="ss">        * </span><span class="ch">{{</span><span class="ss"> margin: 0; padding: 0; box-sizing: border-box; </span><span class="ch">}}</span></span>
<span id="cb8-932"><a href="#cb8-932" aria-hidden="true" tabindex="-1"></a><span class="ss">        body </span><span class="ch">{{</span><span class="ss"> font-family: &#39;Segoe UI&#39;, Tahoma, Geneva, Verdana, sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; padding: 20px; color: #333; </span><span class="ch">}}</span></span>
<span id="cb8-933"><a href="#cb8-933" aria-hidden="true" tabindex="-1"></a><span class="ss">        .container </span><span class="ch">{{</span><span class="ss"> max-width: 1400px; margin: 0 auto; background: white; border-radius: 15px; box-shadow: 0 20px 40px rgba(0,0,0,0.1); overflow: hidden; </span><span class="ch">}}</span></span>
<span id="cb8-934"><a href="#cb8-934" aria-hidden="true" tabindex="-1"></a><span class="ss">        .header </span><span class="ch">{{</span><span class="ss"> background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 40px; text-align: center; </span><span class="ch">}}</span></span>
<span id="cb8-935"><a href="#cb8-935" aria-hidden="true" tabindex="-1"></a><span class="ss">        .header h1 </span><span class="ch">{{</span><span class="ss"> font-size: 2.8em; margin-bottom: 15px; font-weight: 300; </span><span class="ch">}}</span></span>
<span id="cb8-936"><a href="#cb8-936" aria-hidden="true" tabindex="-1"></a><span class="ss">        .header p </span><span class="ch">{{</span><span class="ss"> font-size: 1.2em; opacity: 0.9; margin-bottom: 20px; </span><span class="ch">}}</span></span>
<span id="cb8-937"><a href="#cb8-937" aria-hidden="true" tabindex="-1"></a><span class="ss">        .stats </span><span class="ch">{{</span><span class="ss"> display: flex; justify-content: center; gap: 30px; margin-top: 25px; flex-wrap: wrap; </span><span class="ch">}}</span></span>
<span id="cb8-938"><a href="#cb8-938" aria-hidden="true" tabindex="-1"></a><span class="ss">        .stat-item </span><span class="ch">{{</span><span class="ss"> background: rgba(255,255,255,0.15); padding: 18px 28px; border-radius: 12px; backdrop-filter: blur(10px); font-size: 1.1em; </span><span class="ch">}}</span></span>
<span id="cb8-939"><a href="#cb8-939" aria-hidden="true" tabindex="-1"></a><span class="ss">        .search-section </span><span class="ch">{{</span><span class="ss"> padding: 30px; background: #f8f9fa; border-bottom: 1px solid #e9ecef; </span><span class="ch">}}</span></span>
<span id="cb8-940"><a href="#cb8-940" aria-hidden="true" tabindex="-1"></a><span class="ss">        .search-box </span><span class="ch">{{</span><span class="ss"> width: 100%; padding: 18px 25px; font-size: 16px; border: 2px solid #e9ecef; border-radius: 25px; outline: none; transition: all 0.3s ease; font-family: inherit; </span><span class="ch">}}</span></span>
<span id="cb8-941"><a href="#cb8-941" aria-hidden="true" tabindex="-1"></a><span class="ss">        .search-box:focus </span><span class="ch">{{</span><span class="ss"> border-color: #667eea; box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1); </span><span class="ch">}}</span></span>
<span id="cb8-942"><a href="#cb8-942" aria-hidden="true" tabindex="-1"></a><span class="ss">        .filter-section </span><span class="ch">{{</span></span>
<span id="cb8-943"><a href="#cb8-943" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 20px 30px;</span></span>
<span id="cb8-944"><a href="#cb8-944" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: flex;</span></span>
<span id="cb8-945"><a href="#cb8-945" aria-hidden="true" tabindex="-1"></a><span class="ss">            flex-wrap: wrap;</span></span>
<span id="cb8-946"><a href="#cb8-946" aria-hidden="true" tabindex="-1"></a><span class="ss">            gap: 12px;</span></span>
<span id="cb8-947"><a href="#cb8-947" aria-hidden="true" tabindex="-1"></a><span class="ss">            justify-content: center;</span></span>
<span id="cb8-948"><a href="#cb8-948" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #f8f9fa;</span></span>
<span id="cb8-949"><a href="#cb8-949" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-bottom: 1px solid #e9ecef;</span></span>
<span id="cb8-950"><a href="#cb8-950" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb8-951"><a href="#cb8-951" aria-hidden="true" tabindex="-1"></a><span class="ss">        .filter-btn </span><span class="ch">{{</span></span>
<span id="cb8-952"><a href="#cb8-952" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 10px 20px;</span></span>
<span id="cb8-953"><a href="#cb8-953" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: white;</span></span>
<span id="cb8-954"><a href="#cb8-954" aria-hidden="true" tabindex="-1"></a><span class="ss">            border: 2px solid #e9ecef;</span></span>
<span id="cb8-955"><a href="#cb8-955" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 25px;</span></span>
<span id="cb8-956"><a href="#cb8-956" aria-hidden="true" tabindex="-1"></a><span class="ss">            cursor: pointer;</span></span>
<span id="cb8-957"><a href="#cb8-957" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.95em;</span></span>
<span id="cb8-958"><a href="#cb8-958" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-weight: 500;</span></span>
<span id="cb8-959"><a href="#cb8-959" aria-hidden="true" tabindex="-1"></a><span class="ss">            transition: all 0.3s ease;</span></span>
<span id="cb8-960"><a href="#cb8-960" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-family: inherit;</span></span>
<span id="cb8-961"><a href="#cb8-961" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb8-962"><a href="#cb8-962" aria-hidden="true" tabindex="-1"></a><span class="ss">        .filter-btn.active, .filter-btn:hover </span><span class="ch">{{</span></span>
<span id="cb8-963"><a href="#cb8-963" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #667eea;</span></span>
<span id="cb8-964"><a href="#cb8-964" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: white;</span></span>
<span id="cb8-965"><a href="#cb8-965" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-color: #667eea;</span></span>
<span id="cb8-966"><a href="#cb8-966" aria-hidden="true" tabindex="-1"></a><span class="ss">            transform: translateY(-2px);</span></span>
<span id="cb8-967"><a href="#cb8-967" aria-hidden="true" tabindex="-1"></a><span class="ss">            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);</span></span>
<span id="cb8-968"><a href="#cb8-968" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb8-969"><a href="#cb8-969" aria-hidden="true" tabindex="-1"></a><span class="ss">        .conversations-grid </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb8-970"><a href="#cb8-970" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: grid; </span></span>
<span id="cb8-971"><a href="#cb8-971" aria-hidden="true" tabindex="-1"></a><span class="ss">            grid-template-columns: repeat(auto-fill, minmax(380px, 1fr)); </span></span>
<span id="cb8-972"><a href="#cb8-972" aria-hidden="true" tabindex="-1"></a><span class="ss">            gap: 25px; </span></span>
<span id="cb8-973"><a href="#cb8-973" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 35px;</span></span>
<span id="cb8-974"><a href="#cb8-974" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);</span></span>
<span id="cb8-975"><a href="#cb8-975" aria-hidden="true" tabindex="-1"></a><span class="ss">            min-height: 400px;</span></span>
<span id="cb8-976"><a href="#cb8-976" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb8-977"><a href="#cb8-977" aria-hidden="true" tabindex="-1"></a><span class="ss">        .conversation-card </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb8-978"><a href="#cb8-978" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: white; </span></span>
<span id="cb8-979"><a href="#cb8-979" aria-hidden="true" tabindex="-1"></a><span class="ss">            border: 1px solid #e9ecef; </span></span>
<span id="cb8-980"><a href="#cb8-980" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 15px; </span></span>
<span id="cb8-981"><a href="#cb8-981" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 25px; </span></span>
<span id="cb8-982"><a href="#cb8-982" aria-hidden="true" tabindex="-1"></a><span class="ss">            transition: all 0.4s ease; </span></span>
<span id="cb8-983"><a href="#cb8-983" aria-hidden="true" tabindex="-1"></a><span class="ss">            cursor: pointer; </span></span>
<span id="cb8-984"><a href="#cb8-984" aria-hidden="true" tabindex="-1"></a><span class="ss">            position: relative;</span></span>
<span id="cb8-985"><a href="#cb8-985" aria-hidden="true" tabindex="-1"></a><span class="ss">            box-shadow: 0 5px 15px rgba(0,0,0,0.08);</span></span>
<span id="cb8-986"><a href="#cb8-986" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb8-987"><a href="#cb8-987" aria-hidden="true" tabindex="-1"></a><span class="ss">        .conversation-card:hover </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb8-988"><a href="#cb8-988" aria-hidden="true" tabindex="-1"></a><span class="ss">            transform: translateY(-8px); </span></span>
<span id="cb8-989"><a href="#cb8-989" aria-hidden="true" tabindex="-1"></a><span class="ss">            box-shadow: 0 15px 35px rgba(0,0,0,0.15); </span></span>
<span id="cb8-990"><a href="#cb8-990" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-color: #667eea;</span></span>
<span id="cb8-991"><a href="#cb8-991" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb8-992"><a href="#cb8-992" aria-hidden="true" tabindex="-1"></a><span class="ss">        .card-header </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb8-993"><a href="#cb8-993" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: flex; </span></span>
<span id="cb8-994"><a href="#cb8-994" aria-hidden="true" tabindex="-1"></a><span class="ss">            justify-content: space-between; </span></span>
<span id="cb8-995"><a href="#cb8-995" aria-hidden="true" tabindex="-1"></a><span class="ss">            align-items: flex-start; </span></span>
<span id="cb8-996"><a href="#cb8-996" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-bottom: 18px; </span></span>
<span id="cb8-997"><a href="#cb8-997" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb8-998"><a href="#cb8-998" aria-hidden="true" tabindex="-1"></a><span class="ss">        .card-number </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb8-999"><a href="#cb8-999" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: linear-gradient(135deg, #667eea, #764ba2); </span></span>
<span id="cb8-1000"><a href="#cb8-1000" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: white; </span></span>
<span id="cb8-1001"><a href="#cb8-1001" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 8px 16px; </span></span>
<span id="cb8-1002"><a href="#cb8-1002" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 20px; </span></span>
<span id="cb8-1003"><a href="#cb8-1003" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.9em; </span></span>
<span id="cb8-1004"><a href="#cb8-1004" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-weight: bold;</span></span>
<span id="cb8-1005"><a href="#cb8-1005" aria-hidden="true" tabindex="-1"></a><span class="ss">            box-shadow: 0 3px 10px rgba(102, 126, 234, 0.3);</span></span>
<span id="cb8-1006"><a href="#cb8-1006" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb8-1007"><a href="#cb8-1007" aria-hidden="true" tabindex="-1"></a><span class="ss">        .card-source </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb8-1008"><a href="#cb8-1008" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #e3f2fd; </span></span>
<span id="cb8-1009"><a href="#cb8-1009" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #1976d2; </span></span>
<span id="cb8-1010"><a href="#cb8-1010" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 5px 12px; </span></span>
<span id="cb8-1011"><a href="#cb8-1011" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 12px; </span></span>
<span id="cb8-1012"><a href="#cb8-1012" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.85em; </span></span>
<span id="cb8-1013"><a href="#cb8-1013" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-weight: bold; </span></span>
<span id="cb8-1014"><a href="#cb8-1014" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-left: 10px;</span></span>
<span id="cb8-1015"><a href="#cb8-1015" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb8-1016"><a href="#cb8-1016" aria-hidden="true" tabindex="-1"></a><span class="ss">        .card-title </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb8-1017"><a href="#cb8-1017" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 1.3em; </span></span>
<span id="cb8-1018"><a href="#cb8-1018" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-weight: 600; </span></span>
<span id="cb8-1019"><a href="#cb8-1019" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #2c3e50; </span></span>
<span id="cb8-1020"><a href="#cb8-1020" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-bottom: 12px; </span></span>
<span id="cb8-1021"><a href="#cb8-1021" aria-hidden="true" tabindex="-1"></a><span class="ss">            line-height: 1.4;</span></span>
<span id="cb8-1022"><a href="#cb8-1022" aria-hidden="true" tabindex="-1"></a><span class="ss">            min-height: 3.6em;</span></span>
<span id="cb8-1023"><a href="#cb8-1023" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb8-1024"><a href="#cb8-1024" aria-hidden="true" tabindex="-1"></a><span class="ss">        .card-summary </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb8-1025"><a href="#cb8-1025" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #6c757d; </span></span>
<span id="cb8-1026"><a href="#cb8-1026" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.95em; </span></span>
<span id="cb8-1027"><a href="#cb8-1027" aria-hidden="true" tabindex="-1"></a><span class="ss">            line-height: 1.5; </span></span>
<span id="cb8-1028"><a href="#cb8-1028" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-bottom: 18px;</span></span>
<span id="cb8-1029"><a href="#cb8-1029" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: -webkit-box;</span></span>
<span id="cb8-1030"><a href="#cb8-1030" aria-hidden="true" tabindex="-1"></a><span class="ss">            -webkit-line-clamp: 3;</span></span>
<span id="cb8-1031"><a href="#cb8-1031" aria-hidden="true" tabindex="-1"></a><span class="ss">            -webkit-box-orient: vertical;</span></span>
<span id="cb8-1032"><a href="#cb8-1032" aria-hidden="true" tabindex="-1"></a><span class="ss">            overflow: hidden;</span></span>
<span id="cb8-1033"><a href="#cb8-1033" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb8-1034"><a href="#cb8-1034" aria-hidden="true" tabindex="-1"></a><span class="ss">        .card-meta </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb8-1035"><a href="#cb8-1035" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: flex; </span></span>
<span id="cb8-1036"><a href="#cb8-1036" aria-hidden="true" tabindex="-1"></a><span class="ss">            justify-content: space-between; </span></span>
<span id="cb8-1037"><a href="#cb8-1037" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.85em; </span></span>
<span id="cb8-1038"><a href="#cb8-1038" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #868e96; </span></span>
<span id="cb8-1039"><a href="#cb8-1039" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-top: 1px solid #e9ecef; </span></span>
<span id="cb8-1040"><a href="#cb8-1040" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding-top: 18px;</span></span>
<span id="cb8-1041"><a href="#cb8-1041" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb8-1042"><a href="#cb8-1042" aria-hidden="true" tabindex="-1"></a><span class="ss">        .card-actions </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb8-1043"><a href="#cb8-1043" aria-hidden="true" tabindex="-1"></a><span class="ss">            position: absolute; </span></span>
<span id="cb8-1044"><a href="#cb8-1044" aria-hidden="true" tabindex="-1"></a><span class="ss">            top: 20px; </span></span>
<span id="cb8-1045"><a href="#cb8-1045" aria-hidden="true" tabindex="-1"></a><span class="ss">            right: 20px; </span></span>
<span id="cb8-1046"><a href="#cb8-1046" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: flex; </span></span>
<span id="cb8-1047"><a href="#cb8-1047" aria-hidden="true" tabindex="-1"></a><span class="ss">            gap: 8px; </span></span>
<span id="cb8-1048"><a href="#cb8-1048" aria-hidden="true" tabindex="-1"></a><span class="ss">            opacity: 0; </span></span>
<span id="cb8-1049"><a href="#cb8-1049" aria-hidden="true" tabindex="-1"></a><span class="ss">            transition: opacity 0.3s ease; </span></span>
<span id="cb8-1050"><a href="#cb8-1050" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb8-1051"><a href="#cb8-1051" aria-hidden="true" tabindex="-1"></a><span class="ss">        .conversation-card:hover .card-actions </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb8-1052"><a href="#cb8-1052" aria-hidden="true" tabindex="-1"></a><span class="ss">            opacity: 1; </span></span>
<span id="cb8-1053"><a href="#cb8-1053" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb8-1054"><a href="#cb8-1054" aria-hidden="true" tabindex="-1"></a><span class="ss">        .action-btn </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb8-1055"><a href="#cb8-1055" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: white; </span></span>
<span id="cb8-1056"><a href="#cb8-1056" aria-hidden="true" tabindex="-1"></a><span class="ss">            border: 2px solid #e9ecef; </span></span>
<span id="cb8-1057"><a href="#cb8-1057" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 8px; </span></span>
<span id="cb8-1058"><a href="#cb8-1058" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 6px 12px; </span></span>
<span id="cb8-1059"><a href="#cb8-1059" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.8em; </span></span>
<span id="cb8-1060"><a href="#cb8-1060" aria-hidden="true" tabindex="-1"></a><span class="ss">            cursor: pointer; </span></span>
<span id="cb8-1061"><a href="#cb8-1061" aria-hidden="true" tabindex="-1"></a><span class="ss">            transition: all 0.3s ease;</span></span>
<span id="cb8-1062"><a href="#cb8-1062" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-weight: 500;</span></span>
<span id="cb8-1063"><a href="#cb8-1063" aria-hidden="true" tabindex="-1"></a><span class="ss">            text-decoration: none;</span></span>
<span id="cb8-1064"><a href="#cb8-1064" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #333;</span></span>
<span id="cb8-1065"><a href="#cb8-1065" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: inline-block;</span></span>
<span id="cb8-1066"><a href="#cb8-1066" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb8-1067"><a href="#cb8-1067" aria-hidden="true" tabindex="-1"></a><span class="ss">        .action-btn:hover </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb8-1068"><a href="#cb8-1068" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #667eea; </span></span>
<span id="cb8-1069"><a href="#cb8-1069" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: white; </span></span>
<span id="cb8-1070"><a href="#cb8-1070" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-color: #667eea;</span></span>
<span id="cb8-1071"><a href="#cb8-1071" aria-hidden="true" tabindex="-1"></a><span class="ss">            transform: scale(1.05);</span></span>
<span id="cb8-1072"><a href="#cb8-1072" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb8-1073"><a href="#cb8-1073" aria-hidden="true" tabindex="-1"></a><span class="ss">        .recent-badge </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb8-1074"><a href="#cb8-1074" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #ff6b6b; </span></span>
<span id="cb8-1075"><a href="#cb8-1075" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: white; </span></span>
<span id="cb8-1076"><a href="#cb8-1076" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 3px 10px; </span></span>
<span id="cb8-1077"><a href="#cb8-1077" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 12px; </span></span>
<span id="cb8-1078"><a href="#cb8-1078" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.75em; </span></span>
<span id="cb8-1079"><a href="#cb8-1079" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-left: 8px;</span></span>
<span id="cb8-1080"><a href="#cb8-1080" aria-hidden="true" tabindex="-1"></a><span class="ss">            animation: pulse 2s infinite;</span></span>
<span id="cb8-1081"><a href="#cb8-1081" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb8-1082"><a href="#cb8-1082" aria-hidden="true" tabindex="-1"></a><span class="ss">        .no-results </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb8-1083"><a href="#cb8-1083" aria-hidden="true" tabindex="-1"></a><span class="ss">            text-align: center; </span></span>
<span id="cb8-1084"><a href="#cb8-1084" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 60px 20px; </span></span>
<span id="cb8-1085"><a href="#cb8-1085" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #6c757d;</span></span>
<span id="cb8-1086"><a href="#cb8-1086" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 1.1em;</span></span>
<span id="cb8-1087"><a href="#cb8-1087" aria-hidden="true" tabindex="-1"></a><span class="ss">            grid-column: 1 / -1;</span></span>
<span id="cb8-1088"><a href="#cb8-1088" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb8-1089"><a href="#cb8-1089" aria-hidden="true" tabindex="-1"></a><span class="ss">        @keyframes pulse </span><span class="ch">{{</span></span>
<span id="cb8-1090"><a href="#cb8-1090" aria-hidden="true" tabindex="-1"></a><span class="ss">            0% </span><span class="ch">{{</span><span class="ss"> transform: scale(1); </span><span class="ch">}}</span></span>
<span id="cb8-1091"><a href="#cb8-1091" aria-hidden="true" tabindex="-1"></a><span class="ss">            50% </span><span class="ch">{{</span><span class="ss"> transform: scale(1.05); </span><span class="ch">}}</span></span>
<span id="cb8-1092"><a href="#cb8-1092" aria-hidden="true" tabindex="-1"></a><span class="ss">            100% </span><span class="ch">{{</span><span class="ss"> transform: scale(1); </span><span class="ch">}}</span></span>
<span id="cb8-1093"><a href="#cb8-1093" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb8-1094"><a href="#cb8-1094" aria-hidden="true" tabindex="-1"></a><span class="ss">        .category-badge </span><span class="ch">{{</span></span>
<span id="cb8-1095"><a href="#cb8-1095" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: inline-block;</span></span>
<span id="cb8-1096"><a href="#cb8-1096" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #e3f2fd;</span></span>
<span id="cb8-1097"><a href="#cb8-1097" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #1976d2;</span></span>
<span id="cb8-1098"><a href="#cb8-1098" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 4px 10px;</span></span>
<span id="cb8-1099"><a href="#cb8-1099" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 12px;</span></span>
<span id="cb8-1100"><a href="#cb8-1100" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.8em;</span></span>
<span id="cb8-1101"><a href="#cb8-1101" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-left: 8px;</span></span>
<span id="cb8-1102"><a href="#cb8-1102" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-weight: 500;</span></span>
<span id="cb8-1103"><a href="#cb8-1103" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb8-1104"><a href="#cb8-1104" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb8-1105"><a href="#cb8-1105" aria-hidden="true" tabindex="-1"></a><span class="ss">        /* CORRE√á√ÉO: Links diretos para fallback */</span></span>
<span id="cb8-1106"><a href="#cb8-1106" aria-hidden="true" tabindex="-1"></a><span class="ss">        .direct-link </span><span class="ch">{{</span></span>
<span id="cb8-1107"><a href="#cb8-1107" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: inline-block;</span></span>
<span id="cb8-1108"><a href="#cb8-1108" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin: 5px;</span></span>
<span id="cb8-1109"><a href="#cb8-1109" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 8px 15px;</span></span>
<span id="cb8-1110"><a href="#cb8-1110" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #28a745;</span></span>
<span id="cb8-1111"><a href="#cb8-1111" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: white;</span></span>
<span id="cb8-1112"><a href="#cb8-1112" aria-hidden="true" tabindex="-1"></a><span class="ss">            text-decoration: none;</span></span>
<span id="cb8-1113"><a href="#cb8-1113" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 5px;</span></span>
<span id="cb8-1114"><a href="#cb8-1114" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.9em;</span></span>
<span id="cb8-1115"><a href="#cb8-1115" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb8-1116"><a href="#cb8-1116" aria-hidden="true" tabindex="-1"></a><span class="ss">        .direct-link:hover </span><span class="ch">{{</span></span>
<span id="cb8-1117"><a href="#cb8-1117" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #218838;</span></span>
<span id="cb8-1118"><a href="#cb8-1118" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb8-1119"><a href="#cb8-1119" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;/style&gt;</span></span>
<span id="cb8-1120"><a href="#cb8-1120" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;/head&gt;</span></span>
<span id="cb8-1121"><a href="#cb8-1121" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;body&gt;</span></span>
<span id="cb8-1122"><a href="#cb8-1122" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;div class=&quot;container&quot;&gt;</span></span>
<span id="cb8-1123"><a href="#cb8-1123" aria-hidden="true" tabindex="-1"></a><span class="ss">        &lt;div class=&quot;header&quot;&gt;</span></span>
<span id="cb8-1124"><a href="#cb8-1124" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;h1&gt;üìö √çndice Combinado de Conversas&lt;/h1&gt;</span></span>
<span id="cb8-1125"><a href="#cb8-1125" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;p&gt;Qwen3 ‚Ä¢ ChatGPT ‚Ä¢ DeepSeek ‚Ä¢ Grok&lt;/p&gt;</span></span>
<span id="cb8-1126"><a href="#cb8-1126" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;div class=&quot;stats&quot;&gt;</span></span>
<span id="cb8-1127"><a href="#cb8-1127" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;div class=&quot;stat-item&quot;&gt;</span></span>
<span id="cb8-1128"><a href="#cb8-1128" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;strong&gt;Total:&lt;/strong&gt; &lt;span id=&quot;total-count&quot;&gt;</span><span class="sc">{</span><span class="bu">len</span>(<span class="va">self</span>.all_conversations)<span class="sc">}</span><span class="ss">&lt;/span&gt; conversas</span></span>
<span id="cb8-1129"><a href="#cb8-1129" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;/div&gt;</span></span>
<span id="cb8-1130"><a href="#cb8-1130" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;div class=&quot;stat-item&quot;&gt;</span></span>
<span id="cb8-1131"><a href="#cb8-1131" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;strong&gt;Ordena√ß√£o:&lt;/strong&gt; Mais Recentes Primeiro</span></span>
<span id="cb8-1132"><a href="#cb8-1132" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;/div&gt;</span></span>
<span id="cb8-1133"><a href="#cb8-1133" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;div class=&quot;stat-item&quot;&gt;</span></span>
<span id="cb8-1134"><a href="#cb8-1134" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;strong&gt;Atualizado:&lt;/strong&gt; </span><span class="sc">{</span>datetime<span class="sc">.</span>now()<span class="sc">.</span>strftime(<span class="st">&#39;</span><span class="sc">%d</span><span class="st">/%m/%Y %H:%M&#39;</span>)<span class="sc">}</span></span>
<span id="cb8-1135"><a href="#cb8-1135" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;/div&gt;</span></span>
<span id="cb8-1136"><a href="#cb8-1136" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;/div&gt;</span></span>
<span id="cb8-1137"><a href="#cb8-1137" aria-hidden="true" tabindex="-1"></a><span class="ss">        &lt;/div&gt;</span></span>
<span id="cb8-1138"><a href="#cb8-1138" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb8-1139"><a href="#cb8-1139" aria-hidden="true" tabindex="-1"></a><span class="ss">        &lt;div class=&quot;search-section&quot;&gt;</span></span>
<span id="cb8-1140"><a href="#cb8-1140" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;input type=&quot;text&quot; id=&quot;searchInput&quot; class=&quot;search-box&quot; placeholder=&quot;üîç Pesquisar por t√≠tulo, conte√∫do ou categoria...&quot;&gt;</span></span>
<span id="cb8-1141"><a href="#cb8-1141" aria-hidden="true" tabindex="-1"></a><span class="ss">        &lt;/div&gt;</span></span>
<span id="cb8-1142"><a href="#cb8-1142" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb8-1143"><a href="#cb8-1143" aria-hidden="true" tabindex="-1"></a><span class="ss">        &lt;div class=&quot;filter-section&quot;&gt;</span></span>
<span id="cb8-1144"><a href="#cb8-1144" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;button class=&quot;filter-btn active&quot; data-filter=&quot;todas&quot;&gt;Todas (</span><span class="sc">{</span><span class="bu">len</span>(<span class="va">self</span>.all_conversations)<span class="sc">}</span><span class="ss">)&lt;/button&gt;</span></span>
<span id="cb8-1145"><a href="#cb8-1145" aria-hidden="true" tabindex="-1"></a><span class="ss">&quot;&quot;&quot;</span></span>
<span id="cb8-1146"><a href="#cb8-1146" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-1147"><a href="#cb8-1147" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Bot√µes de filtro por categoria</span></span>
<span id="cb8-1148"><a href="#cb8-1148" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> category, count <span class="kw">in</span> category_stats.items():</span>
<span id="cb8-1149"><a href="#cb8-1149" aria-hidden="true" tabindex="-1"></a>            html_content <span class="op">+=</span> <span class="ss">f&#39;&lt;button class=&quot;filter-btn&quot; data-filter=&quot;</span><span class="sc">{</span>category<span class="sc">.</span>lower()<span class="sc">}</span><span class="ss">&quot;&gt;</span><span class="sc">{</span>category<span class="sc">}</span><span class="ss"> (</span><span class="sc">{</span>count<span class="sc">}</span><span class="ss">)&lt;/button&gt;</span><span class="ch">\n</span><span class="ss">&#39;</span></span>
<span id="cb8-1150"><a href="#cb8-1150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-1151"><a href="#cb8-1151" aria-hidden="true" tabindex="-1"></a>        html_content <span class="op">+=</span> <span class="st">&quot;&quot;&quot;</span></span>
<span id="cb8-1152"><a href="#cb8-1152" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;/div&gt;</span></span>
<span id="cb8-1153"><a href="#cb8-1153" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb8-1154"><a href="#cb8-1154" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;!-- LINKS DIRETOS DE FALLBACK --&gt;</span></span>
<span id="cb8-1155"><a href="#cb8-1155" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;div style=&quot;text-align: center; padding: 15px; background: #e9ecef; border-bottom: 1px solid #ddd;&quot;&gt;</span></span>
<span id="cb8-1156"><a href="#cb8-1156" aria-hidden="true" tabindex="-1"></a><span class="st">            &lt;strong&gt;Acesso R√°pido:&lt;/strong&gt;</span></span>
<span id="cb8-1157"><a href="#cb8-1157" aria-hidden="true" tabindex="-1"></a><span class="st">            &lt;a href=&quot;combined_markdown/&quot; class=&quot;direct-link&quot; target=&quot;_blank&quot;&gt;üìÅ Pasta Markdown&lt;/a&gt;</span></span>
<span id="cb8-1158"><a href="#cb8-1158" aria-hidden="true" tabindex="-1"></a><span class="st">            &lt;a href=&quot;combined_pdfs/&quot; class=&quot;direct-link&quot; target=&quot;_blank&quot;&gt;üìÅ Pasta PDFs&lt;/a&gt;</span></span>
<span id="cb8-1159"><a href="#cb8-1159" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;/div&gt;</span></span>
<span id="cb8-1160"><a href="#cb8-1160" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb8-1161"><a href="#cb8-1161" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;div class=&quot;conversations-grid&quot; id=&quot;conversationsGrid&quot;&gt;</span></span>
<span id="cb8-1162"><a href="#cb8-1162" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;&quot;&quot;</span></span>
<span id="cb8-1163"><a href="#cb8-1163" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-1164"><a href="#cb8-1164" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Cards das conversas - CORRIGIDO</span></span>
<span id="cb8-1165"><a href="#cb8-1165" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, conv <span class="kw">in</span> <span class="bu">enumerate</span>(<span class="va">self</span>.all_conversations):</span>
<span id="cb8-1166"><a href="#cb8-1166" aria-hidden="true" tabindex="-1"></a>            safe_title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(conv[<span class="st">&#39;title&#39;</span>])</span>
<span id="cb8-1167"><a href="#cb8-1167" aria-hidden="true" tabindex="-1"></a>            filename <span class="op">=</span> <span class="ss">f&quot;</span><span class="sc">{</span>conv[<span class="st">&#39;number&#39;</span>]<span class="sc">:03d}</span><span class="ss">_</span><span class="sc">{</span>conv[<span class="st">&#39;source&#39;</span>]<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>safe_title<span class="sc">}</span><span class="ss">.md&quot;</span></span>
<span id="cb8-1168"><a href="#cb8-1168" aria-hidden="true" tabindex="-1"></a>            pdf_filename <span class="op">=</span> filename.replace(<span class="st">&#39;.md&#39;</span>, <span class="st">&#39;.pdf&#39;</span>)</span>
<span id="cb8-1169"><a href="#cb8-1169" aria-hidden="true" tabindex="-1"></a>            recent_badge <span class="op">=</span> <span class="st">&quot;&lt;span class=&#39;recent-badge&#39;&gt;NOVO&lt;/span&gt;&quot;</span> <span class="cf">if</span> i <span class="op">&lt;</span> <span class="dv">5</span> <span class="cf">else</span> <span class="st">&quot;&quot;</span></span>
<span id="cb8-1170"><a href="#cb8-1170" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb8-1171"><a href="#cb8-1171" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Resumo mais informativo</span></span>
<span id="cb8-1172"><a href="#cb8-1172" aria-hidden="true" tabindex="-1"></a>            summary <span class="op">=</span> conv.get(<span class="st">&#39;summary&#39;</span>, <span class="st">&#39;Sem resumo dispon√≠vel&#39;</span>)</span>
<span id="cb8-1173"><a href="#cb8-1173" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">len</span>(summary) <span class="op">&gt;</span> <span class="dv">150</span>:</span>
<span id="cb8-1174"><a href="#cb8-1174" aria-hidden="true" tabindex="-1"></a>                summary <span class="op">=</span> summary[:<span class="dv">150</span>] <span class="op">+</span> <span class="st">&quot;...&quot;</span></span>
<span id="cb8-1175"><a href="#cb8-1175" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb8-1176"><a href="#cb8-1176" aria-hidden="true" tabindex="-1"></a>            <span class="co"># CORRE√á√ÉO: Links HTML reais em vez de bot√µes JavaScript</span></span>
<span id="cb8-1177"><a href="#cb8-1177" aria-hidden="true" tabindex="-1"></a>            html_content <span class="op">+=</span> <span class="ss">f&quot;&quot;&quot;</span></span>
<span id="cb8-1178"><a href="#cb8-1178" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;div class=&quot;conversation-card&quot; data-title=&quot;</span><span class="sc">{</span>conv[<span class="st">&#39;title&#39;</span>]<span class="sc">}</span><span class="ss">&quot; data-summary=&quot;</span><span class="sc">{</span>summary<span class="sc">}</span><span class="ss">&quot; data-source=&quot;</span><span class="sc">{</span>conv[<span class="st">&#39;source&#39;</span>]<span class="sc">.</span>lower()<span class="sc">}</span><span class="ss">&quot; data-category=&quot;</span><span class="sc">{</span>conv[<span class="st">&#39;category&#39;</span>]<span class="sc">.</span>lower()<span class="sc">}</span><span class="ss">&quot;&gt;</span></span>
<span id="cb8-1179"><a href="#cb8-1179" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;div class=&quot;card-header&quot;&gt;</span></span>
<span id="cb8-1180"><a href="#cb8-1180" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;div class=&quot;card-number&quot;&gt;#</span><span class="sc">{</span>conv[<span class="st">&#39;number&#39;</span>]<span class="sc">}</span><span class="ss"> </span><span class="sc">{</span>recent_badge<span class="sc">}</span><span class="ss">&lt;/div&gt;</span></span>
<span id="cb8-1181"><a href="#cb8-1181" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;div class=&quot;card-actions&quot;&gt;</span></span>
<span id="cb8-1182"><a href="#cb8-1182" aria-hidden="true" tabindex="-1"></a><span class="ss">                        &lt;!-- CORRE√á√ÉO: Links diretos HTML --&gt;</span></span>
<span id="cb8-1183"><a href="#cb8-1183" aria-hidden="true" tabindex="-1"></a><span class="ss">                        &lt;a href=&quot;combined_markdown/</span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">&quot; class=&quot;action-btn&quot; target=&quot;_blank&quot; onclick=&quot;event.stopPropagation();&quot;&gt;üìÑ MD&lt;/a&gt;</span></span>
<span id="cb8-1184"><a href="#cb8-1184" aria-hidden="true" tabindex="-1"></a><span class="ss">                        &lt;a href=&quot;combined_pdfs/</span><span class="sc">{</span>pdf_filename<span class="sc">}</span><span class="ss">&quot; class=&quot;action-btn&quot; target=&quot;_blank&quot; onclick=&quot;event.stopPropagation();&quot;&gt;üìä PDF&lt;/a&gt;</span></span>
<span id="cb8-1185"><a href="#cb8-1185" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;/div&gt;</span></span>
<span id="cb8-1186"><a href="#cb8-1186" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;/div&gt;</span></span>
<span id="cb8-1187"><a href="#cb8-1187" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;div class=&quot;card-title&quot;&gt;</span><span class="sc">{</span>conv[<span class="st">&#39;title&#39;</span>]<span class="sc">}</span><span class="ss">&lt;/div&gt;</span></span>
<span id="cb8-1188"><a href="#cb8-1188" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;div&gt;</span></span>
<span id="cb8-1189"><a href="#cb8-1189" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;span class=&quot;card-source&quot;&gt;</span><span class="sc">{</span>conv[<span class="st">&#39;source&#39;</span>]<span class="sc">}</span><span class="ss">&lt;/span&gt;</span></span>
<span id="cb8-1190"><a href="#cb8-1190" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;span class=&quot;category-badge&quot;&gt;</span><span class="sc">{</span>conv[<span class="st">&#39;category&#39;</span>]<span class="sc">}</span><span class="ss">&lt;/span&gt;</span></span>
<span id="cb8-1191"><a href="#cb8-1191" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;/div&gt;</span></span>
<span id="cb8-1192"><a href="#cb8-1192" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;div class=&quot;card-summary&quot;&gt;</span><span class="sc">{</span>summary<span class="sc">}</span><span class="ss">&lt;/div&gt;</span></span>
<span id="cb8-1193"><a href="#cb8-1193" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;div class=&quot;card-meta&quot;&gt;</span></span>
<span id="cb8-1194"><a href="#cb8-1194" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;span&gt;üìÖ </span><span class="sc">{</span>conv<span class="sc">.</span>get(<span class="st">&#39;updated_at&#39;</span>) <span class="kw">or</span> conv<span class="sc">.</span>get(<span class="st">&#39;inserted_at&#39;</span>) <span class="kw">or</span> <span class="st">&#39;N/A&#39;</span><span class="sc">}</span><span class="ss">&lt;/span&gt;</span></span>
<span id="cb8-1195"><a href="#cb8-1195" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;span&gt;üí¨ </span><span class="sc">{</span><span class="bu">len</span>(conv[<span class="st">&#39;messages&#39;</span>])<span class="sc">}</span><span class="ss"> mensagens&lt;/span&gt;</span></span>
<span id="cb8-1196"><a href="#cb8-1196" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;/div&gt;</span></span>
<span id="cb8-1197"><a href="#cb8-1197" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;/div&gt;</span></span>
<span id="cb8-1198"><a href="#cb8-1198" aria-hidden="true" tabindex="-1"></a><span class="ss">            &quot;&quot;&quot;</span></span>
<span id="cb8-1199"><a href="#cb8-1199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-1200"><a href="#cb8-1200" aria-hidden="true" tabindex="-1"></a>        html_content <span class="op">+=</span> <span class="st">&quot;&quot;&quot;</span></span>
<span id="cb8-1201"><a href="#cb8-1201" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;/div&gt;</span></span>
<span id="cb8-1202"><a href="#cb8-1202" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;/div&gt;</span></span>
<span id="cb8-1203"><a href="#cb8-1203" aria-hidden="true" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb8-1204"><a href="#cb8-1204" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;script&gt;</span></span>
<span id="cb8-1205"><a href="#cb8-1205" aria-hidden="true" tabindex="-1"></a><span class="st">        let currentFilter = &#39;todas&#39;;</span></span>
<span id="cb8-1206"><a href="#cb8-1206" aria-hidden="true" tabindex="-1"></a><span class="st">        let allConversations = document.querySelectorAll(&#39;.conversation-card&#39;);</span></span>
<span id="cb8-1207"><a href="#cb8-1207" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb8-1208"><a href="#cb8-1208" aria-hidden="true" tabindex="-1"></a><span class="st">        // Inicializa√ß√£o</span></span>
<span id="cb8-1209"><a href="#cb8-1209" aria-hidden="true" tabindex="-1"></a><span class="st">        document.addEventListener(&#39;DOMContentLoaded&#39;, function() </span><span class="sc">{{</span></span>
<span id="cb8-1210"><a href="#cb8-1210" aria-hidden="true" tabindex="-1"></a><span class="st">            updateStats();</span></span>
<span id="cb8-1211"><a href="#cb8-1211" aria-hidden="true" tabindex="-1"></a><span class="st">        </span><span class="sc">}}</span><span class="st">);</span></span>
<span id="cb8-1212"><a href="#cb8-1212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-1213"><a href="#cb8-1213" aria-hidden="true" tabindex="-1"></a><span class="st">        document.querySelectorAll(&#39;.filter-btn&#39;).forEach(btn =&gt; </span><span class="sc">{{</span></span>
<span id="cb8-1214"><a href="#cb8-1214" aria-hidden="true" tabindex="-1"></a><span class="st">            btn.addEventListener(&#39;click&#39;, () =&gt; </span><span class="sc">{{</span></span>
<span id="cb8-1215"><a href="#cb8-1215" aria-hidden="true" tabindex="-1"></a><span class="st">                document.querySelectorAll(&#39;.filter-btn&#39;).forEach(b =&gt; b.classList.remove(&#39;active&#39;));</span></span>
<span id="cb8-1216"><a href="#cb8-1216" aria-hidden="true" tabindex="-1"></a><span class="st">                btn.classList.add(&#39;active&#39;);</span></span>
<span id="cb8-1217"><a href="#cb8-1217" aria-hidden="true" tabindex="-1"></a><span class="st">                currentFilter = btn.getAttribute(&#39;data-filter&#39;);</span></span>
<span id="cb8-1218"><a href="#cb8-1218" aria-hidden="true" tabindex="-1"></a><span class="st">                filterConversations();</span></span>
<span id="cb8-1219"><a href="#cb8-1219" aria-hidden="true" tabindex="-1"></a><span class="st">            </span><span class="sc">}}</span><span class="st">);</span></span>
<span id="cb8-1220"><a href="#cb8-1220" aria-hidden="true" tabindex="-1"></a><span class="st">        </span><span class="sc">}}</span><span class="st">);</span></span>
<span id="cb8-1221"><a href="#cb8-1221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-1222"><a href="#cb8-1222" aria-hidden="true" tabindex="-1"></a><span class="st">        document.getElementById(&#39;searchInput&#39;).addEventListener(&#39;input&#39;, filterConversations);</span></span>
<span id="cb8-1223"><a href="#cb8-1223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-1224"><a href="#cb8-1224" aria-hidden="true" tabindex="-1"></a><span class="st">        function filterConversations() </span><span class="sc">{{</span></span>
<span id="cb8-1225"><a href="#cb8-1225" aria-hidden="true" tabindex="-1"></a><span class="st">            const term = document.getElementById(&#39;searchInput&#39;).value.toLowerCase();</span></span>
<span id="cb8-1226"><a href="#cb8-1226" aria-hidden="true" tabindex="-1"></a><span class="st">            const cards = document.querySelectorAll(&#39;.conversation-card&#39;);</span></span>
<span id="cb8-1227"><a href="#cb8-1227" aria-hidden="true" tabindex="-1"></a><span class="st">            let visible = 0;</span></span>
<span id="cb8-1228"><a href="#cb8-1228" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb8-1229"><a href="#cb8-1229" aria-hidden="true" tabindex="-1"></a><span class="st">            cards.forEach(card =&gt; </span><span class="sc">{{</span></span>
<span id="cb8-1230"><a href="#cb8-1230" aria-hidden="true" tabindex="-1"></a><span class="st">                const title = card.getAttribute(&#39;data-title&#39;).toLowerCase();</span></span>
<span id="cb8-1231"><a href="#cb8-1231" aria-hidden="true" tabindex="-1"></a><span class="st">                const summary = card.getAttribute(&#39;data-summary&#39;).toLowerCase();</span></span>
<span id="cb8-1232"><a href="#cb8-1232" aria-hidden="true" tabindex="-1"></a><span class="st">                const source = card.getAttribute(&#39;data-source&#39;).toLowerCase();</span></span>
<span id="cb8-1233"><a href="#cb8-1233" aria-hidden="true" tabindex="-1"></a><span class="st">                const category = card.getAttribute(&#39;data-category&#39;).toLowerCase();</span></span>
<span id="cb8-1234"><a href="#cb8-1234" aria-hidden="true" tabindex="-1"></a><span class="st">                </span></span>
<span id="cb8-1235"><a href="#cb8-1235" aria-hidden="true" tabindex="-1"></a><span class="st">                const matchesSearch = (title.includes(term) || summary.includes(term) || category.includes(term) || source.includes(term));</span></span>
<span id="cb8-1236"><a href="#cb8-1236" aria-hidden="true" tabindex="-1"></a><span class="st">                const matchesCategory = (currentFilter === &#39;todas&#39; || category === currentFilter);</span></span>
<span id="cb8-1237"><a href="#cb8-1237" aria-hidden="true" tabindex="-1"></a><span class="st">                </span></span>
<span id="cb8-1238"><a href="#cb8-1238" aria-hidden="true" tabindex="-1"></a><span class="st">                if (matchesSearch &amp;&amp; matchesCategory) </span><span class="sc">{{</span></span>
<span id="cb8-1239"><a href="#cb8-1239" aria-hidden="true" tabindex="-1"></a><span class="st">                    card.style.display = &#39;block&#39;;</span></span>
<span id="cb8-1240"><a href="#cb8-1240" aria-hidden="true" tabindex="-1"></a><span class="st">                    visible++;</span></span>
<span id="cb8-1241"><a href="#cb8-1241" aria-hidden="true" tabindex="-1"></a><span class="st">                </span><span class="sc">}}</span><span class="st"> else </span><span class="sc">{{</span></span>
<span id="cb8-1242"><a href="#cb8-1242" aria-hidden="true" tabindex="-1"></a><span class="st">                    card.style.display = &#39;none&#39;;</span></span>
<span id="cb8-1243"><a href="#cb8-1243" aria-hidden="true" tabindex="-1"></a><span class="st">                </span><span class="sc">}}</span></span>
<span id="cb8-1244"><a href="#cb8-1244" aria-hidden="true" tabindex="-1"></a><span class="st">            </span><span class="sc">}}</span><span class="st">);</span></span>
<span id="cb8-1245"><a href="#cb8-1245" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb8-1246"><a href="#cb8-1246" aria-hidden="true" tabindex="-1"></a><span class="st">            updateStats(visible);</span></span>
<span id="cb8-1247"><a href="#cb8-1247" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb8-1248"><a href="#cb8-1248" aria-hidden="true" tabindex="-1"></a><span class="st">            // Mostra mensagem se n√£o houver resultados</span></span>
<span id="cb8-1249"><a href="#cb8-1249" aria-hidden="true" tabindex="-1"></a><span class="st">            const grid = document.getElementById(&#39;conversationsGrid&#39;);</span></span>
<span id="cb8-1250"><a href="#cb8-1250" aria-hidden="true" tabindex="-1"></a><span class="st">            const noResults = document.getElementById(&#39;no-results-message&#39;);</span></span>
<span id="cb8-1251"><a href="#cb8-1251" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb8-1252"><a href="#cb8-1252" aria-hidden="true" tabindex="-1"></a><span class="st">            if (visible === 0) </span><span class="sc">{{</span></span>
<span id="cb8-1253"><a href="#cb8-1253" aria-hidden="true" tabindex="-1"></a><span class="st">                if (!noResults) </span><span class="sc">{{</span></span>
<span id="cb8-1254"><a href="#cb8-1254" aria-hidden="true" tabindex="-1"></a><span class="st">                    const noResultsMsg = document.createElement(&#39;div&#39;);</span></span>
<span id="cb8-1255"><a href="#cb8-1255" aria-hidden="true" tabindex="-1"></a><span class="st">                    noResultsMsg.id = &#39;no-results-message&#39;;</span></span>
<span id="cb8-1256"><a href="#cb8-1256" aria-hidden="true" tabindex="-1"></a><span class="st">                    noResultsMsg.className = &#39;no-results&#39;;</span></span>
<span id="cb8-1257"><a href="#cb8-1257" aria-hidden="true" tabindex="-1"></a><span class="st">                    noResultsMsg.innerHTML = &#39;üîç Nenhuma conversa encontrada. Tente ajustar os filtros ou a pesquisa.&#39;;</span></span>
<span id="cb8-1258"><a href="#cb8-1258" aria-hidden="true" tabindex="-1"></a><span class="st">                    grid.appendChild(noResultsMsg);</span></span>
<span id="cb8-1259"><a href="#cb8-1259" aria-hidden="true" tabindex="-1"></a><span class="st">                </span><span class="sc">}}</span></span>
<span id="cb8-1260"><a href="#cb8-1260" aria-hidden="true" tabindex="-1"></a><span class="st">            </span><span class="sc">}}</span><span class="st"> else if (noResults) </span><span class="sc">{{</span></span>
<span id="cb8-1261"><a href="#cb8-1261" aria-hidden="true" tabindex="-1"></a><span class="st">                noResults.remove();</span></span>
<span id="cb8-1262"><a href="#cb8-1262" aria-hidden="true" tabindex="-1"></a><span class="st">            </span><span class="sc">}}</span></span>
<span id="cb8-1263"><a href="#cb8-1263" aria-hidden="true" tabindex="-1"></a><span class="st">        </span><span class="sc">}}</span></span>
<span id="cb8-1264"><a href="#cb8-1264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-1265"><a href="#cb8-1265" aria-hidden="true" tabindex="-1"></a><span class="st">        function updateStats(visibleCount = null) </span><span class="sc">{{</span></span>
<span id="cb8-1266"><a href="#cb8-1266" aria-hidden="true" tabindex="-1"></a><span class="st">            const totalElement = document.getElementById(&#39;total-count&#39;);</span></span>
<span id="cb8-1267"><a href="#cb8-1267" aria-hidden="true" tabindex="-1"></a><span class="st">            if (visibleCount !== null) </span><span class="sc">{{</span></span>
<span id="cb8-1268"><a href="#cb8-1268" aria-hidden="true" tabindex="-1"></a><span class="st">                totalElement.textContent = visibleCount;</span></span>
<span id="cb8-1269"><a href="#cb8-1269" aria-hidden="true" tabindex="-1"></a><span class="st">            </span><span class="sc">}}</span><span class="st"> else </span><span class="sc">{{</span></span>
<span id="cb8-1270"><a href="#cb8-1270" aria-hidden="true" tabindex="-1"></a><span class="st">                totalElement.textContent = {len(self.all_conversations)};</span></span>
<span id="cb8-1271"><a href="#cb8-1271" aria-hidden="true" tabindex="-1"></a><span class="st">            </span><span class="sc">}}</span></span>
<span id="cb8-1272"><a href="#cb8-1272" aria-hidden="true" tabindex="-1"></a><span class="st">        </span><span class="sc">}}</span></span>
<span id="cb8-1273"><a href="#cb8-1273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-1274"><a href="#cb8-1274" aria-hidden="true" tabindex="-1"></a><span class="st">        // CORRE√á√ÉO: Fun√ß√µes JavaScript simplificadas e robustas</span></span>
<span id="cb8-1275"><a href="#cb8-1275" aria-hidden="true" tabindex="-1"></a><span class="st">        function openMD(filename) </span><span class="sc">{{</span></span>
<span id="cb8-1276"><a href="#cb8-1276" aria-hidden="true" tabindex="-1"></a><span class="st">            const mdUrl = &#39;combined_markdown/&#39; + filename;</span></span>
<span id="cb8-1277"><a href="#cb8-1277" aria-hidden="true" tabindex="-1"></a><span class="st">            console.log(&#39;Abrindo MD:&#39;, mdUrl);</span></span>
<span id="cb8-1278"><a href="#cb8-1278" aria-hidden="true" tabindex="-1"></a><span class="st">            window.open(mdUrl, &#39;_blank&#39;);</span></span>
<span id="cb8-1279"><a href="#cb8-1279" aria-hidden="true" tabindex="-1"></a><span class="st">        </span><span class="sc">}}</span></span>
<span id="cb8-1280"><a href="#cb8-1280" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb8-1281"><a href="#cb8-1281" aria-hidden="true" tabindex="-1"></a><span class="st">        function openPDF(filename) </span><span class="sc">{{</span></span>
<span id="cb8-1282"><a href="#cb8-1282" aria-hidden="true" tabindex="-1"></a><span class="st">            const pdfFile = filename.replace(&#39;.md&#39;, &#39;.pdf&#39;);</span></span>
<span id="cb8-1283"><a href="#cb8-1283" aria-hidden="true" tabindex="-1"></a><span class="st">            const pdfUrl = &#39;combined_pdfs/&#39; + pdfFile;</span></span>
<span id="cb8-1284"><a href="#cb8-1284" aria-hidden="true" tabindex="-1"></a><span class="st">            console.log(&#39;Abrindo PDF:&#39;, pdfUrl);</span></span>
<span id="cb8-1285"><a href="#cb8-1285" aria-hidden="true" tabindex="-1"></a><span class="st">            window.open(pdfUrl, &#39;_blank&#39;);</span></span>
<span id="cb8-1286"><a href="#cb8-1286" aria-hidden="true" tabindex="-1"></a><span class="st">        </span><span class="sc">}}</span></span>
<span id="cb8-1287"><a href="#cb8-1287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-1288"><a href="#cb8-1288" aria-hidden="true" tabindex="-1"></a><span class="st">        // Navega√ß√£o por teclado</span></span>
<span id="cb8-1289"><a href="#cb8-1289" aria-hidden="true" tabindex="-1"></a><span class="st">        document.addEventListener(&#39;keydown&#39;, function(e) </span><span class="sc">{{</span></span>
<span id="cb8-1290"><a href="#cb8-1290" aria-hidden="true" tabindex="-1"></a><span class="st">            if (e.key === &#39;Escape&#39;) </span><span class="sc">{{</span></span>
<span id="cb8-1291"><a href="#cb8-1291" aria-hidden="true" tabindex="-1"></a><span class="st">                document.getElementById(&#39;searchInput&#39;).value = &#39;&#39;;</span></span>
<span id="cb8-1292"><a href="#cb8-1292" aria-hidden="true" tabindex="-1"></a><span class="st">                filterConversations();</span></span>
<span id="cb8-1293"><a href="#cb8-1293" aria-hidden="true" tabindex="-1"></a><span class="st">            </span><span class="sc">}}</span></span>
<span id="cb8-1294"><a href="#cb8-1294" aria-hidden="true" tabindex="-1"></a><span class="st">        </span><span class="sc">}}</span><span class="st">);</span></span>
<span id="cb8-1295"><a href="#cb8-1295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-1296"><a href="#cb8-1296" aria-hidden="true" tabindex="-1"></a><span class="st">        // Clique nos cards - CORRE√á√ÉO: Preven√ß√£o de conflito</span></span>
<span id="cb8-1297"><a href="#cb8-1297" aria-hidden="true" tabindex="-1"></a><span class="st">        document.querySelectorAll(&#39;.conversation-card&#39;).forEach(card =&gt; </span><span class="sc">{{</span></span>
<span id="cb8-1298"><a href="#cb8-1298" aria-hidden="true" tabindex="-1"></a><span class="st">            card.addEventListener(&#39;click&#39;, function(e) </span><span class="sc">{{</span></span>
<span id="cb8-1299"><a href="#cb8-1299" aria-hidden="true" tabindex="-1"></a><span class="st">                // N√£o faz nada se clicou em um bot√£o de a√ß√£o</span></span>
<span id="cb8-1300"><a href="#cb8-1300" aria-hidden="true" tabindex="-1"></a><span class="st">                if (e.target.closest(&#39;.action-btn&#39;)) </span><span class="sc">{{</span></span>
<span id="cb8-1301"><a href="#cb8-1301" aria-hidden="true" tabindex="-1"></a><span class="st">                    return;</span></span>
<span id="cb8-1302"><a href="#cb8-1302" aria-hidden="true" tabindex="-1"></a><span class="st">                </span><span class="sc">}}</span></span>
<span id="cb8-1303"><a href="#cb8-1303" aria-hidden="true" tabindex="-1"></a><span class="st">                </span></span>
<span id="cb8-1304"><a href="#cb8-1304" aria-hidden="true" tabindex="-1"></a><span class="st">                // Abre o MD ao clicar no card</span></span>
<span id="cb8-1305"><a href="#cb8-1305" aria-hidden="true" tabindex="-1"></a><span class="st">                const mdBtn = this.querySelector(&#39;a[href*=&quot;.md&quot;]&#39;);</span></span>
<span id="cb8-1306"><a href="#cb8-1306" aria-hidden="true" tabindex="-1"></a><span class="st">                if (mdBtn) </span><span class="sc">{{</span></span>
<span id="cb8-1307"><a href="#cb8-1307" aria-hidden="true" tabindex="-1"></a><span class="st">                    const mdUrl = mdBtn.getAttribute(&#39;href&#39;);</span></span>
<span id="cb8-1308"><a href="#cb8-1308" aria-hidden="true" tabindex="-1"></a><span class="st">                    window.open(mdUrl, &#39;_blank&#39;);</span></span>
<span id="cb8-1309"><a href="#cb8-1309" aria-hidden="true" tabindex="-1"></a><span class="st">                </span><span class="sc">}}</span></span>
<span id="cb8-1310"><a href="#cb8-1310" aria-hidden="true" tabindex="-1"></a><span class="st">            </span><span class="sc">}}</span><span class="st">);</span></span>
<span id="cb8-1311"><a href="#cb8-1311" aria-hidden="true" tabindex="-1"></a><span class="st">        </span><span class="sc">}}</span><span class="st">);</span></span>
<span id="cb8-1312"><a href="#cb8-1312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-1313"><a href="#cb8-1313" aria-hidden="true" tabindex="-1"></a><span class="st">        // Foco na pesquisa ao carregar</span></span>
<span id="cb8-1314"><a href="#cb8-1314" aria-hidden="true" tabindex="-1"></a><span class="st">        document.getElementById(&#39;searchInput&#39;).focus();</span></span>
<span id="cb8-1315"><a href="#cb8-1315" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb8-1316"><a href="#cb8-1316" aria-hidden="true" tabindex="-1"></a><span class="st">        // CORRE√á√ÉO: Debug para verificar se os arquivos existem</span></span>
<span id="cb8-1317"><a href="#cb8-1317" aria-hidden="true" tabindex="-1"></a><span class="st">        console.log(&#39;√çndice carregado com&#39;, {len(self.all_conversations)}, &#39;conversas&#39;);</span></span>
<span id="cb8-1318"><a href="#cb8-1318" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;/script&gt;</span></span>
<span id="cb8-1319"><a href="#cb8-1319" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;/body&gt;</span></span>
<span id="cb8-1320"><a href="#cb8-1320" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;/html&gt;</span></span>
<span id="cb8-1321"><a href="#cb8-1321" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;&quot;&quot;</span></span>
<span id="cb8-1322"><a href="#cb8-1322" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-1323"><a href="#cb8-1323" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> <span class="bu">open</span>(<span class="va">self</span>.index_file, <span class="st">&#39;w&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb8-1324"><a href="#cb8-1324" aria-hidden="true" tabindex="-1"></a>            f.write(html_content)</span>
<span id="cb8-1325"><a href="#cb8-1325" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ √çndice combinado criado: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>index_file<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb8-1326"><a href="#cb8-1326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-1327"><a href="#cb8-1327" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> test_preservation():</span>
<span id="cb8-1328"><a href="#cb8-1328" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Testa a preserva√ß√£o de conte√∫do especial&quot;&quot;&quot;</span></span>
<span id="cb8-1329"><a href="#cb8-1329" aria-hidden="true" tabindex="-1"></a>    system <span class="op">=</span> CombinedFragmentsSystem()</span>
<span id="cb8-1330"><a href="#cb8-1330" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-1331"><a href="#cb8-1331" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;üß™ TESTE DE PRESERVA√á√ÉO DE CONTE√öDO&quot;</span>)</span>
<span id="cb8-1332"><a href="#cb8-1332" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;=&quot;</span> <span class="op">*</span> <span class="dv">50</span>)</span>
<span id="cb8-1333"><a href="#cb8-1333" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-1334"><a href="#cb8-1334" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Teste com f√≥rmulas LaTeX corretas</span></span>
<span id="cb8-1335"><a href="#cb8-1335" aria-hidden="true" tabindex="-1"></a>    math_content <span class="op">=</span> <span class="vs">r&quot;&quot;&quot;</span></span>
<span id="cb8-1336"><a href="#cb8-1336" aria-hidden="true" tabindex="-1"></a><span class="vs">    Aqui est√£o algumas f√≥rmulas:</span></span>
<span id="cb8-1337"><a href="#cb8-1337" aria-hidden="true" tabindex="-1"></a><span class="vs">    </span></span>
<span id="cb8-1338"><a href="#cb8-1338" aria-hidden="true" tabindex="-1"></a><span class="vs">    - F√≥rmula famosa: </span><span class="dv">$</span><span class="vs">E = mc</span><span class="dv">^</span><span class="vs">2</span><span class="dv">$</span></span>
<span id="cb8-1339"><a href="#cb8-1339" aria-hidden="true" tabindex="-1"></a><span class="vs">    - Soma: </span><span class="dv">$\s</span><span class="vs">um_{i=1}</span><span class="dv">^</span><span class="vs">n i = </span><span class="ch">\f</span><span class="vs">rac{n</span><span class="kw">(</span><span class="vs">n</span><span class="op">+</span><span class="vs">1</span><span class="kw">)</span><span class="vs">}</span><span class="op">{2}</span><span class="dv">$</span></span>
<span id="cb8-1340"><a href="#cb8-1340" aria-hidden="true" tabindex="-1"></a><span class="vs">    - Integral: </span><span class="dv">$</span><span class="er">\</span><span class="vs">int_a</span><span class="dv">^</span><span class="vs">b f</span><span class="kw">(</span><span class="vs">x</span><span class="kw">)</span><span class="vs">dx = F</span><span class="kw">(</span><span class="vs">b</span><span class="kw">)</span><span class="vs"> - F</span><span class="kw">(</span><span class="vs">a</span><span class="kw">)</span><span class="dv">$</span></span>
<span id="cb8-1341"><a href="#cb8-1341" aria-hidden="true" tabindex="-1"></a><span class="vs">    - Display math: </span></span>
<span id="cb8-1342"><a href="#cb8-1342" aria-hidden="true" tabindex="-1"></a><span class="vs">      </span><span class="dv">$$</span></span>
<span id="cb8-1343"><a href="#cb8-1343" aria-hidden="true" tabindex="-1"></a><span class="vs">      </span><span class="ch">\n</span><span class="vs">abla </span><span class="er">\</span><span class="vs">cdot </span><span class="dv">\m</span><span class="vs">athbf{E} = </span><span class="ch">\f</span><span class="vs">rac{</span><span class="ch">\r</span><span class="vs">ho}{</span><span class="ch">\v</span><span class="vs">arepsilon_0}</span></span>
<span id="cb8-1344"><a href="#cb8-1344" aria-hidden="true" tabindex="-1"></a><span class="vs">      </span><span class="dv">$$</span></span>
<span id="cb8-1345"><a href="#cb8-1345" aria-hidden="true" tabindex="-1"></a><span class="vs">    &quot;&quot;&quot;</span></span>
<span id="cb8-1346"><a href="#cb8-1346" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-1347"><a href="#cb8-1347" aria-hidden="true" tabindex="-1"></a>    test_cases <span class="op">=</span> [</span>
<span id="cb8-1348"><a href="#cb8-1348" aria-hidden="true" tabindex="-1"></a>        (<span class="st">&quot;F√≥rmulas Matem√°ticas&quot;</span>, math_content),</span>
<span id="cb8-1349"><a href="#cb8-1349" aria-hidden="true" tabindex="-1"></a>        (<span class="st">&quot;C√≥digo&quot;</span>, <span class="st">&quot;```python</span><span class="ch">\n</span><span class="st">print(&#39;Hello&#39;)</span><span class="ch">\n</span><span class="st">```&quot;</span>),</span>
<span id="cb8-1350"><a href="#cb8-1350" aria-hidden="true" tabindex="-1"></a>        (<span class="st">&quot;Emojis&quot;</span>, <span class="st">&quot;üöÄ ‚úÖ ‚ù§Ô∏è üìä&quot;</span>),</span>
<span id="cb8-1351"><a href="#cb8-1351" aria-hidden="true" tabindex="-1"></a>        (<span class="st">&quot;Tabela&quot;</span>, <span class="st">&quot;| A | B |</span><span class="ch">\n</span><span class="st">|---|---|</span><span class="ch">\n</span><span class="st">| 1 | 2 |&quot;</span>)</span>
<span id="cb8-1352"><a href="#cb8-1352" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb8-1353"><a href="#cb8-1353" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-1354"><a href="#cb8-1354" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> name, content <span class="kw">in</span> test_cases:</span>
<span id="cb8-1355"><a href="#cb8-1355" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="ch">\n</span><span class="ss">üî¨ </span><span class="sc">{</span>name<span class="sc">}</span><span class="ss">:&quot;</span>)</span>
<span id="cb8-1356"><a href="#cb8-1356" aria-hidden="true" tabindex="-1"></a>        preserved <span class="op">=</span> system.preserve_special_content(content)</span>
<span id="cb8-1357"><a href="#cb8-1357" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-1358"><a href="#cb8-1358" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> content <span class="op">==</span> preserved:</span>
<span id="cb8-1359"><a href="#cb8-1359" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;‚úÖ PERFEITAMENTE PRESERVADO!&quot;</span>)</span>
<span id="cb8-1360"><a href="#cb8-1360" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb8-1361"><a href="#cb8-1361" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;‚ùå ALTERA√á√ïES DETECTADAS!&quot;</span>)</span>
<span id="cb8-1362"><a href="#cb8-1362" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;Diferen√ßas:&quot;</span>)</span>
<span id="cb8-1363"><a href="#cb8-1363" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> i, (orig, pres) <span class="kw">in</span> <span class="bu">enumerate</span>(<span class="bu">zip</span>(content.split(<span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>), preserved.split(<span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>))):</span>
<span id="cb8-1364"><a href="#cb8-1364" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> orig <span class="op">!=</span> pres:</span>
<span id="cb8-1365"><a href="#cb8-1365" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="ss">f&quot;  Linha </span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">: &#39;</span><span class="sc">{</span>orig<span class="sc">}</span><span class="ss">&#39; -&gt; &#39;</span><span class="sc">{</span>pres<span class="sc">}</span><span class="ss">&#39;&quot;</span>)</span>
<span id="cb8-1366"><a href="#cb8-1366" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-1367"><a href="#cb8-1367" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;Visualiza√ß√£o:&quot;</span>)</span>
<span id="cb8-1368"><a href="#cb8-1368" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(preserved)</span>
<span id="cb8-1369"><a href="#cb8-1369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-1370"><a href="#cb8-1370" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&quot;__main__&quot;</span>:</span>
<span id="cb8-1371"><a href="#cb8-1371" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(sys.argv) <span class="op">&gt;</span> <span class="dv">1</span> <span class="kw">and</span> sys.argv[<span class="dv">1</span>] <span class="op">==</span> <span class="st">&quot;--test-preservation&quot;</span>:</span>
<span id="cb8-1372"><a href="#cb8-1372" aria-hidden="true" tabindex="-1"></a>        test_preservation()</span>
<span id="cb8-1373"><a href="#cb8-1373" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb8-1374"><a href="#cb8-1374" aria-hidden="true" tabindex="-1"></a>        parser <span class="op">=</span> argparse.ArgumentParser(</span>
<span id="cb8-1375"><a href="#cb8-1375" aria-hidden="true" tabindex="-1"></a>            description<span class="op">=</span><span class="st">&quot;Processa exporta√ß√µes combinadas com preserva√ß√£o total de conte√∫do.&quot;</span></span>
<span id="cb8-1376"><a href="#cb8-1376" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb8-1377"><a href="#cb8-1377" aria-hidden="true" tabindex="-1"></a>        parser.add_argument(<span class="st">&quot;--dry-run&quot;</span>, action<span class="op">=</span><span class="st">&quot;store_true&quot;</span>, <span class="bu">help</span><span class="op">=</span><span class="st">&quot;Executa sem salvar arquivos&quot;</span>)</span>
<span id="cb8-1378"><a href="#cb8-1378" aria-hidden="true" tabindex="-1"></a>        parser.add_argument(<span class="st">&quot;--force-overwrite&quot;</span>, action<span class="op">=</span><span class="st">&quot;store_true&quot;</span>, <span class="bu">help</span><span class="op">=</span><span class="st">&quot;Substitui arquivos existentes&quot;</span>)</span>
<span id="cb8-1379"><a href="#cb8-1379" aria-hidden="true" tabindex="-1"></a>        parser.add_argument(<span class="st">&quot;--test-preservation&quot;</span>, action<span class="op">=</span><span class="st">&quot;store_true&quot;</span>, <span class="bu">help</span><span class="op">=</span><span class="st">&quot;Testa preserva√ß√£o de conte√∫do&quot;</span>)</span>
<span id="cb8-1380"><a href="#cb8-1380" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-1381"><a href="#cb8-1381" aria-hidden="true" tabindex="-1"></a>        args <span class="op">=</span> parser.parse_args()</span>
<span id="cb8-1382"><a href="#cb8-1382" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-1383"><a href="#cb8-1383" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> args.test_preservation:</span>
<span id="cb8-1384"><a href="#cb8-1384" aria-hidden="true" tabindex="-1"></a>            test_preservation()</span>
<span id="cb8-1385"><a href="#cb8-1385" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb8-1386"><a href="#cb8-1386" aria-hidden="true" tabindex="-1"></a>            system <span class="op">=</span> CombinedFragmentsSystem(</span>
<span id="cb8-1387"><a href="#cb8-1387" aria-hidden="true" tabindex="-1"></a>                dry_run<span class="op">=</span>args.dry_run,</span>
<span id="cb8-1388"><a href="#cb8-1388" aria-hidden="true" tabindex="-1"></a>                force_overwrite<span class="op">=</span>args.force_overwrite</span>
<span id="cb8-1389"><a href="#cb8-1389" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb8-1390"><a href="#cb8-1390" aria-hidden="true" tabindex="-1"></a>            system.run()</span></code></pre></div>
<h2 data-number="1.11" id="principais-corre√ß√µes-implementadas"><span class="header-section-number">1.11</span> üöÄ <strong>Principais
Corre√ß√µes Implementadas:</strong></h2>
<h3 data-number="1.11.1" id="links-html-reais-cr√≠tico"><span class="header-section-number">1.11.1</span> <strong>1. Links HTML Reais
(CR√çTICO)</strong></h3>
<ul>
<li>Substitu√≠dos bot√µes JavaScript por links HTML
<code>&lt;a href=&quot;...&quot;&gt;</code></li>
<li>Adicionado <code>target=&quot;_blank&quot;</code> para abrir em nova aba</li>
<li><code>event.stopPropagation()</code> para prevenir conflitos</li>
</ul>
<h3 data-number="1.11.2" id="css-corrigido"><span class="header-section-number">1.11.2</span> <strong>2. CSS
Corrigido</strong></h3>
<ul>
<li>Links agora s√£o elementos <code>&lt;a&gt;</code> com estilo
adequado</li>
<li><code>text-decoration: none</code> para manter apar√™ncia de
bot√£o</li>
<li>Transi√ß√µes suaves mantidas</li>
</ul>
<h3 data-number="1.11.3" id="javascript-robustecido"><span class="header-section-number">1.11.3</span> <strong>3. JavaScript
Robustecido</strong></h3>
<ul>
<li>Fun√ß√µes de fallback mantidas</li>
<li>Preven√ß√£o de conflitos entre clique no card e nos bot√µes</li>
<li>Console logging para debug</li>
</ul>
<h3 data-number="1.11.4" id="links-de-acesso-r√°pido"><span class="header-section-number">1.11.4</span> <strong>4. Links de Acesso
R√°pido</strong></h3>
<ul>
<li>Links diretos para pastas markdown e PDFs</li>
<li>Fallback visual caso os links individuais n√£o funcionem</li>
</ul>
<h2 data-number="1.12" id="como-usar"><span class="header-section-number">1.12</span> üéØ <strong>Como
Usar:</strong></h2>
<div class="sourceCode" id="cb9"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Executar normalmente</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> comb_fragments_system2_preserve_all.py <span class="at">--force-overwrite</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Modo teste</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> comb_fragments_system2_preserve_all.py <span class="at">--dry-run</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Testar preserva√ß√£o de conte√∫do</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> comb_fragments_system2_preserve_all.py <span class="at">--test-preservation</span></span></code></pre></div>
<p><strong>Agora os links MD e PDF funcionar√£o perfeitamente!</strong>
‚úÖ</p>
<hr />
<h3 data-number="1.12.1" id="utilizador-2025-11-05-054909-deepseek-chat"><span class="header-section-number">1.12.1</span> üë§ Utilizador
<em>(2025-11-05 05:49:09)</em> <em>[deepseek-chat]</em></h3>
<p>Os links md e pdf est√£o a funcionar correctamente. Pretendia agora
que ao clicar no resumo do card ou no respectivo titulo abri-se o mesmo
o conteudo do mesmo card mas no formato html. Pretendo assim uma nova
vers√£o que ter√° mais uma subpasta com o nome combined_html contendo os
files html. Esse html pode ser o resultado da convers√£o de md para html,
simplificando depois o comb_pdf_direct4_optimized.py que s√≥ precisaria
de converter esse html para pdf. Pretende-se um novo
comb_fragments_system2_preserve_all.py, mas com um nome ligeiramente
diferente. E um novo comb_pdf_direct4_optimized.py tambem com um nome
ligeiramente diferente.</p>
<hr />
<h3 data-number="1.12.2" id="deepseek-2025-11-05-054909-deepseek-chat"><span class="header-section-number">1.12.2</span> ü§ñ DeepSeek <em>(2025-11-05
05:49:09)</em> <em>[deepseek-chat]</em></h3>
<p>Perfeito! Vou criar as duas vers√µes atualizadas:</p>
<h2 data-number="1.13" id="comb_fragments_system3_html_export.py"><span class="header-section-number">1.13</span> üìÅ <strong>1.
comb_fragments_system3_html_export.py</strong></h2>
<div class="sourceCode" id="cb10"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># comb_fragments_system3_html_export.py</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> zipfile</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> csv</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> argparse</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sys</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> webbrowser</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> shutil</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tempfile</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> traceback</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> markdown</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Any, Optional</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> CombinedFragmentsSystem:</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, dry_run<span class="op">=</span><span class="va">False</span>, force_overwrite<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.data_dir <span class="op">=</span> Path(<span class="st">&quot;data&quot;</span>)</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.dry_run <span class="op">=</span> dry_run</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.force_overwrite <span class="op">=</span> force_overwrite</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Estrutura de pastas organizada - ADICIONADA PASTA HTML</span></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.output_dirs <span class="op">=</span> {</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;markdown&#39;</span>: <span class="st">&quot;combined_markdown&quot;</span>,</span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;csv&#39;</span>: <span class="st">&quot;combined_csv&quot;</span>, </span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;json&#39;</span>: <span class="st">&quot;combined_json&quot;</span>,</span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;pdfs&#39;</span>: <span class="st">&quot;combined_pdfs&quot;</span>,</span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;html&#39;</span>: <span class="st">&quot;combined_html&quot;</span>  <span class="co"># NOVA PASTA</span></span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.single_files <span class="op">=</span> {</span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;csv&#39;</span>: <span class="st">&quot;combined_all_conversations.csv&quot;</span>,</span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;json&#39;</span>: <span class="st">&quot;combined_all_conversations.json&quot;</span></span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.index_file <span class="op">=</span> <span class="st">&quot;index.html&quot;</span></span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.all_conversations <span class="op">=</span> []</span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Configura√ß√£o de processamento por fonte</span></span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.processors <span class="op">=</span> {</span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;qwen&#39;</span>: {</span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;file&#39;</span>: <span class="st">&quot;chat-export.json&quot;</span>,</span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;method&#39;</span>: <span class="va">self</span>.process_qwen_enhanced,</span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;enabled&#39;</span>: <span class="va">True</span></span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;chatgpt&#39;</span>: {</span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;file&#39;</span>: <span class="st">&quot;chatgpt.zip&quot;</span>, </span>
<span id="cb10-50"><a href="#cb10-50" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;method&#39;</span>: <span class="va">self</span>.process_chatgpt,</span>
<span id="cb10-51"><a href="#cb10-51" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;enabled&#39;</span>: <span class="va">True</span></span>
<span id="cb10-52"><a href="#cb10-52" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb10-53"><a href="#cb10-53" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;deepseek&#39;</span>: {</span>
<span id="cb10-54"><a href="#cb10-54" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;file&#39;</span>: <span class="st">&quot;deepseek_data.zip&quot;</span>,</span>
<span id="cb10-55"><a href="#cb10-55" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;method&#39;</span>: <span class="va">self</span>.process_deepseek,</span>
<span id="cb10-56"><a href="#cb10-56" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;enabled&#39;</span>: <span class="va">True</span></span>
<span id="cb10-57"><a href="#cb10-57" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb10-58"><a href="#cb10-58" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;grok&#39;</span>: {</span>
<span id="cb10-59"><a href="#cb10-59" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;file&#39;</span>: <span class="st">&quot;grok.zip&quot;</span>,</span>
<span id="cb10-60"><a href="#cb10-60" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;method&#39;</span>: <span class="va">self</span>.process_grok,</span>
<span id="cb10-61"><a href="#cb10-61" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;enabled&#39;</span>: <span class="va">True</span></span>
<span id="cb10-62"><a href="#cb10-62" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb10-63"><a href="#cb10-63" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb10-64"><a href="#cb10-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-65"><a href="#cb10-65" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> sanitize_filename(<span class="va">self</span>, text: <span class="bu">str</span>, max_len: <span class="bu">int</span> <span class="op">=</span> <span class="dv">50</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb10-66"><a href="#cb10-66" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Sanitiza nomes de arquivo PRESERVANDO EMOJIS&quot;&quot;&quot;</span></span>
<span id="cb10-67"><a href="#cb10-67" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> text <span class="kw">or</span> <span class="kw">not</span> <span class="bu">isinstance</span>(text, <span class="bu">str</span>):</span>
<span id="cb10-68"><a href="#cb10-68" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">&quot;conversa_sem_titulo&quot;</span></span>
<span id="cb10-69"><a href="#cb10-69" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb10-70"><a href="#cb10-70" aria-hidden="true" tabindex="-1"></a>        invalid_chars <span class="op">=</span> <span class="vs">r&#39;</span><span class="pp">[&lt;&gt;:&quot;/</span><span class="ch">\\</span><span class="pp">|?*</span><span class="ch">\x00</span><span class="pp">-</span><span class="ch">\x1F\x7F</span><span class="pp">]</span><span class="vs">&#39;</span></span>
<span id="cb10-71"><a href="#cb10-71" aria-hidden="true" tabindex="-1"></a>        sanitized <span class="op">=</span> re.sub(invalid_chars, <span class="st">&#39;&#39;</span>, text)</span>
<span id="cb10-72"><a href="#cb10-72" aria-hidden="true" tabindex="-1"></a>        sanitized <span class="op">=</span> re.sub(<span class="vs">r&#39;</span><span class="dv">\s</span><span class="op">+</span><span class="vs">&#39;</span>, <span class="st">&#39; &#39;</span>, sanitized.strip())</span>
<span id="cb10-73"><a href="#cb10-73" aria-hidden="true" tabindex="-1"></a>        sanitized <span class="op">=</span> sanitized.strip()</span>
<span id="cb10-74"><a href="#cb10-74" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-75"><a href="#cb10-75" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> sanitized:</span>
<span id="cb10-76"><a href="#cb10-76" aria-hidden="true" tabindex="-1"></a>            sanitized <span class="op">=</span> <span class="st">&quot;conversa_sem_titulo&quot;</span></span>
<span id="cb10-77"><a href="#cb10-77" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb10-78"><a href="#cb10-78" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(sanitized) <span class="op">&gt;</span> max_len:</span>
<span id="cb10-79"><a href="#cb10-79" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="st">&#39; &#39;</span> <span class="kw">in</span> sanitized[:max_len]:</span>
<span id="cb10-80"><a href="#cb10-80" aria-hidden="true" tabindex="-1"></a>                last_space <span class="op">=</span> sanitized[:max_len].rfind(<span class="st">&#39; &#39;</span>)</span>
<span id="cb10-81"><a href="#cb10-81" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> last_space <span class="op">&gt;</span> <span class="dv">10</span>:</span>
<span id="cb10-82"><a href="#cb10-82" aria-hidden="true" tabindex="-1"></a>                    sanitized <span class="op">=</span> sanitized[:last_space]</span>
<span id="cb10-83"><a href="#cb10-83" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb10-84"><a href="#cb10-84" aria-hidden="true" tabindex="-1"></a>                sanitized <span class="op">=</span> sanitized[:max_len]</span>
<span id="cb10-85"><a href="#cb10-85" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb10-86"><a href="#cb10-86" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> sanitized</span>
<span id="cb10-87"><a href="#cb10-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-88"><a href="#cb10-88" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> preserve_special_content(<span class="va">self</span>, content: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb10-89"><a href="#cb10-89" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Preserva f√≥rmulas matem√°ticas, c√≥digo e formata√ß√£o especial&quot;&quot;&quot;</span></span>
<span id="cb10-90"><a href="#cb10-90" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> content:</span>
<span id="cb10-91"><a href="#cb10-91" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">&quot;&quot;</span></span>
<span id="cb10-92"><a href="#cb10-92" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb10-93"><a href="#cb10-93" aria-hidden="true" tabindex="-1"></a>        preserved_content <span class="op">=</span> content</span>
<span id="cb10-94"><a href="#cb10-94" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-95"><a href="#cb10-95" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Corrige problemas com barras invertidas em LaTeX</span></span>
<span id="cb10-96"><a href="#cb10-96" aria-hidden="true" tabindex="-1"></a>        latex_corrections <span class="op">=</span> {</span>
<span id="cb10-97"><a href="#cb10-97" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;‚ôÄrac&#39;</span>: <span class="st">&#39;</span><span class="ch">\\</span><span class="st">frac&#39;</span>,</span>
<span id="cb10-98"><a href="#cb10-98" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;‚ôÇarepsilon&#39;</span>: <span class="st">&#39;</span><span class="ch">\\</span><span class="st">varepsilon&#39;</span>,</span>
<span id="cb10-99"><a href="#cb10-99" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;‚ôÇ&#39;</span>: <span class="st">&#39;</span><span class="ch">\\</span><span class="st">&#39;</span>,</span>
<span id="cb10-100"><a href="#cb10-100" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;‚ôÄ&#39;</span>: <span class="st">&#39;</span><span class="ch">\\</span><span class="st">&#39;</span></span>
<span id="cb10-101"><a href="#cb10-101" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb10-102"><a href="#cb10-102" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-103"><a href="#cb10-103" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> wrong, correct <span class="kw">in</span> latex_corrections.items():</span>
<span id="cb10-104"><a href="#cb10-104" aria-hidden="true" tabindex="-1"></a>            preserved_content <span class="op">=</span> preserved_content.replace(wrong, correct)</span>
<span id="cb10-105"><a href="#cb10-105" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-106"><a href="#cb10-106" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> preserved_content</span>
<span id="cb10-107"><a href="#cb10-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-108"><a href="#cb10-108" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> ensure_directories(<span class="va">self</span>):</span>
<span id="cb10-109"><a href="#cb10-109" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Cria todas as pastas necess√°rias&quot;&quot;&quot;</span></span>
<span id="cb10-110"><a href="#cb10-110" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb10-111"><a href="#cb10-111" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;DRY-RUN: Pastas seriam criadas:&quot;</span>)</span>
<span id="cb10-112"><a href="#cb10-112" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> folder <span class="kw">in</span> <span class="va">self</span>.output_dirs.values():</span>
<span id="cb10-113"><a href="#cb10-113" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;   </span><span class="sc">{</span>folder<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb10-114"><a href="#cb10-114" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb10-115"><a href="#cb10-115" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb10-116"><a href="#cb10-116" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> folder <span class="kw">in</span> <span class="va">self</span>.output_dirs.values():</span>
<span id="cb10-117"><a href="#cb10-117" aria-hidden="true" tabindex="-1"></a>            Path(folder).mkdir(parents<span class="op">=</span><span class="va">True</span>, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb10-118"><a href="#cb10-118" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;Pasta criada: </span><span class="sc">{</span>folder<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb10-119"><a href="#cb10-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-120"><a href="#cb10-120" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> run(<span class="va">self</span>):</span>
<span id="cb10-121"><a href="#cb10-121" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Executa o processamento completo&quot;&quot;&quot;</span></span>
<span id="cb10-122"><a href="#cb10-122" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;SISTEMA COMBINADO DE EXPORTA√á√ïES COM HTML (Qwen3, ChatGPT, DeepSeek, Grok)&quot;</span>)</span>
<span id="cb10-123"><a href="#cb10-123" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;=&quot;</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb10-124"><a href="#cb10-124" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-125"><a href="#cb10-125" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.data_dir.exists():</span>
<span id="cb10-126"><a href="#cb10-126" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;Pasta &#39;</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>data_dir<span class="sc">}</span><span class="ss">&#39; n√£o encontrada.&quot;</span>)</span>
<span id="cb10-127"><a href="#cb10-127" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;Crie a pasta &#39;data&#39; e coloque os arquivos de exporta√ß√£o:&quot;</span>)</span>
<span id="cb10-128"><a href="#cb10-128" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> source_name, config <span class="kw">in</span> <span class="va">self</span>.processors.items():</span>
<span id="cb10-129"><a href="#cb10-129" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;   - </span><span class="sc">{</span>config[<span class="st">&#39;file&#39;</span>]<span class="sc">}</span><span class="ss"> (para </span><span class="sc">{</span>source_name<span class="sc">.</span>upper()<span class="sc">}</span><span class="ss">)&quot;</span>)</span>
<span id="cb10-130"><a href="#cb10-130" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb10-131"><a href="#cb10-131" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-132"><a href="#cb10-132" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;Usando pasta de dados: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>data_dir<span class="sc">.</span>absolute()<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb10-133"><a href="#cb10-133" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-134"><a href="#cb10-134" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.ensure_directories()</span>
<span id="cb10-135"><a href="#cb10-135" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-136"><a href="#cb10-136" aria-hidden="true" tabindex="-1"></a>        processed_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb10-137"><a href="#cb10-137" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> source_name, config <span class="kw">in</span> <span class="va">self</span>.processors.items():</span>
<span id="cb10-138"><a href="#cb10-138" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> config[<span class="st">&#39;enabled&#39;</span>]:</span>
<span id="cb10-139"><a href="#cb10-139" aria-hidden="true" tabindex="-1"></a>                file_path <span class="op">=</span> <span class="va">self</span>.data_dir <span class="op">/</span> config[<span class="st">&#39;file&#39;</span>]</span>
<span id="cb10-140"><a href="#cb10-140" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> file_path.exists():</span>
<span id="cb10-141"><a href="#cb10-141" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="ch">\n</span><span class="ss">Processando </span><span class="sc">{</span>source_name<span class="sc">.</span>upper()<span class="sc">}</span><span class="ss">...&quot;</span>)</span>
<span id="cb10-142"><a href="#cb10-142" aria-hidden="true" tabindex="-1"></a>                    config[<span class="st">&#39;method&#39;</span>](file_path)</span>
<span id="cb10-143"><a href="#cb10-143" aria-hidden="true" tabindex="-1"></a>                    processed_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb10-144"><a href="#cb10-144" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb10-145"><a href="#cb10-145" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="sc">{</span>source_name<span class="sc">.</span>upper()<span class="sc">}</span><span class="ss">: arquivo n√£o encontrado - </span><span class="sc">{</span>file_path<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb10-146"><a href="#cb10-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-147"><a href="#cb10-147" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> processed_count <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb10-148"><a href="#cb10-148" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;Nenhum arquivo de exporta√ß√£o encontrado na pasta &#39;data&#39;.&quot;</span>)</span>
<span id="cb10-149"><a href="#cb10-149" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb10-150"><a href="#cb10-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-151"><a href="#cb10-151" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb10-152"><a href="#cb10-152" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;Nenhuma conversa foi extra√≠da dos arquivos.&quot;</span>)</span>
<span id="cb10-153"><a href="#cb10-153" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb10-154"><a href="#cb10-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-155"><a href="#cb10-155" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>._post_process_conversations()</span>
<span id="cb10-156"><a href="#cb10-156" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-157"><a href="#cb10-157" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.dry_run:</span>
<span id="cb10-158"><a href="#cb10-158" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>._export_all_formats()</span>
<span id="cb10-159"><a href="#cb10-159" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="ch">\n</span><span class="ss">üéâ SISTEMA COMBINADO FINALIZADO!&quot;</span>)</span>
<span id="cb10-160"><a href="#cb10-160" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;üìÑ √çndice: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>index_file<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb10-161"><a href="#cb10-161" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> Path(<span class="va">self</span>.index_file).exists():</span>
<span id="cb10-162"><a href="#cb10-162" aria-hidden="true" tabindex="-1"></a>                webbrowser.<span class="bu">open</span>(<span class="ss">f&#39;file://</span><span class="sc">{</span>Path(<span class="va">self</span>.index_file)<span class="sc">.</span>absolute()<span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb10-163"><a href="#cb10-163" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb10-164"><a href="#cb10-164" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="ch">\n</span><span class="ss">üß™ MODO DRY-RUN: Nenhum arquivo foi criado.&quot;</span>)</span>
<span id="cb10-165"><a href="#cb10-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-166"><a href="#cb10-166" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _post_process_conversations(<span class="va">self</span>):</span>
<span id="cb10-167"><a href="#cb10-167" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Processamento p√≥s-extra√ß√£o das conversas&quot;&quot;&quot;</span></span>
<span id="cb10-168"><a href="#cb10-168" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.all_conversations.sort(</span>
<span id="cb10-169"><a href="#cb10-169" aria-hidden="true" tabindex="-1"></a>            key<span class="op">=</span><span class="kw">lambda</span> x: <span class="va">self</span>.parse_timestamp_for_sorting(</span>
<span id="cb10-170"><a href="#cb10-170" aria-hidden="true" tabindex="-1"></a>                x.get(<span class="st">&#39;updated_at&#39;</span>) <span class="kw">or</span> x.get(<span class="st">&#39;inserted_at&#39;</span>) <span class="kw">or</span> x.get(<span class="st">&#39;created_at&#39;</span>)</span>
<span id="cb10-171"><a href="#cb10-171" aria-hidden="true" tabindex="-1"></a>            ),</span>
<span id="cb10-172"><a href="#cb10-172" aria-hidden="true" tabindex="-1"></a>            reverse<span class="op">=</span><span class="va">True</span></span>
<span id="cb10-173"><a href="#cb10-173" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb10-174"><a href="#cb10-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-175"><a href="#cb10-175" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, conv <span class="kw">in</span> <span class="bu">enumerate</span>(<span class="va">self</span>.all_conversations):</span>
<span id="cb10-176"><a href="#cb10-176" aria-hidden="true" tabindex="-1"></a>            conv[<span class="st">&#39;number&#39;</span>] <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb10-177"><a href="#cb10-177" aria-hidden="true" tabindex="-1"></a>            conv[<span class="st">&#39;category&#39;</span>] <span class="op">=</span> <span class="va">self</span>.categorize_conversation(conv[<span class="st">&#39;title&#39;</span>], conv.get(<span class="st">&#39;summary&#39;</span>, <span class="st">&#39;&#39;</span>))</span>
<span id="cb10-178"><a href="#cb10-178" aria-hidden="true" tabindex="-1"></a>            conv.setdefault(<span class="st">&#39;source&#39;</span>, <span class="st">&#39;Desconhecido&#39;</span>)</span>
<span id="cb10-179"><a href="#cb10-179" aria-hidden="true" tabindex="-1"></a>            conv.setdefault(<span class="st">&#39;messages&#39;</span>, [])</span>
<span id="cb10-180"><a href="#cb10-180" aria-hidden="true" tabindex="-1"></a>            conv.setdefault(<span class="st">&#39;summary&#39;</span>, conv[<span class="st">&#39;messages&#39;</span>][<span class="dv">0</span>][<span class="st">&#39;content&#39;</span>][:<span class="dv">100</span>] <span class="op">+</span> <span class="st">&quot;...&quot;</span> <span class="cf">if</span> conv[<span class="st">&#39;messages&#39;</span>] <span class="cf">else</span> <span class="st">&quot;Sem conte√∫do&quot;</span>)</span>
<span id="cb10-181"><a href="#cb10-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-182"><a href="#cb10-182" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;üìä Total combinado de conversas: </span><span class="sc">{</span><span class="bu">len</span>(<span class="va">self</span>.all_conversations)<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb10-183"><a href="#cb10-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-184"><a href="#cb10-184" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _export_all_formats(<span class="va">self</span>):</span>
<span id="cb10-185"><a href="#cb10-185" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Exporta para todos os formatos&quot;&quot;&quot;</span></span>
<span id="cb10-186"><a href="#cb10-186" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">üíæ Exportando para formatos...&quot;</span>)</span>
<span id="cb10-187"><a href="#cb10-187" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.save_as_markdown_enhanced()</span>
<span id="cb10-188"><a href="#cb10-188" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.save_as_html_enhanced()  <span class="co"># NOVO: Exporta√ß√£o HTML</span></span>
<span id="cb10-189"><a href="#cb10-189" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.save_as_csv() </span>
<span id="cb10-190"><a href="#cb10-190" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.save_as_json()</span>
<span id="cb10-191"><a href="#cb10-191" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.save_all_to_single_files()</span>
<span id="cb10-192"><a href="#cb10-192" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.create_searchable_index()</span>
<span id="cb10-193"><a href="#cb10-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-194"><a href="#cb10-194" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> categorize_conversation(<span class="va">self</span>, title: <span class="bu">str</span>, summary: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb10-195"><a href="#cb10-195" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Categoriza√ß√£o otimizada com express√µes regulares&quot;&quot;&quot;</span></span>
<span id="cb10-196"><a href="#cb10-196" aria-hidden="true" tabindex="-1"></a>        text <span class="op">=</span> <span class="ss">f&quot;</span><span class="sc">{</span>title<span class="sc">}</span><span class="ss"> </span><span class="sc">{</span>summary<span class="sc">}</span><span class="ss">&quot;</span>.lower()</span>
<span id="cb10-197"><a href="#cb10-197" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-198"><a href="#cb10-198" aria-hidden="true" tabindex="-1"></a>        patterns <span class="op">=</span> {</span>
<span id="cb10-199"><a href="#cb10-199" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Tecnologia&#39;</span>: <span class="vs">r&#39;</span><span class="dv">\b</span><span class="kw">(</span><span class="vs">tecnologia</span><span class="cf">|</span><span class="vs">hardware</span><span class="cf">|</span><span class="vs">software</span><span class="cf">|</span><span class="vs">rede</span><span class="cf">|</span><span class="vs">internet</span><span class="cf">|</span><span class="vs">wifi</span><span class="cf">|</span><span class="vs">bluetooth</span><span class="cf">|</span><span class="pp">[45]</span><span class="vs">g</span><span class="cf">|</span><span class="vs">cloud</span><span class="cf">|</span><span class="vs">aws</span><span class="cf">|</span><span class="vs">azure</span><span class="cf">|</span><span class="vs">gcp</span><span class="cf">|</span><span class="vs">servidor</span><span class="cf">|</span><span class="vs">hosting</span><span class="cf">|</span><span class="vs">dom√≠nio</span><span class="cf">|</span><span class="vs">ssl</span><span class="cf">|</span><span class="vs">router</span><span class="cf">|</span><span class="vs">switch</span><span class="cf">|</span><span class="vs">firewall</span><span class="cf">|</span><span class="vs">iot</span><span class="cf">|</span><span class="vs">smartphone</span><span class="cf">|</span><span class="vs">tablet</span><span class="cf">|</span><span class="vs">navegador</span><span class="cf">|</span><span class="vs">browser</span><span class="cf">|</span><span class="vs">chrome</span><span class="cf">|</span><span class="vs">firefox</span><span class="cf">|</span><span class="vs">edge</span><span class="cf">|</span><span class="vs">safari</span><span class="cf">|</span><span class="vs">email</span><span class="cf">|</span><span class="vs">gmail</span><span class="cf">|</span><span class="vs">outlook</span><span class="cf">|</span><span class="vs">criptografia</span><span class="cf">|</span><span class="vs">seguran√ßa</span><span class="cf">|</span><span class="vs">ciberseguran√ßa</span><span class="cf">|</span><span class="vs">ransomware</span><span class="cf">|</span><span class="vs">phishing</span><span class="cf">|</span><span class="vs">autentica√ß√£o</span><span class="cf">|</span><span class="vs">2fa</span><span class="cf">|</span><span class="vs">biometria</span><span class="kw">)</span><span class="dv">\b</span><span class="vs">&#39;</span>,</span>
<span id="cb10-200"><a href="#cb10-200" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Sa√∫de&#39;</span>: <span class="vs">r&#39;</span><span class="dv">\b</span><span class="kw">(</span><span class="vs">sa√∫de</span><span class="cf">|</span><span class="vs">medicina</span><span class="cf">|</span><span class="vs">m√©dico</span><span class="cf">|</span><span class="vs">enfermagem</span><span class="cf">|</span><span class="vs">doen√ßa</span><span class="cf">|</span><span class="vs">v√≠rus</span><span class="cf">|</span><span class="vs">bact√©ria</span><span class="cf">|</span><span class="vs">vacina</span><span class="cf">|</span><span class="vs">covid</span><span class="cf">|</span><span class="vs">coronav√≠rus</span><span class="cf">|</span><span class="vs">gripe</span><span class="cf">|</span><span class="vs">febre</span><span class="cf">|</span><span class="vs">dor</span><span class="cf">|</span><span class="vs">an√°lise</span><span class="cf">|</span><span class="vs">exame</span><span class="cf">|</span><span class="vs">raio x</span><span class="cf">|</span><span class="vs">resson√¢ncia</span><span class="cf">|</span><span class="vs">hospital</span><span class="cf">|</span><span class="vs">cl√≠nica</span><span class="cf">|</span><span class="vs">farm√°cia</span><span class="cf">|</span><span class="vs">medicamento</span><span class="cf">|</span><span class="vs">rem√©dio</span><span class="cf">|</span><span class="vs">psicologia</span><span class="cf">|</span><span class="vs">terapia</span><span class="cf">|</span><span class="vs">bem-estar</span><span class="cf">|</span><span class="vs">nutri√ß√£o</span><span class="cf">|</span><span class="vs">dieta</span><span class="cf">|</span><span class="vs">exerc√≠cio</span><span class="cf">|</span><span class="vs">fitness</span><span class="cf">|</span><span class="vs">sono</span><span class="cf">|</span><span class="vs">sa√∫de mental</span><span class="kw">)</span><span class="dv">\b</span><span class="vs">&#39;</span>,</span>
<span id="cb10-201"><a href="#cb10-201" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Programa√ß√£o&#39;</span>: <span class="vs">r&#39;</span><span class="dv">\b</span><span class="kw">(</span><span class="vs">python</span><span class="cf">|</span><span class="vs">javascript</span><span class="cf">|</span><span class="vs">java</span><span class="cf">|</span><span class="vs">c</span><span class="ch">\+\+</span><span class="cf">|</span><span class="vs">c#</span><span class="cf">|</span><span class="vs">go</span><span class="cf">|</span><span class="vs">rust</span><span class="cf">|</span><span class="vs">lua</span><span class="cf">|</span><span class="vs">bash</span><span class="cf">|</span><span class="vs">script</span><span class="cf">|</span><span class="vs">debug</span><span class="cf">|</span><span class="vs">erro</span><span class="cf">|</span><span class="vs">conda</span><span class="cf">|</span><span class="vs">mamba</span><span class="cf">|</span><span class="vs">pandoc</span><span class="cf">|</span><span class="vs">msys2</span><span class="cf">|</span><span class="vs">spyder</span><span class="cf">|</span><span class="vs">jupyter</span><span class="cf">|</span><span class="vs">pip</span><span class="cf">|</span><span class="vs">venv</span><span class="cf">|</span><span class="vs">docker</span><span class="cf">|</span><span class="vs">git</span><span class="cf">|</span><span class="vs">github</span><span class="cf">|</span><span class="vs">vscode</span><span class="cf">|</span><span class="vs">ide</span><span class="cf">|</span><span class="vs">programa</span><span class="cf">|</span><span class="vs">c√≥digo</span><span class="cf">|</span><span class="vs">fun√ß√£o</span><span class="cf">|</span><span class="vs">classe</span><span class="cf">|</span><span class="vs">api</span><span class="cf">|</span><span class="vs">selenium</span><span class="cf">|</span><span class="vs">playwright</span><span class="kw">)</span><span class="dv">\b</span><span class="vs">&#39;</span>,</span>
<span id="cb10-202"><a href="#cb10-202" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Sistemas&#39;</span>: <span class="vs">r&#39;</span><span class="dv">\b</span><span class="kw">(</span><span class="vs">windows</span><span class="cf">|</span><span class="vs">linux</span><span class="cf">|</span><span class="vs">macos</span><span class="cf">|</span><span class="vs">so</span><span class="cf">|</span><span class="vs">sistema operacional</span><span class="cf">|</span><span class="vs">driver</span><span class="cf">|</span><span class="vs">registry</span><span class="cf">|</span><span class="vs">process</span><span class="cf">|</span><span class="vs">firewall</span><span class="cf">|</span><span class="vs">bios</span><span class="cf">|</span><span class="vs">boot</span><span class="cf">|</span><span class="vs">path</span><span class="cf">|</span><span class="vs">dll</span><span class="cf">|</span><span class="vs">exe</span><span class="cf">|</span><span class="vs">powershell</span><span class="cf">|</span><span class="vs">cmd</span><span class="cf">|</span><span class="vs">terminal</span><span class="cf">|</span><span class="vs">shell</span><span class="kw">)</span><span class="dv">\b</span><span class="vs">&#39;</span>,</span>
<span id="cb10-203"><a href="#cb10-203" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;IA&#39;</span>: <span class="vs">r&#39;</span><span class="dv">\b</span><span class="kw">(</span><span class="vs">ia</span><span class="cf">|</span><span class="vs">gpt</span><span class="cf">|</span><span class="vs">chatgpt</span><span class="cf">|</span><span class="vs">grok</span><span class="cf">|</span><span class="vs">qwen</span><span class="cf">|</span><span class="vs">deepseek</span><span class="cf">|</span><span class="vs">llm</span><span class="cf">|</span><span class="vs">modelo</span><span class="cf">|</span><span class="vs">prompt</span><span class="cf">|</span><span class="vs">token</span><span class="cf">|</span><span class="vs">embedding</span><span class="cf">|</span><span class="vs">fine-tune</span><span class="cf">|</span><span class="vs">neural</span><span class="cf">|</span><span class="vs">chatbot</span><span class="cf">|</span><span class="vs">intelig√™ncia artificial</span><span class="kw">)</span><span class="dv">\b</span><span class="vs">&#39;</span>,</span>
<span id="cb10-204"><a href="#cb10-204" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Dados&#39;</span>: <span class="vs">r&#39;</span><span class="dv">\b</span><span class="kw">(</span><span class="vs">dados</span><span class="cf">|</span><span class="vs">data</span><span class="cf">|</span><span class="vs">csv</span><span class="cf">|</span><span class="vs">json</span><span class="cf">|</span><span class="vs">pandas</span><span class="cf">|</span><span class="vs">numpy</span><span class="cf">|</span><span class="vs">excel</span><span class="cf">|</span><span class="vs">sql</span><span class="cf">|</span><span class="vs">banco</span><span class="cf">|</span><span class="vs">sqlite</span><span class="cf">|</span><span class="vs">postgres</span><span class="cf">|</span><span class="vs">visualiza√ß√£o</span><span class="cf">|</span><span class="vs">gr√°fico</span><span class="cf">|</span><span class="vs">tabela</span><span class="cf">|</span><span class="vs">an√°lise</span><span class="cf">|</span><span class="vs">etl</span><span class="cf">|</span><span class="vs">dashboard</span><span class="kw">)</span><span class="dv">\b</span><span class="vs">&#39;</span>,</span>
<span id="cb10-205"><a href="#cb10-205" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Geral&#39;</span>: <span class="vs">r&#39;</span><span class="dv">\b</span><span class="kw">(</span><span class="vs">geral</span><span class="cf">|</span><span class="vs">pergunta</span><span class="cf">|</span><span class="vs">ajuda</span><span class="cf">|</span><span class="vs">como fazer</span><span class="cf">|</span><span class="vs">explicar</span><span class="cf">|</span><span class="vs">resumo</span><span class="cf">|</span><span class="vs">tutorial b√°sico</span><span class="kw">)</span><span class="dv">\b</span><span class="vs">&#39;</span></span>
<span id="cb10-206"><a href="#cb10-206" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb10-207"><a href="#cb10-207" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-208"><a href="#cb10-208" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> category, pattern <span class="kw">in</span> patterns.items():</span>
<span id="cb10-209"><a href="#cb10-209" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> re.search(pattern, text, re.IGNORECASE):</span>
<span id="cb10-210"><a href="#cb10-210" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> category</span>
<span id="cb10-211"><a href="#cb10-211" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb10-212"><a href="#cb10-212" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">&#39;Outros&#39;</span></span>
<span id="cb10-213"><a href="#cb10-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-214"><a href="#cb10-214" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> parse_timestamp_for_sorting(<span class="va">self</span>, timestamp) <span class="op">-&gt;</span> datetime:</span>
<span id="cb10-215"><a href="#cb10-215" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> timestamp:</span>
<span id="cb10-216"><a href="#cb10-216" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> datetime.<span class="bu">min</span></span>
<span id="cb10-217"><a href="#cb10-217" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb10-218"><a href="#cb10-218" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb10-219"><a href="#cb10-219" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">isinstance</span>(timestamp, <span class="bu">str</span>):</span>
<span id="cb10-220"><a href="#cb10-220" aria-hidden="true" tabindex="-1"></a>                clean_ts <span class="op">=</span> timestamp.replace(<span class="st">&#39;T&#39;</span>, <span class="st">&#39; &#39;</span>).split(<span class="st">&#39;.&#39;</span>)[<span class="dv">0</span>].split(<span class="st">&#39;+&#39;</span>)[<span class="dv">0</span>]</span>
<span id="cb10-221"><a href="#cb10-221" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> clean_ts.endswith(<span class="st">&#39;Z&#39;</span>):</span>
<span id="cb10-222"><a href="#cb10-222" aria-hidden="true" tabindex="-1"></a>                    clean_ts <span class="op">=</span> clean_ts[:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb10-223"><a href="#cb10-223" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> datetime.fromisoformat(clean_ts)</span>
<span id="cb10-224"><a href="#cb10-224" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> <span class="bu">isinstance</span>(timestamp, (<span class="bu">int</span>, <span class="bu">float</span>)):</span>
<span id="cb10-225"><a href="#cb10-225" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> datetime.fromtimestamp(timestamp)</span>
<span id="cb10-226"><a href="#cb10-226" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span>:</span>
<span id="cb10-227"><a href="#cb10-227" aria-hidden="true" tabindex="-1"></a>            <span class="cf">pass</span></span>
<span id="cb10-228"><a href="#cb10-228" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb10-229"><a href="#cb10-229" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> datetime.<span class="bu">min</span></span>
<span id="cb10-230"><a href="#cb10-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-231"><a href="#cb10-231" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> format_timestamp(<span class="va">self</span>, timestamp) <span class="op">-&gt;</span> Optional[<span class="bu">str</span>]:</span>
<span id="cb10-232"><a href="#cb10-232" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> timestamp:</span>
<span id="cb10-233"><a href="#cb10-233" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb10-234"><a href="#cb10-234" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb10-235"><a href="#cb10-235" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb10-236"><a href="#cb10-236" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">isinstance</span>(timestamp, (<span class="bu">int</span>, <span class="bu">float</span>)):</span>
<span id="cb10-237"><a href="#cb10-237" aria-hidden="true" tabindex="-1"></a>                dt <span class="op">=</span> datetime.fromtimestamp(timestamp)</span>
<span id="cb10-238"><a href="#cb10-238" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> dt.strftime(<span class="st">&#39;%Y-%m-</span><span class="sc">%d</span><span class="st"> %H:%M:%S&#39;</span>)</span>
<span id="cb10-239"><a href="#cb10-239" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> <span class="bu">isinstance</span>(timestamp, <span class="bu">str</span>):</span>
<span id="cb10-240"><a href="#cb10-240" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="st">&#39;T&#39;</span> <span class="kw">in</span> timestamp:</span>
<span id="cb10-241"><a href="#cb10-241" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">return</span> timestamp.replace(<span class="st">&#39;T&#39;</span>, <span class="st">&#39; &#39;</span>).split(<span class="st">&#39;.&#39;</span>)[<span class="dv">0</span>]</span>
<span id="cb10-242"><a href="#cb10-242" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> timestamp</span>
<span id="cb10-243"><a href="#cb10-243" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span>:</span>
<span id="cb10-244"><a href="#cb10-244" aria-hidden="true" tabindex="-1"></a>            <span class="cf">pass</span></span>
<span id="cb10-245"><a href="#cb10-245" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb10-246"><a href="#cb10-246" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">str</span>(timestamp)</span>
<span id="cb10-247"><a href="#cb10-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-248"><a href="#cb10-248" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_enhanced_markdown_content(<span class="va">self</span>, conversation: Dict[<span class="bu">str</span>, Any]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb10-249"><a href="#cb10-249" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Gera conte√∫do Markdown com preserva√ß√£o total de formata√ß√£o&quot;&quot;&quot;</span></span>
<span id="cb10-250"><a href="#cb10-250" aria-hidden="true" tabindex="-1"></a>        lines <span class="op">=</span> [</span>
<span id="cb10-251"><a href="#cb10-251" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f&quot;# </span><span class="sc">{</span>conversation[<span class="st">&#39;title&#39;</span>]<span class="sc">}</span><span class="ss">&quot;</span>,</span>
<span id="cb10-252"><a href="#cb10-252" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;&quot;</span>,</span>
<span id="cb10-253"><a href="#cb10-253" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;## üìä Informa√ß√µes&quot;</span>,</span>
<span id="cb10-254"><a href="#cb10-254" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f&quot;- **N√∫mero:** #</span><span class="sc">{</span>conversation[<span class="st">&#39;number&#39;</span>]<span class="sc">}</span><span class="ss">&quot;</span>,</span>
<span id="cb10-255"><a href="#cb10-255" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f&quot;- **Origem:** </span><span class="sc">{</span>conversation[<span class="st">&#39;source&#39;</span>]<span class="sc">}</span><span class="ss">&quot;</span>,</span>
<span id="cb10-256"><a href="#cb10-256" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f&quot;- **Categoria:** </span><span class="sc">{</span>conversation[<span class="st">&#39;category&#39;</span>]<span class="sc">}</span><span class="ss">&quot;</span>,</span>
<span id="cb10-257"><a href="#cb10-257" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f&quot;- **ID:** </span><span class="sc">{</span>conversation<span class="sc">.</span>get(<span class="st">&#39;id&#39;</span>, <span class="st">&#39;N/A&#39;</span>)<span class="sc">}</span><span class="ss">&quot;</span>,</span>
<span id="cb10-258"><a href="#cb10-258" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f&quot;- **Criada em:** </span><span class="sc">{</span>conversation<span class="sc">.</span>get(<span class="st">&#39;inserted_at&#39;</span>) <span class="kw">or</span> conversation<span class="sc">.</span>get(<span class="st">&#39;created_at&#39;</span>) <span class="kw">or</span> <span class="st">&#39;N/A&#39;</span><span class="sc">}</span><span class="ss">&quot;</span>,</span>
<span id="cb10-259"><a href="#cb10-259" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb10-260"><a href="#cb10-260" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-261"><a href="#cb10-261" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> conversation.get(<span class="st">&#39;updated_at&#39;</span>):</span>
<span id="cb10-262"><a href="#cb10-262" aria-hidden="true" tabindex="-1"></a>            lines.append(<span class="ss">f&quot;- **Atualizada em:** </span><span class="sc">{</span>conversation[<span class="st">&#39;updated_at&#39;</span>]<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb10-263"><a href="#cb10-263" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb10-264"><a href="#cb10-264" aria-hidden="true" tabindex="-1"></a>        lines.extend([</span>
<span id="cb10-265"><a href="#cb10-265" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f&quot;- **Total de mensagens:** </span><span class="sc">{</span><span class="bu">len</span>(conversation[<span class="st">&#39;messages&#39;</span>])<span class="sc">}</span><span class="ss">&quot;</span>,</span>
<span id="cb10-266"><a href="#cb10-266" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f&quot;- **Resumo:** </span><span class="sc">{</span>conversation<span class="sc">.</span>get(<span class="st">&#39;summary&#39;</span>, <span class="st">&#39;Sem resumo&#39;</span>)<span class="sc">}</span><span class="ss">&quot;</span>,</span>
<span id="cb10-267"><a href="#cb10-267" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;&quot;</span>,</span>
<span id="cb10-268"><a href="#cb10-268" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;---&quot;</span>,</span>
<span id="cb10-269"><a href="#cb10-269" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;&quot;</span>,</span>
<span id="cb10-270"><a href="#cb10-270" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;## üó®Ô∏è Conversa&quot;</span>,</span>
<span id="cb10-271"><a href="#cb10-271" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;&quot;</span></span>
<span id="cb10-272"><a href="#cb10-272" aria-hidden="true" tabindex="-1"></a>        ])</span>
<span id="cb10-273"><a href="#cb10-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-274"><a href="#cb10-274" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, msg <span class="kw">in</span> <span class="bu">enumerate</span>(conversation[<span class="st">&#39;messages&#39;</span>], <span class="dv">1</span>):</span>
<span id="cb10-275"><a href="#cb10-275" aria-hidden="true" tabindex="-1"></a>            timestamp <span class="op">=</span> <span class="ss">f&quot; *(</span><span class="sc">{</span>msg[<span class="st">&#39;timestamp&#39;</span>]<span class="sc">}</span><span class="ss">)*&quot;</span> <span class="cf">if</span> msg[<span class="st">&#39;timestamp&#39;</span>] <span class="cf">else</span> <span class="st">&quot;&quot;</span></span>
<span id="cb10-276"><a href="#cb10-276" aria-hidden="true" tabindex="-1"></a>            model_info <span class="op">=</span> <span class="ss">f&quot; *[</span><span class="sc">{</span>msg<span class="sc">.</span>get(<span class="st">&#39;model&#39;</span>, <span class="st">&#39;&#39;</span>)<span class="sc">}</span><span class="ss">]*&quot;</span> <span class="cf">if</span> msg.get(<span class="st">&#39;model&#39;</span>) <span class="cf">else</span> <span class="st">&quot;&quot;</span></span>
<span id="cb10-277"><a href="#cb10-277" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb10-278"><a href="#cb10-278" aria-hidden="true" tabindex="-1"></a>            <span class="co"># PRESERVA√á√ÉO TOTAL do conte√∫do</span></span>
<span id="cb10-279"><a href="#cb10-279" aria-hidden="true" tabindex="-1"></a>            preserved_content <span class="op">=</span> <span class="va">self</span>.preserve_special_content(msg[<span class="st">&#39;content&#39;</span>])</span>
<span id="cb10-280"><a href="#cb10-280" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb10-281"><a href="#cb10-281" aria-hidden="true" tabindex="-1"></a>            lines.extend([</span>
<span id="cb10-282"><a href="#cb10-282" aria-hidden="true" tabindex="-1"></a>                <span class="ss">f&quot;### </span><span class="sc">{</span>msg[<span class="st">&#39;author&#39;</span>]<span class="sc">}{</span>timestamp<span class="sc">}{</span>model_info<span class="sc">}</span><span class="ss">&quot;</span>,</span>
<span id="cb10-283"><a href="#cb10-283" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;&quot;</span>,</span>
<span id="cb10-284"><a href="#cb10-284" aria-hidden="true" tabindex="-1"></a>                <span class="ss">f&quot;</span><span class="sc">{</span>preserved_content<span class="sc">}</span><span class="ss">&quot;</span>,</span>
<span id="cb10-285"><a href="#cb10-285" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;&quot;</span></span>
<span id="cb10-286"><a href="#cb10-286" aria-hidden="true" tabindex="-1"></a>            ])</span>
<span id="cb10-287"><a href="#cb10-287" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb10-288"><a href="#cb10-288" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> j <span class="op">&lt;</span> <span class="bu">len</span>(conversation[<span class="st">&#39;messages&#39;</span>]):</span>
<span id="cb10-289"><a href="#cb10-289" aria-hidden="true" tabindex="-1"></a>                lines.extend([<span class="st">&quot;---&quot;</span>, <span class="st">&quot;&quot;</span>])</span>
<span id="cb10-290"><a href="#cb10-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-291"><a href="#cb10-291" aria-hidden="true" tabindex="-1"></a>        lines.extend([</span>
<span id="cb10-292"><a href="#cb10-292" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;---&quot;</span>,</span>
<span id="cb10-293"><a href="#cb10-293" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;&quot;</span>,</span>
<span id="cb10-294"><a href="#cb10-294" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f&quot;*Conversa exportada do </span><span class="sc">{</span>conversation[<span class="st">&#39;source&#39;</span>]<span class="sc">}</span><span class="ss">*&quot;</span>,</span>
<span id="cb10-295"><a href="#cb10-295" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f&quot;*Processado em: </span><span class="sc">{</span>datetime<span class="sc">.</span>now()<span class="sc">.</span>strftime(<span class="st">&#39;</span><span class="sc">%d</span><span class="st">/%m/%Y %H:%M&#39;</span>)<span class="sc">}</span><span class="ss">*&quot;</span></span>
<span id="cb10-296"><a href="#cb10-296" aria-hidden="true" tabindex="-1"></a>        ])</span>
<span id="cb10-297"><a href="#cb10-297" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-298"><a href="#cb10-298" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>.join(lines)</span>
<span id="cb10-299"><a href="#cb10-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-300"><a href="#cb10-300" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_enhanced_html_content(<span class="va">self</span>, conversation: Dict[<span class="bu">str</span>, Any]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb10-301"><a href="#cb10-301" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Gera conte√∫do HTML elegante a partir do Markdown&quot;&quot;&quot;</span></span>
<span id="cb10-302"><a href="#cb10-302" aria-hidden="true" tabindex="-1"></a>        markdown_content <span class="op">=</span> <span class="va">self</span>.create_enhanced_markdown_content(conversation)</span>
<span id="cb10-303"><a href="#cb10-303" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-304"><a href="#cb10-304" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Converte Markdown para HTML</span></span>
<span id="cb10-305"><a href="#cb10-305" aria-hidden="true" tabindex="-1"></a>        html_content <span class="op">=</span> markdown.markdown(markdown_content, extensions<span class="op">=</span>[<span class="st">&#39;extra&#39;</span>, <span class="st">&#39;tables&#39;</span>])</span>
<span id="cb10-306"><a href="#cb10-306" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-307"><a href="#cb10-307" aria-hidden="true" tabindex="-1"></a>        <span class="co"># HTML template com styling elegante</span></span>
<span id="cb10-308"><a href="#cb10-308" aria-hidden="true" tabindex="-1"></a>        html_template <span class="op">=</span> <span class="ss">f&quot;&quot;&quot;&lt;!DOCTYPE html&gt;</span></span>
<span id="cb10-309"><a href="#cb10-309" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;html lang=&quot;pt-PT&quot;&gt;</span></span>
<span id="cb10-310"><a href="#cb10-310" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;head&gt;</span></span>
<span id="cb10-311"><a href="#cb10-311" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span></span>
<span id="cb10-312"><a href="#cb10-312" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span></span>
<span id="cb10-313"><a href="#cb10-313" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;title&gt;</span><span class="sc">{</span>conversation[<span class="st">&#39;title&#39;</span>]<span class="sc">}</span><span class="ss">&lt;/title&gt;</span></span>
<span id="cb10-314"><a href="#cb10-314" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;style&gt;</span></span>
<span id="cb10-315"><a href="#cb10-315" aria-hidden="true" tabindex="-1"></a><span class="ss">        * </span><span class="ch">{{</span></span>
<span id="cb10-316"><a href="#cb10-316" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin: 0;</span></span>
<span id="cb10-317"><a href="#cb10-317" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 0;</span></span>
<span id="cb10-318"><a href="#cb10-318" aria-hidden="true" tabindex="-1"></a><span class="ss">            box-sizing: border-box;</span></span>
<span id="cb10-319"><a href="#cb10-319" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-320"><a href="#cb10-320" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb10-321"><a href="#cb10-321" aria-hidden="true" tabindex="-1"></a><span class="ss">        body </span><span class="ch">{{</span></span>
<span id="cb10-322"><a href="#cb10-322" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-family: &#39;Segoe UI&#39;, Tahoma, Geneva, Verdana, sans-serif;</span></span>
<span id="cb10-323"><a href="#cb10-323" aria-hidden="true" tabindex="-1"></a><span class="ss">            line-height: 1.6;</span></span>
<span id="cb10-324"><a href="#cb10-324" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #333;</span></span>
<span id="cb10-325"><a href="#cb10-325" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);</span></span>
<span id="cb10-326"><a href="#cb10-326" aria-hidden="true" tabindex="-1"></a><span class="ss">            min-height: 100vh;</span></span>
<span id="cb10-327"><a href="#cb10-327" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 20px;</span></span>
<span id="cb10-328"><a href="#cb10-328" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-329"><a href="#cb10-329" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb10-330"><a href="#cb10-330" aria-hidden="true" tabindex="-1"></a><span class="ss">        .container </span><span class="ch">{{</span></span>
<span id="cb10-331"><a href="#cb10-331" aria-hidden="true" tabindex="-1"></a><span class="ss">            max-width: 1000px;</span></span>
<span id="cb10-332"><a href="#cb10-332" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin: 0 auto;</span></span>
<span id="cb10-333"><a href="#cb10-333" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: white;</span></span>
<span id="cb10-334"><a href="#cb10-334" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 15px;</span></span>
<span id="cb10-335"><a href="#cb10-335" aria-hidden="true" tabindex="-1"></a><span class="ss">            box-shadow: 0 20px 40px rgba(0,0,0,0.1);</span></span>
<span id="cb10-336"><a href="#cb10-336" aria-hidden="true" tabindex="-1"></a><span class="ss">            overflow: hidden;</span></span>
<span id="cb10-337"><a href="#cb10-337" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-338"><a href="#cb10-338" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb10-339"><a href="#cb10-339" aria-hidden="true" tabindex="-1"></a><span class="ss">        .header </span><span class="ch">{{</span></span>
<span id="cb10-340"><a href="#cb10-340" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);</span></span>
<span id="cb10-341"><a href="#cb10-341" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: white;</span></span>
<span id="cb10-342"><a href="#cb10-342" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 40px;</span></span>
<span id="cb10-343"><a href="#cb10-343" aria-hidden="true" tabindex="-1"></a><span class="ss">            text-align: center;</span></span>
<span id="cb10-344"><a href="#cb10-344" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-345"><a href="#cb10-345" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb10-346"><a href="#cb10-346" aria-hidden="true" tabindex="-1"></a><span class="ss">        .header h1 </span><span class="ch">{{</span></span>
<span id="cb10-347"><a href="#cb10-347" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 2.5em;</span></span>
<span id="cb10-348"><a href="#cb10-348" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-bottom: 10px;</span></span>
<span id="cb10-349"><a href="#cb10-349" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-weight: 300;</span></span>
<span id="cb10-350"><a href="#cb10-350" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-351"><a href="#cb10-351" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb10-352"><a href="#cb10-352" aria-hidden="true" tabindex="-1"></a><span class="ss">        .header .meta </span><span class="ch">{{</span></span>
<span id="cb10-353"><a href="#cb10-353" aria-hidden="true" tabindex="-1"></a><span class="ss">            opacity: 0.9;</span></span>
<span id="cb10-354"><a href="#cb10-354" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 1.1em;</span></span>
<span id="cb10-355"><a href="#cb10-355" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-356"><a href="#cb10-356" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb10-357"><a href="#cb10-357" aria-hidden="true" tabindex="-1"></a><span class="ss">        .content </span><span class="ch">{{</span></span>
<span id="cb10-358"><a href="#cb10-358" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 40px;</span></span>
<span id="cb10-359"><a href="#cb10-359" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-360"><a href="#cb10-360" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb10-361"><a href="#cb10-361" aria-hidden="true" tabindex="-1"></a><span class="ss">        h1 </span><span class="ch">{{</span></span>
<span id="cb10-362"><a href="#cb10-362" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #2c3e50;</span></span>
<span id="cb10-363"><a href="#cb10-363" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-bottom: 3px solid #667eea;</span></span>
<span id="cb10-364"><a href="#cb10-364" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding-bottom: 10px;</span></span>
<span id="cb10-365"><a href="#cb10-365" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-bottom: 20px;</span></span>
<span id="cb10-366"><a href="#cb10-366" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-367"><a href="#cb10-367" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb10-368"><a href="#cb10-368" aria-hidden="true" tabindex="-1"></a><span class="ss">        h2 </span><span class="ch">{{</span></span>
<span id="cb10-369"><a href="#cb10-369" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #34495e;</span></span>
<span id="cb10-370"><a href="#cb10-370" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin: 30px 0 15px 0;</span></span>
<span id="cb10-371"><a href="#cb10-371" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding-bottom: 8px;</span></span>
<span id="cb10-372"><a href="#cb10-372" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-bottom: 2px solid #ecf0f1;</span></span>
<span id="cb10-373"><a href="#cb10-373" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-374"><a href="#cb10-374" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb10-375"><a href="#cb10-375" aria-hidden="true" tabindex="-1"></a><span class="ss">        h3 </span><span class="ch">{{</span></span>
<span id="cb10-376"><a href="#cb10-376" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #16a085;</span></span>
<span id="cb10-377"><a href="#cb10-377" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin: 25px 0 10px 0;</span></span>
<span id="cb10-378"><a href="#cb10-378" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #f8f9fa;</span></span>
<span id="cb10-379"><a href="#cb10-379" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 12px 15px;</span></span>
<span id="cb10-380"><a href="#cb10-380" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 8px;</span></span>
<span id="cb10-381"><a href="#cb10-381" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-left: 4px solid #16a085;</span></span>
<span id="cb10-382"><a href="#cb10-382" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-383"><a href="#cb10-383" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb10-384"><a href="#cb10-384" aria-hidden="true" tabindex="-1"></a><span class="ss">        p </span><span class="ch">{{</span></span>
<span id="cb10-385"><a href="#cb10-385" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-bottom: 15px;</span></span>
<span id="cb10-386"><a href="#cb10-386" aria-hidden="true" tabindex="-1"></a><span class="ss">            text-align: justify;</span></span>
<span id="cb10-387"><a href="#cb10-387" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-388"><a href="#cb10-388" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb10-389"><a href="#cb10-389" aria-hidden="true" tabindex="-1"></a><span class="ss">        ul, ol </span><span class="ch">{{</span></span>
<span id="cb10-390"><a href="#cb10-390" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin: 15px 0;</span></span>
<span id="cb10-391"><a href="#cb10-391" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding-left: 30px;</span></span>
<span id="cb10-392"><a href="#cb10-392" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-393"><a href="#cb10-393" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb10-394"><a href="#cb10-394" aria-hidden="true" tabindex="-1"></a><span class="ss">        li </span><span class="ch">{{</span></span>
<span id="cb10-395"><a href="#cb10-395" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-bottom: 8px;</span></span>
<span id="cb10-396"><a href="#cb10-396" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-397"><a href="#cb10-397" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb10-398"><a href="#cb10-398" aria-hidden="true" tabindex="-1"></a><span class="ss">        strong </span><span class="ch">{{</span></span>
<span id="cb10-399"><a href="#cb10-399" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #2c3e50;</span></span>
<span id="cb10-400"><a href="#cb10-400" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-401"><a href="#cb10-401" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb10-402"><a href="#cb10-402" aria-hidden="true" tabindex="-1"></a><span class="ss">        .message-content </span><span class="ch">{{</span></span>
<span id="cb10-403"><a href="#cb10-403" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #f8f9fa;</span></span>
<span id="cb10-404"><a href="#cb10-404" aria-hidden="true" tabindex="-1"></a><span class="ss">            border: 1px solid #e9ecef;</span></span>
<span id="cb10-405"><a href="#cb10-405" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 8px;</span></span>
<span id="cb10-406"><a href="#cb10-406" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 20px;</span></span>
<span id="cb10-407"><a href="#cb10-407" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin: 15px 0;</span></span>
<span id="cb10-408"><a href="#cb10-408" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-left: 4px solid #667eea;</span></span>
<span id="cb10-409"><a href="#cb10-409" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-410"><a href="#cb10-410" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb10-411"><a href="#cb10-411" aria-hidden="true" tabindex="-1"></a><span class="ss">        .message-content pre </span><span class="ch">{{</span></span>
<span id="cb10-412"><a href="#cb10-412" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #2d3748;</span></span>
<span id="cb10-413"><a href="#cb10-413" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #e2e8f0;</span></span>
<span id="cb10-414"><a href="#cb10-414" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 15px;</span></span>
<span id="cb10-415"><a href="#cb10-415" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 6px;</span></span>
<span id="cb10-416"><a href="#cb10-416" aria-hidden="true" tabindex="-1"></a><span class="ss">            overflow-x: auto;</span></span>
<span id="cb10-417"><a href="#cb10-417" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin: 10px 0;</span></span>
<span id="cb10-418"><a href="#cb10-418" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-419"><a href="#cb10-419" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb10-420"><a href="#cb10-420" aria-hidden="true" tabindex="-1"></a><span class="ss">        .message-content code </span><span class="ch">{{</span></span>
<span id="cb10-421"><a href="#cb10-421" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #edf2f7;</span></span>
<span id="cb10-422"><a href="#cb10-422" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 2px 6px;</span></span>
<span id="cb10-423"><a href="#cb10-423" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 4px;</span></span>
<span id="cb10-424"><a href="#cb10-424" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-family: &#39;Courier New&#39;, monospace;</span></span>
<span id="cb10-425"><a href="#cb10-425" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-426"><a href="#cb10-426" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb10-427"><a href="#cb10-427" aria-hidden="true" tabindex="-1"></a><span class="ss">        .message-content pre code </span><span class="ch">{{</span></span>
<span id="cb10-428"><a href="#cb10-428" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: none;</span></span>
<span id="cb10-429"><a href="#cb10-429" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 0;</span></span>
<span id="cb10-430"><a href="#cb10-430" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-431"><a href="#cb10-431" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb10-432"><a href="#cb10-432" aria-hidden="true" tabindex="-1"></a><span class="ss">        .footer </span><span class="ch">{{</span></span>
<span id="cb10-433"><a href="#cb10-433" aria-hidden="true" tabindex="-1"></a><span class="ss">            text-align: center;</span></span>
<span id="cb10-434"><a href="#cb10-434" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 20px;</span></span>
<span id="cb10-435"><a href="#cb10-435" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #f8f9fa;</span></span>
<span id="cb10-436"><a href="#cb10-436" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #6c757d;</span></span>
<span id="cb10-437"><a href="#cb10-437" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-top: 1px solid #e9ecef;</span></span>
<span id="cb10-438"><a href="#cb10-438" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-top: 40px;</span></span>
<span id="cb10-439"><a href="#cb10-439" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-440"><a href="#cb10-440" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb10-441"><a href="#cb10-441" aria-hidden="true" tabindex="-1"></a><span class="ss">        .back-button </span><span class="ch">{{</span></span>
<span id="cb10-442"><a href="#cb10-442" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: inline-block;</span></span>
<span id="cb10-443"><a href="#cb10-443" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);</span></span>
<span id="cb10-444"><a href="#cb10-444" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: white;</span></span>
<span id="cb10-445"><a href="#cb10-445" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 12px 25px;</span></span>
<span id="cb10-446"><a href="#cb10-446" aria-hidden="true" tabindex="-1"></a><span class="ss">            text-decoration: none;</span></span>
<span id="cb10-447"><a href="#cb10-447" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 25px;</span></span>
<span id="cb10-448"><a href="#cb10-448" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-top: 20px;</span></span>
<span id="cb10-449"><a href="#cb10-449" aria-hidden="true" tabindex="-1"></a><span class="ss">            transition: transform 0.3s ease;</span></span>
<span id="cb10-450"><a href="#cb10-450" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-451"><a href="#cb10-451" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb10-452"><a href="#cb10-452" aria-hidden="true" tabindex="-1"></a><span class="ss">        .back-button:hover </span><span class="ch">{{</span></span>
<span id="cb10-453"><a href="#cb10-453" aria-hidden="true" tabindex="-1"></a><span class="ss">            transform: translateY(-2px);</span></span>
<span id="cb10-454"><a href="#cb10-454" aria-hidden="true" tabindex="-1"></a><span class="ss">            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);</span></span>
<span id="cb10-455"><a href="#cb10-455" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-456"><a href="#cb10-456" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb10-457"><a href="#cb10-457" aria-hidden="true" tabindex="-1"></a><span class="ss">        hr </span><span class="ch">{{</span></span>
<span id="cb10-458"><a href="#cb10-458" aria-hidden="true" tabindex="-1"></a><span class="ss">            border: none;</span></span>
<span id="cb10-459"><a href="#cb10-459" aria-hidden="true" tabindex="-1"></a><span class="ss">            height: 2px;</span></span>
<span id="cb10-460"><a href="#cb10-460" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: linear-gradient(90deg, transparent, #667eea, transparent);</span></span>
<span id="cb10-461"><a href="#cb10-461" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin: 30px 0;</span></span>
<span id="cb10-462"><a href="#cb10-462" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-463"><a href="#cb10-463" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb10-464"><a href="#cb10-464" aria-hidden="true" tabindex="-1"></a><span class="ss">        table </span><span class="ch">{{</span></span>
<span id="cb10-465"><a href="#cb10-465" aria-hidden="true" tabindex="-1"></a><span class="ss">            width: 100%;</span></span>
<span id="cb10-466"><a href="#cb10-466" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-collapse: collapse;</span></span>
<span id="cb10-467"><a href="#cb10-467" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin: 20px 0;</span></span>
<span id="cb10-468"><a href="#cb10-468" aria-hidden="true" tabindex="-1"></a><span class="ss">            box-shadow: 0 2px 10px rgba(0,0,0,0.1);</span></span>
<span id="cb10-469"><a href="#cb10-469" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-470"><a href="#cb10-470" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb10-471"><a href="#cb10-471" aria-hidden="true" tabindex="-1"></a><span class="ss">        th, td </span><span class="ch">{{</span></span>
<span id="cb10-472"><a href="#cb10-472" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 12px 15px;</span></span>
<span id="cb10-473"><a href="#cb10-473" aria-hidden="true" tabindex="-1"></a><span class="ss">            text-align: left;</span></span>
<span id="cb10-474"><a href="#cb10-474" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-bottom: 1px solid #e9ecef;</span></span>
<span id="cb10-475"><a href="#cb10-475" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-476"><a href="#cb10-476" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb10-477"><a href="#cb10-477" aria-hidden="true" tabindex="-1"></a><span class="ss">        th </span><span class="ch">{{</span></span>
<span id="cb10-478"><a href="#cb10-478" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #667eea;</span></span>
<span id="cb10-479"><a href="#cb10-479" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: white;</span></span>
<span id="cb10-480"><a href="#cb10-480" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-weight: 600;</span></span>
<span id="cb10-481"><a href="#cb10-481" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-482"><a href="#cb10-482" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb10-483"><a href="#cb10-483" aria-hidden="true" tabindex="-1"></a><span class="ss">        tr:nth-child(even) </span><span class="ch">{{</span></span>
<span id="cb10-484"><a href="#cb10-484" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #f8f9fa;</span></span>
<span id="cb10-485"><a href="#cb10-485" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-486"><a href="#cb10-486" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb10-487"><a href="#cb10-487" aria-hidden="true" tabindex="-1"></a><span class="ss">        @media (max-width: 768px) </span><span class="ch">{{</span></span>
<span id="cb10-488"><a href="#cb10-488" aria-hidden="true" tabindex="-1"></a><span class="ss">            .container </span><span class="ch">{{</span></span>
<span id="cb10-489"><a href="#cb10-489" aria-hidden="true" tabindex="-1"></a><span class="ss">                margin: 10px;</span></span>
<span id="cb10-490"><a href="#cb10-490" aria-hidden="true" tabindex="-1"></a><span class="ss">                border-radius: 10px;</span></span>
<span id="cb10-491"><a href="#cb10-491" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span><span class="ch">}}</span></span>
<span id="cb10-492"><a href="#cb10-492" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span></span>
<span id="cb10-493"><a href="#cb10-493" aria-hidden="true" tabindex="-1"></a><span class="ss">            .content </span><span class="ch">{{</span></span>
<span id="cb10-494"><a href="#cb10-494" aria-hidden="true" tabindex="-1"></a><span class="ss">                padding: 20px;</span></span>
<span id="cb10-495"><a href="#cb10-495" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span><span class="ch">}}</span></span>
<span id="cb10-496"><a href="#cb10-496" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span></span>
<span id="cb10-497"><a href="#cb10-497" aria-hidden="true" tabindex="-1"></a><span class="ss">            .header h1 </span><span class="ch">{{</span></span>
<span id="cb10-498"><a href="#cb10-498" aria-hidden="true" tabindex="-1"></a><span class="ss">                font-size: 2em;</span></span>
<span id="cb10-499"><a href="#cb10-499" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span><span class="ch">}}</span></span>
<span id="cb10-500"><a href="#cb10-500" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-501"><a href="#cb10-501" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;/style&gt;</span></span>
<span id="cb10-502"><a href="#cb10-502" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;/head&gt;</span></span>
<span id="cb10-503"><a href="#cb10-503" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;body&gt;</span></span>
<span id="cb10-504"><a href="#cb10-504" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;div class=&quot;container&quot;&gt;</span></span>
<span id="cb10-505"><a href="#cb10-505" aria-hidden="true" tabindex="-1"></a><span class="ss">        &lt;div class=&quot;header&quot;&gt;</span></span>
<span id="cb10-506"><a href="#cb10-506" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;h1&gt;</span><span class="sc">{</span>conversation[<span class="st">&#39;title&#39;</span>]<span class="sc">}</span><span class="ss">&lt;/h1&gt;</span></span>
<span id="cb10-507"><a href="#cb10-507" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;div class=&quot;meta&quot;&gt;</span></span>
<span id="cb10-508"><a href="#cb10-508" aria-hidden="true" tabindex="-1"></a><span class="ss">                #</span><span class="sc">{</span>conversation[<span class="st">&#39;number&#39;</span>]<span class="sc">}</span><span class="ss"> ‚Ä¢ </span><span class="sc">{</span>conversation[<span class="st">&#39;source&#39;</span>]<span class="sc">}</span><span class="ss"> ‚Ä¢ </span><span class="sc">{</span>conversation[<span class="st">&#39;category&#39;</span>]<span class="sc">}</span></span>
<span id="cb10-509"><a href="#cb10-509" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;/div&gt;</span></span>
<span id="cb10-510"><a href="#cb10-510" aria-hidden="true" tabindex="-1"></a><span class="ss">        &lt;/div&gt;</span></span>
<span id="cb10-511"><a href="#cb10-511" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb10-512"><a href="#cb10-512" aria-hidden="true" tabindex="-1"></a><span class="ss">        &lt;div class=&quot;content&quot;&gt;</span></span>
<span id="cb10-513"><a href="#cb10-513" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span><span class="sc">{</span>html_content<span class="sc">}</span></span>
<span id="cb10-514"><a href="#cb10-514" aria-hidden="true" tabindex="-1"></a><span class="ss">        &lt;/div&gt;</span></span>
<span id="cb10-515"><a href="#cb10-515" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb10-516"><a href="#cb10-516" aria-hidden="true" tabindex="-1"></a><span class="ss">        &lt;div class=&quot;footer&quot;&gt;</span></span>
<span id="cb10-517"><a href="#cb10-517" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;p&gt;Conversa exportada do </span><span class="sc">{</span>conversation[<span class="st">&#39;source&#39;</span>]<span class="sc">}</span><span class="ss"> ‚Ä¢ Processado em </span><span class="sc">{</span>datetime<span class="sc">.</span>now()<span class="sc">.</span>strftime(<span class="st">&#39;</span><span class="sc">%d</span><span class="st">/%m/%Y %H:%M&#39;</span>)<span class="sc">}</span><span class="ss">&lt;/p&gt;</span></span>
<span id="cb10-518"><a href="#cb10-518" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;a href=&quot;../index.html&quot; class=&quot;back-button&quot;&gt;‚Üê Voltar ao √çndice&lt;/a&gt;</span></span>
<span id="cb10-519"><a href="#cb10-519" aria-hidden="true" tabindex="-1"></a><span class="ss">        &lt;/div&gt;</span></span>
<span id="cb10-520"><a href="#cb10-520" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;/div&gt;</span></span>
<span id="cb10-521"><a href="#cb10-521" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;/body&gt;</span></span>
<span id="cb10-522"><a href="#cb10-522" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;/html&gt;&quot;&quot;&quot;</span></span>
<span id="cb10-523"><a href="#cb10-523" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-524"><a href="#cb10-524" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> html_template</span>
<span id="cb10-525"><a href="#cb10-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-526"><a href="#cb10-526" aria-hidden="true" tabindex="-1"></a>    <span class="co"># M√âTODOS DE PROCESSAMENTO (mantidos do original)</span></span>
<span id="cb10-527"><a href="#cb10-527" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> process_qwen_enhanced(<span class="va">self</span>, path: Path):</span>
<span id="cb10-528"><a href="#cb10-528" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Processa Qwen3 com preserva√ß√£o total de conte√∫do&quot;&quot;&quot;</span></span>
<span id="cb10-529"><a href="#cb10-529" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb10-530"><a href="#cb10-530" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;üß™ [DRY-RUN] Processaria Qwen3: </span><span class="sc">{</span>path<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb10-531"><a href="#cb10-531" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb10-532"><a href="#cb10-532" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb10-533"><a href="#cb10-533" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb10-534"><a href="#cb10-534" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(path, <span class="st">&#39;r&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb10-535"><a href="#cb10-535" aria-hidden="true" tabindex="-1"></a>                raw <span class="op">=</span> json.load(f)</span>
<span id="cb10-536"><a href="#cb10-536" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb10-537"><a href="#cb10-537" aria-hidden="true" tabindex="-1"></a>            data <span class="op">=</span> raw.get(<span class="st">&#39;data&#39;</span>, [])</span>
<span id="cb10-538"><a href="#cb10-538" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(data, <span class="bu">list</span>):</span>
<span id="cb10-539"><a href="#cb10-539" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;‚ö†Ô∏è  Qwen3: &#39;data&#39; n√£o √© uma lista.&quot;</span>)</span>
<span id="cb10-540"><a href="#cb10-540" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span></span>
<span id="cb10-541"><a href="#cb10-541" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb10-542"><a href="#cb10-542" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;üîç Qwen3: encontradas </span><span class="sc">{</span><span class="bu">len</span>(data)<span class="sc">}</span><span class="ss"> conversas.&quot;</span>)</span>
<span id="cb10-543"><a href="#cb10-543" aria-hidden="true" tabindex="-1"></a>            processed_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb10-544"><a href="#cb10-544" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb10-545"><a href="#cb10-545" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> i, conv <span class="kw">in</span> <span class="bu">enumerate</span>(data):</span>
<span id="cb10-546"><a href="#cb10-546" aria-hidden="true" tabindex="-1"></a>                title <span class="op">=</span> conv.get(<span class="st">&#39;title&#39;</span>, <span class="ss">f&#39;Conversa_Qwen_</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb10-547"><a href="#cb10-547" aria-hidden="true" tabindex="-1"></a>                title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(title)</span>
<span id="cb10-548"><a href="#cb10-548" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb10-549"><a href="#cb10-549" aria-hidden="true" tabindex="-1"></a>                history <span class="op">=</span> conv.get(<span class="st">&#39;chat&#39;</span>, {}).get(<span class="st">&#39;history&#39;</span>, {})</span>
<span id="cb10-550"><a href="#cb10-550" aria-hidden="true" tabindex="-1"></a>                messages <span class="op">=</span> []</span>
<span id="cb10-551"><a href="#cb10-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-552"><a href="#cb10-552" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="kw">not</span> history:</span>
<span id="cb10-553"><a href="#cb10-553" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">continue</span></span>
<span id="cb10-554"><a href="#cb10-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-555"><a href="#cb10-555" aria-hidden="true" tabindex="-1"></a>                messages_dict <span class="op">=</span> history.get(<span class="st">&#39;messages&#39;</span>, {})</span>
<span id="cb10-556"><a href="#cb10-556" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb10-557"><a href="#cb10-557" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(messages_dict, <span class="bu">dict</span>):</span>
<span id="cb10-558"><a href="#cb10-558" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">continue</span></span>
<span id="cb10-559"><a href="#cb10-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-560"><a href="#cb10-560" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;   üìù Conversa </span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">: &#39;</span><span class="sc">{</span>title<span class="sc">}</span><span class="ss">&#39; - </span><span class="sc">{</span><span class="bu">len</span>(messages_dict)<span class="sc">}</span><span class="ss"> mensagens&quot;</span>)</span>
<span id="cb10-561"><a href="#cb10-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-562"><a href="#cb10-562" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> message_id, message_data <span class="kw">in</span> messages_dict.items():</span>
<span id="cb10-563"><a href="#cb10-563" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(message_data, <span class="bu">dict</span>):</span>
<span id="cb10-564"><a href="#cb10-564" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb10-565"><a href="#cb10-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-566"><a href="#cb10-566" aria-hidden="true" tabindex="-1"></a>                    role <span class="op">=</span> message_data.get(<span class="st">&#39;role&#39;</span>, <span class="st">&#39;&#39;</span>)</span>
<span id="cb10-567"><a href="#cb10-567" aria-hidden="true" tabindex="-1"></a>                    content <span class="op">=</span> message_data.get(<span class="st">&#39;content&#39;</span>, <span class="st">&#39;&#39;</span>)</span>
<span id="cb10-568"><a href="#cb10-568" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb10-569"><a href="#cb10-569" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="kw">not</span> content <span class="kw">or</span> <span class="kw">not</span> role:</span>
<span id="cb10-570"><a href="#cb10-570" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb10-571"><a href="#cb10-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-572"><a href="#cb10-572" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> role <span class="op">==</span> <span class="st">&#39;user&#39;</span>:</span>
<span id="cb10-573"><a href="#cb10-573" aria-hidden="true" tabindex="-1"></a>                        author <span class="op">=</span> <span class="st">&quot;üë§ Utilizador&quot;</span></span>
<span id="cb10-574"><a href="#cb10-574" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">elif</span> role <span class="op">==</span> <span class="st">&#39;assistant&#39;</span>:</span>
<span id="cb10-575"><a href="#cb10-575" aria-hidden="true" tabindex="-1"></a>                        author <span class="op">=</span> <span class="st">&quot;ü§ñ Qwen3&quot;</span></span>
<span id="cb10-576"><a href="#cb10-576" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">else</span>:</span>
<span id="cb10-577"><a href="#cb10-577" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb10-578"><a href="#cb10-578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-579"><a href="#cb10-579" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="bu">isinstance</span>(content, <span class="bu">list</span>):</span>
<span id="cb10-580"><a href="#cb10-580" aria-hidden="true" tabindex="-1"></a>                        text_parts <span class="op">=</span> []</span>
<span id="cb10-581"><a href="#cb10-581" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">for</span> block <span class="kw">in</span> content:</span>
<span id="cb10-582"><a href="#cb10-582" aria-hidden="true" tabindex="-1"></a>                            <span class="cf">if</span> <span class="bu">isinstance</span>(block, <span class="bu">dict</span>):</span>
<span id="cb10-583"><a href="#cb10-583" aria-hidden="true" tabindex="-1"></a>                                <span class="cf">if</span> block.get(<span class="st">&#39;type&#39;</span>) <span class="op">==</span> <span class="st">&#39;text&#39;</span>:</span>
<span id="cb10-584"><a href="#cb10-584" aria-hidden="true" tabindex="-1"></a>                                    text_parts.append(block.get(<span class="st">&#39;text&#39;</span>, <span class="st">&#39;&#39;</span>))</span>
<span id="cb10-585"><a href="#cb10-585" aria-hidden="true" tabindex="-1"></a>                                <span class="cf">elif</span> block.get(<span class="st">&#39;type&#39;</span>) <span class="op">==</span> <span class="st">&#39;image&#39;</span>:</span>
<span id="cb10-586"><a href="#cb10-586" aria-hidden="true" tabindex="-1"></a>                                    image_info <span class="op">=</span> block.get(<span class="st">&#39;image&#39;</span>, <span class="st">&#39;&#39;</span>)</span>
<span id="cb10-587"><a href="#cb10-587" aria-hidden="true" tabindex="-1"></a>                                    <span class="cf">if</span> image_info:</span>
<span id="cb10-588"><a href="#cb10-588" aria-hidden="true" tabindex="-1"></a>                                        text_parts.append(<span class="ss">f&quot;![Imagem](</span><span class="sc">{</span>image_info<span class="sc">}</span><span class="ss">)&quot;</span>)</span>
<span id="cb10-589"><a href="#cb10-589" aria-hidden="true" tabindex="-1"></a>                            <span class="cf">elif</span> <span class="bu">isinstance</span>(block, <span class="bu">str</span>):</span>
<span id="cb10-590"><a href="#cb10-590" aria-hidden="true" tabindex="-1"></a>                                text_parts.append(block)</span>
<span id="cb10-591"><a href="#cb10-591" aria-hidden="true" tabindex="-1"></a>                        final_content <span class="op">=</span> <span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>.join(text_parts).strip()</span>
<span id="cb10-592"><a href="#cb10-592" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">else</span>:</span>
<span id="cb10-593"><a href="#cb10-593" aria-hidden="true" tabindex="-1"></a>                        final_content <span class="op">=</span> <span class="bu">str</span>(content).strip()</span>
<span id="cb10-594"><a href="#cb10-594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-595"><a href="#cb10-595" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># APLICA PRESERVA√á√ÉO</span></span>
<span id="cb10-596"><a href="#cb10-596" aria-hidden="true" tabindex="-1"></a>                    final_content <span class="op">=</span> <span class="va">self</span>.preserve_special_content(final_content)</span>
<span id="cb10-597"><a href="#cb10-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-598"><a href="#cb10-598" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="kw">not</span> final_content <span class="kw">or</span> final_content <span class="op">==</span> <span class="st">&#39;null&#39;</span>:</span>
<span id="cb10-599"><a href="#cb10-599" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb10-600"><a href="#cb10-600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-601"><a href="#cb10-601" aria-hidden="true" tabindex="-1"></a>                    messages.append({</span>
<span id="cb10-602"><a href="#cb10-602" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;author&#39;</span>: author,</span>
<span id="cb10-603"><a href="#cb10-603" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;role&#39;</span>: role,</span>
<span id="cb10-604"><a href="#cb10-604" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;content&#39;</span>: final_content,</span>
<span id="cb10-605"><a href="#cb10-605" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;timestamp&#39;</span>: <span class="va">self</span>.format_timestamp(message_data.get(<span class="st">&#39;created_at&#39;</span>)),</span>
<span id="cb10-606"><a href="#cb10-606" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;model&#39;</span>: message_data.get(<span class="st">&#39;model&#39;</span>, <span class="st">&#39;Qwen3&#39;</span>)</span>
<span id="cb10-607"><a href="#cb10-607" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb10-608"><a href="#cb10-608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-609"><a href="#cb10-609" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> messages:</span>
<span id="cb10-610"><a href="#cb10-610" aria-hidden="true" tabindex="-1"></a>                    messages.sort(key<span class="op">=</span><span class="kw">lambda</span> x: <span class="va">self</span>.parse_timestamp_for_sorting(x[<span class="st">&#39;timestamp&#39;</span>]))</span>
<span id="cb10-611"><a href="#cb10-611" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb10-612"><a href="#cb10-612" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.all_conversations.append({</span>
<span id="cb10-613"><a href="#cb10-613" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;title&#39;</span>: title,</span>
<span id="cb10-614"><a href="#cb10-614" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;source&#39;</span>: <span class="st">&#39;Qwen3&#39;</span>,</span>
<span id="cb10-615"><a href="#cb10-615" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;id&#39;</span>: conv.get(<span class="st">&#39;id&#39;</span>, <span class="ss">f&#39;qwen_</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">&#39;</span>),</span>
<span id="cb10-616"><a href="#cb10-616" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;inserted_at&#39;</span>: <span class="va">self</span>.format_timestamp(conv.get(<span class="st">&#39;created_at&#39;</span>)),</span>
<span id="cb10-617"><a href="#cb10-617" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;updated_at&#39;</span>: <span class="va">self</span>.format_timestamp(conv.get(<span class="st">&#39;updated_at&#39;</span>)),</span>
<span id="cb10-618"><a href="#cb10-618" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;messages&#39;</span>: messages,</span>
<span id="cb10-619"><a href="#cb10-619" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;summary&#39;</span>: messages[<span class="dv">0</span>][<span class="st">&#39;content&#39;</span>][:<span class="dv">100</span>] <span class="op">+</span> <span class="st">&quot;...&quot;</span> <span class="cf">if</span> messages <span class="cf">else</span> <span class="st">&quot;Sem conte√∫do&quot;</span>,</span>
<span id="cb10-620"><a href="#cb10-620" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;category&#39;</span>: <span class="st">&#39;Geral&#39;</span></span>
<span id="cb10-621"><a href="#cb10-621" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb10-622"><a href="#cb10-622" aria-hidden="true" tabindex="-1"></a>                    processed_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb10-623"><a href="#cb10-623" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="ss">f&quot;   ‚úÖ Adicionada: </span><span class="sc">{</span><span class="bu">len</span>(messages)<span class="sc">}</span><span class="ss"> mensagens&quot;</span>)</span>
<span id="cb10-624"><a href="#cb10-624" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb10-625"><a href="#cb10-625" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ Qwen3: </span><span class="sc">{</span>processed_count<span class="sc">}</span><span class="ss"> conversas processadas.&quot;</span>)</span>
<span id="cb10-626"><a href="#cb10-626" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb10-627"><a href="#cb10-627" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb10-628"><a href="#cb10-628" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚ùå Erro ao processar Qwen3: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb10-629"><a href="#cb10-629" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb10-630"><a href="#cb10-630" aria-hidden="true" tabindex="-1"></a>                traceback.print_exc()</span>
<span id="cb10-631"><a href="#cb10-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-632"><a href="#cb10-632" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> process_chatgpt(<span class="va">self</span>, path: Path):</span>
<span id="cb10-633"><a href="#cb10-633" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Processa exporta√ß√£o do ChatGPT&quot;&quot;&quot;</span></span>
<span id="cb10-634"><a href="#cb10-634" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb10-635"><a href="#cb10-635" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;üß™ [DRY-RUN] Processaria ChatGPT: </span><span class="sc">{</span>path<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb10-636"><a href="#cb10-636" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb10-637"><a href="#cb10-637" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb10-638"><a href="#cb10-638" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb10-639"><a href="#cb10-639" aria-hidden="true" tabindex="-1"></a>            temp_dir <span class="op">=</span> tempfile.mkdtemp(prefix<span class="op">=</span><span class="st">&quot;chatgpt_&quot;</span>)</span>
<span id="cb10-640"><a href="#cb10-640" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> zipfile.ZipFile(path, <span class="st">&#39;r&#39;</span>) <span class="im">as</span> z:</span>
<span id="cb10-641"><a href="#cb10-641" aria-hidden="true" tabindex="-1"></a>                z.extractall(temp_dir)</span>
<span id="cb10-642"><a href="#cb10-642" aria-hidden="true" tabindex="-1"></a>            convs_path <span class="op">=</span> Path(temp_dir) <span class="op">/</span> <span class="st">&quot;conversations.json&quot;</span></span>
<span id="cb10-643"><a href="#cb10-643" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> convs_path.exists():</span>
<span id="cb10-644"><a href="#cb10-644" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;‚ùå ChatGPT: conversations.json n√£o encontrado.&quot;</span>)</span>
<span id="cb10-645"><a href="#cb10-645" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span></span>
<span id="cb10-646"><a href="#cb10-646" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb10-647"><a href="#cb10-647" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(convs_path, <span class="st">&#39;r&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb10-648"><a href="#cb10-648" aria-hidden="true" tabindex="-1"></a>                data <span class="op">=</span> json.load(f)</span>
<span id="cb10-649"><a href="#cb10-649" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb10-650"><a href="#cb10-650" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(data, <span class="bu">list</span>):</span>
<span id="cb10-651"><a href="#cb10-651" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;‚ö†Ô∏è  ChatGPT: estrutura inesperada.&quot;</span>)</span>
<span id="cb10-652"><a href="#cb10-652" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span></span>
<span id="cb10-653"><a href="#cb10-653" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb10-654"><a href="#cb10-654" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;üîç ChatGPT: encontradas </span><span class="sc">{</span><span class="bu">len</span>(data)<span class="sc">}</span><span class="ss"> conversas.&quot;</span>)</span>
<span id="cb10-655"><a href="#cb10-655" aria-hidden="true" tabindex="-1"></a>            processed_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb10-656"><a href="#cb10-656" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb10-657"><a href="#cb10-657" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> i, conv <span class="kw">in</span> <span class="bu">enumerate</span>(data):</span>
<span id="cb10-658"><a href="#cb10-658" aria-hidden="true" tabindex="-1"></a>                title <span class="op">=</span> conv.get(<span class="st">&#39;title&#39;</span>, <span class="ss">f&#39;Conversa_ChatGPT_</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb10-659"><a href="#cb10-659" aria-hidden="true" tabindex="-1"></a>                title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(title)</span>
<span id="cb10-660"><a href="#cb10-660" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb10-661"><a href="#cb10-661" aria-hidden="true" tabindex="-1"></a>                messages <span class="op">=</span> []</span>
<span id="cb10-662"><a href="#cb10-662" aria-hidden="true" tabindex="-1"></a>                mapping <span class="op">=</span> conv.get(<span class="st">&#39;mapping&#39;</span>, {})</span>
<span id="cb10-663"><a href="#cb10-663" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb10-664"><a href="#cb10-664" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> msg_id, node <span class="kw">in</span> mapping.items():</span>
<span id="cb10-665"><a href="#cb10-665" aria-hidden="true" tabindex="-1"></a>                    msg_data <span class="op">=</span> node.get(<span class="st">&#39;message&#39;</span>)</span>
<span id="cb10-666"><a href="#cb10-666" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="kw">not</span> msg_data <span class="kw">or</span> <span class="kw">not</span> <span class="bu">isinstance</span>(msg_data, <span class="bu">dict</span>):</span>
<span id="cb10-667"><a href="#cb10-667" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb10-668"><a href="#cb10-668" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb10-669"><a href="#cb10-669" aria-hidden="true" tabindex="-1"></a>                    author_role <span class="op">=</span> msg_data.get(<span class="st">&#39;author&#39;</span>, {}).get(<span class="st">&#39;role&#39;</span>, <span class="st">&#39;&#39;</span>)</span>
<span id="cb10-670"><a href="#cb10-670" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> author_role <span class="op">==</span> <span class="st">&#39;user&#39;</span>:</span>
<span id="cb10-671"><a href="#cb10-671" aria-hidden="true" tabindex="-1"></a>                        author <span class="op">=</span> <span class="st">&quot;üë§ Utilizador&quot;</span></span>
<span id="cb10-672"><a href="#cb10-672" aria-hidden="true" tabindex="-1"></a>                        role <span class="op">=</span> <span class="st">&#39;user&#39;</span></span>
<span id="cb10-673"><a href="#cb10-673" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">elif</span> author_role <span class="op">==</span> <span class="st">&#39;assistant&#39;</span>:</span>
<span id="cb10-674"><a href="#cb10-674" aria-hidden="true" tabindex="-1"></a>                        author <span class="op">=</span> <span class="st">&quot;ü§ñ ChatGPT&quot;</span></span>
<span id="cb10-675"><a href="#cb10-675" aria-hidden="true" tabindex="-1"></a>                        role <span class="op">=</span> <span class="st">&#39;assistant&#39;</span></span>
<span id="cb10-676"><a href="#cb10-676" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">else</span>:</span>
<span id="cb10-677"><a href="#cb10-677" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb10-678"><a href="#cb10-678" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb10-679"><a href="#cb10-679" aria-hidden="true" tabindex="-1"></a>                    content_parts <span class="op">=</span> []</span>
<span id="cb10-680"><a href="#cb10-680" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">for</span> part <span class="kw">in</span> msg_data.get(<span class="st">&#39;content&#39;</span>, {}).get(<span class="st">&#39;parts&#39;</span>, []):</span>
<span id="cb10-681"><a href="#cb10-681" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">if</span> <span class="bu">isinstance</span>(part, <span class="bu">str</span>):</span>
<span id="cb10-682"><a href="#cb10-682" aria-hidden="true" tabindex="-1"></a>                            content_parts.append(part)</span>
<span id="cb10-683"><a href="#cb10-683" aria-hidden="true" tabindex="-1"></a>                    content <span class="op">=</span> <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>.join(content_parts).strip()</span>
<span id="cb10-684"><a href="#cb10-684" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb10-685"><a href="#cb10-685" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># APLICA PRESERVA√á√ÉO</span></span>
<span id="cb10-686"><a href="#cb10-686" aria-hidden="true" tabindex="-1"></a>                    content <span class="op">=</span> <span class="va">self</span>.preserve_special_content(content)</span>
<span id="cb10-687"><a href="#cb10-687" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb10-688"><a href="#cb10-688" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="kw">not</span> content:</span>
<span id="cb10-689"><a href="#cb10-689" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb10-690"><a href="#cb10-690" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb10-691"><a href="#cb10-691" aria-hidden="true" tabindex="-1"></a>                    messages.append({</span>
<span id="cb10-692"><a href="#cb10-692" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;author&#39;</span>: author,</span>
<span id="cb10-693"><a href="#cb10-693" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;role&#39;</span>: role,</span>
<span id="cb10-694"><a href="#cb10-694" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;content&#39;</span>: content,</span>
<span id="cb10-695"><a href="#cb10-695" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;timestamp&#39;</span>: <span class="va">self</span>.format_timestamp(msg_data.get(<span class="st">&#39;create_time&#39;</span>)),</span>
<span id="cb10-696"><a href="#cb10-696" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;model&#39;</span>: msg_data.get(<span class="st">&#39;model&#39;</span>, <span class="st">&#39;ChatGPT&#39;</span>)</span>
<span id="cb10-697"><a href="#cb10-697" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb10-698"><a href="#cb10-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-699"><a href="#cb10-699" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> messages:</span>
<span id="cb10-700"><a href="#cb10-700" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.all_conversations.append({</span>
<span id="cb10-701"><a href="#cb10-701" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;title&#39;</span>: title,</span>
<span id="cb10-702"><a href="#cb10-702" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;source&#39;</span>: <span class="st">&#39;ChatGPT&#39;</span>,</span>
<span id="cb10-703"><a href="#cb10-703" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;id&#39;</span>: conv.get(<span class="st">&#39;id&#39;</span>, <span class="ss">f&#39;chatgpt_</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">&#39;</span>),</span>
<span id="cb10-704"><a href="#cb10-704" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;inserted_at&#39;</span>: <span class="va">self</span>.format_timestamp(conv.get(<span class="st">&#39;create_time&#39;</span>)),</span>
<span id="cb10-705"><a href="#cb10-705" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;updated_at&#39;</span>: <span class="va">self</span>.format_timestamp(conv.get(<span class="st">&#39;update_time&#39;</span>)),</span>
<span id="cb10-706"><a href="#cb10-706" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;messages&#39;</span>: messages,</span>
<span id="cb10-707"><a href="#cb10-707" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;summary&#39;</span>: messages[<span class="dv">0</span>][<span class="st">&#39;content&#39;</span>][:<span class="dv">100</span>] <span class="op">+</span> <span class="st">&quot;...&quot;</span> <span class="cf">if</span> messages <span class="cf">else</span> <span class="st">&quot;Sem conte√∫do&quot;</span>,</span>
<span id="cb10-708"><a href="#cb10-708" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;category&#39;</span>: <span class="st">&#39;Geral&#39;</span></span>
<span id="cb10-709"><a href="#cb10-709" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb10-710"><a href="#cb10-710" aria-hidden="true" tabindex="-1"></a>                    processed_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb10-711"><a href="#cb10-711" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb10-712"><a href="#cb10-712" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ ChatGPT: </span><span class="sc">{</span>processed_count<span class="sc">}</span><span class="ss"> conversas processadas.&quot;</span>)</span>
<span id="cb10-713"><a href="#cb10-713" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb10-714"><a href="#cb10-714" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb10-715"><a href="#cb10-715" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚ùå Erro ao processar ChatGPT: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb10-716"><a href="#cb10-716" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb10-717"><a href="#cb10-717" aria-hidden="true" tabindex="-1"></a>                traceback.print_exc()</span>
<span id="cb10-718"><a href="#cb10-718" aria-hidden="true" tabindex="-1"></a>        <span class="cf">finally</span>:</span>
<span id="cb10-719"><a href="#cb10-719" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="st">&#39;temp_dir&#39;</span> <span class="kw">in</span> <span class="bu">locals</span>():</span>
<span id="cb10-720"><a href="#cb10-720" aria-hidden="true" tabindex="-1"></a>                shutil.rmtree(temp_dir, ignore_errors<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb10-721"><a href="#cb10-721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-722"><a href="#cb10-722" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> process_deepseek(<span class="va">self</span>, path: Path):</span>
<span id="cb10-723"><a href="#cb10-723" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Processa exporta√ß√£o do DeepSeek&quot;&quot;&quot;</span></span>
<span id="cb10-724"><a href="#cb10-724" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb10-725"><a href="#cb10-725" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;üß™ [DRY-RUN] Processaria DeepSeek: </span><span class="sc">{</span>path<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb10-726"><a href="#cb10-726" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb10-727"><a href="#cb10-727" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb10-728"><a href="#cb10-728" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb10-729"><a href="#cb10-729" aria-hidden="true" tabindex="-1"></a>            temp_dir <span class="op">=</span> tempfile.mkdtemp(prefix<span class="op">=</span><span class="st">&quot;deepseek_&quot;</span>)</span>
<span id="cb10-730"><a href="#cb10-730" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> zipfile.ZipFile(path, <span class="st">&#39;r&#39;</span>) <span class="im">as</span> z:</span>
<span id="cb10-731"><a href="#cb10-731" aria-hidden="true" tabindex="-1"></a>                z.extractall(temp_dir)</span>
<span id="cb10-732"><a href="#cb10-732" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb10-733"><a href="#cb10-733" aria-hidden="true" tabindex="-1"></a>            convs_path <span class="op">=</span> Path(temp_dir) <span class="op">/</span> <span class="st">&quot;conversations.json&quot;</span></span>
<span id="cb10-734"><a href="#cb10-734" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> convs_path.exists():</span>
<span id="cb10-735"><a href="#cb10-735" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;‚ùå DeepSeek: conversations.json n√£o encontrado.&quot;</span>)</span>
<span id="cb10-736"><a href="#cb10-736" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span></span>
<span id="cb10-737"><a href="#cb10-737" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb10-738"><a href="#cb10-738" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(convs_path, <span class="st">&#39;r&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb10-739"><a href="#cb10-739" aria-hidden="true" tabindex="-1"></a>                raw_data <span class="op">=</span> json.load(f)</span>
<span id="cb10-740"><a href="#cb10-740" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb10-741"><a href="#cb10-741" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">isinstance</span>(raw_data, <span class="bu">list</span>):</span>
<span id="cb10-742"><a href="#cb10-742" aria-hidden="true" tabindex="-1"></a>                data <span class="op">=</span> raw_data</span>
<span id="cb10-743"><a href="#cb10-743" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> <span class="bu">isinstance</span>(raw_data, <span class="bu">dict</span>) <span class="kw">and</span> <span class="st">&#39;data&#39;</span> <span class="kw">in</span> raw_data:</span>
<span id="cb10-744"><a href="#cb10-744" aria-hidden="true" tabindex="-1"></a>                data <span class="op">=</span> raw_data[<span class="st">&#39;data&#39;</span>]</span>
<span id="cb10-745"><a href="#cb10-745" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb10-746"><a href="#cb10-746" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;‚ö†Ô∏è  DeepSeek: estrutura inesperada.&quot;</span>)</span>
<span id="cb10-747"><a href="#cb10-747" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span></span>
<span id="cb10-748"><a href="#cb10-748" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb10-749"><a href="#cb10-749" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(data, <span class="bu">list</span>):</span>
<span id="cb10-750"><a href="#cb10-750" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;‚ö†Ô∏è  DeepSeek: &#39;data&#39; n√£o √© uma lista.&quot;</span>)</span>
<span id="cb10-751"><a href="#cb10-751" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span></span>
<span id="cb10-752"><a href="#cb10-752" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb10-753"><a href="#cb10-753" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;üîç DeepSeek: encontradas </span><span class="sc">{</span><span class="bu">len</span>(data)<span class="sc">}</span><span class="ss"> conversas.&quot;</span>)</span>
<span id="cb10-754"><a href="#cb10-754" aria-hidden="true" tabindex="-1"></a>            processed_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb10-755"><a href="#cb10-755" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb10-756"><a href="#cb10-756" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> i, conv <span class="kw">in</span> <span class="bu">enumerate</span>(data):</span>
<span id="cb10-757"><a href="#cb10-757" aria-hidden="true" tabindex="-1"></a>                title <span class="op">=</span> conv.get(<span class="st">&#39;title&#39;</span>, <span class="ss">f&#39;Conversa_DeepSeek_</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb10-758"><a href="#cb10-758" aria-hidden="true" tabindex="-1"></a>                title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(title)</span>
<span id="cb10-759"><a href="#cb10-759" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb10-760"><a href="#cb10-760" aria-hidden="true" tabindex="-1"></a>                messages <span class="op">=</span> []</span>
<span id="cb10-761"><a href="#cb10-761" aria-hidden="true" tabindex="-1"></a>                mapping <span class="op">=</span> conv.get(<span class="st">&#39;mapping&#39;</span>, {})</span>
<span id="cb10-762"><a href="#cb10-762" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb10-763"><a href="#cb10-763" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> node_id, node <span class="kw">in</span> mapping.items():</span>
<span id="cb10-764"><a href="#cb10-764" aria-hidden="true" tabindex="-1"></a>                    msg_data <span class="op">=</span> node.get(<span class="st">&#39;message&#39;</span>)</span>
<span id="cb10-765"><a href="#cb10-765" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="kw">not</span> msg_data <span class="kw">or</span> <span class="kw">not</span> <span class="bu">isinstance</span>(msg_data, <span class="bu">dict</span>):</span>
<span id="cb10-766"><a href="#cb10-766" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb10-767"><a href="#cb10-767" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb10-768"><a href="#cb10-768" aria-hidden="true" tabindex="-1"></a>                    fragments <span class="op">=</span> msg_data.get(<span class="st">&#39;fragments&#39;</span>, [])</span>
<span id="cb10-769"><a href="#cb10-769" aria-hidden="true" tabindex="-1"></a>                    content_parts <span class="op">=</span> []</span>
<span id="cb10-770"><a href="#cb10-770" aria-hidden="true" tabindex="-1"></a>                    msg_type <span class="op">=</span> <span class="va">None</span></span>
<span id="cb10-771"><a href="#cb10-771" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb10-772"><a href="#cb10-772" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">for</span> frag <span class="kw">in</span> fragments:</span>
<span id="cb10-773"><a href="#cb10-773" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">if</span> <span class="bu">isinstance</span>(frag, <span class="bu">dict</span>):</span>
<span id="cb10-774"><a href="#cb10-774" aria-hidden="true" tabindex="-1"></a>                            frag_type <span class="op">=</span> frag.get(<span class="st">&#39;type&#39;</span>, <span class="st">&#39;&#39;</span>).upper()</span>
<span id="cb10-775"><a href="#cb10-775" aria-hidden="true" tabindex="-1"></a>                            <span class="cf">if</span> frag_type <span class="kw">in</span> (<span class="st">&#39;REQUEST&#39;</span>, <span class="st">&#39;RESPONSE&#39;</span>):</span>
<span id="cb10-776"><a href="#cb10-776" aria-hidden="true" tabindex="-1"></a>                                msg_type <span class="op">=</span> frag_type</span>
<span id="cb10-777"><a href="#cb10-777" aria-hidden="true" tabindex="-1"></a>                            text <span class="op">=</span> frag.get(<span class="st">&#39;text&#39;</span>, <span class="st">&#39;&#39;</span>)</span>
<span id="cb10-778"><a href="#cb10-778" aria-hidden="true" tabindex="-1"></a>                            <span class="cf">if</span> text:</span>
<span id="cb10-779"><a href="#cb10-779" aria-hidden="true" tabindex="-1"></a>                                content_parts.append(text)</span>
<span id="cb10-780"><a href="#cb10-780" aria-hidden="true" tabindex="-1"></a>                            content <span class="op">=</span> frag.get(<span class="st">&#39;content&#39;</span>, <span class="st">&#39;&#39;</span>)</span>
<span id="cb10-781"><a href="#cb10-781" aria-hidden="true" tabindex="-1"></a>                            <span class="cf">if</span> content:</span>
<span id="cb10-782"><a href="#cb10-782" aria-hidden="true" tabindex="-1"></a>                                <span class="cf">if</span> <span class="bu">isinstance</span>(content, <span class="bu">list</span>):</span>
<span id="cb10-783"><a href="#cb10-783" aria-hidden="true" tabindex="-1"></a>                                    <span class="cf">for</span> item <span class="kw">in</span> content:</span>
<span id="cb10-784"><a href="#cb10-784" aria-hidden="true" tabindex="-1"></a>                                        <span class="cf">if</span> <span class="bu">isinstance</span>(item, <span class="bu">str</span>):</span>
<span id="cb10-785"><a href="#cb10-785" aria-hidden="true" tabindex="-1"></a>                                            content_parts.append(item)</span>
<span id="cb10-786"><a href="#cb10-786" aria-hidden="true" tabindex="-1"></a>                                        <span class="cf">elif</span> <span class="bu">isinstance</span>(item, <span class="bu">dict</span>):</span>
<span id="cb10-787"><a href="#cb10-787" aria-hidden="true" tabindex="-1"></a>                                            item_text <span class="op">=</span> item.get(<span class="st">&#39;text&#39;</span>, <span class="st">&#39;&#39;</span>)</span>
<span id="cb10-788"><a href="#cb10-788" aria-hidden="true" tabindex="-1"></a>                                            <span class="cf">if</span> item_text:</span>
<span id="cb10-789"><a href="#cb10-789" aria-hidden="true" tabindex="-1"></a>                                                content_parts.append(<span class="bu">str</span>(item_text))</span>
<span id="cb10-790"><a href="#cb10-790" aria-hidden="true" tabindex="-1"></a>                                <span class="cf">else</span>:</span>
<span id="cb10-791"><a href="#cb10-791" aria-hidden="true" tabindex="-1"></a>                                    content_parts.append(<span class="bu">str</span>(content))</span>
<span id="cb10-792"><a href="#cb10-792" aria-hidden="true" tabindex="-1"></a>                                    </span>
<span id="cb10-793"><a href="#cb10-793" aria-hidden="true" tabindex="-1"></a>                    content <span class="op">=</span> <span class="st">&#39; &#39;</span>.join(content_parts).strip()</span>
<span id="cb10-794"><a href="#cb10-794" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb10-795"><a href="#cb10-795" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># APLICA PRESERVA√á√ÉO</span></span>
<span id="cb10-796"><a href="#cb10-796" aria-hidden="true" tabindex="-1"></a>                    content <span class="op">=</span> <span class="va">self</span>.preserve_special_content(content)</span>
<span id="cb10-797"><a href="#cb10-797" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb10-798"><a href="#cb10-798" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="kw">not</span> content:</span>
<span id="cb10-799"><a href="#cb10-799" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb10-800"><a href="#cb10-800" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb10-801"><a href="#cb10-801" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> msg_type <span class="op">==</span> <span class="st">&#39;REQUEST&#39;</span>:</span>
<span id="cb10-802"><a href="#cb10-802" aria-hidden="true" tabindex="-1"></a>                        author <span class="op">=</span> <span class="st">&quot;üë§ Utilizador&quot;</span></span>
<span id="cb10-803"><a href="#cb10-803" aria-hidden="true" tabindex="-1"></a>                        role <span class="op">=</span> <span class="st">&#39;user&#39;</span></span>
<span id="cb10-804"><a href="#cb10-804" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">else</span>:</span>
<span id="cb10-805"><a href="#cb10-805" aria-hidden="true" tabindex="-1"></a>                        author <span class="op">=</span> <span class="st">&quot;ü§ñ DeepSeek&quot;</span></span>
<span id="cb10-806"><a href="#cb10-806" aria-hidden="true" tabindex="-1"></a>                        role <span class="op">=</span> <span class="st">&#39;assistant&#39;</span></span>
<span id="cb10-807"><a href="#cb10-807" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb10-808"><a href="#cb10-808" aria-hidden="true" tabindex="-1"></a>                    messages.append({</span>
<span id="cb10-809"><a href="#cb10-809" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;author&#39;</span>: author,</span>
<span id="cb10-810"><a href="#cb10-810" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;role&#39;</span>: role,</span>
<span id="cb10-811"><a href="#cb10-811" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;content&#39;</span>: content,</span>
<span id="cb10-812"><a href="#cb10-812" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;timestamp&#39;</span>: <span class="va">self</span>.format_timestamp(msg_data.get(<span class="st">&#39;inserted_at&#39;</span>)),</span>
<span id="cb10-813"><a href="#cb10-813" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;model&#39;</span>: msg_data.get(<span class="st">&#39;model&#39;</span>, <span class="st">&#39;DeepSeek&#39;</span>)</span>
<span id="cb10-814"><a href="#cb10-814" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb10-815"><a href="#cb10-815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-816"><a href="#cb10-816" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> messages:</span>
<span id="cb10-817"><a href="#cb10-817" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.all_conversations.append({</span>
<span id="cb10-818"><a href="#cb10-818" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;title&#39;</span>: title,</span>
<span id="cb10-819"><a href="#cb10-819" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;source&#39;</span>: <span class="st">&#39;DeepSeek&#39;</span>,</span>
<span id="cb10-820"><a href="#cb10-820" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;id&#39;</span>: conv.get(<span class="st">&#39;id&#39;</span>, <span class="ss">f&#39;deepseek_</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">&#39;</span>),</span>
<span id="cb10-821"><a href="#cb10-821" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;inserted_at&#39;</span>: <span class="va">self</span>.format_timestamp(conv.get(<span class="st">&#39;inserted_at&#39;</span>)),</span>
<span id="cb10-822"><a href="#cb10-822" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;updated_at&#39;</span>: <span class="va">self</span>.format_timestamp(conv.get(<span class="st">&#39;updated_at&#39;</span>)),</span>
<span id="cb10-823"><a href="#cb10-823" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;messages&#39;</span>: messages,</span>
<span id="cb10-824"><a href="#cb10-824" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;summary&#39;</span>: messages[<span class="dv">0</span>][<span class="st">&#39;content&#39;</span>][:<span class="dv">100</span>] <span class="op">+</span> <span class="st">&quot;...&quot;</span> <span class="cf">if</span> messages <span class="cf">else</span> <span class="st">&quot;Sem conte√∫do&quot;</span>,</span>
<span id="cb10-825"><a href="#cb10-825" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;category&#39;</span>: <span class="st">&#39;Geral&#39;</span></span>
<span id="cb10-826"><a href="#cb10-826" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb10-827"><a href="#cb10-827" aria-hidden="true" tabindex="-1"></a>                    processed_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb10-828"><a href="#cb10-828" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb10-829"><a href="#cb10-829" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ DeepSeek: </span><span class="sc">{</span>processed_count<span class="sc">}</span><span class="ss"> conversas processadas.&quot;</span>)</span>
<span id="cb10-830"><a href="#cb10-830" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb10-831"><a href="#cb10-831" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb10-832"><a href="#cb10-832" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚ùå Erro ao processar DeepSeek: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb10-833"><a href="#cb10-833" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb10-834"><a href="#cb10-834" aria-hidden="true" tabindex="-1"></a>                traceback.print_exc()</span>
<span id="cb10-835"><a href="#cb10-835" aria-hidden="true" tabindex="-1"></a>        <span class="cf">finally</span>:</span>
<span id="cb10-836"><a href="#cb10-836" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="st">&#39;temp_dir&#39;</span> <span class="kw">in</span> <span class="bu">locals</span>():</span>
<span id="cb10-837"><a href="#cb10-837" aria-hidden="true" tabindex="-1"></a>                shutil.rmtree(temp_dir, ignore_errors<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb10-838"><a href="#cb10-838" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-839"><a href="#cb10-839" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> process_grok(<span class="va">self</span>, path: Path):</span>
<span id="cb10-840"><a href="#cb10-840" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Processa exporta√ß√£o do Grok&quot;&quot;&quot;</span></span>
<span id="cb10-841"><a href="#cb10-841" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb10-842"><a href="#cb10-842" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;üß™ [DRY-RUN] Processaria Grok: </span><span class="sc">{</span>path<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb10-843"><a href="#cb10-843" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb10-844"><a href="#cb10-844" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb10-845"><a href="#cb10-845" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb10-846"><a href="#cb10-846" aria-hidden="true" tabindex="-1"></a>            temp_dir <span class="op">=</span> tempfile.mkdtemp(prefix<span class="op">=</span><span class="st">&quot;grok_&quot;</span>)</span>
<span id="cb10-847"><a href="#cb10-847" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> zipfile.ZipFile(path, <span class="st">&#39;r&#39;</span>) <span class="im">as</span> z:</span>
<span id="cb10-848"><a href="#cb10-848" aria-hidden="true" tabindex="-1"></a>                z.extractall(temp_dir)</span>
<span id="cb10-849"><a href="#cb10-849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-850"><a href="#cb10-850" aria-hidden="true" tabindex="-1"></a>            target_file <span class="op">=</span> <span class="va">None</span></span>
<span id="cb10-851"><a href="#cb10-851" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> root, _, files <span class="kw">in</span> os.walk(temp_dir):</span>
<span id="cb10-852"><a href="#cb10-852" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> <span class="bu">file</span> <span class="kw">in</span> files:</span>
<span id="cb10-853"><a href="#cb10-853" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="bu">file</span> <span class="op">==</span> <span class="st">&quot;prod-grok-backend.json&quot;</span>:</span>
<span id="cb10-854"><a href="#cb10-854" aria-hidden="true" tabindex="-1"></a>                        target_file <span class="op">=</span> Path(root) <span class="op">/</span> <span class="bu">file</span></span>
<span id="cb10-855"><a href="#cb10-855" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">break</span></span>
<span id="cb10-856"><a href="#cb10-856" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> target_file:</span>
<span id="cb10-857"><a href="#cb10-857" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">break</span></span>
<span id="cb10-858"><a href="#cb10-858" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-859"><a href="#cb10-859" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> target_file:</span>
<span id="cb10-860"><a href="#cb10-860" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;‚ùå Grok: ficheiro &#39;prod-grok-backend.json&#39; n√£o encontrado no ZIP.&quot;</span>)</span>
<span id="cb10-861"><a href="#cb10-861" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span></span>
<span id="cb10-862"><a href="#cb10-862" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-863"><a href="#cb10-863" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;üîç Grok: carregando </span><span class="sc">{</span>target_file<span class="sc">.</span>name<span class="sc">}</span><span class="ss">...&quot;</span>)</span>
<span id="cb10-864"><a href="#cb10-864" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(target_file, <span class="st">&#39;r&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb10-865"><a href="#cb10-865" aria-hidden="true" tabindex="-1"></a>                data <span class="op">=</span> json.load(f)</span>
<span id="cb10-866"><a href="#cb10-866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-867"><a href="#cb10-867" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(data, <span class="bu">dict</span>) <span class="kw">or</span> <span class="st">&#39;conversations&#39;</span> <span class="kw">not</span> <span class="kw">in</span> data:</span>
<span id="cb10-868"><a href="#cb10-868" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;‚ùå Grok: estrutura inesperada ‚Äî chave &#39;conversations&#39; n√£o encontrada.&quot;</span>)</span>
<span id="cb10-869"><a href="#cb10-869" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span></span>
<span id="cb10-870"><a href="#cb10-870" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-871"><a href="#cb10-871" aria-hidden="true" tabindex="-1"></a>            conversations_list <span class="op">=</span> data[<span class="st">&#39;conversations&#39;</span>]</span>
<span id="cb10-872"><a href="#cb10-872" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(conversations_list, <span class="bu">list</span>):</span>
<span id="cb10-873"><a href="#cb10-873" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;‚ùå Grok: &#39;conversations&#39; n√£o √© uma lista.&quot;</span>)</span>
<span id="cb10-874"><a href="#cb10-874" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span></span>
<span id="cb10-875"><a href="#cb10-875" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-876"><a href="#cb10-876" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;üìä Grok: encontradas </span><span class="sc">{</span><span class="bu">len</span>(conversations_list)<span class="sc">}</span><span class="ss"> conversas.&quot;</span>)</span>
<span id="cb10-877"><a href="#cb10-877" aria-hidden="true" tabindex="-1"></a>            total_convs <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb10-878"><a href="#cb10-878" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-879"><a href="#cb10-879" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> item <span class="kw">in</span> conversations_list:</span>
<span id="cb10-880"><a href="#cb10-880" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(item, <span class="bu">dict</span>):</span>
<span id="cb10-881"><a href="#cb10-881" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">continue</span></span>
<span id="cb10-882"><a href="#cb10-882" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-883"><a href="#cb10-883" aria-hidden="true" tabindex="-1"></a>                conv_meta <span class="op">=</span> item.get(<span class="st">&#39;conversation&#39;</span>)</span>
<span id="cb10-884"><a href="#cb10-884" aria-hidden="true" tabindex="-1"></a>                responses <span class="op">=</span> item.get(<span class="st">&#39;responses&#39;</span>, [])</span>
<span id="cb10-885"><a href="#cb10-885" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-886"><a href="#cb10-886" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(conv_meta, <span class="bu">dict</span>) <span class="kw">or</span> <span class="kw">not</span> <span class="bu">isinstance</span>(responses, <span class="bu">list</span>) <span class="kw">or</span> <span class="kw">not</span> responses:</span>
<span id="cb10-887"><a href="#cb10-887" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">continue</span></span>
<span id="cb10-888"><a href="#cb10-888" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-889"><a href="#cb10-889" aria-hidden="true" tabindex="-1"></a>                conv_id <span class="op">=</span> conv_meta.get(<span class="st">&#39;id&#39;</span>)</span>
<span id="cb10-890"><a href="#cb10-890" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="kw">not</span> conv_id:</span>
<span id="cb10-891"><a href="#cb10-891" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">continue</span></span>
<span id="cb10-892"><a href="#cb10-892" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-893"><a href="#cb10-893" aria-hidden="true" tabindex="-1"></a>                title <span class="op">=</span> conv_meta.get(<span class="st">&#39;title&#39;</span>, <span class="ss">f&quot;Conversa Grok </span><span class="sc">{</span>total_convs <span class="op">+</span> <span class="dv">1</span><span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb10-894"><a href="#cb10-894" aria-hidden="true" tabindex="-1"></a>                title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(title)</span>
<span id="cb10-895"><a href="#cb10-895" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb10-896"><a href="#cb10-896" aria-hidden="true" tabindex="-1"></a>                create_time_str <span class="op">=</span> conv_meta.get(<span class="st">&#39;create_time&#39;</span>)</span>
<span id="cb10-897"><a href="#cb10-897" aria-hidden="true" tabindex="-1"></a>                modify_time_str <span class="op">=</span> conv_meta.get(<span class="st">&#39;modify_time&#39;</span>)</span>
<span id="cb10-898"><a href="#cb10-898" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-899"><a href="#cb10-899" aria-hidden="true" tabindex="-1"></a>                <span class="kw">def</span> format_iso_timestamp(ts_str):</span>
<span id="cb10-900"><a href="#cb10-900" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="kw">not</span> ts_str:</span>
<span id="cb10-901"><a href="#cb10-901" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb10-902"><a href="#cb10-902" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">try</span>:</span>
<span id="cb10-903"><a href="#cb10-903" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">if</span> <span class="st">&#39;.&#39;</span> <span class="kw">in</span> ts_str:</span>
<span id="cb10-904"><a href="#cb10-904" aria-hidden="true" tabindex="-1"></a>                            ts_str <span class="op">=</span> ts_str.split(<span class="st">&#39;.&#39;</span>)[<span class="dv">0</span>] <span class="op">+</span> <span class="st">&#39;Z&#39;</span></span>
<span id="cb10-905"><a href="#cb10-905" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">return</span> <span class="va">self</span>.format_timestamp(ts_str)</span>
<span id="cb10-906"><a href="#cb10-906" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">except</span>:</span>
<span id="cb10-907"><a href="#cb10-907" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">return</span> <span class="bu">str</span>(ts_str)</span>
<span id="cb10-908"><a href="#cb10-908" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-909"><a href="#cb10-909" aria-hidden="true" tabindex="-1"></a>                inserted_at <span class="op">=</span> format_iso_timestamp(create_time_str)</span>
<span id="cb10-910"><a href="#cb10-910" aria-hidden="true" tabindex="-1"></a>                updated_at <span class="op">=</span> format_iso_timestamp(modify_time_str)</span>
<span id="cb10-911"><a href="#cb10-911" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-912"><a href="#cb10-912" aria-hidden="true" tabindex="-1"></a>                messages <span class="op">=</span> []</span>
<span id="cb10-913"><a href="#cb10-913" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> resp <span class="kw">in</span> responses:</span>
<span id="cb10-914"><a href="#cb10-914" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(resp, <span class="bu">dict</span>):</span>
<span id="cb10-915"><a href="#cb10-915" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb10-916"><a href="#cb10-916" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-917"><a href="#cb10-917" aria-hidden="true" tabindex="-1"></a>                    resp_data <span class="op">=</span> resp.get(<span class="st">&#39;response&#39;</span>)</span>
<span id="cb10-918"><a href="#cb10-918" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(resp_data, <span class="bu">dict</span>):</span>
<span id="cb10-919"><a href="#cb10-919" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb10-920"><a href="#cb10-920" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-921"><a href="#cb10-921" aria-hidden="true" tabindex="-1"></a>                    sender <span class="op">=</span> resp_data.get(<span class="st">&#39;sender&#39;</span>, <span class="st">&#39;&#39;</span>).upper()</span>
<span id="cb10-922"><a href="#cb10-922" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> sender <span class="op">==</span> <span class="st">&#39;HUMAN&#39;</span>:</span>
<span id="cb10-923"><a href="#cb10-923" aria-hidden="true" tabindex="-1"></a>                        author <span class="op">=</span> <span class="st">&quot;üë§ Utilizador&quot;</span></span>
<span id="cb10-924"><a href="#cb10-924" aria-hidden="true" tabindex="-1"></a>                        role <span class="op">=</span> <span class="st">&quot;user&quot;</span></span>
<span id="cb10-925"><a href="#cb10-925" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">elif</span> sender <span class="op">==</span> <span class="st">&#39;ASSISTANT&#39;</span>:</span>
<span id="cb10-926"><a href="#cb10-926" aria-hidden="true" tabindex="-1"></a>                        author <span class="op">=</span> <span class="st">&quot;ü§ñ Grok&quot;</span></span>
<span id="cb10-927"><a href="#cb10-927" aria-hidden="true" tabindex="-1"></a>                        role <span class="op">=</span> <span class="st">&quot;assistant&quot;</span></span>
<span id="cb10-928"><a href="#cb10-928" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">else</span>:</span>
<span id="cb10-929"><a href="#cb10-929" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb10-930"><a href="#cb10-930" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-931"><a href="#cb10-931" aria-hidden="true" tabindex="-1"></a>                    content <span class="op">=</span> <span class="bu">str</span>(resp_data.get(<span class="st">&#39;message&#39;</span>, <span class="st">&#39;&#39;</span>)).strip()</span>
<span id="cb10-932"><a href="#cb10-932" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb10-933"><a href="#cb10-933" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># APLICA PRESERVA√á√ÉO</span></span>
<span id="cb10-934"><a href="#cb10-934" aria-hidden="true" tabindex="-1"></a>                    content <span class="op">=</span> <span class="va">self</span>.preserve_special_content(content)</span>
<span id="cb10-935"><a href="#cb10-935" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb10-936"><a href="#cb10-936" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="kw">not</span> content:</span>
<span id="cb10-937"><a href="#cb10-937" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb10-938"><a href="#cb10-938" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-939"><a href="#cb10-939" aria-hidden="true" tabindex="-1"></a>                    create_time <span class="op">=</span> resp_data.get(<span class="st">&#39;create_time&#39;</span>)</span>
<span id="cb10-940"><a href="#cb10-940" aria-hidden="true" tabindex="-1"></a>                    timestamp_ms <span class="op">=</span> <span class="va">None</span></span>
<span id="cb10-941"><a href="#cb10-941" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="bu">isinstance</span>(create_time, <span class="bu">dict</span>) <span class="kw">and</span> <span class="st">&#39;$date&#39;</span> <span class="kw">in</span> create_time:</span>
<span id="cb10-942"><a href="#cb10-942" aria-hidden="true" tabindex="-1"></a>                        date_obj <span class="op">=</span> create_time[<span class="st">&#39;$date&#39;</span>]</span>
<span id="cb10-943"><a href="#cb10-943" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">if</span> <span class="bu">isinstance</span>(date_obj, <span class="bu">dict</span>) <span class="kw">and</span> <span class="st">&#39;$numberLong&#39;</span> <span class="kw">in</span> date_obj:</span>
<span id="cb10-944"><a href="#cb10-944" aria-hidden="true" tabindex="-1"></a>                            <span class="cf">try</span>:</span>
<span id="cb10-945"><a href="#cb10-945" aria-hidden="true" tabindex="-1"></a>                                timestamp_ms <span class="op">=</span> <span class="bu">int</span>(date_obj[<span class="st">&#39;$numberLong&#39;</span>])</span>
<span id="cb10-946"><a href="#cb10-946" aria-hidden="true" tabindex="-1"></a>                            <span class="cf">except</span>:</span>
<span id="cb10-947"><a href="#cb10-947" aria-hidden="true" tabindex="-1"></a>                                <span class="cf">pass</span></span>
<span id="cb10-948"><a href="#cb10-948" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-949"><a href="#cb10-949" aria-hidden="true" tabindex="-1"></a>                    messages.append({</span>
<span id="cb10-950"><a href="#cb10-950" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;author&#39;</span>: author,</span>
<span id="cb10-951"><a href="#cb10-951" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;role&#39;</span>: role,</span>
<span id="cb10-952"><a href="#cb10-952" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;content&#39;</span>: content,</span>
<span id="cb10-953"><a href="#cb10-953" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;timestamp&#39;</span>: <span class="va">self</span>.format_timestamp(timestamp_ms <span class="op">/</span> <span class="fl">1000.0</span> <span class="cf">if</span> timestamp_ms <span class="cf">else</span> <span class="va">None</span>),</span>
<span id="cb10-954"><a href="#cb10-954" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;model&#39;</span>: <span class="st">&#39;Grok&#39;</span></span>
<span id="cb10-955"><a href="#cb10-955" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb10-956"><a href="#cb10-956" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-957"><a href="#cb10-957" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> messages:</span>
<span id="cb10-958"><a href="#cb10-958" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.all_conversations.append({</span>
<span id="cb10-959"><a href="#cb10-959" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;title&#39;</span>: title,</span>
<span id="cb10-960"><a href="#cb10-960" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;source&#39;</span>: <span class="st">&#39;Grok&#39;</span>,</span>
<span id="cb10-961"><a href="#cb10-961" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;id&#39;</span>: conv_id,</span>
<span id="cb10-962"><a href="#cb10-962" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;inserted_at&#39;</span>: inserted_at,</span>
<span id="cb10-963"><a href="#cb10-963" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;updated_at&#39;</span>: updated_at,</span>
<span id="cb10-964"><a href="#cb10-964" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;messages&#39;</span>: messages,</span>
<span id="cb10-965"><a href="#cb10-965" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;summary&#39;</span>: messages[<span class="dv">0</span>][<span class="st">&#39;content&#39;</span>][:<span class="dv">100</span>] <span class="op">+</span> <span class="st">&quot;...&quot;</span> <span class="cf">if</span> messages <span class="cf">else</span> <span class="st">&quot;Sem conte√∫do&quot;</span>,</span>
<span id="cb10-966"><a href="#cb10-966" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;category&#39;</span>: <span class="st">&#39;Geral&#39;</span></span>
<span id="cb10-967"><a href="#cb10-967" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb10-968"><a href="#cb10-968" aria-hidden="true" tabindex="-1"></a>                    total_convs <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb10-969"><a href="#cb10-969" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-970"><a href="#cb10-970" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> total_convs <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb10-971"><a href="#cb10-971" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ Grok: processadas </span><span class="sc">{</span>total_convs<span class="sc">}</span><span class="ss"> conversas.&quot;</span>)</span>
<span id="cb10-972"><a href="#cb10-972" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb10-973"><a href="#cb10-973" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;‚ùå Grok: nenhuma conversa v√°lida encontrada.&quot;</span>)</span>
<span id="cb10-974"><a href="#cb10-974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-975"><a href="#cb10-975" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb10-976"><a href="#cb10-976" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚ùå Erro ao processar Grok: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb10-977"><a href="#cb10-977" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb10-978"><a href="#cb10-978" aria-hidden="true" tabindex="-1"></a>                traceback.print_exc()</span>
<span id="cb10-979"><a href="#cb10-979" aria-hidden="true" tabindex="-1"></a>        <span class="cf">finally</span>:</span>
<span id="cb10-980"><a href="#cb10-980" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="st">&#39;temp_dir&#39;</span> <span class="kw">in</span> <span class="bu">locals</span>():</span>
<span id="cb10-981"><a href="#cb10-981" aria-hidden="true" tabindex="-1"></a>                shutil.rmtree(temp_dir, ignore_errors<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb10-982"><a href="#cb10-982" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-983"><a href="#cb10-983" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> save_as_markdown_enhanced(<span class="va">self</span>):</span>
<span id="cb10-984"><a href="#cb10-984" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Salva conversas com preserva√ß√£o total de formata√ß√£o&quot;&quot;&quot;</span></span>
<span id="cb10-985"><a href="#cb10-985" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb10-986"><a href="#cb10-986" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;üß™ [DRY-RUN] Markdowns seriam criados:&quot;</span>)</span>
<span id="cb10-987"><a href="#cb10-987" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> conv <span class="kw">in</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb10-988"><a href="#cb10-988" aria-hidden="true" tabindex="-1"></a>                safe_title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(conv[<span class="st">&#39;title&#39;</span>])</span>
<span id="cb10-989"><a href="#cb10-989" aria-hidden="true" tabindex="-1"></a>                filename <span class="op">=</span> <span class="ss">f&quot;</span><span class="sc">{</span>conv[<span class="st">&#39;number&#39;</span>]<span class="sc">:03d}</span><span class="ss">_</span><span class="sc">{</span>conv[<span class="st">&#39;source&#39;</span>]<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>safe_title<span class="sc">}</span><span class="ss">.md&quot;</span></span>
<span id="cb10-990"><a href="#cb10-990" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;   üìÑ </span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb10-991"><a href="#cb10-991" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb10-992"><a href="#cb10-992" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb10-993"><a href="#cb10-993" aria-hidden="true" tabindex="-1"></a>        folder <span class="op">=</span> <span class="va">self</span>.output_dirs[<span class="st">&#39;markdown&#39;</span>]</span>
<span id="cb10-994"><a href="#cb10-994" aria-hidden="true" tabindex="-1"></a>        saved_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb10-995"><a href="#cb10-995" aria-hidden="true" tabindex="-1"></a>        failed_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb10-996"><a href="#cb10-996" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-997"><a href="#cb10-997" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> conv <span class="kw">in</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb10-998"><a href="#cb10-998" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb10-999"><a href="#cb10-999" aria-hidden="true" tabindex="-1"></a>                safe_title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(conv[<span class="st">&#39;title&#39;</span>])</span>
<span id="cb10-1000"><a href="#cb10-1000" aria-hidden="true" tabindex="-1"></a>                filename <span class="op">=</span> <span class="ss">f&quot;</span><span class="sc">{</span>conv[<span class="st">&#39;number&#39;</span>]<span class="sc">:03d}</span><span class="ss">_</span><span class="sc">{</span>conv[<span class="st">&#39;source&#39;</span>]<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>safe_title<span class="sc">}</span><span class="ss">.md&quot;</span></span>
<span id="cb10-1001"><a href="#cb10-1001" aria-hidden="true" tabindex="-1"></a>                filepath <span class="op">=</span> Path(folder) <span class="op">/</span> filename</span>
<span id="cb10-1002"><a href="#cb10-1002" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb10-1003"><a href="#cb10-1003" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.force_overwrite <span class="kw">and</span> filepath.exists():</span>
<span id="cb10-1004"><a href="#cb10-1004" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">continue</span></span>
<span id="cb10-1005"><a href="#cb10-1005" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb10-1006"><a href="#cb10-1006" aria-hidden="true" tabindex="-1"></a>                markdown_content <span class="op">=</span> <span class="va">self</span>.create_enhanced_markdown_content(conv)</span>
<span id="cb10-1007"><a href="#cb10-1007" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb10-1008"><a href="#cb10-1008" aria-hidden="true" tabindex="-1"></a>                <span class="cf">with</span> <span class="bu">open</span>(filepath, <span class="st">&#39;w&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb10-1009"><a href="#cb10-1009" aria-hidden="true" tabindex="-1"></a>                    f.write(markdown_content)</span>
<span id="cb10-1010"><a href="#cb10-1010" aria-hidden="true" tabindex="-1"></a>                saved_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb10-1011"><a href="#cb10-1011" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb10-1012"><a href="#cb10-1012" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb10-1013"><a href="#cb10-1013" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;‚ùå Erro ao salvar conversa </span><span class="sc">{</span>conv[<span class="st">&#39;number&#39;</span>]<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb10-1014"><a href="#cb10-1014" aria-hidden="true" tabindex="-1"></a>                failed_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb10-1015"><a href="#cb10-1015" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span></span>
<span id="cb10-1016"><a href="#cb10-1016" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb10-1017"><a href="#cb10-1017" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ Markdown: </span><span class="sc">{</span>saved_count<span class="sc">}</span><span class="ss"> arquivos criados, </span><span class="sc">{</span>failed_count<span class="sc">}</span><span class="ss"> falhas em &#39;</span><span class="sc">{</span>folder<span class="sc">}</span><span class="ss">&#39;&quot;</span>)</span>
<span id="cb10-1018"><a href="#cb10-1018" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-1019"><a href="#cb10-1019" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> save_as_html_enhanced(<span class="va">self</span>):</span>
<span id="cb10-1020"><a href="#cb10-1020" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Salva conversas em HTML elegante - NOVO M√âTODO&quot;&quot;&quot;</span></span>
<span id="cb10-1021"><a href="#cb10-1021" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb10-1022"><a href="#cb10-1022" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;üß™ [DRY-RUN] HTMLs seriam criados:&quot;</span>)</span>
<span id="cb10-1023"><a href="#cb10-1023" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> conv <span class="kw">in</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb10-1024"><a href="#cb10-1024" aria-hidden="true" tabindex="-1"></a>                safe_title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(conv[<span class="st">&#39;title&#39;</span>])</span>
<span id="cb10-1025"><a href="#cb10-1025" aria-hidden="true" tabindex="-1"></a>                filename <span class="op">=</span> <span class="ss">f&quot;</span><span class="sc">{</span>conv[<span class="st">&#39;number&#39;</span>]<span class="sc">:03d}</span><span class="ss">_</span><span class="sc">{</span>conv[<span class="st">&#39;source&#39;</span>]<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>safe_title<span class="sc">}</span><span class="ss">.html&quot;</span></span>
<span id="cb10-1026"><a href="#cb10-1026" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;   üåê </span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb10-1027"><a href="#cb10-1027" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb10-1028"><a href="#cb10-1028" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb10-1029"><a href="#cb10-1029" aria-hidden="true" tabindex="-1"></a>        folder <span class="op">=</span> <span class="va">self</span>.output_dirs[<span class="st">&#39;html&#39;</span>]</span>
<span id="cb10-1030"><a href="#cb10-1030" aria-hidden="true" tabindex="-1"></a>        saved_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb10-1031"><a href="#cb10-1031" aria-hidden="true" tabindex="-1"></a>        failed_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb10-1032"><a href="#cb10-1032" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-1033"><a href="#cb10-1033" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> conv <span class="kw">in</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb10-1034"><a href="#cb10-1034" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb10-1035"><a href="#cb10-1035" aria-hidden="true" tabindex="-1"></a>                safe_title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(conv[<span class="st">&#39;title&#39;</span>])</span>
<span id="cb10-1036"><a href="#cb10-1036" aria-hidden="true" tabindex="-1"></a>                filename <span class="op">=</span> <span class="ss">f&quot;</span><span class="sc">{</span>conv[<span class="st">&#39;number&#39;</span>]<span class="sc">:03d}</span><span class="ss">_</span><span class="sc">{</span>conv[<span class="st">&#39;source&#39;</span>]<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>safe_title<span class="sc">}</span><span class="ss">.html&quot;</span></span>
<span id="cb10-1037"><a href="#cb10-1037" aria-hidden="true" tabindex="-1"></a>                filepath <span class="op">=</span> Path(folder) <span class="op">/</span> filename</span>
<span id="cb10-1038"><a href="#cb10-1038" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb10-1039"><a href="#cb10-1039" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.force_overwrite <span class="kw">and</span> filepath.exists():</span>
<span id="cb10-1040"><a href="#cb10-1040" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">continue</span></span>
<span id="cb10-1041"><a href="#cb10-1041" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb10-1042"><a href="#cb10-1042" aria-hidden="true" tabindex="-1"></a>                html_content <span class="op">=</span> <span class="va">self</span>.create_enhanced_html_content(conv)</span>
<span id="cb10-1043"><a href="#cb10-1043" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb10-1044"><a href="#cb10-1044" aria-hidden="true" tabindex="-1"></a>                <span class="cf">with</span> <span class="bu">open</span>(filepath, <span class="st">&#39;w&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb10-1045"><a href="#cb10-1045" aria-hidden="true" tabindex="-1"></a>                    f.write(html_content)</span>
<span id="cb10-1046"><a href="#cb10-1046" aria-hidden="true" tabindex="-1"></a>                saved_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb10-1047"><a href="#cb10-1047" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb10-1048"><a href="#cb10-1048" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;   üåê HTML criado: </span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb10-1049"><a href="#cb10-1049" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb10-1050"><a href="#cb10-1050" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb10-1051"><a href="#cb10-1051" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;‚ùå Erro ao salvar HTML </span><span class="sc">{</span>conv[<span class="st">&#39;number&#39;</span>]<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb10-1052"><a href="#cb10-1052" aria-hidden="true" tabindex="-1"></a>                failed_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb10-1053"><a href="#cb10-1053" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span></span>
<span id="cb10-1054"><a href="#cb10-1054" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb10-1055"><a href="#cb10-1055" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ HTML: </span><span class="sc">{</span>saved_count<span class="sc">}</span><span class="ss"> arquivos criados, </span><span class="sc">{</span>failed_count<span class="sc">}</span><span class="ss"> falhas em &#39;</span><span class="sc">{</span>folder<span class="sc">}</span><span class="ss">&#39;&quot;</span>)</span>
<span id="cb10-1056"><a href="#cb10-1056" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-1057"><a href="#cb10-1057" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> save_as_csv(<span class="va">self</span>):</span>
<span id="cb10-1058"><a href="#cb10-1058" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Salva conversas em arquivos CSV individuais&quot;&quot;&quot;</span></span>
<span id="cb10-1059"><a href="#cb10-1059" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb10-1060"><a href="#cb10-1060" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;üß™ [DRY-RUN] CSVs seriam criados:&quot;</span>)</span>
<span id="cb10-1061"><a href="#cb10-1061" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> conv <span class="kw">in</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb10-1062"><a href="#cb10-1062" aria-hidden="true" tabindex="-1"></a>                safe_title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(conv[<span class="st">&#39;title&#39;</span>])</span>
<span id="cb10-1063"><a href="#cb10-1063" aria-hidden="true" tabindex="-1"></a>                filename <span class="op">=</span> <span class="ss">f&quot;</span><span class="sc">{</span>conv[<span class="st">&#39;number&#39;</span>]<span class="sc">:03d}</span><span class="ss">_</span><span class="sc">{</span>conv[<span class="st">&#39;source&#39;</span>]<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>safe_title<span class="sc">}</span><span class="ss">.csv&quot;</span></span>
<span id="cb10-1064"><a href="#cb10-1064" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;   üìä </span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb10-1065"><a href="#cb10-1065" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb10-1066"><a href="#cb10-1066" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb10-1067"><a href="#cb10-1067" aria-hidden="true" tabindex="-1"></a>        folder <span class="op">=</span> <span class="va">self</span>.output_dirs[<span class="st">&#39;csv&#39;</span>]</span>
<span id="cb10-1068"><a href="#cb10-1068" aria-hidden="true" tabindex="-1"></a>        saved_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb10-1069"><a href="#cb10-1069" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-1070"><a href="#cb10-1070" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> conv <span class="kw">in</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb10-1071"><a href="#cb10-1071" aria-hidden="true" tabindex="-1"></a>            safe_title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(conv[<span class="st">&#39;title&#39;</span>])</span>
<span id="cb10-1072"><a href="#cb10-1072" aria-hidden="true" tabindex="-1"></a>            filename <span class="op">=</span> <span class="ss">f&quot;</span><span class="sc">{</span>conv[<span class="st">&#39;number&#39;</span>]<span class="sc">:03d}</span><span class="ss">_</span><span class="sc">{</span>conv[<span class="st">&#39;source&#39;</span>]<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>safe_title<span class="sc">}</span><span class="ss">.csv&quot;</span></span>
<span id="cb10-1073"><a href="#cb10-1073" aria-hidden="true" tabindex="-1"></a>            filepath <span class="op">=</span> Path(folder) <span class="op">/</span> filename</span>
<span id="cb10-1074"><a href="#cb10-1074" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb10-1075"><a href="#cb10-1075" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.force_overwrite <span class="kw">and</span> filepath.exists():</span>
<span id="cb10-1076"><a href="#cb10-1076" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span></span>
<span id="cb10-1077"><a href="#cb10-1077" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb10-1078"><a href="#cb10-1078" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(filepath, <span class="st">&#39;w&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>, newline<span class="op">=</span><span class="st">&#39;&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb10-1079"><a href="#cb10-1079" aria-hidden="true" tabindex="-1"></a>                writer <span class="op">=</span> csv.DictWriter(f, fieldnames<span class="op">=</span>[</span>
<span id="cb10-1080"><a href="#cb10-1080" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;node_id&#39;</span>, <span class="st">&#39;author&#39;</span>, <span class="st">&#39;role&#39;</span>, <span class="st">&#39;timestamp&#39;</span>, <span class="st">&#39;model&#39;</span>, <span class="st">&#39;content&#39;</span></span>
<span id="cb10-1081"><a href="#cb10-1081" aria-hidden="true" tabindex="-1"></a>                ])</span>
<span id="cb10-1082"><a href="#cb10-1082" aria-hidden="true" tabindex="-1"></a>                writer.writeheader()</span>
<span id="cb10-1083"><a href="#cb10-1083" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> i, msg <span class="kw">in</span> <span class="bu">enumerate</span>(conv[<span class="st">&#39;messages&#39;</span>]):</span>
<span id="cb10-1084"><a href="#cb10-1084" aria-hidden="true" tabindex="-1"></a>                    writer.writerow({</span>
<span id="cb10-1085"><a href="#cb10-1085" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;node_id&#39;</span>: <span class="bu">str</span>(i),</span>
<span id="cb10-1086"><a href="#cb10-1086" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;author&#39;</span>: msg[<span class="st">&#39;author&#39;</span>],</span>
<span id="cb10-1087"><a href="#cb10-1087" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;role&#39;</span>: msg[<span class="st">&#39;role&#39;</span>],</span>
<span id="cb10-1088"><a href="#cb10-1088" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;timestamp&#39;</span>: msg[<span class="st">&#39;timestamp&#39;</span>],</span>
<span id="cb10-1089"><a href="#cb10-1089" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;model&#39;</span>: msg[<span class="st">&#39;model&#39;</span>],</span>
<span id="cb10-1090"><a href="#cb10-1090" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;content&#39;</span>: msg[<span class="st">&#39;content&#39;</span>]</span>
<span id="cb10-1091"><a href="#cb10-1091" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb10-1092"><a href="#cb10-1092" aria-hidden="true" tabindex="-1"></a>            saved_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb10-1093"><a href="#cb10-1093" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb10-1094"><a href="#cb10-1094" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ CSV: </span><span class="sc">{</span>saved_count<span class="sc">}</span><span class="ss"> arquivos criados em &#39;</span><span class="sc">{</span>folder<span class="sc">}</span><span class="ss">&#39;&quot;</span>)</span>
<span id="cb10-1095"><a href="#cb10-1095" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-1096"><a href="#cb10-1096" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> save_as_json(<span class="va">self</span>):</span>
<span id="cb10-1097"><a href="#cb10-1097" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Salva conversas em arquivos JSON individuais&quot;&quot;&quot;</span></span>
<span id="cb10-1098"><a href="#cb10-1098" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb10-1099"><a href="#cb10-1099" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;üß™ [DRY-RUN] JSONs seriam criados:&quot;</span>)</span>
<span id="cb10-1100"><a href="#cb10-1100" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> conv <span class="kw">in</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb10-1101"><a href="#cb10-1101" aria-hidden="true" tabindex="-1"></a>                safe_title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(conv[<span class="st">&#39;title&#39;</span>])</span>
<span id="cb10-1102"><a href="#cb10-1102" aria-hidden="true" tabindex="-1"></a>                filename <span class="op">=</span> <span class="ss">f&quot;</span><span class="sc">{</span>conv[<span class="st">&#39;number&#39;</span>]<span class="sc">:03d}</span><span class="ss">_</span><span class="sc">{</span>conv[<span class="st">&#39;source&#39;</span>]<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>safe_title<span class="sc">}</span><span class="ss">.json&quot;</span></span>
<span id="cb10-1103"><a href="#cb10-1103" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;   üìã </span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb10-1104"><a href="#cb10-1104" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb10-1105"><a href="#cb10-1105" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb10-1106"><a href="#cb10-1106" aria-hidden="true" tabindex="-1"></a>        folder <span class="op">=</span> <span class="va">self</span>.output_dirs[<span class="st">&#39;json&#39;</span>]</span>
<span id="cb10-1107"><a href="#cb10-1107" aria-hidden="true" tabindex="-1"></a>        saved_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb10-1108"><a href="#cb10-1108" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-1109"><a href="#cb10-1109" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> conv <span class="kw">in</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb10-1110"><a href="#cb10-1110" aria-hidden="true" tabindex="-1"></a>            safe_title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(conv[<span class="st">&#39;title&#39;</span>])</span>
<span id="cb10-1111"><a href="#cb10-1111" aria-hidden="true" tabindex="-1"></a>            filename <span class="op">=</span> <span class="ss">f&quot;</span><span class="sc">{</span>conv[<span class="st">&#39;number&#39;</span>]<span class="sc">:03d}</span><span class="ss">_</span><span class="sc">{</span>conv[<span class="st">&#39;source&#39;</span>]<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>safe_title<span class="sc">}</span><span class="ss">.json&quot;</span></span>
<span id="cb10-1112"><a href="#cb10-1112" aria-hidden="true" tabindex="-1"></a>            filepath <span class="op">=</span> Path(folder) <span class="op">/</span> filename</span>
<span id="cb10-1113"><a href="#cb10-1113" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb10-1114"><a href="#cb10-1114" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.force_overwrite <span class="kw">and</span> filepath.exists():</span>
<span id="cb10-1115"><a href="#cb10-1115" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span></span>
<span id="cb10-1116"><a href="#cb10-1116" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb10-1117"><a href="#cb10-1117" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(filepath, <span class="st">&#39;w&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb10-1118"><a href="#cb10-1118" aria-hidden="true" tabindex="-1"></a>                json.dump(conv, f, ensure_ascii<span class="op">=</span><span class="va">False</span>, indent<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb10-1119"><a href="#cb10-1119" aria-hidden="true" tabindex="-1"></a>            saved_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb10-1120"><a href="#cb10-1120" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb10-1121"><a href="#cb10-1121" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ JSON: </span><span class="sc">{</span>saved_count<span class="sc">}</span><span class="ss"> arquivos criados em &#39;</span><span class="sc">{</span>folder<span class="sc">}</span><span class="ss">&#39;&quot;</span>)</span>
<span id="cb10-1122"><a href="#cb10-1122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-1123"><a href="#cb10-1123" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> save_all_to_single_files(<span class="va">self</span>):</span>
<span id="cb10-1124"><a href="#cb10-1124" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Salva todas as conversas em arquivos √∫nicos CSV e JSON&quot;&quot;&quot;</span></span>
<span id="cb10-1125"><a href="#cb10-1125" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb10-1126"><a href="#cb10-1126" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;üß™ [DRY-RUN] Arquivos √∫nicos seriam criados:&quot;</span>)</span>
<span id="cb10-1127"><a href="#cb10-1127" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;   üìÅ </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>single_files[<span class="st">&#39;csv&#39;</span>]<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb10-1128"><a href="#cb10-1128" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;   üìÅ </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>single_files[<span class="st">&#39;json&#39;</span>]<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb10-1129"><a href="#cb10-1129" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb10-1130"><a href="#cb10-1130" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb10-1131"><a href="#cb10-1131" aria-hidden="true" tabindex="-1"></a>        <span class="co"># CSV √∫nico</span></span>
<span id="cb10-1132"><a href="#cb10-1132" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> <span class="bu">open</span>(<span class="va">self</span>.single_files[<span class="st">&#39;csv&#39;</span>], <span class="st">&#39;w&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>, newline<span class="op">=</span><span class="st">&#39;&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb10-1133"><a href="#cb10-1133" aria-hidden="true" tabindex="-1"></a>            fieldnames <span class="op">=</span> [</span>
<span id="cb10-1134"><a href="#cb10-1134" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;conversation_number&#39;</span>, <span class="st">&#39;source&#39;</span>, <span class="st">&#39;conversation_title&#39;</span>, <span class="st">&#39;category&#39;</span>,</span>
<span id="cb10-1135"><a href="#cb10-1135" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;author&#39;</span>, <span class="st">&#39;role&#39;</span>, <span class="st">&#39;timestamp&#39;</span>, <span class="st">&#39;model&#39;</span>, <span class="st">&#39;content&#39;</span></span>
<span id="cb10-1136"><a href="#cb10-1136" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb10-1137"><a href="#cb10-1137" aria-hidden="true" tabindex="-1"></a>            writer <span class="op">=</span> csv.DictWriter(f, fieldnames<span class="op">=</span>fieldnames)</span>
<span id="cb10-1138"><a href="#cb10-1138" aria-hidden="true" tabindex="-1"></a>            writer.writeheader()</span>
<span id="cb10-1139"><a href="#cb10-1139" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> conv <span class="kw">in</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb10-1140"><a href="#cb10-1140" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> msg <span class="kw">in</span> conv[<span class="st">&#39;messages&#39;</span>]:</span>
<span id="cb10-1141"><a href="#cb10-1141" aria-hidden="true" tabindex="-1"></a>                    writer.writerow({</span>
<span id="cb10-1142"><a href="#cb10-1142" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;conversation_number&#39;</span>: conv[<span class="st">&#39;number&#39;</span>],</span>
<span id="cb10-1143"><a href="#cb10-1143" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;source&#39;</span>: conv[<span class="st">&#39;source&#39;</span>],</span>
<span id="cb10-1144"><a href="#cb10-1144" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;conversation_title&#39;</span>: conv[<span class="st">&#39;title&#39;</span>],</span>
<span id="cb10-1145"><a href="#cb10-1145" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;category&#39;</span>: conv[<span class="st">&#39;category&#39;</span>],</span>
<span id="cb10-1146"><a href="#cb10-1146" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;author&#39;</span>: msg[<span class="st">&#39;author&#39;</span>],</span>
<span id="cb10-1147"><a href="#cb10-1147" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;role&#39;</span>: msg[<span class="st">&#39;role&#39;</span>],</span>
<span id="cb10-1148"><a href="#cb10-1148" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;timestamp&#39;</span>: msg[<span class="st">&#39;timestamp&#39;</span>],</span>
<span id="cb10-1149"><a href="#cb10-1149" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;model&#39;</span>: msg[<span class="st">&#39;model&#39;</span>],</span>
<span id="cb10-1150"><a href="#cb10-1150" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;content&#39;</span>: msg[<span class="st">&#39;content&#39;</span>]</span>
<span id="cb10-1151"><a href="#cb10-1151" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb10-1152"><a href="#cb10-1152" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ CSV √∫nico: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>single_files[<span class="st">&#39;csv&#39;</span>]<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb10-1153"><a href="#cb10-1153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-1154"><a href="#cb10-1154" aria-hidden="true" tabindex="-1"></a>        <span class="co"># JSON √∫nico</span></span>
<span id="cb10-1155"><a href="#cb10-1155" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> <span class="bu">open</span>(<span class="va">self</span>.single_files[<span class="st">&#39;json&#39;</span>], <span class="st">&#39;w&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb10-1156"><a href="#cb10-1156" aria-hidden="true" tabindex="-1"></a>            json.dump(<span class="va">self</span>.all_conversations, f, ensure_ascii<span class="op">=</span><span class="va">False</span>, indent<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb10-1157"><a href="#cb10-1157" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ JSON √∫nico: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>single_files[<span class="st">&#39;json&#39;</span>]<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb10-1158"><a href="#cb10-1158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-1159"><a href="#cb10-1159" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_searchable_index(<span class="va">self</span>):</span>
<span id="cb10-1160"><a href="#cb10-1160" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Cria √≠ndice HTML pesquis√°vel com links para HTML&quot;&quot;&quot;</span></span>
<span id="cb10-1161"><a href="#cb10-1161" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb10-1162"><a href="#cb10-1162" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;üß™ [DRY-RUN] √çndice HTML seria criado: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>index_file<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb10-1163"><a href="#cb10-1163" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb10-1164"><a href="#cb10-1164" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb10-1165"><a href="#cb10-1165" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;üéØ Criando √≠ndice HTML combinado...&quot;</span>)</span>
<span id="cb10-1166"><a href="#cb10-1166" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-1167"><a href="#cb10-1167" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Estat√≠sticas por categoria</span></span>
<span id="cb10-1168"><a href="#cb10-1168" aria-hidden="true" tabindex="-1"></a>        category_stats <span class="op">=</span> {}</span>
<span id="cb10-1169"><a href="#cb10-1169" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> conv <span class="kw">in</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb10-1170"><a href="#cb10-1170" aria-hidden="true" tabindex="-1"></a>            cat <span class="op">=</span> conv[<span class="st">&#39;category&#39;</span>]</span>
<span id="cb10-1171"><a href="#cb10-1171" aria-hidden="true" tabindex="-1"></a>            category_stats[cat] <span class="op">=</span> category_stats.get(cat, <span class="dv">0</span>) <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb10-1172"><a href="#cb10-1172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-1173"><a href="#cb10-1173" aria-hidden="true" tabindex="-1"></a>        <span class="co"># HTML content com links para HTML</span></span>
<span id="cb10-1174"><a href="#cb10-1174" aria-hidden="true" tabindex="-1"></a>        html_content <span class="op">=</span> <span class="ss">f&quot;&quot;&quot;&lt;!DOCTYPE html&gt;</span></span>
<span id="cb10-1175"><a href="#cb10-1175" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;html lang=&quot;pt-PT&quot;&gt;</span></span>
<span id="cb10-1176"><a href="#cb10-1176" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;head&gt;</span></span>
<span id="cb10-1177"><a href="#cb10-1177" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span></span>
<span id="cb10-1178"><a href="#cb10-1178" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span></span>
<span id="cb10-1179"><a href="#cb10-1179" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;title&gt;√çndice Combinado - AI Chats&lt;/title&gt;</span></span>
<span id="cb10-1180"><a href="#cb10-1180" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;style&gt;</span></span>
<span id="cb10-1181"><a href="#cb10-1181" aria-hidden="true" tabindex="-1"></a><span class="ss">        /* ... (mantido o mesmo CSS do anterior) ... */</span></span>
<span id="cb10-1182"><a href="#cb10-1182" aria-hidden="true" tabindex="-1"></a><span class="ss">        * </span><span class="ch">{{</span><span class="ss"> margin: 0; padding: 0; box-sizing: border-box; </span><span class="ch">}}</span></span>
<span id="cb10-1183"><a href="#cb10-1183" aria-hidden="true" tabindex="-1"></a><span class="ss">        body </span><span class="ch">{{</span><span class="ss"> font-family: &#39;Segoe UI&#39;, Tahoma, Geneva, Verdana, sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; padding: 20px; color: #333; </span><span class="ch">}}</span></span>
<span id="cb10-1184"><a href="#cb10-1184" aria-hidden="true" tabindex="-1"></a><span class="ss">        .container </span><span class="ch">{{</span><span class="ss"> max-width: 1400px; margin: 0 auto; background: white; border-radius: 15px; box-shadow: 0 20px 40px rgba(0,0,0,0.1); overflow: hidden; </span><span class="ch">}}</span></span>
<span id="cb10-1185"><a href="#cb10-1185" aria-hidden="true" tabindex="-1"></a><span class="ss">        .header </span><span class="ch">{{</span><span class="ss"> background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 40px; text-align: center; </span><span class="ch">}}</span></span>
<span id="cb10-1186"><a href="#cb10-1186" aria-hidden="true" tabindex="-1"></a><span class="ss">        .header h1 </span><span class="ch">{{</span><span class="ss"> font-size: 2.8em; margin-bottom: 15px; font-weight: 300; </span><span class="ch">}}</span></span>
<span id="cb10-1187"><a href="#cb10-1187" aria-hidden="true" tabindex="-1"></a><span class="ss">        .header p </span><span class="ch">{{</span><span class="ss"> font-size: 1.2em; opacity: 0.9; margin-bottom: 20px; </span><span class="ch">}}</span></span>
<span id="cb10-1188"><a href="#cb10-1188" aria-hidden="true" tabindex="-1"></a><span class="ss">        .stats </span><span class="ch">{{</span><span class="ss"> display: flex; justify-content: center; gap: 30px; margin-top: 25px; flex-wrap: wrap; </span><span class="ch">}}</span></span>
<span id="cb10-1189"><a href="#cb10-1189" aria-hidden="true" tabindex="-1"></a><span class="ss">        .stat-item </span><span class="ch">{{</span><span class="ss"> background: rgba(255,255,255,0.15); padding: 18px 28px; border-radius: 12px; backdrop-filter: blur(10px); font-size: 1.1em; </span><span class="ch">}}</span></span>
<span id="cb10-1190"><a href="#cb10-1190" aria-hidden="true" tabindex="-1"></a><span class="ss">        .search-section </span><span class="ch">{{</span><span class="ss"> padding: 30px; background: #f8f9fa; border-bottom: 1px solid #e9ecef; </span><span class="ch">}}</span></span>
<span id="cb10-1191"><a href="#cb10-1191" aria-hidden="true" tabindex="-1"></a><span class="ss">        .search-box </span><span class="ch">{{</span><span class="ss"> width: 100%; padding: 18px 25px; font-size: 16px; border: 2px solid #e9ecef; border-radius: 25px; outline: none; transition: all 0.3s ease; font-family: inherit; </span><span class="ch">}}</span></span>
<span id="cb10-1192"><a href="#cb10-1192" aria-hidden="true" tabindex="-1"></a><span class="ss">        .search-box:focus </span><span class="ch">{{</span><span class="ss"> border-color: #667eea; box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1); </span><span class="ch">}}</span></span>
<span id="cb10-1193"><a href="#cb10-1193" aria-hidden="true" tabindex="-1"></a><span class="ss">        .filter-section </span><span class="ch">{{</span></span>
<span id="cb10-1194"><a href="#cb10-1194" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 20px 30px;</span></span>
<span id="cb10-1195"><a href="#cb10-1195" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: flex;</span></span>
<span id="cb10-1196"><a href="#cb10-1196" aria-hidden="true" tabindex="-1"></a><span class="ss">            flex-wrap: wrap;</span></span>
<span id="cb10-1197"><a href="#cb10-1197" aria-hidden="true" tabindex="-1"></a><span class="ss">            gap: 12px;</span></span>
<span id="cb10-1198"><a href="#cb10-1198" aria-hidden="true" tabindex="-1"></a><span class="ss">            justify-content: center;</span></span>
<span id="cb10-1199"><a href="#cb10-1199" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #f8f9fa;</span></span>
<span id="cb10-1200"><a href="#cb10-1200" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-bottom: 1px solid #e9ecef;</span></span>
<span id="cb10-1201"><a href="#cb10-1201" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-1202"><a href="#cb10-1202" aria-hidden="true" tabindex="-1"></a><span class="ss">        .filter-btn </span><span class="ch">{{</span></span>
<span id="cb10-1203"><a href="#cb10-1203" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 10px 20px;</span></span>
<span id="cb10-1204"><a href="#cb10-1204" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: white;</span></span>
<span id="cb10-1205"><a href="#cb10-1205" aria-hidden="true" tabindex="-1"></a><span class="ss">            border: 2px solid #e9ecef;</span></span>
<span id="cb10-1206"><a href="#cb10-1206" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 25px;</span></span>
<span id="cb10-1207"><a href="#cb10-1207" aria-hidden="true" tabindex="-1"></a><span class="ss">            cursor: pointer;</span></span>
<span id="cb10-1208"><a href="#cb10-1208" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.95em;</span></span>
<span id="cb10-1209"><a href="#cb10-1209" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-weight: 500;</span></span>
<span id="cb10-1210"><a href="#cb10-1210" aria-hidden="true" tabindex="-1"></a><span class="ss">            transition: all 0.3s ease;</span></span>
<span id="cb10-1211"><a href="#cb10-1211" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-family: inherit;</span></span>
<span id="cb10-1212"><a href="#cb10-1212" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-1213"><a href="#cb10-1213" aria-hidden="true" tabindex="-1"></a><span class="ss">        .filter-btn.active, .filter-btn:hover </span><span class="ch">{{</span></span>
<span id="cb10-1214"><a href="#cb10-1214" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #667eea;</span></span>
<span id="cb10-1215"><a href="#cb10-1215" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: white;</span></span>
<span id="cb10-1216"><a href="#cb10-1216" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-color: #667eea;</span></span>
<span id="cb10-1217"><a href="#cb10-1217" aria-hidden="true" tabindex="-1"></a><span class="ss">            transform: translateY(-2px);</span></span>
<span id="cb10-1218"><a href="#cb10-1218" aria-hidden="true" tabindex="-1"></a><span class="ss">            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);</span></span>
<span id="cb10-1219"><a href="#cb10-1219" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-1220"><a href="#cb10-1220" aria-hidden="true" tabindex="-1"></a><span class="ss">        .conversations-grid </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb10-1221"><a href="#cb10-1221" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: grid; </span></span>
<span id="cb10-1222"><a href="#cb10-1222" aria-hidden="true" tabindex="-1"></a><span class="ss">            grid-template-columns: repeat(auto-fill, minmax(380px, 1fr)); </span></span>
<span id="cb10-1223"><a href="#cb10-1223" aria-hidden="true" tabindex="-1"></a><span class="ss">            gap: 25px; </span></span>
<span id="cb10-1224"><a href="#cb10-1224" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 35px;</span></span>
<span id="cb10-1225"><a href="#cb10-1225" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);</span></span>
<span id="cb10-1226"><a href="#cb10-1226" aria-hidden="true" tabindex="-1"></a><span class="ss">            min-height: 400px;</span></span>
<span id="cb10-1227"><a href="#cb10-1227" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-1228"><a href="#cb10-1228" aria-hidden="true" tabindex="-1"></a><span class="ss">        .conversation-card </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb10-1229"><a href="#cb10-1229" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: white; </span></span>
<span id="cb10-1230"><a href="#cb10-1230" aria-hidden="true" tabindex="-1"></a><span class="ss">            border: 1px solid #e9ecef; </span></span>
<span id="cb10-1231"><a href="#cb10-1231" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 15px; </span></span>
<span id="cb10-1232"><a href="#cb10-1232" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 25px; </span></span>
<span id="cb10-1233"><a href="#cb10-1233" aria-hidden="true" tabindex="-1"></a><span class="ss">            transition: all 0.4s ease; </span></span>
<span id="cb10-1234"><a href="#cb10-1234" aria-hidden="true" tabindex="-1"></a><span class="ss">            cursor: pointer; </span></span>
<span id="cb10-1235"><a href="#cb10-1235" aria-hidden="true" tabindex="-1"></a><span class="ss">            position: relative;</span></span>
<span id="cb10-1236"><a href="#cb10-1236" aria-hidden="true" tabindex="-1"></a><span class="ss">            box-shadow: 0 5px 15px rgba(0,0,0,0.08);</span></span>
<span id="cb10-1237"><a href="#cb10-1237" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-1238"><a href="#cb10-1238" aria-hidden="true" tabindex="-1"></a><span class="ss">        .conversation-card:hover </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb10-1239"><a href="#cb10-1239" aria-hidden="true" tabindex="-1"></a><span class="ss">            transform: translateY(-8px); </span></span>
<span id="cb10-1240"><a href="#cb10-1240" aria-hidden="true" tabindex="-1"></a><span class="ss">            box-shadow: 0 15px 35px rgba(0,0,0,0.15); </span></span>
<span id="cb10-1241"><a href="#cb10-1241" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-color: #667eea;</span></span>
<span id="cb10-1242"><a href="#cb10-1242" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-1243"><a href="#cb10-1243" aria-hidden="true" tabindex="-1"></a><span class="ss">        .card-header </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb10-1244"><a href="#cb10-1244" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: flex; </span></span>
<span id="cb10-1245"><a href="#cb10-1245" aria-hidden="true" tabindex="-1"></a><span class="ss">            justify-content: space-between; </span></span>
<span id="cb10-1246"><a href="#cb10-1246" aria-hidden="true" tabindex="-1"></a><span class="ss">            align-items: flex-start; </span></span>
<span id="cb10-1247"><a href="#cb10-1247" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-bottom: 18px; </span></span>
<span id="cb10-1248"><a href="#cb10-1248" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-1249"><a href="#cb10-1249" aria-hidden="true" tabindex="-1"></a><span class="ss">        .card-number </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb10-1250"><a href="#cb10-1250" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: linear-gradient(135deg, #667eea, #764ba2); </span></span>
<span id="cb10-1251"><a href="#cb10-1251" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: white; </span></span>
<span id="cb10-1252"><a href="#cb10-1252" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 8px 16px; </span></span>
<span id="cb10-1253"><a href="#cb10-1253" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 20px; </span></span>
<span id="cb10-1254"><a href="#cb10-1254" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.9em; </span></span>
<span id="cb10-1255"><a href="#cb10-1255" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-weight: bold;</span></span>
<span id="cb10-1256"><a href="#cb10-1256" aria-hidden="true" tabindex="-1"></a><span class="ss">            box-shadow: 0 3px 10px rgba(102, 126, 234, 0.3);</span></span>
<span id="cb10-1257"><a href="#cb10-1257" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-1258"><a href="#cb10-1258" aria-hidden="true" tabindex="-1"></a><span class="ss">        .card-source </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb10-1259"><a href="#cb10-1259" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #e3f2fd; </span></span>
<span id="cb10-1260"><a href="#cb10-1260" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #1976d2; </span></span>
<span id="cb10-1261"><a href="#cb10-1261" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 5px 12px; </span></span>
<span id="cb10-1262"><a href="#cb10-1262" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 12px; </span></span>
<span id="cb10-1263"><a href="#cb10-1263" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.85em; </span></span>
<span id="cb10-1264"><a href="#cb10-1264" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-weight: bold; </span></span>
<span id="cb10-1265"><a href="#cb10-1265" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-left: 10px;</span></span>
<span id="cb10-1266"><a href="#cb10-1266" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-1267"><a href="#cb10-1267" aria-hidden="true" tabindex="-1"></a><span class="ss">        .card-title </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb10-1268"><a href="#cb10-1268" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 1.3em; </span></span>
<span id="cb10-1269"><a href="#cb10-1269" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-weight: 600; </span></span>
<span id="cb10-1270"><a href="#cb10-1270" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #2c3e50; </span></span>
<span id="cb10-1271"><a href="#cb10-1271" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-bottom: 12px; </span></span>
<span id="cb10-1272"><a href="#cb10-1272" aria-hidden="true" tabindex="-1"></a><span class="ss">            line-height: 1.4;</span></span>
<span id="cb10-1273"><a href="#cb10-1273" aria-hidden="true" tabindex="-1"></a><span class="ss">            min-height: 3.6em;</span></span>
<span id="cb10-1274"><a href="#cb10-1274" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-1275"><a href="#cb10-1275" aria-hidden="true" tabindex="-1"></a><span class="ss">        .card-summary </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb10-1276"><a href="#cb10-1276" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #6c757d; </span></span>
<span id="cb10-1277"><a href="#cb10-1277" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.95em; </span></span>
<span id="cb10-1278"><a href="#cb10-1278" aria-hidden="true" tabindex="-1"></a><span class="ss">            line-height: 1.5; </span></span>
<span id="cb10-1279"><a href="#cb10-1279" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-bottom: 18px;</span></span>
<span id="cb10-1280"><a href="#cb10-1280" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: -webkit-box;</span></span>
<span id="cb10-1281"><a href="#cb10-1281" aria-hidden="true" tabindex="-1"></a><span class="ss">            -webkit-line-clamp: 3;</span></span>
<span id="cb10-1282"><a href="#cb10-1282" aria-hidden="true" tabindex="-1"></a><span class="ss">            -webkit-box-orient: vertical;</span></span>
<span id="cb10-1283"><a href="#cb10-1283" aria-hidden="true" tabindex="-1"></a><span class="ss">            overflow: hidden;</span></span>
<span id="cb10-1284"><a href="#cb10-1284" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-1285"><a href="#cb10-1285" aria-hidden="true" tabindex="-1"></a><span class="ss">        .card-meta </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb10-1286"><a href="#cb10-1286" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: flex; </span></span>
<span id="cb10-1287"><a href="#cb10-1287" aria-hidden="true" tabindex="-1"></a><span class="ss">            justify-content: space-between; </span></span>
<span id="cb10-1288"><a href="#cb10-1288" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.85em; </span></span>
<span id="cb10-1289"><a href="#cb10-1289" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #868e96; </span></span>
<span id="cb10-1290"><a href="#cb10-1290" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-top: 1px solid #e9ecef; </span></span>
<span id="cb10-1291"><a href="#cb10-1291" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding-top: 18px;</span></span>
<span id="cb10-1292"><a href="#cb10-1292" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-1293"><a href="#cb10-1293" aria-hidden="true" tabindex="-1"></a><span class="ss">        .card-actions </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb10-1294"><a href="#cb10-1294" aria-hidden="true" tabindex="-1"></a><span class="ss">            position: absolute; </span></span>
<span id="cb10-1295"><a href="#cb10-1295" aria-hidden="true" tabindex="-1"></a><span class="ss">            top: 20px; </span></span>
<span id="cb10-1296"><a href="#cb10-1296" aria-hidden="true" tabindex="-1"></a><span class="ss">            right: 20px; </span></span>
<span id="cb10-1297"><a href="#cb10-1297" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: flex; </span></span>
<span id="cb10-1298"><a href="#cb10-1298" aria-hidden="true" tabindex="-1"></a><span class="ss">            gap: 8px; </span></span>
<span id="cb10-1299"><a href="#cb10-1299" aria-hidden="true" tabindex="-1"></a><span class="ss">            opacity: 0; </span></span>
<span id="cb10-1300"><a href="#cb10-1300" aria-hidden="true" tabindex="-1"></a><span class="ss">            transition: opacity 0.3s ease; </span></span>
<span id="cb10-1301"><a href="#cb10-1301" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-1302"><a href="#cb10-1302" aria-hidden="true" tabindex="-1"></a><span class="ss">        .conversation-card:hover .card-actions </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb10-1303"><a href="#cb10-1303" aria-hidden="true" tabindex="-1"></a><span class="ss">            opacity: 1; </span></span>
<span id="cb10-1304"><a href="#cb10-1304" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-1305"><a href="#cb10-1305" aria-hidden="true" tabindex="-1"></a><span class="ss">        .action-btn </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb10-1306"><a href="#cb10-1306" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: white; </span></span>
<span id="cb10-1307"><a href="#cb10-1307" aria-hidden="true" tabindex="-1"></a><span class="ss">            border: 2px solid #e9ecef; </span></span>
<span id="cb10-1308"><a href="#cb10-1308" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 8px; </span></span>
<span id="cb10-1309"><a href="#cb10-1309" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 6px 12px; </span></span>
<span id="cb10-1310"><a href="#cb10-1310" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.8em; </span></span>
<span id="cb10-1311"><a href="#cb10-1311" aria-hidden="true" tabindex="-1"></a><span class="ss">            cursor: pointer; </span></span>
<span id="cb10-1312"><a href="#cb10-1312" aria-hidden="true" tabindex="-1"></a><span class="ss">            transition: all 0.3s ease;</span></span>
<span id="cb10-1313"><a href="#cb10-1313" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-weight: 500;</span></span>
<span id="cb10-1314"><a href="#cb10-1314" aria-hidden="true" tabindex="-1"></a><span class="ss">            text-decoration: none;</span></span>
<span id="cb10-1315"><a href="#cb10-1315" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #333;</span></span>
<span id="cb10-1316"><a href="#cb10-1316" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: inline-block;</span></span>
<span id="cb10-1317"><a href="#cb10-1317" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-1318"><a href="#cb10-1318" aria-hidden="true" tabindex="-1"></a><span class="ss">        .action-btn:hover </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb10-1319"><a href="#cb10-1319" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #667eea; </span></span>
<span id="cb10-1320"><a href="#cb10-1320" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: white; </span></span>
<span id="cb10-1321"><a href="#cb10-1321" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-color: #667eea;</span></span>
<span id="cb10-1322"><a href="#cb10-1322" aria-hidden="true" tabindex="-1"></a><span class="ss">            transform: scale(1.05);</span></span>
<span id="cb10-1323"><a href="#cb10-1323" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-1324"><a href="#cb10-1324" aria-hidden="true" tabindex="-1"></a><span class="ss">        .recent-badge </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb10-1325"><a href="#cb10-1325" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #ff6b6b; </span></span>
<span id="cb10-1326"><a href="#cb10-1326" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: white; </span></span>
<span id="cb10-1327"><a href="#cb10-1327" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 3px 10px; </span></span>
<span id="cb10-1328"><a href="#cb10-1328" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 12px; </span></span>
<span id="cb10-1329"><a href="#cb10-1329" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.75em; </span></span>
<span id="cb10-1330"><a href="#cb10-1330" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-left: 8px;</span></span>
<span id="cb10-1331"><a href="#cb10-1331" aria-hidden="true" tabindex="-1"></a><span class="ss">            animation: pulse 2s infinite;</span></span>
<span id="cb10-1332"><a href="#cb10-1332" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-1333"><a href="#cb10-1333" aria-hidden="true" tabindex="-1"></a><span class="ss">        .no-results </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb10-1334"><a href="#cb10-1334" aria-hidden="true" tabindex="-1"></a><span class="ss">            text-align: center; </span></span>
<span id="cb10-1335"><a href="#cb10-1335" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 60px 20px; </span></span>
<span id="cb10-1336"><a href="#cb10-1336" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #6c757d;</span></span>
<span id="cb10-1337"><a href="#cb10-1337" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 1.1em;</span></span>
<span id="cb10-1338"><a href="#cb10-1338" aria-hidden="true" tabindex="-1"></a><span class="ss">            grid-column: 1 / -1;</span></span>
<span id="cb10-1339"><a href="#cb10-1339" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-1340"><a href="#cb10-1340" aria-hidden="true" tabindex="-1"></a><span class="ss">        @keyframes pulse </span><span class="ch">{{</span></span>
<span id="cb10-1341"><a href="#cb10-1341" aria-hidden="true" tabindex="-1"></a><span class="ss">            0% </span><span class="ch">{{</span><span class="ss"> transform: scale(1); </span><span class="ch">}}</span></span>
<span id="cb10-1342"><a href="#cb10-1342" aria-hidden="true" tabindex="-1"></a><span class="ss">            50% </span><span class="ch">{{</span><span class="ss"> transform: scale(1.05); </span><span class="ch">}}</span></span>
<span id="cb10-1343"><a href="#cb10-1343" aria-hidden="true" tabindex="-1"></a><span class="ss">            100% </span><span class="ch">{{</span><span class="ss"> transform: scale(1); </span><span class="ch">}}</span></span>
<span id="cb10-1344"><a href="#cb10-1344" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-1345"><a href="#cb10-1345" aria-hidden="true" tabindex="-1"></a><span class="ss">        .category-badge </span><span class="ch">{{</span></span>
<span id="cb10-1346"><a href="#cb10-1346" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: inline-block;</span></span>
<span id="cb10-1347"><a href="#cb10-1347" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #e3f2fd;</span></span>
<span id="cb10-1348"><a href="#cb10-1348" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #1976d2;</span></span>
<span id="cb10-1349"><a href="#cb10-1349" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 4px 10px;</span></span>
<span id="cb10-1350"><a href="#cb10-1350" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 12px;</span></span>
<span id="cb10-1351"><a href="#cb10-1351" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.8em;</span></span>
<span id="cb10-1352"><a href="#cb10-1352" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-left: 8px;</span></span>
<span id="cb10-1353"><a href="#cb10-1353" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-weight: 500;</span></span>
<span id="cb10-1354"><a href="#cb10-1354" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-1355"><a href="#cb10-1355" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb10-1356"><a href="#cb10-1356" aria-hidden="true" tabindex="-1"></a><span class="ss">        .direct-link </span><span class="ch">{{</span></span>
<span id="cb10-1357"><a href="#cb10-1357" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: inline-block;</span></span>
<span id="cb10-1358"><a href="#cb10-1358" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin: 5px;</span></span>
<span id="cb10-1359"><a href="#cb10-1359" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 8px 15px;</span></span>
<span id="cb10-1360"><a href="#cb10-1360" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #28a745;</span></span>
<span id="cb10-1361"><a href="#cb10-1361" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: white;</span></span>
<span id="cb10-1362"><a href="#cb10-1362" aria-hidden="true" tabindex="-1"></a><span class="ss">            text-decoration: none;</span></span>
<span id="cb10-1363"><a href="#cb10-1363" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 5px;</span></span>
<span id="cb10-1364"><a href="#cb10-1364" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.9em;</span></span>
<span id="cb10-1365"><a href="#cb10-1365" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-1366"><a href="#cb10-1366" aria-hidden="true" tabindex="-1"></a><span class="ss">        .direct-link:hover </span><span class="ch">{{</span></span>
<span id="cb10-1367"><a href="#cb10-1367" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #218838;</span></span>
<span id="cb10-1368"><a href="#cb10-1368" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-1369"><a href="#cb10-1369" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb10-1370"><a href="#cb10-1370" aria-hidden="true" tabindex="-1"></a><span class="ss">        /* NOVO: Estilo para link HTML */</span></span>
<span id="cb10-1371"><a href="#cb10-1371" aria-hidden="true" tabindex="-1"></a><span class="ss">        .html-btn </span><span class="ch">{{</span></span>
<span id="cb10-1372"><a href="#cb10-1372" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #17a2b8;</span></span>
<span id="cb10-1373"><a href="#cb10-1373" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: white;</span></span>
<span id="cb10-1374"><a href="#cb10-1374" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-1375"><a href="#cb10-1375" aria-hidden="true" tabindex="-1"></a><span class="ss">        .html-btn:hover </span><span class="ch">{{</span></span>
<span id="cb10-1376"><a href="#cb10-1376" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #138496;</span></span>
<span id="cb10-1377"><a href="#cb10-1377" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb10-1378"><a href="#cb10-1378" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;/style&gt;</span></span>
<span id="cb10-1379"><a href="#cb10-1379" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;/head&gt;</span></span>
<span id="cb10-1380"><a href="#cb10-1380" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;body&gt;</span></span>
<span id="cb10-1381"><a href="#cb10-1381" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;div class=&quot;container&quot;&gt;</span></span>
<span id="cb10-1382"><a href="#cb10-1382" aria-hidden="true" tabindex="-1"></a><span class="ss">        &lt;div class=&quot;header&quot;&gt;</span></span>
<span id="cb10-1383"><a href="#cb10-1383" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;h1&gt;üìö √çndice Combinado de Conversas&lt;/h1&gt;</span></span>
<span id="cb10-1384"><a href="#cb10-1384" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;p&gt;Qwen3 ‚Ä¢ ChatGPT ‚Ä¢ DeepSeek ‚Ä¢ Grok ‚Ä¢ COM HTML&lt;/p&gt;</span></span>
<span id="cb10-1385"><a href="#cb10-1385" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;div class=&quot;stats&quot;&gt;</span></span>
<span id="cb10-1386"><a href="#cb10-1386" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;div class=&quot;stat-item&quot;&gt;</span></span>
<span id="cb10-1387"><a href="#cb10-1387" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;strong&gt;Total:&lt;/strong&gt; &lt;span id=&quot;total-count&quot;&gt;</span><span class="sc">{</span><span class="bu">len</span>(<span class="va">self</span>.all_conversations)<span class="sc">}</span><span class="ss">&lt;/span&gt; conversas</span></span>
<span id="cb10-1388"><a href="#cb10-1388" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;/div&gt;</span></span>
<span id="cb10-1389"><a href="#cb10-1389" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;div class=&quot;stat-item&quot;&gt;</span></span>
<span id="cb10-1390"><a href="#cb10-1390" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;strong&gt;Ordena√ß√£o:&lt;/strong&gt; Mais Recentes Primeiro</span></span>
<span id="cb10-1391"><a href="#cb10-1391" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;/div&gt;</span></span>
<span id="cb10-1392"><a href="#cb10-1392" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;div class=&quot;stat-item&quot;&gt;</span></span>
<span id="cb10-1393"><a href="#cb10-1393" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;strong&gt;Atualizado:&lt;/strong&gt; </span><span class="sc">{</span>datetime<span class="sc">.</span>now()<span class="sc">.</span>strftime(<span class="st">&#39;</span><span class="sc">%d</span><span class="st">/%m/%Y %H:%M&#39;</span>)<span class="sc">}</span></span>
<span id="cb10-1394"><a href="#cb10-1394" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;/div&gt;</span></span>
<span id="cb10-1395"><a href="#cb10-1395" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;/div&gt;</span></span>
<span id="cb10-1396"><a href="#cb10-1396" aria-hidden="true" tabindex="-1"></a><span class="ss">        &lt;/div&gt;</span></span>
<span id="cb10-1397"><a href="#cb10-1397" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb10-1398"><a href="#cb10-1398" aria-hidden="true" tabindex="-1"></a><span class="ss">        &lt;div class=&quot;search-section&quot;&gt;</span></span>
<span id="cb10-1399"><a href="#cb10-1399" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;input type=&quot;text&quot; id=&quot;searchInput&quot; class=&quot;search-box&quot; placeholder=&quot;üîç Pesquisar por t√≠tulo, conte√∫do ou categoria...&quot;&gt;</span></span>
<span id="cb10-1400"><a href="#cb10-1400" aria-hidden="true" tabindex="-1"></a><span class="ss">        &lt;/div&gt;</span></span>
<span id="cb10-1401"><a href="#cb10-1401" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb10-1402"><a href="#cb10-1402" aria-hidden="true" tabindex="-1"></a><span class="ss">        &lt;div class=&quot;filter-section&quot;&gt;</span></span>
<span id="cb10-1403"><a href="#cb10-1403" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;button class=&quot;filter-btn active&quot; data-filter=&quot;todas&quot;&gt;Todas (</span><span class="sc">{</span><span class="bu">len</span>(<span class="va">self</span>.all_conversations)<span class="sc">}</span><span class="ss">)&lt;/button&gt;</span></span>
<span id="cb10-1404"><a href="#cb10-1404" aria-hidden="true" tabindex="-1"></a><span class="ss">&quot;&quot;&quot;</span></span>
<span id="cb10-1405"><a href="#cb10-1405" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-1406"><a href="#cb10-1406" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Bot√µes de filtro por categoria</span></span>
<span id="cb10-1407"><a href="#cb10-1407" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> category, count <span class="kw">in</span> category_stats.items():</span>
<span id="cb10-1408"><a href="#cb10-1408" aria-hidden="true" tabindex="-1"></a>            html_content <span class="op">+=</span> <span class="ss">f&#39;&lt;button class=&quot;filter-btn&quot; data-filter=&quot;</span><span class="sc">{</span>category<span class="sc">.</span>lower()<span class="sc">}</span><span class="ss">&quot;&gt;</span><span class="sc">{</span>category<span class="sc">}</span><span class="ss"> (</span><span class="sc">{</span>count<span class="sc">}</span><span class="ss">)&lt;/button&gt;</span><span class="ch">\n</span><span class="ss">&#39;</span></span>
<span id="cb10-1409"><a href="#cb10-1409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-1410"><a href="#cb10-1410" aria-hidden="true" tabindex="-1"></a>        html_content <span class="op">+=</span> <span class="st">&quot;&quot;&quot;</span></span>
<span id="cb10-1411"><a href="#cb10-1411" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;/div&gt;</span></span>
<span id="cb10-1412"><a href="#cb10-1412" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb10-1413"><a href="#cb10-1413" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;!-- LINKS DIRETOS DE FALLBACK --&gt;</span></span>
<span id="cb10-1414"><a href="#cb10-1414" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;div style=&quot;text-align: center; padding: 15px; background: #e9ecef; border-bottom: 1px solid #ddd;&quot;&gt;</span></span>
<span id="cb10-1415"><a href="#cb10-1415" aria-hidden="true" tabindex="-1"></a><span class="st">            &lt;strong&gt;Acesso R√°pido:&lt;/strong&gt;</span></span>
<span id="cb10-1416"><a href="#cb10-1416" aria-hidden="true" tabindex="-1"></a><span class="st">            &lt;a href=&quot;combined_markdown/&quot; class=&quot;direct-link&quot; target=&quot;_blank&quot;&gt;üìÅ Markdown&lt;/a&gt;</span></span>
<span id="cb10-1417"><a href="#cb10-1417" aria-hidden="true" tabindex="-1"></a><span class="st">            &lt;a href=&quot;combined_html/&quot; class=&quot;direct-link&quot; target=&quot;_blank&quot;&gt;üåê HTML&lt;/a&gt;</span></span>
<span id="cb10-1418"><a href="#cb10-1418" aria-hidden="true" tabindex="-1"></a><span class="st">            &lt;a href=&quot;combined_pdfs/&quot; class=&quot;direct-link&quot; target=&quot;_blank&quot;&gt;üìä PDFs&lt;/a&gt;</span></span>
<span id="cb10-1419"><a href="#cb10-1419" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;/div&gt;</span></span>
<span id="cb10-1420"><a href="#cb10-1420" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb10-1421"><a href="#cb10-1421" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;div class=&quot;conversations-grid&quot; id=&quot;conversationsGrid&quot;&gt;</span></span>
<span id="cb10-1422"><a href="#cb10-1422" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;&quot;&quot;</span></span>
<span id="cb10-1423"><a href="#cb10-1423" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-1424"><a href="#cb10-1424" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Cards das conversas - COM LINK HTML</span></span>
<span id="cb10-1425"><a href="#cb10-1425" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, conv <span class="kw">in</span> <span class="bu">enumerate</span>(<span class="va">self</span>.all_conversations):</span>
<span id="cb10-1426"><a href="#cb10-1426" aria-hidden="true" tabindex="-1"></a>            safe_title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(conv[<span class="st">&#39;title&#39;</span>])</span>
<span id="cb10-1427"><a href="#cb10-1427" aria-hidden="true" tabindex="-1"></a>            filename <span class="op">=</span> <span class="ss">f&quot;</span><span class="sc">{</span>conv[<span class="st">&#39;number&#39;</span>]<span class="sc">:03d}</span><span class="ss">_</span><span class="sc">{</span>conv[<span class="st">&#39;source&#39;</span>]<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>safe_title<span class="sc">}</span><span class="ss">&quot;</span></span>
<span id="cb10-1428"><a href="#cb10-1428" aria-hidden="true" tabindex="-1"></a>            recent_badge <span class="op">=</span> <span class="st">&quot;&lt;span class=&#39;recent-badge&#39;&gt;NOVO&lt;/span&gt;&quot;</span> <span class="cf">if</span> i <span class="op">&lt;</span> <span class="dv">5</span> <span class="cf">else</span> <span class="st">&quot;&quot;</span></span>
<span id="cb10-1429"><a href="#cb10-1429" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb10-1430"><a href="#cb10-1430" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Resumo mais informativo</span></span>
<span id="cb10-1431"><a href="#cb10-1431" aria-hidden="true" tabindex="-1"></a>            summary <span class="op">=</span> conv.get(<span class="st">&#39;summary&#39;</span>, <span class="st">&#39;Sem resumo dispon√≠vel&#39;</span>)</span>
<span id="cb10-1432"><a href="#cb10-1432" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">len</span>(summary) <span class="op">&gt;</span> <span class="dv">150</span>:</span>
<span id="cb10-1433"><a href="#cb10-1433" aria-hidden="true" tabindex="-1"></a>                summary <span class="op">=</span> summary[:<span class="dv">150</span>] <span class="op">+</span> <span class="st">&quot;...&quot;</span></span>
<span id="cb10-1434"><a href="#cb10-1434" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb10-1435"><a href="#cb10-1435" aria-hidden="true" tabindex="-1"></a>            html_content <span class="op">+=</span> <span class="ss">f&quot;&quot;&quot;</span></span>
<span id="cb10-1436"><a href="#cb10-1436" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;div class=&quot;conversation-card&quot; data-title=&quot;</span><span class="sc">{</span>conv[<span class="st">&#39;title&#39;</span>]<span class="sc">}</span><span class="ss">&quot; data-summary=&quot;</span><span class="sc">{</span>summary<span class="sc">}</span><span class="ss">&quot; data-source=&quot;</span><span class="sc">{</span>conv[<span class="st">&#39;source&#39;</span>]<span class="sc">.</span>lower()<span class="sc">}</span><span class="ss">&quot; data-category=&quot;</span><span class="sc">{</span>conv[<span class="st">&#39;category&#39;</span>]<span class="sc">.</span>lower()<span class="sc">}</span><span class="ss">&quot;&gt;</span></span>
<span id="cb10-1437"><a href="#cb10-1437" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;div class=&quot;card-header&quot;&gt;</span></span>
<span id="cb10-1438"><a href="#cb10-1438" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;div class=&quot;card-number&quot;&gt;#</span><span class="sc">{</span>conv[<span class="st">&#39;number&#39;</span>]<span class="sc">}</span><span class="ss"> </span><span class="sc">{</span>recent_badge<span class="sc">}</span><span class="ss">&lt;/div&gt;</span></span>
<span id="cb10-1439"><a href="#cb10-1439" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;div class=&quot;card-actions&quot;&gt;</span></span>
<span id="cb10-1440"><a href="#cb10-1440" aria-hidden="true" tabindex="-1"></a><span class="ss">                        &lt;a href=&quot;combined_markdown/</span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">.md&quot; class=&quot;action-btn&quot; target=&quot;_blank&quot; onclick=&quot;event.stopPropagation();&quot;&gt;üìÑ MD&lt;/a&gt;</span></span>
<span id="cb10-1441"><a href="#cb10-1441" aria-hidden="true" tabindex="-1"></a><span class="ss">                        &lt;a href=&quot;combined_html/</span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">.html&quot; class=&quot;action-btn html-btn&quot; target=&quot;_blank&quot; onclick=&quot;event.stopPropagation();&quot;&gt;üåê HTML&lt;/a&gt;</span></span>
<span id="cb10-1442"><a href="#cb10-1442" aria-hidden="true" tabindex="-1"></a><span class="ss">                        &lt;a href=&quot;combined_pdfs/</span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">.pdf&quot; class=&quot;action-btn&quot; target=&quot;_blank&quot; onclick=&quot;event.stopPropagation();&quot;&gt;üìä PDF&lt;/a&gt;</span></span>
<span id="cb10-1443"><a href="#cb10-1443" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;/div&gt;</span></span>
<span id="cb10-1444"><a href="#cb10-1444" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;/div&gt;</span></span>
<span id="cb10-1445"><a href="#cb10-1445" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;div class=&quot;card-title&quot; onclick=&quot;openHTML(&#39;</span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">.html&#39;)&quot;&gt;</span><span class="sc">{</span>conv[<span class="st">&#39;title&#39;</span>]<span class="sc">}</span><span class="ss">&lt;/div&gt;</span></span>
<span id="cb10-1446"><a href="#cb10-1446" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;div&gt;</span></span>
<span id="cb10-1447"><a href="#cb10-1447" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;span class=&quot;card-source&quot;&gt;</span><span class="sc">{</span>conv[<span class="st">&#39;source&#39;</span>]<span class="sc">}</span><span class="ss">&lt;/span&gt;</span></span>
<span id="cb10-1448"><a href="#cb10-1448" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;span class=&quot;category-badge&quot;&gt;</span><span class="sc">{</span>conv[<span class="st">&#39;category&#39;</span>]<span class="sc">}</span><span class="ss">&lt;/span&gt;</span></span>
<span id="cb10-1449"><a href="#cb10-1449" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;/div&gt;</span></span>
<span id="cb10-1450"><a href="#cb10-1450" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;div class=&quot;card-summary&quot; onclick=&quot;openHTML(&#39;</span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">.html&#39;)&quot;&gt;</span><span class="sc">{</span>summary<span class="sc">}</span><span class="ss">&lt;/div&gt;</span></span>
<span id="cb10-1451"><a href="#cb10-1451" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;div class=&quot;card-meta&quot;&gt;</span></span>
<span id="cb10-1452"><a href="#cb10-1452" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;span&gt;üìÖ </span><span class="sc">{</span>conv<span class="sc">.</span>get(<span class="st">&#39;updated_at&#39;</span>) <span class="kw">or</span> conv<span class="sc">.</span>get(<span class="st">&#39;inserted_at&#39;</span>) <span class="kw">or</span> <span class="st">&#39;N/A&#39;</span><span class="sc">}</span><span class="ss">&lt;/span&gt;</span></span>
<span id="cb10-1453"><a href="#cb10-1453" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;span&gt;üí¨ </span><span class="sc">{</span><span class="bu">len</span>(conv[<span class="st">&#39;messages&#39;</span>])<span class="sc">}</span><span class="ss"> mensagens&lt;/span&gt;</span></span>
<span id="cb10-1454"><a href="#cb10-1454" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;/div&gt;</span></span>
<span id="cb10-1455"><a href="#cb10-1455" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;/div&gt;</span></span>
<span id="cb10-1456"><a href="#cb10-1456" aria-hidden="true" tabindex="-1"></a><span class="ss">            &quot;&quot;&quot;</span></span>
<span id="cb10-1457"><a href="#cb10-1457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-1458"><a href="#cb10-1458" aria-hidden="true" tabindex="-1"></a>        html_content <span class="op">+=</span> <span class="st">&quot;&quot;&quot;</span></span>
<span id="cb10-1459"><a href="#cb10-1459" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;/div&gt;</span></span>
<span id="cb10-1460"><a href="#cb10-1460" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;/div&gt;</span></span>
<span id="cb10-1461"><a href="#cb10-1461" aria-hidden="true" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb10-1462"><a href="#cb10-1462" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;script&gt;</span></span>
<span id="cb10-1463"><a href="#cb10-1463" aria-hidden="true" tabindex="-1"></a><span class="st">        let currentFilter = &#39;todas&#39;;</span></span>
<span id="cb10-1464"><a href="#cb10-1464" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb10-1465"><a href="#cb10-1465" aria-hidden="true" tabindex="-1"></a><span class="st">        // Inicializa√ß√£o</span></span>
<span id="cb10-1466"><a href="#cb10-1466" aria-hidden="true" tabindex="-1"></a><span class="st">        document.addEventListener(&#39;DOMContentLoaded&#39;, function() {</span></span>
<span id="cb10-1467"><a href="#cb10-1467" aria-hidden="true" tabindex="-1"></a><span class="st">            updateStats();</span></span>
<span id="cb10-1468"><a href="#cb10-1468" aria-hidden="true" tabindex="-1"></a><span class="st">        });</span></span>
<span id="cb10-1469"><a href="#cb10-1469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-1470"><a href="#cb10-1470" aria-hidden="true" tabindex="-1"></a><span class="st">        document.querySelectorAll(&#39;.filter-btn&#39;).forEach(btn =&gt; {</span></span>
<span id="cb10-1471"><a href="#cb10-1471" aria-hidden="true" tabindex="-1"></a><span class="st">            btn.addEventListener(&#39;click&#39;, () =&gt; {</span></span>
<span id="cb10-1472"><a href="#cb10-1472" aria-hidden="true" tabindex="-1"></a><span class="st">                document.querySelectorAll(&#39;.filter-btn&#39;).forEach(b =&gt; b.classList.remove(&#39;active&#39;));</span></span>
<span id="cb10-1473"><a href="#cb10-1473" aria-hidden="true" tabindex="-1"></a><span class="st">                btn.classList.add(&#39;active&#39;);</span></span>
<span id="cb10-1474"><a href="#cb10-1474" aria-hidden="true" tabindex="-1"></a><span class="st">                currentFilter = btn.getAttribute(&#39;data-filter&#39;);</span></span>
<span id="cb10-1475"><a href="#cb10-1475" aria-hidden="true" tabindex="-1"></a><span class="st">                filterConversations();</span></span>
<span id="cb10-1476"><a href="#cb10-1476" aria-hidden="true" tabindex="-1"></a><span class="st">            });</span></span>
<span id="cb10-1477"><a href="#cb10-1477" aria-hidden="true" tabindex="-1"></a><span class="st">        });</span></span>
<span id="cb10-1478"><a href="#cb10-1478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-1479"><a href="#cb10-1479" aria-hidden="true" tabindex="-1"></a><span class="st">        document.getElementById(&#39;searchInput&#39;).addEventListener(&#39;input&#39;, filterConversations);</span></span>
<span id="cb10-1480"><a href="#cb10-1480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-1481"><a href="#cb10-1481" aria-hidden="true" tabindex="-1"></a><span class="st">        function filterConversations() {</span></span>
<span id="cb10-1482"><a href="#cb10-1482" aria-hidden="true" tabindex="-1"></a><span class="st">            const term = document.getElementById(&#39;searchInput&#39;).value.toLowerCase();</span></span>
<span id="cb10-1483"><a href="#cb10-1483" aria-hidden="true" tabindex="-1"></a><span class="st">            const cards = document.querySelectorAll(&#39;.conversation-card&#39;);</span></span>
<span id="cb10-1484"><a href="#cb10-1484" aria-hidden="true" tabindex="-1"></a><span class="st">            let visible = 0;</span></span>
<span id="cb10-1485"><a href="#cb10-1485" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb10-1486"><a href="#cb10-1486" aria-hidden="true" tabindex="-1"></a><span class="st">            cards.forEach(card =&gt; {</span></span>
<span id="cb10-1487"><a href="#cb10-1487" aria-hidden="true" tabindex="-1"></a><span class="st">                const title = card.getAttribute(&#39;data-title&#39;).toLowerCase();</span></span>
<span id="cb10-1488"><a href="#cb10-1488" aria-hidden="true" tabindex="-1"></a><span class="st">                const summary = card.getAttribute(&#39;data-summary&#39;).toLowerCase();</span></span>
<span id="cb10-1489"><a href="#cb10-1489" aria-hidden="true" tabindex="-1"></a><span class="st">                const source = card.getAttribute(&#39;data-source&#39;).toLowerCase();</span></span>
<span id="cb10-1490"><a href="#cb10-1490" aria-hidden="true" tabindex="-1"></a><span class="st">                const category = card.getAttribute(&#39;data-category&#39;).toLowerCase();</span></span>
<span id="cb10-1491"><a href="#cb10-1491" aria-hidden="true" tabindex="-1"></a><span class="st">                </span></span>
<span id="cb10-1492"><a href="#cb10-1492" aria-hidden="true" tabindex="-1"></a><span class="st">                const matchesSearch = (title.includes(term) || summary.includes(term) || category.includes(term) || source.includes(term));</span></span>
<span id="cb10-1493"><a href="#cb10-1493" aria-hidden="true" tabindex="-1"></a><span class="st">                const matchesCategory = (currentFilter === &#39;todas&#39; || category === currentFilter);</span></span>
<span id="cb10-1494"><a href="#cb10-1494" aria-hidden="true" tabindex="-1"></a><span class="st">                </span></span>
<span id="cb10-1495"><a href="#cb10-1495" aria-hidden="true" tabindex="-1"></a><span class="st">                if (matchesSearch &amp;&amp; matchesCategory) {</span></span>
<span id="cb10-1496"><a href="#cb10-1496" aria-hidden="true" tabindex="-1"></a><span class="st">                    card.style.display = &#39;block&#39;;</span></span>
<span id="cb10-1497"><a href="#cb10-1497" aria-hidden="true" tabindex="-1"></a><span class="st">                    visible++;</span></span>
<span id="cb10-1498"><a href="#cb10-1498" aria-hidden="true" tabindex="-1"></a><span class="st">                } else {</span></span>
<span id="cb10-1499"><a href="#cb10-1499" aria-hidden="true" tabindex="-1"></a><span class="st">                    card.style.display = &#39;none&#39;;</span></span>
<span id="cb10-1500"><a href="#cb10-1500" aria-hidden="true" tabindex="-1"></a><span class="st">                }</span></span>
<span id="cb10-1501"><a href="#cb10-1501" aria-hidden="true" tabindex="-1"></a><span class="st">            });</span></span>
<span id="cb10-1502"><a href="#cb10-1502" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb10-1503"><a href="#cb10-1503" aria-hidden="true" tabindex="-1"></a><span class="st">            updateStats(visible);</span></span>
<span id="cb10-1504"><a href="#cb10-1504" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb10-1505"><a href="#cb10-1505" aria-hidden="true" tabindex="-1"></a><span class="st">            // Mostra mensagem se n√£o houver resultados</span></span>
<span id="cb10-1506"><a href="#cb10-1506" aria-hidden="true" tabindex="-1"></a><span class="st">            const grid = document.getElementById(&#39;conversationsGrid&#39;);</span></span>
<span id="cb10-1507"><a href="#cb10-1507" aria-hidden="true" tabindex="-1"></a><span class="st">            const noResults = document.getElementById(&#39;no-results-message&#39;);</span></span>
<span id="cb10-1508"><a href="#cb10-1508" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb10-1509"><a href="#cb10-1509" aria-hidden="true" tabindex="-1"></a><span class="st">            if (visible === 0) {</span></span>
<span id="cb10-1510"><a href="#cb10-1510" aria-hidden="true" tabindex="-1"></a><span class="st">                if (!noResults) {</span></span>
<span id="cb10-1511"><a href="#cb10-1511" aria-hidden="true" tabindex="-1"></a><span class="st">                    const noResultsMsg = document.createElement(&#39;div&#39;);</span></span>
<span id="cb10-1512"><a href="#cb10-1512" aria-hidden="true" tabindex="-1"></a><span class="st">                    noResultsMsg.id = &#39;no-results-message&#39;;</span></span>
<span id="cb10-1513"><a href="#cb10-1513" aria-hidden="true" tabindex="-1"></a><span class="st">                    noResultsMsg.className = &#39;no-results&#39;;</span></span>
<span id="cb10-1514"><a href="#cb10-1514" aria-hidden="true" tabindex="-1"></a><span class="st">                    noResultsMsg.innerHTML = &#39;üîç Nenhuma conversa encontrada. Tente ajustar os filtros ou a pesquisa.&#39;;</span></span>
<span id="cb10-1515"><a href="#cb10-1515" aria-hidden="true" tabindex="-1"></a><span class="st">                    grid.appendChild(noResultsMsg);</span></span>
<span id="cb10-1516"><a href="#cb10-1516" aria-hidden="true" tabindex="-1"></a><span class="st">                }</span></span>
<span id="cb10-1517"><a href="#cb10-1517" aria-hidden="true" tabindex="-1"></a><span class="st">            } else if (noResults) {</span></span>
<span id="cb10-1518"><a href="#cb10-1518" aria-hidden="true" tabindex="-1"></a><span class="st">                noResults.remove();</span></span>
<span id="cb10-1519"><a href="#cb10-1519" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb10-1520"><a href="#cb10-1520" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb10-1521"><a href="#cb10-1521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-1522"><a href="#cb10-1522" aria-hidden="true" tabindex="-1"></a><span class="st">        function updateStats(visibleCount = null) {</span></span>
<span id="cb10-1523"><a href="#cb10-1523" aria-hidden="true" tabindex="-1"></a><span class="st">            const totalElement = document.getElementById(&#39;total-count&#39;);</span></span>
<span id="cb10-1524"><a href="#cb10-1524" aria-hidden="true" tabindex="-1"></a><span class="st">            if (visibleCount !== null) {</span></span>
<span id="cb10-1525"><a href="#cb10-1525" aria-hidden="true" tabindex="-1"></a><span class="st">                totalElement.textContent = visibleCount;</span></span>
<span id="cb10-1526"><a href="#cb10-1526" aria-hidden="true" tabindex="-1"></a><span class="st">            } else {</span></span>
<span id="cb10-1527"><a href="#cb10-1527" aria-hidden="true" tabindex="-1"></a><span class="st">                totalElement.textContent = &quot;&quot;&quot;</span> <span class="op">+</span> <span class="bu">str</span>(<span class="bu">len</span>(<span class="va">self</span>.all_conversations)) <span class="op">+</span> <span class="st">&quot;&quot;&quot;;</span></span>
<span id="cb10-1528"><a href="#cb10-1528" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb10-1529"><a href="#cb10-1529" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb10-1530"><a href="#cb10-1530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-1531"><a href="#cb10-1531" aria-hidden="true" tabindex="-1"></a><span class="st">        // NOVA FUN√á√ÉO: Abrir HTML ao clicar no t√≠tulo ou resumo</span></span>
<span id="cb10-1532"><a href="#cb10-1532" aria-hidden="true" tabindex="-1"></a><span class="st">        function openHTML(filename) {</span></span>
<span id="cb10-1533"><a href="#cb10-1533" aria-hidden="true" tabindex="-1"></a><span class="st">            const htmlUrl = &#39;combined_html/&#39; + filename;</span></span>
<span id="cb10-1534"><a href="#cb10-1534" aria-hidden="true" tabindex="-1"></a><span class="st">            console.log(&#39;Abrindo HTML:&#39;, htmlUrl);</span></span>
<span id="cb10-1535"><a href="#cb10-1535" aria-hidden="true" tabindex="-1"></a><span class="st">            window.open(htmlUrl, &#39;_blank&#39;);</span></span>
<span id="cb10-1536"><a href="#cb10-1536" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb10-1537"><a href="#cb10-1537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-1538"><a href="#cb10-1538" aria-hidden="true" tabindex="-1"></a><span class="st">        function openMD(filename) {</span></span>
<span id="cb10-1539"><a href="#cb10-1539" aria-hidden="true" tabindex="-1"></a><span class="st">            const mdUrl = &#39;combined_markdown/&#39; + filename;</span></span>
<span id="cb10-1540"><a href="#cb10-1540" aria-hidden="true" tabindex="-1"></a><span class="st">            window.open(mdUrl, &#39;_blank&#39;);</span></span>
<span id="cb10-1541"><a href="#cb10-1541" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb10-1542"><a href="#cb10-1542" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb10-1543"><a href="#cb10-1543" aria-hidden="true" tabindex="-1"></a><span class="st">        function openPDF(filename) {</span></span>
<span id="cb10-1544"><a href="#cb10-1544" aria-hidden="true" tabindex="-1"></a><span class="st">            const pdfFile = filename.replace(&#39;.md&#39;, &#39;.pdf&#39;);</span></span>
<span id="cb10-1545"><a href="#cb10-1545" aria-hidden="true" tabindex="-1"></a><span class="st">            const pdfUrl = &#39;combined_pdfs/&#39; + pdfFile;</span></span>
<span id="cb10-1546"><a href="#cb10-1546" aria-hidden="true" tabindex="-1"></a><span class="st">            window.open(pdfUrl, &#39;_blank&#39;);</span></span>
<span id="cb10-1547"><a href="#cb10-1547" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb10-1548"><a href="#cb10-1548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-1549"><a href="#cb10-1549" aria-hidden="true" tabindex="-1"></a><span class="st">        // Navega√ß√£o por teclado</span></span>
<span id="cb10-1550"><a href="#cb10-1550" aria-hidden="true" tabindex="-1"></a><span class="st">        document.addEventListener(&#39;keydown&#39;, function(e) {</span></span>
<span id="cb10-1551"><a href="#cb10-1551" aria-hidden="true" tabindex="-1"></a><span class="st">            if (e.key === &#39;Escape&#39;) {</span></span>
<span id="cb10-1552"><a href="#cb10-1552" aria-hidden="true" tabindex="-1"></a><span class="st">                document.getElementById(&#39;searchInput&#39;).value = &#39;&#39;;</span></span>
<span id="cb10-1553"><a href="#cb10-1553" aria-hidden="true" tabindex="-1"></a><span class="st">                filterConversations();</span></span>
<span id="cb10-1554"><a href="#cb10-1554" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb10-1555"><a href="#cb10-1555" aria-hidden="true" tabindex="-1"></a><span class="st">        });</span></span>
<span id="cb10-1556"><a href="#cb10-1556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-1557"><a href="#cb10-1557" aria-hidden="true" tabindex="-1"></a><span class="st">        // Clique nos cards - ABRE HTML</span></span>
<span id="cb10-1558"><a href="#cb10-1558" aria-hidden="true" tabindex="-1"></a><span class="st">        document.querySelectorAll(&#39;.conversation-card&#39;).forEach(card =&gt; {</span></span>
<span id="cb10-1559"><a href="#cb10-1559" aria-hidden="true" tabindex="-1"></a><span class="st">            card.addEventListener(&#39;click&#39;, function(e) {</span></span>
<span id="cb10-1560"><a href="#cb10-1560" aria-hidden="true" tabindex="-1"></a><span class="st">                // N√£o faz nada se clicou em um bot√£o de a√ß√£o</span></span>
<span id="cb10-1561"><a href="#cb10-1561" aria-hidden="true" tabindex="-1"></a><span class="st">                if (e.target.closest(&#39;.action-btn&#39;)) {</span></span>
<span id="cb10-1562"><a href="#cb10-1562" aria-hidden="true" tabindex="-1"></a><span class="st">                    return;</span></span>
<span id="cb10-1563"><a href="#cb10-1563" aria-hidden="true" tabindex="-1"></a><span class="st">                }</span></span>
<span id="cb10-1564"><a href="#cb10-1564" aria-hidden="true" tabindex="-1"></a><span class="st">                </span></span>
<span id="cb10-1565"><a href="#cb10-1565" aria-hidden="true" tabindex="-1"></a><span class="st">                // Abre o HTML ao clicar no card</span></span>
<span id="cb10-1566"><a href="#cb10-1566" aria-hidden="true" tabindex="-1"></a><span class="st">                const htmlBtn = this.querySelector(&#39;a.html-btn&#39;);</span></span>
<span id="cb10-1567"><a href="#cb10-1567" aria-hidden="true" tabindex="-1"></a><span class="st">                if (htmlBtn) {</span></span>
<span id="cb10-1568"><a href="#cb10-1568" aria-hidden="true" tabindex="-1"></a><span class="st">                    const htmlUrl = htmlBtn.getAttribute(&#39;href&#39;);</span></span>
<span id="cb10-1569"><a href="#cb10-1569" aria-hidden="true" tabindex="-1"></a><span class="st">                    window.open(htmlUrl, &#39;_blank&#39;);</span></span>
<span id="cb10-1570"><a href="#cb10-1570" aria-hidden="true" tabindex="-1"></a><span class="st">                }</span></span>
<span id="cb10-1571"><a href="#cb10-1571" aria-hidden="true" tabindex="-1"></a><span class="st">            });</span></span>
<span id="cb10-1572"><a href="#cb10-1572" aria-hidden="true" tabindex="-1"></a><span class="st">        });</span></span>
<span id="cb10-1573"><a href="#cb10-1573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-1574"><a href="#cb10-1574" aria-hidden="true" tabindex="-1"></a><span class="st">        // Foco na pesquisa ao carregar</span></span>
<span id="cb10-1575"><a href="#cb10-1575" aria-hidden="true" tabindex="-1"></a><span class="st">        document.getElementById(&#39;searchInput&#39;).focus();</span></span>
<span id="cb10-1576"><a href="#cb10-1576" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb10-1577"><a href="#cb10-1577" aria-hidden="true" tabindex="-1"></a><span class="st">        console.log(&#39;√çndice carregado com&#39;, &quot;&quot;&quot;</span> <span class="op">+</span> <span class="bu">str</span>(<span class="bu">len</span>(<span class="va">self</span>.all_conversations)) <span class="op">+</span> <span class="st">&quot;&quot;&quot;, &#39;conversas&#39;);</span></span>
<span id="cb10-1578"><a href="#cb10-1578" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;/script&gt;</span></span>
<span id="cb10-1579"><a href="#cb10-1579" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;/body&gt;</span></span>
<span id="cb10-1580"><a href="#cb10-1580" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;/html&gt;</span></span>
<span id="cb10-1581"><a href="#cb10-1581" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;&quot;&quot;</span></span>
<span id="cb10-1582"><a href="#cb10-1582" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-1583"><a href="#cb10-1583" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> <span class="bu">open</span>(<span class="va">self</span>.index_file, <span class="st">&#39;w&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb10-1584"><a href="#cb10-1584" aria-hidden="true" tabindex="-1"></a>            f.write(html_content)</span>
<span id="cb10-1585"><a href="#cb10-1585" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ √çndice combinado criado: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>index_file<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb10-1586"><a href="#cb10-1586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-1587"><a href="#cb10-1587" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> main():</span>
<span id="cb10-1588"><a href="#cb10-1588" aria-hidden="true" tabindex="-1"></a>    parser <span class="op">=</span> argparse.ArgumentParser(</span>
<span id="cb10-1589"><a href="#cb10-1589" aria-hidden="true" tabindex="-1"></a>        description<span class="op">=</span><span class="st">&quot;Processa exporta√ß√µes combinadas com exporta√ß√£o HTML.&quot;</span></span>
<span id="cb10-1590"><a href="#cb10-1590" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb10-1591"><a href="#cb10-1591" aria-hidden="true" tabindex="-1"></a>    parser.add_argument(<span class="st">&quot;--dry-run&quot;</span>, action<span class="op">=</span><span class="st">&quot;store_true&quot;</span>, <span class="bu">help</span><span class="op">=</span><span class="st">&quot;Executa sem salvar arquivos&quot;</span>)</span>
<span id="cb10-1592"><a href="#cb10-1592" aria-hidden="true" tabindex="-1"></a>    parser.add_argument(<span class="st">&quot;--force-overwrite&quot;</span>, action<span class="op">=</span><span class="st">&quot;store_true&quot;</span>, <span class="bu">help</span><span class="op">=</span><span class="st">&quot;Substitui arquivos existentes&quot;</span>)</span>
<span id="cb10-1593"><a href="#cb10-1593" aria-hidden="true" tabindex="-1"></a>    parser.add_argument(<span class="st">&quot;--test-preservation&quot;</span>, action<span class="op">=</span><span class="st">&quot;store_true&quot;</span>, <span class="bu">help</span><span class="op">=</span><span class="st">&quot;Testa preserva√ß√£o de conte√∫do&quot;</span>)</span>
<span id="cb10-1594"><a href="#cb10-1594" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-1595"><a href="#cb10-1595" aria-hidden="true" tabindex="-1"></a>    args <span class="op">=</span> parser.parse_args()</span>
<span id="cb10-1596"><a href="#cb10-1596" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-1597"><a href="#cb10-1597" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> args.test_preservation:</span>
<span id="cb10-1598"><a href="#cb10-1598" aria-hidden="true" tabindex="-1"></a>        test_preservation()</span>
<span id="cb10-1599"><a href="#cb10-1599" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb10-1600"><a href="#cb10-1600" aria-hidden="true" tabindex="-1"></a>        system <span class="op">=</span> CombinedFragmentsSystem(</span>
<span id="cb10-1601"><a href="#cb10-1601" aria-hidden="true" tabindex="-1"></a>            dry_run<span class="op">=</span>args.dry_run,</span>
<span id="cb10-1602"><a href="#cb10-1602" aria-hidden="true" tabindex="-1"></a>            force_overwrite<span class="op">=</span>args.force_overwrite</span>
<span id="cb10-1603"><a href="#cb10-1603" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb10-1604"><a href="#cb10-1604" aria-hidden="true" tabindex="-1"></a>        system.run()</span>
<span id="cb10-1605"><a href="#cb10-1605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-1606"><a href="#cb10-1606" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> test_preservation():</span>
<span id="cb10-1607"><a href="#cb10-1607" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Testa a preserva√ß√£o de conte√∫do especial&quot;&quot;&quot;</span></span>
<span id="cb10-1608"><a href="#cb10-1608" aria-hidden="true" tabindex="-1"></a>    system <span class="op">=</span> CombinedFragmentsSystem()</span>
<span id="cb10-1609"><a href="#cb10-1609" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-1610"><a href="#cb10-1610" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;üß™ TESTE DE PRESERVA√á√ÉO DE CONTE√öDO&quot;</span>)</span>
<span id="cb10-1611"><a href="#cb10-1611" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;=&quot;</span> <span class="op">*</span> <span class="dv">50</span>)</span>
<span id="cb10-1612"><a href="#cb10-1612" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-1613"><a href="#cb10-1613" aria-hidden="true" tabindex="-1"></a>    test_cases <span class="op">=</span> [</span>
<span id="cb10-1614"><a href="#cb10-1614" aria-hidden="true" tabindex="-1"></a>        (<span class="st">&quot;F√≥rmulas Matem√°ticas&quot;</span>, <span class="vs">r&quot;</span><span class="dv">$</span><span class="vs">E = mc</span><span class="dv">^</span><span class="vs">2</span><span class="dv">$</span><span class="vs"> </span><span class="dv">$\s</span><span class="vs">um_{i=1}</span><span class="dv">^</span><span class="vs">n i = </span><span class="ch">\f</span><span class="vs">rac{n</span><span class="kw">(</span><span class="vs">n</span><span class="op">+</span><span class="vs">1</span><span class="kw">)</span><span class="vs">}</span><span class="op">{2}</span><span class="dv">$</span><span class="vs">&quot;</span>),</span>
<span id="cb10-1615"><a href="#cb10-1615" aria-hidden="true" tabindex="-1"></a>        (<span class="st">&quot;C√≥digo&quot;</span>, <span class="st">&quot;```python</span><span class="ch">\n</span><span class="st">print(&#39;Hello&#39;)</span><span class="ch">\n</span><span class="st">```&quot;</span>),</span>
<span id="cb10-1616"><a href="#cb10-1616" aria-hidden="true" tabindex="-1"></a>        (<span class="st">&quot;Emojis&quot;</span>, <span class="st">&quot;üöÄ ‚úÖ ‚ù§Ô∏è üìä&quot;</span>),</span>
<span id="cb10-1617"><a href="#cb10-1617" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb10-1618"><a href="#cb10-1618" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-1619"><a href="#cb10-1619" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> name, content <span class="kw">in</span> test_cases:</span>
<span id="cb10-1620"><a href="#cb10-1620" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="ch">\n</span><span class="ss">üî¨ </span><span class="sc">{</span>name<span class="sc">}</span><span class="ss">:&quot;</span>)</span>
<span id="cb10-1621"><a href="#cb10-1621" aria-hidden="true" tabindex="-1"></a>        preserved <span class="op">=</span> system.preserve_special_content(content)</span>
<span id="cb10-1622"><a href="#cb10-1622" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-1623"><a href="#cb10-1623" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> content <span class="op">==</span> preserved:</span>
<span id="cb10-1624"><a href="#cb10-1624" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;‚úÖ PERFEITAMENTE PRESERVADO!&quot;</span>)</span>
<span id="cb10-1625"><a href="#cb10-1625" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb10-1626"><a href="#cb10-1626" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;‚ùå ALTERA√á√ïES DETECTADAS!&quot;</span>)</span>
<span id="cb10-1627"><a href="#cb10-1627" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-1628"><a href="#cb10-1628" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;Visualiza√ß√£o:&quot;</span>)</span>
<span id="cb10-1629"><a href="#cb10-1629" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(preserved)</span>
<span id="cb10-1630"><a href="#cb10-1630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-1631"><a href="#cb10-1631" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&quot;__main__&quot;</span>:</span>
<span id="cb10-1632"><a href="#cb10-1632" aria-hidden="true" tabindex="-1"></a>    main()</span></code></pre></div>
<h2 data-number="1.14" id="comb_pdf_direct5_html_based.py"><span class="header-section-number">1.14</span> üìÅ <strong>2.
comb_pdf_direct5_html_based.py</strong></h2>
<div class="sourceCode" id="cb11"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># comb_pdf_direct5_html_based.py</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sys</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> argparse</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> weasyprint <span class="im">import</span> HTML</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tempfile</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> shutil</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> concurrent.futures <span class="im">import</span> ThreadPoolExecutor, as_completed</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> PDFGeneratorHTML:</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, force_overwrite<span class="op">=</span><span class="va">False</span>, max_workers<span class="op">=</span><span class="dv">3</span>):</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.force_overwrite <span class="op">=</span> force_overwrite</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.max_workers <span class="op">=</span> max_workers</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Pastas de entrada e sa√≠da</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.html_dir <span class="op">=</span> Path(<span class="st">&quot;combined_html&quot;</span>)</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.pdf_dir <span class="op">=</span> Path(<span class="st">&quot;combined_pdfs&quot;</span>)</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Configura√ß√£o do WeasyPrint para melhor qualidade</span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.pdf_options <span class="op">=</span> {</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;optimize_images&#39;</span>: <span class="va">True</span>,</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;image_dpi&#39;</span>: <span class="dv">150</span>,</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;full_fonts&#39;</span>: <span class="va">True</span></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> ensure_directories(<span class="va">self</span>):</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Garante que as pastas existem&quot;&quot;&quot;</span></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.pdf_dir.mkdir(exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.html_dir.exists():</span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚ùå Pasta de HTML n√£o encontrada: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>html_dir<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> convert_html_to_pdf(<span class="va">self</span>, html_file):</span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Converte um √∫nico arquivo HTML para PDF&quot;&quot;&quot;</span></span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>            pdf_file <span class="op">=</span> <span class="va">self</span>.pdf_dir <span class="op">/</span> html_file.with_suffix(<span class="st">&#39;.pdf&#39;</span>).name</span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Verifica se j√° existe</span></span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.force_overwrite <span class="kw">and</span> pdf_file.exists():</span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="ss">f&quot;‚è≠Ô∏è  PDF j√° existe: </span><span class="sc">{</span>pdf_file<span class="sc">.</span>name<span class="sc">}</span><span class="ss">&quot;</span></span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Converte HTML para PDF</span></span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a>            HTML(html_file).write_pdf(</span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a>                pdf_file,</span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a>                optimize_images<span class="op">=</span><span class="va">self</span>.pdf_options[<span class="st">&#39;optimize_images&#39;</span>],</span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a>                image_dpi<span class="op">=</span><span class="va">self</span>.pdf_options[<span class="st">&#39;image_dpi&#39;</span>],</span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a>                full_fonts<span class="op">=</span><span class="va">self</span>.pdf_options[<span class="st">&#39;full_fonts&#39;</span>]</span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="ss">f&quot;‚úÖ PDF criado: </span><span class="sc">{</span>pdf_file<span class="sc">.</span>name<span class="sc">}</span><span class="ss">&quot;</span></span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb11-54"><a href="#cb11-54" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb11-55"><a href="#cb11-55" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="ss">f&quot;‚ùå Erro em </span><span class="sc">{</span>html_file<span class="sc">.</span>name<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span><span class="bu">str</span>(e)<span class="sc">}</span><span class="ss">&quot;</span></span>
<span id="cb11-56"><a href="#cb11-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-57"><a href="#cb11-57" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> generate_pdfs(<span class="va">self</span>):</span>
<span id="cb11-58"><a href="#cb11-58" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Gera PDFs a partir dos arquivos HTML&quot;&quot;&quot;</span></span>
<span id="cb11-59"><a href="#cb11-59" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.ensure_directories():</span>
<span id="cb11-60"><a href="#cb11-60" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb11-61"><a href="#cb11-61" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb11-62"><a href="#cb11-62" aria-hidden="true" tabindex="-1"></a>        html_files <span class="op">=</span> <span class="bu">list</span>(<span class="va">self</span>.html_dir.glob(<span class="st">&quot;*.html&quot;</span>))</span>
<span id="cb11-63"><a href="#cb11-63" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb11-64"><a href="#cb11-64" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> html_files:</span>
<span id="cb11-65"><a href="#cb11-65" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;‚ùå Nenhum arquivo HTML encontrado para convers√£o.&quot;</span>)</span>
<span id="cb11-66"><a href="#cb11-66" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb11-67"><a href="#cb11-67" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb11-68"><a href="#cb11-68" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;üîç Encontrados </span><span class="sc">{</span><span class="bu">len</span>(html_files)<span class="sc">}</span><span class="ss"> arquivos HTML&quot;</span>)</span>
<span id="cb11-69"><a href="#cb11-69" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;üîÑ Convertendo para PDF...&quot;</span>)</span>
<span id="cb11-70"><a href="#cb11-70" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb11-71"><a href="#cb11-71" aria-hidden="true" tabindex="-1"></a>        successful <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb11-72"><a href="#cb11-72" aria-hidden="true" tabindex="-1"></a>        failed <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb11-73"><a href="#cb11-73" aria-hidden="true" tabindex="-1"></a>        skipped <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb11-74"><a href="#cb11-74" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb11-75"><a href="#cb11-75" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Processamento em paralelo</span></span>
<span id="cb11-76"><a href="#cb11-76" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> ThreadPoolExecutor(max_workers<span class="op">=</span><span class="va">self</span>.max_workers) <span class="im">as</span> executor:</span>
<span id="cb11-77"><a href="#cb11-77" aria-hidden="true" tabindex="-1"></a>            future_to_file <span class="op">=</span> {</span>
<span id="cb11-78"><a href="#cb11-78" aria-hidden="true" tabindex="-1"></a>                executor.submit(<span class="va">self</span>.convert_html_to_pdf, html_file): html_file </span>
<span id="cb11-79"><a href="#cb11-79" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> html_file <span class="kw">in</span> html_files</span>
<span id="cb11-80"><a href="#cb11-80" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb11-81"><a href="#cb11-81" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb11-82"><a href="#cb11-82" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> future <span class="kw">in</span> as_completed(future_to_file):</span>
<span id="cb11-83"><a href="#cb11-83" aria-hidden="true" tabindex="-1"></a>                result <span class="op">=</span> future.result()</span>
<span id="cb11-84"><a href="#cb11-84" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;   </span><span class="sc">{</span>result<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb11-85"><a href="#cb11-85" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb11-86"><a href="#cb11-86" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="st">&quot;‚úÖ&quot;</span> <span class="kw">in</span> result:</span>
<span id="cb11-87"><a href="#cb11-87" aria-hidden="true" tabindex="-1"></a>                    successful <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb11-88"><a href="#cb11-88" aria-hidden="true" tabindex="-1"></a>                <span class="cf">elif</span> <span class="st">&quot;‚ùå&quot;</span> <span class="kw">in</span> result:</span>
<span id="cb11-89"><a href="#cb11-89" aria-hidden="true" tabindex="-1"></a>                    failed <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb11-90"><a href="#cb11-90" aria-hidden="true" tabindex="-1"></a>                <span class="cf">elif</span> <span class="st">&quot;‚è≠Ô∏è&quot;</span> <span class="kw">in</span> result:</span>
<span id="cb11-91"><a href="#cb11-91" aria-hidden="true" tabindex="-1"></a>                    skipped <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb11-92"><a href="#cb11-92" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb11-93"><a href="#cb11-93" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="ch">\n</span><span class="ss">üìä RESUMO DA CONVERS√ÉO:&quot;</span>)</span>
<span id="cb11-94"><a href="#cb11-94" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;   ‚úÖ Sucessos: </span><span class="sc">{</span>successful<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb11-95"><a href="#cb11-95" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;   ‚è≠Ô∏è  Pulados: </span><span class="sc">{</span>skipped<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb11-96"><a href="#cb11-96" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;   ‚ùå Falhas: </span><span class="sc">{</span>failed<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb11-97"><a href="#cb11-97" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;   üìÅ Pasta de PDFs: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>pdf_dir<span class="sc">.</span>absolute()<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb11-98"><a href="#cb11-98" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb11-99"><a href="#cb11-99" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> successful <span class="op">&gt;</span> <span class="dv">0</span></span>
<span id="cb11-100"><a href="#cb11-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-101"><a href="#cb11-101" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> generate_single_pdf(<span class="va">self</span>, html_filename):</span>
<span id="cb11-102"><a href="#cb11-102" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Gera um √∫nico PDF a partir de um arquivo HTML espec√≠fico&quot;&quot;&quot;</span></span>
<span id="cb11-103"><a href="#cb11-103" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.ensure_directories():</span>
<span id="cb11-104"><a href="#cb11-104" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb11-105"><a href="#cb11-105" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb11-106"><a href="#cb11-106" aria-hidden="true" tabindex="-1"></a>        html_file <span class="op">=</span> <span class="va">self</span>.html_dir <span class="op">/</span> html_filename</span>
<span id="cb11-107"><a href="#cb11-107" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> html_file.exists():</span>
<span id="cb11-108"><a href="#cb11-108" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚ùå Arquivo HTML n√£o encontrado: </span><span class="sc">{</span>html_file<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb11-109"><a href="#cb11-109" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb11-110"><a href="#cb11-110" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb11-111"><a href="#cb11-111" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> <span class="va">self</span>.convert_html_to_pdf(html_file)</span>
<span id="cb11-112"><a href="#cb11-112" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(result)</span>
<span id="cb11-113"><a href="#cb11-113" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">&quot;‚úÖ&quot;</span> <span class="kw">in</span> result</span>
<span id="cb11-114"><a href="#cb11-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-115"><a href="#cb11-115" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> main():</span>
<span id="cb11-116"><a href="#cb11-116" aria-hidden="true" tabindex="-1"></a>    parser <span class="op">=</span> argparse.ArgumentParser(</span>
<span id="cb11-117"><a href="#cb11-117" aria-hidden="true" tabindex="-1"></a>        description<span class="op">=</span><span class="st">&quot;Gera PDFs a partir de arquivos HTML (vers√£o otimizada baseada em HTML)&quot;</span></span>
<span id="cb11-118"><a href="#cb11-118" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb11-119"><a href="#cb11-119" aria-hidden="true" tabindex="-1"></a>    parser.add_argument(<span class="st">&quot;--force-overwrite&quot;</span>, action<span class="op">=</span><span class="st">&quot;store_true&quot;</span>, </span>
<span id="cb11-120"><a href="#cb11-120" aria-hidden="true" tabindex="-1"></a>                       <span class="bu">help</span><span class="op">=</span><span class="st">&quot;Substitui PDFs existentes&quot;</span>)</span>
<span id="cb11-121"><a href="#cb11-121" aria-hidden="true" tabindex="-1"></a>    parser.add_argument(<span class="st">&quot;--max-workers&quot;</span>, <span class="bu">type</span><span class="op">=</span><span class="bu">int</span>, default<span class="op">=</span><span class="dv">3</span>,</span>
<span id="cb11-122"><a href="#cb11-122" aria-hidden="true" tabindex="-1"></a>                       <span class="bu">help</span><span class="op">=</span><span class="st">&quot;N√∫mero m√°ximo de workers paralelos (padr√£o: 3)&quot;</span>)</span>
<span id="cb11-123"><a href="#cb11-123" aria-hidden="true" tabindex="-1"></a>    parser.add_argument(<span class="st">&quot;--single-file&quot;</span>, <span class="bu">type</span><span class="op">=</span><span class="bu">str</span>,</span>
<span id="cb11-124"><a href="#cb11-124" aria-hidden="true" tabindex="-1"></a>                       <span class="bu">help</span><span class="op">=</span><span class="st">&quot;Converte apenas um arquivo HTML espec√≠fico&quot;</span>)</span>
<span id="cb11-125"><a href="#cb11-125" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-126"><a href="#cb11-126" aria-hidden="true" tabindex="-1"></a>    args <span class="op">=</span> parser.parse_args()</span>
<span id="cb11-127"><a href="#cb11-127" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-128"><a href="#cb11-128" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;üîÑ PDF GENERATOR - HTML BASED&quot;</span>)</span>
<span id="cb11-129"><a href="#cb11-129" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;=&quot;</span> <span class="op">*</span> <span class="dv">40</span>)</span>
<span id="cb11-130"><a href="#cb11-130" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-131"><a href="#cb11-131" aria-hidden="true" tabindex="-1"></a>    generator <span class="op">=</span> PDFGeneratorHTML(</span>
<span id="cb11-132"><a href="#cb11-132" aria-hidden="true" tabindex="-1"></a>        force_overwrite<span class="op">=</span>args.force_overwrite,</span>
<span id="cb11-133"><a href="#cb11-133" aria-hidden="true" tabindex="-1"></a>        max_workers<span class="op">=</span>args.max_workers</span>
<span id="cb11-134"><a href="#cb11-134" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb11-135"><a href="#cb11-135" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-136"><a href="#cb11-136" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> args.single_file:</span>
<span id="cb11-137"><a href="#cb11-137" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;üéØ Convertendo arquivo √∫nico: </span><span class="sc">{</span>args<span class="sc">.</span>single_file<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb11-138"><a href="#cb11-138" aria-hidden="true" tabindex="-1"></a>        success <span class="op">=</span> generator.generate_single_pdf(args.single_file)</span>
<span id="cb11-139"><a href="#cb11-139" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb11-140"><a href="#cb11-140" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;üîÑ Convertendo todos os arquivos HTML...&quot;</span>)</span>
<span id="cb11-141"><a href="#cb11-141" aria-hidden="true" tabindex="-1"></a>        success <span class="op">=</span> generator.generate_pdfs()</span>
<span id="cb11-142"><a href="#cb11-142" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-143"><a href="#cb11-143" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> success:</span>
<span id="cb11-144"><a href="#cb11-144" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">üéâ CONVERS√ÉO CONCLU√çDA!&quot;</span>)</span>
<span id="cb11-145"><a href="#cb11-145" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb11-146"><a href="#cb11-146" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">üí• CONVERS√ÉO FALHOU!&quot;</span>)</span>
<span id="cb11-147"><a href="#cb11-147" aria-hidden="true" tabindex="-1"></a>        sys.exit(<span class="dv">1</span>)</span>
<span id="cb11-148"><a href="#cb11-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-149"><a href="#cb11-149" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&quot;__main__&quot;</span>:</span>
<span id="cb11-150"><a href="#cb11-150" aria-hidden="true" tabindex="-1"></a>    main()</span></code></pre></div>
<h2 data-number="1.15" id="novas-funcionalidades"><span class="header-section-number">1.15</span> üöÄ <strong>Novas
Funcionalidades:</strong></h2>
<h3 data-number="1.15.1" id="comb_fragments_system3_html_export.py-1"><span class="header-section-number">1.15.1</span>
<strong>comb_fragments_system3_html_export.py:</strong></h3>
<ul>
<li>‚úÖ <strong>Nova pasta <code>combined_html</code></strong> com
vers√µes HTML elegantes</li>
<li>‚úÖ <strong>Clique no t√≠tulo/resumo</strong> abre vers√£o HTML</li>
<li>‚úÖ <strong>Convers√£o autom√°tica</strong> Markdown ‚Üí HTML</li>
<li>‚úÖ <strong>Design responsivo</strong> e elegante</li>
<li>‚úÖ <strong>Bot√£o ‚ÄúVoltar ao √çndice‚Äù</strong> em cada HTML</li>
</ul>
<h3 data-number="1.15.2" id="comb_pdf_direct5_html_based.py-1"><span class="header-section-number">1.15.2</span>
<strong>comb_pdf_direct5_html_based.py:</strong></h3>
<ul>
<li>‚úÖ <strong>Convers√£o direta HTML ‚Üí PDF</strong> (mais simples e
confi√°vel)</li>
<li>‚úÖ <strong>Processamento paralelo</strong> otimizado</li>
<li>‚úÖ <strong>Melhor qualidade</strong> de PDF</li>
<li>‚úÖ <strong>Convers√£o individual</strong> ou em lote</li>
</ul>
<h2 data-number="1.16" id="como-usar-1"><span class="header-section-number">1.16</span> üìã <strong>Como
Usar:</strong></h2>
<div class="sourceCode" id="cb12"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Processar conversas e gerar HTML</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> comb_fragments_system3_html_export.py <span class="at">--force-overwrite</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Gerar PDFs a partir do HTML</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> comb_pdf_direct5_html_based.py <span class="at">--force-overwrite</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Converter apenas um arquivo espec√≠fico</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> comb_pdf_direct5_html_based.py <span class="at">--single-file</span> <span class="st">&quot;001_ChatGPT_Conversa.html&quot;</span></span></code></pre></div>
<p>Agora o fluxo √© muito mais simples e eficiente! üéâ</p>
<hr />
<h3 data-number="1.16.1" id="utilizador-2025-11-05-061041-deepseek-chat"><span class="header-section-number">1.16.1</span> üë§ Utilizador
<em>(2025-11-05 06:10:41)</em> <em>[deepseek-chat]</em></h3>
<p>o metodo de convers√£o de html para pdf em
comb_pdf_direct5_html_based.py deve ser o usado em
comb_pdf_direct4_optimized.py</p>
<hr />
<h3 data-number="1.16.2" id="deepseek-2025-11-05-061041-deepseek-chat"><span class="header-section-number">1.16.2</span> ü§ñ DeepSeek <em>(2025-11-05
06:10:41)</em> <em>[deepseek-chat]</em></h3>
<p>Perfeito! Vou criar o <code>comb_pdf_direct5_html_based.py</code>
usando o m√©todo de convers√£o do
<code>comb_pdf_direct4_optimized.py</code>:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># comb_pdf_direct5_html_based.py</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> base64</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> time</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> argparse</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> selenium <span class="im">import</span> webdriver</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> selenium.webdriver.chrome.options <span class="im">import</span> Options</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> selenium.webdriver.support.ui <span class="im">import</span> WebDriverWait</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> selenium.common.exceptions <span class="im">import</span> TimeoutException, WebDriverException</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> concurrent.futures <span class="im">import</span> ThreadPoolExecutor, as_completed</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> logging</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tempfile</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> PDFGeneratorHTML:</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, force_overwrite<span class="op">=</span><span class="va">False</span>, max_workers<span class="op">=</span><span class="dv">3</span>, headless<span class="op">=</span><span class="va">True</span>, timeout<span class="op">=</span><span class="dv">60</span>):</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.force_overwrite <span class="op">=</span> force_overwrite</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.max_workers <span class="op">=</span> max_workers</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.headless <span class="op">=</span> headless</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.timeout <span class="op">=</span> timeout</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.setup_logging()</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Pastas de entrada e sa√≠da</span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.html_dir <span class="op">=</span> Path(<span class="st">&quot;combined_html&quot;</span>)</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.pdf_dir <span class="op">=</span> Path(<span class="st">&quot;combined_pdfs&quot;</span>)</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> setup_logging(<span class="va">self</span>):</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Configura logging detalhado&quot;&quot;&quot;</span></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>        logging.basicConfig(</span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>            level<span class="op">=</span>logging.INFO,</span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>            <span class="bu">format</span><span class="op">=</span><span class="st">&#39;</span><span class="sc">%(asctime)s</span><span class="st"> - </span><span class="sc">%(levelname)s</span><span class="st"> - </span><span class="sc">%(message)s</span><span class="st">&#39;</span>,</span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>            handlers<span class="op">=</span>[</span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>                logging.StreamHandler(),</span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>                logging.FileHandler(<span class="st">&#39;pdf_conversion_html.log&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>)</span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.logger <span class="op">=</span> logging.getLogger(<span class="va">__name__</span>)</span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> check_chrome_driver(<span class="va">self</span>) <span class="op">-&gt;</span> <span class="bu">bool</span>:</span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Verifica se Chrome Driver est√° dispon√≠vel&quot;&quot;&quot;</span></span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a>            options <span class="op">=</span> Options()</span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="va">self</span>.headless:</span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a>                options.add_argument(<span class="st">&#39;--headless&#39;</span>)</span>
<span id="cb13-45"><a href="#cb13-45" aria-hidden="true" tabindex="-1"></a>            options.add_argument(<span class="st">&#39;--disable-gpu&#39;</span>)</span>
<span id="cb13-46"><a href="#cb13-46" aria-hidden="true" tabindex="-1"></a>            options.add_argument(<span class="st">&#39;--no-sandbox&#39;</span>)</span>
<span id="cb13-47"><a href="#cb13-47" aria-hidden="true" tabindex="-1"></a>            options.add_argument(<span class="st">&#39;--disable-dev-shm-usage&#39;</span>)</span>
<span id="cb13-48"><a href="#cb13-48" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb13-49"><a href="#cb13-49" aria-hidden="true" tabindex="-1"></a>            driver <span class="op">=</span> webdriver.Chrome(options<span class="op">=</span>options)</span>
<span id="cb13-50"><a href="#cb13-50" aria-hidden="true" tabindex="-1"></a>            driver.quit()</span>
<span id="cb13-51"><a href="#cb13-51" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="st">&quot;‚úÖ Chrome Driver verificado&quot;</span>)</span>
<span id="cb13-52"><a href="#cb13-52" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb13-53"><a href="#cb13-53" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb13-54"><a href="#cb13-54" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.error(<span class="ss">f&quot;‚ùå Chrome Driver n√£o dispon√≠vel: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb13-55"><a href="#cb13-55" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb13-56"><a href="#cb13-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-57"><a href="#cb13-57" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> ensure_directories(<span class="va">self</span>):</span>
<span id="cb13-58"><a href="#cb13-58" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Garante que as pastas existem&quot;&quot;&quot;</span></span>
<span id="cb13-59"><a href="#cb13-59" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.pdf_dir.mkdir(exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb13-60"><a href="#cb13-60" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.html_dir.exists():</span>
<span id="cb13-61"><a href="#cb13-61" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.error(<span class="ss">f&quot;‚ùå Pasta de HTML n√£o encontrada: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>html_dir<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb13-62"><a href="#cb13-62" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb13-63"><a href="#cb13-63" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb13-64"><a href="#cb13-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-65"><a href="#cb13-65" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> html_to_pdf(<span class="va">self</span>, html_file: <span class="bu">str</span>, pdf_file: <span class="bu">str</span>, retry_count: <span class="bu">int</span> <span class="op">=</span> <span class="dv">3</span>) <span class="op">-&gt;</span> <span class="bu">bool</span>:</span>
<span id="cb13-66"><a href="#cb13-66" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Converte HTML para PDF com retry - M√âTODO DO comb_pdf_direct4_optimized.py&quot;&quot;&quot;</span></span>
<span id="cb13-67"><a href="#cb13-67" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> attempt <span class="kw">in</span> <span class="bu">range</span>(retry_count):</span>
<span id="cb13-68"><a href="#cb13-68" aria-hidden="true" tabindex="-1"></a>            driver <span class="op">=</span> <span class="va">None</span></span>
<span id="cb13-69"><a href="#cb13-69" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb13-70"><a href="#cb13-70" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.info(<span class="ss">f&quot;üìñ Convertendo: </span><span class="sc">{</span>Path(html_file)<span class="sc">.</span>name<span class="sc">}</span><span class="ss"> ‚Üí </span><span class="sc">{</span>Path(pdf_file)<span class="sc">.</span>name<span class="sc">}</span><span class="ss"> (tentativa </span><span class="sc">{</span>attempt <span class="op">+</span> <span class="dv">1</span><span class="sc">}</span><span class="ss">/</span><span class="sc">{</span>retry_count<span class="sc">}</span><span class="ss">)&quot;</span>)</span>
<span id="cb13-71"><a href="#cb13-71" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb13-72"><a href="#cb13-72" aria-hidden="true" tabindex="-1"></a>                options <span class="op">=</span> Options()</span>
<span id="cb13-73"><a href="#cb13-73" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="va">self</span>.headless:</span>
<span id="cb13-74"><a href="#cb13-74" aria-hidden="true" tabindex="-1"></a>                    options.add_argument(<span class="st">&#39;--headless&#39;</span>)</span>
<span id="cb13-75"><a href="#cb13-75" aria-hidden="true" tabindex="-1"></a>                options.add_argument(<span class="st">&#39;--disable-gpu&#39;</span>)</span>
<span id="cb13-76"><a href="#cb13-76" aria-hidden="true" tabindex="-1"></a>                options.add_argument(<span class="st">&#39;--no-sandbox&#39;</span>)</span>
<span id="cb13-77"><a href="#cb13-77" aria-hidden="true" tabindex="-1"></a>                options.add_argument(<span class="st">&#39;--disable-dev-shm-usage&#39;</span>)</span>
<span id="cb13-78"><a href="#cb13-78" aria-hidden="true" tabindex="-1"></a>                options.add_argument(<span class="st">&#39;--window-size=1920,1080&#39;</span>)</span>
<span id="cb13-79"><a href="#cb13-79" aria-hidden="true" tabindex="-1"></a>                options.add_argument(<span class="st">&#39;--log-level=3&#39;</span>)  <span class="co"># Reduce logging</span></span>
<span id="cb13-80"><a href="#cb13-80" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb13-81"><a href="#cb13-81" aria-hidden="true" tabindex="-1"></a>                driver <span class="op">=</span> webdriver.Chrome(options<span class="op">=</span>options)</span>
<span id="cb13-82"><a href="#cb13-82" aria-hidden="true" tabindex="-1"></a>                driver.set_page_load_timeout(<span class="va">self</span>.timeout)</span>
<span id="cb13-83"><a href="#cb13-83" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb13-84"><a href="#cb13-84" aria-hidden="true" tabindex="-1"></a>                full_path <span class="op">=</span> <span class="ss">f&quot;file:///</span><span class="sc">{</span>Path(html_file)<span class="sc">.</span>absolute()<span class="sc">}</span><span class="ss">&quot;</span></span>
<span id="cb13-85"><a href="#cb13-85" aria-hidden="true" tabindex="-1"></a>                driver.get(full_path)</span>
<span id="cb13-86"><a href="#cb13-86" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb13-87"><a href="#cb13-87" aria-hidden="true" tabindex="-1"></a>                WebDriverWait(driver, <span class="dv">30</span>).until(</span>
<span id="cb13-88"><a href="#cb13-88" aria-hidden="true" tabindex="-1"></a>                    <span class="kw">lambda</span> d: d.execute_script(<span class="st">&#39;return document.readyState&#39;</span>) <span class="op">==</span> <span class="st">&#39;complete&#39;</span></span>
<span id="cb13-89"><a href="#cb13-89" aria-hidden="true" tabindex="-1"></a>                )</span>
<span id="cb13-90"><a href="#cb13-90" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb13-91"><a href="#cb13-91" aria-hidden="true" tabindex="-1"></a>                time.sleep(<span class="dv">2</span>)  <span class="co"># Espera para renderiza√ß√£o completa</span></span>
<span id="cb13-92"><a href="#cb13-92" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb13-93"><a href="#cb13-93" aria-hidden="true" tabindex="-1"></a>                pdf_params <span class="op">=</span> {</span>
<span id="cb13-94"><a href="#cb13-94" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;landscape&#39;</span>: <span class="va">False</span>,</span>
<span id="cb13-95"><a href="#cb13-95" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;displayHeaderFooter&#39;</span>: <span class="va">False</span>,</span>
<span id="cb13-96"><a href="#cb13-96" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;printBackground&#39;</span>: <span class="va">True</span>,</span>
<span id="cb13-97"><a href="#cb13-97" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;preferCSSPageSize&#39;</span>: <span class="va">True</span>,</span>
<span id="cb13-98"><a href="#cb13-98" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;marginTop&#39;</span>: <span class="fl">0.5</span>,</span>
<span id="cb13-99"><a href="#cb13-99" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;marginBottom&#39;</span>: <span class="fl">0.5</span>,</span>
<span id="cb13-100"><a href="#cb13-100" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;marginLeft&#39;</span>: <span class="fl">0.5</span>,</span>
<span id="cb13-101"><a href="#cb13-101" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;marginRight&#39;</span>: <span class="fl">0.5</span>,</span>
<span id="cb13-102"><a href="#cb13-102" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb13-103"><a href="#cb13-103" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb13-104"><a href="#cb13-104" aria-hidden="true" tabindex="-1"></a>                result <span class="op">=</span> driver.execute_cdp_cmd(<span class="st">&#39;Page.printToPDF&#39;</span>, pdf_params)</span>
<span id="cb13-105"><a href="#cb13-105" aria-hidden="true" tabindex="-1"></a>                pdf_data <span class="op">=</span> base64.b64decode(result[<span class="st">&#39;data&#39;</span>])</span>
<span id="cb13-106"><a href="#cb13-106" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb13-107"><a href="#cb13-107" aria-hidden="true" tabindex="-1"></a>                <span class="cf">with</span> <span class="bu">open</span>(pdf_file, <span class="st">&#39;wb&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb13-108"><a href="#cb13-108" aria-hidden="true" tabindex="-1"></a>                    f.write(pdf_data)</span>
<span id="cb13-109"><a href="#cb13-109" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb13-110"><a href="#cb13-110" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.info(<span class="ss">f&quot;‚úÖ PDF gerado: </span><span class="sc">{</span>Path(pdf_file)<span class="sc">.</span>name<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb13-111"><a href="#cb13-111" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb13-112"><a href="#cb13-112" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb13-113"><a href="#cb13-113" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span> TimeoutException <span class="im">as</span> e:</span>
<span id="cb13-114"><a href="#cb13-114" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.warning(<span class="ss">f&quot;‚è∞ Timeout na tentativa </span><span class="sc">{</span>attempt <span class="op">+</span> <span class="dv">1</span><span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb13-115"><a href="#cb13-115" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span> WebDriverException <span class="im">as</span> e:</span>
<span id="cb13-116"><a href="#cb13-116" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.warning(<span class="ss">f&quot;üö´ Erro WebDriver na tentativa </span><span class="sc">{</span>attempt <span class="op">+</span> <span class="dv">1</span><span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb13-117"><a href="#cb13-117" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb13-118"><a href="#cb13-118" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.error(<span class="ss">f&quot;‚ùå Erro inesperado na tentativa </span><span class="sc">{</span>attempt <span class="op">+</span> <span class="dv">1</span><span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb13-119"><a href="#cb13-119" aria-hidden="true" tabindex="-1"></a>            <span class="cf">finally</span>:</span>
<span id="cb13-120"><a href="#cb13-120" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> driver:</span>
<span id="cb13-121"><a href="#cb13-121" aria-hidden="true" tabindex="-1"></a>                    driver.quit()</span>
<span id="cb13-122"><a href="#cb13-122" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb13-123"><a href="#cb13-123" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> attempt <span class="op">&lt;</span> retry_count <span class="op">-</span> <span class="dv">1</span>:</span>
<span id="cb13-124"><a href="#cb13-124" aria-hidden="true" tabindex="-1"></a>                time.sleep(<span class="dv">5</span>)  <span class="co"># Espera entre tentativas</span></span>
<span id="cb13-125"><a href="#cb13-125" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb13-126"><a href="#cb13-126" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.logger.error(<span class="ss">f&quot;üí• Falha ap√≥s </span><span class="sc">{</span>retry_count<span class="sc">}</span><span class="ss"> tentativas: </span><span class="sc">{</span>Path(html_file)<span class="sc">.</span>name<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb13-127"><a href="#cb13-127" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb13-128"><a href="#cb13-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-129"><a href="#cb13-129" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> convert_single_file(<span class="va">self</span>, html_file: <span class="bu">str</span>, mode: <span class="bu">str</span>, dry_run: <span class="bu">bool</span>) <span class="op">-&gt;</span> <span class="bu">tuple</span>:</span>
<span id="cb13-130"><a href="#cb13-130" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Processa um √∫nico arquivo HTML&quot;&quot;&quot;</span></span>
<span id="cb13-131"><a href="#cb13-131" aria-hidden="true" tabindex="-1"></a>        base_name <span class="op">=</span> Path(html_file).stem</span>
<span id="cb13-132"><a href="#cb13-132" aria-hidden="true" tabindex="-1"></a>        pdf_file <span class="op">=</span> <span class="va">self</span>.pdf_dir <span class="op">/</span> <span class="ss">f&quot;</span><span class="sc">{</span>base_name<span class="sc">}</span><span class="ss">.pdf&quot;</span></span>
<span id="cb13-133"><a href="#cb13-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-134"><a href="#cb13-134" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Verifica se precisa processar</span></span>
<span id="cb13-135"><a href="#cb13-135" aria-hidden="true" tabindex="-1"></a>        pdf_exists <span class="op">=</span> pdf_file.exists()</span>
<span id="cb13-136"><a href="#cb13-136" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> mode <span class="op">==</span> <span class="st">&#39;only_new&#39;</span> <span class="kw">and</span> pdf_exists:</span>
<span id="cb13-137"><a href="#cb13-137" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="ss">f&quot;‚è≠Ô∏è PDF j√° existe: </span><span class="sc">{</span>pdf_file<span class="sc">.</span>name<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb13-138"><a href="#cb13-138" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> (html_file, <span class="va">True</span>, <span class="st">&quot;J√° existe&quot;</span>)</span>
<span id="cb13-139"><a href="#cb13-139" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> mode <span class="op">==</span> <span class="st">&#39;force&#39;</span> <span class="kw">and</span> pdf_exists:</span>
<span id="cb13-140"><a href="#cb13-140" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="ss">f&quot;‚ôªÔ∏è Substituindo PDF: </span><span class="sc">{</span>pdf_file<span class="sc">.</span>name<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb13-141"><a href="#cb13-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-142"><a href="#cb13-142" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> dry_run:</span>
<span id="cb13-143"><a href="#cb13-143" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="ss">f&quot;üß™ [DRY-RUN] Processaria: </span><span class="sc">{</span>Path(html_file)<span class="sc">.</span>name<span class="sc">}</span><span class="ss"> ‚Üí </span><span class="sc">{</span>pdf_file<span class="sc">.</span>name<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb13-144"><a href="#cb13-144" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> (html_file, <span class="va">True</span>, <span class="st">&quot;Dry-run&quot;</span>)</span>
<span id="cb13-145"><a href="#cb13-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-146"><a href="#cb13-146" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Convers√£o real</span></span>
<span id="cb13-147"><a href="#cb13-147" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb13-148"><a href="#cb13-148" aria-hidden="true" tabindex="-1"></a>            success <span class="op">=</span> <span class="va">self</span>.html_to_pdf(<span class="bu">str</span>(html_file), <span class="bu">str</span>(pdf_file))</span>
<span id="cb13-149"><a href="#cb13-149" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> (html_file, success, <span class="st">&quot;Sucesso&quot;</span> <span class="cf">if</span> success <span class="cf">else</span> <span class="st">&quot;Falha na convers√£o PDF&quot;</span>)</span>
<span id="cb13-150"><a href="#cb13-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-151"><a href="#cb13-151" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb13-152"><a href="#cb13-152" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.error(<span class="ss">f&quot;‚ùå Erro processando </span><span class="sc">{</span>Path(html_file)<span class="sc">.</span>name<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb13-153"><a href="#cb13-153" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> (html_file, <span class="va">False</span>, <span class="ss">f&quot;Erro: </span><span class="sc">{</span><span class="bu">str</span>(e)<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb13-154"><a href="#cb13-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-155"><a href="#cb13-155" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> generate_pdfs(<span class="va">self</span>, mode: <span class="bu">str</span> <span class="op">=</span> <span class="st">&#39;only_new&#39;</span>, dry_run: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>) <span class="op">-&gt;</span> <span class="bu">bool</span>:</span>
<span id="cb13-156"><a href="#cb13-156" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Gera PDFs a partir dos arquivos HTML&quot;&quot;&quot;</span></span>
<span id="cb13-157"><a href="#cb13-157" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.ensure_directories():</span>
<span id="cb13-158"><a href="#cb13-158" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb13-159"><a href="#cb13-159" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb13-160"><a href="#cb13-160" aria-hidden="true" tabindex="-1"></a>        html_files <span class="op">=</span> <span class="bu">list</span>(<span class="va">self</span>.html_dir.glob(<span class="st">&quot;*.html&quot;</span>))</span>
<span id="cb13-161"><a href="#cb13-161" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb13-162"><a href="#cb13-162" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> html_files:</span>
<span id="cb13-163"><a href="#cb13-163" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.error(<span class="st">&quot;‚ùå Nenhum arquivo HTML encontrado para convers√£o.&quot;</span>)</span>
<span id="cb13-164"><a href="#cb13-164" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb13-165"><a href="#cb13-165" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb13-166"><a href="#cb13-166" aria-hidden="true" tabindex="-1"></a>        mode_desc <span class="op">=</span> {</span>
<span id="cb13-167"><a href="#cb13-167" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;only_new&#39;</span>: <span class="st">&quot;apenas novos (sem PDF)&quot;</span>,</span>
<span id="cb13-168"><a href="#cb13-168" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;force&#39;</span>: <span class="st">&quot;for√ßar substitui√ß√£o&quot;</span>, </span>
<span id="cb13-169"><a href="#cb13-169" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;dry_run&#39;</span>: <span class="st">&quot;modo simula√ß√£o&quot;</span></span>
<span id="cb13-170"><a href="#cb13-170" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb13-171"><a href="#cb13-171" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb13-172"><a href="#cb13-172" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.logger.info(<span class="ss">f&quot;üéØ Encontrados </span><span class="sc">{</span><span class="bu">len</span>(html_files)<span class="sc">}</span><span class="ss"> arquivos HTML&quot;</span>)</span>
<span id="cb13-173"><a href="#cb13-173" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.logger.info(<span class="ss">f&quot;üîß Modo: </span><span class="sc">{</span>mode_desc<span class="sc">.</span>get(mode, mode)<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb13-174"><a href="#cb13-174" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.logger.info(<span class="ss">f&quot;üë• Workers: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>max_workers<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb13-175"><a href="#cb13-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-176"><a href="#cb13-176" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> dry_run:</span>
<span id="cb13-177"><a href="#cb13-177" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="st">&quot;üß™ [DRY-RUN] Simulando convers√£o de arquivos:&quot;</span>)</span>
<span id="cb13-178"><a href="#cb13-178" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> html_file <span class="kw">in</span> html_files:</span>
<span id="cb13-179"><a href="#cb13-179" aria-hidden="true" tabindex="-1"></a>                pdf_file <span class="op">=</span> <span class="va">self</span>.pdf_dir <span class="op">/</span> <span class="ss">f&quot;</span><span class="sc">{</span>html_file<span class="sc">.</span>stem<span class="sc">}</span><span class="ss">.pdf&quot;</span></span>
<span id="cb13-180"><a href="#cb13-180" aria-hidden="true" tabindex="-1"></a>                pdf_exists <span class="op">=</span> pdf_file.exists()</span>
<span id="cb13-181"><a href="#cb13-181" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb13-182"><a href="#cb13-182" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> mode <span class="op">==</span> <span class="st">&#39;only_new&#39;</span> <span class="kw">and</span> pdf_exists:</span>
<span id="cb13-183"><a href="#cb13-183" aria-hidden="true" tabindex="-1"></a>                    status <span class="op">=</span> <span class="st">&quot;‚è≠Ô∏è J√° existe&quot;</span></span>
<span id="cb13-184"><a href="#cb13-184" aria-hidden="true" tabindex="-1"></a>                <span class="cf">elif</span> mode <span class="op">==</span> <span class="st">&#39;force&#39;</span> <span class="kw">and</span> pdf_exists:</span>
<span id="cb13-185"><a href="#cb13-185" aria-hidden="true" tabindex="-1"></a>                    status <span class="op">=</span> <span class="st">&quot;‚ôªÔ∏è Substituiria&quot;</span></span>
<span id="cb13-186"><a href="#cb13-186" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb13-187"><a href="#cb13-187" aria-hidden="true" tabindex="-1"></a>                    status <span class="op">=</span> <span class="st">&quot;üÜï Criaria&quot;</span></span>
<span id="cb13-188"><a href="#cb13-188" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb13-189"><a href="#cb13-189" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.info(<span class="ss">f&quot;   </span><span class="sc">{</span>status<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>html_file<span class="sc">.</span>name<span class="sc">}</span><span class="ss"> ‚Üí </span><span class="sc">{</span>pdf_file<span class="sc">.</span>name<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb13-190"><a href="#cb13-190" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb13-191"><a href="#cb13-191" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="ss">f&quot;üß™ [DRY-RUN] Simula√ß√£o conclu√≠da: </span><span class="sc">{</span><span class="bu">len</span>(html_files)<span class="sc">}</span><span class="ss"> arquivos processados&quot;</span>)</span>
<span id="cb13-192"><a href="#cb13-192" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb13-193"><a href="#cb13-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-194"><a href="#cb13-194" aria-hidden="true" tabindex="-1"></a>        success_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb13-195"><a href="#cb13-195" aria-hidden="true" tabindex="-1"></a>        failed_files <span class="op">=</span> []</span>
<span id="cb13-196"><a href="#cb13-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-197"><a href="#cb13-197" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Processamento real em paralelo</span></span>
<span id="cb13-198"><a href="#cb13-198" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> ThreadPoolExecutor(max_workers<span class="op">=</span><span class="va">self</span>.max_workers) <span class="im">as</span> executor:</span>
<span id="cb13-199"><a href="#cb13-199" aria-hidden="true" tabindex="-1"></a>            futures <span class="op">=</span> {</span>
<span id="cb13-200"><a href="#cb13-200" aria-hidden="true" tabindex="-1"></a>                executor.submit(</span>
<span id="cb13-201"><a href="#cb13-201" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.convert_single_file, </span>
<span id="cb13-202"><a href="#cb13-202" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">str</span>(html_file), </span>
<span id="cb13-203"><a href="#cb13-203" aria-hidden="true" tabindex="-1"></a>                    mode, </span>
<span id="cb13-204"><a href="#cb13-204" aria-hidden="true" tabindex="-1"></a>                    dry_run</span>
<span id="cb13-205"><a href="#cb13-205" aria-hidden="true" tabindex="-1"></a>                ): html_file <span class="cf">for</span> html_file <span class="kw">in</span> html_files</span>
<span id="cb13-206"><a href="#cb13-206" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb13-207"><a href="#cb13-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-208"><a href="#cb13-208" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> future <span class="kw">in</span> as_completed(futures):</span>
<span id="cb13-209"><a href="#cb13-209" aria-hidden="true" tabindex="-1"></a>                html_file, success, message <span class="op">=</span> future.result()</span>
<span id="cb13-210"><a href="#cb13-210" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> success:</span>
<span id="cb13-211"><a href="#cb13-211" aria-hidden="true" tabindex="-1"></a>                    success_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb13-212"><a href="#cb13-212" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb13-213"><a href="#cb13-213" aria-hidden="true" tabindex="-1"></a>                    failed_files.append((Path(html_file).name, message))</span>
<span id="cb13-214"><a href="#cb13-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-215"><a href="#cb13-215" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Relat√≥rio final</span></span>
<span id="cb13-216"><a href="#cb13-216" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.logger.info(<span class="ss">f&quot;üìä Resumo da convers√£o:&quot;</span>)</span>
<span id="cb13-217"><a href="#cb13-217" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.logger.info(<span class="ss">f&quot; ‚úÖ Sucessos: </span><span class="sc">{</span>success_count<span class="sc">}</span><span class="ss">/</span><span class="sc">{</span><span class="bu">len</span>(html_files)<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb13-218"><a href="#cb13-218" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.logger.info(<span class="ss">f&quot; ‚ùå Falhas: </span><span class="sc">{</span><span class="bu">len</span>(failed_files)<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb13-219"><a href="#cb13-219" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb13-220"><a href="#cb13-220" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> failed_files:</span>
<span id="cb13-221"><a href="#cb13-221" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="st">&quot;üìã Arquivos com falha:&quot;</span>)</span>
<span id="cb13-222"><a href="#cb13-222" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> failed, reason <span class="kw">in</span> failed_files[:<span class="dv">10</span>]:</span>
<span id="cb13-223"><a href="#cb13-223" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.info(<span class="ss">f&quot; - </span><span class="sc">{</span>failed<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>reason<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb13-224"><a href="#cb13-224" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">len</span>(failed_files) <span class="op">&gt;</span> <span class="dv">10</span>:</span>
<span id="cb13-225"><a href="#cb13-225" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.info(<span class="ss">f&quot; ... e mais </span><span class="sc">{</span><span class="bu">len</span>(failed_files) <span class="op">-</span> <span class="dv">10</span><span class="sc">}</span><span class="ss"> arquivos&quot;</span>)</span>
<span id="cb13-226"><a href="#cb13-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-227"><a href="#cb13-227" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> success_count <span class="op">&gt;</span> <span class="dv">0</span></span>
<span id="cb13-228"><a href="#cb13-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-229"><a href="#cb13-229" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> generate_single_pdf(<span class="va">self</span>, html_filename: <span class="bu">str</span>, mode: <span class="bu">str</span> <span class="op">=</span> <span class="st">&#39;force&#39;</span>) <span class="op">-&gt;</span> <span class="bu">bool</span>:</span>
<span id="cb13-230"><a href="#cb13-230" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Gera um √∫nico PDF a partir de um arquivo HTML espec√≠fico&quot;&quot;&quot;</span></span>
<span id="cb13-231"><a href="#cb13-231" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.ensure_directories():</span>
<span id="cb13-232"><a href="#cb13-232" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb13-233"><a href="#cb13-233" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb13-234"><a href="#cb13-234" aria-hidden="true" tabindex="-1"></a>        html_file <span class="op">=</span> <span class="va">self</span>.html_dir <span class="op">/</span> html_filename</span>
<span id="cb13-235"><a href="#cb13-235" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> html_file.exists():</span>
<span id="cb13-236"><a href="#cb13-236" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.error(<span class="ss">f&quot;‚ùå Arquivo HTML n√£o encontrado: </span><span class="sc">{</span>html_file<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb13-237"><a href="#cb13-237" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb13-238"><a href="#cb13-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-239"><a href="#cb13-239" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> <span class="va">self</span>.convert_single_file(<span class="bu">str</span>(html_file), mode, dry_run<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb13-240"><a href="#cb13-240" aria-hidden="true" tabindex="-1"></a>        success <span class="op">=</span> result[<span class="dv">1</span>]</span>
<span id="cb13-241"><a href="#cb13-241" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb13-242"><a href="#cb13-242" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> success:</span>
<span id="cb13-243"><a href="#cb13-243" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="ss">f&quot;‚úÖ PDF criado com sucesso: </span><span class="sc">{</span>html_filename<span class="sc">}</span><span class="ss"> ‚Üí </span><span class="sc">{</span>html_file<span class="sc">.</span>stem<span class="sc">}</span><span class="ss">.pdf&quot;</span>)</span>
<span id="cb13-244"><a href="#cb13-244" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb13-245"><a href="#cb13-245" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.error(<span class="ss">f&quot;‚ùå Falha ao criar PDF: </span><span class="sc">{</span>html_filename<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb13-246"><a href="#cb13-246" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb13-247"><a href="#cb13-247" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> success</span>
<span id="cb13-248"><a href="#cb13-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-249"><a href="#cb13-249" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> main():</span>
<span id="cb13-250"><a href="#cb13-250" aria-hidden="true" tabindex="-1"></a>    parser <span class="op">=</span> argparse.ArgumentParser(</span>
<span id="cb13-251"><a href="#cb13-251" aria-hidden="true" tabindex="-1"></a>        description<span class="op">=</span><span class="st">&quot;Gera PDFs a partir de arquivos HTML usando Chrome Driver (baseado em comb_pdf_direct4_optimized.py)&quot;</span></span>
<span id="cb13-252"><a href="#cb13-252" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb13-253"><a href="#cb13-253" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-254"><a href="#cb13-254" aria-hidden="true" tabindex="-1"></a>    group <span class="op">=</span> parser.add_mutually_exclusive_group()</span>
<span id="cb13-255"><a href="#cb13-255" aria-hidden="true" tabindex="-1"></a>    group.add_argument(<span class="st">&#39;--force&#39;</span>, action<span class="op">=</span><span class="st">&#39;store_true&#39;</span>, <span class="bu">help</span><span class="op">=</span><span class="st">&quot;Sobrescreve PDFs j√° existentes&quot;</span>)</span>
<span id="cb13-256"><a href="#cb13-256" aria-hidden="true" tabindex="-1"></a>    group.add_argument(<span class="st">&#39;--only-new&#39;</span>, action<span class="op">=</span><span class="st">&#39;store_true&#39;</span>, default<span class="op">=</span><span class="va">True</span>, <span class="bu">help</span><span class="op">=</span><span class="st">&quot;Apenas novos arquivos (padr√£o)&quot;</span>)</span>
<span id="cb13-257"><a href="#cb13-257" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-258"><a href="#cb13-258" aria-hidden="true" tabindex="-1"></a>    parser.add_argument(<span class="st">&#39;--dry-run&#39;</span>, action<span class="op">=</span><span class="st">&#39;store_true&#39;</span>, <span class="bu">help</span><span class="op">=</span><span class="st">&quot;Simula sem criar arquivos&quot;</span>)</span>
<span id="cb13-259"><a href="#cb13-259" aria-hidden="true" tabindex="-1"></a>    parser.add_argument(<span class="st">&#39;--source&#39;</span>, default<span class="op">=</span><span class="st">&quot;combined_html&quot;</span>, <span class="bu">help</span><span class="op">=</span><span class="st">&quot;Pasta com arquivos .html&quot;</span>)</span>
<span id="cb13-260"><a href="#cb13-260" aria-hidden="true" tabindex="-1"></a>    parser.add_argument(<span class="st">&#39;--output&#39;</span>, default<span class="op">=</span><span class="st">&quot;combined_pdfs&quot;</span>, <span class="bu">help</span><span class="op">=</span><span class="st">&quot;Pasta de sa√≠da para PDFs&quot;</span>)</span>
<span id="cb13-261"><a href="#cb13-261" aria-hidden="true" tabindex="-1"></a>    parser.add_argument(<span class="st">&#39;--workers&#39;</span>, <span class="bu">type</span><span class="op">=</span><span class="bu">int</span>, default<span class="op">=</span><span class="dv">3</span>, <span class="bu">help</span><span class="op">=</span><span class="st">&quot;N√∫mero de processos paralelos&quot;</span>)</span>
<span id="cb13-262"><a href="#cb13-262" aria-hidden="true" tabindex="-1"></a>    parser.add_argument(<span class="st">&#39;--no-headless&#39;</span>, action<span class="op">=</span><span class="st">&#39;store_true&#39;</span>, <span class="bu">help</span><span class="op">=</span><span class="st">&quot;Mostra navegador (debug)&quot;</span>)</span>
<span id="cb13-263"><a href="#cb13-263" aria-hidden="true" tabindex="-1"></a>    parser.add_argument(<span class="st">&#39;--single-file&#39;</span>, <span class="bu">type</span><span class="op">=</span><span class="bu">str</span>, <span class="bu">help</span><span class="op">=</span><span class="st">&quot;Converte apenas um arquivo HTML espec√≠fico&quot;</span>)</span>
<span id="cb13-264"><a href="#cb13-264" aria-hidden="true" tabindex="-1"></a>    parser.add_argument(<span class="st">&#39;--timeout&#39;</span>, <span class="bu">type</span><span class="op">=</span><span class="bu">int</span>, default<span class="op">=</span><span class="dv">60</span>, <span class="bu">help</span><span class="op">=</span><span class="st">&quot;Timeout para carregamento de p√°ginas&quot;</span>)</span>
<span id="cb13-265"><a href="#cb13-265" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-266"><a href="#cb13-266" aria-hidden="true" tabindex="-1"></a>    args <span class="op">=</span> parser.parse_args()</span>
<span id="cb13-267"><a href="#cb13-267" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-268"><a href="#cb13-268" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Determina modo de opera√ß√£o</span></span>
<span id="cb13-269"><a href="#cb13-269" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> args.dry_run:</span>
<span id="cb13-270"><a href="#cb13-270" aria-hidden="true" tabindex="-1"></a>        mode <span class="op">=</span> <span class="st">&#39;dry_run&#39;</span></span>
<span id="cb13-271"><a href="#cb13-271" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> args.force:</span>
<span id="cb13-272"><a href="#cb13-272" aria-hidden="true" tabindex="-1"></a>        mode <span class="op">=</span> <span class="st">&#39;force&#39;</span></span>
<span id="cb13-273"><a href="#cb13-273" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb13-274"><a href="#cb13-274" aria-hidden="true" tabindex="-1"></a>        mode <span class="op">=</span> <span class="st">&#39;only_new&#39;</span></span>
<span id="cb13-275"><a href="#cb13-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-276"><a href="#cb13-276" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;üöÄ PDF GENERATOR - HTML BASED (Chrome Driver)&quot;</span>)</span>
<span id="cb13-277"><a href="#cb13-277" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;=&quot;</span> <span class="op">*</span> <span class="dv">50</span>)</span>
<span id="cb13-278"><a href="#cb13-278" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-279"><a href="#cb13-279" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> args.dry_run:</span>
<span id="cb13-280"><a href="#cb13-280" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;üß™ MODO DRY-RUN ATIVADO - Nenhum arquivo ser√° criado&quot;</span>)</span>
<span id="cb13-281"><a href="#cb13-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-282"><a href="#cb13-282" aria-hidden="true" tabindex="-1"></a>    generator <span class="op">=</span> PDFGeneratorHTML(</span>
<span id="cb13-283"><a href="#cb13-283" aria-hidden="true" tabindex="-1"></a>        force_overwrite<span class="op">=</span>args.force,</span>
<span id="cb13-284"><a href="#cb13-284" aria-hidden="true" tabindex="-1"></a>        max_workers<span class="op">=</span>args.workers,</span>
<span id="cb13-285"><a href="#cb13-285" aria-hidden="true" tabindex="-1"></a>        headless<span class="op">=</span><span class="kw">not</span> args.no_headless,</span>
<span id="cb13-286"><a href="#cb13-286" aria-hidden="true" tabindex="-1"></a>        timeout<span class="op">=</span>args.timeout</span>
<span id="cb13-287"><a href="#cb13-287" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb13-288"><a href="#cb13-288" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-289"><a href="#cb13-289" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Configura pastas personalizadas se fornecidas</span></span>
<span id="cb13-290"><a href="#cb13-290" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> args.source <span class="op">!=</span> <span class="st">&quot;combined_html&quot;</span>:</span>
<span id="cb13-291"><a href="#cb13-291" aria-hidden="true" tabindex="-1"></a>        generator.html_dir <span class="op">=</span> Path(args.source)</span>
<span id="cb13-292"><a href="#cb13-292" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> args.output <span class="op">!=</span> <span class="st">&quot;combined_pdfs&quot;</span>:</span>
<span id="cb13-293"><a href="#cb13-293" aria-hidden="true" tabindex="-1"></a>        generator.pdf_dir <span class="op">=</span> Path(args.output)</span>
<span id="cb13-294"><a href="#cb13-294" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-295"><a href="#cb13-295" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Verifica depend√™ncias</span></span>
<span id="cb13-296"><a href="#cb13-296" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> generator.check_chrome_driver():</span>
<span id="cb13-297"><a href="#cb13-297" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;‚ùå Chrome Driver n√£o dispon√≠vel. Instale o Chrome e Chrome Driver.&quot;</span>)</span>
<span id="cb13-298"><a href="#cb13-298" aria-hidden="true" tabindex="-1"></a>        exit(<span class="dv">1</span>)</span>
<span id="cb13-299"><a href="#cb13-299" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-300"><a href="#cb13-300" aria-hidden="true" tabindex="-1"></a>    success <span class="op">=</span> <span class="va">False</span></span>
<span id="cb13-301"><a href="#cb13-301" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-302"><a href="#cb13-302" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> args.single_file:</span>
<span id="cb13-303"><a href="#cb13-303" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;üéØ Convertendo arquivo √∫nico: </span><span class="sc">{</span>args<span class="sc">.</span>single_file<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb13-304"><a href="#cb13-304" aria-hidden="true" tabindex="-1"></a>        success <span class="op">=</span> generator.generate_single_pdf(args.single_file, mode)</span>
<span id="cb13-305"><a href="#cb13-305" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb13-306"><a href="#cb13-306" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;üîÑ Convertendo todos os arquivos HTML...&quot;</span>)</span>
<span id="cb13-307"><a href="#cb13-307" aria-hidden="true" tabindex="-1"></a>        success <span class="op">=</span> generator.generate_pdfs(mode<span class="op">=</span>mode, dry_run<span class="op">=</span>args.dry_run)</span>
<span id="cb13-308"><a href="#cb13-308" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-309"><a href="#cb13-309" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> args.dry_run:</span>
<span id="cb13-310"><a href="#cb13-310" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;üß™ MODO DRY-RUN FINALIZADO - Verifique o log acima&quot;</span>)</span>
<span id="cb13-311"><a href="#cb13-311" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb13-312"><a href="#cb13-312" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> success:</span>
<span id="cb13-313"><a href="#cb13-313" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;üéâ Convers√£o conclu√≠da com sucesso!&quot;</span>)</span>
<span id="cb13-314"><a href="#cb13-314" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;üìÅ PDFs salvos em: </span><span class="sc">{</span>generator<span class="sc">.</span>pdf_dir<span class="sc">.</span>absolute()<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb13-315"><a href="#cb13-315" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb13-316"><a href="#cb13-316" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;‚ö†Ô∏è Convers√£o parcial ou com falhas.&quot;</span>)</span>
<span id="cb13-317"><a href="#cb13-317" aria-hidden="true" tabindex="-1"></a>            exit(<span class="dv">1</span>)</span>
<span id="cb13-318"><a href="#cb13-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-319"><a href="#cb13-319" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&quot;__main__&quot;</span>:</span>
<span id="cb13-320"><a href="#cb13-320" aria-hidden="true" tabindex="-1"></a>    main()</span></code></pre></div>
<h2 data-number="1.17" id="principais-caracter√≠sticas-do-comb_pdf_direct5_html_based.py"><span class="header-section-number">1.17</span> üîß <strong>Principais
Caracter√≠sticas do comb_pdf_direct5_html_based.py:</strong></h2>
<h3 data-number="1.17.1" id="m√©todo-de-convers√£o-id√™ntico"><span class="header-section-number">1.17.1</span> <strong>‚úÖ M√©todo de
Convers√£o Id√™ntico:</strong></h3>
<ul>
<li>Usa <strong>exatamente o mesmo m√©todo</strong>
<code>html_to_pdf()</code> do
<code>comb_pdf_direct4_optimized.py</code></li>
<li><strong>Chrome Driver</strong> com as mesmas op√ß√µes e
configura√ß√µes</li>
<li><strong>PDF parameters</strong> id√™nticos para qualidade
consistente</li>
<li><strong>Sistema de retry</strong> com m√∫ltiplas tentativas</li>
</ul>
<h3 data-number="1.17.2" id="fluxo-simplificado"><span class="header-section-number">1.17.2</span> <strong>üîÑ Fluxo
Simplificado:</strong></h3>
<ul>
<li><strong>Entrada:</strong> Arquivos HTML da pasta
<code>combined_html/</code></li>
<li><strong>Processamento:</strong> Convers√£o direta HTML ‚Üí PDF</li>
<li><strong>Sa√≠da:</strong> PDFs na pasta
<code>combined_pdfs/</code></li>
</ul>
<h3 data-number="1.17.3" id="funcionalidades-mantidas"><span class="header-section-number">1.17.3</span> <strong>üéØ Funcionalidades
Mantidas:</strong></h3>
<ul>
<li><strong>Processamento paralelo</strong> com ThreadPoolExecutor</li>
<li><strong>Modos de opera√ß√£o:</strong> <code>--force</code>,
<code>--only-new</code>, <code>--dry-run</code></li>
<li><strong>Convers√£o individual</strong> com
<code>--single-file</code></li>
<li><strong>Logging detalhado</strong> e relat√≥rios</li>
<li><strong>Verifica√ß√£o de depend√™ncias</strong> (Chrome Driver)</li>
</ul>
<h3 data-number="1.17.4" id="como-usar-2"><span class="header-section-number">1.17.4</span> <strong>üöÄ Como
Usar:</strong></h3>
<div class="sourceCode" id="cb14"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Converter todos os HTMLs (apenas novos)</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> comb_pdf_direct5_html_based.py</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co"># For√ßar substitui√ß√£o de todos os PDFs</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> comb_pdf_direct5_html_based.py <span class="at">--force</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Apenas simular (dry-run)</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> comb_pdf_direct5_html_based.py <span class="at">--dry-run</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Converter arquivo espec√≠fico</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> comb_pdf_direct5_html_based.py <span class="at">--single-file</span> <span class="st">&quot;001_ChatGPT_Conversa.html&quot;</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Com mais workers para velocidade</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> comb_pdf_direct5_html_based.py <span class="at">--force</span> <span class="at">--workers</span> 5</span></code></pre></div>
<p>Agora voc√™ tem um sistema <strong>muito mais eficiente</strong> onde:
1. <strong>comb_fragments_system3_html_export.py</strong> gera HTMLs
elegantes 2. <strong>comb_pdf_direct5_html_based.py</strong> converte
esses HTMLs para PDFs com qualidade superior</p>
<p>O fluxo √© mais r√°pido e confi√°vel! üéâ</p>
<hr />
<h3 data-number="1.17.5" id="utilizador-2025-11-05-063358-deepseek-chat"><span class="header-section-number">1.17.5</span> üë§ Utilizador
<em>(2025-11-05 06:33:58)</em> <em>[deepseek-chat]</em></h3>
<p>Pretendo que no file comb_fragments_system3_html_export.py, as
conversas devem dar origem ao md e depois a convers√£o de md para html
seja feita com pandoc ‚Äìstandalone ‚Äìmathjax;O fluxo deve ser: zip ‚Üí
Processor ‚Üí Markdown + html</p>
<hr />
<h3 data-number="1.17.6" id="deepseek-2025-11-05-063358-deepseek-chat"><span class="header-section-number">1.17.6</span> ü§ñ DeepSeek <em>(2025-11-05
06:33:58)</em> <em>[deepseek-chat]</em></h3>
<p>Perfeito! Vou modificar o
<code>comb_fragments_system3_html_export.py</code> para usar o Pandoc
com <code>--standalone --mathjax</code> para a convers√£o MD ‚Üí HTML:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># comb_fragments_system3_html_export.py</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> zipfile</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> csv</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> argparse</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sys</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> webbrowser</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> shutil</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tempfile</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> traceback</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> subprocess</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Any, Optional</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> CombinedFragmentsSystem:</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, dry_run<span class="op">=</span><span class="va">False</span>, force_overwrite<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.data_dir <span class="op">=</span> Path(<span class="st">&quot;data&quot;</span>)</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.dry_run <span class="op">=</span> dry_run</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.force_overwrite <span class="op">=</span> force_overwrite</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Estrutura de pastas organizada</span></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.output_dirs <span class="op">=</span> {</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;markdown&#39;</span>: <span class="st">&quot;combined_markdown&quot;</span>,</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;csv&#39;</span>: <span class="st">&quot;combined_csv&quot;</span>, </span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;json&#39;</span>: <span class="st">&quot;combined_json&quot;</span>,</span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;pdfs&#39;</span>: <span class="st">&quot;combined_pdfs&quot;</span>,</span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;html&#39;</span>: <span class="st">&quot;combined_html&quot;</span>  <span class="co"># NOVA PASTA</span></span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.single_files <span class="op">=</span> {</span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;csv&#39;</span>: <span class="st">&quot;combined_all_conversations.csv&quot;</span>,</span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;json&#39;</span>: <span class="st">&quot;combined_all_conversations.json&quot;</span></span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.index_file <span class="op">=</span> <span class="st">&quot;index.html&quot;</span></span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.all_conversations <span class="op">=</span> []</span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Configura√ß√£o de processamento por fonte</span></span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.processors <span class="op">=</span> {</span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;qwen&#39;</span>: {</span>
<span id="cb15-44"><a href="#cb15-44" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;file&#39;</span>: <span class="st">&quot;chat-export.json&quot;</span>,</span>
<span id="cb15-45"><a href="#cb15-45" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;method&#39;</span>: <span class="va">self</span>.process_qwen_enhanced,</span>
<span id="cb15-46"><a href="#cb15-46" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;enabled&#39;</span>: <span class="va">True</span></span>
<span id="cb15-47"><a href="#cb15-47" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb15-48"><a href="#cb15-48" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;chatgpt&#39;</span>: {</span>
<span id="cb15-49"><a href="#cb15-49" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;file&#39;</span>: <span class="st">&quot;chatgpt.zip&quot;</span>, </span>
<span id="cb15-50"><a href="#cb15-50" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;method&#39;</span>: <span class="va">self</span>.process_chatgpt,</span>
<span id="cb15-51"><a href="#cb15-51" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;enabled&#39;</span>: <span class="va">True</span></span>
<span id="cb15-52"><a href="#cb15-52" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb15-53"><a href="#cb15-53" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;deepseek&#39;</span>: {</span>
<span id="cb15-54"><a href="#cb15-54" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;file&#39;</span>: <span class="st">&quot;deepseek_data.zip&quot;</span>,</span>
<span id="cb15-55"><a href="#cb15-55" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;method&#39;</span>: <span class="va">self</span>.process_deepseek,</span>
<span id="cb15-56"><a href="#cb15-56" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;enabled&#39;</span>: <span class="va">True</span></span>
<span id="cb15-57"><a href="#cb15-57" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb15-58"><a href="#cb15-58" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;grok&#39;</span>: {</span>
<span id="cb15-59"><a href="#cb15-59" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;file&#39;</span>: <span class="st">&quot;grok.zip&quot;</span>,</span>
<span id="cb15-60"><a href="#cb15-60" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;method&#39;</span>: <span class="va">self</span>.process_grok,</span>
<span id="cb15-61"><a href="#cb15-61" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;enabled&#39;</span>: <span class="va">True</span></span>
<span id="cb15-62"><a href="#cb15-62" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb15-63"><a href="#cb15-63" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb15-64"><a href="#cb15-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-65"><a href="#cb15-65" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> sanitize_filename(<span class="va">self</span>, text: <span class="bu">str</span>, max_len: <span class="bu">int</span> <span class="op">=</span> <span class="dv">50</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb15-66"><a href="#cb15-66" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Sanitiza nomes de arquivo PRESERVANDO EMOJIS&quot;&quot;&quot;</span></span>
<span id="cb15-67"><a href="#cb15-67" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> text <span class="kw">or</span> <span class="kw">not</span> <span class="bu">isinstance</span>(text, <span class="bu">str</span>):</span>
<span id="cb15-68"><a href="#cb15-68" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">&quot;conversa_sem_titulo&quot;</span></span>
<span id="cb15-69"><a href="#cb15-69" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb15-70"><a href="#cb15-70" aria-hidden="true" tabindex="-1"></a>        invalid_chars <span class="op">=</span> <span class="vs">r&#39;</span><span class="pp">[&lt;&gt;:&quot;/</span><span class="ch">\\</span><span class="pp">|?*</span><span class="ch">\x00</span><span class="pp">-</span><span class="ch">\x1F\x7F</span><span class="pp">]</span><span class="vs">&#39;</span></span>
<span id="cb15-71"><a href="#cb15-71" aria-hidden="true" tabindex="-1"></a>        sanitized <span class="op">=</span> re.sub(invalid_chars, <span class="st">&#39;&#39;</span>, text)</span>
<span id="cb15-72"><a href="#cb15-72" aria-hidden="true" tabindex="-1"></a>        sanitized <span class="op">=</span> re.sub(<span class="vs">r&#39;</span><span class="dv">\s</span><span class="op">+</span><span class="vs">&#39;</span>, <span class="st">&#39; &#39;</span>, sanitized.strip())</span>
<span id="cb15-73"><a href="#cb15-73" aria-hidden="true" tabindex="-1"></a>        sanitized <span class="op">=</span> sanitized.strip()</span>
<span id="cb15-74"><a href="#cb15-74" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-75"><a href="#cb15-75" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> sanitized:</span>
<span id="cb15-76"><a href="#cb15-76" aria-hidden="true" tabindex="-1"></a>            sanitized <span class="op">=</span> <span class="st">&quot;conversa_sem_titulo&quot;</span></span>
<span id="cb15-77"><a href="#cb15-77" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb15-78"><a href="#cb15-78" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(sanitized) <span class="op">&gt;</span> max_len:</span>
<span id="cb15-79"><a href="#cb15-79" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="st">&#39; &#39;</span> <span class="kw">in</span> sanitized[:max_len]:</span>
<span id="cb15-80"><a href="#cb15-80" aria-hidden="true" tabindex="-1"></a>                last_space <span class="op">=</span> sanitized[:max_len].rfind(<span class="st">&#39; &#39;</span>)</span>
<span id="cb15-81"><a href="#cb15-81" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> last_space <span class="op">&gt;</span> <span class="dv">10</span>:</span>
<span id="cb15-82"><a href="#cb15-82" aria-hidden="true" tabindex="-1"></a>                    sanitized <span class="op">=</span> sanitized[:last_space]</span>
<span id="cb15-83"><a href="#cb15-83" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb15-84"><a href="#cb15-84" aria-hidden="true" tabindex="-1"></a>                sanitized <span class="op">=</span> sanitized[:max_len]</span>
<span id="cb15-85"><a href="#cb15-85" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb15-86"><a href="#cb15-86" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> sanitized</span>
<span id="cb15-87"><a href="#cb15-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-88"><a href="#cb15-88" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> preserve_special_content(<span class="va">self</span>, content: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb15-89"><a href="#cb15-89" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Preserva f√≥rmulas matem√°ticas, c√≥digo e formata√ß√£o especial&quot;&quot;&quot;</span></span>
<span id="cb15-90"><a href="#cb15-90" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> content:</span>
<span id="cb15-91"><a href="#cb15-91" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">&quot;&quot;</span></span>
<span id="cb15-92"><a href="#cb15-92" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb15-93"><a href="#cb15-93" aria-hidden="true" tabindex="-1"></a>        preserved_content <span class="op">=</span> content</span>
<span id="cb15-94"><a href="#cb15-94" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-95"><a href="#cb15-95" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Corrige problemas com barras invertidas em LaTeX</span></span>
<span id="cb15-96"><a href="#cb15-96" aria-hidden="true" tabindex="-1"></a>        latex_corrections <span class="op">=</span> {</span>
<span id="cb15-97"><a href="#cb15-97" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;‚ôÄrac&#39;</span>: <span class="st">&#39;</span><span class="ch">\\</span><span class="st">frac&#39;</span>,</span>
<span id="cb15-98"><a href="#cb15-98" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;‚ôÇarepsilon&#39;</span>: <span class="st">&#39;</span><span class="ch">\\</span><span class="st">varepsilon&#39;</span>,</span>
<span id="cb15-99"><a href="#cb15-99" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;‚ôÇ&#39;</span>: <span class="st">&#39;</span><span class="ch">\\</span><span class="st">&#39;</span>,</span>
<span id="cb15-100"><a href="#cb15-100" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;‚ôÄ&#39;</span>: <span class="st">&#39;</span><span class="ch">\\</span><span class="st">&#39;</span></span>
<span id="cb15-101"><a href="#cb15-101" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb15-102"><a href="#cb15-102" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-103"><a href="#cb15-103" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> wrong, correct <span class="kw">in</span> latex_corrections.items():</span>
<span id="cb15-104"><a href="#cb15-104" aria-hidden="true" tabindex="-1"></a>            preserved_content <span class="op">=</span> preserved_content.replace(wrong, correct)</span>
<span id="cb15-105"><a href="#cb15-105" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-106"><a href="#cb15-106" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> preserved_content</span>
<span id="cb15-107"><a href="#cb15-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-108"><a href="#cb15-108" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> ensure_directories(<span class="va">self</span>):</span>
<span id="cb15-109"><a href="#cb15-109" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Cria todas as pastas necess√°rias&quot;&quot;&quot;</span></span>
<span id="cb15-110"><a href="#cb15-110" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb15-111"><a href="#cb15-111" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;DRY-RUN: Pastas seriam criadas:&quot;</span>)</span>
<span id="cb15-112"><a href="#cb15-112" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> folder <span class="kw">in</span> <span class="va">self</span>.output_dirs.values():</span>
<span id="cb15-113"><a href="#cb15-113" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;   </span><span class="sc">{</span>folder<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb15-114"><a href="#cb15-114" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb15-115"><a href="#cb15-115" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb15-116"><a href="#cb15-116" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> folder <span class="kw">in</span> <span class="va">self</span>.output_dirs.values():</span>
<span id="cb15-117"><a href="#cb15-117" aria-hidden="true" tabindex="-1"></a>            Path(folder).mkdir(parents<span class="op">=</span><span class="va">True</span>, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb15-118"><a href="#cb15-118" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;Pasta criada: </span><span class="sc">{</span>folder<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb15-119"><a href="#cb15-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-120"><a href="#cb15-120" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> run(<span class="va">self</span>):</span>
<span id="cb15-121"><a href="#cb15-121" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Executa o processamento completo&quot;&quot;&quot;</span></span>
<span id="cb15-122"><a href="#cb15-122" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;SISTEMA COMBINADO DE EXPORTA√á√ïES COM HTML (Qwen3, ChatGPT, DeepSeek, Grok)&quot;</span>)</span>
<span id="cb15-123"><a href="#cb15-123" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;=&quot;</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb15-124"><a href="#cb15-124" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-125"><a href="#cb15-125" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.data_dir.exists():</span>
<span id="cb15-126"><a href="#cb15-126" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;Pasta &#39;</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>data_dir<span class="sc">}</span><span class="ss">&#39; n√£o encontrada.&quot;</span>)</span>
<span id="cb15-127"><a href="#cb15-127" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;Crie a pasta &#39;data&#39; e coloque os arquivos de exporta√ß√£o:&quot;</span>)</span>
<span id="cb15-128"><a href="#cb15-128" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> source_name, config <span class="kw">in</span> <span class="va">self</span>.processors.items():</span>
<span id="cb15-129"><a href="#cb15-129" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;   - </span><span class="sc">{</span>config[<span class="st">&#39;file&#39;</span>]<span class="sc">}</span><span class="ss"> (para </span><span class="sc">{</span>source_name<span class="sc">.</span>upper()<span class="sc">}</span><span class="ss">)&quot;</span>)</span>
<span id="cb15-130"><a href="#cb15-130" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb15-131"><a href="#cb15-131" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-132"><a href="#cb15-132" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;Usando pasta de dados: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>data_dir<span class="sc">.</span>absolute()<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb15-133"><a href="#cb15-133" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-134"><a href="#cb15-134" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.ensure_directories()</span>
<span id="cb15-135"><a href="#cb15-135" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-136"><a href="#cb15-136" aria-hidden="true" tabindex="-1"></a>        processed_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb15-137"><a href="#cb15-137" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> source_name, config <span class="kw">in</span> <span class="va">self</span>.processors.items():</span>
<span id="cb15-138"><a href="#cb15-138" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> config[<span class="st">&#39;enabled&#39;</span>]:</span>
<span id="cb15-139"><a href="#cb15-139" aria-hidden="true" tabindex="-1"></a>                file_path <span class="op">=</span> <span class="va">self</span>.data_dir <span class="op">/</span> config[<span class="st">&#39;file&#39;</span>]</span>
<span id="cb15-140"><a href="#cb15-140" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> file_path.exists():</span>
<span id="cb15-141"><a href="#cb15-141" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="ch">\n</span><span class="ss">Processando </span><span class="sc">{</span>source_name<span class="sc">.</span>upper()<span class="sc">}</span><span class="ss">...&quot;</span>)</span>
<span id="cb15-142"><a href="#cb15-142" aria-hidden="true" tabindex="-1"></a>                    config[<span class="st">&#39;method&#39;</span>](file_path)</span>
<span id="cb15-143"><a href="#cb15-143" aria-hidden="true" tabindex="-1"></a>                    processed_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb15-144"><a href="#cb15-144" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb15-145"><a href="#cb15-145" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="sc">{</span>source_name<span class="sc">.</span>upper()<span class="sc">}</span><span class="ss">: arquivo n√£o encontrado - </span><span class="sc">{</span>file_path<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb15-146"><a href="#cb15-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-147"><a href="#cb15-147" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> processed_count <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb15-148"><a href="#cb15-148" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;Nenhum arquivo de exporta√ß√£o encontrado na pasta &#39;data&#39;.&quot;</span>)</span>
<span id="cb15-149"><a href="#cb15-149" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb15-150"><a href="#cb15-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-151"><a href="#cb15-151" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb15-152"><a href="#cb15-152" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;Nenhuma conversa foi extra√≠da dos arquivos.&quot;</span>)</span>
<span id="cb15-153"><a href="#cb15-153" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb15-154"><a href="#cb15-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-155"><a href="#cb15-155" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>._post_process_conversations()</span>
<span id="cb15-156"><a href="#cb15-156" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-157"><a href="#cb15-157" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.dry_run:</span>
<span id="cb15-158"><a href="#cb15-158" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>._export_all_formats()</span>
<span id="cb15-159"><a href="#cb15-159" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="ch">\n</span><span class="ss">üéâ SISTEMA COMBINADO FINALIZADO!&quot;</span>)</span>
<span id="cb15-160"><a href="#cb15-160" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;üìÑ √çndice: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>index_file<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb15-161"><a href="#cb15-161" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> Path(<span class="va">self</span>.index_file).exists():</span>
<span id="cb15-162"><a href="#cb15-162" aria-hidden="true" tabindex="-1"></a>                webbrowser.<span class="bu">open</span>(<span class="ss">f&#39;file://</span><span class="sc">{</span>Path(<span class="va">self</span>.index_file)<span class="sc">.</span>absolute()<span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb15-163"><a href="#cb15-163" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb15-164"><a href="#cb15-164" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="ch">\n</span><span class="ss">üß™ MODO DRY-RUN: Nenhum arquivo foi criado.&quot;</span>)</span>
<span id="cb15-165"><a href="#cb15-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-166"><a href="#cb15-166" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _post_process_conversations(<span class="va">self</span>):</span>
<span id="cb15-167"><a href="#cb15-167" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Processamento p√≥s-extra√ß√£o das conversas&quot;&quot;&quot;</span></span>
<span id="cb15-168"><a href="#cb15-168" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.all_conversations.sort(</span>
<span id="cb15-169"><a href="#cb15-169" aria-hidden="true" tabindex="-1"></a>            key<span class="op">=</span><span class="kw">lambda</span> x: <span class="va">self</span>.parse_timestamp_for_sorting(</span>
<span id="cb15-170"><a href="#cb15-170" aria-hidden="true" tabindex="-1"></a>                x.get(<span class="st">&#39;updated_at&#39;</span>) <span class="kw">or</span> x.get(<span class="st">&#39;inserted_at&#39;</span>) <span class="kw">or</span> x.get(<span class="st">&#39;created_at&#39;</span>)</span>
<span id="cb15-171"><a href="#cb15-171" aria-hidden="true" tabindex="-1"></a>            ),</span>
<span id="cb15-172"><a href="#cb15-172" aria-hidden="true" tabindex="-1"></a>            reverse<span class="op">=</span><span class="va">True</span></span>
<span id="cb15-173"><a href="#cb15-173" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb15-174"><a href="#cb15-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-175"><a href="#cb15-175" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, conv <span class="kw">in</span> <span class="bu">enumerate</span>(<span class="va">self</span>.all_conversations):</span>
<span id="cb15-176"><a href="#cb15-176" aria-hidden="true" tabindex="-1"></a>            conv[<span class="st">&#39;number&#39;</span>] <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb15-177"><a href="#cb15-177" aria-hidden="true" tabindex="-1"></a>            conv[<span class="st">&#39;category&#39;</span>] <span class="op">=</span> <span class="va">self</span>.categorize_conversation(conv[<span class="st">&#39;title&#39;</span>], conv.get(<span class="st">&#39;summary&#39;</span>, <span class="st">&#39;&#39;</span>))</span>
<span id="cb15-178"><a href="#cb15-178" aria-hidden="true" tabindex="-1"></a>            conv.setdefault(<span class="st">&#39;source&#39;</span>, <span class="st">&#39;Desconhecido&#39;</span>)</span>
<span id="cb15-179"><a href="#cb15-179" aria-hidden="true" tabindex="-1"></a>            conv.setdefault(<span class="st">&#39;messages&#39;</span>, [])</span>
<span id="cb15-180"><a href="#cb15-180" aria-hidden="true" tabindex="-1"></a>            conv.setdefault(<span class="st">&#39;summary&#39;</span>, conv[<span class="st">&#39;messages&#39;</span>][<span class="dv">0</span>][<span class="st">&#39;content&#39;</span>][:<span class="dv">100</span>] <span class="op">+</span> <span class="st">&quot;...&quot;</span> <span class="cf">if</span> conv[<span class="st">&#39;messages&#39;</span>] <span class="cf">else</span> <span class="st">&quot;Sem conte√∫do&quot;</span>)</span>
<span id="cb15-181"><a href="#cb15-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-182"><a href="#cb15-182" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;üìä Total combinado de conversas: </span><span class="sc">{</span><span class="bu">len</span>(<span class="va">self</span>.all_conversations)<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb15-183"><a href="#cb15-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-184"><a href="#cb15-184" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _export_all_formats(<span class="va">self</span>):</span>
<span id="cb15-185"><a href="#cb15-185" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Exporta para todos os formatos&quot;&quot;&quot;</span></span>
<span id="cb15-186"><a href="#cb15-186" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">üíæ Exportando para formatos...&quot;</span>)</span>
<span id="cb15-187"><a href="#cb15-187" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.save_as_markdown_enhanced()</span>
<span id="cb15-188"><a href="#cb15-188" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.save_as_html_with_pandoc()  <span class="co"># NOVO: Exporta√ß√£o HTML com Pandoc</span></span>
<span id="cb15-189"><a href="#cb15-189" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.save_as_csv() </span>
<span id="cb15-190"><a href="#cb15-190" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.save_as_json()</span>
<span id="cb15-191"><a href="#cb15-191" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.save_all_to_single_files()</span>
<span id="cb15-192"><a href="#cb15-192" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.create_searchable_index()</span>
<span id="cb15-193"><a href="#cb15-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-194"><a href="#cb15-194" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> check_pandoc_available(<span class="va">self</span>) <span class="op">-&gt;</span> <span class="bu">bool</span>:</span>
<span id="cb15-195"><a href="#cb15-195" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Verifica se Pandoc est√° dispon√≠vel&quot;&quot;&quot;</span></span>
<span id="cb15-196"><a href="#cb15-196" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb15-197"><a href="#cb15-197" aria-hidden="true" tabindex="-1"></a>            result <span class="op">=</span> subprocess.run(</span>
<span id="cb15-198"><a href="#cb15-198" aria-hidden="true" tabindex="-1"></a>                [<span class="st">&#39;pandoc&#39;</span>, <span class="st">&#39;--version&#39;</span>], </span>
<span id="cb15-199"><a href="#cb15-199" aria-hidden="true" tabindex="-1"></a>                capture_output<span class="op">=</span><span class="va">True</span>, </span>
<span id="cb15-200"><a href="#cb15-200" aria-hidden="true" tabindex="-1"></a>                text<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb15-201"><a href="#cb15-201" aria-hidden="true" tabindex="-1"></a>                timeout<span class="op">=</span><span class="dv">10</span></span>
<span id="cb15-202"><a href="#cb15-202" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb15-203"><a href="#cb15-203" aria-hidden="true" tabindex="-1"></a>            available <span class="op">=</span> result.returncode <span class="op">==</span> <span class="dv">0</span></span>
<span id="cb15-204"><a href="#cb15-204" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> available:</span>
<span id="cb15-205"><a href="#cb15-205" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;‚úÖ Pandoc dispon√≠vel para convers√£o HTML&quot;</span>)</span>
<span id="cb15-206"><a href="#cb15-206" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb15-207"><a href="#cb15-207" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;‚ö†Ô∏è Pandoc n√£o encontrado - HTML n√£o ser√° gerado&quot;</span>)</span>
<span id="cb15-208"><a href="#cb15-208" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> available</span>
<span id="cb15-209"><a href="#cb15-209" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> (subprocess.TimeoutExpired, <span class="pp">FileNotFoundError</span>, <span class="pp">Exception</span>) <span class="im">as</span> e:</span>
<span id="cb15-210"><a href="#cb15-210" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚ö†Ô∏è Pandoc n√£o dispon√≠vel: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb15-211"><a href="#cb15-211" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb15-212"><a href="#cb15-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-213"><a href="#cb15-213" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> convert_markdown_to_html_pandoc(<span class="va">self</span>, md_file_path: Path) <span class="op">-&gt;</span> <span class="bu">bool</span>:</span>
<span id="cb15-214"><a href="#cb15-214" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Converte Markdown para HTML usando Pandoc --standalone --mathjax&quot;&quot;&quot;</span></span>
<span id="cb15-215"><a href="#cb15-215" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb15-216"><a href="#cb15-216" aria-hidden="true" tabindex="-1"></a>            html_file <span class="op">=</span> <span class="va">self</span>.output_dirs[<span class="st">&#39;html&#39;</span>] <span class="op">/</span> md_file_path.with_suffix(<span class="st">&#39;.html&#39;</span>).name</span>
<span id="cb15-217"><a href="#cb15-217" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb15-218"><a href="#cb15-218" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.force_overwrite <span class="kw">and</span> html_file.exists():</span>
<span id="cb15-219"><a href="#cb15-219" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;‚è≠Ô∏è HTML j√° existe: </span><span class="sc">{</span>html_file<span class="sc">.</span>name<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb15-220"><a href="#cb15-220" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb15-221"><a href="#cb15-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-222"><a href="#cb15-222" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;üîß Convertendo com Pandoc: </span><span class="sc">{</span>md_file_path<span class="sc">.</span>name<span class="sc">}</span><span class="ss"> ‚Üí </span><span class="sc">{</span>html_file<span class="sc">.</span>name<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb15-223"><a href="#cb15-223" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb15-224"><a href="#cb15-224" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Comando Pandoc com --standalone --mathjax</span></span>
<span id="cb15-225"><a href="#cb15-225" aria-hidden="true" tabindex="-1"></a>            result <span class="op">=</span> subprocess.run([</span>
<span id="cb15-226"><a href="#cb15-226" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;pandoc&#39;</span>, </span>
<span id="cb15-227"><a href="#cb15-227" aria-hidden="true" tabindex="-1"></a>                <span class="bu">str</span>(md_file_path),</span>
<span id="cb15-228"><a href="#cb15-228" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;--from&#39;</span>, <span class="st">&#39;markdown+emoji&#39;</span>,</span>
<span id="cb15-229"><a href="#cb15-229" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;--to&#39;</span>, <span class="st">&#39;html5&#39;</span>,</span>
<span id="cb15-230"><a href="#cb15-230" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;--standalone&#39;</span>,</span>
<span id="cb15-231"><a href="#cb15-231" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;--mathjax&#39;</span>,</span>
<span id="cb15-232"><a href="#cb15-232" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;--output&#39;</span>, <span class="bu">str</span>(html_file)</span>
<span id="cb15-233"><a href="#cb15-233" aria-hidden="true" tabindex="-1"></a>            ], capture_output<span class="op">=</span><span class="va">True</span>, text<span class="op">=</span><span class="va">True</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>, timeout<span class="op">=</span><span class="dv">30</span>)</span>
<span id="cb15-234"><a href="#cb15-234" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb15-235"><a href="#cb15-235" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> result.returncode <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb15-236"><a href="#cb15-236" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ HTML gerado: </span><span class="sc">{</span>html_file<span class="sc">.</span>name<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb15-237"><a href="#cb15-237" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb15-238"><a href="#cb15-238" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb15-239"><a href="#cb15-239" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;‚ùå Erro no Pandoc para </span><span class="sc">{</span>md_file_path<span class="sc">.</span>name<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>result<span class="sc">.</span>stderr<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb15-240"><a href="#cb15-240" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb15-241"><a href="#cb15-241" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb15-242"><a href="#cb15-242" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> subprocess.TimeoutExpired:</span>
<span id="cb15-243"><a href="#cb15-243" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚è∞ Timeout no Pandoc para </span><span class="sc">{</span>md_file_path<span class="sc">.</span>name<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb15-244"><a href="#cb15-244" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb15-245"><a href="#cb15-245" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb15-246"><a href="#cb15-246" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚ùå Erro inesperado no Pandoc: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb15-247"><a href="#cb15-247" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb15-248"><a href="#cb15-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-249"><a href="#cb15-249" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> categorize_conversation(<span class="va">self</span>, title: <span class="bu">str</span>, summary: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb15-250"><a href="#cb15-250" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Categoriza√ß√£o otimizada com express√µes regulares&quot;&quot;&quot;</span></span>
<span id="cb15-251"><a href="#cb15-251" aria-hidden="true" tabindex="-1"></a>        text <span class="op">=</span> <span class="ss">f&quot;</span><span class="sc">{</span>title<span class="sc">}</span><span class="ss"> </span><span class="sc">{</span>summary<span class="sc">}</span><span class="ss">&quot;</span>.lower()</span>
<span id="cb15-252"><a href="#cb15-252" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-253"><a href="#cb15-253" aria-hidden="true" tabindex="-1"></a>        patterns <span class="op">=</span> {</span>
<span id="cb15-254"><a href="#cb15-254" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Tecnologia&#39;</span>: <span class="vs">r&#39;</span><span class="dv">\b</span><span class="kw">(</span><span class="vs">tecnologia</span><span class="cf">|</span><span class="vs">hardware</span><span class="cf">|</span><span class="vs">software</span><span class="cf">|</span><span class="vs">rede</span><span class="cf">|</span><span class="vs">internet</span><span class="cf">|</span><span class="vs">wifi</span><span class="cf">|</span><span class="vs">bluetooth</span><span class="cf">|</span><span class="pp">[45]</span><span class="vs">g</span><span class="cf">|</span><span class="vs">cloud</span><span class="cf">|</span><span class="vs">aws</span><span class="cf">|</span><span class="vs">azure</span><span class="cf">|</span><span class="vs">gcp</span><span class="cf">|</span><span class="vs">servidor</span><span class="cf">|</span><span class="vs">hosting</span><span class="cf">|</span><span class="vs">dom√≠nio</span><span class="cf">|</span><span class="vs">ssl</span><span class="cf">|</span><span class="vs">router</span><span class="cf">|</span><span class="vs">switch</span><span class="cf">|</span><span class="vs">firewall</span><span class="cf">|</span><span class="vs">iot</span><span class="cf">|</span><span class="vs">smartphone</span><span class="cf">|</span><span class="vs">tablet</span><span class="cf">|</span><span class="vs">navegador</span><span class="cf">|</span><span class="vs">browser</span><span class="cf">|</span><span class="vs">chrome</span><span class="cf">|</span><span class="vs">firefox</span><span class="cf">|</span><span class="vs">edge</span><span class="cf">|</span><span class="vs">safari</span><span class="cf">|</span><span class="vs">email</span><span class="cf">|</span><span class="vs">gmail</span><span class="cf">|</span><span class="vs">outlook</span><span class="cf">|</span><span class="vs">criptografia</span><span class="cf">|</span><span class="vs">seguran√ßa</span><span class="cf">|</span><span class="vs">ciberseguran√ßa</span><span class="cf">|</span><span class="vs">ransomware</span><span class="cf">|</span><span class="vs">phishing</span><span class="cf">|</span><span class="vs">autentica√ß√£o</span><span class="cf">|</span><span class="vs">2fa</span><span class="cf">|</span><span class="vs">biometria</span><span class="kw">)</span><span class="dv">\b</span><span class="vs">&#39;</span>,</span>
<span id="cb15-255"><a href="#cb15-255" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Sa√∫de&#39;</span>: <span class="vs">r&#39;</span><span class="dv">\b</span><span class="kw">(</span><span class="vs">sa√∫de</span><span class="cf">|</span><span class="vs">medicina</span><span class="cf">|</span><span class="vs">m√©dico</span><span class="cf">|</span><span class="vs">enfermagem</span><span class="cf">|</span><span class="vs">doen√ßa</span><span class="cf">|</span><span class="vs">v√≠rus</span><span class="cf">|</span><span class="vs">bact√©ria</span><span class="cf">|</span><span class="vs">vacina</span><span class="cf">|</span><span class="vs">covid</span><span class="cf">|</span><span class="vs">coronav√≠rus</span><span class="cf">|</span><span class="vs">gripe</span><span class="cf">|</span><span class="vs">febre</span><span class="cf">|</span><span class="vs">dor</span><span class="cf">|</span><span class="vs">an√°lise</span><span class="cf">|</span><span class="vs">exame</span><span class="cf">|</span><span class="vs">raio x</span><span class="cf">|</span><span class="vs">resson√¢ncia</span><span class="cf">|</span><span class="vs">hospital</span><span class="cf">|</span><span class="vs">cl√≠nica</span><span class="cf">|</span><span class="vs">farm√°cia</span><span class="cf">|</span><span class="vs">medicamento</span><span class="cf">|</span><span class="vs">rem√©dio</span><span class="cf">|</span><span class="vs">psicologia</span><span class="cf">|</span><span class="vs">terapia</span><span class="cf">|</span><span class="vs">bem-estar</span><span class="cf">|</span><span class="vs">nutri√ß√£o</span><span class="cf">|</span><span class="vs">dieta</span><span class="cf">|</span><span class="vs">exerc√≠cio</span><span class="cf">|</span><span class="vs">fitness</span><span class="cf">|</span><span class="vs">sono</span><span class="cf">|</span><span class="vs">sa√∫de mental</span><span class="kw">)</span><span class="dv">\b</span><span class="vs">&#39;</span>,</span>
<span id="cb15-256"><a href="#cb15-256" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Programa√ß√£o&#39;</span>: <span class="vs">r&#39;</span><span class="dv">\b</span><span class="kw">(</span><span class="vs">python</span><span class="cf">|</span><span class="vs">javascript</span><span class="cf">|</span><span class="vs">java</span><span class="cf">|</span><span class="vs">c</span><span class="ch">\+\+</span><span class="cf">|</span><span class="vs">c#</span><span class="cf">|</span><span class="vs">go</span><span class="cf">|</span><span class="vs">rust</span><span class="cf">|</span><span class="vs">lua</span><span class="cf">|</span><span class="vs">bash</span><span class="cf">|</span><span class="vs">script</span><span class="cf">|</span><span class="vs">debug</span><span class="cf">|</span><span class="vs">erro</span><span class="cf">|</span><span class="vs">conda</span><span class="cf">|</span><span class="vs">mamba</span><span class="cf">|</span><span class="vs">pandoc</span><span class="cf">|</span><span class="vs">msys2</span><span class="cf">|</span><span class="vs">spyder</span><span class="cf">|</span><span class="vs">jupyter</span><span class="cf">|</span><span class="vs">pip</span><span class="cf">|</span><span class="vs">venv</span><span class="cf">|</span><span class="vs">docker</span><span class="cf">|</span><span class="vs">git</span><span class="cf">|</span><span class="vs">github</span><span class="cf">|</span><span class="vs">vscode</span><span class="cf">|</span><span class="vs">ide</span><span class="cf">|</span><span class="vs">programa</span><span class="cf">|</span><span class="vs">c√≥digo</span><span class="cf">|</span><span class="vs">fun√ß√£o</span><span class="cf">|</span><span class="vs">classe</span><span class="cf">|</span><span class="vs">api</span><span class="cf">|</span><span class="vs">selenium</span><span class="cf">|</span><span class="vs">playwright</span><span class="kw">)</span><span class="dv">\b</span><span class="vs">&#39;</span>,</span>
<span id="cb15-257"><a href="#cb15-257" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Sistemas&#39;</span>: <span class="vs">r&#39;</span><span class="dv">\b</span><span class="kw">(</span><span class="vs">windows</span><span class="cf">|</span><span class="vs">linux</span><span class="cf">|</span><span class="vs">macos</span><span class="cf">|</span><span class="vs">so</span><span class="cf">|</span><span class="vs">sistema operacional</span><span class="cf">|</span><span class="vs">driver</span><span class="cf">|</span><span class="vs">registry</span><span class="cf">|</span><span class="vs">process</span><span class="cf">|</span><span class="vs">firewall</span><span class="cf">|</span><span class="vs">bios</span><span class="cf">|</span><span class="vs">boot</span><span class="cf">|</span><span class="vs">path</span><span class="cf">|</span><span class="vs">dll</span><span class="cf">|</span><span class="vs">exe</span><span class="cf">|</span><span class="vs">powershell</span><span class="cf">|</span><span class="vs">cmd</span><span class="cf">|</span><span class="vs">terminal</span><span class="cf">|</span><span class="vs">shell</span><span class="kw">)</span><span class="dv">\b</span><span class="vs">&#39;</span>,</span>
<span id="cb15-258"><a href="#cb15-258" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;IA&#39;</span>: <span class="vs">r&#39;</span><span class="dv">\b</span><span class="kw">(</span><span class="vs">ia</span><span class="cf">|</span><span class="vs">gpt</span><span class="cf">|</span><span class="vs">chatgpt</span><span class="cf">|</span><span class="vs">grok</span><span class="cf">|</span><span class="vs">qwen</span><span class="cf">|</span><span class="vs">deepseek</span><span class="cf">|</span><span class="vs">llm</span><span class="cf">|</span><span class="vs">modelo</span><span class="cf">|</span><span class="vs">prompt</span><span class="cf">|</span><span class="vs">token</span><span class="cf">|</span><span class="vs">embedding</span><span class="cf">|</span><span class="vs">fine-tune</span><span class="cf">|</span><span class="vs">neural</span><span class="cf">|</span><span class="vs">chatbot</span><span class="cf">|</span><span class="vs">intelig√™ncia artificial</span><span class="kw">)</span><span class="dv">\b</span><span class="vs">&#39;</span>,</span>
<span id="cb15-259"><a href="#cb15-259" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Dados&#39;</span>: <span class="vs">r&#39;</span><span class="dv">\b</span><span class="kw">(</span><span class="vs">dados</span><span class="cf">|</span><span class="vs">data</span><span class="cf">|</span><span class="vs">csv</span><span class="cf">|</span><span class="vs">json</span><span class="cf">|</span><span class="vs">pandas</span><span class="cf">|</span><span class="vs">numpy</span><span class="cf">|</span><span class="vs">excel</span><span class="cf">|</span><span class="vs">sql</span><span class="cf">|</span><span class="vs">banco</span><span class="cf">|</span><span class="vs">sqlite</span><span class="cf">|</span><span class="vs">postgres</span><span class="cf">|</span><span class="vs">visualiza√ß√£o</span><span class="cf">|</span><span class="vs">gr√°fico</span><span class="cf">|</span><span class="vs">tabela</span><span class="cf">|</span><span class="vs">an√°lise</span><span class="cf">|</span><span class="vs">etl</span><span class="cf">|</span><span class="vs">dashboard</span><span class="kw">)</span><span class="dv">\b</span><span class="vs">&#39;</span>,</span>
<span id="cb15-260"><a href="#cb15-260" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Geral&#39;</span>: <span class="vs">r&#39;</span><span class="dv">\b</span><span class="kw">(</span><span class="vs">geral</span><span class="cf">|</span><span class="vs">pergunta</span><span class="cf">|</span><span class="vs">ajuda</span><span class="cf">|</span><span class="vs">como fazer</span><span class="cf">|</span><span class="vs">explicar</span><span class="cf">|</span><span class="vs">resumo</span><span class="cf">|</span><span class="vs">tutorial b√°sico</span><span class="kw">)</span><span class="dv">\b</span><span class="vs">&#39;</span></span>
<span id="cb15-261"><a href="#cb15-261" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb15-262"><a href="#cb15-262" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-263"><a href="#cb15-263" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> category, pattern <span class="kw">in</span> patterns.items():</span>
<span id="cb15-264"><a href="#cb15-264" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> re.search(pattern, text, re.IGNORECASE):</span>
<span id="cb15-265"><a href="#cb15-265" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> category</span>
<span id="cb15-266"><a href="#cb15-266" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb15-267"><a href="#cb15-267" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">&#39;Outros&#39;</span></span>
<span id="cb15-268"><a href="#cb15-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-269"><a href="#cb15-269" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> parse_timestamp_for_sorting(<span class="va">self</span>, timestamp) <span class="op">-&gt;</span> datetime:</span>
<span id="cb15-270"><a href="#cb15-270" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> timestamp:</span>
<span id="cb15-271"><a href="#cb15-271" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> datetime.<span class="bu">min</span></span>
<span id="cb15-272"><a href="#cb15-272" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb15-273"><a href="#cb15-273" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb15-274"><a href="#cb15-274" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">isinstance</span>(timestamp, <span class="bu">str</span>):</span>
<span id="cb15-275"><a href="#cb15-275" aria-hidden="true" tabindex="-1"></a>                clean_ts <span class="op">=</span> timestamp.replace(<span class="st">&#39;T&#39;</span>, <span class="st">&#39; &#39;</span>).split(<span class="st">&#39;.&#39;</span>)[<span class="dv">0</span>].split(<span class="st">&#39;+&#39;</span>)[<span class="dv">0</span>]</span>
<span id="cb15-276"><a href="#cb15-276" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> clean_ts.endswith(<span class="st">&#39;Z&#39;</span>):</span>
<span id="cb15-277"><a href="#cb15-277" aria-hidden="true" tabindex="-1"></a>                    clean_ts <span class="op">=</span> clean_ts[:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb15-278"><a href="#cb15-278" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> datetime.fromisoformat(clean_ts)</span>
<span id="cb15-279"><a href="#cb15-279" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> <span class="bu">isinstance</span>(timestamp, (<span class="bu">int</span>, <span class="bu">float</span>)):</span>
<span id="cb15-280"><a href="#cb15-280" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> datetime.fromtimestamp(timestamp)</span>
<span id="cb15-281"><a href="#cb15-281" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span>:</span>
<span id="cb15-282"><a href="#cb15-282" aria-hidden="true" tabindex="-1"></a>            <span class="cf">pass</span></span>
<span id="cb15-283"><a href="#cb15-283" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb15-284"><a href="#cb15-284" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> datetime.<span class="bu">min</span></span>
<span id="cb15-285"><a href="#cb15-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-286"><a href="#cb15-286" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> format_timestamp(<span class="va">self</span>, timestamp) <span class="op">-&gt;</span> Optional[<span class="bu">str</span>]:</span>
<span id="cb15-287"><a href="#cb15-287" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> timestamp:</span>
<span id="cb15-288"><a href="#cb15-288" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb15-289"><a href="#cb15-289" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb15-290"><a href="#cb15-290" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb15-291"><a href="#cb15-291" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">isinstance</span>(timestamp, (<span class="bu">int</span>, <span class="bu">float</span>)):</span>
<span id="cb15-292"><a href="#cb15-292" aria-hidden="true" tabindex="-1"></a>                dt <span class="op">=</span> datetime.fromtimestamp(timestamp)</span>
<span id="cb15-293"><a href="#cb15-293" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> dt.strftime(<span class="st">&#39;%Y-%m-</span><span class="sc">%d</span><span class="st"> %H:%M:%S&#39;</span>)</span>
<span id="cb15-294"><a href="#cb15-294" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> <span class="bu">isinstance</span>(timestamp, <span class="bu">str</span>):</span>
<span id="cb15-295"><a href="#cb15-295" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="st">&#39;T&#39;</span> <span class="kw">in</span> timestamp:</span>
<span id="cb15-296"><a href="#cb15-296" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">return</span> timestamp.replace(<span class="st">&#39;T&#39;</span>, <span class="st">&#39; &#39;</span>).split(<span class="st">&#39;.&#39;</span>)[<span class="dv">0</span>]</span>
<span id="cb15-297"><a href="#cb15-297" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> timestamp</span>
<span id="cb15-298"><a href="#cb15-298" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span>:</span>
<span id="cb15-299"><a href="#cb15-299" aria-hidden="true" tabindex="-1"></a>            <span class="cf">pass</span></span>
<span id="cb15-300"><a href="#cb15-300" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb15-301"><a href="#cb15-301" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">str</span>(timestamp)</span>
<span id="cb15-302"><a href="#cb15-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-303"><a href="#cb15-303" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_enhanced_markdown_content(<span class="va">self</span>, conversation: Dict[<span class="bu">str</span>, Any]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb15-304"><a href="#cb15-304" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Gera conte√∫do Markdown com preserva√ß√£o total de formata√ß√£o&quot;&quot;&quot;</span></span>
<span id="cb15-305"><a href="#cb15-305" aria-hidden="true" tabindex="-1"></a>        lines <span class="op">=</span> [</span>
<span id="cb15-306"><a href="#cb15-306" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f&quot;# </span><span class="sc">{</span>conversation[<span class="st">&#39;title&#39;</span>]<span class="sc">}</span><span class="ss">&quot;</span>,</span>
<span id="cb15-307"><a href="#cb15-307" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;&quot;</span>,</span>
<span id="cb15-308"><a href="#cb15-308" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;## üìä Informa√ß√µes&quot;</span>,</span>
<span id="cb15-309"><a href="#cb15-309" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f&quot;- **N√∫mero:** #</span><span class="sc">{</span>conversation[<span class="st">&#39;number&#39;</span>]<span class="sc">}</span><span class="ss">&quot;</span>,</span>
<span id="cb15-310"><a href="#cb15-310" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f&quot;- **Origem:** </span><span class="sc">{</span>conversation[<span class="st">&#39;source&#39;</span>]<span class="sc">}</span><span class="ss">&quot;</span>,</span>
<span id="cb15-311"><a href="#cb15-311" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f&quot;- **Categoria:** </span><span class="sc">{</span>conversation[<span class="st">&#39;category&#39;</span>]<span class="sc">}</span><span class="ss">&quot;</span>,</span>
<span id="cb15-312"><a href="#cb15-312" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f&quot;- **ID:** </span><span class="sc">{</span>conversation<span class="sc">.</span>get(<span class="st">&#39;id&#39;</span>, <span class="st">&#39;N/A&#39;</span>)<span class="sc">}</span><span class="ss">&quot;</span>,</span>
<span id="cb15-313"><a href="#cb15-313" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f&quot;- **Criada em:** </span><span class="sc">{</span>conversation<span class="sc">.</span>get(<span class="st">&#39;inserted_at&#39;</span>) <span class="kw">or</span> conversation<span class="sc">.</span>get(<span class="st">&#39;created_at&#39;</span>) <span class="kw">or</span> <span class="st">&#39;N/A&#39;</span><span class="sc">}</span><span class="ss">&quot;</span>,</span>
<span id="cb15-314"><a href="#cb15-314" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb15-315"><a href="#cb15-315" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-316"><a href="#cb15-316" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> conversation.get(<span class="st">&#39;updated_at&#39;</span>):</span>
<span id="cb15-317"><a href="#cb15-317" aria-hidden="true" tabindex="-1"></a>            lines.append(<span class="ss">f&quot;- **Atualizada em:** </span><span class="sc">{</span>conversation[<span class="st">&#39;updated_at&#39;</span>]<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb15-318"><a href="#cb15-318" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb15-319"><a href="#cb15-319" aria-hidden="true" tabindex="-1"></a>        lines.extend([</span>
<span id="cb15-320"><a href="#cb15-320" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f&quot;- **Total de mensagens:** </span><span class="sc">{</span><span class="bu">len</span>(conversation[<span class="st">&#39;messages&#39;</span>])<span class="sc">}</span><span class="ss">&quot;</span>,</span>
<span id="cb15-321"><a href="#cb15-321" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f&quot;- **Resumo:** </span><span class="sc">{</span>conversation<span class="sc">.</span>get(<span class="st">&#39;summary&#39;</span>, <span class="st">&#39;Sem resumo&#39;</span>)<span class="sc">}</span><span class="ss">&quot;</span>,</span>
<span id="cb15-322"><a href="#cb15-322" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;&quot;</span>,</span>
<span id="cb15-323"><a href="#cb15-323" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;---&quot;</span>,</span>
<span id="cb15-324"><a href="#cb15-324" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;&quot;</span>,</span>
<span id="cb15-325"><a href="#cb15-325" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;## üó®Ô∏è Conversa&quot;</span>,</span>
<span id="cb15-326"><a href="#cb15-326" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;&quot;</span></span>
<span id="cb15-327"><a href="#cb15-327" aria-hidden="true" tabindex="-1"></a>        ])</span>
<span id="cb15-328"><a href="#cb15-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-329"><a href="#cb15-329" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, msg <span class="kw">in</span> <span class="bu">enumerate</span>(conversation[<span class="st">&#39;messages&#39;</span>], <span class="dv">1</span>):</span>
<span id="cb15-330"><a href="#cb15-330" aria-hidden="true" tabindex="-1"></a>            timestamp <span class="op">=</span> <span class="ss">f&quot; *(</span><span class="sc">{</span>msg[<span class="st">&#39;timestamp&#39;</span>]<span class="sc">}</span><span class="ss">)*&quot;</span> <span class="cf">if</span> msg[<span class="st">&#39;timestamp&#39;</span>] <span class="cf">else</span> <span class="st">&quot;&quot;</span></span>
<span id="cb15-331"><a href="#cb15-331" aria-hidden="true" tabindex="-1"></a>            model_info <span class="op">=</span> <span class="ss">f&quot; *[</span><span class="sc">{</span>msg<span class="sc">.</span>get(<span class="st">&#39;model&#39;</span>, <span class="st">&#39;&#39;</span>)<span class="sc">}</span><span class="ss">]*&quot;</span> <span class="cf">if</span> msg.get(<span class="st">&#39;model&#39;</span>) <span class="cf">else</span> <span class="st">&quot;&quot;</span></span>
<span id="cb15-332"><a href="#cb15-332" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb15-333"><a href="#cb15-333" aria-hidden="true" tabindex="-1"></a>            <span class="co"># PRESERVA√á√ÉO TOTAL do conte√∫do</span></span>
<span id="cb15-334"><a href="#cb15-334" aria-hidden="true" tabindex="-1"></a>            preserved_content <span class="op">=</span> <span class="va">self</span>.preserve_special_content(msg[<span class="st">&#39;content&#39;</span>])</span>
<span id="cb15-335"><a href="#cb15-335" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb15-336"><a href="#cb15-336" aria-hidden="true" tabindex="-1"></a>            lines.extend([</span>
<span id="cb15-337"><a href="#cb15-337" aria-hidden="true" tabindex="-1"></a>                <span class="ss">f&quot;### </span><span class="sc">{</span>msg[<span class="st">&#39;author&#39;</span>]<span class="sc">}{</span>timestamp<span class="sc">}{</span>model_info<span class="sc">}</span><span class="ss">&quot;</span>,</span>
<span id="cb15-338"><a href="#cb15-338" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;&quot;</span>,</span>
<span id="cb15-339"><a href="#cb15-339" aria-hidden="true" tabindex="-1"></a>                <span class="ss">f&quot;</span><span class="sc">{</span>preserved_content<span class="sc">}</span><span class="ss">&quot;</span>,</span>
<span id="cb15-340"><a href="#cb15-340" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;&quot;</span></span>
<span id="cb15-341"><a href="#cb15-341" aria-hidden="true" tabindex="-1"></a>            ])</span>
<span id="cb15-342"><a href="#cb15-342" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb15-343"><a href="#cb15-343" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> j <span class="op">&lt;</span> <span class="bu">len</span>(conversation[<span class="st">&#39;messages&#39;</span>]):</span>
<span id="cb15-344"><a href="#cb15-344" aria-hidden="true" tabindex="-1"></a>                lines.extend([<span class="st">&quot;---&quot;</span>, <span class="st">&quot;&quot;</span>])</span>
<span id="cb15-345"><a href="#cb15-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-346"><a href="#cb15-346" aria-hidden="true" tabindex="-1"></a>        lines.extend([</span>
<span id="cb15-347"><a href="#cb15-347" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;---&quot;</span>,</span>
<span id="cb15-348"><a href="#cb15-348" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;&quot;</span>,</span>
<span id="cb15-349"><a href="#cb15-349" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f&quot;*Conversa exportada do </span><span class="sc">{</span>conversation[<span class="st">&#39;source&#39;</span>]<span class="sc">}</span><span class="ss">*&quot;</span>,</span>
<span id="cb15-350"><a href="#cb15-350" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f&quot;*Processado em: </span><span class="sc">{</span>datetime<span class="sc">.</span>now()<span class="sc">.</span>strftime(<span class="st">&#39;</span><span class="sc">%d</span><span class="st">/%m/%Y %H:%M&#39;</span>)<span class="sc">}</span><span class="ss">*&quot;</span></span>
<span id="cb15-351"><a href="#cb15-351" aria-hidden="true" tabindex="-1"></a>        ])</span>
<span id="cb15-352"><a href="#cb15-352" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-353"><a href="#cb15-353" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>.join(lines)</span>
<span id="cb15-354"><a href="#cb15-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-355"><a href="#cb15-355" aria-hidden="true" tabindex="-1"></a>    <span class="co"># M√âTODOS DE PROCESSAMENTO (mantidos do original)</span></span>
<span id="cb15-356"><a href="#cb15-356" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> process_qwen_enhanced(<span class="va">self</span>, path: Path):</span>
<span id="cb15-357"><a href="#cb15-357" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Processa Qwen3 com preserva√ß√£o total de conte√∫do&quot;&quot;&quot;</span></span>
<span id="cb15-358"><a href="#cb15-358" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb15-359"><a href="#cb15-359" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;üß™ [DRY-RUN] Processaria Qwen3: </span><span class="sc">{</span>path<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb15-360"><a href="#cb15-360" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb15-361"><a href="#cb15-361" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb15-362"><a href="#cb15-362" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb15-363"><a href="#cb15-363" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(path, <span class="st">&#39;r&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb15-364"><a href="#cb15-364" aria-hidden="true" tabindex="-1"></a>                raw <span class="op">=</span> json.load(f)</span>
<span id="cb15-365"><a href="#cb15-365" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb15-366"><a href="#cb15-366" aria-hidden="true" tabindex="-1"></a>            data <span class="op">=</span> raw.get(<span class="st">&#39;data&#39;</span>, [])</span>
<span id="cb15-367"><a href="#cb15-367" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(data, <span class="bu">list</span>):</span>
<span id="cb15-368"><a href="#cb15-368" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;‚ö†Ô∏è  Qwen3: &#39;data&#39; n√£o √© uma lista.&quot;</span>)</span>
<span id="cb15-369"><a href="#cb15-369" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span></span>
<span id="cb15-370"><a href="#cb15-370" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb15-371"><a href="#cb15-371" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;üîç Qwen3: encontradas </span><span class="sc">{</span><span class="bu">len</span>(data)<span class="sc">}</span><span class="ss"> conversas.&quot;</span>)</span>
<span id="cb15-372"><a href="#cb15-372" aria-hidden="true" tabindex="-1"></a>            processed_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb15-373"><a href="#cb15-373" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb15-374"><a href="#cb15-374" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> i, conv <span class="kw">in</span> <span class="bu">enumerate</span>(data):</span>
<span id="cb15-375"><a href="#cb15-375" aria-hidden="true" tabindex="-1"></a>                title <span class="op">=</span> conv.get(<span class="st">&#39;title&#39;</span>, <span class="ss">f&#39;Conversa_Qwen_</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb15-376"><a href="#cb15-376" aria-hidden="true" tabindex="-1"></a>                title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(title)</span>
<span id="cb15-377"><a href="#cb15-377" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb15-378"><a href="#cb15-378" aria-hidden="true" tabindex="-1"></a>                history <span class="op">=</span> conv.get(<span class="st">&#39;chat&#39;</span>, {}).get(<span class="st">&#39;history&#39;</span>, {})</span>
<span id="cb15-379"><a href="#cb15-379" aria-hidden="true" tabindex="-1"></a>                messages <span class="op">=</span> []</span>
<span id="cb15-380"><a href="#cb15-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-381"><a href="#cb15-381" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="kw">not</span> history:</span>
<span id="cb15-382"><a href="#cb15-382" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">continue</span></span>
<span id="cb15-383"><a href="#cb15-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-384"><a href="#cb15-384" aria-hidden="true" tabindex="-1"></a>                messages_dict <span class="op">=</span> history.get(<span class="st">&#39;messages&#39;</span>, {})</span>
<span id="cb15-385"><a href="#cb15-385" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb15-386"><a href="#cb15-386" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(messages_dict, <span class="bu">dict</span>):</span>
<span id="cb15-387"><a href="#cb15-387" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">continue</span></span>
<span id="cb15-388"><a href="#cb15-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-389"><a href="#cb15-389" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;   üìù Conversa </span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">: &#39;</span><span class="sc">{</span>title<span class="sc">}</span><span class="ss">&#39; - </span><span class="sc">{</span><span class="bu">len</span>(messages_dict)<span class="sc">}</span><span class="ss"> mensagens&quot;</span>)</span>
<span id="cb15-390"><a href="#cb15-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-391"><a href="#cb15-391" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> message_id, message_data <span class="kw">in</span> messages_dict.items():</span>
<span id="cb15-392"><a href="#cb15-392" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(message_data, <span class="bu">dict</span>):</span>
<span id="cb15-393"><a href="#cb15-393" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb15-394"><a href="#cb15-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-395"><a href="#cb15-395" aria-hidden="true" tabindex="-1"></a>                    role <span class="op">=</span> message_data.get(<span class="st">&#39;role&#39;</span>, <span class="st">&#39;&#39;</span>)</span>
<span id="cb15-396"><a href="#cb15-396" aria-hidden="true" tabindex="-1"></a>                    content <span class="op">=</span> message_data.get(<span class="st">&#39;content&#39;</span>, <span class="st">&#39;&#39;</span>)</span>
<span id="cb15-397"><a href="#cb15-397" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb15-398"><a href="#cb15-398" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="kw">not</span> content <span class="kw">or</span> <span class="kw">not</span> role:</span>
<span id="cb15-399"><a href="#cb15-399" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb15-400"><a href="#cb15-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-401"><a href="#cb15-401" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> role <span class="op">==</span> <span class="st">&#39;user&#39;</span>:</span>
<span id="cb15-402"><a href="#cb15-402" aria-hidden="true" tabindex="-1"></a>                        author <span class="op">=</span> <span class="st">&quot;üë§ Utilizador&quot;</span></span>
<span id="cb15-403"><a href="#cb15-403" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">elif</span> role <span class="op">==</span> <span class="st">&#39;assistant&#39;</span>:</span>
<span id="cb15-404"><a href="#cb15-404" aria-hidden="true" tabindex="-1"></a>                        author <span class="op">=</span> <span class="st">&quot;ü§ñ Qwen3&quot;</span></span>
<span id="cb15-405"><a href="#cb15-405" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">else</span>:</span>
<span id="cb15-406"><a href="#cb15-406" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb15-407"><a href="#cb15-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-408"><a href="#cb15-408" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="bu">isinstance</span>(content, <span class="bu">list</span>):</span>
<span id="cb15-409"><a href="#cb15-409" aria-hidden="true" tabindex="-1"></a>                        text_parts <span class="op">=</span> []</span>
<span id="cb15-410"><a href="#cb15-410" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">for</span> block <span class="kw">in</span> content:</span>
<span id="cb15-411"><a href="#cb15-411" aria-hidden="true" tabindex="-1"></a>                            <span class="cf">if</span> <span class="bu">isinstance</span>(block, <span class="bu">dict</span>):</span>
<span id="cb15-412"><a href="#cb15-412" aria-hidden="true" tabindex="-1"></a>                                <span class="cf">if</span> block.get(<span class="st">&#39;type&#39;</span>) <span class="op">==</span> <span class="st">&#39;text&#39;</span>:</span>
<span id="cb15-413"><a href="#cb15-413" aria-hidden="true" tabindex="-1"></a>                                    text_parts.append(block.get(<span class="st">&#39;text&#39;</span>, <span class="st">&#39;&#39;</span>))</span>
<span id="cb15-414"><a href="#cb15-414" aria-hidden="true" tabindex="-1"></a>                                <span class="cf">elif</span> block.get(<span class="st">&#39;type&#39;</span>) <span class="op">==</span> <span class="st">&#39;image&#39;</span>:</span>
<span id="cb15-415"><a href="#cb15-415" aria-hidden="true" tabindex="-1"></a>                                    image_info <span class="op">=</span> block.get(<span class="st">&#39;image&#39;</span>, <span class="st">&#39;&#39;</span>)</span>
<span id="cb15-416"><a href="#cb15-416" aria-hidden="true" tabindex="-1"></a>                                    <span class="cf">if</span> image_info:</span>
<span id="cb15-417"><a href="#cb15-417" aria-hidden="true" tabindex="-1"></a>                                        text_parts.append(<span class="ss">f&quot;![Imagem](</span><span class="sc">{</span>image_info<span class="sc">}</span><span class="ss">)&quot;</span>)</span>
<span id="cb15-418"><a href="#cb15-418" aria-hidden="true" tabindex="-1"></a>                            <span class="cf">elif</span> <span class="bu">isinstance</span>(block, <span class="bu">str</span>):</span>
<span id="cb15-419"><a href="#cb15-419" aria-hidden="true" tabindex="-1"></a>                                text_parts.append(block)</span>
<span id="cb15-420"><a href="#cb15-420" aria-hidden="true" tabindex="-1"></a>                        final_content <span class="op">=</span> <span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>.join(text_parts).strip()</span>
<span id="cb15-421"><a href="#cb15-421" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">else</span>:</span>
<span id="cb15-422"><a href="#cb15-422" aria-hidden="true" tabindex="-1"></a>                        final_content <span class="op">=</span> <span class="bu">str</span>(content).strip()</span>
<span id="cb15-423"><a href="#cb15-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-424"><a href="#cb15-424" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># APLICA PRESERVA√á√ÉO</span></span>
<span id="cb15-425"><a href="#cb15-425" aria-hidden="true" tabindex="-1"></a>                    final_content <span class="op">=</span> <span class="va">self</span>.preserve_special_content(final_content)</span>
<span id="cb15-426"><a href="#cb15-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-427"><a href="#cb15-427" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="kw">not</span> final_content <span class="kw">or</span> final_content <span class="op">==</span> <span class="st">&#39;null&#39;</span>:</span>
<span id="cb15-428"><a href="#cb15-428" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb15-429"><a href="#cb15-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-430"><a href="#cb15-430" aria-hidden="true" tabindex="-1"></a>                    messages.append({</span>
<span id="cb15-431"><a href="#cb15-431" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;author&#39;</span>: author,</span>
<span id="cb15-432"><a href="#cb15-432" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;role&#39;</span>: role,</span>
<span id="cb15-433"><a href="#cb15-433" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;content&#39;</span>: final_content,</span>
<span id="cb15-434"><a href="#cb15-434" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;timestamp&#39;</span>: <span class="va">self</span>.format_timestamp(message_data.get(<span class="st">&#39;created_at&#39;</span>)),</span>
<span id="cb15-435"><a href="#cb15-435" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;model&#39;</span>: message_data.get(<span class="st">&#39;model&#39;</span>, <span class="st">&#39;Qwen3&#39;</span>)</span>
<span id="cb15-436"><a href="#cb15-436" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb15-437"><a href="#cb15-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-438"><a href="#cb15-438" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> messages:</span>
<span id="cb15-439"><a href="#cb15-439" aria-hidden="true" tabindex="-1"></a>                    messages.sort(key<span class="op">=</span><span class="kw">lambda</span> x: <span class="va">self</span>.parse_timestamp_for_sorting(x[<span class="st">&#39;timestamp&#39;</span>]))</span>
<span id="cb15-440"><a href="#cb15-440" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb15-441"><a href="#cb15-441" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.all_conversations.append({</span>
<span id="cb15-442"><a href="#cb15-442" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;title&#39;</span>: title,</span>
<span id="cb15-443"><a href="#cb15-443" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;source&#39;</span>: <span class="st">&#39;Qwen3&#39;</span>,</span>
<span id="cb15-444"><a href="#cb15-444" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;id&#39;</span>: conv.get(<span class="st">&#39;id&#39;</span>, <span class="ss">f&#39;qwen_</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">&#39;</span>),</span>
<span id="cb15-445"><a href="#cb15-445" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;inserted_at&#39;</span>: <span class="va">self</span>.format_timestamp(conv.get(<span class="st">&#39;created_at&#39;</span>)),</span>
<span id="cb15-446"><a href="#cb15-446" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;updated_at&#39;</span>: <span class="va">self</span>.format_timestamp(conv.get(<span class="st">&#39;updated_at&#39;</span>)),</span>
<span id="cb15-447"><a href="#cb15-447" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;messages&#39;</span>: messages,</span>
<span id="cb15-448"><a href="#cb15-448" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;summary&#39;</span>: messages[<span class="dv">0</span>][<span class="st">&#39;content&#39;</span>][:<span class="dv">100</span>] <span class="op">+</span> <span class="st">&quot;...&quot;</span> <span class="cf">if</span> messages <span class="cf">else</span> <span class="st">&quot;Sem conte√∫do&quot;</span>,</span>
<span id="cb15-449"><a href="#cb15-449" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;category&#39;</span>: <span class="st">&#39;Geral&#39;</span></span>
<span id="cb15-450"><a href="#cb15-450" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb15-451"><a href="#cb15-451" aria-hidden="true" tabindex="-1"></a>                    processed_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb15-452"><a href="#cb15-452" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="ss">f&quot;   ‚úÖ Adicionada: </span><span class="sc">{</span><span class="bu">len</span>(messages)<span class="sc">}</span><span class="ss"> mensagens&quot;</span>)</span>
<span id="cb15-453"><a href="#cb15-453" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb15-454"><a href="#cb15-454" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ Qwen3: </span><span class="sc">{</span>processed_count<span class="sc">}</span><span class="ss"> conversas processadas.&quot;</span>)</span>
<span id="cb15-455"><a href="#cb15-455" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb15-456"><a href="#cb15-456" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb15-457"><a href="#cb15-457" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚ùå Erro ao processar Qwen3: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb15-458"><a href="#cb15-458" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb15-459"><a href="#cb15-459" aria-hidden="true" tabindex="-1"></a>                traceback.print_exc()</span>
<span id="cb15-460"><a href="#cb15-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-461"><a href="#cb15-461" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> process_chatgpt(<span class="va">self</span>, path: Path):</span>
<span id="cb15-462"><a href="#cb15-462" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Processa exporta√ß√£o do ChatGPT&quot;&quot;&quot;</span></span>
<span id="cb15-463"><a href="#cb15-463" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb15-464"><a href="#cb15-464" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;üß™ [DRY-RUN] Processaria ChatGPT: </span><span class="sc">{</span>path<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb15-465"><a href="#cb15-465" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb15-466"><a href="#cb15-466" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb15-467"><a href="#cb15-467" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb15-468"><a href="#cb15-468" aria-hidden="true" tabindex="-1"></a>            temp_dir <span class="op">=</span> tempfile.mkdtemp(prefix<span class="op">=</span><span class="st">&quot;chatgpt_&quot;</span>)</span>
<span id="cb15-469"><a href="#cb15-469" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> zipfile.ZipFile(path, <span class="st">&#39;r&#39;</span>) <span class="im">as</span> z:</span>
<span id="cb15-470"><a href="#cb15-470" aria-hidden="true" tabindex="-1"></a>                z.extractall(temp_dir)</span>
<span id="cb15-471"><a href="#cb15-471" aria-hidden="true" tabindex="-1"></a>            convs_path <span class="op">=</span> Path(temp_dir) <span class="op">/</span> <span class="st">&quot;conversations.json&quot;</span></span>
<span id="cb15-472"><a href="#cb15-472" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> convs_path.exists():</span>
<span id="cb15-473"><a href="#cb15-473" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;‚ùå ChatGPT: conversations.json n√£o encontrado.&quot;</span>)</span>
<span id="cb15-474"><a href="#cb15-474" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span></span>
<span id="cb15-475"><a href="#cb15-475" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb15-476"><a href="#cb15-476" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(convs_path, <span class="st">&#39;r&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb15-477"><a href="#cb15-477" aria-hidden="true" tabindex="-1"></a>                data <span class="op">=</span> json.load(f)</span>
<span id="cb15-478"><a href="#cb15-478" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb15-479"><a href="#cb15-479" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(data, <span class="bu">list</span>):</span>
<span id="cb15-480"><a href="#cb15-480" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;‚ö†Ô∏è  ChatGPT: estrutura inesperada.&quot;</span>)</span>
<span id="cb15-481"><a href="#cb15-481" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span></span>
<span id="cb15-482"><a href="#cb15-482" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb15-483"><a href="#cb15-483" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;üîç ChatGPT: encontradas </span><span class="sc">{</span><span class="bu">len</span>(data)<span class="sc">}</span><span class="ss"> conversas.&quot;</span>)</span>
<span id="cb15-484"><a href="#cb15-484" aria-hidden="true" tabindex="-1"></a>            processed_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb15-485"><a href="#cb15-485" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb15-486"><a href="#cb15-486" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> i, conv <span class="kw">in</span> <span class="bu">enumerate</span>(data):</span>
<span id="cb15-487"><a href="#cb15-487" aria-hidden="true" tabindex="-1"></a>                title <span class="op">=</span> conv.get(<span class="st">&#39;title&#39;</span>, <span class="ss">f&#39;Conversa_ChatGPT_</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb15-488"><a href="#cb15-488" aria-hidden="true" tabindex="-1"></a>                title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(title)</span>
<span id="cb15-489"><a href="#cb15-489" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb15-490"><a href="#cb15-490" aria-hidden="true" tabindex="-1"></a>                messages <span class="op">=</span> []</span>
<span id="cb15-491"><a href="#cb15-491" aria-hidden="true" tabindex="-1"></a>                mapping <span class="op">=</span> conv.get(<span class="st">&#39;mapping&#39;</span>, {})</span>
<span id="cb15-492"><a href="#cb15-492" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb15-493"><a href="#cb15-493" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> msg_id, node <span class="kw">in</span> mapping.items():</span>
<span id="cb15-494"><a href="#cb15-494" aria-hidden="true" tabindex="-1"></a>                    msg_data <span class="op">=</span> node.get(<span class="st">&#39;message&#39;</span>)</span>
<span id="cb15-495"><a href="#cb15-495" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="kw">not</span> msg_data <span class="kw">or</span> <span class="kw">not</span> <span class="bu">isinstance</span>(msg_data, <span class="bu">dict</span>):</span>
<span id="cb15-496"><a href="#cb15-496" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb15-497"><a href="#cb15-497" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb15-498"><a href="#cb15-498" aria-hidden="true" tabindex="-1"></a>                    author_role <span class="op">=</span> msg_data.get(<span class="st">&#39;author&#39;</span>, {}).get(<span class="st">&#39;role&#39;</span>, <span class="st">&#39;&#39;</span>)</span>
<span id="cb15-499"><a href="#cb15-499" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> author_role <span class="op">==</span> <span class="st">&#39;user&#39;</span>:</span>
<span id="cb15-500"><a href="#cb15-500" aria-hidden="true" tabindex="-1"></a>                        author <span class="op">=</span> <span class="st">&quot;üë§ Utilizador&quot;</span></span>
<span id="cb15-501"><a href="#cb15-501" aria-hidden="true" tabindex="-1"></a>                        role <span class="op">=</span> <span class="st">&#39;user&#39;</span></span>
<span id="cb15-502"><a href="#cb15-502" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">elif</span> author_role <span class="op">==</span> <span class="st">&#39;assistant&#39;</span>:</span>
<span id="cb15-503"><a href="#cb15-503" aria-hidden="true" tabindex="-1"></a>                        author <span class="op">=</span> <span class="st">&quot;ü§ñ ChatGPT&quot;</span></span>
<span id="cb15-504"><a href="#cb15-504" aria-hidden="true" tabindex="-1"></a>                        role <span class="op">=</span> <span class="st">&#39;assistant&#39;</span></span>
<span id="cb15-505"><a href="#cb15-505" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">else</span>:</span>
<span id="cb15-506"><a href="#cb15-506" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb15-507"><a href="#cb15-507" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb15-508"><a href="#cb15-508" aria-hidden="true" tabindex="-1"></a>                    content_parts <span class="op">=</span> []</span>
<span id="cb15-509"><a href="#cb15-509" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">for</span> part <span class="kw">in</span> msg_data.get(<span class="st">&#39;content&#39;</span>, {}).get(<span class="st">&#39;parts&#39;</span>, []):</span>
<span id="cb15-510"><a href="#cb15-510" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">if</span> <span class="bu">isinstance</span>(part, <span class="bu">str</span>):</span>
<span id="cb15-511"><a href="#cb15-511" aria-hidden="true" tabindex="-1"></a>                            content_parts.append(part)</span>
<span id="cb15-512"><a href="#cb15-512" aria-hidden="true" tabindex="-1"></a>                    content <span class="op">=</span> <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>.join(content_parts).strip()</span>
<span id="cb15-513"><a href="#cb15-513" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb15-514"><a href="#cb15-514" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># APLICA PRESERVA√á√ÉO</span></span>
<span id="cb15-515"><a href="#cb15-515" aria-hidden="true" tabindex="-1"></a>                    content <span class="op">=</span> <span class="va">self</span>.preserve_special_content(content)</span>
<span id="cb15-516"><a href="#cb15-516" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb15-517"><a href="#cb15-517" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="kw">not</span> content:</span>
<span id="cb15-518"><a href="#cb15-518" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb15-519"><a href="#cb15-519" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb15-520"><a href="#cb15-520" aria-hidden="true" tabindex="-1"></a>                    messages.append({</span>
<span id="cb15-521"><a href="#cb15-521" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;author&#39;</span>: author,</span>
<span id="cb15-522"><a href="#cb15-522" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;role&#39;</span>: role,</span>
<span id="cb15-523"><a href="#cb15-523" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;content&#39;</span>: content,</span>
<span id="cb15-524"><a href="#cb15-524" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;timestamp&#39;</span>: <span class="va">self</span>.format_timestamp(msg_data.get(<span class="st">&#39;create_time&#39;</span>)),</span>
<span id="cb15-525"><a href="#cb15-525" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;model&#39;</span>: msg_data.get(<span class="st">&#39;model&#39;</span>, <span class="st">&#39;ChatGPT&#39;</span>)</span>
<span id="cb15-526"><a href="#cb15-526" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb15-527"><a href="#cb15-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-528"><a href="#cb15-528" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> messages:</span>
<span id="cb15-529"><a href="#cb15-529" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.all_conversations.append({</span>
<span id="cb15-530"><a href="#cb15-530" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;title&#39;</span>: title,</span>
<span id="cb15-531"><a href="#cb15-531" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;source&#39;</span>: <span class="st">&#39;ChatGPT&#39;</span>,</span>
<span id="cb15-532"><a href="#cb15-532" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;id&#39;</span>: conv.get(<span class="st">&#39;id&#39;</span>, <span class="ss">f&#39;chatgpt_</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">&#39;</span>),</span>
<span id="cb15-533"><a href="#cb15-533" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;inserted_at&#39;</span>: <span class="va">self</span>.format_timestamp(conv.get(<span class="st">&#39;create_time&#39;</span>)),</span>
<span id="cb15-534"><a href="#cb15-534" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;updated_at&#39;</span>: <span class="va">self</span>.format_timestamp(conv.get(<span class="st">&#39;update_time&#39;</span>)),</span>
<span id="cb15-535"><a href="#cb15-535" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;messages&#39;</span>: messages,</span>
<span id="cb15-536"><a href="#cb15-536" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;summary&#39;</span>: messages[<span class="dv">0</span>][<span class="st">&#39;content&#39;</span>][:<span class="dv">100</span>] <span class="op">+</span> <span class="st">&quot;...&quot;</span> <span class="cf">if</span> messages <span class="cf">else</span> <span class="st">&quot;Sem conte√∫do&quot;</span>,</span>
<span id="cb15-537"><a href="#cb15-537" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;category&#39;</span>: <span class="st">&#39;Geral&#39;</span></span>
<span id="cb15-538"><a href="#cb15-538" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb15-539"><a href="#cb15-539" aria-hidden="true" tabindex="-1"></a>                    processed_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb15-540"><a href="#cb15-540" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb15-541"><a href="#cb15-541" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ ChatGPT: </span><span class="sc">{</span>processed_count<span class="sc">}</span><span class="ss"> conversas processadas.&quot;</span>)</span>
<span id="cb15-542"><a href="#cb15-542" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb15-543"><a href="#cb15-543" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb15-544"><a href="#cb15-544" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚ùå Erro ao processar ChatGPT: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb15-545"><a href="#cb15-545" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb15-546"><a href="#cb15-546" aria-hidden="true" tabindex="-1"></a>                traceback.print_exc()</span>
<span id="cb15-547"><a href="#cb15-547" aria-hidden="true" tabindex="-1"></a>        <span class="cf">finally</span>:</span>
<span id="cb15-548"><a href="#cb15-548" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="st">&#39;temp_dir&#39;</span> <span class="kw">in</span> <span class="bu">locals</span>():</span>
<span id="cb15-549"><a href="#cb15-549" aria-hidden="true" tabindex="-1"></a>                shutil.rmtree(temp_dir, ignore_errors<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb15-550"><a href="#cb15-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-551"><a href="#cb15-551" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> process_deepseek(<span class="va">self</span>, path: Path):</span>
<span id="cb15-552"><a href="#cb15-552" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Processa exporta√ß√£o do DeepSeek&quot;&quot;&quot;</span></span>
<span id="cb15-553"><a href="#cb15-553" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb15-554"><a href="#cb15-554" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;üß™ [DRY-RUN] Processaria DeepSeek: </span><span class="sc">{</span>path<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb15-555"><a href="#cb15-555" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb15-556"><a href="#cb15-556" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb15-557"><a href="#cb15-557" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb15-558"><a href="#cb15-558" aria-hidden="true" tabindex="-1"></a>            temp_dir <span class="op">=</span> tempfile.mkdtemp(prefix<span class="op">=</span><span class="st">&quot;deepseek_&quot;</span>)</span>
<span id="cb15-559"><a href="#cb15-559" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> zipfile.ZipFile(path, <span class="st">&#39;r&#39;</span>) <span class="im">as</span> z:</span>
<span id="cb15-560"><a href="#cb15-560" aria-hidden="true" tabindex="-1"></a>                z.extractall(temp_dir)</span>
<span id="cb15-561"><a href="#cb15-561" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb15-562"><a href="#cb15-562" aria-hidden="true" tabindex="-1"></a>            convs_path <span class="op">=</span> Path(temp_dir) <span class="op">/</span> <span class="st">&quot;conversations.json&quot;</span></span>
<span id="cb15-563"><a href="#cb15-563" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> convs_path.exists():</span>
<span id="cb15-564"><a href="#cb15-564" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;‚ùå DeepSeek: conversations.json n√£o encontrado.&quot;</span>)</span>
<span id="cb15-565"><a href="#cb15-565" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span></span>
<span id="cb15-566"><a href="#cb15-566" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb15-567"><a href="#cb15-567" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(convs_path, <span class="st">&#39;r&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb15-568"><a href="#cb15-568" aria-hidden="true" tabindex="-1"></a>                raw_data <span class="op">=</span> json.load(f)</span>
<span id="cb15-569"><a href="#cb15-569" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb15-570"><a href="#cb15-570" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">isinstance</span>(raw_data, <span class="bu">list</span>):</span>
<span id="cb15-571"><a href="#cb15-571" aria-hidden="true" tabindex="-1"></a>                data <span class="op">=</span> raw_data</span>
<span id="cb15-572"><a href="#cb15-572" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> <span class="bu">isinstance</span>(raw_data, <span class="bu">dict</span>) <span class="kw">and</span> <span class="st">&#39;data&#39;</span> <span class="kw">in</span> raw_data:</span>
<span id="cb15-573"><a href="#cb15-573" aria-hidden="true" tabindex="-1"></a>                data <span class="op">=</span> raw_data[<span class="st">&#39;data&#39;</span>]</span>
<span id="cb15-574"><a href="#cb15-574" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb15-575"><a href="#cb15-575" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;‚ö†Ô∏è  DeepSeek: estrutura inesperada.&quot;</span>)</span>
<span id="cb15-576"><a href="#cb15-576" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span></span>
<span id="cb15-577"><a href="#cb15-577" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb15-578"><a href="#cb15-578" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(data, <span class="bu">list</span>):</span>
<span id="cb15-579"><a href="#cb15-579" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;‚ö†Ô∏è  DeepSeek: &#39;data&#39; n√£o √© uma lista.&quot;</span>)</span>
<span id="cb15-580"><a href="#cb15-580" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span></span>
<span id="cb15-581"><a href="#cb15-581" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb15-582"><a href="#cb15-582" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;üîç DeepSeek: encontradas </span><span class="sc">{</span><span class="bu">len</span>(data)<span class="sc">}</span><span class="ss"> conversas.&quot;</span>)</span>
<span id="cb15-583"><a href="#cb15-583" aria-hidden="true" tabindex="-1"></a>            processed_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb15-584"><a href="#cb15-584" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb15-585"><a href="#cb15-585" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> i, conv <span class="kw">in</span> <span class="bu">enumerate</span>(data):</span>
<span id="cb15-586"><a href="#cb15-586" aria-hidden="true" tabindex="-1"></a>                title <span class="op">=</span> conv.get(<span class="st">&#39;title&#39;</span>, <span class="ss">f&#39;Conversa_DeepSeek_</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb15-587"><a href="#cb15-587" aria-hidden="true" tabindex="-1"></a>                title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(title)</span>
<span id="cb15-588"><a href="#cb15-588" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb15-589"><a href="#cb15-589" aria-hidden="true" tabindex="-1"></a>                messages <span class="op">=</span> []</span>
<span id="cb15-590"><a href="#cb15-590" aria-hidden="true" tabindex="-1"></a>                mapping <span class="op">=</span> conv.get(<span class="st">&#39;mapping&#39;</span>, {})</span>
<span id="cb15-591"><a href="#cb15-591" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb15-592"><a href="#cb15-592" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> node_id, node <span class="kw">in</span> mapping.items():</span>
<span id="cb15-593"><a href="#cb15-593" aria-hidden="true" tabindex="-1"></a>                    msg_data <span class="op">=</span> node.get(<span class="st">&#39;message&#39;</span>)</span>
<span id="cb15-594"><a href="#cb15-594" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="kw">not</span> msg_data <span class="kw">or</span> <span class="kw">not</span> <span class="bu">isinstance</span>(msg_data, <span class="bu">dict</span>):</span>
<span id="cb15-595"><a href="#cb15-595" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb15-596"><a href="#cb15-596" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb15-597"><a href="#cb15-597" aria-hidden="true" tabindex="-1"></a>                    fragments <span class="op">=</span> msg_data.get(<span class="st">&#39;fragments&#39;</span>, [])</span>
<span id="cb15-598"><a href="#cb15-598" aria-hidden="true" tabindex="-1"></a>                    content_parts <span class="op">=</span> []</span>
<span id="cb15-599"><a href="#cb15-599" aria-hidden="true" tabindex="-1"></a>                    msg_type <span class="op">=</span> <span class="va">None</span></span>
<span id="cb15-600"><a href="#cb15-600" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb15-601"><a href="#cb15-601" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">for</span> frag <span class="kw">in</span> fragments:</span>
<span id="cb15-602"><a href="#cb15-602" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">if</span> <span class="bu">isinstance</span>(frag, <span class="bu">dict</span>):</span>
<span id="cb15-603"><a href="#cb15-603" aria-hidden="true" tabindex="-1"></a>                            frag_type <span class="op">=</span> frag.get(<span class="st">&#39;type&#39;</span>, <span class="st">&#39;&#39;</span>).upper()</span>
<span id="cb15-604"><a href="#cb15-604" aria-hidden="true" tabindex="-1"></a>                            <span class="cf">if</span> frag_type <span class="kw">in</span> (<span class="st">&#39;REQUEST&#39;</span>, <span class="st">&#39;RESPONSE&#39;</span>):</span>
<span id="cb15-605"><a href="#cb15-605" aria-hidden="true" tabindex="-1"></a>                                msg_type <span class="op">=</span> frag_type</span>
<span id="cb15-606"><a href="#cb15-606" aria-hidden="true" tabindex="-1"></a>                            text <span class="op">=</span> frag.get(<span class="st">&#39;text&#39;</span>, <span class="st">&#39;&#39;</span>)</span>
<span id="cb15-607"><a href="#cb15-607" aria-hidden="true" tabindex="-1"></a>                            <span class="cf">if</span> text:</span>
<span id="cb15-608"><a href="#cb15-608" aria-hidden="true" tabindex="-1"></a>                                content_parts.append(text)</span>
<span id="cb15-609"><a href="#cb15-609" aria-hidden="true" tabindex="-1"></a>                            content <span class="op">=</span> frag.get(<span class="st">&#39;content&#39;</span>, <span class="st">&#39;&#39;</span>)</span>
<span id="cb15-610"><a href="#cb15-610" aria-hidden="true" tabindex="-1"></a>                            <span class="cf">if</span> content:</span>
<span id="cb15-611"><a href="#cb15-611" aria-hidden="true" tabindex="-1"></a>                                <span class="cf">if</span> <span class="bu">isinstance</span>(content, <span class="bu">list</span>):</span>
<span id="cb15-612"><a href="#cb15-612" aria-hidden="true" tabindex="-1"></a>                                    <span class="cf">for</span> item <span class="kw">in</span> content:</span>
<span id="cb15-613"><a href="#cb15-613" aria-hidden="true" tabindex="-1"></a>                                        <span class="cf">if</span> <span class="bu">isinstance</span>(item, <span class="bu">str</span>):</span>
<span id="cb15-614"><a href="#cb15-614" aria-hidden="true" tabindex="-1"></a>                                            content_parts.append(item)</span>
<span id="cb15-615"><a href="#cb15-615" aria-hidden="true" tabindex="-1"></a>                                        <span class="cf">elif</span> <span class="bu">isinstance</span>(item, <span class="bu">dict</span>):</span>
<span id="cb15-616"><a href="#cb15-616" aria-hidden="true" tabindex="-1"></a>                                            item_text <span class="op">=</span> item.get(<span class="st">&#39;text&#39;</span>, <span class="st">&#39;&#39;</span>)</span>
<span id="cb15-617"><a href="#cb15-617" aria-hidden="true" tabindex="-1"></a>                                            <span class="cf">if</span> item_text:</span>
<span id="cb15-618"><a href="#cb15-618" aria-hidden="true" tabindex="-1"></a>                                                content_parts.append(<span class="bu">str</span>(item_text))</span>
<span id="cb15-619"><a href="#cb15-619" aria-hidden="true" tabindex="-1"></a>                                <span class="cf">else</span>:</span>
<span id="cb15-620"><a href="#cb15-620" aria-hidden="true" tabindex="-1"></a>                                    content_parts.append(<span class="bu">str</span>(content))</span>
<span id="cb15-621"><a href="#cb15-621" aria-hidden="true" tabindex="-1"></a>                                    </span>
<span id="cb15-622"><a href="#cb15-622" aria-hidden="true" tabindex="-1"></a>                    content <span class="op">=</span> <span class="st">&#39; &#39;</span>.join(content_parts).strip()</span>
<span id="cb15-623"><a href="#cb15-623" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb15-624"><a href="#cb15-624" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># APLICA PRESERVA√á√ÉO</span></span>
<span id="cb15-625"><a href="#cb15-625" aria-hidden="true" tabindex="-1"></a>                    content <span class="op">=</span> <span class="va">self</span>.preserve_special_content(content)</span>
<span id="cb15-626"><a href="#cb15-626" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb15-627"><a href="#cb15-627" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="kw">not</span> content:</span>
<span id="cb15-628"><a href="#cb15-628" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb15-629"><a href="#cb15-629" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb15-630"><a href="#cb15-630" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> msg_type <span class="op">==</span> <span class="st">&#39;REQUEST&#39;</span>:</span>
<span id="cb15-631"><a href="#cb15-631" aria-hidden="true" tabindex="-1"></a>                        author <span class="op">=</span> <span class="st">&quot;üë§ Utilizador&quot;</span></span>
<span id="cb15-632"><a href="#cb15-632" aria-hidden="true" tabindex="-1"></a>                        role <span class="op">=</span> <span class="st">&#39;user&#39;</span></span>
<span id="cb15-633"><a href="#cb15-633" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">else</span>:</span>
<span id="cb15-634"><a href="#cb15-634" aria-hidden="true" tabindex="-1"></a>                        author <span class="op">=</span> <span class="st">&quot;ü§ñ DeepSeek&quot;</span></span>
<span id="cb15-635"><a href="#cb15-635" aria-hidden="true" tabindex="-1"></a>                        role <span class="op">=</span> <span class="st">&#39;assistant&#39;</span></span>
<span id="cb15-636"><a href="#cb15-636" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb15-637"><a href="#cb15-637" aria-hidden="true" tabindex="-1"></a>                    messages.append({</span>
<span id="cb15-638"><a href="#cb15-638" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;author&#39;</span>: author,</span>
<span id="cb15-639"><a href="#cb15-639" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;role&#39;</span>: role,</span>
<span id="cb15-640"><a href="#cb15-640" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;content&#39;</span>: content,</span>
<span id="cb15-641"><a href="#cb15-641" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;timestamp&#39;</span>: <span class="va">self</span>.format_timestamp(msg_data.get(<span class="st">&#39;inserted_at&#39;</span>)),</span>
<span id="cb15-642"><a href="#cb15-642" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;model&#39;</span>: msg_data.get(<span class="st">&#39;model&#39;</span>, <span class="st">&#39;DeepSeek&#39;</span>)</span>
<span id="cb15-643"><a href="#cb15-643" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb15-644"><a href="#cb15-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-645"><a href="#cb15-645" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> messages:</span>
<span id="cb15-646"><a href="#cb15-646" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.all_conversations.append({</span>
<span id="cb15-647"><a href="#cb15-647" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;title&#39;</span>: title,</span>
<span id="cb15-648"><a href="#cb15-648" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;source&#39;</span>: <span class="st">&#39;DeepSeek&#39;</span>,</span>
<span id="cb15-649"><a href="#cb15-649" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;id&#39;</span>: conv.get(<span class="st">&#39;id&#39;</span>, <span class="ss">f&#39;deepseek_</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">&#39;</span>),</span>
<span id="cb15-650"><a href="#cb15-650" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;inserted_at&#39;</span>: <span class="va">self</span>.format_timestamp(conv.get(<span class="st">&#39;inserted_at&#39;</span>)),</span>
<span id="cb15-651"><a href="#cb15-651" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;updated_at&#39;</span>: <span class="va">self</span>.format_timestamp(conv.get(<span class="st">&#39;updated_at&#39;</span>)),</span>
<span id="cb15-652"><a href="#cb15-652" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;messages&#39;</span>: messages,</span>
<span id="cb15-653"><a href="#cb15-653" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;summary&#39;</span>: messages[<span class="dv">0</span>][<span class="st">&#39;content&#39;</span>][:<span class="dv">100</span>] <span class="op">+</span> <span class="st">&quot;...&quot;</span> <span class="cf">if</span> messages <span class="cf">else</span> <span class="st">&quot;Sem conte√∫do&quot;</span>,</span>
<span id="cb15-654"><a href="#cb15-654" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;category&#39;</span>: <span class="st">&#39;Geral&#39;</span></span>
<span id="cb15-655"><a href="#cb15-655" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb15-656"><a href="#cb15-656" aria-hidden="true" tabindex="-1"></a>                    processed_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb15-657"><a href="#cb15-657" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb15-658"><a href="#cb15-658" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ DeepSeek: </span><span class="sc">{</span>processed_count<span class="sc">}</span><span class="ss"> conversas processadas.&quot;</span>)</span>
<span id="cb15-659"><a href="#cb15-659" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb15-660"><a href="#cb15-660" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb15-661"><a href="#cb15-661" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚ùå Erro ao processar DeepSeek: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb15-662"><a href="#cb15-662" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb15-663"><a href="#cb15-663" aria-hidden="true" tabindex="-1"></a>                traceback.print_exc()</span>
<span id="cb15-664"><a href="#cb15-664" aria-hidden="true" tabindex="-1"></a>        <span class="cf">finally</span>:</span>
<span id="cb15-665"><a href="#cb15-665" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="st">&#39;temp_dir&#39;</span> <span class="kw">in</span> <span class="bu">locals</span>():</span>
<span id="cb15-666"><a href="#cb15-666" aria-hidden="true" tabindex="-1"></a>                shutil.rmtree(temp_dir, ignore_errors<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb15-667"><a href="#cb15-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-668"><a href="#cb15-668" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> process_grok(<span class="va">self</span>, path: Path):</span>
<span id="cb15-669"><a href="#cb15-669" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Processa exporta√ß√£o do Grok&quot;&quot;&quot;</span></span>
<span id="cb15-670"><a href="#cb15-670" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb15-671"><a href="#cb15-671" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;üß™ [DRY-RUN] Processaria Grok: </span><span class="sc">{</span>path<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb15-672"><a href="#cb15-672" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb15-673"><a href="#cb15-673" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb15-674"><a href="#cb15-674" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb15-675"><a href="#cb15-675" aria-hidden="true" tabindex="-1"></a>            temp_dir <span class="op">=</span> tempfile.mkdtemp(prefix<span class="op">=</span><span class="st">&quot;grok_&quot;</span>)</span>
<span id="cb15-676"><a href="#cb15-676" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> zipfile.ZipFile(path, <span class="st">&#39;r&#39;</span>) <span class="im">as</span> z:</span>
<span id="cb15-677"><a href="#cb15-677" aria-hidden="true" tabindex="-1"></a>                z.extractall(temp_dir)</span>
<span id="cb15-678"><a href="#cb15-678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-679"><a href="#cb15-679" aria-hidden="true" tabindex="-1"></a>            target_file <span class="op">=</span> <span class="va">None</span></span>
<span id="cb15-680"><a href="#cb15-680" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> root, _, files <span class="kw">in</span> os.walk(temp_dir):</span>
<span id="cb15-681"><a href="#cb15-681" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> <span class="bu">file</span> <span class="kw">in</span> files:</span>
<span id="cb15-682"><a href="#cb15-682" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="bu">file</span> <span class="op">==</span> <span class="st">&quot;prod-grok-backend.json&quot;</span>:</span>
<span id="cb15-683"><a href="#cb15-683" aria-hidden="true" tabindex="-1"></a>                        target_file <span class="op">=</span> Path(root) <span class="op">/</span> <span class="bu">file</span></span>
<span id="cb15-684"><a href="#cb15-684" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">break</span></span>
<span id="cb15-685"><a href="#cb15-685" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> target_file:</span>
<span id="cb15-686"><a href="#cb15-686" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">break</span></span>
<span id="cb15-687"><a href="#cb15-687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-688"><a href="#cb15-688" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> target_file:</span>
<span id="cb15-689"><a href="#cb15-689" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;‚ùå Grok: ficheiro &#39;prod-grok-backend.json&#39; n√£o encontrado no ZIP.&quot;</span>)</span>
<span id="cb15-690"><a href="#cb15-690" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span></span>
<span id="cb15-691"><a href="#cb15-691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-692"><a href="#cb15-692" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;üîç Grok: carregando </span><span class="sc">{</span>target_file<span class="sc">.</span>name<span class="sc">}</span><span class="ss">...&quot;</span>)</span>
<span id="cb15-693"><a href="#cb15-693" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(target_file, <span class="st">&#39;r&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb15-694"><a href="#cb15-694" aria-hidden="true" tabindex="-1"></a>                data <span class="op">=</span> json.load(f)</span>
<span id="cb15-695"><a href="#cb15-695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-696"><a href="#cb15-696" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(data, <span class="bu">dict</span>) <span class="kw">or</span> <span class="st">&#39;conversations&#39;</span> <span class="kw">not</span> <span class="kw">in</span> data:</span>
<span id="cb15-697"><a href="#cb15-697" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;‚ùå Grok: estrutura inesperada ‚Äî chave &#39;conversations&#39; n√£o encontrada.&quot;</span>)</span>
<span id="cb15-698"><a href="#cb15-698" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span></span>
<span id="cb15-699"><a href="#cb15-699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-700"><a href="#cb15-700" aria-hidden="true" tabindex="-1"></a>            conversations_list <span class="op">=</span> data[<span class="st">&#39;conversations&#39;</span>]</span>
<span id="cb15-701"><a href="#cb15-701" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(conversations_list, <span class="bu">list</span>):</span>
<span id="cb15-702"><a href="#cb15-702" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;‚ùå Grok: &#39;conversations&#39; n√£o √© uma lista.&quot;</span>)</span>
<span id="cb15-703"><a href="#cb15-703" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span></span>
<span id="cb15-704"><a href="#cb15-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-705"><a href="#cb15-705" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;üìä Grok: encontradas </span><span class="sc">{</span><span class="bu">len</span>(conversations_list)<span class="sc">}</span><span class="ss"> conversas.&quot;</span>)</span>
<span id="cb15-706"><a href="#cb15-706" aria-hidden="true" tabindex="-1"></a>            total_convs <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb15-707"><a href="#cb15-707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-708"><a href="#cb15-708" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> item <span class="kw">in</span> conversations_list:</span>
<span id="cb15-709"><a href="#cb15-709" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(item, <span class="bu">dict</span>):</span>
<span id="cb15-710"><a href="#cb15-710" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">continue</span></span>
<span id="cb15-711"><a href="#cb15-711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-712"><a href="#cb15-712" aria-hidden="true" tabindex="-1"></a>                conv_meta <span class="op">=</span> item.get(<span class="st">&#39;conversation&#39;</span>)</span>
<span id="cb15-713"><a href="#cb15-713" aria-hidden="true" tabindex="-1"></a>                responses <span class="op">=</span> item.get(<span class="st">&#39;responses&#39;</span>, [])</span>
<span id="cb15-714"><a href="#cb15-714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-715"><a href="#cb15-715" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(conv_meta, <span class="bu">dict</span>) <span class="kw">or</span> <span class="kw">not</span> <span class="bu">isinstance</span>(responses, <span class="bu">list</span>) <span class="kw">or</span> <span class="kw">not</span> responses:</span>
<span id="cb15-716"><a href="#cb15-716" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">continue</span></span>
<span id="cb15-717"><a href="#cb15-717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-718"><a href="#cb15-718" aria-hidden="true" tabindex="-1"></a>                conv_id <span class="op">=</span> conv_meta.get(<span class="st">&#39;id&#39;</span>)</span>
<span id="cb15-719"><a href="#cb15-719" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="kw">not</span> conv_id:</span>
<span id="cb15-720"><a href="#cb15-720" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">continue</span></span>
<span id="cb15-721"><a href="#cb15-721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-722"><a href="#cb15-722" aria-hidden="true" tabindex="-1"></a>                title <span class="op">=</span> conv_meta.get(<span class="st">&#39;title&#39;</span>, <span class="ss">f&quot;Conversa Grok </span><span class="sc">{</span>total_convs <span class="op">+</span> <span class="dv">1</span><span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb15-723"><a href="#cb15-723" aria-hidden="true" tabindex="-1"></a>                title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(title)</span>
<span id="cb15-724"><a href="#cb15-724" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb15-725"><a href="#cb15-725" aria-hidden="true" tabindex="-1"></a>                create_time_str <span class="op">=</span> conv_meta.get(<span class="st">&#39;create_time&#39;</span>)</span>
<span id="cb15-726"><a href="#cb15-726" aria-hidden="true" tabindex="-1"></a>                modify_time_str <span class="op">=</span> conv_meta.get(<span class="st">&#39;modify_time&#39;</span>)</span>
<span id="cb15-727"><a href="#cb15-727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-728"><a href="#cb15-728" aria-hidden="true" tabindex="-1"></a>                <span class="kw">def</span> format_iso_timestamp(ts_str):</span>
<span id="cb15-729"><a href="#cb15-729" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="kw">not</span> ts_str:</span>
<span id="cb15-730"><a href="#cb15-730" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb15-731"><a href="#cb15-731" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">try</span>:</span>
<span id="cb15-732"><a href="#cb15-732" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">if</span> <span class="st">&#39;.&#39;</span> <span class="kw">in</span> ts_str:</span>
<span id="cb15-733"><a href="#cb15-733" aria-hidden="true" tabindex="-1"></a>                            ts_str <span class="op">=</span> ts_str.split(<span class="st">&#39;.&#39;</span>)[<span class="dv">0</span>] <span class="op">+</span> <span class="st">&#39;Z&#39;</span></span>
<span id="cb15-734"><a href="#cb15-734" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">return</span> <span class="va">self</span>.format_timestamp(ts_str)</span>
<span id="cb15-735"><a href="#cb15-735" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">except</span>:</span>
<span id="cb15-736"><a href="#cb15-736" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">return</span> <span class="bu">str</span>(ts_str)</span>
<span id="cb15-737"><a href="#cb15-737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-738"><a href="#cb15-738" aria-hidden="true" tabindex="-1"></a>                inserted_at <span class="op">=</span> format_iso_timestamp(create_time_str)</span>
<span id="cb15-739"><a href="#cb15-739" aria-hidden="true" tabindex="-1"></a>                updated_at <span class="op">=</span> format_iso_timestamp(modify_time_str)</span>
<span id="cb15-740"><a href="#cb15-740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-741"><a href="#cb15-741" aria-hidden="true" tabindex="-1"></a>                messages <span class="op">=</span> []</span>
<span id="cb15-742"><a href="#cb15-742" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> resp <span class="kw">in</span> responses:</span>
<span id="cb15-743"><a href="#cb15-743" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(resp, <span class="bu">dict</span>):</span>
<span id="cb15-744"><a href="#cb15-744" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb15-745"><a href="#cb15-745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-746"><a href="#cb15-746" aria-hidden="true" tabindex="-1"></a>                    resp_data <span class="op">=</span> resp.get(<span class="st">&#39;response&#39;</span>)</span>
<span id="cb15-747"><a href="#cb15-747" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(resp_data, <span class="bu">dict</span>):</span>
<span id="cb15-748"><a href="#cb15-748" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb15-749"><a href="#cb15-749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-750"><a href="#cb15-750" aria-hidden="true" tabindex="-1"></a>                    sender <span class="op">=</span> resp_data.get(<span class="st">&#39;sender&#39;</span>, <span class="st">&#39;&#39;</span>).upper()</span>
<span id="cb15-751"><a href="#cb15-751" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> sender <span class="op">==</span> <span class="st">&#39;HUMAN&#39;</span>:</span>
<span id="cb15-752"><a href="#cb15-752" aria-hidden="true" tabindex="-1"></a>                        author <span class="op">=</span> <span class="st">&quot;üë§ Utilizador&quot;</span></span>
<span id="cb15-753"><a href="#cb15-753" aria-hidden="true" tabindex="-1"></a>                        role <span class="op">=</span> <span class="st">&quot;user&quot;</span></span>
<span id="cb15-754"><a href="#cb15-754" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">elif</span> sender <span class="op">==</span> <span class="st">&#39;ASSISTANT&#39;</span>:</span>
<span id="cb15-755"><a href="#cb15-755" aria-hidden="true" tabindex="-1"></a>                        author <span class="op">=</span> <span class="st">&quot;ü§ñ Grok&quot;</span></span>
<span id="cb15-756"><a href="#cb15-756" aria-hidden="true" tabindex="-1"></a>                        role <span class="op">=</span> <span class="st">&quot;assistant&quot;</span></span>
<span id="cb15-757"><a href="#cb15-757" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">else</span>:</span>
<span id="cb15-758"><a href="#cb15-758" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb15-759"><a href="#cb15-759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-760"><a href="#cb15-760" aria-hidden="true" tabindex="-1"></a>                    content <span class="op">=</span> <span class="bu">str</span>(resp_data.get(<span class="st">&#39;message&#39;</span>, <span class="st">&#39;&#39;</span>)).strip()</span>
<span id="cb15-761"><a href="#cb15-761" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb15-762"><a href="#cb15-762" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># APLICA PRESERVA√á√ÉO</span></span>
<span id="cb15-763"><a href="#cb15-763" aria-hidden="true" tabindex="-1"></a>                    content <span class="op">=</span> <span class="va">self</span>.preserve_special_content(content)</span>
<span id="cb15-764"><a href="#cb15-764" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb15-765"><a href="#cb15-765" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="kw">not</span> content:</span>
<span id="cb15-766"><a href="#cb15-766" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb15-767"><a href="#cb15-767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-768"><a href="#cb15-768" aria-hidden="true" tabindex="-1"></a>                    create_time <span class="op">=</span> resp_data.get(<span class="st">&#39;create_time&#39;</span>)</span>
<span id="cb15-769"><a href="#cb15-769" aria-hidden="true" tabindex="-1"></a>                    timestamp_ms <span class="op">=</span> <span class="va">None</span></span>
<span id="cb15-770"><a href="#cb15-770" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="bu">isinstance</span>(create_time, <span class="bu">dict</span>) <span class="kw">and</span> <span class="st">&#39;$date&#39;</span> <span class="kw">in</span> create_time:</span>
<span id="cb15-771"><a href="#cb15-771" aria-hidden="true" tabindex="-1"></a>                        date_obj <span class="op">=</span> create_time[<span class="st">&#39;$date&#39;</span>]</span>
<span id="cb15-772"><a href="#cb15-772" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">if</span> <span class="bu">isinstance</span>(date_obj, <span class="bu">dict</span>) <span class="kw">and</span> <span class="st">&#39;$numberLong&#39;</span> <span class="kw">in</span> date_obj:</span>
<span id="cb15-773"><a href="#cb15-773" aria-hidden="true" tabindex="-1"></a>                            <span class="cf">try</span>:</span>
<span id="cb15-774"><a href="#cb15-774" aria-hidden="true" tabindex="-1"></a>                                timestamp_ms <span class="op">=</span> <span class="bu">int</span>(date_obj[<span class="st">&#39;$numberLong&#39;</span>])</span>
<span id="cb15-775"><a href="#cb15-775" aria-hidden="true" tabindex="-1"></a>                            <span class="cf">except</span>:</span>
<span id="cb15-776"><a href="#cb15-776" aria-hidden="true" tabindex="-1"></a>                                <span class="cf">pass</span></span>
<span id="cb15-777"><a href="#cb15-777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-778"><a href="#cb15-778" aria-hidden="true" tabindex="-1"></a>                    messages.append({</span>
<span id="cb15-779"><a href="#cb15-779" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;author&#39;</span>: author,</span>
<span id="cb15-780"><a href="#cb15-780" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;role&#39;</span>: role,</span>
<span id="cb15-781"><a href="#cb15-781" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;content&#39;</span>: content,</span>
<span id="cb15-782"><a href="#cb15-782" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;timestamp&#39;</span>: <span class="va">self</span>.format_timestamp(timestamp_ms <span class="op">/</span> <span class="fl">1000.0</span> <span class="cf">if</span> timestamp_ms <span class="cf">else</span> <span class="va">None</span>),</span>
<span id="cb15-783"><a href="#cb15-783" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;model&#39;</span>: <span class="st">&#39;Grok&#39;</span></span>
<span id="cb15-784"><a href="#cb15-784" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb15-785"><a href="#cb15-785" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-786"><a href="#cb15-786" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> messages:</span>
<span id="cb15-787"><a href="#cb15-787" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.all_conversations.append({</span>
<span id="cb15-788"><a href="#cb15-788" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;title&#39;</span>: title,</span>
<span id="cb15-789"><a href="#cb15-789" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;source&#39;</span>: <span class="st">&#39;Grok&#39;</span>,</span>
<span id="cb15-790"><a href="#cb15-790" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;id&#39;</span>: conv_id,</span>
<span id="cb15-791"><a href="#cb15-791" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;inserted_at&#39;</span>: inserted_at,</span>
<span id="cb15-792"><a href="#cb15-792" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;updated_at&#39;</span>: updated_at,</span>
<span id="cb15-793"><a href="#cb15-793" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;messages&#39;</span>: messages,</span>
<span id="cb15-794"><a href="#cb15-794" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;summary&#39;</span>: messages[<span class="dv">0</span>][<span class="st">&#39;content&#39;</span>][:<span class="dv">100</span>] <span class="op">+</span> <span class="st">&quot;...&quot;</span> <span class="cf">if</span> messages <span class="cf">else</span> <span class="st">&quot;Sem conte√∫do&quot;</span>,</span>
<span id="cb15-795"><a href="#cb15-795" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;category&#39;</span>: <span class="st">&#39;Geral&#39;</span></span>
<span id="cb15-796"><a href="#cb15-796" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb15-797"><a href="#cb15-797" aria-hidden="true" tabindex="-1"></a>                    total_convs <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb15-798"><a href="#cb15-798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-799"><a href="#cb15-799" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> total_convs <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb15-800"><a href="#cb15-800" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ Grok: processadas </span><span class="sc">{</span>total_convs<span class="sc">}</span><span class="ss"> conversas.&quot;</span>)</span>
<span id="cb15-801"><a href="#cb15-801" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb15-802"><a href="#cb15-802" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;‚ùå Grok: nenhuma conversa v√°lida encontrada.&quot;</span>)</span>
<span id="cb15-803"><a href="#cb15-803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-804"><a href="#cb15-804" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb15-805"><a href="#cb15-805" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚ùå Erro ao processar Grok: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb15-806"><a href="#cb15-806" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb15-807"><a href="#cb15-807" aria-hidden="true" tabindex="-1"></a>                traceback.print_exc()</span>
<span id="cb15-808"><a href="#cb15-808" aria-hidden="true" tabindex="-1"></a>        <span class="cf">finally</span>:</span>
<span id="cb15-809"><a href="#cb15-809" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="st">&#39;temp_dir&#39;</span> <span class="kw">in</span> <span class="bu">locals</span>():</span>
<span id="cb15-810"><a href="#cb15-810" aria-hidden="true" tabindex="-1"></a>                shutil.rmtree(temp_dir, ignore_errors<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb15-811"><a href="#cb15-811" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-812"><a href="#cb15-812" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> save_as_markdown_enhanced(<span class="va">self</span>):</span>
<span id="cb15-813"><a href="#cb15-813" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Salva conversas com preserva√ß√£o total de formata√ß√£o&quot;&quot;&quot;</span></span>
<span id="cb15-814"><a href="#cb15-814" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb15-815"><a href="#cb15-815" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;üß™ [DRY-RUN] Markdowns seriam criados:&quot;</span>)</span>
<span id="cb15-816"><a href="#cb15-816" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> conv <span class="kw">in</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb15-817"><a href="#cb15-817" aria-hidden="true" tabindex="-1"></a>                safe_title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(conv[<span class="st">&#39;title&#39;</span>])</span>
<span id="cb15-818"><a href="#cb15-818" aria-hidden="true" tabindex="-1"></a>                filename <span class="op">=</span> <span class="ss">f&quot;</span><span class="sc">{</span>conv[<span class="st">&#39;number&#39;</span>]<span class="sc">:03d}</span><span class="ss">_</span><span class="sc">{</span>conv[<span class="st">&#39;source&#39;</span>]<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>safe_title<span class="sc">}</span><span class="ss">.md&quot;</span></span>
<span id="cb15-819"><a href="#cb15-819" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;   üìÑ </span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb15-820"><a href="#cb15-820" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb15-821"><a href="#cb15-821" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb15-822"><a href="#cb15-822" aria-hidden="true" tabindex="-1"></a>        folder <span class="op">=</span> <span class="va">self</span>.output_dirs[<span class="st">&#39;markdown&#39;</span>]</span>
<span id="cb15-823"><a href="#cb15-823" aria-hidden="true" tabindex="-1"></a>        saved_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb15-824"><a href="#cb15-824" aria-hidden="true" tabindex="-1"></a>        failed_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb15-825"><a href="#cb15-825" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-826"><a href="#cb15-826" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> conv <span class="kw">in</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb15-827"><a href="#cb15-827" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb15-828"><a href="#cb15-828" aria-hidden="true" tabindex="-1"></a>                safe_title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(conv[<span class="st">&#39;title&#39;</span>])</span>
<span id="cb15-829"><a href="#cb15-829" aria-hidden="true" tabindex="-1"></a>                filename <span class="op">=</span> <span class="ss">f&quot;</span><span class="sc">{</span>conv[<span class="st">&#39;number&#39;</span>]<span class="sc">:03d}</span><span class="ss">_</span><span class="sc">{</span>conv[<span class="st">&#39;source&#39;</span>]<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>safe_title<span class="sc">}</span><span class="ss">.md&quot;</span></span>
<span id="cb15-830"><a href="#cb15-830" aria-hidden="true" tabindex="-1"></a>                filepath <span class="op">=</span> Path(folder) <span class="op">/</span> filename</span>
<span id="cb15-831"><a href="#cb15-831" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb15-832"><a href="#cb15-832" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.force_overwrite <span class="kw">and</span> filepath.exists():</span>
<span id="cb15-833"><a href="#cb15-833" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">continue</span></span>
<span id="cb15-834"><a href="#cb15-834" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb15-835"><a href="#cb15-835" aria-hidden="true" tabindex="-1"></a>                markdown_content <span class="op">=</span> <span class="va">self</span>.create_enhanced_markdown_content(conv)</span>
<span id="cb15-836"><a href="#cb15-836" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb15-837"><a href="#cb15-837" aria-hidden="true" tabindex="-1"></a>                <span class="cf">with</span> <span class="bu">open</span>(filepath, <span class="st">&#39;w&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb15-838"><a href="#cb15-838" aria-hidden="true" tabindex="-1"></a>                    f.write(markdown_content)</span>
<span id="cb15-839"><a href="#cb15-839" aria-hidden="true" tabindex="-1"></a>                saved_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb15-840"><a href="#cb15-840" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb15-841"><a href="#cb15-841" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb15-842"><a href="#cb15-842" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;‚ùå Erro ao salvar conversa </span><span class="sc">{</span>conv[<span class="st">&#39;number&#39;</span>]<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb15-843"><a href="#cb15-843" aria-hidden="true" tabindex="-1"></a>                failed_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb15-844"><a href="#cb15-844" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span></span>
<span id="cb15-845"><a href="#cb15-845" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb15-846"><a href="#cb15-846" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ Markdown: </span><span class="sc">{</span>saved_count<span class="sc">}</span><span class="ss"> arquivos criados, </span><span class="sc">{</span>failed_count<span class="sc">}</span><span class="ss"> falhas em &#39;</span><span class="sc">{</span>folder<span class="sc">}</span><span class="ss">&#39;&quot;</span>)</span>
<span id="cb15-847"><a href="#cb15-847" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-848"><a href="#cb15-848" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> save_as_html_with_pandoc(<span class="va">self</span>):</span>
<span id="cb15-849"><a href="#cb15-849" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Converte arquivos Markdown para HTML usando Pandoc --standalone --mathjax&quot;&quot;&quot;</span></span>
<span id="cb15-850"><a href="#cb15-850" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb15-851"><a href="#cb15-851" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;üß™ [DRY-RUN] HTMLs seriam criados com Pandoc:&quot;</span>)</span>
<span id="cb15-852"><a href="#cb15-852" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> conv <span class="kw">in</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb15-853"><a href="#cb15-853" aria-hidden="true" tabindex="-1"></a>                safe_title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(conv[<span class="st">&#39;title&#39;</span>])</span>
<span id="cb15-854"><a href="#cb15-854" aria-hidden="true" tabindex="-1"></a>                filename <span class="op">=</span> <span class="ss">f&quot;</span><span class="sc">{</span>conv[<span class="st">&#39;number&#39;</span>]<span class="sc">:03d}</span><span class="ss">_</span><span class="sc">{</span>conv[<span class="st">&#39;source&#39;</span>]<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>safe_title<span class="sc">}</span><span class="ss">.html&quot;</span></span>
<span id="cb15-855"><a href="#cb15-855" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;   üåê </span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss"> (via Pandoc)&quot;</span>)</span>
<span id="cb15-856"><a href="#cb15-856" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb15-857"><a href="#cb15-857" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-858"><a href="#cb15-858" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.check_pandoc_available():</span>
<span id="cb15-859"><a href="#cb15-859" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;‚ùå Pandoc n√£o dispon√≠vel. HTMLs n√£o ser√£o gerados.&quot;</span>)</span>
<span id="cb15-860"><a href="#cb15-860" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb15-861"><a href="#cb15-861" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb15-862"><a href="#cb15-862" aria-hidden="true" tabindex="-1"></a>        folder <span class="op">=</span> <span class="va">self</span>.output_dirs[<span class="st">&#39;markdown&#39;</span>]</span>
<span id="cb15-863"><a href="#cb15-863" aria-hidden="true" tabindex="-1"></a>        html_folder <span class="op">=</span> <span class="va">self</span>.output_dirs[<span class="st">&#39;html&#39;</span>]</span>
<span id="cb15-864"><a href="#cb15-864" aria-hidden="true" tabindex="-1"></a>        converted_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb15-865"><a href="#cb15-865" aria-hidden="true" tabindex="-1"></a>        failed_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb15-866"><a href="#cb15-866" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-867"><a href="#cb15-867" aria-hidden="true" tabindex="-1"></a>        md_files <span class="op">=</span> <span class="bu">list</span>(Path(folder).glob(<span class="st">&quot;*.md&quot;</span>))</span>
<span id="cb15-868"><a href="#cb15-868" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-869"><a href="#cb15-869" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> md_files:</span>
<span id="cb15-870"><a href="#cb15-870" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;‚ùå Nenhum arquivo Markdown encontrado para convers√£o.&quot;</span>)</span>
<span id="cb15-871"><a href="#cb15-871" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb15-872"><a href="#cb15-872" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-873"><a href="#cb15-873" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;üîÑ Convertendo </span><span class="sc">{</span><span class="bu">len</span>(md_files)<span class="sc">}</span><span class="ss"> arquivos Markdown para HTML com Pandoc...&quot;</span>)</span>
<span id="cb15-874"><a href="#cb15-874" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-875"><a href="#cb15-875" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> md_file <span class="kw">in</span> md_files:</span>
<span id="cb15-876"><a href="#cb15-876" aria-hidden="true" tabindex="-1"></a>            success <span class="op">=</span> <span class="va">self</span>.convert_markdown_to_html_pandoc(md_file)</span>
<span id="cb15-877"><a href="#cb15-877" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> success:</span>
<span id="cb15-878"><a href="#cb15-878" aria-hidden="true" tabindex="-1"></a>                converted_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb15-879"><a href="#cb15-879" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb15-880"><a href="#cb15-880" aria-hidden="true" tabindex="-1"></a>                failed_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb15-881"><a href="#cb15-881" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb15-882"><a href="#cb15-882" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ HTML: </span><span class="sc">{</span>converted_count<span class="sc">}</span><span class="ss"> arquivos criados, </span><span class="sc">{</span>failed_count<span class="sc">}</span><span class="ss"> falhas em &#39;</span><span class="sc">{</span>html_folder<span class="sc">}</span><span class="ss">&#39;&quot;</span>)</span>
<span id="cb15-883"><a href="#cb15-883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-884"><a href="#cb15-884" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> save_as_csv(<span class="va">self</span>):</span>
<span id="cb15-885"><a href="#cb15-885" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Salva conversas em arquivos CSV individuais&quot;&quot;&quot;</span></span>
<span id="cb15-886"><a href="#cb15-886" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb15-887"><a href="#cb15-887" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;üß™ [DRY-RUN] CSVs seriam criados:&quot;</span>)</span>
<span id="cb15-888"><a href="#cb15-888" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> conv <span class="kw">in</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb15-889"><a href="#cb15-889" aria-hidden="true" tabindex="-1"></a>                safe_title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(conv[<span class="st">&#39;title&#39;</span>])</span>
<span id="cb15-890"><a href="#cb15-890" aria-hidden="true" tabindex="-1"></a>                filename <span class="op">=</span> <span class="ss">f&quot;</span><span class="sc">{</span>conv[<span class="st">&#39;number&#39;</span>]<span class="sc">:03d}</span><span class="ss">_</span><span class="sc">{</span>conv[<span class="st">&#39;source&#39;</span>]<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>safe_title<span class="sc">}</span><span class="ss">.csv&quot;</span></span>
<span id="cb15-891"><a href="#cb15-891" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;   üìä </span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb15-892"><a href="#cb15-892" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb15-893"><a href="#cb15-893" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb15-894"><a href="#cb15-894" aria-hidden="true" tabindex="-1"></a>        folder <span class="op">=</span> <span class="va">self</span>.output_dirs[<span class="st">&#39;csv&#39;</span>]</span>
<span id="cb15-895"><a href="#cb15-895" aria-hidden="true" tabindex="-1"></a>        saved_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb15-896"><a href="#cb15-896" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-897"><a href="#cb15-897" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> conv <span class="kw">in</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb15-898"><a href="#cb15-898" aria-hidden="true" tabindex="-1"></a>            safe_title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(conv[<span class="st">&#39;title&#39;</span>])</span>
<span id="cb15-899"><a href="#cb15-899" aria-hidden="true" tabindex="-1"></a>            filename <span class="op">=</span> <span class="ss">f&quot;</span><span class="sc">{</span>conv[<span class="st">&#39;number&#39;</span>]<span class="sc">:03d}</span><span class="ss">_</span><span class="sc">{</span>conv[<span class="st">&#39;source&#39;</span>]<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>safe_title<span class="sc">}</span><span class="ss">.csv&quot;</span></span>
<span id="cb15-900"><a href="#cb15-900" aria-hidden="true" tabindex="-1"></a>            filepath <span class="op">=</span> Path(folder) <span class="op">/</span> filename</span>
<span id="cb15-901"><a href="#cb15-901" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb15-902"><a href="#cb15-902" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.force_overwrite <span class="kw">and</span> filepath.exists():</span>
<span id="cb15-903"><a href="#cb15-903" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span></span>
<span id="cb15-904"><a href="#cb15-904" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb15-905"><a href="#cb15-905" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(filepath, <span class="st">&#39;w&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>, newline<span class="op">=</span><span class="st">&#39;&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb15-906"><a href="#cb15-906" aria-hidden="true" tabindex="-1"></a>                writer <span class="op">=</span> csv.DictWriter(f, fieldnames<span class="op">=</span>[</span>
<span id="cb15-907"><a href="#cb15-907" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;node_id&#39;</span>, <span class="st">&#39;author&#39;</span>, <span class="st">&#39;role&#39;</span>, <span class="st">&#39;timestamp&#39;</span>, <span class="st">&#39;model&#39;</span>, <span class="st">&#39;content&#39;</span></span>
<span id="cb15-908"><a href="#cb15-908" aria-hidden="true" tabindex="-1"></a>                ])</span>
<span id="cb15-909"><a href="#cb15-909" aria-hidden="true" tabindex="-1"></a>                writer.writeheader()</span>
<span id="cb15-910"><a href="#cb15-910" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> i, msg <span class="kw">in</span> <span class="bu">enumerate</span>(conv[<span class="st">&#39;messages&#39;</span>]):</span>
<span id="cb15-911"><a href="#cb15-911" aria-hidden="true" tabindex="-1"></a>                    writer.writerow({</span>
<span id="cb15-912"><a href="#cb15-912" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;node_id&#39;</span>: <span class="bu">str</span>(i),</span>
<span id="cb15-913"><a href="#cb15-913" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;author&#39;</span>: msg[<span class="st">&#39;author&#39;</span>],</span>
<span id="cb15-914"><a href="#cb15-914" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;role&#39;</span>: msg[<span class="st">&#39;role&#39;</span>],</span>
<span id="cb15-915"><a href="#cb15-915" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;timestamp&#39;</span>: msg[<span class="st">&#39;timestamp&#39;</span>],</span>
<span id="cb15-916"><a href="#cb15-916" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;model&#39;</span>: msg[<span class="st">&#39;model&#39;</span>],</span>
<span id="cb15-917"><a href="#cb15-917" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;content&#39;</span>: msg[<span class="st">&#39;content&#39;</span>]</span>
<span id="cb15-918"><a href="#cb15-918" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb15-919"><a href="#cb15-919" aria-hidden="true" tabindex="-1"></a>            saved_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb15-920"><a href="#cb15-920" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb15-921"><a href="#cb15-921" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ CSV: </span><span class="sc">{</span>saved_count<span class="sc">}</span><span class="ss"> arquivos criados em &#39;</span><span class="sc">{</span>folder<span class="sc">}</span><span class="ss">&#39;&quot;</span>)</span>
<span id="cb15-922"><a href="#cb15-922" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-923"><a href="#cb15-923" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> save_as_json(<span class="va">self</span>):</span>
<span id="cb15-924"><a href="#cb15-924" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Salva conversas em arquivos JSON individuais&quot;&quot;&quot;</span></span>
<span id="cb15-925"><a href="#cb15-925" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb15-926"><a href="#cb15-926" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;üß™ [DRY-RUN] JSONs seriam criados:&quot;</span>)</span>
<span id="cb15-927"><a href="#cb15-927" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> conv <span class="kw">in</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb15-928"><a href="#cb15-928" aria-hidden="true" tabindex="-1"></a>                safe_title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(conv[<span class="st">&#39;title&#39;</span>])</span>
<span id="cb15-929"><a href="#cb15-929" aria-hidden="true" tabindex="-1"></a>                filename <span class="op">=</span> <span class="ss">f&quot;</span><span class="sc">{</span>conv[<span class="st">&#39;number&#39;</span>]<span class="sc">:03d}</span><span class="ss">_</span><span class="sc">{</span>conv[<span class="st">&#39;source&#39;</span>]<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>safe_title<span class="sc">}</span><span class="ss">.json&quot;</span></span>
<span id="cb15-930"><a href="#cb15-930" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;   üìã </span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb15-931"><a href="#cb15-931" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb15-932"><a href="#cb15-932" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb15-933"><a href="#cb15-933" aria-hidden="true" tabindex="-1"></a>        folder <span class="op">=</span> <span class="va">self</span>.output_dirs[<span class="st">&#39;json&#39;</span>]</span>
<span id="cb15-934"><a href="#cb15-934" aria-hidden="true" tabindex="-1"></a>        saved_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb15-935"><a href="#cb15-935" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-936"><a href="#cb15-936" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> conv <span class="kw">in</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb15-937"><a href="#cb15-937" aria-hidden="true" tabindex="-1"></a>            safe_title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(conv[<span class="st">&#39;title&#39;</span>])</span>
<span id="cb15-938"><a href="#cb15-938" aria-hidden="true" tabindex="-1"></a>            filename <span class="op">=</span> <span class="ss">f&quot;</span><span class="sc">{</span>conv[<span class="st">&#39;number&#39;</span>]<span class="sc">:03d}</span><span class="ss">_</span><span class="sc">{</span>conv[<span class="st">&#39;source&#39;</span>]<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>safe_title<span class="sc">}</span><span class="ss">.json&quot;</span></span>
<span id="cb15-939"><a href="#cb15-939" aria-hidden="true" tabindex="-1"></a>            filepath <span class="op">=</span> Path(folder) <span class="op">/</span> filename</span>
<span id="cb15-940"><a href="#cb15-940" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb15-941"><a href="#cb15-941" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.force_overwrite <span class="kw">and</span> filepath.exists():</span>
<span id="cb15-942"><a href="#cb15-942" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span></span>
<span id="cb15-943"><a href="#cb15-943" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb15-944"><a href="#cb15-944" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(filepath, <span class="st">&#39;w&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb15-945"><a href="#cb15-945" aria-hidden="true" tabindex="-1"></a>                json.dump(conv, f, ensure_ascii<span class="op">=</span><span class="va">False</span>, indent<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb15-946"><a href="#cb15-946" aria-hidden="true" tabindex="-1"></a>            saved_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb15-947"><a href="#cb15-947" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb15-948"><a href="#cb15-948" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ JSON: </span><span class="sc">{</span>saved_count<span class="sc">}</span><span class="ss"> arquivos criados em &#39;</span><span class="sc">{</span>folder<span class="sc">}</span><span class="ss">&#39;&quot;</span>)</span>
<span id="cb15-949"><a href="#cb15-949" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-950"><a href="#cb15-950" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> save_all_to_single_files(<span class="va">self</span>):</span>
<span id="cb15-951"><a href="#cb15-951" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Salva todas as conversas em arquivos √∫nicos CSV e JSON&quot;&quot;&quot;</span></span>
<span id="cb15-952"><a href="#cb15-952" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb15-953"><a href="#cb15-953" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;üß™ [DRY-RUN] Arquivos √∫nicos seriam criados:&quot;</span>)</span>
<span id="cb15-954"><a href="#cb15-954" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;   üìÅ </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>single_files[<span class="st">&#39;csv&#39;</span>]<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb15-955"><a href="#cb15-955" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;   üìÅ </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>single_files[<span class="st">&#39;json&#39;</span>]<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb15-956"><a href="#cb15-956" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb15-957"><a href="#cb15-957" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb15-958"><a href="#cb15-958" aria-hidden="true" tabindex="-1"></a>        <span class="co"># CSV √∫nico</span></span>
<span id="cb15-959"><a href="#cb15-959" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> <span class="bu">open</span>(<span class="va">self</span>.single_files[<span class="st">&#39;csv&#39;</span>], <span class="st">&#39;w&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>, newline<span class="op">=</span><span class="st">&#39;&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb15-960"><a href="#cb15-960" aria-hidden="true" tabindex="-1"></a>            fieldnames <span class="op">=</span> [</span>
<span id="cb15-961"><a href="#cb15-961" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;conversation_number&#39;</span>, <span class="st">&#39;source&#39;</span>, <span class="st">&#39;conversation_title&#39;</span>, <span class="st">&#39;category&#39;</span>,</span>
<span id="cb15-962"><a href="#cb15-962" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;author&#39;</span>, <span class="st">&#39;role&#39;</span>, <span class="st">&#39;timestamp&#39;</span>, <span class="st">&#39;model&#39;</span>, <span class="st">&#39;content&#39;</span></span>
<span id="cb15-963"><a href="#cb15-963" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb15-964"><a href="#cb15-964" aria-hidden="true" tabindex="-1"></a>            writer <span class="op">=</span> csv.DictWriter(f, fieldnames<span class="op">=</span>fieldnames)</span>
<span id="cb15-965"><a href="#cb15-965" aria-hidden="true" tabindex="-1"></a>            writer.writeheader()</span>
<span id="cb15-966"><a href="#cb15-966" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> conv <span class="kw">in</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb15-967"><a href="#cb15-967" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> msg <span class="kw">in</span> conv[<span class="st">&#39;messages&#39;</span>]:</span>
<span id="cb15-968"><a href="#cb15-968" aria-hidden="true" tabindex="-1"></a>                    writer.writerow({</span>
<span id="cb15-969"><a href="#cb15-969" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;conversation_number&#39;</span>: conv[<span class="st">&#39;number&#39;</span>],</span>
<span id="cb15-970"><a href="#cb15-970" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;source&#39;</span>: conv[<span class="st">&#39;source&#39;</span>],</span>
<span id="cb15-971"><a href="#cb15-971" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;conversation_title&#39;</span>: conv[<span class="st">&#39;title&#39;</span>],</span>
<span id="cb15-972"><a href="#cb15-972" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;category&#39;</span>: conv[<span class="st">&#39;category&#39;</span>],</span>
<span id="cb15-973"><a href="#cb15-973" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;author&#39;</span>: msg[<span class="st">&#39;author&#39;</span>],</span>
<span id="cb15-974"><a href="#cb15-974" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;role&#39;</span>: msg[<span class="st">&#39;role&#39;</span>],</span>
<span id="cb15-975"><a href="#cb15-975" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;timestamp&#39;</span>: msg[<span class="st">&#39;timestamp&#39;</span>],</span>
<span id="cb15-976"><a href="#cb15-976" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;model&#39;</span>: msg[<span class="st">&#39;model&#39;</span>],</span>
<span id="cb15-977"><a href="#cb15-977" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;content&#39;</span>: msg[<span class="st">&#39;content&#39;</span>]</span>
<span id="cb15-978"><a href="#cb15-978" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb15-979"><a href="#cb15-979" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ CSV √∫nico: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>single_files[<span class="st">&#39;csv&#39;</span>]<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb15-980"><a href="#cb15-980" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-981"><a href="#cb15-981" aria-hidden="true" tabindex="-1"></a>        <span class="co"># JSON √∫nico</span></span>
<span id="cb15-982"><a href="#cb15-982" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> <span class="bu">open</span>(<span class="va">self</span>.single_files[<span class="st">&#39;json&#39;</span>], <span class="st">&#39;w&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb15-983"><a href="#cb15-983" aria-hidden="true" tabindex="-1"></a>            json.dump(<span class="va">self</span>.all_conversations, f, ensure_ascii<span class="op">=</span><span class="va">False</span>, indent<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb15-984"><a href="#cb15-984" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ JSON √∫nico: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>single_files[<span class="st">&#39;json&#39;</span>]<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb15-985"><a href="#cb15-985" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-986"><a href="#cb15-986" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_searchable_index(<span class="va">self</span>):</span>
<span id="cb15-987"><a href="#cb15-987" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Cria √≠ndice HTML pesquis√°vel com links para HTML&quot;&quot;&quot;</span></span>
<span id="cb15-988"><a href="#cb15-988" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb15-989"><a href="#cb15-989" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;üß™ [DRY-RUN] √çndice HTML seria criado: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>index_file<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb15-990"><a href="#cb15-990" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb15-991"><a href="#cb15-991" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb15-992"><a href="#cb15-992" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;üéØ Criando √≠ndice HTML combinado...&quot;</span>)</span>
<span id="cb15-993"><a href="#cb15-993" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-994"><a href="#cb15-994" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Estat√≠sticas por categoria</span></span>
<span id="cb15-995"><a href="#cb15-995" aria-hidden="true" tabindex="-1"></a>        category_stats <span class="op">=</span> {}</span>
<span id="cb15-996"><a href="#cb15-996" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> conv <span class="kw">in</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb15-997"><a href="#cb15-997" aria-hidden="true" tabindex="-1"></a>            cat <span class="op">=</span> conv[<span class="st">&#39;category&#39;</span>]</span>
<span id="cb15-998"><a href="#cb15-998" aria-hidden="true" tabindex="-1"></a>            category_stats[cat] <span class="op">=</span> category_stats.get(cat, <span class="dv">0</span>) <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb15-999"><a href="#cb15-999" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-1000"><a href="#cb15-1000" aria-hidden="true" tabindex="-1"></a>        <span class="co"># HTML content com links para HTML</span></span>
<span id="cb15-1001"><a href="#cb15-1001" aria-hidden="true" tabindex="-1"></a>        html_content <span class="op">=</span> <span class="ss">f&quot;&quot;&quot;&lt;!DOCTYPE html&gt;</span></span>
<span id="cb15-1002"><a href="#cb15-1002" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;html lang=&quot;pt-PT&quot;&gt;</span></span>
<span id="cb15-1003"><a href="#cb15-1003" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;head&gt;</span></span>
<span id="cb15-1004"><a href="#cb15-1004" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span></span>
<span id="cb15-1005"><a href="#cb15-1005" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span></span>
<span id="cb15-1006"><a href="#cb15-1006" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;title&gt;√çndice Combinado - AI Chats&lt;/title&gt;</span></span>
<span id="cb15-1007"><a href="#cb15-1007" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;style&gt;</span></span>
<span id="cb15-1008"><a href="#cb15-1008" aria-hidden="true" tabindex="-1"></a><span class="ss">        * </span><span class="ch">{{</span><span class="ss"> margin: 0; padding: 0; box-sizing: border-box; </span><span class="ch">}}</span></span>
<span id="cb15-1009"><a href="#cb15-1009" aria-hidden="true" tabindex="-1"></a><span class="ss">        body </span><span class="ch">{{</span><span class="ss"> font-family: &#39;Segoe UI&#39;, Tahoma, Geneva, Verdana, sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; padding: 20px; color: #333; </span><span class="ch">}}</span></span>
<span id="cb15-1010"><a href="#cb15-1010" aria-hidden="true" tabindex="-1"></a><span class="ss">        .container </span><span class="ch">{{</span><span class="ss"> max-width: 1400px; margin: 0 auto; background: white; border-radius: 15px; box-shadow: 0 20px 40px rgba(0,0,0,0.1); overflow: hidden; </span><span class="ch">}}</span></span>
<span id="cb15-1011"><a href="#cb15-1011" aria-hidden="true" tabindex="-1"></a><span class="ss">        .header </span><span class="ch">{{</span><span class="ss"> background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 40px; text-align: center; </span><span class="ch">}}</span></span>
<span id="cb15-1012"><a href="#cb15-1012" aria-hidden="true" tabindex="-1"></a><span class="ss">        .header h1 </span><span class="ch">{{</span><span class="ss"> font-size: 2.8em; margin-bottom: 15px; font-weight: 300; </span><span class="ch">}}</span></span>
<span id="cb15-1013"><a href="#cb15-1013" aria-hidden="true" tabindex="-1"></a><span class="ss">        .header p </span><span class="ch">{{</span><span class="ss"> font-size: 1.2em; opacity: 0.9; margin-bottom: 20px; </span><span class="ch">}}</span></span>
<span id="cb15-1014"><a href="#cb15-1014" aria-hidden="true" tabindex="-1"></a><span class="ss">        .stats </span><span class="ch">{{</span><span class="ss"> display: flex; justify-content: center; gap: 30px; margin-top: 25px; flex-wrap: wrap; </span><span class="ch">}}</span></span>
<span id="cb15-1015"><a href="#cb15-1015" aria-hidden="true" tabindex="-1"></a><span class="ss">        .stat-item </span><span class="ch">{{</span><span class="ss"> background: rgba(255,255,255,0.15); padding: 18px 28px; border-radius: 12px; backdrop-filter: blur(10px); font-size: 1.1em; </span><span class="ch">}}</span></span>
<span id="cb15-1016"><a href="#cb15-1016" aria-hidden="true" tabindex="-1"></a><span class="ss">        .search-section </span><span class="ch">{{</span><span class="ss"> padding: 30px; background: #f8f9fa; border-bottom: 1px solid #e9ecef; </span><span class="ch">}}</span></span>
<span id="cb15-1017"><a href="#cb15-1017" aria-hidden="true" tabindex="-1"></a><span class="ss">        .search-box </span><span class="ch">{{</span><span class="ss"> width: 100%; padding: 18px 25px; font-size: 16px; border: 2px solid #e9ecef; border-radius: 25px; outline: none; transition: all 0.3s ease; font-family: inherit; </span><span class="ch">}}</span></span>
<span id="cb15-1018"><a href="#cb15-1018" aria-hidden="true" tabindex="-1"></a><span class="ss">        .search-box:focus </span><span class="ch">{{</span><span class="ss"> border-color: #667eea; box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1); </span><span class="ch">}}</span></span>
<span id="cb15-1019"><a href="#cb15-1019" aria-hidden="true" tabindex="-1"></a><span class="ss">        .filter-section </span><span class="ch">{{</span></span>
<span id="cb15-1020"><a href="#cb15-1020" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 20px 30px;</span></span>
<span id="cb15-1021"><a href="#cb15-1021" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: flex;</span></span>
<span id="cb15-1022"><a href="#cb15-1022" aria-hidden="true" tabindex="-1"></a><span class="ss">            flex-wrap: wrap;</span></span>
<span id="cb15-1023"><a href="#cb15-1023" aria-hidden="true" tabindex="-1"></a><span class="ss">            gap: 12px;</span></span>
<span id="cb15-1024"><a href="#cb15-1024" aria-hidden="true" tabindex="-1"></a><span class="ss">            justify-content: center;</span></span>
<span id="cb15-1025"><a href="#cb15-1025" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #f8f9fa;</span></span>
<span id="cb15-1026"><a href="#cb15-1026" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-bottom: 1px solid #e9ecef;</span></span>
<span id="cb15-1027"><a href="#cb15-1027" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb15-1028"><a href="#cb15-1028" aria-hidden="true" tabindex="-1"></a><span class="ss">        .filter-btn </span><span class="ch">{{</span></span>
<span id="cb15-1029"><a href="#cb15-1029" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 10px 20px;</span></span>
<span id="cb15-1030"><a href="#cb15-1030" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: white;</span></span>
<span id="cb15-1031"><a href="#cb15-1031" aria-hidden="true" tabindex="-1"></a><span class="ss">            border: 2px solid #e9ecef;</span></span>
<span id="cb15-1032"><a href="#cb15-1032" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 25px;</span></span>
<span id="cb15-1033"><a href="#cb15-1033" aria-hidden="true" tabindex="-1"></a><span class="ss">            cursor: pointer;</span></span>
<span id="cb15-1034"><a href="#cb15-1034" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.95em;</span></span>
<span id="cb15-1035"><a href="#cb15-1035" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-weight: 500;</span></span>
<span id="cb15-1036"><a href="#cb15-1036" aria-hidden="true" tabindex="-1"></a><span class="ss">            transition: all 0.3s ease;</span></span>
<span id="cb15-1037"><a href="#cb15-1037" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-family: inherit;</span></span>
<span id="cb15-1038"><a href="#cb15-1038" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb15-1039"><a href="#cb15-1039" aria-hidden="true" tabindex="-1"></a><span class="ss">        .filter-btn.active, .filter-btn:hover </span><span class="ch">{{</span></span>
<span id="cb15-1040"><a href="#cb15-1040" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #667eea;</span></span>
<span id="cb15-1041"><a href="#cb15-1041" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: white;</span></span>
<span id="cb15-1042"><a href="#cb15-1042" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-color: #667eea;</span></span>
<span id="cb15-1043"><a href="#cb15-1043" aria-hidden="true" tabindex="-1"></a><span class="ss">            transform: translateY(-2px);</span></span>
<span id="cb15-1044"><a href="#cb15-1044" aria-hidden="true" tabindex="-1"></a><span class="ss">            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);</span></span>
<span id="cb15-1045"><a href="#cb15-1045" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb15-1046"><a href="#cb15-1046" aria-hidden="true" tabindex="-1"></a><span class="ss">        .conversations-grid </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb15-1047"><a href="#cb15-1047" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: grid; </span></span>
<span id="cb15-1048"><a href="#cb15-1048" aria-hidden="true" tabindex="-1"></a><span class="ss">            grid-template-columns: repeat(auto-fill, minmax(380px, 1fr)); </span></span>
<span id="cb15-1049"><a href="#cb15-1049" aria-hidden="true" tabindex="-1"></a><span class="ss">            gap: 25px; </span></span>
<span id="cb15-1050"><a href="#cb15-1050" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 35px;</span></span>
<span id="cb15-1051"><a href="#cb15-1051" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);</span></span>
<span id="cb15-1052"><a href="#cb15-1052" aria-hidden="true" tabindex="-1"></a><span class="ss">            min-height: 400px;</span></span>
<span id="cb15-1053"><a href="#cb15-1053" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb15-1054"><a href="#cb15-1054" aria-hidden="true" tabindex="-1"></a><span class="ss">        .conversation-card </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb15-1055"><a href="#cb15-1055" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: white; </span></span>
<span id="cb15-1056"><a href="#cb15-1056" aria-hidden="true" tabindex="-1"></a><span class="ss">            border: 1px solid #e9ecef; </span></span>
<span id="cb15-1057"><a href="#cb15-1057" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 15px; </span></span>
<span id="cb15-1058"><a href="#cb15-1058" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 25px; </span></span>
<span id="cb15-1059"><a href="#cb15-1059" aria-hidden="true" tabindex="-1"></a><span class="ss">            transition: all 0.4s ease; </span></span>
<span id="cb15-1060"><a href="#cb15-1060" aria-hidden="true" tabindex="-1"></a><span class="ss">            cursor: pointer; </span></span>
<span id="cb15-1061"><a href="#cb15-1061" aria-hidden="true" tabindex="-1"></a><span class="ss">            position: relative;</span></span>
<span id="cb15-1062"><a href="#cb15-1062" aria-hidden="true" tabindex="-1"></a><span class="ss">            box-shadow: 0 5px 15px rgba(0,0,0,0.08);</span></span>
<span id="cb15-1063"><a href="#cb15-1063" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb15-1064"><a href="#cb15-1064" aria-hidden="true" tabindex="-1"></a><span class="ss">        .conversation-card:hover </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb15-1065"><a href="#cb15-1065" aria-hidden="true" tabindex="-1"></a><span class="ss">            transform: translateY(-8px); </span></span>
<span id="cb15-1066"><a href="#cb15-1066" aria-hidden="true" tabindex="-1"></a><span class="ss">            box-shadow: 0 15px 35px rgba(0,0,0,0.15); </span></span>
<span id="cb15-1067"><a href="#cb15-1067" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-color: #667eea;</span></span>
<span id="cb15-1068"><a href="#cb15-1068" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb15-1069"><a href="#cb15-1069" aria-hidden="true" tabindex="-1"></a><span class="ss">        .card-header </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb15-1070"><a href="#cb15-1070" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: flex; </span></span>
<span id="cb15-1071"><a href="#cb15-1071" aria-hidden="true" tabindex="-1"></a><span class="ss">            justify-content: space-between; </span></span>
<span id="cb15-1072"><a href="#cb15-1072" aria-hidden="true" tabindex="-1"></a><span class="ss">            align-items: flex-start; </span></span>
<span id="cb15-1073"><a href="#cb15-1073" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-bottom: 18px; </span></span>
<span id="cb15-1074"><a href="#cb15-1074" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb15-1075"><a href="#cb15-1075" aria-hidden="true" tabindex="-1"></a><span class="ss">        .card-number </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb15-1076"><a href="#cb15-1076" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: linear-gradient(135deg, #667eea, #764ba2); </span></span>
<span id="cb15-1077"><a href="#cb15-1077" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: white; </span></span>
<span id="cb15-1078"><a href="#cb15-1078" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 8px 16px; </span></span>
<span id="cb15-1079"><a href="#cb15-1079" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 20px; </span></span>
<span id="cb15-1080"><a href="#cb15-1080" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.9em; </span></span>
<span id="cb15-1081"><a href="#cb15-1081" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-weight: bold;</span></span>
<span id="cb15-1082"><a href="#cb15-1082" aria-hidden="true" tabindex="-1"></a><span class="ss">            box-shadow: 0 3px 10px rgba(102, 126, 234, 0.3);</span></span>
<span id="cb15-1083"><a href="#cb15-1083" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb15-1084"><a href="#cb15-1084" aria-hidden="true" tabindex="-1"></a><span class="ss">        .card-source </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb15-1085"><a href="#cb15-1085" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #e3f2fd; </span></span>
<span id="cb15-1086"><a href="#cb15-1086" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #1976d2; </span></span>
<span id="cb15-1087"><a href="#cb15-1087" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 5px 12px; </span></span>
<span id="cb15-1088"><a href="#cb15-1088" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 12px; </span></span>
<span id="cb15-1089"><a href="#cb15-1089" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.85em; </span></span>
<span id="cb15-1090"><a href="#cb15-1090" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-weight: bold; </span></span>
<span id="cb15-1091"><a href="#cb15-1091" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-left: 10px;</span></span>
<span id="cb15-1092"><a href="#cb15-1092" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb15-1093"><a href="#cb15-1093" aria-hidden="true" tabindex="-1"></a><span class="ss">        .card-title </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb15-1094"><a href="#cb15-1094" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 1.3em; </span></span>
<span id="cb15-1095"><a href="#cb15-1095" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-weight: 600; </span></span>
<span id="cb15-1096"><a href="#cb15-1096" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #2c3e50; </span></span>
<span id="cb15-1097"><a href="#cb15-1097" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-bottom: 12px; </span></span>
<span id="cb15-1098"><a href="#cb15-1098" aria-hidden="true" tabindex="-1"></a><span class="ss">            line-height: 1.4;</span></span>
<span id="cb15-1099"><a href="#cb15-1099" aria-hidden="true" tabindex="-1"></a><span class="ss">            min-height: 3.6em;</span></span>
<span id="cb15-1100"><a href="#cb15-1100" aria-hidden="true" tabindex="-1"></a><span class="ss">            cursor: pointer;</span></span>
<span id="cb15-1101"><a href="#cb15-1101" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb15-1102"><a href="#cb15-1102" aria-hidden="true" tabindex="-1"></a><span class="ss">        .card-summary </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb15-1103"><a href="#cb15-1103" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #6c757d; </span></span>
<span id="cb15-1104"><a href="#cb15-1104" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.95em; </span></span>
<span id="cb15-1105"><a href="#cb15-1105" aria-hidden="true" tabindex="-1"></a><span class="ss">            line-height: 1.5; </span></span>
<span id="cb15-1106"><a href="#cb15-1106" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-bottom: 18px;</span></span>
<span id="cb15-1107"><a href="#cb15-1107" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: -webkit-box;</span></span>
<span id="cb15-1108"><a href="#cb15-1108" aria-hidden="true" tabindex="-1"></a><span class="ss">            -webkit-line-clamp: 3;</span></span>
<span id="cb15-1109"><a href="#cb15-1109" aria-hidden="true" tabindex="-1"></a><span class="ss">            -webkit-box-orient: vertical;</span></span>
<span id="cb15-1110"><a href="#cb15-1110" aria-hidden="true" tabindex="-1"></a><span class="ss">            overflow: hidden;</span></span>
<span id="cb15-1111"><a href="#cb15-1111" aria-hidden="true" tabindex="-1"></a><span class="ss">            cursor: pointer;</span></span>
<span id="cb15-1112"><a href="#cb15-1112" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb15-1113"><a href="#cb15-1113" aria-hidden="true" tabindex="-1"></a><span class="ss">        .card-meta </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb15-1114"><a href="#cb15-1114" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: flex; </span></span>
<span id="cb15-1115"><a href="#cb15-1115" aria-hidden="true" tabindex="-1"></a><span class="ss">            justify-content: space-between; </span></span>
<span id="cb15-1116"><a href="#cb15-1116" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.85em; </span></span>
<span id="cb15-1117"><a href="#cb15-1117" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #868e96; </span></span>
<span id="cb15-1118"><a href="#cb15-1118" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-top: 1px solid #e9ecef; </span></span>
<span id="cb15-1119"><a href="#cb15-1119" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding-top: 18px;</span></span>
<span id="cb15-1120"><a href="#cb15-1120" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb15-1121"><a href="#cb15-1121" aria-hidden="true" tabindex="-1"></a><span class="ss">        .card-actions </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb15-1122"><a href="#cb15-1122" aria-hidden="true" tabindex="-1"></a><span class="ss">            position: absolute; </span></span>
<span id="cb15-1123"><a href="#cb15-1123" aria-hidden="true" tabindex="-1"></a><span class="ss">            top: 20px; </span></span>
<span id="cb15-1124"><a href="#cb15-1124" aria-hidden="true" tabindex="-1"></a><span class="ss">            right: 20px; </span></span>
<span id="cb15-1125"><a href="#cb15-1125" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: flex; </span></span>
<span id="cb15-1126"><a href="#cb15-1126" aria-hidden="true" tabindex="-1"></a><span class="ss">            gap: 8px; </span></span>
<span id="cb15-1127"><a href="#cb15-1127" aria-hidden="true" tabindex="-1"></a><span class="ss">            opacity: 0; </span></span>
<span id="cb15-1128"><a href="#cb15-1128" aria-hidden="true" tabindex="-1"></a><span class="ss">            transition: opacity 0.3s ease; </span></span>
<span id="cb15-1129"><a href="#cb15-1129" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb15-1130"><a href="#cb15-1130" aria-hidden="true" tabindex="-1"></a><span class="ss">        .conversation-card:hover .card-actions </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb15-1131"><a href="#cb15-1131" aria-hidden="true" tabindex="-1"></a><span class="ss">            opacity: 1; </span></span>
<span id="cb15-1132"><a href="#cb15-1132" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb15-1133"><a href="#cb15-1133" aria-hidden="true" tabindex="-1"></a><span class="ss">        .action-btn </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb15-1134"><a href="#cb15-1134" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: white; </span></span>
<span id="cb15-1135"><a href="#cb15-1135" aria-hidden="true" tabindex="-1"></a><span class="ss">            border: 2px solid #e9ecef; </span></span>
<span id="cb15-1136"><a href="#cb15-1136" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 8px; </span></span>
<span id="cb15-1137"><a href="#cb15-1137" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 6px 12px; </span></span>
<span id="cb15-1138"><a href="#cb15-1138" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.8em; </span></span>
<span id="cb15-1139"><a href="#cb15-1139" aria-hidden="true" tabindex="-1"></a><span class="ss">            cursor: pointer; </span></span>
<span id="cb15-1140"><a href="#cb15-1140" aria-hidden="true" tabindex="-1"></a><span class="ss">            transition: all 0.3s ease;</span></span>
<span id="cb15-1141"><a href="#cb15-1141" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-weight: 500;</span></span>
<span id="cb15-1142"><a href="#cb15-1142" aria-hidden="true" tabindex="-1"></a><span class="ss">            text-decoration: none;</span></span>
<span id="cb15-1143"><a href="#cb15-1143" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #333;</span></span>
<span id="cb15-1144"><a href="#cb15-1144" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: inline-block;</span></span>
<span id="cb15-1145"><a href="#cb15-1145" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb15-1146"><a href="#cb15-1146" aria-hidden="true" tabindex="-1"></a><span class="ss">        .action-btn:hover </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb15-1147"><a href="#cb15-1147" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #667eea; </span></span>
<span id="cb15-1148"><a href="#cb15-1148" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: white; </span></span>
<span id="cb15-1149"><a href="#cb15-1149" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-color: #667eea;</span></span>
<span id="cb15-1150"><a href="#cb15-1150" aria-hidden="true" tabindex="-1"></a><span class="ss">            transform: scale(1.05);</span></span>
<span id="cb15-1151"><a href="#cb15-1151" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb15-1152"><a href="#cb15-1152" aria-hidden="true" tabindex="-1"></a><span class="ss">        .recent-badge </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb15-1153"><a href="#cb15-1153" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #ff6b6b; </span></span>
<span id="cb15-1154"><a href="#cb15-1154" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: white; </span></span>
<span id="cb15-1155"><a href="#cb15-1155" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 3px 10px; </span></span>
<span id="cb15-1156"><a href="#cb15-1156" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 12px; </span></span>
<span id="cb15-1157"><a href="#cb15-1157" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.75em; </span></span>
<span id="cb15-1158"><a href="#cb15-1158" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-left: 8px;</span></span>
<span id="cb15-1159"><a href="#cb15-1159" aria-hidden="true" tabindex="-1"></a><span class="ss">            animation: pulse 2s infinite;</span></span>
<span id="cb15-1160"><a href="#cb15-1160" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb15-1161"><a href="#cb15-1161" aria-hidden="true" tabindex="-1"></a><span class="ss">        .no-results </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb15-1162"><a href="#cb15-1162" aria-hidden="true" tabindex="-1"></a><span class="ss">            text-align: center; </span></span>
<span id="cb15-1163"><a href="#cb15-1163" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 60px 20px; </span></span>
<span id="cb15-1164"><a href="#cb15-1164" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #6c757d;</span></span>
<span id="cb15-1165"><a href="#cb15-1165" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 1.1em;</span></span>
<span id="cb15-1166"><a href="#cb15-1166" aria-hidden="true" tabindex="-1"></a><span class="ss">            grid-column: 1 / -1;</span></span>
<span id="cb15-1167"><a href="#cb15-1167" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb15-1168"><a href="#cb15-1168" aria-hidden="true" tabindex="-1"></a><span class="ss">        @keyframes pulse </span><span class="ch">{{</span></span>
<span id="cb15-1169"><a href="#cb15-1169" aria-hidden="true" tabindex="-1"></a><span class="ss">            0% </span><span class="ch">{{</span><span class="ss"> transform: scale(1); </span><span class="ch">}}</span></span>
<span id="cb15-1170"><a href="#cb15-1170" aria-hidden="true" tabindex="-1"></a><span class="ss">            50% </span><span class="ch">{{</span><span class="ss"> transform: scale(1.05); </span><span class="ch">}}</span></span>
<span id="cb15-1171"><a href="#cb15-1171" aria-hidden="true" tabindex="-1"></a><span class="ss">            100% </span><span class="ch">{{</span><span class="ss"> transform: scale(1); </span><span class="ch">}}</span></span>
<span id="cb15-1172"><a href="#cb15-1172" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb15-1173"><a href="#cb15-1173" aria-hidden="true" tabindex="-1"></a><span class="ss">        .category-badge </span><span class="ch">{{</span></span>
<span id="cb15-1174"><a href="#cb15-1174" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: inline-block;</span></span>
<span id="cb15-1175"><a href="#cb15-1175" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #e3f2fd;</span></span>
<span id="cb15-1176"><a href="#cb15-1176" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #1976d2;</span></span>
<span id="cb15-1177"><a href="#cb15-1177" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 4px 10px;</span></span>
<span id="cb15-1178"><a href="#cb15-1178" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 12px;</span></span>
<span id="cb15-1179"><a href="#cb15-1179" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.8em;</span></span>
<span id="cb15-1180"><a href="#cb15-1180" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-left: 8px;</span></span>
<span id="cb15-1181"><a href="#cb15-1181" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-weight: 500;</span></span>
<span id="cb15-1182"><a href="#cb15-1182" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb15-1183"><a href="#cb15-1183" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb15-1184"><a href="#cb15-1184" aria-hidden="true" tabindex="-1"></a><span class="ss">        .direct-link </span><span class="ch">{{</span></span>
<span id="cb15-1185"><a href="#cb15-1185" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: inline-block;</span></span>
<span id="cb15-1186"><a href="#cb15-1186" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin: 5px;</span></span>
<span id="cb15-1187"><a href="#cb15-1187" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 8px 15px;</span></span>
<span id="cb15-1188"><a href="#cb15-1188" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #28a745;</span></span>
<span id="cb15-1189"><a href="#cb15-1189" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: white;</span></span>
<span id="cb15-1190"><a href="#cb15-1190" aria-hidden="true" tabindex="-1"></a><span class="ss">            text-decoration: none;</span></span>
<span id="cb15-1191"><a href="#cb15-1191" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 5px;</span></span>
<span id="cb15-1192"><a href="#cb15-1192" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.9em;</span></span>
<span id="cb15-1193"><a href="#cb15-1193" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb15-1194"><a href="#cb15-1194" aria-hidden="true" tabindex="-1"></a><span class="ss">        .direct-link:hover </span><span class="ch">{{</span></span>
<span id="cb15-1195"><a href="#cb15-1195" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #218838;</span></span>
<span id="cb15-1196"><a href="#cb15-1196" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb15-1197"><a href="#cb15-1197" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb15-1198"><a href="#cb15-1198" aria-hidden="true" tabindex="-1"></a><span class="ss">        /* Estilo para link HTML */</span></span>
<span id="cb15-1199"><a href="#cb15-1199" aria-hidden="true" tabindex="-1"></a><span class="ss">        .html-btn </span><span class="ch">{{</span></span>
<span id="cb15-1200"><a href="#cb15-1200" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #17a2b8;</span></span>
<span id="cb15-1201"><a href="#cb15-1201" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: white;</span></span>
<span id="cb15-1202"><a href="#cb15-1202" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb15-1203"><a href="#cb15-1203" aria-hidden="true" tabindex="-1"></a><span class="ss">        .html-btn:hover </span><span class="ch">{{</span></span>
<span id="cb15-1204"><a href="#cb15-1204" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #138496;</span></span>
<span id="cb15-1205"><a href="#cb15-1205" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb15-1206"><a href="#cb15-1206" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;/style&gt;</span></span>
<span id="cb15-1207"><a href="#cb15-1207" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;/head&gt;</span></span>
<span id="cb15-1208"><a href="#cb15-1208" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;body&gt;</span></span>
<span id="cb15-1209"><a href="#cb15-1209" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;div class=&quot;container&quot;&gt;</span></span>
<span id="cb15-1210"><a href="#cb15-1210" aria-hidden="true" tabindex="-1"></a><span class="ss">        &lt;div class=&quot;header&quot;&gt;</span></span>
<span id="cb15-1211"><a href="#cb15-1211" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;h1&gt;üìö √çndice Combinado de Conversas&lt;/h1&gt;</span></span>
<span id="cb15-1212"><a href="#cb15-1212" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;p&gt;Qwen3 ‚Ä¢ ChatGPT ‚Ä¢ DeepSeek ‚Ä¢ Grok ‚Ä¢ COM HTML (Pandoc)&lt;/p&gt;</span></span>
<span id="cb15-1213"><a href="#cb15-1213" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;div class=&quot;stats&quot;&gt;</span></span>
<span id="cb15-1214"><a href="#cb15-1214" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;div class=&quot;stat-item&quot;&gt;</span></span>
<span id="cb15-1215"><a href="#cb15-1215" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;strong&gt;Total:&lt;/strong&gt; &lt;span id=&quot;total-count&quot;&gt;</span><span class="sc">{</span><span class="bu">len</span>(<span class="va">self</span>.all_conversations)<span class="sc">}</span><span class="ss">&lt;/span&gt; conversas</span></span>
<span id="cb15-1216"><a href="#cb15-1216" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;/div&gt;</span></span>
<span id="cb15-1217"><a href="#cb15-1217" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;div class=&quot;stat-item&quot;&gt;</span></span>
<span id="cb15-1218"><a href="#cb15-1218" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;strong&gt;Ordena√ß√£o:&lt;/strong&gt; Mais Recentes Primeiro</span></span>
<span id="cb15-1219"><a href="#cb15-1219" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;/div&gt;</span></span>
<span id="cb15-1220"><a href="#cb15-1220" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;div class=&quot;stat-item&quot;&gt;</span></span>
<span id="cb15-1221"><a href="#cb15-1221" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;strong&gt;Atualizado:&lt;/strong&gt; </span><span class="sc">{</span>datetime<span class="sc">.</span>now()<span class="sc">.</span>strftime(<span class="st">&#39;</span><span class="sc">%d</span><span class="st">/%m/%Y %H:%M&#39;</span>)<span class="sc">}</span></span>
<span id="cb15-1222"><a href="#cb15-1222" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;/div&gt;</span></span>
<span id="cb15-1223"><a href="#cb15-1223" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;/div&gt;</span></span>
<span id="cb15-1224"><a href="#cb15-1224" aria-hidden="true" tabindex="-1"></a><span class="ss">        &lt;/div&gt;</span></span>
<span id="cb15-1225"><a href="#cb15-1225" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb15-1226"><a href="#cb15-1226" aria-hidden="true" tabindex="-1"></a><span class="ss">        &lt;div class=&quot;search-section&quot;&gt;</span></span>
<span id="cb15-1227"><a href="#cb15-1227" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;input type=&quot;text&quot; id=&quot;searchInput&quot; class=&quot;search-box&quot; placeholder=&quot;üîç Pesquisar por t√≠tulo, conte√∫do ou categoria...&quot;&gt;</span></span>
<span id="cb15-1228"><a href="#cb15-1228" aria-hidden="true" tabindex="-1"></a><span class="ss">        &lt;/div&gt;</span></span>
<span id="cb15-1229"><a href="#cb15-1229" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb15-1230"><a href="#cb15-1230" aria-hidden="true" tabindex="-1"></a><span class="ss">        &lt;div class=&quot;filter-section&quot;&gt;</span></span>
<span id="cb15-1231"><a href="#cb15-1231" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;button class=&quot;filter-btn active&quot; data-filter=&quot;todas&quot;&gt;Todas (</span><span class="sc">{</span><span class="bu">len</span>(<span class="va">self</span>.all_conversations)<span class="sc">}</span><span class="ss">)&lt;/button&gt;</span></span>
<span id="cb15-1232"><a href="#cb15-1232" aria-hidden="true" tabindex="-1"></a><span class="ss">&quot;&quot;&quot;</span></span>
<span id="cb15-1233"><a href="#cb15-1233" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-1234"><a href="#cb15-1234" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Bot√µes de filtro por categoria</span></span>
<span id="cb15-1235"><a href="#cb15-1235" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> category, count <span class="kw">in</span> category_stats.items():</span>
<span id="cb15-1236"><a href="#cb15-1236" aria-hidden="true" tabindex="-1"></a>            html_content <span class="op">+=</span> <span class="ss">f&#39;&lt;button class=&quot;filter-btn&quot; data-filter=&quot;</span><span class="sc">{</span>category<span class="sc">.</span>lower()<span class="sc">}</span><span class="ss">&quot;&gt;</span><span class="sc">{</span>category<span class="sc">}</span><span class="ss"> (</span><span class="sc">{</span>count<span class="sc">}</span><span class="ss">)&lt;/button&gt;</span><span class="ch">\n</span><span class="ss">&#39;</span></span>
<span id="cb15-1237"><a href="#cb15-1237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-1238"><a href="#cb15-1238" aria-hidden="true" tabindex="-1"></a>        html_content <span class="op">+=</span> <span class="st">&quot;&quot;&quot;</span></span>
<span id="cb15-1239"><a href="#cb15-1239" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;/div&gt;</span></span>
<span id="cb15-1240"><a href="#cb15-1240" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb15-1241"><a href="#cb15-1241" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;!-- LINKS DIRETOS DE FALLBACK --&gt;</span></span>
<span id="cb15-1242"><a href="#cb15-1242" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;div style=&quot;text-align: center; padding: 15px; background: #e9ecef; border-bottom: 1px solid #ddd;&quot;&gt;</span></span>
<span id="cb15-1243"><a href="#cb15-1243" aria-hidden="true" tabindex="-1"></a><span class="st">            &lt;strong&gt;Acesso R√°pido:&lt;/strong&gt;</span></span>
<span id="cb15-1244"><a href="#cb15-1244" aria-hidden="true" tabindex="-1"></a><span class="st">            &lt;a href=&quot;combined_markdown/&quot; class=&quot;direct-link&quot; target=&quot;_blank&quot;&gt;üìÅ Markdown&lt;/a&gt;</span></span>
<span id="cb15-1245"><a href="#cb15-1245" aria-hidden="true" tabindex="-1"></a><span class="st">            &lt;a href=&quot;combined_html/&quot; class=&quot;direct-link&quot; target=&quot;_blank&quot;&gt;üåê HTML&lt;/a&gt;</span></span>
<span id="cb15-1246"><a href="#cb15-1246" aria-hidden="true" tabindex="-1"></a><span class="st">            &lt;a href=&quot;combined_pdfs/&quot; class=&quot;direct-link&quot; target=&quot;_blank&quot;&gt;üìä PDFs&lt;/a&gt;</span></span>
<span id="cb15-1247"><a href="#cb15-1247" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;/div&gt;</span></span>
<span id="cb15-1248"><a href="#cb15-1248" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb15-1249"><a href="#cb15-1249" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;div class=&quot;conversations-grid&quot; id=&quot;conversationsGrid&quot;&gt;</span></span>
<span id="cb15-1250"><a href="#cb15-1250" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;&quot;&quot;</span></span>
<span id="cb15-1251"><a href="#cb15-1251" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-1252"><a href="#cb15-1252" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Cards das conversas - COM LINK HTML</span></span>
<span id="cb15-1253"><a href="#cb15-1253" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, conv <span class="kw">in</span> <span class="bu">enumerate</span>(<span class="va">self</span>.all_conversations):</span>
<span id="cb15-1254"><a href="#cb15-1254" aria-hidden="true" tabindex="-1"></a>            safe_title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(conv[<span class="st">&#39;title&#39;</span>])</span>
<span id="cb15-1255"><a href="#cb15-1255" aria-hidden="true" tabindex="-1"></a>            filename <span class="op">=</span> <span class="ss">f&quot;</span><span class="sc">{</span>conv[<span class="st">&#39;number&#39;</span>]<span class="sc">:03d}</span><span class="ss">_</span><span class="sc">{</span>conv[<span class="st">&#39;source&#39;</span>]<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>safe_title<span class="sc">}</span><span class="ss">&quot;</span></span>
<span id="cb15-1256"><a href="#cb15-1256" aria-hidden="true" tabindex="-1"></a>            recent_badge <span class="op">=</span> <span class="st">&quot;&lt;span class=&#39;recent-badge&#39;&gt;NOVO&lt;/span&gt;&quot;</span> <span class="cf">if</span> i <span class="op">&lt;</span> <span class="dv">5</span> <span class="cf">else</span> <span class="st">&quot;&quot;</span></span>
<span id="cb15-1257"><a href="#cb15-1257" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb15-1258"><a href="#cb15-1258" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Resumo mais informativo</span></span>
<span id="cb15-1259"><a href="#cb15-1259" aria-hidden="true" tabindex="-1"></a>            summary <span class="op">=</span> conv.get(<span class="st">&#39;summary&#39;</span>, <span class="st">&#39;Sem resumo dispon√≠vel&#39;</span>)</span>
<span id="cb15-1260"><a href="#cb15-1260" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">len</span>(summary) <span class="op">&gt;</span> <span class="dv">150</span>:</span>
<span id="cb15-1261"><a href="#cb15-1261" aria-hidden="true" tabindex="-1"></a>                summary <span class="op">=</span> summary[:<span class="dv">150</span>] <span class="op">+</span> <span class="st">&quot;...&quot;</span></span>
<span id="cb15-1262"><a href="#cb15-1262" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb15-1263"><a href="#cb15-1263" aria-hidden="true" tabindex="-1"></a>            html_content <span class="op">+=</span> <span class="ss">f&quot;&quot;&quot;</span></span>
<span id="cb15-1264"><a href="#cb15-1264" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;div class=&quot;conversation-card&quot; data-title=&quot;</span><span class="sc">{</span>conv[<span class="st">&#39;title&#39;</span>]<span class="sc">}</span><span class="ss">&quot; data-summary=&quot;</span><span class="sc">{</span>summary<span class="sc">}</span><span class="ss">&quot; data-source=&quot;</span><span class="sc">{</span>conv[<span class="st">&#39;source&#39;</span>]<span class="sc">.</span>lower()<span class="sc">}</span><span class="ss">&quot; data-category=&quot;</span><span class="sc">{</span>conv[<span class="st">&#39;category&#39;</span>]<span class="sc">.</span>lower()<span class="sc">}</span><span class="ss">&quot;&gt;</span></span>
<span id="cb15-1265"><a href="#cb15-1265" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;div class=&quot;card-header&quot;&gt;</span></span>
<span id="cb15-1266"><a href="#cb15-1266" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;div class=&quot;card-number&quot;&gt;#</span><span class="sc">{</span>conv[<span class="st">&#39;number&#39;</span>]<span class="sc">}</span><span class="ss"> </span><span class="sc">{</span>recent_badge<span class="sc">}</span><span class="ss">&lt;/div&gt;</span></span>
<span id="cb15-1267"><a href="#cb15-1267" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;div class=&quot;card-actions&quot;&gt;</span></span>
<span id="cb15-1268"><a href="#cb15-1268" aria-hidden="true" tabindex="-1"></a><span class="ss">                        &lt;a href=&quot;combined_markdown/</span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">.md&quot; class=&quot;action-btn&quot; target=&quot;_blank&quot; onclick=&quot;event.stopPropagation();&quot;&gt;üìÑ MD&lt;/a&gt;</span></span>
<span id="cb15-1269"><a href="#cb15-1269" aria-hidden="true" tabindex="-1"></a><span class="ss">                        &lt;a href=&quot;combined_html/</span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">.html&quot; class=&quot;action-btn html-btn&quot; target=&quot;_blank&quot; onclick=&quot;event.stopPropagation();&quot;&gt;üåê HTML&lt;/a&gt;</span></span>
<span id="cb15-1270"><a href="#cb15-1270" aria-hidden="true" tabindex="-1"></a><span class="ss">                        &lt;a href=&quot;combined_pdfs/</span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">.pdf&quot; class=&quot;action-btn&quot; target=&quot;_blank&quot; onclick=&quot;event.stopPropagation();&quot;&gt;üìä PDF&lt;/a&gt;</span></span>
<span id="cb15-1271"><a href="#cb15-1271" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;/div&gt;</span></span>
<span id="cb15-1272"><a href="#cb15-1272" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;/div&gt;</span></span>
<span id="cb15-1273"><a href="#cb15-1273" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;div class=&quot;card-title&quot; onclick=&quot;openHTML(&#39;</span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">.html&#39;)&quot;&gt;</span><span class="sc">{</span>conv[<span class="st">&#39;title&#39;</span>]<span class="sc">}</span><span class="ss">&lt;/div&gt;</span></span>
<span id="cb15-1274"><a href="#cb15-1274" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;div&gt;</span></span>
<span id="cb15-1275"><a href="#cb15-1275" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;span class=&quot;card-source&quot;&gt;</span><span class="sc">{</span>conv[<span class="st">&#39;source&#39;</span>]<span class="sc">}</span><span class="ss">&lt;/span&gt;</span></span>
<span id="cb15-1276"><a href="#cb15-1276" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;span class=&quot;category-badge&quot;&gt;</span><span class="sc">{</span>conv[<span class="st">&#39;category&#39;</span>]<span class="sc">}</span><span class="ss">&lt;/span&gt;</span></span>
<span id="cb15-1277"><a href="#cb15-1277" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;/div&gt;</span></span>
<span id="cb15-1278"><a href="#cb15-1278" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;div class=&quot;card-summary&quot; onclick=&quot;openHTML(&#39;</span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">.html&#39;)&quot;&gt;</span><span class="sc">{</span>summary<span class="sc">}</span><span class="ss">&lt;/div&gt;</span></span>
<span id="cb15-1279"><a href="#cb15-1279" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;div class=&quot;card-meta&quot;&gt;</span></span>
<span id="cb15-1280"><a href="#cb15-1280" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;span&gt;üìÖ </span><span class="sc">{</span>conv<span class="sc">.</span>get(<span class="st">&#39;updated_at&#39;</span>) <span class="kw">or</span> conv<span class="sc">.</span>get(<span class="st">&#39;inserted_at&#39;</span>) <span class="kw">or</span> <span class="st">&#39;N/A&#39;</span><span class="sc">}</span><span class="ss">&lt;/span&gt;</span></span>
<span id="cb15-1281"><a href="#cb15-1281" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;span&gt;üí¨ </span><span class="sc">{</span><span class="bu">len</span>(conv[<span class="st">&#39;messages&#39;</span>])<span class="sc">}</span><span class="ss"> mensagens&lt;/span&gt;</span></span>
<span id="cb15-1282"><a href="#cb15-1282" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;/div&gt;</span></span>
<span id="cb15-1283"><a href="#cb15-1283" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;/div&gt;</span></span>
<span id="cb15-1284"><a href="#cb15-1284" aria-hidden="true" tabindex="-1"></a><span class="ss">            &quot;&quot;&quot;</span></span>
<span id="cb15-1285"><a href="#cb15-1285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-1286"><a href="#cb15-1286" aria-hidden="true" tabindex="-1"></a>        html_content <span class="op">+=</span> <span class="st">&quot;&quot;&quot;</span></span>
<span id="cb15-1287"><a href="#cb15-1287" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;/div&gt;</span></span>
<span id="cb15-1288"><a href="#cb15-1288" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;/div&gt;</span></span>
<span id="cb15-1289"><a href="#cb15-1289" aria-hidden="true" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb15-1290"><a href="#cb15-1290" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;script&gt;</span></span>
<span id="cb15-1291"><a href="#cb15-1291" aria-hidden="true" tabindex="-1"></a><span class="st">        let currentFilter = &#39;todas&#39;;</span></span>
<span id="cb15-1292"><a href="#cb15-1292" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb15-1293"><a href="#cb15-1293" aria-hidden="true" tabindex="-1"></a><span class="st">        // Inicializa√ß√£o</span></span>
<span id="cb15-1294"><a href="#cb15-1294" aria-hidden="true" tabindex="-1"></a><span class="st">        document.addEventListener(&#39;DOMContentLoaded&#39;, function() {</span></span>
<span id="cb15-1295"><a href="#cb15-1295" aria-hidden="true" tabindex="-1"></a><span class="st">            updateStats();</span></span>
<span id="cb15-1296"><a href="#cb15-1296" aria-hidden="true" tabindex="-1"></a><span class="st">        });</span></span>
<span id="cb15-1297"><a href="#cb15-1297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-1298"><a href="#cb15-1298" aria-hidden="true" tabindex="-1"></a><span class="st">        document.querySelectorAll(&#39;.filter-btn&#39;).forEach(btn =&gt; {</span></span>
<span id="cb15-1299"><a href="#cb15-1299" aria-hidden="true" tabindex="-1"></a><span class="st">            btn.addEventListener(&#39;click&#39;, () =&gt; {</span></span>
<span id="cb15-1300"><a href="#cb15-1300" aria-hidden="true" tabindex="-1"></a><span class="st">                document.querySelectorAll(&#39;.filter-btn&#39;).forEach(b =&gt; b.classList.remove(&#39;active&#39;));</span></span>
<span id="cb15-1301"><a href="#cb15-1301" aria-hidden="true" tabindex="-1"></a><span class="st">                btn.classList.add(&#39;active&#39;);</span></span>
<span id="cb15-1302"><a href="#cb15-1302" aria-hidden="true" tabindex="-1"></a><span class="st">                currentFilter = btn.getAttribute(&#39;data-filter&#39;);</span></span>
<span id="cb15-1303"><a href="#cb15-1303" aria-hidden="true" tabindex="-1"></a><span class="st">                filterConversations();</span></span>
<span id="cb15-1304"><a href="#cb15-1304" aria-hidden="true" tabindex="-1"></a><span class="st">            });</span></span>
<span id="cb15-1305"><a href="#cb15-1305" aria-hidden="true" tabindex="-1"></a><span class="st">        });</span></span>
<span id="cb15-1306"><a href="#cb15-1306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-1307"><a href="#cb15-1307" aria-hidden="true" tabindex="-1"></a><span class="st">        document.getElementById(&#39;searchInput&#39;).addEventListener(&#39;input&#39;, filterConversations);</span></span>
<span id="cb15-1308"><a href="#cb15-1308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-1309"><a href="#cb15-1309" aria-hidden="true" tabindex="-1"></a><span class="st">        function filterConversations() {</span></span>
<span id="cb15-1310"><a href="#cb15-1310" aria-hidden="true" tabindex="-1"></a><span class="st">            const term = document.getElementById(&#39;searchInput&#39;).value.toLowerCase();</span></span>
<span id="cb15-1311"><a href="#cb15-1311" aria-hidden="true" tabindex="-1"></a><span class="st">            const cards = document.querySelectorAll(&#39;.conversation-card&#39;);</span></span>
<span id="cb15-1312"><a href="#cb15-1312" aria-hidden="true" tabindex="-1"></a><span class="st">            let visible = 0;</span></span>
<span id="cb15-1313"><a href="#cb15-1313" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb15-1314"><a href="#cb15-1314" aria-hidden="true" tabindex="-1"></a><span class="st">            cards.forEach(card =&gt; {</span></span>
<span id="cb15-1315"><a href="#cb15-1315" aria-hidden="true" tabindex="-1"></a><span class="st">                const title = card.getAttribute(&#39;data-title&#39;).toLowerCase();</span></span>
<span id="cb15-1316"><a href="#cb15-1316" aria-hidden="true" tabindex="-1"></a><span class="st">                const summary = card.getAttribute(&#39;data-summary&#39;).toLowerCase();</span></span>
<span id="cb15-1317"><a href="#cb15-1317" aria-hidden="true" tabindex="-1"></a><span class="st">                const source = card.getAttribute(&#39;data-source&#39;).toLowerCase();</span></span>
<span id="cb15-1318"><a href="#cb15-1318" aria-hidden="true" tabindex="-1"></a><span class="st">                const category = card.getAttribute(&#39;data-category&#39;).toLowerCase();</span></span>
<span id="cb15-1319"><a href="#cb15-1319" aria-hidden="true" tabindex="-1"></a><span class="st">                </span></span>
<span id="cb15-1320"><a href="#cb15-1320" aria-hidden="true" tabindex="-1"></a><span class="st">                const matchesSearch = (title.includes(term) || summary.includes(term) || category.includes(term) || source.includes(term));</span></span>
<span id="cb15-1321"><a href="#cb15-1321" aria-hidden="true" tabindex="-1"></a><span class="st">                const matchesCategory = (currentFilter === &#39;todas&#39; || category === currentFilter);</span></span>
<span id="cb15-1322"><a href="#cb15-1322" aria-hidden="true" tabindex="-1"></a><span class="st">                </span></span>
<span id="cb15-1323"><a href="#cb15-1323" aria-hidden="true" tabindex="-1"></a><span class="st">                if (matchesSearch &amp;&amp; matchesCategory) {</span></span>
<span id="cb15-1324"><a href="#cb15-1324" aria-hidden="true" tabindex="-1"></a><span class="st">                    card.style.display = &#39;block&#39;;</span></span>
<span id="cb15-1325"><a href="#cb15-1325" aria-hidden="true" tabindex="-1"></a><span class="st">                    visible++;</span></span>
<span id="cb15-1326"><a href="#cb15-1326" aria-hidden="true" tabindex="-1"></a><span class="st">                } else {</span></span>
<span id="cb15-1327"><a href="#cb15-1327" aria-hidden="true" tabindex="-1"></a><span class="st">                    card.style.display = &#39;none&#39;;</span></span>
<span id="cb15-1328"><a href="#cb15-1328" aria-hidden="true" tabindex="-1"></a><span class="st">                }</span></span>
<span id="cb15-1329"><a href="#cb15-1329" aria-hidden="true" tabindex="-1"></a><span class="st">            });</span></span>
<span id="cb15-1330"><a href="#cb15-1330" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb15-1331"><a href="#cb15-1331" aria-hidden="true" tabindex="-1"></a><span class="st">            updateStats(visible);</span></span>
<span id="cb15-1332"><a href="#cb15-1332" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb15-1333"><a href="#cb15-1333" aria-hidden="true" tabindex="-1"></a><span class="st">            // Mostra mensagem se n√£o houver resultados</span></span>
<span id="cb15-1334"><a href="#cb15-1334" aria-hidden="true" tabindex="-1"></a><span class="st">            const grid = document.getElementById(&#39;conversationsGrid&#39;);</span></span>
<span id="cb15-1335"><a href="#cb15-1335" aria-hidden="true" tabindex="-1"></a><span class="st">            const noResults = document.getElementById(&#39;no-results-message&#39;);</span></span>
<span id="cb15-1336"><a href="#cb15-1336" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb15-1337"><a href="#cb15-1337" aria-hidden="true" tabindex="-1"></a><span class="st">            if (visible === 0) {</span></span>
<span id="cb15-1338"><a href="#cb15-1338" aria-hidden="true" tabindex="-1"></a><span class="st">                if (!noResults) {</span></span>
<span id="cb15-1339"><a href="#cb15-1339" aria-hidden="true" tabindex="-1"></a><span class="st">                    const noResultsMsg = document.createElement(&#39;div&#39;);</span></span>
<span id="cb15-1340"><a href="#cb15-1340" aria-hidden="true" tabindex="-1"></a><span class="st">                    noResultsMsg.id = &#39;no-results-message&#39;;</span></span>
<span id="cb15-1341"><a href="#cb15-1341" aria-hidden="true" tabindex="-1"></a><span class="st">                    noResultsMsg.className = &#39;no-results&#39;;</span></span>
<span id="cb15-1342"><a href="#cb15-1342" aria-hidden="true" tabindex="-1"></a><span class="st">                    noResultsMsg.innerHTML = &#39;üîç Nenhuma conversa encontrada. Tente ajustar os filtros ou a pesquisa.&#39;;</span></span>
<span id="cb15-1343"><a href="#cb15-1343" aria-hidden="true" tabindex="-1"></a><span class="st">                    grid.appendChild(noResultsMsg);</span></span>
<span id="cb15-1344"><a href="#cb15-1344" aria-hidden="true" tabindex="-1"></a><span class="st">                }</span></span>
<span id="cb15-1345"><a href="#cb15-1345" aria-hidden="true" tabindex="-1"></a><span class="st">            } else if (noResults) {</span></span>
<span id="cb15-1346"><a href="#cb15-1346" aria-hidden="true" tabindex="-1"></a><span class="st">                noResults.remove();</span></span>
<span id="cb15-1347"><a href="#cb15-1347" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb15-1348"><a href="#cb15-1348" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb15-1349"><a href="#cb15-1349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-1350"><a href="#cb15-1350" aria-hidden="true" tabindex="-1"></a><span class="st">        function updateStats(visibleCount = null) {</span></span>
<span id="cb15-1351"><a href="#cb15-1351" aria-hidden="true" tabindex="-1"></a><span class="st">            const totalElement = document.getElementById(&#39;total-count&#39;);</span></span>
<span id="cb15-1352"><a href="#cb15-1352" aria-hidden="true" tabindex="-1"></a><span class="st">            if (visibleCount !== null) {</span></span>
<span id="cb15-1353"><a href="#cb15-1353" aria-hidden="true" tabindex="-1"></a><span class="st">                totalElement.textContent = visibleCount;</span></span>
<span id="cb15-1354"><a href="#cb15-1354" aria-hidden="true" tabindex="-1"></a><span class="st">            } else {</span></span>
<span id="cb15-1355"><a href="#cb15-1355" aria-hidden="true" tabindex="-1"></a><span class="st">                totalElement.textContent = &quot;&quot;&quot;</span> <span class="op">+</span> <span class="bu">str</span>(<span class="bu">len</span>(<span class="va">self</span>.all_conversations)) <span class="op">+</span> <span class="st">&quot;&quot;&quot;;</span></span>
<span id="cb15-1356"><a href="#cb15-1356" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb15-1357"><a href="#cb15-1357" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb15-1358"><a href="#cb15-1358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-1359"><a href="#cb15-1359" aria-hidden="true" tabindex="-1"></a><span class="st">        // NOVA FUN√á√ÉO: Abrir HTML ao clicar no t√≠tulo ou resumo</span></span>
<span id="cb15-1360"><a href="#cb15-1360" aria-hidden="true" tabindex="-1"></a><span class="st">        function openHTML(filename) {</span></span>
<span id="cb15-1361"><a href="#cb15-1361" aria-hidden="true" tabindex="-1"></a><span class="st">            const htmlUrl = &#39;combined_html/&#39; + filename;</span></span>
<span id="cb15-1362"><a href="#cb15-1362" aria-hidden="true" tabindex="-1"></a><span class="st">            console.log(&#39;Abrindo HTML:&#39;, htmlUrl);</span></span>
<span id="cb15-1363"><a href="#cb15-1363" aria-hidden="true" tabindex="-1"></a><span class="st">            window.open(htmlUrl, &#39;_blank&#39;);</span></span>
<span id="cb15-1364"><a href="#cb15-1364" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb15-1365"><a href="#cb15-1365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-1366"><a href="#cb15-1366" aria-hidden="true" tabindex="-1"></a><span class="st">        function openMD(filename) {</span></span>
<span id="cb15-1367"><a href="#cb15-1367" aria-hidden="true" tabindex="-1"></a><span class="st">            const mdUrl = &#39;combined_markdown/&#39; + filename;</span></span>
<span id="cb15-1368"><a href="#cb15-1368" aria-hidden="true" tabindex="-1"></a><span class="st">            window.open(mdUrl, &#39;_blank&#39;);</span></span>
<span id="cb15-1369"><a href="#cb15-1369" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb15-1370"><a href="#cb15-1370" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb15-1371"><a href="#cb15-1371" aria-hidden="true" tabindex="-1"></a><span class="st">        function openPDF(filename) {</span></span>
<span id="cb15-1372"><a href="#cb15-1372" aria-hidden="true" tabindex="-1"></a><span class="st">            const pdfFile = filename.replace(&#39;.md&#39;, &#39;.pdf&#39;);</span></span>
<span id="cb15-1373"><a href="#cb15-1373" aria-hidden="true" tabindex="-1"></a><span class="st">            const pdfUrl = &#39;combined_pdfs/&#39; + pdfFile;</span></span>
<span id="cb15-1374"><a href="#cb15-1374" aria-hidden="true" tabindex="-1"></a><span class="st">            window.open(pdfUrl, &#39;_blank&#39;);</span></span>
<span id="cb15-1375"><a href="#cb15-1375" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb15-1376"><a href="#cb15-1376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-1377"><a href="#cb15-1377" aria-hidden="true" tabindex="-1"></a><span class="st">        // Navega√ß√£o por teclado</span></span>
<span id="cb15-1378"><a href="#cb15-1378" aria-hidden="true" tabindex="-1"></a><span class="st">        document.addEventListener(&#39;keydown&#39;, function(e) {</span></span>
<span id="cb15-1379"><a href="#cb15-1379" aria-hidden="true" tabindex="-1"></a><span class="st">            if (e.key === &#39;Escape&#39;) {</span></span>
<span id="cb15-1380"><a href="#cb15-1380" aria-hidden="true" tabindex="-1"></a><span class="st">                document.getElementById(&#39;searchInput&#39;).value = &#39;&#39;;</span></span>
<span id="cb15-1381"><a href="#cb15-1381" aria-hidden="true" tabindex="-1"></a><span class="st">                filterConversations();</span></span>
<span id="cb15-1382"><a href="#cb15-1382" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb15-1383"><a href="#cb15-1383" aria-hidden="true" tabindex="-1"></a><span class="st">        });</span></span>
<span id="cb15-1384"><a href="#cb15-1384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-1385"><a href="#cb15-1385" aria-hidden="true" tabindex="-1"></a><span class="st">        // Clique nos cards - ABRE HTML</span></span>
<span id="cb15-1386"><a href="#cb15-1386" aria-hidden="true" tabindex="-1"></a><span class="st">        document.querySelectorAll(&#39;.conversation-card&#39;).forEach(card =&gt; {</span></span>
<span id="cb15-1387"><a href="#cb15-1387" aria-hidden="true" tabindex="-1"></a><span class="st">            card.addEventListener(&#39;click&#39;, function(e) {</span></span>
<span id="cb15-1388"><a href="#cb15-1388" aria-hidden="true" tabindex="-1"></a><span class="st">                // N√£o faz nada se clicou em um bot√£o de a√ß√£o</span></span>
<span id="cb15-1389"><a href="#cb15-1389" aria-hidden="true" tabindex="-1"></a><span class="st">                if (e.target.closest(&#39;.action-btn&#39;)) {</span></span>
<span id="cb15-1390"><a href="#cb15-1390" aria-hidden="true" tabindex="-1"></a><span class="st">                    return;</span></span>
<span id="cb15-1391"><a href="#cb15-1391" aria-hidden="true" tabindex="-1"></a><span class="st">                }</span></span>
<span id="cb15-1392"><a href="#cb15-1392" aria-hidden="true" tabindex="-1"></a><span class="st">                </span></span>
<span id="cb15-1393"><a href="#cb15-1393" aria-hidden="true" tabindex="-1"></a><span class="st">                // Abre o HTML ao clicar no card</span></span>
<span id="cb15-1394"><a href="#cb15-1394" aria-hidden="true" tabindex="-1"></a><span class="st">                const htmlBtn = this.querySelector(&#39;a.html-btn&#39;);</span></span>
<span id="cb15-1395"><a href="#cb15-1395" aria-hidden="true" tabindex="-1"></a><span class="st">                if (htmlBtn) {</span></span>
<span id="cb15-1396"><a href="#cb15-1396" aria-hidden="true" tabindex="-1"></a><span class="st">                    const htmlUrl = htmlBtn.getAttribute(&#39;href&#39;);</span></span>
<span id="cb15-1397"><a href="#cb15-1397" aria-hidden="true" tabindex="-1"></a><span class="st">                    window.open(htmlUrl, &#39;_blank&#39;);</span></span>
<span id="cb15-1398"><a href="#cb15-1398" aria-hidden="true" tabindex="-1"></a><span class="st">                }</span></span>
<span id="cb15-1399"><a href="#cb15-1399" aria-hidden="true" tabindex="-1"></a><span class="st">            });</span></span>
<span id="cb15-1400"><a href="#cb15-1400" aria-hidden="true" tabindex="-1"></a><span class="st">        });</span></span>
<span id="cb15-1401"><a href="#cb15-1401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-1402"><a href="#cb15-1402" aria-hidden="true" tabindex="-1"></a><span class="st">        // Foco na pesquisa ao carregar</span></span>
<span id="cb15-1403"><a href="#cb15-1403" aria-hidden="true" tabindex="-1"></a><span class="st">        document.getElementById(&#39;searchInput&#39;).focus();</span></span>
<span id="cb15-1404"><a href="#cb15-1404" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb15-1405"><a href="#cb15-1405" aria-hidden="true" tabindex="-1"></a><span class="st">        console.log(&#39;√çndice carregado com&#39;, &quot;&quot;&quot;</span> <span class="op">+</span> <span class="bu">str</span>(<span class="bu">len</span>(<span class="va">self</span>.all_conversations)) <span class="op">+</span> <span class="st">&quot;&quot;&quot;, &#39;conversas&#39;);</span></span>
<span id="cb15-1406"><a href="#cb15-1406" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;/script&gt;</span></span>
<span id="cb15-1407"><a href="#cb15-1407" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;/body&gt;</span></span>
<span id="cb15-1408"><a href="#cb15-1408" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;/html&gt;</span></span>
<span id="cb15-1409"><a href="#cb15-1409" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;&quot;&quot;</span></span>
<span id="cb15-1410"><a href="#cb15-1410" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-1411"><a href="#cb15-1411" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> <span class="bu">open</span>(<span class="va">self</span>.index_file, <span class="st">&#39;w&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb15-1412"><a href="#cb15-1412" aria-hidden="true" tabindex="-1"></a>            f.write(html_content)</span>
<span id="cb15-1413"><a href="#cb15-1413" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ √çndice combinado criado: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>index_file<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb15-1414"><a href="#cb15-1414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-1415"><a href="#cb15-1415" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> main():</span>
<span id="cb15-1416"><a href="#cb15-1416" aria-hidden="true" tabindex="-1"></a>    parser <span class="op">=</span> argparse.ArgumentParser(</span>
<span id="cb15-1417"><a href="#cb15-1417" aria-hidden="true" tabindex="-1"></a>        description<span class="op">=</span><span class="st">&quot;Processa exporta√ß√µes combinadas com exporta√ß√£o HTML via Pandoc.&quot;</span></span>
<span id="cb15-1418"><a href="#cb15-1418" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb15-1419"><a href="#cb15-1419" aria-hidden="true" tabindex="-1"></a>    parser.add_argument(<span class="st">&quot;--dry-run&quot;</span>, action<span class="op">=</span><span class="st">&quot;store_true&quot;</span>, <span class="bu">help</span><span class="op">=</span><span class="st">&quot;Executa sem salvar arquivos&quot;</span>)</span>
<span id="cb15-1420"><a href="#cb15-1420" aria-hidden="true" tabindex="-1"></a>    parser.add_argument(<span class="st">&quot;--force-overwrite&quot;</span>, action<span class="op">=</span><span class="st">&quot;store_true&quot;</span>, <span class="bu">help</span><span class="op">=</span><span class="st">&quot;Substitui arquivos existentes&quot;</span>)</span>
<span id="cb15-1421"><a href="#cb15-1421" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-1422"><a href="#cb15-1422" aria-hidden="true" tabindex="-1"></a>    args <span class="op">=</span> parser.parse_args()</span>
<span id="cb15-1423"><a href="#cb15-1423" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-1424"><a href="#cb15-1424" aria-hidden="true" tabindex="-1"></a>    system <span class="op">=</span> CombinedFragmentsSystem(</span>
<span id="cb15-1425"><a href="#cb15-1425" aria-hidden="true" tabindex="-1"></a>        dry_run<span class="op">=</span>args.dry_run,</span>
<span id="cb15-1426"><a href="#cb15-1426" aria-hidden="true" tabindex="-1"></a>        force_overwrite<span class="op">=</span>args.force_overwrite</span>
<span id="cb15-1427"><a href="#cb15-1427" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb15-1428"><a href="#cb15-1428" aria-hidden="true" tabindex="-1"></a>    system.run()</span>
<span id="cb15-1429"><a href="#cb15-1429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-1430"><a href="#cb15-1430" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&quot;__main__&quot;</span>:</span>
<span id="cb15-1431"><a href="#cb15-1431" aria-hidden="true" tabindex="-1"></a>    main()</span></code></pre></div>
<h2 data-number="1.18" id="fluxo-implementado"><span class="header-section-number">1.18</span> üîÑ <strong>Fluxo
Implementado:</strong></h2>
<h3 data-number="1.18.1" id="zip-processor"><span class="header-section-number">1.18.1</span> <strong>1. ZIP ‚Üí
Processor</strong></h3>
<ul>
<li>Extrai dados dos arquivos ZIP/JSON</li>
<li>Processa conversas de todas as fontes (Qwen3, ChatGPT, DeepSeek,
Grok)</li>
<li>Preserva formata√ß√£o especial (f√≥rmulas matem√°ticas, c√≥digo,
emojis)</li>
</ul>
<h3 data-number="1.18.2" id="processor-markdown"><span class="header-section-number">1.18.2</span> <strong>2. Processor ‚Üí
Markdown</strong></h3>
<ul>
<li>Gera arquivos Markdown na pasta <code>combined_markdown/</code></li>
<li>Preserva toda a formata√ß√£o original</li>
<li>Estrutura organizada com metadados</li>
</ul>
<h3 data-number="1.18.3" id="markdown-html-pandoc"><span class="header-section-number">1.18.3</span> <strong>3. Markdown ‚Üí HTML
(Pandoc)</strong></h3>
<ul>
<li><strong>Usa <code>pandoc --standalone --mathjax</code></strong> para
convers√£o</li>
<li>Gera HTMLs completos e aut√¥nomos na pasta
<code>combined_html/</code></li>
<li>Suporte nativo para f√≥rmulas matem√°ticas via MathJax</li>
<li>HTMLs bem formatados e prontos para visualiza√ß√£o</li>
</ul>
<h2 data-number="1.19" id="como-usar-3"><span class="header-section-number">1.19</span> üöÄ <strong>Como
Usar:</strong></h2>
<div class="sourceCode" id="cb16"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Processar tudo (ZIP ‚Üí MD ‚Üí HTML)</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> comb_fragments_system3_html_export.py <span class="at">--force-overwrite</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Apenas simular</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> comb_fragments_system3_html_export.py <span class="at">--dry-run</span></span></code></pre></div>
<h2 data-number="1.20" id="vantagens-do-novo-fluxo"><span class="header-section-number">1.20</span> ‚úÖ <strong>Vantagens do Novo
Fluxo:</strong></h2>
<ol type="1">
<li><strong>üéØ Qualidade Superior</strong>: Pandoc gera HTML mais limpo
e compat√≠vel</li>
<li><strong>üìê F√≥rmulas Matem√°ticas</strong>: Suporte nativo com
MathJax</li>
<li><strong>üîß Padr√£o Industrial</strong>: Pandoc √© o padr√£o para
convers√£o Markdown</li>
<li><strong>üöÄ Performance</strong>: Convers√£o em lote eficiente</li>
<li><strong>üìä Consist√™ncia</strong>: HTMLs gerados de forma
uniforme</li>
</ol>
<p>Agora o fluxo √©: <strong>ZIP ‚Üí Processor ‚Üí Markdown ‚Üí HTML
(Pandoc)</strong>! üéâ</p>
<hr />
<h3 data-number="1.20.1" id="utilizador-2025-11-05-064903-deepseek-chat"><span class="header-section-number">1.20.1</span> üë§ Utilizador
<em>(2025-11-05 06:49:03)</em> <em>[deepseek-chat]</em></h3>
<p>üíæ Exportando para formatos‚Ä¶ ‚úÖ Markdown: 206 arquivos criados, 0
falhas em ‚Äòcombined_markdown‚Äô ‚úÖ Pandoc dispon√≠vel para convers√£o HTML
üîÑ Convertendo 564 arquivos Markdown para HTML com Pandoc‚Ä¶ ‚ùå Erro
inesperado no Pandoc: unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô
‚ùå Erro inesperado no Pandoc: unsupported operand type(s) for /: ‚Äòstr‚Äô
and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc: unsupported operand type(s) for
/: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚úÖ HTML: 0 arquivos criados, 564
falhas em ‚Äòcombined_html‚Äô ‚úÖ CSV: 206 arquivos criados em ‚Äòcombined_csv‚Äô
‚úÖ JSON: 206 arquivos criados em ‚Äòcombined_json‚Äô ‚úÖ CSV √∫nico:
combined_all_conversations.csv ‚úÖ JSON √∫nico:
combined_all_conversations.json üéØ Criando √≠ndice HTML combinado‚Ä¶ ‚úÖ
√çndice combinado criado: index.html</p>
<p>üéâ SISTEMA COMBINADO FINALIZADO! üìÑ √çndice: index.html</p>
<hr />
<h3 data-number="1.20.2" id="deepseek-2025-11-05-064903-deepseek-chat"><span class="header-section-number">1.20.2</span> ü§ñ DeepSeek <em>(2025-11-05
06:49:03)</em> <em>[deepseek-chat]</em></h3>
<p>O erro est√° na fun√ß√£o <code>convert_markdown_to_html_pandoc</code>. O
problema √© que estou tentando dividir strings. Vou corrigir:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># comb_fragments_system3_html_export.py (VERS√ÉO CORRIGIDA)</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> zipfile</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> csv</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> argparse</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sys</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> webbrowser</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> shutil</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tempfile</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> traceback</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> subprocess</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Any, Optional</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> CombinedFragmentsSystem:</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, dry_run<span class="op">=</span><span class="va">False</span>, force_overwrite<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.data_dir <span class="op">=</span> Path(<span class="st">&quot;data&quot;</span>)</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.dry_run <span class="op">=</span> dry_run</span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.force_overwrite <span class="op">=</span> force_overwrite</span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Estrutura de pastas organizada</span></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.output_dirs <span class="op">=</span> {</span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;markdown&#39;</span>: <span class="st">&quot;combined_markdown&quot;</span>,</span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;csv&#39;</span>: <span class="st">&quot;combined_csv&quot;</span>, </span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;json&#39;</span>: <span class="st">&quot;combined_json&quot;</span>,</span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;pdfs&#39;</span>: <span class="st">&quot;combined_pdfs&quot;</span>,</span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;html&#39;</span>: <span class="st">&quot;combined_html&quot;</span></span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.single_files <span class="op">=</span> {</span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;csv&#39;</span>: <span class="st">&quot;combined_all_conversations.csv&quot;</span>,</span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;json&#39;</span>: <span class="st">&quot;combined_all_conversations.json&quot;</span></span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.index_file <span class="op">=</span> <span class="st">&quot;index.html&quot;</span></span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.all_conversations <span class="op">=</span> []</span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Configura√ß√£o de processamento por fonte</span></span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.processors <span class="op">=</span> {</span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;qwen&#39;</span>: {</span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;file&#39;</span>: <span class="st">&quot;chat-export.json&quot;</span>,</span>
<span id="cb17-45"><a href="#cb17-45" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;method&#39;</span>: <span class="va">self</span>.process_qwen_enhanced,</span>
<span id="cb17-46"><a href="#cb17-46" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;enabled&#39;</span>: <span class="va">True</span></span>
<span id="cb17-47"><a href="#cb17-47" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb17-48"><a href="#cb17-48" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;chatgpt&#39;</span>: {</span>
<span id="cb17-49"><a href="#cb17-49" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;file&#39;</span>: <span class="st">&quot;chatgpt.zip&quot;</span>, </span>
<span id="cb17-50"><a href="#cb17-50" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;method&#39;</span>: <span class="va">self</span>.process_chatgpt,</span>
<span id="cb17-51"><a href="#cb17-51" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;enabled&#39;</span>: <span class="va">True</span></span>
<span id="cb17-52"><a href="#cb17-52" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb17-53"><a href="#cb17-53" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;deepseek&#39;</span>: {</span>
<span id="cb17-54"><a href="#cb17-54" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;file&#39;</span>: <span class="st">&quot;deepseek_data.zip&quot;</span>,</span>
<span id="cb17-55"><a href="#cb17-55" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;method&#39;</span>: <span class="va">self</span>.process_deepseek,</span>
<span id="cb17-56"><a href="#cb17-56" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;enabled&#39;</span>: <span class="va">True</span></span>
<span id="cb17-57"><a href="#cb17-57" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb17-58"><a href="#cb17-58" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;grok&#39;</span>: {</span>
<span id="cb17-59"><a href="#cb17-59" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;file&#39;</span>: <span class="st">&quot;grok.zip&quot;</span>,</span>
<span id="cb17-60"><a href="#cb17-60" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;method&#39;</span>: <span class="va">self</span>.process_grok,</span>
<span id="cb17-61"><a href="#cb17-61" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;enabled&#39;</span>: <span class="va">True</span></span>
<span id="cb17-62"><a href="#cb17-62" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb17-63"><a href="#cb17-63" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb17-64"><a href="#cb17-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-65"><a href="#cb17-65" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> sanitize_filename(<span class="va">self</span>, text: <span class="bu">str</span>, max_len: <span class="bu">int</span> <span class="op">=</span> <span class="dv">50</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb17-66"><a href="#cb17-66" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Sanitiza nomes de arquivo PRESERVANDO EMOJIS&quot;&quot;&quot;</span></span>
<span id="cb17-67"><a href="#cb17-67" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> text <span class="kw">or</span> <span class="kw">not</span> <span class="bu">isinstance</span>(text, <span class="bu">str</span>):</span>
<span id="cb17-68"><a href="#cb17-68" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">&quot;conversa_sem_titulo&quot;</span></span>
<span id="cb17-69"><a href="#cb17-69" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb17-70"><a href="#cb17-70" aria-hidden="true" tabindex="-1"></a>        invalid_chars <span class="op">=</span> <span class="vs">r&#39;</span><span class="pp">[&lt;&gt;:&quot;/</span><span class="ch">\\</span><span class="pp">|?*</span><span class="ch">\x00</span><span class="pp">-</span><span class="ch">\x1F\x7F</span><span class="pp">]</span><span class="vs">&#39;</span></span>
<span id="cb17-71"><a href="#cb17-71" aria-hidden="true" tabindex="-1"></a>        sanitized <span class="op">=</span> re.sub(invalid_chars, <span class="st">&#39;&#39;</span>, text)</span>
<span id="cb17-72"><a href="#cb17-72" aria-hidden="true" tabindex="-1"></a>        sanitized <span class="op">=</span> re.sub(<span class="vs">r&#39;</span><span class="dv">\s</span><span class="op">+</span><span class="vs">&#39;</span>, <span class="st">&#39; &#39;</span>, sanitized.strip())</span>
<span id="cb17-73"><a href="#cb17-73" aria-hidden="true" tabindex="-1"></a>        sanitized <span class="op">=</span> sanitized.strip()</span>
<span id="cb17-74"><a href="#cb17-74" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb17-75"><a href="#cb17-75" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> sanitized:</span>
<span id="cb17-76"><a href="#cb17-76" aria-hidden="true" tabindex="-1"></a>            sanitized <span class="op">=</span> <span class="st">&quot;conversa_sem_titulo&quot;</span></span>
<span id="cb17-77"><a href="#cb17-77" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb17-78"><a href="#cb17-78" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(sanitized) <span class="op">&gt;</span> max_len:</span>
<span id="cb17-79"><a href="#cb17-79" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="st">&#39; &#39;</span> <span class="kw">in</span> sanitized[:max_len]:</span>
<span id="cb17-80"><a href="#cb17-80" aria-hidden="true" tabindex="-1"></a>                last_space <span class="op">=</span> sanitized[:max_len].rfind(<span class="st">&#39; &#39;</span>)</span>
<span id="cb17-81"><a href="#cb17-81" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> last_space <span class="op">&gt;</span> <span class="dv">10</span>:</span>
<span id="cb17-82"><a href="#cb17-82" aria-hidden="true" tabindex="-1"></a>                    sanitized <span class="op">=</span> sanitized[:last_space]</span>
<span id="cb17-83"><a href="#cb17-83" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb17-84"><a href="#cb17-84" aria-hidden="true" tabindex="-1"></a>                sanitized <span class="op">=</span> sanitized[:max_len]</span>
<span id="cb17-85"><a href="#cb17-85" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb17-86"><a href="#cb17-86" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> sanitized</span>
<span id="cb17-87"><a href="#cb17-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-88"><a href="#cb17-88" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> preserve_special_content(<span class="va">self</span>, content: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb17-89"><a href="#cb17-89" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Preserva f√≥rmulas matem√°ticas, c√≥digo e formata√ß√£o especial&quot;&quot;&quot;</span></span>
<span id="cb17-90"><a href="#cb17-90" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> content:</span>
<span id="cb17-91"><a href="#cb17-91" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">&quot;&quot;</span></span>
<span id="cb17-92"><a href="#cb17-92" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb17-93"><a href="#cb17-93" aria-hidden="true" tabindex="-1"></a>        preserved_content <span class="op">=</span> content</span>
<span id="cb17-94"><a href="#cb17-94" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb17-95"><a href="#cb17-95" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Corrige problemas com barras invertidas em LaTeX</span></span>
<span id="cb17-96"><a href="#cb17-96" aria-hidden="true" tabindex="-1"></a>        latex_corrections <span class="op">=</span> {</span>
<span id="cb17-97"><a href="#cb17-97" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;‚ôÄrac&#39;</span>: <span class="st">&#39;</span><span class="ch">\\</span><span class="st">frac&#39;</span>,</span>
<span id="cb17-98"><a href="#cb17-98" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;‚ôÇarepsilon&#39;</span>: <span class="st">&#39;</span><span class="ch">\\</span><span class="st">varepsilon&#39;</span>,</span>
<span id="cb17-99"><a href="#cb17-99" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;‚ôÇ&#39;</span>: <span class="st">&#39;</span><span class="ch">\\</span><span class="st">&#39;</span>,</span>
<span id="cb17-100"><a href="#cb17-100" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;‚ôÄ&#39;</span>: <span class="st">&#39;</span><span class="ch">\\</span><span class="st">&#39;</span></span>
<span id="cb17-101"><a href="#cb17-101" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb17-102"><a href="#cb17-102" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb17-103"><a href="#cb17-103" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> wrong, correct <span class="kw">in</span> latex_corrections.items():</span>
<span id="cb17-104"><a href="#cb17-104" aria-hidden="true" tabindex="-1"></a>            preserved_content <span class="op">=</span> preserved_content.replace(wrong, correct)</span>
<span id="cb17-105"><a href="#cb17-105" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb17-106"><a href="#cb17-106" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> preserved_content</span>
<span id="cb17-107"><a href="#cb17-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-108"><a href="#cb17-108" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> ensure_directories(<span class="va">self</span>):</span>
<span id="cb17-109"><a href="#cb17-109" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Cria todas as pastas necess√°rias&quot;&quot;&quot;</span></span>
<span id="cb17-110"><a href="#cb17-110" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb17-111"><a href="#cb17-111" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;DRY-RUN: Pastas seriam criadas:&quot;</span>)</span>
<span id="cb17-112"><a href="#cb17-112" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> folder <span class="kw">in</span> <span class="va">self</span>.output_dirs.values():</span>
<span id="cb17-113"><a href="#cb17-113" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;   </span><span class="sc">{</span>folder<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb17-114"><a href="#cb17-114" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb17-115"><a href="#cb17-115" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb17-116"><a href="#cb17-116" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> folder <span class="kw">in</span> <span class="va">self</span>.output_dirs.values():</span>
<span id="cb17-117"><a href="#cb17-117" aria-hidden="true" tabindex="-1"></a>            Path(folder).mkdir(parents<span class="op">=</span><span class="va">True</span>, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb17-118"><a href="#cb17-118" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;Pasta criada: </span><span class="sc">{</span>folder<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb17-119"><a href="#cb17-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-120"><a href="#cb17-120" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> run(<span class="va">self</span>):</span>
<span id="cb17-121"><a href="#cb17-121" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Executa o processamento completo&quot;&quot;&quot;</span></span>
<span id="cb17-122"><a href="#cb17-122" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;SISTEMA COMBINADO DE EXPORTA√á√ïES COM HTML (Qwen3, ChatGPT, DeepSeek, Grok)&quot;</span>)</span>
<span id="cb17-123"><a href="#cb17-123" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;=&quot;</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb17-124"><a href="#cb17-124" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb17-125"><a href="#cb17-125" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.data_dir.exists():</span>
<span id="cb17-126"><a href="#cb17-126" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;Pasta &#39;</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>data_dir<span class="sc">}</span><span class="ss">&#39; n√£o encontrada.&quot;</span>)</span>
<span id="cb17-127"><a href="#cb17-127" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;Crie a pasta &#39;data&#39; e coloque os arquivos de exporta√ß√£o:&quot;</span>)</span>
<span id="cb17-128"><a href="#cb17-128" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> source_name, config <span class="kw">in</span> <span class="va">self</span>.processors.items():</span>
<span id="cb17-129"><a href="#cb17-129" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;   - </span><span class="sc">{</span>config[<span class="st">&#39;file&#39;</span>]<span class="sc">}</span><span class="ss"> (para </span><span class="sc">{</span>source_name<span class="sc">.</span>upper()<span class="sc">}</span><span class="ss">)&quot;</span>)</span>
<span id="cb17-130"><a href="#cb17-130" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb17-131"><a href="#cb17-131" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb17-132"><a href="#cb17-132" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;Usando pasta de dados: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>data_dir<span class="sc">.</span>absolute()<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb17-133"><a href="#cb17-133" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb17-134"><a href="#cb17-134" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.ensure_directories()</span>
<span id="cb17-135"><a href="#cb17-135" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb17-136"><a href="#cb17-136" aria-hidden="true" tabindex="-1"></a>        processed_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb17-137"><a href="#cb17-137" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> source_name, config <span class="kw">in</span> <span class="va">self</span>.processors.items():</span>
<span id="cb17-138"><a href="#cb17-138" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> config[<span class="st">&#39;enabled&#39;</span>]:</span>
<span id="cb17-139"><a href="#cb17-139" aria-hidden="true" tabindex="-1"></a>                file_path <span class="op">=</span> <span class="va">self</span>.data_dir <span class="op">/</span> config[<span class="st">&#39;file&#39;</span>]</span>
<span id="cb17-140"><a href="#cb17-140" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> file_path.exists():</span>
<span id="cb17-141"><a href="#cb17-141" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="ch">\n</span><span class="ss">Processando </span><span class="sc">{</span>source_name<span class="sc">.</span>upper()<span class="sc">}</span><span class="ss">...&quot;</span>)</span>
<span id="cb17-142"><a href="#cb17-142" aria-hidden="true" tabindex="-1"></a>                    config[<span class="st">&#39;method&#39;</span>](file_path)</span>
<span id="cb17-143"><a href="#cb17-143" aria-hidden="true" tabindex="-1"></a>                    processed_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb17-144"><a href="#cb17-144" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb17-145"><a href="#cb17-145" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="sc">{</span>source_name<span class="sc">.</span>upper()<span class="sc">}</span><span class="ss">: arquivo n√£o encontrado - </span><span class="sc">{</span>file_path<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb17-146"><a href="#cb17-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-147"><a href="#cb17-147" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> processed_count <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb17-148"><a href="#cb17-148" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;Nenhum arquivo de exporta√ß√£o encontrado na pasta &#39;data&#39;.&quot;</span>)</span>
<span id="cb17-149"><a href="#cb17-149" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb17-150"><a href="#cb17-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-151"><a href="#cb17-151" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb17-152"><a href="#cb17-152" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;Nenhuma conversa foi extra√≠da dos arquivos.&quot;</span>)</span>
<span id="cb17-153"><a href="#cb17-153" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb17-154"><a href="#cb17-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-155"><a href="#cb17-155" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>._post_process_conversations()</span>
<span id="cb17-156"><a href="#cb17-156" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb17-157"><a href="#cb17-157" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.dry_run:</span>
<span id="cb17-158"><a href="#cb17-158" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>._export_all_formats()</span>
<span id="cb17-159"><a href="#cb17-159" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="ch">\n</span><span class="ss">üéâ SISTEMA COMBINADO FINALIZADO!&quot;</span>)</span>
<span id="cb17-160"><a href="#cb17-160" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;üìÑ √çndice: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>index_file<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb17-161"><a href="#cb17-161" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> Path(<span class="va">self</span>.index_file).exists():</span>
<span id="cb17-162"><a href="#cb17-162" aria-hidden="true" tabindex="-1"></a>                webbrowser.<span class="bu">open</span>(<span class="ss">f&#39;file://</span><span class="sc">{</span>Path(<span class="va">self</span>.index_file)<span class="sc">.</span>absolute()<span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb17-163"><a href="#cb17-163" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb17-164"><a href="#cb17-164" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="ch">\n</span><span class="ss">üß™ MODO DRY-RUN: Nenhum arquivo foi criado.&quot;</span>)</span>
<span id="cb17-165"><a href="#cb17-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-166"><a href="#cb17-166" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _post_process_conversations(<span class="va">self</span>):</span>
<span id="cb17-167"><a href="#cb17-167" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Processamento p√≥s-extra√ß√£o das conversas&quot;&quot;&quot;</span></span>
<span id="cb17-168"><a href="#cb17-168" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.all_conversations.sort(</span>
<span id="cb17-169"><a href="#cb17-169" aria-hidden="true" tabindex="-1"></a>            key<span class="op">=</span><span class="kw">lambda</span> x: <span class="va">self</span>.parse_timestamp_for_sorting(</span>
<span id="cb17-170"><a href="#cb17-170" aria-hidden="true" tabindex="-1"></a>                x.get(<span class="st">&#39;updated_at&#39;</span>) <span class="kw">or</span> x.get(<span class="st">&#39;inserted_at&#39;</span>) <span class="kw">or</span> x.get(<span class="st">&#39;created_at&#39;</span>)</span>
<span id="cb17-171"><a href="#cb17-171" aria-hidden="true" tabindex="-1"></a>            ),</span>
<span id="cb17-172"><a href="#cb17-172" aria-hidden="true" tabindex="-1"></a>            reverse<span class="op">=</span><span class="va">True</span></span>
<span id="cb17-173"><a href="#cb17-173" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb17-174"><a href="#cb17-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-175"><a href="#cb17-175" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, conv <span class="kw">in</span> <span class="bu">enumerate</span>(<span class="va">self</span>.all_conversations):</span>
<span id="cb17-176"><a href="#cb17-176" aria-hidden="true" tabindex="-1"></a>            conv[<span class="st">&#39;number&#39;</span>] <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb17-177"><a href="#cb17-177" aria-hidden="true" tabindex="-1"></a>            conv[<span class="st">&#39;category&#39;</span>] <span class="op">=</span> <span class="va">self</span>.categorize_conversation(conv[<span class="st">&#39;title&#39;</span>], conv.get(<span class="st">&#39;summary&#39;</span>, <span class="st">&#39;&#39;</span>))</span>
<span id="cb17-178"><a href="#cb17-178" aria-hidden="true" tabindex="-1"></a>            conv.setdefault(<span class="st">&#39;source&#39;</span>, <span class="st">&#39;Desconhecido&#39;</span>)</span>
<span id="cb17-179"><a href="#cb17-179" aria-hidden="true" tabindex="-1"></a>            conv.setdefault(<span class="st">&#39;messages&#39;</span>, [])</span>
<span id="cb17-180"><a href="#cb17-180" aria-hidden="true" tabindex="-1"></a>            conv.setdefault(<span class="st">&#39;summary&#39;</span>, conv[<span class="st">&#39;messages&#39;</span>][<span class="dv">0</span>][<span class="st">&#39;content&#39;</span>][:<span class="dv">100</span>] <span class="op">+</span> <span class="st">&quot;...&quot;</span> <span class="cf">if</span> conv[<span class="st">&#39;messages&#39;</span>] <span class="cf">else</span> <span class="st">&quot;Sem conte√∫do&quot;</span>)</span>
<span id="cb17-181"><a href="#cb17-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-182"><a href="#cb17-182" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;üìä Total combinado de conversas: </span><span class="sc">{</span><span class="bu">len</span>(<span class="va">self</span>.all_conversations)<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb17-183"><a href="#cb17-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-184"><a href="#cb17-184" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _export_all_formats(<span class="va">self</span>):</span>
<span id="cb17-185"><a href="#cb17-185" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Exporta para todos os formatos&quot;&quot;&quot;</span></span>
<span id="cb17-186"><a href="#cb17-186" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">üíæ Exportando para formatos...&quot;</span>)</span>
<span id="cb17-187"><a href="#cb17-187" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.save_as_markdown_enhanced()</span>
<span id="cb17-188"><a href="#cb17-188" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.save_as_html_with_pandoc()  <span class="co"># Exporta√ß√£o HTML com Pandoc</span></span>
<span id="cb17-189"><a href="#cb17-189" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.save_as_csv() </span>
<span id="cb17-190"><a href="#cb17-190" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.save_as_json()</span>
<span id="cb17-191"><a href="#cb17-191" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.save_all_to_single_files()</span>
<span id="cb17-192"><a href="#cb17-192" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.create_searchable_index()</span>
<span id="cb17-193"><a href="#cb17-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-194"><a href="#cb17-194" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> check_pandoc_available(<span class="va">self</span>) <span class="op">-&gt;</span> <span class="bu">bool</span>:</span>
<span id="cb17-195"><a href="#cb17-195" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Verifica se Pandoc est√° dispon√≠vel&quot;&quot;&quot;</span></span>
<span id="cb17-196"><a href="#cb17-196" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb17-197"><a href="#cb17-197" aria-hidden="true" tabindex="-1"></a>            result <span class="op">=</span> subprocess.run(</span>
<span id="cb17-198"><a href="#cb17-198" aria-hidden="true" tabindex="-1"></a>                [<span class="st">&#39;pandoc&#39;</span>, <span class="st">&#39;--version&#39;</span>], </span>
<span id="cb17-199"><a href="#cb17-199" aria-hidden="true" tabindex="-1"></a>                capture_output<span class="op">=</span><span class="va">True</span>, </span>
<span id="cb17-200"><a href="#cb17-200" aria-hidden="true" tabindex="-1"></a>                text<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb17-201"><a href="#cb17-201" aria-hidden="true" tabindex="-1"></a>                timeout<span class="op">=</span><span class="dv">10</span></span>
<span id="cb17-202"><a href="#cb17-202" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb17-203"><a href="#cb17-203" aria-hidden="true" tabindex="-1"></a>            available <span class="op">=</span> result.returncode <span class="op">==</span> <span class="dv">0</span></span>
<span id="cb17-204"><a href="#cb17-204" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> available:</span>
<span id="cb17-205"><a href="#cb17-205" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;‚úÖ Pandoc dispon√≠vel para convers√£o HTML&quot;</span>)</span>
<span id="cb17-206"><a href="#cb17-206" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb17-207"><a href="#cb17-207" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;‚ö†Ô∏è Pandoc n√£o encontrado - HTML n√£o ser√° gerado&quot;</span>)</span>
<span id="cb17-208"><a href="#cb17-208" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> available</span>
<span id="cb17-209"><a href="#cb17-209" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> (subprocess.TimeoutExpired, <span class="pp">FileNotFoundError</span>, <span class="pp">Exception</span>) <span class="im">as</span> e:</span>
<span id="cb17-210"><a href="#cb17-210" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚ö†Ô∏è Pandoc n√£o dispon√≠vel: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb17-211"><a href="#cb17-211" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb17-212"><a href="#cb17-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-213"><a href="#cb17-213" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> convert_markdown_to_html_pandoc(<span class="va">self</span>, md_file_path: Path) <span class="op">-&gt;</span> <span class="bu">bool</span>:</span>
<span id="cb17-214"><a href="#cb17-214" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Converte Markdown para HTML usando Pandoc --standalone --mathjax&quot;&quot;&quot;</span></span>
<span id="cb17-215"><a href="#cb17-215" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb17-216"><a href="#cb17-216" aria-hidden="true" tabindex="-1"></a>            html_file <span class="op">=</span> <span class="va">self</span>.output_dirs[<span class="st">&#39;html&#39;</span>] <span class="op">/</span> md_file_path.with_suffix(<span class="st">&#39;.html&#39;</span>).name</span>
<span id="cb17-217"><a href="#cb17-217" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb17-218"><a href="#cb17-218" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.force_overwrite <span class="kw">and</span> html_file.exists():</span>
<span id="cb17-219"><a href="#cb17-219" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;‚è≠Ô∏è HTML j√° existe: </span><span class="sc">{</span>html_file<span class="sc">.</span>name<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb17-220"><a href="#cb17-220" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb17-221"><a href="#cb17-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-222"><a href="#cb17-222" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;üîß Convertendo com Pandoc: </span><span class="sc">{</span>md_file_path<span class="sc">.</span>name<span class="sc">}</span><span class="ss"> ‚Üí </span><span class="sc">{</span>html_file<span class="sc">.</span>name<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb17-223"><a href="#cb17-223" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb17-224"><a href="#cb17-224" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Comando Pandoc com --standalone --mathjax</span></span>
<span id="cb17-225"><a href="#cb17-225" aria-hidden="true" tabindex="-1"></a>            result <span class="op">=</span> subprocess.run([</span>
<span id="cb17-226"><a href="#cb17-226" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;pandoc&#39;</span>, </span>
<span id="cb17-227"><a href="#cb17-227" aria-hidden="true" tabindex="-1"></a>                <span class="bu">str</span>(md_file_path),</span>
<span id="cb17-228"><a href="#cb17-228" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;--from&#39;</span>, <span class="st">&#39;markdown+emoji&#39;</span>,</span>
<span id="cb17-229"><a href="#cb17-229" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;--to&#39;</span>, <span class="st">&#39;html5&#39;</span>,</span>
<span id="cb17-230"><a href="#cb17-230" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;--standalone&#39;</span>,</span>
<span id="cb17-231"><a href="#cb17-231" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;--mathjax&#39;</span>,</span>
<span id="cb17-232"><a href="#cb17-232" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;--output&#39;</span>, <span class="bu">str</span>(html_file)</span>
<span id="cb17-233"><a href="#cb17-233" aria-hidden="true" tabindex="-1"></a>            ], capture_output<span class="op">=</span><span class="va">True</span>, text<span class="op">=</span><span class="va">True</span>, timeout<span class="op">=</span><span class="dv">30</span>)</span>
<span id="cb17-234"><a href="#cb17-234" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb17-235"><a href="#cb17-235" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> result.returncode <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb17-236"><a href="#cb17-236" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ HTML gerado: </span><span class="sc">{</span>html_file<span class="sc">.</span>name<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb17-237"><a href="#cb17-237" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb17-238"><a href="#cb17-238" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb17-239"><a href="#cb17-239" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;‚ùå Erro no Pandoc para </span><span class="sc">{</span>md_file_path<span class="sc">.</span>name<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>result<span class="sc">.</span>stderr<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb17-240"><a href="#cb17-240" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb17-241"><a href="#cb17-241" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb17-242"><a href="#cb17-242" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> subprocess.TimeoutExpired:</span>
<span id="cb17-243"><a href="#cb17-243" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚è∞ Timeout no Pandoc para </span><span class="sc">{</span>md_file_path<span class="sc">.</span>name<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb17-244"><a href="#cb17-244" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb17-245"><a href="#cb17-245" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb17-246"><a href="#cb17-246" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚ùå Erro inesperado no Pandoc para </span><span class="sc">{</span>md_file_path<span class="sc">.</span>name<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span><span class="bu">str</span>(e)<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb17-247"><a href="#cb17-247" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb17-248"><a href="#cb17-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-249"><a href="#cb17-249" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> save_as_html_with_pandoc(<span class="va">self</span>):</span>
<span id="cb17-250"><a href="#cb17-250" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Converte arquivos Markdown para HTML usando Pandoc --standalone --mathjax&quot;&quot;&quot;</span></span>
<span id="cb17-251"><a href="#cb17-251" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb17-252"><a href="#cb17-252" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;üß™ [DRY-RUN] HTMLs seriam criados com Pandoc:&quot;</span>)</span>
<span id="cb17-253"><a href="#cb17-253" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> conv <span class="kw">in</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb17-254"><a href="#cb17-254" aria-hidden="true" tabindex="-1"></a>                safe_title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(conv[<span class="st">&#39;title&#39;</span>])</span>
<span id="cb17-255"><a href="#cb17-255" aria-hidden="true" tabindex="-1"></a>                filename <span class="op">=</span> <span class="ss">f&quot;</span><span class="sc">{</span>conv[<span class="st">&#39;number&#39;</span>]<span class="sc">:03d}</span><span class="ss">_</span><span class="sc">{</span>conv[<span class="st">&#39;source&#39;</span>]<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>safe_title<span class="sc">}</span><span class="ss">.html&quot;</span></span>
<span id="cb17-256"><a href="#cb17-256" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;   üåê </span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss"> (via Pandoc)&quot;</span>)</span>
<span id="cb17-257"><a href="#cb17-257" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb17-258"><a href="#cb17-258" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb17-259"><a href="#cb17-259" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.check_pandoc_available():</span>
<span id="cb17-260"><a href="#cb17-260" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;‚ùå Pandoc n√£o dispon√≠vel. HTMLs n√£o ser√£o gerados.&quot;</span>)</span>
<span id="cb17-261"><a href="#cb17-261" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb17-262"><a href="#cb17-262" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb17-263"><a href="#cb17-263" aria-hidden="true" tabindex="-1"></a>        markdown_folder <span class="op">=</span> <span class="va">self</span>.output_dirs[<span class="st">&#39;markdown&#39;</span>]</span>
<span id="cb17-264"><a href="#cb17-264" aria-hidden="true" tabindex="-1"></a>        html_folder <span class="op">=</span> <span class="va">self</span>.output_dirs[<span class="st">&#39;html&#39;</span>]</span>
<span id="cb17-265"><a href="#cb17-265" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb17-266"><a href="#cb17-266" aria-hidden="true" tabindex="-1"></a>        <span class="co"># CORRE√á√ÉO: Buscar arquivos MD da pasta markdown</span></span>
<span id="cb17-267"><a href="#cb17-267" aria-hidden="true" tabindex="-1"></a>        md_files <span class="op">=</span> <span class="bu">list</span>(Path(markdown_folder).glob(<span class="st">&quot;*.md&quot;</span>))</span>
<span id="cb17-268"><a href="#cb17-268" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb17-269"><a href="#cb17-269" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> md_files:</span>
<span id="cb17-270"><a href="#cb17-270" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;‚ùå Nenhum arquivo Markdown encontrado para convers√£o.&quot;</span>)</span>
<span id="cb17-271"><a href="#cb17-271" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb17-272"><a href="#cb17-272" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb17-273"><a href="#cb17-273" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;üîÑ Convertendo </span><span class="sc">{</span><span class="bu">len</span>(md_files)<span class="sc">}</span><span class="ss"> arquivos Markdown para HTML com Pandoc...&quot;</span>)</span>
<span id="cb17-274"><a href="#cb17-274" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb17-275"><a href="#cb17-275" aria-hidden="true" tabindex="-1"></a>        converted_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb17-276"><a href="#cb17-276" aria-hidden="true" tabindex="-1"></a>        failed_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb17-277"><a href="#cb17-277" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb17-278"><a href="#cb17-278" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> md_file <span class="kw">in</span> md_files:</span>
<span id="cb17-279"><a href="#cb17-279" aria-hidden="true" tabindex="-1"></a>            success <span class="op">=</span> <span class="va">self</span>.convert_markdown_to_html_pandoc(md_file)</span>
<span id="cb17-280"><a href="#cb17-280" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> success:</span>
<span id="cb17-281"><a href="#cb17-281" aria-hidden="true" tabindex="-1"></a>                converted_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb17-282"><a href="#cb17-282" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb17-283"><a href="#cb17-283" aria-hidden="true" tabindex="-1"></a>                failed_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb17-284"><a href="#cb17-284" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb17-285"><a href="#cb17-285" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ HTML: </span><span class="sc">{</span>converted_count<span class="sc">}</span><span class="ss"> arquivos criados, </span><span class="sc">{</span>failed_count<span class="sc">}</span><span class="ss"> falhas em &#39;</span><span class="sc">{</span>html_folder<span class="sc">}</span><span class="ss">&#39;&quot;</span>)</span>
<span id="cb17-286"><a href="#cb17-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-287"><a href="#cb17-287" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ... (mantenha todos os outros m√©todos existentes como process_qwen_enhanced, process_chatgpt, etc.)</span></span>
<span id="cb17-288"><a href="#cb17-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-289"><a href="#cb17-289" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> save_as_markdown_enhanced(<span class="va">self</span>):</span>
<span id="cb17-290"><a href="#cb17-290" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Salva conversas com preserva√ß√£o total de formata√ß√£o&quot;&quot;&quot;</span></span>
<span id="cb17-291"><a href="#cb17-291" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb17-292"><a href="#cb17-292" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;üß™ [DRY-RUN] Markdowns seriam criados:&quot;</span>)</span>
<span id="cb17-293"><a href="#cb17-293" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> conv <span class="kw">in</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb17-294"><a href="#cb17-294" aria-hidden="true" tabindex="-1"></a>                safe_title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(conv[<span class="st">&#39;title&#39;</span>])</span>
<span id="cb17-295"><a href="#cb17-295" aria-hidden="true" tabindex="-1"></a>                filename <span class="op">=</span> <span class="ss">f&quot;</span><span class="sc">{</span>conv[<span class="st">&#39;number&#39;</span>]<span class="sc">:03d}</span><span class="ss">_</span><span class="sc">{</span>conv[<span class="st">&#39;source&#39;</span>]<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>safe_title<span class="sc">}</span><span class="ss">.md&quot;</span></span>
<span id="cb17-296"><a href="#cb17-296" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;   üìÑ </span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb17-297"><a href="#cb17-297" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb17-298"><a href="#cb17-298" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb17-299"><a href="#cb17-299" aria-hidden="true" tabindex="-1"></a>        folder <span class="op">=</span> <span class="va">self</span>.output_dirs[<span class="st">&#39;markdown&#39;</span>]</span>
<span id="cb17-300"><a href="#cb17-300" aria-hidden="true" tabindex="-1"></a>        saved_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb17-301"><a href="#cb17-301" aria-hidden="true" tabindex="-1"></a>        failed_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb17-302"><a href="#cb17-302" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb17-303"><a href="#cb17-303" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> conv <span class="kw">in</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb17-304"><a href="#cb17-304" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb17-305"><a href="#cb17-305" aria-hidden="true" tabindex="-1"></a>                safe_title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(conv[<span class="st">&#39;title&#39;</span>])</span>
<span id="cb17-306"><a href="#cb17-306" aria-hidden="true" tabindex="-1"></a>                filename <span class="op">=</span> <span class="ss">f&quot;</span><span class="sc">{</span>conv[<span class="st">&#39;number&#39;</span>]<span class="sc">:03d}</span><span class="ss">_</span><span class="sc">{</span>conv[<span class="st">&#39;source&#39;</span>]<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>safe_title<span class="sc">}</span><span class="ss">.md&quot;</span></span>
<span id="cb17-307"><a href="#cb17-307" aria-hidden="true" tabindex="-1"></a>                filepath <span class="op">=</span> Path(folder) <span class="op">/</span> filename</span>
<span id="cb17-308"><a href="#cb17-308" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb17-309"><a href="#cb17-309" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.force_overwrite <span class="kw">and</span> filepath.exists():</span>
<span id="cb17-310"><a href="#cb17-310" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">continue</span></span>
<span id="cb17-311"><a href="#cb17-311" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb17-312"><a href="#cb17-312" aria-hidden="true" tabindex="-1"></a>                markdown_content <span class="op">=</span> <span class="va">self</span>.create_enhanced_markdown_content(conv)</span>
<span id="cb17-313"><a href="#cb17-313" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb17-314"><a href="#cb17-314" aria-hidden="true" tabindex="-1"></a>                <span class="cf">with</span> <span class="bu">open</span>(filepath, <span class="st">&#39;w&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb17-315"><a href="#cb17-315" aria-hidden="true" tabindex="-1"></a>                    f.write(markdown_content)</span>
<span id="cb17-316"><a href="#cb17-316" aria-hidden="true" tabindex="-1"></a>                saved_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb17-317"><a href="#cb17-317" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb17-318"><a href="#cb17-318" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb17-319"><a href="#cb17-319" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;‚ùå Erro ao salvar conversa </span><span class="sc">{</span>conv[<span class="st">&#39;number&#39;</span>]<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb17-320"><a href="#cb17-320" aria-hidden="true" tabindex="-1"></a>                failed_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb17-321"><a href="#cb17-321" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span></span>
<span id="cb17-322"><a href="#cb17-322" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb17-323"><a href="#cb17-323" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ Markdown: </span><span class="sc">{</span>saved_count<span class="sc">}</span><span class="ss"> arquivos criados, </span><span class="sc">{</span>failed_count<span class="sc">}</span><span class="ss"> falhas em &#39;</span><span class="sc">{</span>folder<span class="sc">}</span><span class="ss">&#39;&quot;</span>)</span>
<span id="cb17-324"><a href="#cb17-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-325"><a href="#cb17-325" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ... (mantenha todos os outros m√©todos: save_as_csv, save_as_json, create_searchable_index, etc.)</span></span>
<span id="cb17-326"><a href="#cb17-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-327"><a href="#cb17-327" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> main():</span>
<span id="cb17-328"><a href="#cb17-328" aria-hidden="true" tabindex="-1"></a>    parser <span class="op">=</span> argparse.ArgumentParser(</span>
<span id="cb17-329"><a href="#cb17-329" aria-hidden="true" tabindex="-1"></a>        description<span class="op">=</span><span class="st">&quot;Processa exporta√ß√µes combinadas com exporta√ß√£o HTML via Pandoc.&quot;</span></span>
<span id="cb17-330"><a href="#cb17-330" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb17-331"><a href="#cb17-331" aria-hidden="true" tabindex="-1"></a>    parser.add_argument(<span class="st">&quot;--dry-run&quot;</span>, action<span class="op">=</span><span class="st">&quot;store_true&quot;</span>, <span class="bu">help</span><span class="op">=</span><span class="st">&quot;Executa sem salvar arquivos&quot;</span>)</span>
<span id="cb17-332"><a href="#cb17-332" aria-hidden="true" tabindex="-1"></a>    parser.add_argument(<span class="st">&quot;--force-overwrite&quot;</span>, action<span class="op">=</span><span class="st">&quot;store_true&quot;</span>, <span class="bu">help</span><span class="op">=</span><span class="st">&quot;Substitui arquivos existentes&quot;</span>)</span>
<span id="cb17-333"><a href="#cb17-333" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-334"><a href="#cb17-334" aria-hidden="true" tabindex="-1"></a>    args <span class="op">=</span> parser.parse_args()</span>
<span id="cb17-335"><a href="#cb17-335" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-336"><a href="#cb17-336" aria-hidden="true" tabindex="-1"></a>    system <span class="op">=</span> CombinedFragmentsSystem(</span>
<span id="cb17-337"><a href="#cb17-337" aria-hidden="true" tabindex="-1"></a>        dry_run<span class="op">=</span>args.dry_run,</span>
<span id="cb17-338"><a href="#cb17-338" aria-hidden="true" tabindex="-1"></a>        force_overwrite<span class="op">=</span>args.force_overwrite</span>
<span id="cb17-339"><a href="#cb17-339" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb17-340"><a href="#cb17-340" aria-hidden="true" tabindex="-1"></a>    system.run()</span>
<span id="cb17-341"><a href="#cb17-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-342"><a href="#cb17-342" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&quot;__main__&quot;</span>:</span>
<span id="cb17-343"><a href="#cb17-343" aria-hidden="true" tabindex="-1"></a>    main()</span></code></pre></div>
<h2 data-number="1.21" id="principais-corre√ß√µes-1"><span class="header-section-number">1.21</span> üîß <strong>Principais
Corre√ß√µes:</strong></h2>
<h3 data-number="1.21.1" id="problema-do-erro-unsupported-operand-types-for"><span class="header-section-number">1.21.1</span> <strong>1. Problema do Erro
<code>unsupported operand type(s) for /</code></strong></h3>
<ul>
<li><strong>Causa</strong>: Estava tentando dividir strings no m√©todo
<code>convert_markdown_to_html_pandoc</code></li>
<li><strong>Solu√ß√£o</strong>: Simplifiquei o tratamento de exce√ß√µes para
mostrar apenas a mensagem de erro</li>
</ul>
<h3 data-number="1.21.2" id="busca-correta-de-arquivos-md"><span class="header-section-number">1.21.2</span> <strong>2. Busca Correta de
Arquivos MD</strong></h3>
<ul>
<li><strong>Problema</strong>: O c√≥digo anterior mencionava 564 arquivos
mas s√≥ criou 206</li>
<li><strong>Solu√ß√£o</strong>: Agora busca os arquivos MD reais da pasta
<code>combined_markdown/</code></li>
</ul>
<h3 data-number="1.21.3" id="logs-mais-claros"><span class="header-section-number">1.21.3</span> <strong>3. Logs Mais
Claros</strong></h3>
<ul>
<li>Mensagens de erro mais espec√≠ficas por arquivo</li>
<li>Contagem precisa de sucessos/falhas</li>
</ul>
<h2 data-number="1.22" id="execute-novamente"><span class="header-section-number">1.22</span> üöÄ <strong>Execute
Novamente:</strong></h2>
<div class="sourceCode" id="cb18"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> comb_fragments_system3_html_export.py <span class="at">--force-overwrite</span></span></code></pre></div>
<p>Agora deve funcionar corretamente! O Pandoc ir√° converter os 206
arquivos Markdown para HTML com <code>--standalone --mathjax</code>.</p>
<p>Se ainda houver problemas, o erro ser√° mais espec√≠fico e poderemos
corrigir.</p>
<hr />
<h3 data-number="1.22.1" id="utilizador-2025-11-05-065417-deepseek-chat"><span class="header-section-number">1.22.1</span> üë§ Utilizador
<em>(2025-11-05 06:54:17)</em> <em>[deepseek-chat]</em></h3>
<p>(Pesquisas) D:_DOCS__DOCS___D_C_G_Qwen_Op&gt;python
comb_fragments_system3_html_export.py ‚Äìforce-overwrite Traceback (most
recent call last): File
‚ÄúD:_DOCS__DOCS___D_C_G_Qwen_Op<em>fragments_system3_html_export.py‚Äù,
line 343, in <module> main() File
‚ÄúD:_DOCS</em>_DOCS___D_C_G_Qwen_Op<em>fragments_system3_html_export.py‚Äù,
line 336, in main system = CombinedFragmentsSystem( <sup></sup> File
‚ÄúD:_DOCS</em>_DOCS___D_C_G_Qwen_Op_fragments_system3_html_export.py‚Äù,
line 45, in <strong>init</strong> ‚Äòmethod‚Äô: self.process_qwen_enhanced,
<sup></sup> AttributeError: ‚ÄòCombinedFragmentsSystem‚Äô object has no
attribute ‚Äòprocess_qwen_enhanced‚Äô parece que
comb_fragments_system3_html_export.py est√° incompleto</p>
<hr />
<h3 data-number="1.22.2" id="deepseek-2025-11-05-065417-deepseek-chat"><span class="header-section-number">1.22.2</span> ü§ñ DeepSeek <em>(2025-11-05
06:54:17)</em> <em>[deepseek-chat]</em></h3>
<p>Tem raz√£o! O arquivo est√° incompleto. Vou fornecer a vers√£o completa
e corrigida:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># comb_fragments_system3_html_export.py</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> zipfile</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> csv</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> argparse</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sys</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> webbrowser</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> shutil</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tempfile</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> traceback</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> subprocess</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Any, Optional</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> CombinedFragmentsSystem:</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, dry_run<span class="op">=</span><span class="va">False</span>, force_overwrite<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.data_dir <span class="op">=</span> Path(<span class="st">&quot;data&quot;</span>)</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.dry_run <span class="op">=</span> dry_run</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.force_overwrite <span class="op">=</span> force_overwrite</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Estrutura de pastas organizada</span></span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.output_dirs <span class="op">=</span> {</span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;markdown&#39;</span>: <span class="st">&quot;combined_markdown&quot;</span>,</span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;csv&#39;</span>: <span class="st">&quot;combined_csv&quot;</span>, </span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;json&#39;</span>: <span class="st">&quot;combined_json&quot;</span>,</span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;pdfs&#39;</span>: <span class="st">&quot;combined_pdfs&quot;</span>,</span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;html&#39;</span>: <span class="st">&quot;combined_html&quot;</span></span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.single_files <span class="op">=</span> {</span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;csv&#39;</span>: <span class="st">&quot;combined_all_conversations.csv&quot;</span>,</span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;json&#39;</span>: <span class="st">&quot;combined_all_conversations.json&quot;</span></span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.index_file <span class="op">=</span> <span class="st">&quot;index.html&quot;</span></span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.all_conversations <span class="op">=</span> []</span>
<span id="cb19-40"><a href="#cb19-40" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-41"><a href="#cb19-41" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Configura√ß√£o de processamento por fonte</span></span>
<span id="cb19-42"><a href="#cb19-42" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.processors <span class="op">=</span> {</span>
<span id="cb19-43"><a href="#cb19-43" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;qwen&#39;</span>: {</span>
<span id="cb19-44"><a href="#cb19-44" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;file&#39;</span>: <span class="st">&quot;chat-export.json&quot;</span>,</span>
<span id="cb19-45"><a href="#cb19-45" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;method&#39;</span>: <span class="va">self</span>.process_qwen_enhanced,</span>
<span id="cb19-46"><a href="#cb19-46" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;enabled&#39;</span>: <span class="va">True</span></span>
<span id="cb19-47"><a href="#cb19-47" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb19-48"><a href="#cb19-48" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;chatgpt&#39;</span>: {</span>
<span id="cb19-49"><a href="#cb19-49" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;file&#39;</span>: <span class="st">&quot;chatgpt.zip&quot;</span>, </span>
<span id="cb19-50"><a href="#cb19-50" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;method&#39;</span>: <span class="va">self</span>.process_chatgpt,</span>
<span id="cb19-51"><a href="#cb19-51" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;enabled&#39;</span>: <span class="va">True</span></span>
<span id="cb19-52"><a href="#cb19-52" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb19-53"><a href="#cb19-53" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;deepseek&#39;</span>: {</span>
<span id="cb19-54"><a href="#cb19-54" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;file&#39;</span>: <span class="st">&quot;deepseek_data.zip&quot;</span>,</span>
<span id="cb19-55"><a href="#cb19-55" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;method&#39;</span>: <span class="va">self</span>.process_deepseek,</span>
<span id="cb19-56"><a href="#cb19-56" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;enabled&#39;</span>: <span class="va">True</span></span>
<span id="cb19-57"><a href="#cb19-57" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb19-58"><a href="#cb19-58" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;grok&#39;</span>: {</span>
<span id="cb19-59"><a href="#cb19-59" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;file&#39;</span>: <span class="st">&quot;grok.zip&quot;</span>,</span>
<span id="cb19-60"><a href="#cb19-60" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;method&#39;</span>: <span class="va">self</span>.process_grok,</span>
<span id="cb19-61"><a href="#cb19-61" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;enabled&#39;</span>: <span class="va">True</span></span>
<span id="cb19-62"><a href="#cb19-62" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb19-63"><a href="#cb19-63" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb19-64"><a href="#cb19-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-65"><a href="#cb19-65" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> sanitize_filename(<span class="va">self</span>, text: <span class="bu">str</span>, max_len: <span class="bu">int</span> <span class="op">=</span> <span class="dv">50</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb19-66"><a href="#cb19-66" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Sanitiza nomes de arquivo PRESERVANDO EMOJIS&quot;&quot;&quot;</span></span>
<span id="cb19-67"><a href="#cb19-67" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> text <span class="kw">or</span> <span class="kw">not</span> <span class="bu">isinstance</span>(text, <span class="bu">str</span>):</span>
<span id="cb19-68"><a href="#cb19-68" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">&quot;conversa_sem_titulo&quot;</span></span>
<span id="cb19-69"><a href="#cb19-69" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb19-70"><a href="#cb19-70" aria-hidden="true" tabindex="-1"></a>        invalid_chars <span class="op">=</span> <span class="vs">r&#39;</span><span class="pp">[&lt;&gt;:&quot;/</span><span class="ch">\\</span><span class="pp">|?*</span><span class="ch">\x00</span><span class="pp">-</span><span class="ch">\x1F\x7F</span><span class="pp">]</span><span class="vs">&#39;</span></span>
<span id="cb19-71"><a href="#cb19-71" aria-hidden="true" tabindex="-1"></a>        sanitized <span class="op">=</span> re.sub(invalid_chars, <span class="st">&#39;&#39;</span>, text)</span>
<span id="cb19-72"><a href="#cb19-72" aria-hidden="true" tabindex="-1"></a>        sanitized <span class="op">=</span> re.sub(<span class="vs">r&#39;</span><span class="dv">\s</span><span class="op">+</span><span class="vs">&#39;</span>, <span class="st">&#39; &#39;</span>, sanitized.strip())</span>
<span id="cb19-73"><a href="#cb19-73" aria-hidden="true" tabindex="-1"></a>        sanitized <span class="op">=</span> sanitized.strip()</span>
<span id="cb19-74"><a href="#cb19-74" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-75"><a href="#cb19-75" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> sanitized:</span>
<span id="cb19-76"><a href="#cb19-76" aria-hidden="true" tabindex="-1"></a>            sanitized <span class="op">=</span> <span class="st">&quot;conversa_sem_titulo&quot;</span></span>
<span id="cb19-77"><a href="#cb19-77" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb19-78"><a href="#cb19-78" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(sanitized) <span class="op">&gt;</span> max_len:</span>
<span id="cb19-79"><a href="#cb19-79" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="st">&#39; &#39;</span> <span class="kw">in</span> sanitized[:max_len]:</span>
<span id="cb19-80"><a href="#cb19-80" aria-hidden="true" tabindex="-1"></a>                last_space <span class="op">=</span> sanitized[:max_len].rfind(<span class="st">&#39; &#39;</span>)</span>
<span id="cb19-81"><a href="#cb19-81" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> last_space <span class="op">&gt;</span> <span class="dv">10</span>:</span>
<span id="cb19-82"><a href="#cb19-82" aria-hidden="true" tabindex="-1"></a>                    sanitized <span class="op">=</span> sanitized[:last_space]</span>
<span id="cb19-83"><a href="#cb19-83" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb19-84"><a href="#cb19-84" aria-hidden="true" tabindex="-1"></a>                sanitized <span class="op">=</span> sanitized[:max_len]</span>
<span id="cb19-85"><a href="#cb19-85" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb19-86"><a href="#cb19-86" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> sanitized</span>
<span id="cb19-87"><a href="#cb19-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-88"><a href="#cb19-88" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> preserve_special_content(<span class="va">self</span>, content: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb19-89"><a href="#cb19-89" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Preserva f√≥rmulas matem√°ticas, c√≥digo e formata√ß√£o especial&quot;&quot;&quot;</span></span>
<span id="cb19-90"><a href="#cb19-90" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> content:</span>
<span id="cb19-91"><a href="#cb19-91" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">&quot;&quot;</span></span>
<span id="cb19-92"><a href="#cb19-92" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb19-93"><a href="#cb19-93" aria-hidden="true" tabindex="-1"></a>        preserved_content <span class="op">=</span> content</span>
<span id="cb19-94"><a href="#cb19-94" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-95"><a href="#cb19-95" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Corrige problemas com barras invertidas em LaTeX</span></span>
<span id="cb19-96"><a href="#cb19-96" aria-hidden="true" tabindex="-1"></a>        latex_corrections <span class="op">=</span> {</span>
<span id="cb19-97"><a href="#cb19-97" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;‚ôÄrac&#39;</span>: <span class="st">&#39;</span><span class="ch">\\</span><span class="st">frac&#39;</span>,</span>
<span id="cb19-98"><a href="#cb19-98" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;‚ôÇarepsilon&#39;</span>: <span class="st">&#39;</span><span class="ch">\\</span><span class="st">varepsilon&#39;</span>,</span>
<span id="cb19-99"><a href="#cb19-99" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;‚ôÇ&#39;</span>: <span class="st">&#39;</span><span class="ch">\\</span><span class="st">&#39;</span>,</span>
<span id="cb19-100"><a href="#cb19-100" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;‚ôÄ&#39;</span>: <span class="st">&#39;</span><span class="ch">\\</span><span class="st">&#39;</span></span>
<span id="cb19-101"><a href="#cb19-101" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb19-102"><a href="#cb19-102" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-103"><a href="#cb19-103" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> wrong, correct <span class="kw">in</span> latex_corrections.items():</span>
<span id="cb19-104"><a href="#cb19-104" aria-hidden="true" tabindex="-1"></a>            preserved_content <span class="op">=</span> preserved_content.replace(wrong, correct)</span>
<span id="cb19-105"><a href="#cb19-105" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-106"><a href="#cb19-106" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> preserved_content</span>
<span id="cb19-107"><a href="#cb19-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-108"><a href="#cb19-108" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> ensure_directories(<span class="va">self</span>):</span>
<span id="cb19-109"><a href="#cb19-109" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Cria todas as pastas necess√°rias&quot;&quot;&quot;</span></span>
<span id="cb19-110"><a href="#cb19-110" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb19-111"><a href="#cb19-111" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;DRY-RUN: Pastas seriam criadas:&quot;</span>)</span>
<span id="cb19-112"><a href="#cb19-112" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> folder <span class="kw">in</span> <span class="va">self</span>.output_dirs.values():</span>
<span id="cb19-113"><a href="#cb19-113" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;   </span><span class="sc">{</span>folder<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb19-114"><a href="#cb19-114" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb19-115"><a href="#cb19-115" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb19-116"><a href="#cb19-116" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> folder <span class="kw">in</span> <span class="va">self</span>.output_dirs.values():</span>
<span id="cb19-117"><a href="#cb19-117" aria-hidden="true" tabindex="-1"></a>            Path(folder).mkdir(parents<span class="op">=</span><span class="va">True</span>, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb19-118"><a href="#cb19-118" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;Pasta criada: </span><span class="sc">{</span>folder<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb19-119"><a href="#cb19-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-120"><a href="#cb19-120" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> run(<span class="va">self</span>):</span>
<span id="cb19-121"><a href="#cb19-121" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Executa o processamento completo&quot;&quot;&quot;</span></span>
<span id="cb19-122"><a href="#cb19-122" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;SISTEMA COMBINADO DE EXPORTA√á√ïES COM HTML (Qwen3, ChatGPT, DeepSeek, Grok)&quot;</span>)</span>
<span id="cb19-123"><a href="#cb19-123" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;=&quot;</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb19-124"><a href="#cb19-124" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-125"><a href="#cb19-125" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.data_dir.exists():</span>
<span id="cb19-126"><a href="#cb19-126" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;Pasta &#39;</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>data_dir<span class="sc">}</span><span class="ss">&#39; n√£o encontrada.&quot;</span>)</span>
<span id="cb19-127"><a href="#cb19-127" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;Crie a pasta &#39;data&#39; e coloque os arquivos de exporta√ß√£o:&quot;</span>)</span>
<span id="cb19-128"><a href="#cb19-128" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> source_name, config <span class="kw">in</span> <span class="va">self</span>.processors.items():</span>
<span id="cb19-129"><a href="#cb19-129" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;   - </span><span class="sc">{</span>config[<span class="st">&#39;file&#39;</span>]<span class="sc">}</span><span class="ss"> (para </span><span class="sc">{</span>source_name<span class="sc">.</span>upper()<span class="sc">}</span><span class="ss">)&quot;</span>)</span>
<span id="cb19-130"><a href="#cb19-130" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb19-131"><a href="#cb19-131" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-132"><a href="#cb19-132" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;Usando pasta de dados: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>data_dir<span class="sc">.</span>absolute()<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb19-133"><a href="#cb19-133" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-134"><a href="#cb19-134" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.ensure_directories()</span>
<span id="cb19-135"><a href="#cb19-135" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-136"><a href="#cb19-136" aria-hidden="true" tabindex="-1"></a>        processed_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb19-137"><a href="#cb19-137" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> source_name, config <span class="kw">in</span> <span class="va">self</span>.processors.items():</span>
<span id="cb19-138"><a href="#cb19-138" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> config[<span class="st">&#39;enabled&#39;</span>]:</span>
<span id="cb19-139"><a href="#cb19-139" aria-hidden="true" tabindex="-1"></a>                file_path <span class="op">=</span> <span class="va">self</span>.data_dir <span class="op">/</span> config[<span class="st">&#39;file&#39;</span>]</span>
<span id="cb19-140"><a href="#cb19-140" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> file_path.exists():</span>
<span id="cb19-141"><a href="#cb19-141" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="ch">\n</span><span class="ss">Processando </span><span class="sc">{</span>source_name<span class="sc">.</span>upper()<span class="sc">}</span><span class="ss">...&quot;</span>)</span>
<span id="cb19-142"><a href="#cb19-142" aria-hidden="true" tabindex="-1"></a>                    config[<span class="st">&#39;method&#39;</span>](file_path)</span>
<span id="cb19-143"><a href="#cb19-143" aria-hidden="true" tabindex="-1"></a>                    processed_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb19-144"><a href="#cb19-144" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb19-145"><a href="#cb19-145" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="sc">{</span>source_name<span class="sc">.</span>upper()<span class="sc">}</span><span class="ss">: arquivo n√£o encontrado - </span><span class="sc">{</span>file_path<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb19-146"><a href="#cb19-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-147"><a href="#cb19-147" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> processed_count <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb19-148"><a href="#cb19-148" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;Nenhum arquivo de exporta√ß√£o encontrado na pasta &#39;data&#39;.&quot;</span>)</span>
<span id="cb19-149"><a href="#cb19-149" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb19-150"><a href="#cb19-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-151"><a href="#cb19-151" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb19-152"><a href="#cb19-152" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;Nenhuma conversa foi extra√≠da dos arquivos.&quot;</span>)</span>
<span id="cb19-153"><a href="#cb19-153" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb19-154"><a href="#cb19-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-155"><a href="#cb19-155" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>._post_process_conversations()</span>
<span id="cb19-156"><a href="#cb19-156" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-157"><a href="#cb19-157" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.dry_run:</span>
<span id="cb19-158"><a href="#cb19-158" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>._export_all_formats()</span>
<span id="cb19-159"><a href="#cb19-159" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="ch">\n</span><span class="ss">üéâ SISTEMA COMBINADO FINALIZADO!&quot;</span>)</span>
<span id="cb19-160"><a href="#cb19-160" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;üìÑ √çndice: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>index_file<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb19-161"><a href="#cb19-161" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> Path(<span class="va">self</span>.index_file).exists():</span>
<span id="cb19-162"><a href="#cb19-162" aria-hidden="true" tabindex="-1"></a>                webbrowser.<span class="bu">open</span>(<span class="ss">f&#39;file://</span><span class="sc">{</span>Path(<span class="va">self</span>.index_file)<span class="sc">.</span>absolute()<span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb19-163"><a href="#cb19-163" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb19-164"><a href="#cb19-164" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="ch">\n</span><span class="ss">üß™ MODO DRY-RUN: Nenhum arquivo foi criado.&quot;</span>)</span>
<span id="cb19-165"><a href="#cb19-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-166"><a href="#cb19-166" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _post_process_conversations(<span class="va">self</span>):</span>
<span id="cb19-167"><a href="#cb19-167" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Processamento p√≥s-extra√ß√£o das conversas&quot;&quot;&quot;</span></span>
<span id="cb19-168"><a href="#cb19-168" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.all_conversations.sort(</span>
<span id="cb19-169"><a href="#cb19-169" aria-hidden="true" tabindex="-1"></a>            key<span class="op">=</span><span class="kw">lambda</span> x: <span class="va">self</span>.parse_timestamp_for_sorting(</span>
<span id="cb19-170"><a href="#cb19-170" aria-hidden="true" tabindex="-1"></a>                x.get(<span class="st">&#39;updated_at&#39;</span>) <span class="kw">or</span> x.get(<span class="st">&#39;inserted_at&#39;</span>) <span class="kw">or</span> x.get(<span class="st">&#39;created_at&#39;</span>)</span>
<span id="cb19-171"><a href="#cb19-171" aria-hidden="true" tabindex="-1"></a>            ),</span>
<span id="cb19-172"><a href="#cb19-172" aria-hidden="true" tabindex="-1"></a>            reverse<span class="op">=</span><span class="va">True</span></span>
<span id="cb19-173"><a href="#cb19-173" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb19-174"><a href="#cb19-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-175"><a href="#cb19-175" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, conv <span class="kw">in</span> <span class="bu">enumerate</span>(<span class="va">self</span>.all_conversations):</span>
<span id="cb19-176"><a href="#cb19-176" aria-hidden="true" tabindex="-1"></a>            conv[<span class="st">&#39;number&#39;</span>] <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb19-177"><a href="#cb19-177" aria-hidden="true" tabindex="-1"></a>            conv[<span class="st">&#39;category&#39;</span>] <span class="op">=</span> <span class="va">self</span>.categorize_conversation(conv[<span class="st">&#39;title&#39;</span>], conv.get(<span class="st">&#39;summary&#39;</span>, <span class="st">&#39;&#39;</span>))</span>
<span id="cb19-178"><a href="#cb19-178" aria-hidden="true" tabindex="-1"></a>            conv.setdefault(<span class="st">&#39;source&#39;</span>, <span class="st">&#39;Desconhecido&#39;</span>)</span>
<span id="cb19-179"><a href="#cb19-179" aria-hidden="true" tabindex="-1"></a>            conv.setdefault(<span class="st">&#39;messages&#39;</span>, [])</span>
<span id="cb19-180"><a href="#cb19-180" aria-hidden="true" tabindex="-1"></a>            conv.setdefault(<span class="st">&#39;summary&#39;</span>, conv[<span class="st">&#39;messages&#39;</span>][<span class="dv">0</span>][<span class="st">&#39;content&#39;</span>][:<span class="dv">100</span>] <span class="op">+</span> <span class="st">&quot;...&quot;</span> <span class="cf">if</span> conv[<span class="st">&#39;messages&#39;</span>] <span class="cf">else</span> <span class="st">&quot;Sem conte√∫do&quot;</span>)</span>
<span id="cb19-181"><a href="#cb19-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-182"><a href="#cb19-182" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;üìä Total combinado de conversas: </span><span class="sc">{</span><span class="bu">len</span>(<span class="va">self</span>.all_conversations)<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb19-183"><a href="#cb19-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-184"><a href="#cb19-184" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _export_all_formats(<span class="va">self</span>):</span>
<span id="cb19-185"><a href="#cb19-185" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Exporta para todos os formatos&quot;&quot;&quot;</span></span>
<span id="cb19-186"><a href="#cb19-186" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">üíæ Exportando para formatos...&quot;</span>)</span>
<span id="cb19-187"><a href="#cb19-187" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.save_as_markdown_enhanced()</span>
<span id="cb19-188"><a href="#cb19-188" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.save_as_html_with_pandoc()</span>
<span id="cb19-189"><a href="#cb19-189" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.save_as_csv() </span>
<span id="cb19-190"><a href="#cb19-190" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.save_as_json()</span>
<span id="cb19-191"><a href="#cb19-191" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.save_all_to_single_files()</span>
<span id="cb19-192"><a href="#cb19-192" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.create_searchable_index()</span>
<span id="cb19-193"><a href="#cb19-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-194"><a href="#cb19-194" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> check_pandoc_available(<span class="va">self</span>) <span class="op">-&gt;</span> <span class="bu">bool</span>:</span>
<span id="cb19-195"><a href="#cb19-195" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Verifica se Pandoc est√° dispon√≠vel&quot;&quot;&quot;</span></span>
<span id="cb19-196"><a href="#cb19-196" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb19-197"><a href="#cb19-197" aria-hidden="true" tabindex="-1"></a>            result <span class="op">=</span> subprocess.run(</span>
<span id="cb19-198"><a href="#cb19-198" aria-hidden="true" tabindex="-1"></a>                [<span class="st">&#39;pandoc&#39;</span>, <span class="st">&#39;--version&#39;</span>], </span>
<span id="cb19-199"><a href="#cb19-199" aria-hidden="true" tabindex="-1"></a>                capture_output<span class="op">=</span><span class="va">True</span>, </span>
<span id="cb19-200"><a href="#cb19-200" aria-hidden="true" tabindex="-1"></a>                text<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb19-201"><a href="#cb19-201" aria-hidden="true" tabindex="-1"></a>                timeout<span class="op">=</span><span class="dv">10</span></span>
<span id="cb19-202"><a href="#cb19-202" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb19-203"><a href="#cb19-203" aria-hidden="true" tabindex="-1"></a>            available <span class="op">=</span> result.returncode <span class="op">==</span> <span class="dv">0</span></span>
<span id="cb19-204"><a href="#cb19-204" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> available:</span>
<span id="cb19-205"><a href="#cb19-205" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;‚úÖ Pandoc dispon√≠vel para convers√£o HTML&quot;</span>)</span>
<span id="cb19-206"><a href="#cb19-206" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb19-207"><a href="#cb19-207" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;‚ö†Ô∏è Pandoc n√£o encontrado - HTML n√£o ser√° gerado&quot;</span>)</span>
<span id="cb19-208"><a href="#cb19-208" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> available</span>
<span id="cb19-209"><a href="#cb19-209" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> (subprocess.TimeoutExpired, <span class="pp">FileNotFoundError</span>, <span class="pp">Exception</span>) <span class="im">as</span> e:</span>
<span id="cb19-210"><a href="#cb19-210" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚ö†Ô∏è Pandoc n√£o dispon√≠vel: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb19-211"><a href="#cb19-211" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb19-212"><a href="#cb19-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-213"><a href="#cb19-213" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> convert_markdown_to_html_pandoc(<span class="va">self</span>, md_file_path: Path) <span class="op">-&gt;</span> <span class="bu">bool</span>:</span>
<span id="cb19-214"><a href="#cb19-214" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Converte Markdown para HTML usando Pandoc --standalone --mathjax&quot;&quot;&quot;</span></span>
<span id="cb19-215"><a href="#cb19-215" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb19-216"><a href="#cb19-216" aria-hidden="true" tabindex="-1"></a>            html_file <span class="op">=</span> <span class="va">self</span>.output_dirs[<span class="st">&#39;html&#39;</span>] <span class="op">/</span> md_file_path.with_suffix(<span class="st">&#39;.html&#39;</span>).name</span>
<span id="cb19-217"><a href="#cb19-217" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb19-218"><a href="#cb19-218" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.force_overwrite <span class="kw">and</span> html_file.exists():</span>
<span id="cb19-219"><a href="#cb19-219" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;‚è≠Ô∏è HTML j√° existe: </span><span class="sc">{</span>html_file<span class="sc">.</span>name<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb19-220"><a href="#cb19-220" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb19-221"><a href="#cb19-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-222"><a href="#cb19-222" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;üîß Convertendo com Pandoc: </span><span class="sc">{</span>md_file_path<span class="sc">.</span>name<span class="sc">}</span><span class="ss"> ‚Üí </span><span class="sc">{</span>html_file<span class="sc">.</span>name<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb19-223"><a href="#cb19-223" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb19-224"><a href="#cb19-224" aria-hidden="true" tabindex="-1"></a>            result <span class="op">=</span> subprocess.run([</span>
<span id="cb19-225"><a href="#cb19-225" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;pandoc&#39;</span>, </span>
<span id="cb19-226"><a href="#cb19-226" aria-hidden="true" tabindex="-1"></a>                <span class="bu">str</span>(md_file_path),</span>
<span id="cb19-227"><a href="#cb19-227" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;--from&#39;</span>, <span class="st">&#39;markdown+emoji&#39;</span>,</span>
<span id="cb19-228"><a href="#cb19-228" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;--to&#39;</span>, <span class="st">&#39;html5&#39;</span>,</span>
<span id="cb19-229"><a href="#cb19-229" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;--standalone&#39;</span>,</span>
<span id="cb19-230"><a href="#cb19-230" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;--mathjax&#39;</span>,</span>
<span id="cb19-231"><a href="#cb19-231" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;--output&#39;</span>, <span class="bu">str</span>(html_file)</span>
<span id="cb19-232"><a href="#cb19-232" aria-hidden="true" tabindex="-1"></a>            ], capture_output<span class="op">=</span><span class="va">True</span>, text<span class="op">=</span><span class="va">True</span>, timeout<span class="op">=</span><span class="dv">30</span>)</span>
<span id="cb19-233"><a href="#cb19-233" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb19-234"><a href="#cb19-234" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> result.returncode <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb19-235"><a href="#cb19-235" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ HTML gerado: </span><span class="sc">{</span>html_file<span class="sc">.</span>name<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb19-236"><a href="#cb19-236" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb19-237"><a href="#cb19-237" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb19-238"><a href="#cb19-238" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;‚ùå Erro no Pandoc para </span><span class="sc">{</span>md_file_path<span class="sc">.</span>name<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>result<span class="sc">.</span>stderr<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb19-239"><a href="#cb19-239" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb19-240"><a href="#cb19-240" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb19-241"><a href="#cb19-241" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> subprocess.TimeoutExpired:</span>
<span id="cb19-242"><a href="#cb19-242" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚è∞ Timeout no Pandoc para </span><span class="sc">{</span>md_file_path<span class="sc">.</span>name<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb19-243"><a href="#cb19-243" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb19-244"><a href="#cb19-244" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb19-245"><a href="#cb19-245" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚ùå Erro inesperado no Pandoc para </span><span class="sc">{</span>md_file_path<span class="sc">.</span>name<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span><span class="bu">str</span>(e)<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb19-246"><a href="#cb19-246" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb19-247"><a href="#cb19-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-248"><a href="#cb19-248" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> save_as_html_with_pandoc(<span class="va">self</span>):</span>
<span id="cb19-249"><a href="#cb19-249" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Converte arquivos Markdown para HTML usando Pandoc --standalone --mathjax&quot;&quot;&quot;</span></span>
<span id="cb19-250"><a href="#cb19-250" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb19-251"><a href="#cb19-251" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;üß™ [DRY-RUN] HTMLs seriam criados com Pandoc:&quot;</span>)</span>
<span id="cb19-252"><a href="#cb19-252" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> conv <span class="kw">in</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb19-253"><a href="#cb19-253" aria-hidden="true" tabindex="-1"></a>                safe_title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(conv[<span class="st">&#39;title&#39;</span>])</span>
<span id="cb19-254"><a href="#cb19-254" aria-hidden="true" tabindex="-1"></a>                filename <span class="op">=</span> <span class="ss">f&quot;</span><span class="sc">{</span>conv[<span class="st">&#39;number&#39;</span>]<span class="sc">:03d}</span><span class="ss">_</span><span class="sc">{</span>conv[<span class="st">&#39;source&#39;</span>]<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>safe_title<span class="sc">}</span><span class="ss">.html&quot;</span></span>
<span id="cb19-255"><a href="#cb19-255" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;   üåê </span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss"> (via Pandoc)&quot;</span>)</span>
<span id="cb19-256"><a href="#cb19-256" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb19-257"><a href="#cb19-257" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-258"><a href="#cb19-258" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.check_pandoc_available():</span>
<span id="cb19-259"><a href="#cb19-259" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;‚ùå Pandoc n√£o dispon√≠vel. HTMLs n√£o ser√£o gerados.&quot;</span>)</span>
<span id="cb19-260"><a href="#cb19-260" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb19-261"><a href="#cb19-261" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb19-262"><a href="#cb19-262" aria-hidden="true" tabindex="-1"></a>        markdown_folder <span class="op">=</span> <span class="va">self</span>.output_dirs[<span class="st">&#39;markdown&#39;</span>]</span>
<span id="cb19-263"><a href="#cb19-263" aria-hidden="true" tabindex="-1"></a>        html_folder <span class="op">=</span> <span class="va">self</span>.output_dirs[<span class="st">&#39;html&#39;</span>]</span>
<span id="cb19-264"><a href="#cb19-264" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-265"><a href="#cb19-265" aria-hidden="true" tabindex="-1"></a>        md_files <span class="op">=</span> <span class="bu">list</span>(Path(markdown_folder).glob(<span class="st">&quot;*.md&quot;</span>))</span>
<span id="cb19-266"><a href="#cb19-266" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-267"><a href="#cb19-267" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> md_files:</span>
<span id="cb19-268"><a href="#cb19-268" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;‚ùå Nenhum arquivo Markdown encontrado para convers√£o.&quot;</span>)</span>
<span id="cb19-269"><a href="#cb19-269" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb19-270"><a href="#cb19-270" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-271"><a href="#cb19-271" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;üîÑ Convertendo </span><span class="sc">{</span><span class="bu">len</span>(md_files)<span class="sc">}</span><span class="ss"> arquivos Markdown para HTML com Pandoc...&quot;</span>)</span>
<span id="cb19-272"><a href="#cb19-272" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-273"><a href="#cb19-273" aria-hidden="true" tabindex="-1"></a>        converted_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb19-274"><a href="#cb19-274" aria-hidden="true" tabindex="-1"></a>        failed_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb19-275"><a href="#cb19-275" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-276"><a href="#cb19-276" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> md_file <span class="kw">in</span> md_files:</span>
<span id="cb19-277"><a href="#cb19-277" aria-hidden="true" tabindex="-1"></a>            success <span class="op">=</span> <span class="va">self</span>.convert_markdown_to_html_pandoc(md_file)</span>
<span id="cb19-278"><a href="#cb19-278" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> success:</span>
<span id="cb19-279"><a href="#cb19-279" aria-hidden="true" tabindex="-1"></a>                converted_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb19-280"><a href="#cb19-280" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb19-281"><a href="#cb19-281" aria-hidden="true" tabindex="-1"></a>                failed_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb19-282"><a href="#cb19-282" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb19-283"><a href="#cb19-283" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ HTML: </span><span class="sc">{</span>converted_count<span class="sc">}</span><span class="ss"> arquivos criados, </span><span class="sc">{</span>failed_count<span class="sc">}</span><span class="ss"> falhas em &#39;</span><span class="sc">{</span>html_folder<span class="sc">}</span><span class="ss">&#39;&quot;</span>)</span>
<span id="cb19-284"><a href="#cb19-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-285"><a href="#cb19-285" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> categorize_conversation(<span class="va">self</span>, title: <span class="bu">str</span>, summary: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb19-286"><a href="#cb19-286" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Categoriza√ß√£o otimizada com express√µes regulares&quot;&quot;&quot;</span></span>
<span id="cb19-287"><a href="#cb19-287" aria-hidden="true" tabindex="-1"></a>        text <span class="op">=</span> <span class="ss">f&quot;</span><span class="sc">{</span>title<span class="sc">}</span><span class="ss"> </span><span class="sc">{</span>summary<span class="sc">}</span><span class="ss">&quot;</span>.lower()</span>
<span id="cb19-288"><a href="#cb19-288" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-289"><a href="#cb19-289" aria-hidden="true" tabindex="-1"></a>        patterns <span class="op">=</span> {</span>
<span id="cb19-290"><a href="#cb19-290" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Tecnologia&#39;</span>: <span class="vs">r&#39;</span><span class="dv">\b</span><span class="kw">(</span><span class="vs">tecnologia</span><span class="cf">|</span><span class="vs">hardware</span><span class="cf">|</span><span class="vs">software</span><span class="cf">|</span><span class="vs">rede</span><span class="cf">|</span><span class="vs">internet</span><span class="cf">|</span><span class="vs">wifi</span><span class="cf">|</span><span class="vs">bluetooth</span><span class="cf">|</span><span class="pp">[45]</span><span class="vs">g</span><span class="cf">|</span><span class="vs">cloud</span><span class="cf">|</span><span class="vs">aws</span><span class="cf">|</span><span class="vs">azure</span><span class="cf">|</span><span class="vs">gcp</span><span class="cf">|</span><span class="vs">servidor</span><span class="cf">|</span><span class="vs">hosting</span><span class="cf">|</span><span class="vs">dom√≠nio</span><span class="cf">|</span><span class="vs">ssl</span><span class="cf">|</span><span class="vs">router</span><span class="cf">|</span><span class="vs">switch</span><span class="cf">|</span><span class="vs">firewall</span><span class="cf">|</span><span class="vs">iot</span><span class="cf">|</span><span class="vs">smartphone</span><span class="cf">|</span><span class="vs">tablet</span><span class="cf">|</span><span class="vs">navegador</span><span class="cf">|</span><span class="vs">browser</span><span class="cf">|</span><span class="vs">chrome</span><span class="cf">|</span><span class="vs">firefox</span><span class="cf">|</span><span class="vs">edge</span><span class="cf">|</span><span class="vs">safari</span><span class="cf">|</span><span class="vs">email</span><span class="cf">|</span><span class="vs">gmail</span><span class="cf">|</span><span class="vs">outlook</span><span class="cf">|</span><span class="vs">criptografia</span><span class="cf">|</span><span class="vs">seguran√ßa</span><span class="cf">|</span><span class="vs">ciberseguran√ßa</span><span class="cf">|</span><span class="vs">ransomware</span><span class="cf">|</span><span class="vs">phishing</span><span class="cf">|</span><span class="vs">autentica√ß√£o</span><span class="cf">|</span><span class="vs">2fa</span><span class="cf">|</span><span class="vs">biometria</span><span class="kw">)</span><span class="dv">\b</span><span class="vs">&#39;</span>,</span>
<span id="cb19-291"><a href="#cb19-291" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Sa√∫de&#39;</span>: <span class="vs">r&#39;</span><span class="dv">\b</span><span class="kw">(</span><span class="vs">sa√∫de</span><span class="cf">|</span><span class="vs">medicina</span><span class="cf">|</span><span class="vs">m√©dico</span><span class="cf">|</span><span class="vs">enfermagem</span><span class="cf">|</span><span class="vs">doen√ßa</span><span class="cf">|</span><span class="vs">v√≠rus</span><span class="cf">|</span><span class="vs">bact√©ria</span><span class="cf">|</span><span class="vs">vacina</span><span class="cf">|</span><span class="vs">covid</span><span class="cf">|</span><span class="vs">coronav√≠rus</span><span class="cf">|</span><span class="vs">gripe</span><span class="cf">|</span><span class="vs">febre</span><span class="cf">|</span><span class="vs">dor</span><span class="cf">|</span><span class="vs">an√°lise</span><span class="cf">|</span><span class="vs">exame</span><span class="cf">|</span><span class="vs">raio x</span><span class="cf">|</span><span class="vs">resson√¢ncia</span><span class="cf">|</span><span class="vs">hospital</span><span class="cf">|</span><span class="vs">cl√≠nica</span><span class="cf">|</span><span class="vs">farm√°cia</span><span class="cf">|</span><span class="vs">medicamento</span><span class="cf">|</span><span class="vs">rem√©dio</span><span class="cf">|</span><span class="vs">psicologia</span><span class="cf">|</span><span class="vs">terapia</span><span class="cf">|</span><span class="vs">bem-estar</span><span class="cf">|</span><span class="vs">nutri√ß√£o</span><span class="cf">|</span><span class="vs">dieta</span><span class="cf">|</span><span class="vs">exerc√≠cio</span><span class="cf">|</span><span class="vs">fitness</span><span class="cf">|</span><span class="vs">sono</span><span class="cf">|</span><span class="vs">sa√∫de mental</span><span class="kw">)</span><span class="dv">\b</span><span class="vs">&#39;</span>,</span>
<span id="cb19-292"><a href="#cb19-292" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Programa√ß√£o&#39;</span>: <span class="vs">r&#39;</span><span class="dv">\b</span><span class="kw">(</span><span class="vs">python</span><span class="cf">|</span><span class="vs">javascript</span><span class="cf">|</span><span class="vs">java</span><span class="cf">|</span><span class="vs">c</span><span class="ch">\+\+</span><span class="cf">|</span><span class="vs">c#</span><span class="cf">|</span><span class="vs">go</span><span class="cf">|</span><span class="vs">rust</span><span class="cf">|</span><span class="vs">lua</span><span class="cf">|</span><span class="vs">bash</span><span class="cf">|</span><span class="vs">script</span><span class="cf">|</span><span class="vs">debug</span><span class="cf">|</span><span class="vs">erro</span><span class="cf">|</span><span class="vs">conda</span><span class="cf">|</span><span class="vs">mamba</span><span class="cf">|</span><span class="vs">pandoc</span><span class="cf">|</span><span class="vs">msys2</span><span class="cf">|</span><span class="vs">spyder</span><span class="cf">|</span><span class="vs">jupyter</span><span class="cf">|</span><span class="vs">pip</span><span class="cf">|</span><span class="vs">venv</span><span class="cf">|</span><span class="vs">docker</span><span class="cf">|</span><span class="vs">git</span><span class="cf">|</span><span class="vs">github</span><span class="cf">|</span><span class="vs">vscode</span><span class="cf">|</span><span class="vs">ide</span><span class="cf">|</span><span class="vs">programa</span><span class="cf">|</span><span class="vs">c√≥digo</span><span class="cf">|</span><span class="vs">fun√ß√£o</span><span class="cf">|</span><span class="vs">classe</span><span class="cf">|</span><span class="vs">api</span><span class="cf">|</span><span class="vs">selenium</span><span class="cf">|</span><span class="vs">playwright</span><span class="kw">)</span><span class="dv">\b</span><span class="vs">&#39;</span>,</span>
<span id="cb19-293"><a href="#cb19-293" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Sistemas&#39;</span>: <span class="vs">r&#39;</span><span class="dv">\b</span><span class="kw">(</span><span class="vs">windows</span><span class="cf">|</span><span class="vs">linux</span><span class="cf">|</span><span class="vs">macos</span><span class="cf">|</span><span class="vs">so</span><span class="cf">|</span><span class="vs">sistema operacional</span><span class="cf">|</span><span class="vs">driver</span><span class="cf">|</span><span class="vs">registry</span><span class="cf">|</span><span class="vs">process</span><span class="cf">|</span><span class="vs">firewall</span><span class="cf">|</span><span class="vs">bios</span><span class="cf">|</span><span class="vs">boot</span><span class="cf">|</span><span class="vs">path</span><span class="cf">|</span><span class="vs">dll</span><span class="cf">|</span><span class="vs">exe</span><span class="cf">|</span><span class="vs">powershell</span><span class="cf">|</span><span class="vs">cmd</span><span class="cf">|</span><span class="vs">terminal</span><span class="cf">|</span><span class="vs">shell</span><span class="kw">)</span><span class="dv">\b</span><span class="vs">&#39;</span>,</span>
<span id="cb19-294"><a href="#cb19-294" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;IA&#39;</span>: <span class="vs">r&#39;</span><span class="dv">\b</span><span class="kw">(</span><span class="vs">ia</span><span class="cf">|</span><span class="vs">gpt</span><span class="cf">|</span><span class="vs">chatgpt</span><span class="cf">|</span><span class="vs">grok</span><span class="cf">|</span><span class="vs">qwen</span><span class="cf">|</span><span class="vs">deepseek</span><span class="cf">|</span><span class="vs">llm</span><span class="cf">|</span><span class="vs">modelo</span><span class="cf">|</span><span class="vs">prompt</span><span class="cf">|</span><span class="vs">token</span><span class="cf">|</span><span class="vs">embedding</span><span class="cf">|</span><span class="vs">fine-tune</span><span class="cf">|</span><span class="vs">neural</span><span class="cf">|</span><span class="vs">chatbot</span><span class="cf">|</span><span class="vs">intelig√™ncia artificial</span><span class="kw">)</span><span class="dv">\b</span><span class="vs">&#39;</span>,</span>
<span id="cb19-295"><a href="#cb19-295" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Dados&#39;</span>: <span class="vs">r&#39;</span><span class="dv">\b</span><span class="kw">(</span><span class="vs">dados</span><span class="cf">|</span><span class="vs">data</span><span class="cf">|</span><span class="vs">csv</span><span class="cf">|</span><span class="vs">json</span><span class="cf">|</span><span class="vs">pandas</span><span class="cf">|</span><span class="vs">numpy</span><span class="cf">|</span><span class="vs">excel</span><span class="cf">|</span><span class="vs">sql</span><span class="cf">|</span><span class="vs">banco</span><span class="cf">|</span><span class="vs">sqlite</span><span class="cf">|</span><span class="vs">postgres</span><span class="cf">|</span><span class="vs">visualiza√ß√£o</span><span class="cf">|</span><span class="vs">gr√°fico</span><span class="cf">|</span><span class="vs">tabela</span><span class="cf">|</span><span class="vs">an√°lise</span><span class="cf">|</span><span class="vs">etl</span><span class="cf">|</span><span class="vs">dashboard</span><span class="kw">)</span><span class="dv">\b</span><span class="vs">&#39;</span>,</span>
<span id="cb19-296"><a href="#cb19-296" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Geral&#39;</span>: <span class="vs">r&#39;</span><span class="dv">\b</span><span class="kw">(</span><span class="vs">geral</span><span class="cf">|</span><span class="vs">pergunta</span><span class="cf">|</span><span class="vs">ajuda</span><span class="cf">|</span><span class="vs">como fazer</span><span class="cf">|</span><span class="vs">explicar</span><span class="cf">|</span><span class="vs">resumo</span><span class="cf">|</span><span class="vs">tutorial b√°sico</span><span class="kw">)</span><span class="dv">\b</span><span class="vs">&#39;</span></span>
<span id="cb19-297"><a href="#cb19-297" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb19-298"><a href="#cb19-298" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-299"><a href="#cb19-299" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> category, pattern <span class="kw">in</span> patterns.items():</span>
<span id="cb19-300"><a href="#cb19-300" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> re.search(pattern, text, re.IGNORECASE):</span>
<span id="cb19-301"><a href="#cb19-301" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> category</span>
<span id="cb19-302"><a href="#cb19-302" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb19-303"><a href="#cb19-303" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">&#39;Outros&#39;</span></span>
<span id="cb19-304"><a href="#cb19-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-305"><a href="#cb19-305" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> parse_timestamp_for_sorting(<span class="va">self</span>, timestamp) <span class="op">-&gt;</span> datetime:</span>
<span id="cb19-306"><a href="#cb19-306" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> timestamp:</span>
<span id="cb19-307"><a href="#cb19-307" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> datetime.<span class="bu">min</span></span>
<span id="cb19-308"><a href="#cb19-308" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb19-309"><a href="#cb19-309" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb19-310"><a href="#cb19-310" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">isinstance</span>(timestamp, <span class="bu">str</span>):</span>
<span id="cb19-311"><a href="#cb19-311" aria-hidden="true" tabindex="-1"></a>                clean_ts <span class="op">=</span> timestamp.replace(<span class="st">&#39;T&#39;</span>, <span class="st">&#39; &#39;</span>).split(<span class="st">&#39;.&#39;</span>)[<span class="dv">0</span>].split(<span class="st">&#39;+&#39;</span>)[<span class="dv">0</span>]</span>
<span id="cb19-312"><a href="#cb19-312" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> clean_ts.endswith(<span class="st">&#39;Z&#39;</span>):</span>
<span id="cb19-313"><a href="#cb19-313" aria-hidden="true" tabindex="-1"></a>                    clean_ts <span class="op">=</span> clean_ts[:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb19-314"><a href="#cb19-314" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> datetime.fromisoformat(clean_ts)</span>
<span id="cb19-315"><a href="#cb19-315" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> <span class="bu">isinstance</span>(timestamp, (<span class="bu">int</span>, <span class="bu">float</span>)):</span>
<span id="cb19-316"><a href="#cb19-316" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> datetime.fromtimestamp(timestamp)</span>
<span id="cb19-317"><a href="#cb19-317" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span>:</span>
<span id="cb19-318"><a href="#cb19-318" aria-hidden="true" tabindex="-1"></a>            <span class="cf">pass</span></span>
<span id="cb19-319"><a href="#cb19-319" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb19-320"><a href="#cb19-320" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> datetime.<span class="bu">min</span></span>
<span id="cb19-321"><a href="#cb19-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-322"><a href="#cb19-322" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> format_timestamp(<span class="va">self</span>, timestamp) <span class="op">-&gt;</span> Optional[<span class="bu">str</span>]:</span>
<span id="cb19-323"><a href="#cb19-323" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> timestamp:</span>
<span id="cb19-324"><a href="#cb19-324" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb19-325"><a href="#cb19-325" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb19-326"><a href="#cb19-326" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb19-327"><a href="#cb19-327" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">isinstance</span>(timestamp, (<span class="bu">int</span>, <span class="bu">float</span>)):</span>
<span id="cb19-328"><a href="#cb19-328" aria-hidden="true" tabindex="-1"></a>                dt <span class="op">=</span> datetime.fromtimestamp(timestamp)</span>
<span id="cb19-329"><a href="#cb19-329" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> dt.strftime(<span class="st">&#39;%Y-%m-</span><span class="sc">%d</span><span class="st"> %H:%M:%S&#39;</span>)</span>
<span id="cb19-330"><a href="#cb19-330" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> <span class="bu">isinstance</span>(timestamp, <span class="bu">str</span>):</span>
<span id="cb19-331"><a href="#cb19-331" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="st">&#39;T&#39;</span> <span class="kw">in</span> timestamp:</span>
<span id="cb19-332"><a href="#cb19-332" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">return</span> timestamp.replace(<span class="st">&#39;T&#39;</span>, <span class="st">&#39; &#39;</span>).split(<span class="st">&#39;.&#39;</span>)[<span class="dv">0</span>]</span>
<span id="cb19-333"><a href="#cb19-333" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> timestamp</span>
<span id="cb19-334"><a href="#cb19-334" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span>:</span>
<span id="cb19-335"><a href="#cb19-335" aria-hidden="true" tabindex="-1"></a>            <span class="cf">pass</span></span>
<span id="cb19-336"><a href="#cb19-336" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb19-337"><a href="#cb19-337" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">str</span>(timestamp)</span>
<span id="cb19-338"><a href="#cb19-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-339"><a href="#cb19-339" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_enhanced_markdown_content(<span class="va">self</span>, conversation: Dict[<span class="bu">str</span>, Any]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb19-340"><a href="#cb19-340" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Gera conte√∫do Markdown com preserva√ß√£o total de formata√ß√£o&quot;&quot;&quot;</span></span>
<span id="cb19-341"><a href="#cb19-341" aria-hidden="true" tabindex="-1"></a>        lines <span class="op">=</span> [</span>
<span id="cb19-342"><a href="#cb19-342" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f&quot;# </span><span class="sc">{</span>conversation[<span class="st">&#39;title&#39;</span>]<span class="sc">}</span><span class="ss">&quot;</span>,</span>
<span id="cb19-343"><a href="#cb19-343" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;&quot;</span>,</span>
<span id="cb19-344"><a href="#cb19-344" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;## üìä Informa√ß√µes&quot;</span>,</span>
<span id="cb19-345"><a href="#cb19-345" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f&quot;- **N√∫mero:** #</span><span class="sc">{</span>conversation[<span class="st">&#39;number&#39;</span>]<span class="sc">}</span><span class="ss">&quot;</span>,</span>
<span id="cb19-346"><a href="#cb19-346" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f&quot;- **Origem:** </span><span class="sc">{</span>conversation[<span class="st">&#39;source&#39;</span>]<span class="sc">}</span><span class="ss">&quot;</span>,</span>
<span id="cb19-347"><a href="#cb19-347" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f&quot;- **Categoria:** </span><span class="sc">{</span>conversation[<span class="st">&#39;category&#39;</span>]<span class="sc">}</span><span class="ss">&quot;</span>,</span>
<span id="cb19-348"><a href="#cb19-348" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f&quot;- **ID:** </span><span class="sc">{</span>conversation<span class="sc">.</span>get(<span class="st">&#39;id&#39;</span>, <span class="st">&#39;N/A&#39;</span>)<span class="sc">}</span><span class="ss">&quot;</span>,</span>
<span id="cb19-349"><a href="#cb19-349" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f&quot;- **Criada em:** </span><span class="sc">{</span>conversation<span class="sc">.</span>get(<span class="st">&#39;inserted_at&#39;</span>) <span class="kw">or</span> conversation<span class="sc">.</span>get(<span class="st">&#39;created_at&#39;</span>) <span class="kw">or</span> <span class="st">&#39;N/A&#39;</span><span class="sc">}</span><span class="ss">&quot;</span>,</span>
<span id="cb19-350"><a href="#cb19-350" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb19-351"><a href="#cb19-351" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-352"><a href="#cb19-352" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> conversation.get(<span class="st">&#39;updated_at&#39;</span>):</span>
<span id="cb19-353"><a href="#cb19-353" aria-hidden="true" tabindex="-1"></a>            lines.append(<span class="ss">f&quot;- **Atualizada em:** </span><span class="sc">{</span>conversation[<span class="st">&#39;updated_at&#39;</span>]<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb19-354"><a href="#cb19-354" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb19-355"><a href="#cb19-355" aria-hidden="true" tabindex="-1"></a>        lines.extend([</span>
<span id="cb19-356"><a href="#cb19-356" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f&quot;- **Total de mensagens:** </span><span class="sc">{</span><span class="bu">len</span>(conversation[<span class="st">&#39;messages&#39;</span>])<span class="sc">}</span><span class="ss">&quot;</span>,</span>
<span id="cb19-357"><a href="#cb19-357" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f&quot;- **Resumo:** </span><span class="sc">{</span>conversation<span class="sc">.</span>get(<span class="st">&#39;summary&#39;</span>, <span class="st">&#39;Sem resumo&#39;</span>)<span class="sc">}</span><span class="ss">&quot;</span>,</span>
<span id="cb19-358"><a href="#cb19-358" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;&quot;</span>,</span>
<span id="cb19-359"><a href="#cb19-359" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;---&quot;</span>,</span>
<span id="cb19-360"><a href="#cb19-360" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;&quot;</span>,</span>
<span id="cb19-361"><a href="#cb19-361" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;## üó®Ô∏è Conversa&quot;</span>,</span>
<span id="cb19-362"><a href="#cb19-362" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;&quot;</span></span>
<span id="cb19-363"><a href="#cb19-363" aria-hidden="true" tabindex="-1"></a>        ])</span>
<span id="cb19-364"><a href="#cb19-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-365"><a href="#cb19-365" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, msg <span class="kw">in</span> <span class="bu">enumerate</span>(conversation[<span class="st">&#39;messages&#39;</span>], <span class="dv">1</span>):</span>
<span id="cb19-366"><a href="#cb19-366" aria-hidden="true" tabindex="-1"></a>            timestamp <span class="op">=</span> <span class="ss">f&quot; *(</span><span class="sc">{</span>msg[<span class="st">&#39;timestamp&#39;</span>]<span class="sc">}</span><span class="ss">)*&quot;</span> <span class="cf">if</span> msg[<span class="st">&#39;timestamp&#39;</span>] <span class="cf">else</span> <span class="st">&quot;&quot;</span></span>
<span id="cb19-367"><a href="#cb19-367" aria-hidden="true" tabindex="-1"></a>            model_info <span class="op">=</span> <span class="ss">f&quot; *[</span><span class="sc">{</span>msg<span class="sc">.</span>get(<span class="st">&#39;model&#39;</span>, <span class="st">&#39;&#39;</span>)<span class="sc">}</span><span class="ss">]*&quot;</span> <span class="cf">if</span> msg.get(<span class="st">&#39;model&#39;</span>) <span class="cf">else</span> <span class="st">&quot;&quot;</span></span>
<span id="cb19-368"><a href="#cb19-368" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb19-369"><a href="#cb19-369" aria-hidden="true" tabindex="-1"></a>            preserved_content <span class="op">=</span> <span class="va">self</span>.preserve_special_content(msg[<span class="st">&#39;content&#39;</span>])</span>
<span id="cb19-370"><a href="#cb19-370" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb19-371"><a href="#cb19-371" aria-hidden="true" tabindex="-1"></a>            lines.extend([</span>
<span id="cb19-372"><a href="#cb19-372" aria-hidden="true" tabindex="-1"></a>                <span class="ss">f&quot;### </span><span class="sc">{</span>msg[<span class="st">&#39;author&#39;</span>]<span class="sc">}{</span>timestamp<span class="sc">}{</span>model_info<span class="sc">}</span><span class="ss">&quot;</span>,</span>
<span id="cb19-373"><a href="#cb19-373" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;&quot;</span>,</span>
<span id="cb19-374"><a href="#cb19-374" aria-hidden="true" tabindex="-1"></a>                <span class="ss">f&quot;</span><span class="sc">{</span>preserved_content<span class="sc">}</span><span class="ss">&quot;</span>,</span>
<span id="cb19-375"><a href="#cb19-375" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;&quot;</span></span>
<span id="cb19-376"><a href="#cb19-376" aria-hidden="true" tabindex="-1"></a>            ])</span>
<span id="cb19-377"><a href="#cb19-377" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb19-378"><a href="#cb19-378" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> j <span class="op">&lt;</span> <span class="bu">len</span>(conversation[<span class="st">&#39;messages&#39;</span>]):</span>
<span id="cb19-379"><a href="#cb19-379" aria-hidden="true" tabindex="-1"></a>                lines.extend([<span class="st">&quot;---&quot;</span>, <span class="st">&quot;&quot;</span>])</span>
<span id="cb19-380"><a href="#cb19-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-381"><a href="#cb19-381" aria-hidden="true" tabindex="-1"></a>        lines.extend([</span>
<span id="cb19-382"><a href="#cb19-382" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;---&quot;</span>,</span>
<span id="cb19-383"><a href="#cb19-383" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;&quot;</span>,</span>
<span id="cb19-384"><a href="#cb19-384" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f&quot;*Conversa exportada do </span><span class="sc">{</span>conversation[<span class="st">&#39;source&#39;</span>]<span class="sc">}</span><span class="ss">*&quot;</span>,</span>
<span id="cb19-385"><a href="#cb19-385" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f&quot;*Processado em: </span><span class="sc">{</span>datetime<span class="sc">.</span>now()<span class="sc">.</span>strftime(<span class="st">&#39;</span><span class="sc">%d</span><span class="st">/%m/%Y %H:%M&#39;</span>)<span class="sc">}</span><span class="ss">*&quot;</span></span>
<span id="cb19-386"><a href="#cb19-386" aria-hidden="true" tabindex="-1"></a>        ])</span>
<span id="cb19-387"><a href="#cb19-387" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-388"><a href="#cb19-388" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>.join(lines)</span>
<span id="cb19-389"><a href="#cb19-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-390"><a href="#cb19-390" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> process_qwen_enhanced(<span class="va">self</span>, path: Path):</span>
<span id="cb19-391"><a href="#cb19-391" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Processa Qwen3 com preserva√ß√£o total de conte√∫do&quot;&quot;&quot;</span></span>
<span id="cb19-392"><a href="#cb19-392" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb19-393"><a href="#cb19-393" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;üß™ [DRY-RUN] Processaria Qwen3: </span><span class="sc">{</span>path<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb19-394"><a href="#cb19-394" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb19-395"><a href="#cb19-395" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb19-396"><a href="#cb19-396" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb19-397"><a href="#cb19-397" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(path, <span class="st">&#39;r&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb19-398"><a href="#cb19-398" aria-hidden="true" tabindex="-1"></a>                raw <span class="op">=</span> json.load(f)</span>
<span id="cb19-399"><a href="#cb19-399" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb19-400"><a href="#cb19-400" aria-hidden="true" tabindex="-1"></a>            data <span class="op">=</span> raw.get(<span class="st">&#39;data&#39;</span>, [])</span>
<span id="cb19-401"><a href="#cb19-401" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(data, <span class="bu">list</span>):</span>
<span id="cb19-402"><a href="#cb19-402" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;‚ö†Ô∏è  Qwen3: &#39;data&#39; n√£o √© uma lista.&quot;</span>)</span>
<span id="cb19-403"><a href="#cb19-403" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span></span>
<span id="cb19-404"><a href="#cb19-404" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb19-405"><a href="#cb19-405" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;üîç Qwen3: encontradas </span><span class="sc">{</span><span class="bu">len</span>(data)<span class="sc">}</span><span class="ss"> conversas.&quot;</span>)</span>
<span id="cb19-406"><a href="#cb19-406" aria-hidden="true" tabindex="-1"></a>            processed_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb19-407"><a href="#cb19-407" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb19-408"><a href="#cb19-408" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> i, conv <span class="kw">in</span> <span class="bu">enumerate</span>(data):</span>
<span id="cb19-409"><a href="#cb19-409" aria-hidden="true" tabindex="-1"></a>                title <span class="op">=</span> conv.get(<span class="st">&#39;title&#39;</span>, <span class="ss">f&#39;Conversa_Qwen_</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb19-410"><a href="#cb19-410" aria-hidden="true" tabindex="-1"></a>                title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(title)</span>
<span id="cb19-411"><a href="#cb19-411" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb19-412"><a href="#cb19-412" aria-hidden="true" tabindex="-1"></a>                history <span class="op">=</span> conv.get(<span class="st">&#39;chat&#39;</span>, {}).get(<span class="st">&#39;history&#39;</span>, {})</span>
<span id="cb19-413"><a href="#cb19-413" aria-hidden="true" tabindex="-1"></a>                messages <span class="op">=</span> []</span>
<span id="cb19-414"><a href="#cb19-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-415"><a href="#cb19-415" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="kw">not</span> history:</span>
<span id="cb19-416"><a href="#cb19-416" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">continue</span></span>
<span id="cb19-417"><a href="#cb19-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-418"><a href="#cb19-418" aria-hidden="true" tabindex="-1"></a>                messages_dict <span class="op">=</span> history.get(<span class="st">&#39;messages&#39;</span>, {})</span>
<span id="cb19-419"><a href="#cb19-419" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb19-420"><a href="#cb19-420" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(messages_dict, <span class="bu">dict</span>):</span>
<span id="cb19-421"><a href="#cb19-421" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">continue</span></span>
<span id="cb19-422"><a href="#cb19-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-423"><a href="#cb19-423" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;   üìù Conversa </span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">: &#39;</span><span class="sc">{</span>title<span class="sc">}</span><span class="ss">&#39; - </span><span class="sc">{</span><span class="bu">len</span>(messages_dict)<span class="sc">}</span><span class="ss"> mensagens&quot;</span>)</span>
<span id="cb19-424"><a href="#cb19-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-425"><a href="#cb19-425" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> message_id, message_data <span class="kw">in</span> messages_dict.items():</span>
<span id="cb19-426"><a href="#cb19-426" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(message_data, <span class="bu">dict</span>):</span>
<span id="cb19-427"><a href="#cb19-427" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb19-428"><a href="#cb19-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-429"><a href="#cb19-429" aria-hidden="true" tabindex="-1"></a>                    role <span class="op">=</span> message_data.get(<span class="st">&#39;role&#39;</span>, <span class="st">&#39;&#39;</span>)</span>
<span id="cb19-430"><a href="#cb19-430" aria-hidden="true" tabindex="-1"></a>                    content <span class="op">=</span> message_data.get(<span class="st">&#39;content&#39;</span>, <span class="st">&#39;&#39;</span>)</span>
<span id="cb19-431"><a href="#cb19-431" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb19-432"><a href="#cb19-432" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="kw">not</span> content <span class="kw">or</span> <span class="kw">not</span> role:</span>
<span id="cb19-433"><a href="#cb19-433" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb19-434"><a href="#cb19-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-435"><a href="#cb19-435" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> role <span class="op">==</span> <span class="st">&#39;user&#39;</span>:</span>
<span id="cb19-436"><a href="#cb19-436" aria-hidden="true" tabindex="-1"></a>                        author <span class="op">=</span> <span class="st">&quot;üë§ Utilizador&quot;</span></span>
<span id="cb19-437"><a href="#cb19-437" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">elif</span> role <span class="op">==</span> <span class="st">&#39;assistant&#39;</span>:</span>
<span id="cb19-438"><a href="#cb19-438" aria-hidden="true" tabindex="-1"></a>                        author <span class="op">=</span> <span class="st">&quot;ü§ñ Qwen3&quot;</span></span>
<span id="cb19-439"><a href="#cb19-439" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">else</span>:</span>
<span id="cb19-440"><a href="#cb19-440" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb19-441"><a href="#cb19-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-442"><a href="#cb19-442" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="bu">isinstance</span>(content, <span class="bu">list</span>):</span>
<span id="cb19-443"><a href="#cb19-443" aria-hidden="true" tabindex="-1"></a>                        text_parts <span class="op">=</span> []</span>
<span id="cb19-444"><a href="#cb19-444" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">for</span> block <span class="kw">in</span> content:</span>
<span id="cb19-445"><a href="#cb19-445" aria-hidden="true" tabindex="-1"></a>                            <span class="cf">if</span> <span class="bu">isinstance</span>(block, <span class="bu">dict</span>):</span>
<span id="cb19-446"><a href="#cb19-446" aria-hidden="true" tabindex="-1"></a>                                <span class="cf">if</span> block.get(<span class="st">&#39;type&#39;</span>) <span class="op">==</span> <span class="st">&#39;text&#39;</span>:</span>
<span id="cb19-447"><a href="#cb19-447" aria-hidden="true" tabindex="-1"></a>                                    text_parts.append(block.get(<span class="st">&#39;text&#39;</span>, <span class="st">&#39;&#39;</span>))</span>
<span id="cb19-448"><a href="#cb19-448" aria-hidden="true" tabindex="-1"></a>                                <span class="cf">elif</span> block.get(<span class="st">&#39;type&#39;</span>) <span class="op">==</span> <span class="st">&#39;image&#39;</span>:</span>
<span id="cb19-449"><a href="#cb19-449" aria-hidden="true" tabindex="-1"></a>                                    image_info <span class="op">=</span> block.get(<span class="st">&#39;image&#39;</span>, <span class="st">&#39;&#39;</span>)</span>
<span id="cb19-450"><a href="#cb19-450" aria-hidden="true" tabindex="-1"></a>                                    <span class="cf">if</span> image_info:</span>
<span id="cb19-451"><a href="#cb19-451" aria-hidden="true" tabindex="-1"></a>                                        text_parts.append(<span class="ss">f&quot;![Imagem](</span><span class="sc">{</span>image_info<span class="sc">}</span><span class="ss">)&quot;</span>)</span>
<span id="cb19-452"><a href="#cb19-452" aria-hidden="true" tabindex="-1"></a>                            <span class="cf">elif</span> <span class="bu">isinstance</span>(block, <span class="bu">str</span>):</span>
<span id="cb19-453"><a href="#cb19-453" aria-hidden="true" tabindex="-1"></a>                                text_parts.append(block)</span>
<span id="cb19-454"><a href="#cb19-454" aria-hidden="true" tabindex="-1"></a>                        final_content <span class="op">=</span> <span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>.join(text_parts).strip()</span>
<span id="cb19-455"><a href="#cb19-455" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">else</span>:</span>
<span id="cb19-456"><a href="#cb19-456" aria-hidden="true" tabindex="-1"></a>                        final_content <span class="op">=</span> <span class="bu">str</span>(content).strip()</span>
<span id="cb19-457"><a href="#cb19-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-458"><a href="#cb19-458" aria-hidden="true" tabindex="-1"></a>                    final_content <span class="op">=</span> <span class="va">self</span>.preserve_special_content(final_content)</span>
<span id="cb19-459"><a href="#cb19-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-460"><a href="#cb19-460" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="kw">not</span> final_content <span class="kw">or</span> final_content <span class="op">==</span> <span class="st">&#39;null&#39;</span>:</span>
<span id="cb19-461"><a href="#cb19-461" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb19-462"><a href="#cb19-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-463"><a href="#cb19-463" aria-hidden="true" tabindex="-1"></a>                    messages.append({</span>
<span id="cb19-464"><a href="#cb19-464" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;author&#39;</span>: author,</span>
<span id="cb19-465"><a href="#cb19-465" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;role&#39;</span>: role,</span>
<span id="cb19-466"><a href="#cb19-466" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;content&#39;</span>: final_content,</span>
<span id="cb19-467"><a href="#cb19-467" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;timestamp&#39;</span>: <span class="va">self</span>.format_timestamp(message_data.get(<span class="st">&#39;created_at&#39;</span>)),</span>
<span id="cb19-468"><a href="#cb19-468" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;model&#39;</span>: message_data.get(<span class="st">&#39;model&#39;</span>, <span class="st">&#39;Qwen3&#39;</span>)</span>
<span id="cb19-469"><a href="#cb19-469" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb19-470"><a href="#cb19-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-471"><a href="#cb19-471" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> messages:</span>
<span id="cb19-472"><a href="#cb19-472" aria-hidden="true" tabindex="-1"></a>                    messages.sort(key<span class="op">=</span><span class="kw">lambda</span> x: <span class="va">self</span>.parse_timestamp_for_sorting(x[<span class="st">&#39;timestamp&#39;</span>]))</span>
<span id="cb19-473"><a href="#cb19-473" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb19-474"><a href="#cb19-474" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.all_conversations.append({</span>
<span id="cb19-475"><a href="#cb19-475" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;title&#39;</span>: title,</span>
<span id="cb19-476"><a href="#cb19-476" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;source&#39;</span>: <span class="st">&#39;Qwen3&#39;</span>,</span>
<span id="cb19-477"><a href="#cb19-477" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;id&#39;</span>: conv.get(<span class="st">&#39;id&#39;</span>, <span class="ss">f&#39;qwen_</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">&#39;</span>),</span>
<span id="cb19-478"><a href="#cb19-478" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;inserted_at&#39;</span>: <span class="va">self</span>.format_timestamp(conv.get(<span class="st">&#39;created_at&#39;</span>)),</span>
<span id="cb19-479"><a href="#cb19-479" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;updated_at&#39;</span>: <span class="va">self</span>.format_timestamp(conv.get(<span class="st">&#39;updated_at&#39;</span>)),</span>
<span id="cb19-480"><a href="#cb19-480" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;messages&#39;</span>: messages,</span>
<span id="cb19-481"><a href="#cb19-481" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;summary&#39;</span>: messages[<span class="dv">0</span>][<span class="st">&#39;content&#39;</span>][:<span class="dv">100</span>] <span class="op">+</span> <span class="st">&quot;...&quot;</span> <span class="cf">if</span> messages <span class="cf">else</span> <span class="st">&quot;Sem conte√∫do&quot;</span>,</span>
<span id="cb19-482"><a href="#cb19-482" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;category&#39;</span>: <span class="st">&#39;Geral&#39;</span></span>
<span id="cb19-483"><a href="#cb19-483" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb19-484"><a href="#cb19-484" aria-hidden="true" tabindex="-1"></a>                    processed_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb19-485"><a href="#cb19-485" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="ss">f&quot;   ‚úÖ Adicionada: </span><span class="sc">{</span><span class="bu">len</span>(messages)<span class="sc">}</span><span class="ss"> mensagens&quot;</span>)</span>
<span id="cb19-486"><a href="#cb19-486" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb19-487"><a href="#cb19-487" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ Qwen3: </span><span class="sc">{</span>processed_count<span class="sc">}</span><span class="ss"> conversas processadas.&quot;</span>)</span>
<span id="cb19-488"><a href="#cb19-488" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb19-489"><a href="#cb19-489" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb19-490"><a href="#cb19-490" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚ùå Erro ao processar Qwen3: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb19-491"><a href="#cb19-491" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb19-492"><a href="#cb19-492" aria-hidden="true" tabindex="-1"></a>                traceback.print_exc()</span>
<span id="cb19-493"><a href="#cb19-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-494"><a href="#cb19-494" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> process_chatgpt(<span class="va">self</span>, path: Path):</span>
<span id="cb19-495"><a href="#cb19-495" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Processa exporta√ß√£o do ChatGPT&quot;&quot;&quot;</span></span>
<span id="cb19-496"><a href="#cb19-496" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb19-497"><a href="#cb19-497" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;üß™ [DRY-RUN] Processaria ChatGPT: </span><span class="sc">{</span>path<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb19-498"><a href="#cb19-498" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb19-499"><a href="#cb19-499" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb19-500"><a href="#cb19-500" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb19-501"><a href="#cb19-501" aria-hidden="true" tabindex="-1"></a>            temp_dir <span class="op">=</span> tempfile.mkdtemp(prefix<span class="op">=</span><span class="st">&quot;chatgpt_&quot;</span>)</span>
<span id="cb19-502"><a href="#cb19-502" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> zipfile.ZipFile(path, <span class="st">&#39;r&#39;</span>) <span class="im">as</span> z:</span>
<span id="cb19-503"><a href="#cb19-503" aria-hidden="true" tabindex="-1"></a>                z.extractall(temp_dir)</span>
<span id="cb19-504"><a href="#cb19-504" aria-hidden="true" tabindex="-1"></a>            convs_path <span class="op">=</span> Path(temp_dir) <span class="op">/</span> <span class="st">&quot;conversations.json&quot;</span></span>
<span id="cb19-505"><a href="#cb19-505" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> convs_path.exists():</span>
<span id="cb19-506"><a href="#cb19-506" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;‚ùå ChatGPT: conversations.json n√£o encontrado.&quot;</span>)</span>
<span id="cb19-507"><a href="#cb19-507" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span></span>
<span id="cb19-508"><a href="#cb19-508" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb19-509"><a href="#cb19-509" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(convs_path, <span class="st">&#39;r&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb19-510"><a href="#cb19-510" aria-hidden="true" tabindex="-1"></a>                data <span class="op">=</span> json.load(f)</span>
<span id="cb19-511"><a href="#cb19-511" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb19-512"><a href="#cb19-512" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(data, <span class="bu">list</span>):</span>
<span id="cb19-513"><a href="#cb19-513" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;‚ö†Ô∏è  ChatGPT: estrutura inesperada.&quot;</span>)</span>
<span id="cb19-514"><a href="#cb19-514" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span></span>
<span id="cb19-515"><a href="#cb19-515" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb19-516"><a href="#cb19-516" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;üîç ChatGPT: encontradas </span><span class="sc">{</span><span class="bu">len</span>(data)<span class="sc">}</span><span class="ss"> conversas.&quot;</span>)</span>
<span id="cb19-517"><a href="#cb19-517" aria-hidden="true" tabindex="-1"></a>            processed_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb19-518"><a href="#cb19-518" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb19-519"><a href="#cb19-519" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> i, conv <span class="kw">in</span> <span class="bu">enumerate</span>(data):</span>
<span id="cb19-520"><a href="#cb19-520" aria-hidden="true" tabindex="-1"></a>                title <span class="op">=</span> conv.get(<span class="st">&#39;title&#39;</span>, <span class="ss">f&#39;Conversa_ChatGPT_</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb19-521"><a href="#cb19-521" aria-hidden="true" tabindex="-1"></a>                title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(title)</span>
<span id="cb19-522"><a href="#cb19-522" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb19-523"><a href="#cb19-523" aria-hidden="true" tabindex="-1"></a>                messages <span class="op">=</span> []</span>
<span id="cb19-524"><a href="#cb19-524" aria-hidden="true" tabindex="-1"></a>                mapping <span class="op">=</span> conv.get(<span class="st">&#39;mapping&#39;</span>, {})</span>
<span id="cb19-525"><a href="#cb19-525" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb19-526"><a href="#cb19-526" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> msg_id, node <span class="kw">in</span> mapping.items():</span>
<span id="cb19-527"><a href="#cb19-527" aria-hidden="true" tabindex="-1"></a>                    msg_data <span class="op">=</span> node.get(<span class="st">&#39;message&#39;</span>)</span>
<span id="cb19-528"><a href="#cb19-528" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="kw">not</span> msg_data <span class="kw">or</span> <span class="kw">not</span> <span class="bu">isinstance</span>(msg_data, <span class="bu">dict</span>):</span>
<span id="cb19-529"><a href="#cb19-529" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb19-530"><a href="#cb19-530" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb19-531"><a href="#cb19-531" aria-hidden="true" tabindex="-1"></a>                    author_role <span class="op">=</span> msg_data.get(<span class="st">&#39;author&#39;</span>, {}).get(<span class="st">&#39;role&#39;</span>, <span class="st">&#39;&#39;</span>)</span>
<span id="cb19-532"><a href="#cb19-532" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> author_role <span class="op">==</span> <span class="st">&#39;user&#39;</span>:</span>
<span id="cb19-533"><a href="#cb19-533" aria-hidden="true" tabindex="-1"></a>                        author <span class="op">=</span> <span class="st">&quot;üë§ Utilizador&quot;</span></span>
<span id="cb19-534"><a href="#cb19-534" aria-hidden="true" tabindex="-1"></a>                        role <span class="op">=</span> <span class="st">&#39;user&#39;</span></span>
<span id="cb19-535"><a href="#cb19-535" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">elif</span> author_role <span class="op">==</span> <span class="st">&#39;assistant&#39;</span>:</span>
<span id="cb19-536"><a href="#cb19-536" aria-hidden="true" tabindex="-1"></a>                        author <span class="op">=</span> <span class="st">&quot;ü§ñ ChatGPT&quot;</span></span>
<span id="cb19-537"><a href="#cb19-537" aria-hidden="true" tabindex="-1"></a>                        role <span class="op">=</span> <span class="st">&#39;assistant&#39;</span></span>
<span id="cb19-538"><a href="#cb19-538" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">else</span>:</span>
<span id="cb19-539"><a href="#cb19-539" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb19-540"><a href="#cb19-540" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb19-541"><a href="#cb19-541" aria-hidden="true" tabindex="-1"></a>                    content_parts <span class="op">=</span> []</span>
<span id="cb19-542"><a href="#cb19-542" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">for</span> part <span class="kw">in</span> msg_data.get(<span class="st">&#39;content&#39;</span>, {}).get(<span class="st">&#39;parts&#39;</span>, []):</span>
<span id="cb19-543"><a href="#cb19-543" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">if</span> <span class="bu">isinstance</span>(part, <span class="bu">str</span>):</span>
<span id="cb19-544"><a href="#cb19-544" aria-hidden="true" tabindex="-1"></a>                            content_parts.append(part)</span>
<span id="cb19-545"><a href="#cb19-545" aria-hidden="true" tabindex="-1"></a>                    content <span class="op">=</span> <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>.join(content_parts).strip()</span>
<span id="cb19-546"><a href="#cb19-546" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb19-547"><a href="#cb19-547" aria-hidden="true" tabindex="-1"></a>                    content <span class="op">=</span> <span class="va">self</span>.preserve_special_content(content)</span>
<span id="cb19-548"><a href="#cb19-548" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb19-549"><a href="#cb19-549" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="kw">not</span> content:</span>
<span id="cb19-550"><a href="#cb19-550" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb19-551"><a href="#cb19-551" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb19-552"><a href="#cb19-552" aria-hidden="true" tabindex="-1"></a>                    messages.append({</span>
<span id="cb19-553"><a href="#cb19-553" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;author&#39;</span>: author,</span>
<span id="cb19-554"><a href="#cb19-554" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;role&#39;</span>: role,</span>
<span id="cb19-555"><a href="#cb19-555" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;content&#39;</span>: content,</span>
<span id="cb19-556"><a href="#cb19-556" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;timestamp&#39;</span>: <span class="va">self</span>.format_timestamp(msg_data.get(<span class="st">&#39;create_time&#39;</span>)),</span>
<span id="cb19-557"><a href="#cb19-557" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;model&#39;</span>: msg_data.get(<span class="st">&#39;model&#39;</span>, <span class="st">&#39;ChatGPT&#39;</span>)</span>
<span id="cb19-558"><a href="#cb19-558" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb19-559"><a href="#cb19-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-560"><a href="#cb19-560" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> messages:</span>
<span id="cb19-561"><a href="#cb19-561" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.all_conversations.append({</span>
<span id="cb19-562"><a href="#cb19-562" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;title&#39;</span>: title,</span>
<span id="cb19-563"><a href="#cb19-563" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;source&#39;</span>: <span class="st">&#39;ChatGPT&#39;</span>,</span>
<span id="cb19-564"><a href="#cb19-564" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;id&#39;</span>: conv.get(<span class="st">&#39;id&#39;</span>, <span class="ss">f&#39;chatgpt_</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">&#39;</span>),</span>
<span id="cb19-565"><a href="#cb19-565" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;inserted_at&#39;</span>: <span class="va">self</span>.format_timestamp(conv.get(<span class="st">&#39;create_time&#39;</span>)),</span>
<span id="cb19-566"><a href="#cb19-566" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;updated_at&#39;</span>: <span class="va">self</span>.format_timestamp(conv.get(<span class="st">&#39;update_time&#39;</span>)),</span>
<span id="cb19-567"><a href="#cb19-567" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;messages&#39;</span>: messages,</span>
<span id="cb19-568"><a href="#cb19-568" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;summary&#39;</span>: messages[<span class="dv">0</span>][<span class="st">&#39;content&#39;</span>][:<span class="dv">100</span>] <span class="op">+</span> <span class="st">&quot;...&quot;</span> <span class="cf">if</span> messages <span class="cf">else</span> <span class="st">&quot;Sem conte√∫do&quot;</span>,</span>
<span id="cb19-569"><a href="#cb19-569" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;category&#39;</span>: <span class="st">&#39;Geral&#39;</span></span>
<span id="cb19-570"><a href="#cb19-570" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb19-571"><a href="#cb19-571" aria-hidden="true" tabindex="-1"></a>                    processed_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb19-572"><a href="#cb19-572" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb19-573"><a href="#cb19-573" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ ChatGPT: </span><span class="sc">{</span>processed_count<span class="sc">}</span><span class="ss"> conversas processadas.&quot;</span>)</span>
<span id="cb19-574"><a href="#cb19-574" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb19-575"><a href="#cb19-575" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb19-576"><a href="#cb19-576" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚ùå Erro ao processar ChatGPT: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb19-577"><a href="#cb19-577" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb19-578"><a href="#cb19-578" aria-hidden="true" tabindex="-1"></a>                traceback.print_exc()</span>
<span id="cb19-579"><a href="#cb19-579" aria-hidden="true" tabindex="-1"></a>        <span class="cf">finally</span>:</span>
<span id="cb19-580"><a href="#cb19-580" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="st">&#39;temp_dir&#39;</span> <span class="kw">in</span> <span class="bu">locals</span>():</span>
<span id="cb19-581"><a href="#cb19-581" aria-hidden="true" tabindex="-1"></a>                shutil.rmtree(temp_dir, ignore_errors<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb19-582"><a href="#cb19-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-583"><a href="#cb19-583" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> process_deepseek(<span class="va">self</span>, path: Path):</span>
<span id="cb19-584"><a href="#cb19-584" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Processa exporta√ß√£o do DeepSeek&quot;&quot;&quot;</span></span>
<span id="cb19-585"><a href="#cb19-585" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb19-586"><a href="#cb19-586" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;üß™ [DRY-RUN] Processaria DeepSeek: </span><span class="sc">{</span>path<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb19-587"><a href="#cb19-587" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb19-588"><a href="#cb19-588" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb19-589"><a href="#cb19-589" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb19-590"><a href="#cb19-590" aria-hidden="true" tabindex="-1"></a>            temp_dir <span class="op">=</span> tempfile.mkdtemp(prefix<span class="op">=</span><span class="st">&quot;deepseek_&quot;</span>)</span>
<span id="cb19-591"><a href="#cb19-591" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> zipfile.ZipFile(path, <span class="st">&#39;r&#39;</span>) <span class="im">as</span> z:</span>
<span id="cb19-592"><a href="#cb19-592" aria-hidden="true" tabindex="-1"></a>                z.extractall(temp_dir)</span>
<span id="cb19-593"><a href="#cb19-593" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb19-594"><a href="#cb19-594" aria-hidden="true" tabindex="-1"></a>            convs_path <span class="op">=</span> Path(temp_dir) <span class="op">/</span> <span class="st">&quot;conversations.json&quot;</span></span>
<span id="cb19-595"><a href="#cb19-595" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> convs_path.exists():</span>
<span id="cb19-596"><a href="#cb19-596" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;‚ùå DeepSeek: conversations.json n√£o encontrado.&quot;</span>)</span>
<span id="cb19-597"><a href="#cb19-597" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span></span>
<span id="cb19-598"><a href="#cb19-598" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb19-599"><a href="#cb19-599" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(convs_path, <span class="st">&#39;r&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb19-600"><a href="#cb19-600" aria-hidden="true" tabindex="-1"></a>                raw_data <span class="op">=</span> json.load(f)</span>
<span id="cb19-601"><a href="#cb19-601" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb19-602"><a href="#cb19-602" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">isinstance</span>(raw_data, <span class="bu">list</span>):</span>
<span id="cb19-603"><a href="#cb19-603" aria-hidden="true" tabindex="-1"></a>                data <span class="op">=</span> raw_data</span>
<span id="cb19-604"><a href="#cb19-604" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> <span class="bu">isinstance</span>(raw_data, <span class="bu">dict</span>) <span class="kw">and</span> <span class="st">&#39;data&#39;</span> <span class="kw">in</span> raw_data:</span>
<span id="cb19-605"><a href="#cb19-605" aria-hidden="true" tabindex="-1"></a>                data <span class="op">=</span> raw_data[<span class="st">&#39;data&#39;</span>]</span>
<span id="cb19-606"><a href="#cb19-606" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb19-607"><a href="#cb19-607" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;‚ö†Ô∏è  DeepSeek: estrutura inesperada.&quot;</span>)</span>
<span id="cb19-608"><a href="#cb19-608" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span></span>
<span id="cb19-609"><a href="#cb19-609" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb19-610"><a href="#cb19-610" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(data, <span class="bu">list</span>):</span>
<span id="cb19-611"><a href="#cb19-611" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;‚ö†Ô∏è  DeepSeek: &#39;data&#39; n√£o √© uma lista.&quot;</span>)</span>
<span id="cb19-612"><a href="#cb19-612" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span></span>
<span id="cb19-613"><a href="#cb19-613" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb19-614"><a href="#cb19-614" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;üîç DeepSeek: encontradas </span><span class="sc">{</span><span class="bu">len</span>(data)<span class="sc">}</span><span class="ss"> conversas.&quot;</span>)</span>
<span id="cb19-615"><a href="#cb19-615" aria-hidden="true" tabindex="-1"></a>            processed_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb19-616"><a href="#cb19-616" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb19-617"><a href="#cb19-617" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> i, conv <span class="kw">in</span> <span class="bu">enumerate</span>(data):</span>
<span id="cb19-618"><a href="#cb19-618" aria-hidden="true" tabindex="-1"></a>                title <span class="op">=</span> conv.get(<span class="st">&#39;title&#39;</span>, <span class="ss">f&#39;Conversa_DeepSeek_</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb19-619"><a href="#cb19-619" aria-hidden="true" tabindex="-1"></a>                title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(title)</span>
<span id="cb19-620"><a href="#cb19-620" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb19-621"><a href="#cb19-621" aria-hidden="true" tabindex="-1"></a>                messages <span class="op">=</span> []</span>
<span id="cb19-622"><a href="#cb19-622" aria-hidden="true" tabindex="-1"></a>                mapping <span class="op">=</span> conv.get(<span class="st">&#39;mapping&#39;</span>, {})</span>
<span id="cb19-623"><a href="#cb19-623" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb19-624"><a href="#cb19-624" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> node_id, node <span class="kw">in</span> mapping.items():</span>
<span id="cb19-625"><a href="#cb19-625" aria-hidden="true" tabindex="-1"></a>                    msg_data <span class="op">=</span> node.get(<span class="st">&#39;message&#39;</span>)</span>
<span id="cb19-626"><a href="#cb19-626" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="kw">not</span> msg_data <span class="kw">or</span> <span class="kw">not</span> <span class="bu">isinstance</span>(msg_data, <span class="bu">dict</span>):</span>
<span id="cb19-627"><a href="#cb19-627" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb19-628"><a href="#cb19-628" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb19-629"><a href="#cb19-629" aria-hidden="true" tabindex="-1"></a>                    fragments <span class="op">=</span> msg_data.get(<span class="st">&#39;fragments&#39;</span>, [])</span>
<span id="cb19-630"><a href="#cb19-630" aria-hidden="true" tabindex="-1"></a>                    content_parts <span class="op">=</span> []</span>
<span id="cb19-631"><a href="#cb19-631" aria-hidden="true" tabindex="-1"></a>                    msg_type <span class="op">=</span> <span class="va">None</span></span>
<span id="cb19-632"><a href="#cb19-632" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb19-633"><a href="#cb19-633" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">for</span> frag <span class="kw">in</span> fragments:</span>
<span id="cb19-634"><a href="#cb19-634" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">if</span> <span class="bu">isinstance</span>(frag, <span class="bu">dict</span>):</span>
<span id="cb19-635"><a href="#cb19-635" aria-hidden="true" tabindex="-1"></a>                            frag_type <span class="op">=</span> frag.get(<span class="st">&#39;type&#39;</span>, <span class="st">&#39;&#39;</span>).upper()</span>
<span id="cb19-636"><a href="#cb19-636" aria-hidden="true" tabindex="-1"></a>                            <span class="cf">if</span> frag_type <span class="kw">in</span> (<span class="st">&#39;REQUEST&#39;</span>, <span class="st">&#39;RESPONSE&#39;</span>):</span>
<span id="cb19-637"><a href="#cb19-637" aria-hidden="true" tabindex="-1"></a>                                msg_type <span class="op">=</span> frag_type</span>
<span id="cb19-638"><a href="#cb19-638" aria-hidden="true" tabindex="-1"></a>                            text <span class="op">=</span> frag.get(<span class="st">&#39;text&#39;</span>, <span class="st">&#39;&#39;</span>)</span>
<span id="cb19-639"><a href="#cb19-639" aria-hidden="true" tabindex="-1"></a>                            <span class="cf">if</span> text:</span>
<span id="cb19-640"><a href="#cb19-640" aria-hidden="true" tabindex="-1"></a>                                content_parts.append(text)</span>
<span id="cb19-641"><a href="#cb19-641" aria-hidden="true" tabindex="-1"></a>                            content <span class="op">=</span> frag.get(<span class="st">&#39;content&#39;</span>, <span class="st">&#39;&#39;</span>)</span>
<span id="cb19-642"><a href="#cb19-642" aria-hidden="true" tabindex="-1"></a>                            <span class="cf">if</span> content:</span>
<span id="cb19-643"><a href="#cb19-643" aria-hidden="true" tabindex="-1"></a>                                <span class="cf">if</span> <span class="bu">isinstance</span>(content, <span class="bu">list</span>):</span>
<span id="cb19-644"><a href="#cb19-644" aria-hidden="true" tabindex="-1"></a>                                    <span class="cf">for</span> item <span class="kw">in</span> content:</span>
<span id="cb19-645"><a href="#cb19-645" aria-hidden="true" tabindex="-1"></a>                                        <span class="cf">if</span> <span class="bu">isinstance</span>(item, <span class="bu">str</span>):</span>
<span id="cb19-646"><a href="#cb19-646" aria-hidden="true" tabindex="-1"></a>                                            content_parts.append(item)</span>
<span id="cb19-647"><a href="#cb19-647" aria-hidden="true" tabindex="-1"></a>                                        <span class="cf">elif</span> <span class="bu">isinstance</span>(item, <span class="bu">dict</span>):</span>
<span id="cb19-648"><a href="#cb19-648" aria-hidden="true" tabindex="-1"></a>                                            item_text <span class="op">=</span> item.get(<span class="st">&#39;text&#39;</span>, <span class="st">&#39;&#39;</span>)</span>
<span id="cb19-649"><a href="#cb19-649" aria-hidden="true" tabindex="-1"></a>                                            <span class="cf">if</span> item_text:</span>
<span id="cb19-650"><a href="#cb19-650" aria-hidden="true" tabindex="-1"></a>                                                content_parts.append(<span class="bu">str</span>(item_text))</span>
<span id="cb19-651"><a href="#cb19-651" aria-hidden="true" tabindex="-1"></a>                                <span class="cf">else</span>:</span>
<span id="cb19-652"><a href="#cb19-652" aria-hidden="true" tabindex="-1"></a>                                    content_parts.append(<span class="bu">str</span>(content))</span>
<span id="cb19-653"><a href="#cb19-653" aria-hidden="true" tabindex="-1"></a>                                    </span>
<span id="cb19-654"><a href="#cb19-654" aria-hidden="true" tabindex="-1"></a>                    content <span class="op">=</span> <span class="st">&#39; &#39;</span>.join(content_parts).strip()</span>
<span id="cb19-655"><a href="#cb19-655" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb19-656"><a href="#cb19-656" aria-hidden="true" tabindex="-1"></a>                    content <span class="op">=</span> <span class="va">self</span>.preserve_special_content(content)</span>
<span id="cb19-657"><a href="#cb19-657" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb19-658"><a href="#cb19-658" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="kw">not</span> content:</span>
<span id="cb19-659"><a href="#cb19-659" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb19-660"><a href="#cb19-660" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb19-661"><a href="#cb19-661" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> msg_type <span class="op">==</span> <span class="st">&#39;REQUEST&#39;</span>:</span>
<span id="cb19-662"><a href="#cb19-662" aria-hidden="true" tabindex="-1"></a>                        author <span class="op">=</span> <span class="st">&quot;üë§ Utilizador&quot;</span></span>
<span id="cb19-663"><a href="#cb19-663" aria-hidden="true" tabindex="-1"></a>                        role <span class="op">=</span> <span class="st">&#39;user&#39;</span></span>
<span id="cb19-664"><a href="#cb19-664" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">else</span>:</span>
<span id="cb19-665"><a href="#cb19-665" aria-hidden="true" tabindex="-1"></a>                        author <span class="op">=</span> <span class="st">&quot;ü§ñ DeepSeek&quot;</span></span>
<span id="cb19-666"><a href="#cb19-666" aria-hidden="true" tabindex="-1"></a>                        role <span class="op">=</span> <span class="st">&#39;assistant&#39;</span></span>
<span id="cb19-667"><a href="#cb19-667" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb19-668"><a href="#cb19-668" aria-hidden="true" tabindex="-1"></a>                    messages.append({</span>
<span id="cb19-669"><a href="#cb19-669" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;author&#39;</span>: author,</span>
<span id="cb19-670"><a href="#cb19-670" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;role&#39;</span>: role,</span>
<span id="cb19-671"><a href="#cb19-671" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;content&#39;</span>: content,</span>
<span id="cb19-672"><a href="#cb19-672" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;timestamp&#39;</span>: <span class="va">self</span>.format_timestamp(msg_data.get(<span class="st">&#39;inserted_at&#39;</span>)),</span>
<span id="cb19-673"><a href="#cb19-673" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;model&#39;</span>: msg_data.get(<span class="st">&#39;model&#39;</span>, <span class="st">&#39;DeepSeek&#39;</span>)</span>
<span id="cb19-674"><a href="#cb19-674" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb19-675"><a href="#cb19-675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-676"><a href="#cb19-676" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> messages:</span>
<span id="cb19-677"><a href="#cb19-677" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.all_conversations.append({</span>
<span id="cb19-678"><a href="#cb19-678" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;title&#39;</span>: title,</span>
<span id="cb19-679"><a href="#cb19-679" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;source&#39;</span>: <span class="st">&#39;DeepSeek&#39;</span>,</span>
<span id="cb19-680"><a href="#cb19-680" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;id&#39;</span>: conv.get(<span class="st">&#39;id&#39;</span>, <span class="ss">f&#39;deepseek_</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">&#39;</span>),</span>
<span id="cb19-681"><a href="#cb19-681" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;inserted_at&#39;</span>: <span class="va">self</span>.format_timestamp(conv.get(<span class="st">&#39;inserted_at&#39;</span>)),</span>
<span id="cb19-682"><a href="#cb19-682" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;updated_at&#39;</span>: <span class="va">self</span>.format_timestamp(conv.get(<span class="st">&#39;updated_at&#39;</span>)),</span>
<span id="cb19-683"><a href="#cb19-683" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;messages&#39;</span>: messages,</span>
<span id="cb19-684"><a href="#cb19-684" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;summary&#39;</span>: messages[<span class="dv">0</span>][<span class="st">&#39;content&#39;</span>][:<span class="dv">100</span>] <span class="op">+</span> <span class="st">&quot;...&quot;</span> <span class="cf">if</span> messages <span class="cf">else</span> <span class="st">&quot;Sem conte√∫do&quot;</span>,</span>
<span id="cb19-685"><a href="#cb19-685" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;category&#39;</span>: <span class="st">&#39;Geral&#39;</span></span>
<span id="cb19-686"><a href="#cb19-686" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb19-687"><a href="#cb19-687" aria-hidden="true" tabindex="-1"></a>                    processed_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb19-688"><a href="#cb19-688" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb19-689"><a href="#cb19-689" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ DeepSeek: </span><span class="sc">{</span>processed_count<span class="sc">}</span><span class="ss"> conversas processadas.&quot;</span>)</span>
<span id="cb19-690"><a href="#cb19-690" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb19-691"><a href="#cb19-691" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb19-692"><a href="#cb19-692" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚ùå Erro ao processar DeepSeek: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb19-693"><a href="#cb19-693" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb19-694"><a href="#cb19-694" aria-hidden="true" tabindex="-1"></a>                traceback.print_exc()</span>
<span id="cb19-695"><a href="#cb19-695" aria-hidden="true" tabindex="-1"></a>        <span class="cf">finally</span>:</span>
<span id="cb19-696"><a href="#cb19-696" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="st">&#39;temp_dir&#39;</span> <span class="kw">in</span> <span class="bu">locals</span>():</span>
<span id="cb19-697"><a href="#cb19-697" aria-hidden="true" tabindex="-1"></a>                shutil.rmtree(temp_dir, ignore_errors<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb19-698"><a href="#cb19-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-699"><a href="#cb19-699" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> process_grok(<span class="va">self</span>, path: Path):</span>
<span id="cb19-700"><a href="#cb19-700" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Processa exporta√ß√£o do Grok&quot;&quot;&quot;</span></span>
<span id="cb19-701"><a href="#cb19-701" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb19-702"><a href="#cb19-702" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;üß™ [DRY-RUN] Processaria Grok: </span><span class="sc">{</span>path<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb19-703"><a href="#cb19-703" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb19-704"><a href="#cb19-704" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb19-705"><a href="#cb19-705" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb19-706"><a href="#cb19-706" aria-hidden="true" tabindex="-1"></a>            temp_dir <span class="op">=</span> tempfile.mkdtemp(prefix<span class="op">=</span><span class="st">&quot;grok_&quot;</span>)</span>
<span id="cb19-707"><a href="#cb19-707" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> zipfile.ZipFile(path, <span class="st">&#39;r&#39;</span>) <span class="im">as</span> z:</span>
<span id="cb19-708"><a href="#cb19-708" aria-hidden="true" tabindex="-1"></a>                z.extractall(temp_dir)</span>
<span id="cb19-709"><a href="#cb19-709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-710"><a href="#cb19-710" aria-hidden="true" tabindex="-1"></a>            target_file <span class="op">=</span> <span class="va">None</span></span>
<span id="cb19-711"><a href="#cb19-711" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> root, _, files <span class="kw">in</span> os.walk(temp_dir):</span>
<span id="cb19-712"><a href="#cb19-712" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> <span class="bu">file</span> <span class="kw">in</span> files:</span>
<span id="cb19-713"><a href="#cb19-713" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="bu">file</span> <span class="op">==</span> <span class="st">&quot;prod-grok-backend.json&quot;</span>:</span>
<span id="cb19-714"><a href="#cb19-714" aria-hidden="true" tabindex="-1"></a>                        target_file <span class="op">=</span> Path(root) <span class="op">/</span> <span class="bu">file</span></span>
<span id="cb19-715"><a href="#cb19-715" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">break</span></span>
<span id="cb19-716"><a href="#cb19-716" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> target_file:</span>
<span id="cb19-717"><a href="#cb19-717" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">break</span></span>
<span id="cb19-718"><a href="#cb19-718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-719"><a href="#cb19-719" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> target_file:</span>
<span id="cb19-720"><a href="#cb19-720" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;‚ùå Grok: ficheiro &#39;prod-grok-backend.json&#39; n√£o encontrado no ZIP.&quot;</span>)</span>
<span id="cb19-721"><a href="#cb19-721" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span></span>
<span id="cb19-722"><a href="#cb19-722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-723"><a href="#cb19-723" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;üîç Grok: carregando </span><span class="sc">{</span>target_file<span class="sc">.</span>name<span class="sc">}</span><span class="ss">...&quot;</span>)</span>
<span id="cb19-724"><a href="#cb19-724" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(target_file, <span class="st">&#39;r&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb19-725"><a href="#cb19-725" aria-hidden="true" tabindex="-1"></a>                data <span class="op">=</span> json.load(f)</span>
<span id="cb19-726"><a href="#cb19-726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-727"><a href="#cb19-727" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(data, <span class="bu">dict</span>) <span class="kw">or</span> <span class="st">&#39;conversations&#39;</span> <span class="kw">not</span> <span class="kw">in</span> data:</span>
<span id="cb19-728"><a href="#cb19-728" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;‚ùå Grok: estrutura inesperada ‚Äî chave &#39;conversations&#39; n√£o encontrada.&quot;</span>)</span>
<span id="cb19-729"><a href="#cb19-729" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span></span>
<span id="cb19-730"><a href="#cb19-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-731"><a href="#cb19-731" aria-hidden="true" tabindex="-1"></a>            conversations_list <span class="op">=</span> data[<span class="st">&#39;conversations&#39;</span>]</span>
<span id="cb19-732"><a href="#cb19-732" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(conversations_list, <span class="bu">list</span>):</span>
<span id="cb19-733"><a href="#cb19-733" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;‚ùå Grok: &#39;conversations&#39; n√£o √© uma lista.&quot;</span>)</span>
<span id="cb19-734"><a href="#cb19-734" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span></span>
<span id="cb19-735"><a href="#cb19-735" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-736"><a href="#cb19-736" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;üìä Grok: encontradas </span><span class="sc">{</span><span class="bu">len</span>(conversations_list)<span class="sc">}</span><span class="ss"> conversas.&quot;</span>)</span>
<span id="cb19-737"><a href="#cb19-737" aria-hidden="true" tabindex="-1"></a>            total_convs <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb19-738"><a href="#cb19-738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-739"><a href="#cb19-739" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> item <span class="kw">in</span> conversations_list:</span>
<span id="cb19-740"><a href="#cb19-740" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(item, <span class="bu">dict</span>):</span>
<span id="cb19-741"><a href="#cb19-741" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">continue</span></span>
<span id="cb19-742"><a href="#cb19-742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-743"><a href="#cb19-743" aria-hidden="true" tabindex="-1"></a>                conv_meta <span class="op">=</span> item.get(<span class="st">&#39;conversation&#39;</span>)</span>
<span id="cb19-744"><a href="#cb19-744" aria-hidden="true" tabindex="-1"></a>                responses <span class="op">=</span> item.get(<span class="st">&#39;responses&#39;</span>, [])</span>
<span id="cb19-745"><a href="#cb19-745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-746"><a href="#cb19-746" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(conv_meta, <span class="bu">dict</span>) <span class="kw">or</span> <span class="kw">not</span> <span class="bu">isinstance</span>(responses, <span class="bu">list</span>) <span class="kw">or</span> <span class="kw">not</span> responses:</span>
<span id="cb19-747"><a href="#cb19-747" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">continue</span></span>
<span id="cb19-748"><a href="#cb19-748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-749"><a href="#cb19-749" aria-hidden="true" tabindex="-1"></a>                conv_id <span class="op">=</span> conv_meta.get(<span class="st">&#39;id&#39;</span>)</span>
<span id="cb19-750"><a href="#cb19-750" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="kw">not</span> conv_id:</span>
<span id="cb19-751"><a href="#cb19-751" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">continue</span></span>
<span id="cb19-752"><a href="#cb19-752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-753"><a href="#cb19-753" aria-hidden="true" tabindex="-1"></a>                title <span class="op">=</span> conv_meta.get(<span class="st">&#39;title&#39;</span>, <span class="ss">f&quot;Conversa Grok </span><span class="sc">{</span>total_convs <span class="op">+</span> <span class="dv">1</span><span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb19-754"><a href="#cb19-754" aria-hidden="true" tabindex="-1"></a>                title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(title)</span>
<span id="cb19-755"><a href="#cb19-755" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb19-756"><a href="#cb19-756" aria-hidden="true" tabindex="-1"></a>                create_time_str <span class="op">=</span> conv_meta.get(<span class="st">&#39;create_time&#39;</span>)</span>
<span id="cb19-757"><a href="#cb19-757" aria-hidden="true" tabindex="-1"></a>                modify_time_str <span class="op">=</span> conv_meta.get(<span class="st">&#39;modify_time&#39;</span>)</span>
<span id="cb19-758"><a href="#cb19-758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-759"><a href="#cb19-759" aria-hidden="true" tabindex="-1"></a>                <span class="kw">def</span> format_iso_timestamp(ts_str):</span>
<span id="cb19-760"><a href="#cb19-760" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="kw">not</span> ts_str:</span>
<span id="cb19-761"><a href="#cb19-761" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb19-762"><a href="#cb19-762" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">try</span>:</span>
<span id="cb19-763"><a href="#cb19-763" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">if</span> <span class="st">&#39;.&#39;</span> <span class="kw">in</span> ts_str:</span>
<span id="cb19-764"><a href="#cb19-764" aria-hidden="true" tabindex="-1"></a>                            ts_str <span class="op">=</span> ts_str.split(<span class="st">&#39;.&#39;</span>)[<span class="dv">0</span>] <span class="op">+</span> <span class="st">&#39;Z&#39;</span></span>
<span id="cb19-765"><a href="#cb19-765" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">return</span> <span class="va">self</span>.format_timestamp(ts_str)</span>
<span id="cb19-766"><a href="#cb19-766" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">except</span>:</span>
<span id="cb19-767"><a href="#cb19-767" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">return</span> <span class="bu">str</span>(ts_str)</span>
<span id="cb19-768"><a href="#cb19-768" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-769"><a href="#cb19-769" aria-hidden="true" tabindex="-1"></a>                inserted_at <span class="op">=</span> format_iso_timestamp(create_time_str)</span>
<span id="cb19-770"><a href="#cb19-770" aria-hidden="true" tabindex="-1"></a>                updated_at <span class="op">=</span> format_iso_timestamp(modify_time_str)</span>
<span id="cb19-771"><a href="#cb19-771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-772"><a href="#cb19-772" aria-hidden="true" tabindex="-1"></a>                messages <span class="op">=</span> []</span>
<span id="cb19-773"><a href="#cb19-773" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> resp <span class="kw">in</span> responses:</span>
<span id="cb19-774"><a href="#cb19-774" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(resp, <span class="bu">dict</span>):</span>
<span id="cb19-775"><a href="#cb19-775" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb19-776"><a href="#cb19-776" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-777"><a href="#cb19-777" aria-hidden="true" tabindex="-1"></a>                    resp_data <span class="op">=</span> resp.get(<span class="st">&#39;response&#39;</span>)</span>
<span id="cb19-778"><a href="#cb19-778" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(resp_data, <span class="bu">dict</span>):</span>
<span id="cb19-779"><a href="#cb19-779" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb19-780"><a href="#cb19-780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-781"><a href="#cb19-781" aria-hidden="true" tabindex="-1"></a>                    sender <span class="op">=</span> resp_data.get(<span class="st">&#39;sender&#39;</span>, <span class="st">&#39;&#39;</span>).upper()</span>
<span id="cb19-782"><a href="#cb19-782" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> sender <span class="op">==</span> <span class="st">&#39;HUMAN&#39;</span>:</span>
<span id="cb19-783"><a href="#cb19-783" aria-hidden="true" tabindex="-1"></a>                        author <span class="op">=</span> <span class="st">&quot;üë§ Utilizador&quot;</span></span>
<span id="cb19-784"><a href="#cb19-784" aria-hidden="true" tabindex="-1"></a>                        role <span class="op">=</span> <span class="st">&quot;user&quot;</span></span>
<span id="cb19-785"><a href="#cb19-785" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">elif</span> sender <span class="op">==</span> <span class="st">&#39;ASSISTANT&#39;</span>:</span>
<span id="cb19-786"><a href="#cb19-786" aria-hidden="true" tabindex="-1"></a>                        author <span class="op">=</span> <span class="st">&quot;ü§ñ Grok&quot;</span></span>
<span id="cb19-787"><a href="#cb19-787" aria-hidden="true" tabindex="-1"></a>                        role <span class="op">=</span> <span class="st">&quot;assistant&quot;</span></span>
<span id="cb19-788"><a href="#cb19-788" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">else</span>:</span>
<span id="cb19-789"><a href="#cb19-789" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb19-790"><a href="#cb19-790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-791"><a href="#cb19-791" aria-hidden="true" tabindex="-1"></a>                    content <span class="op">=</span> <span class="bu">str</span>(resp_data.get(<span class="st">&#39;message&#39;</span>, <span class="st">&#39;&#39;</span>)).strip()</span>
<span id="cb19-792"><a href="#cb19-792" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb19-793"><a href="#cb19-793" aria-hidden="true" tabindex="-1"></a>                    content <span class="op">=</span> <span class="va">self</span>.preserve_special_content(content)</span>
<span id="cb19-794"><a href="#cb19-794" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb19-795"><a href="#cb19-795" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="kw">not</span> content:</span>
<span id="cb19-796"><a href="#cb19-796" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb19-797"><a href="#cb19-797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-798"><a href="#cb19-798" aria-hidden="true" tabindex="-1"></a>                    create_time <span class="op">=</span> resp_data.get(<span class="st">&#39;create_time&#39;</span>)</span>
<span id="cb19-799"><a href="#cb19-799" aria-hidden="true" tabindex="-1"></a>                    timestamp_ms <span class="op">=</span> <span class="va">None</span></span>
<span id="cb19-800"><a href="#cb19-800" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="bu">isinstance</span>(create_time, <span class="bu">dict</span>) <span class="kw">and</span> <span class="st">&#39;$date&#39;</span> <span class="kw">in</span> create_time:</span>
<span id="cb19-801"><a href="#cb19-801" aria-hidden="true" tabindex="-1"></a>                        date_obj <span class="op">=</span> create_time[<span class="st">&#39;$date&#39;</span>]</span>
<span id="cb19-802"><a href="#cb19-802" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">if</span> <span class="bu">isinstance</span>(date_obj, <span class="bu">dict</span>) <span class="kw">and</span> <span class="st">&#39;$numberLong&#39;</span> <span class="kw">in</span> date_obj:</span>
<span id="cb19-803"><a href="#cb19-803" aria-hidden="true" tabindex="-1"></a>                            <span class="cf">try</span>:</span>
<span id="cb19-804"><a href="#cb19-804" aria-hidden="true" tabindex="-1"></a>                                timestamp_ms <span class="op">=</span> <span class="bu">int</span>(date_obj[<span class="st">&#39;$numberLong&#39;</span>])</span>
<span id="cb19-805"><a href="#cb19-805" aria-hidden="true" tabindex="-1"></a>                            <span class="cf">except</span>:</span>
<span id="cb19-806"><a href="#cb19-806" aria-hidden="true" tabindex="-1"></a>                                <span class="cf">pass</span></span>
<span id="cb19-807"><a href="#cb19-807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-808"><a href="#cb19-808" aria-hidden="true" tabindex="-1"></a>                    messages.append({</span>
<span id="cb19-809"><a href="#cb19-809" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;author&#39;</span>: author,</span>
<span id="cb19-810"><a href="#cb19-810" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;role&#39;</span>: role,</span>
<span id="cb19-811"><a href="#cb19-811" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;content&#39;</span>: content,</span>
<span id="cb19-812"><a href="#cb19-812" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;timestamp&#39;</span>: <span class="va">self</span>.format_timestamp(timestamp_ms <span class="op">/</span> <span class="fl">1000.0</span> <span class="cf">if</span> timestamp_ms <span class="cf">else</span> <span class="va">None</span>),</span>
<span id="cb19-813"><a href="#cb19-813" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;model&#39;</span>: <span class="st">&#39;Grok&#39;</span></span>
<span id="cb19-814"><a href="#cb19-814" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb19-815"><a href="#cb19-815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-816"><a href="#cb19-816" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> messages:</span>
<span id="cb19-817"><a href="#cb19-817" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.all_conversations.append({</span>
<span id="cb19-818"><a href="#cb19-818" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;title&#39;</span>: title,</span>
<span id="cb19-819"><a href="#cb19-819" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;source&#39;</span>: <span class="st">&#39;Grok&#39;</span>,</span>
<span id="cb19-820"><a href="#cb19-820" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;id&#39;</span>: conv_id,</span>
<span id="cb19-821"><a href="#cb19-821" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;inserted_at&#39;</span>: inserted_at,</span>
<span id="cb19-822"><a href="#cb19-822" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;updated_at&#39;</span>: updated_at,</span>
<span id="cb19-823"><a href="#cb19-823" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;messages&#39;</span>: messages,</span>
<span id="cb19-824"><a href="#cb19-824" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;summary&#39;</span>: messages[<span class="dv">0</span>][<span class="st">&#39;content&#39;</span>][:<span class="dv">100</span>] <span class="op">+</span> <span class="st">&quot;...&quot;</span> <span class="cf">if</span> messages <span class="cf">else</span> <span class="st">&quot;Sem conte√∫do&quot;</span>,</span>
<span id="cb19-825"><a href="#cb19-825" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;category&#39;</span>: <span class="st">&#39;Geral&#39;</span></span>
<span id="cb19-826"><a href="#cb19-826" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb19-827"><a href="#cb19-827" aria-hidden="true" tabindex="-1"></a>                    total_convs <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb19-828"><a href="#cb19-828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-829"><a href="#cb19-829" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> total_convs <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb19-830"><a href="#cb19-830" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ Grok: processadas </span><span class="sc">{</span>total_convs<span class="sc">}</span><span class="ss"> conversas.&quot;</span>)</span>
<span id="cb19-831"><a href="#cb19-831" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb19-832"><a href="#cb19-832" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;‚ùå Grok: nenhuma conversa v√°lida encontrada.&quot;</span>)</span>
<span id="cb19-833"><a href="#cb19-833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-834"><a href="#cb19-834" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb19-835"><a href="#cb19-835" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚ùå Erro ao processar Grok: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb19-836"><a href="#cb19-836" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb19-837"><a href="#cb19-837" aria-hidden="true" tabindex="-1"></a>                traceback.print_exc()</span>
<span id="cb19-838"><a href="#cb19-838" aria-hidden="true" tabindex="-1"></a>        <span class="cf">finally</span>:</span>
<span id="cb19-839"><a href="#cb19-839" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="st">&#39;temp_dir&#39;</span> <span class="kw">in</span> <span class="bu">locals</span>():</span>
<span id="cb19-840"><a href="#cb19-840" aria-hidden="true" tabindex="-1"></a>                shutil.rmtree(temp_dir, ignore_errors<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb19-841"><a href="#cb19-841" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-842"><a href="#cb19-842" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> save_as_markdown_enhanced(<span class="va">self</span>):</span>
<span id="cb19-843"><a href="#cb19-843" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Salva conversas com preserva√ß√£o total de formata√ß√£o&quot;&quot;&quot;</span></span>
<span id="cb19-844"><a href="#cb19-844" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb19-845"><a href="#cb19-845" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;üß™ [DRY-RUN] Markdowns seriam criados:&quot;</span>)</span>
<span id="cb19-846"><a href="#cb19-846" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> conv <span class="kw">in</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb19-847"><a href="#cb19-847" aria-hidden="true" tabindex="-1"></a>                safe_title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(conv[<span class="st">&#39;title&#39;</span>])</span>
<span id="cb19-848"><a href="#cb19-848" aria-hidden="true" tabindex="-1"></a>                filename <span class="op">=</span> <span class="ss">f&quot;</span><span class="sc">{</span>conv[<span class="st">&#39;number&#39;</span>]<span class="sc">:03d}</span><span class="ss">_</span><span class="sc">{</span>conv[<span class="st">&#39;source&#39;</span>]<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>safe_title<span class="sc">}</span><span class="ss">.md&quot;</span></span>
<span id="cb19-849"><a href="#cb19-849" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;   üìÑ </span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb19-850"><a href="#cb19-850" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb19-851"><a href="#cb19-851" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb19-852"><a href="#cb19-852" aria-hidden="true" tabindex="-1"></a>        folder <span class="op">=</span> <span class="va">self</span>.output_dirs[<span class="st">&#39;markdown&#39;</span>]</span>
<span id="cb19-853"><a href="#cb19-853" aria-hidden="true" tabindex="-1"></a>        saved_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb19-854"><a href="#cb19-854" aria-hidden="true" tabindex="-1"></a>        failed_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb19-855"><a href="#cb19-855" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-856"><a href="#cb19-856" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> conv <span class="kw">in</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb19-857"><a href="#cb19-857" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb19-858"><a href="#cb19-858" aria-hidden="true" tabindex="-1"></a>                safe_title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(conv[<span class="st">&#39;title&#39;</span>])</span>
<span id="cb19-859"><a href="#cb19-859" aria-hidden="true" tabindex="-1"></a>                filename <span class="op">=</span> <span class="ss">f&quot;</span><span class="sc">{</span>conv[<span class="st">&#39;number&#39;</span>]<span class="sc">:03d}</span><span class="ss">_</span><span class="sc">{</span>conv[<span class="st">&#39;source&#39;</span>]<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>safe_title<span class="sc">}</span><span class="ss">.md&quot;</span></span>
<span id="cb19-860"><a href="#cb19-860" aria-hidden="true" tabindex="-1"></a>                filepath <span class="op">=</span> Path(folder) <span class="op">/</span> filename</span>
<span id="cb19-861"><a href="#cb19-861" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb19-862"><a href="#cb19-862" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.force_overwrite <span class="kw">and</span> filepath.exists():</span>
<span id="cb19-863"><a href="#cb19-863" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">continue</span></span>
<span id="cb19-864"><a href="#cb19-864" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb19-865"><a href="#cb19-865" aria-hidden="true" tabindex="-1"></a>                markdown_content <span class="op">=</span> <span class="va">self</span>.create_enhanced_markdown_content(conv)</span>
<span id="cb19-866"><a href="#cb19-866" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb19-867"><a href="#cb19-867" aria-hidden="true" tabindex="-1"></a>                <span class="cf">with</span> <span class="bu">open</span>(filepath, <span class="st">&#39;w&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb19-868"><a href="#cb19-868" aria-hidden="true" tabindex="-1"></a>                    f.write(markdown_content)</span>
<span id="cb19-869"><a href="#cb19-869" aria-hidden="true" tabindex="-1"></a>                saved_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb19-870"><a href="#cb19-870" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb19-871"><a href="#cb19-871" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb19-872"><a href="#cb19-872" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;‚ùå Erro ao salvar conversa </span><span class="sc">{</span>conv[<span class="st">&#39;number&#39;</span>]<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb19-873"><a href="#cb19-873" aria-hidden="true" tabindex="-1"></a>                failed_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb19-874"><a href="#cb19-874" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span></span>
<span id="cb19-875"><a href="#cb19-875" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb19-876"><a href="#cb19-876" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ Markdown: </span><span class="sc">{</span>saved_count<span class="sc">}</span><span class="ss"> arquivos criados, </span><span class="sc">{</span>failed_count<span class="sc">}</span><span class="ss"> falhas em &#39;</span><span class="sc">{</span>folder<span class="sc">}</span><span class="ss">&#39;&quot;</span>)</span>
<span id="cb19-877"><a href="#cb19-877" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-878"><a href="#cb19-878" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> save_as_csv(<span class="va">self</span>):</span>
<span id="cb19-879"><a href="#cb19-879" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Salva conversas em arquivos CSV individuais&quot;&quot;&quot;</span></span>
<span id="cb19-880"><a href="#cb19-880" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb19-881"><a href="#cb19-881" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;üß™ [DRY-RUN] CSVs seriam criados:&quot;</span>)</span>
<span id="cb19-882"><a href="#cb19-882" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> conv <span class="kw">in</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb19-883"><a href="#cb19-883" aria-hidden="true" tabindex="-1"></a>                safe_title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(conv[<span class="st">&#39;title&#39;</span>])</span>
<span id="cb19-884"><a href="#cb19-884" aria-hidden="true" tabindex="-1"></a>                filename <span class="op">=</span> <span class="ss">f&quot;</span><span class="sc">{</span>conv[<span class="st">&#39;number&#39;</span>]<span class="sc">:03d}</span><span class="ss">_</span><span class="sc">{</span>conv[<span class="st">&#39;source&#39;</span>]<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>safe_title<span class="sc">}</span><span class="ss">.csv&quot;</span></span>
<span id="cb19-885"><a href="#cb19-885" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;   üìä </span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb19-886"><a href="#cb19-886" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb19-887"><a href="#cb19-887" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb19-888"><a href="#cb19-888" aria-hidden="true" tabindex="-1"></a>        folder <span class="op">=</span> <span class="va">self</span>.output_dirs[<span class="st">&#39;csv&#39;</span>]</span>
<span id="cb19-889"><a href="#cb19-889" aria-hidden="true" tabindex="-1"></a>        saved_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb19-890"><a href="#cb19-890" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-891"><a href="#cb19-891" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> conv <span class="kw">in</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb19-892"><a href="#cb19-892" aria-hidden="true" tabindex="-1"></a>            safe_title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(conv[<span class="st">&#39;title&#39;</span>])</span>
<span id="cb19-893"><a href="#cb19-893" aria-hidden="true" tabindex="-1"></a>            filename <span class="op">=</span> <span class="ss">f&quot;</span><span class="sc">{</span>conv[<span class="st">&#39;number&#39;</span>]<span class="sc">:03d}</span><span class="ss">_</span><span class="sc">{</span>conv[<span class="st">&#39;source&#39;</span>]<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>safe_title<span class="sc">}</span><span class="ss">.csv&quot;</span></span>
<span id="cb19-894"><a href="#cb19-894" aria-hidden="true" tabindex="-1"></a>            filepath <span class="op">=</span> Path(folder) <span class="op">/</span> filename</span>
<span id="cb19-895"><a href="#cb19-895" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb19-896"><a href="#cb19-896" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.force_overwrite <span class="kw">and</span> filepath.exists():</span>
<span id="cb19-897"><a href="#cb19-897" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span></span>
<span id="cb19-898"><a href="#cb19-898" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb19-899"><a href="#cb19-899" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(filepath, <span class="st">&#39;w&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>, newline<span class="op">=</span><span class="st">&#39;&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb19-900"><a href="#cb19-900" aria-hidden="true" tabindex="-1"></a>                writer <span class="op">=</span> csv.DictWriter(f, fieldnames<span class="op">=</span>[</span>
<span id="cb19-901"><a href="#cb19-901" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;node_id&#39;</span>, <span class="st">&#39;author&#39;</span>, <span class="st">&#39;role&#39;</span>, <span class="st">&#39;timestamp&#39;</span>, <span class="st">&#39;model&#39;</span>, <span class="st">&#39;content&#39;</span></span>
<span id="cb19-902"><a href="#cb19-902" aria-hidden="true" tabindex="-1"></a>                ])</span>
<span id="cb19-903"><a href="#cb19-903" aria-hidden="true" tabindex="-1"></a>                writer.writeheader()</span>
<span id="cb19-904"><a href="#cb19-904" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> i, msg <span class="kw">in</span> <span class="bu">enumerate</span>(conv[<span class="st">&#39;messages&#39;</span>]):</span>
<span id="cb19-905"><a href="#cb19-905" aria-hidden="true" tabindex="-1"></a>                    writer.writerow({</span>
<span id="cb19-906"><a href="#cb19-906" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;node_id&#39;</span>: <span class="bu">str</span>(i),</span>
<span id="cb19-907"><a href="#cb19-907" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;author&#39;</span>: msg[<span class="st">&#39;author&#39;</span>],</span>
<span id="cb19-908"><a href="#cb19-908" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;role&#39;</span>: msg[<span class="st">&#39;role&#39;</span>],</span>
<span id="cb19-909"><a href="#cb19-909" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;timestamp&#39;</span>: msg[<span class="st">&#39;timestamp&#39;</span>],</span>
<span id="cb19-910"><a href="#cb19-910" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;model&#39;</span>: msg[<span class="st">&#39;model&#39;</span>],</span>
<span id="cb19-911"><a href="#cb19-911" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;content&#39;</span>: msg[<span class="st">&#39;content&#39;</span>]</span>
<span id="cb19-912"><a href="#cb19-912" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb19-913"><a href="#cb19-913" aria-hidden="true" tabindex="-1"></a>            saved_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb19-914"><a href="#cb19-914" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb19-915"><a href="#cb19-915" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ CSV: </span><span class="sc">{</span>saved_count<span class="sc">}</span><span class="ss"> arquivos criados em &#39;</span><span class="sc">{</span>folder<span class="sc">}</span><span class="ss">&#39;&quot;</span>)</span>
<span id="cb19-916"><a href="#cb19-916" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-917"><a href="#cb19-917" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> save_as_json(<span class="va">self</span>):</span>
<span id="cb19-918"><a href="#cb19-918" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Salva conversas em arquivos JSON individuais&quot;&quot;&quot;</span></span>
<span id="cb19-919"><a href="#cb19-919" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb19-920"><a href="#cb19-920" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;üß™ [DRY-RUN] JSONs seriam criados:&quot;</span>)</span>
<span id="cb19-921"><a href="#cb19-921" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> conv <span class="kw">in</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb19-922"><a href="#cb19-922" aria-hidden="true" tabindex="-1"></a>                safe_title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(conv[<span class="st">&#39;title&#39;</span>])</span>
<span id="cb19-923"><a href="#cb19-923" aria-hidden="true" tabindex="-1"></a>                filename <span class="op">=</span> <span class="ss">f&quot;</span><span class="sc">{</span>conv[<span class="st">&#39;number&#39;</span>]<span class="sc">:03d}</span><span class="ss">_</span><span class="sc">{</span>conv[<span class="st">&#39;source&#39;</span>]<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>safe_title<span class="sc">}</span><span class="ss">.json&quot;</span></span>
<span id="cb19-924"><a href="#cb19-924" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;   üìã </span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb19-925"><a href="#cb19-925" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb19-926"><a href="#cb19-926" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb19-927"><a href="#cb19-927" aria-hidden="true" tabindex="-1"></a>        folder <span class="op">=</span> <span class="va">self</span>.output_dirs[<span class="st">&#39;json&#39;</span>]</span>
<span id="cb19-928"><a href="#cb19-928" aria-hidden="true" tabindex="-1"></a>        saved_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb19-929"><a href="#cb19-929" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-930"><a href="#cb19-930" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> conv <span class="kw">in</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb19-931"><a href="#cb19-931" aria-hidden="true" tabindex="-1"></a>            safe_title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(conv[<span class="st">&#39;title&#39;</span>])</span>
<span id="cb19-932"><a href="#cb19-932" aria-hidden="true" tabindex="-1"></a>            filename <span class="op">=</span> <span class="ss">f&quot;</span><span class="sc">{</span>conv[<span class="st">&#39;number&#39;</span>]<span class="sc">:03d}</span><span class="ss">_</span><span class="sc">{</span>conv[<span class="st">&#39;source&#39;</span>]<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>safe_title<span class="sc">}</span><span class="ss">.json&quot;</span></span>
<span id="cb19-933"><a href="#cb19-933" aria-hidden="true" tabindex="-1"></a>            filepath <span class="op">=</span> Path(folder) <span class="op">/</span> filename</span>
<span id="cb19-934"><a href="#cb19-934" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb19-935"><a href="#cb19-935" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.force_overwrite <span class="kw">and</span> filepath.exists():</span>
<span id="cb19-936"><a href="#cb19-936" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span></span>
<span id="cb19-937"><a href="#cb19-937" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb19-938"><a href="#cb19-938" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(filepath, <span class="st">&#39;w&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb19-939"><a href="#cb19-939" aria-hidden="true" tabindex="-1"></a>                json.dump(conv, f, ensure_ascii<span class="op">=</span><span class="va">False</span>, indent<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb19-940"><a href="#cb19-940" aria-hidden="true" tabindex="-1"></a>            saved_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb19-941"><a href="#cb19-941" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb19-942"><a href="#cb19-942" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ JSON: </span><span class="sc">{</span>saved_count<span class="sc">}</span><span class="ss"> arquivos criados em &#39;</span><span class="sc">{</span>folder<span class="sc">}</span><span class="ss">&#39;&quot;</span>)</span>
<span id="cb19-943"><a href="#cb19-943" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-944"><a href="#cb19-944" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> save_all_to_single_files(<span class="va">self</span>):</span>
<span id="cb19-945"><a href="#cb19-945" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Salva todas as conversas em arquivos √∫nicos CSV e JSON&quot;&quot;&quot;</span></span>
<span id="cb19-946"><a href="#cb19-946" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb19-947"><a href="#cb19-947" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;üß™ [DRY-RUN] Arquivos √∫nicos seriam criados:&quot;</span>)</span>
<span id="cb19-948"><a href="#cb19-948" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;   üìÅ </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>single_files[<span class="st">&#39;csv&#39;</span>]<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb19-949"><a href="#cb19-949" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;   üìÅ </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>single_files[<span class="st">&#39;json&#39;</span>]<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb19-950"><a href="#cb19-950" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb19-951"><a href="#cb19-951" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb19-952"><a href="#cb19-952" aria-hidden="true" tabindex="-1"></a>        <span class="co"># CSV √∫nico</span></span>
<span id="cb19-953"><a href="#cb19-953" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> <span class="bu">open</span>(<span class="va">self</span>.single_files[<span class="st">&#39;csv&#39;</span>], <span class="st">&#39;w&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>, newline<span class="op">=</span><span class="st">&#39;&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb19-954"><a href="#cb19-954" aria-hidden="true" tabindex="-1"></a>            fieldnames <span class="op">=</span> [</span>
<span id="cb19-955"><a href="#cb19-955" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;conversation_number&#39;</span>, <span class="st">&#39;source&#39;</span>, <span class="st">&#39;conversation_title&#39;</span>, <span class="st">&#39;category&#39;</span>,</span>
<span id="cb19-956"><a href="#cb19-956" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;author&#39;</span>, <span class="st">&#39;role&#39;</span>, <span class="st">&#39;timestamp&#39;</span>, <span class="st">&#39;model&#39;</span>, <span class="st">&#39;content&#39;</span></span>
<span id="cb19-957"><a href="#cb19-957" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb19-958"><a href="#cb19-958" aria-hidden="true" tabindex="-1"></a>            writer <span class="op">=</span> csv.DictWriter(f, fieldnames<span class="op">=</span>fieldnames)</span>
<span id="cb19-959"><a href="#cb19-959" aria-hidden="true" tabindex="-1"></a>            writer.writeheader()</span>
<span id="cb19-960"><a href="#cb19-960" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> conv <span class="kw">in</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb19-961"><a href="#cb19-961" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> msg <span class="kw">in</span> conv[<span class="st">&#39;messages&#39;</span>]:</span>
<span id="cb19-962"><a href="#cb19-962" aria-hidden="true" tabindex="-1"></a>                    writer.writerow({</span>
<span id="cb19-963"><a href="#cb19-963" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;conversation_number&#39;</span>: conv[<span class="st">&#39;number&#39;</span>],</span>
<span id="cb19-964"><a href="#cb19-964" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;source&#39;</span>: conv[<span class="st">&#39;source&#39;</span>],</span>
<span id="cb19-965"><a href="#cb19-965" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;conversation_title&#39;</span>: conv[<span class="st">&#39;title&#39;</span>],</span>
<span id="cb19-966"><a href="#cb19-966" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;category&#39;</span>: conv[<span class="st">&#39;category&#39;</span>],</span>
<span id="cb19-967"><a href="#cb19-967" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;author&#39;</span>: msg[<span class="st">&#39;author&#39;</span>],</span>
<span id="cb19-968"><a href="#cb19-968" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;role&#39;</span>: msg[<span class="st">&#39;role&#39;</span>],</span>
<span id="cb19-969"><a href="#cb19-969" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;timestamp&#39;</span>: msg[<span class="st">&#39;timestamp&#39;</span>],</span>
<span id="cb19-970"><a href="#cb19-970" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;model&#39;</span>: msg[<span class="st">&#39;model&#39;</span>],</span>
<span id="cb19-971"><a href="#cb19-971" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;content&#39;</span>: msg[<span class="st">&#39;content&#39;</span>]</span>
<span id="cb19-972"><a href="#cb19-972" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb19-973"><a href="#cb19-973" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ CSV √∫nico: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>single_files[<span class="st">&#39;csv&#39;</span>]<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb19-974"><a href="#cb19-974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-975"><a href="#cb19-975" aria-hidden="true" tabindex="-1"></a>        <span class="co"># JSON √∫nico</span></span>
<span id="cb19-976"><a href="#cb19-976" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> <span class="bu">open</span>(<span class="va">self</span>.single_files[<span class="st">&#39;json&#39;</span>], <span class="st">&#39;w&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb19-977"><a href="#cb19-977" aria-hidden="true" tabindex="-1"></a>            json.dump(<span class="va">self</span>.all_conversations, f, ensure_ascii<span class="op">=</span><span class="va">False</span>, indent<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb19-978"><a href="#cb19-978" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ JSON √∫nico: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>single_files[<span class="st">&#39;json&#39;</span>]<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb19-979"><a href="#cb19-979" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-980"><a href="#cb19-980" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_searchable_index(<span class="va">self</span>):</span>
<span id="cb19-981"><a href="#cb19-981" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Cria √≠ndice HTML pesquis√°vel com links para HTML&quot;&quot;&quot;</span></span>
<span id="cb19-982"><a href="#cb19-982" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb19-983"><a href="#cb19-983" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;üß™ [DRY-RUN] √çndice HTML seria criado: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>index_file<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb19-984"><a href="#cb19-984" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb19-985"><a href="#cb19-985" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb19-986"><a href="#cb19-986" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;üéØ Criando √≠ndice HTML combinado...&quot;</span>)</span>
<span id="cb19-987"><a href="#cb19-987" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-988"><a href="#cb19-988" aria-hidden="true" tabindex="-1"></a>        category_stats <span class="op">=</span> {}</span>
<span id="cb19-989"><a href="#cb19-989" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> conv <span class="kw">in</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb19-990"><a href="#cb19-990" aria-hidden="true" tabindex="-1"></a>            cat <span class="op">=</span> conv[<span class="st">&#39;category&#39;</span>]</span>
<span id="cb19-991"><a href="#cb19-991" aria-hidden="true" tabindex="-1"></a>            category_stats[cat] <span class="op">=</span> category_stats.get(cat, <span class="dv">0</span>) <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb19-992"><a href="#cb19-992" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-993"><a href="#cb19-993" aria-hidden="true" tabindex="-1"></a>        html_content <span class="op">=</span> <span class="ss">f&quot;&quot;&quot;&lt;!DOCTYPE html&gt;</span></span>
<span id="cb19-994"><a href="#cb19-994" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;html lang=&quot;pt-PT&quot;&gt;</span></span>
<span id="cb19-995"><a href="#cb19-995" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;head&gt;</span></span>
<span id="cb19-996"><a href="#cb19-996" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span></span>
<span id="cb19-997"><a href="#cb19-997" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span></span>
<span id="cb19-998"><a href="#cb19-998" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;title&gt;√çndice Combinado - AI Chats&lt;/title&gt;</span></span>
<span id="cb19-999"><a href="#cb19-999" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;style&gt;</span></span>
<span id="cb19-1000"><a href="#cb19-1000" aria-hidden="true" tabindex="-1"></a><span class="ss">        * </span><span class="ch">{{</span><span class="ss"> margin: 0; padding: 0; box-sizing: border-box; </span><span class="ch">}}</span></span>
<span id="cb19-1001"><a href="#cb19-1001" aria-hidden="true" tabindex="-1"></a><span class="ss">        body </span><span class="ch">{{</span><span class="ss"> font-family: &#39;Segoe UI&#39;, Tahoma, Geneva, Verdana, sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; padding: 20px; color: #333; </span><span class="ch">}}</span></span>
<span id="cb19-1002"><a href="#cb19-1002" aria-hidden="true" tabindex="-1"></a><span class="ss">        .container </span><span class="ch">{{</span><span class="ss"> max-width: 1400px; margin: 0 auto; background: white; border-radius: 15px; box-shadow: 0 20px 40px rgba(0,0,0,0.1); overflow: hidden; </span><span class="ch">}}</span></span>
<span id="cb19-1003"><a href="#cb19-1003" aria-hidden="true" tabindex="-1"></a><span class="ss">        .header </span><span class="ch">{{</span><span class="ss"> background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 40px; text-align: center; </span><span class="ch">}}</span></span>
<span id="cb19-1004"><a href="#cb19-1004" aria-hidden="true" tabindex="-1"></a><span class="ss">        .header h1 </span><span class="ch">{{</span><span class="ss"> font-size: 2.8em; margin-bottom: 15px; font-weight: 300; </span><span class="ch">}}</span></span>
<span id="cb19-1005"><a href="#cb19-1005" aria-hidden="true" tabindex="-1"></a><span class="ss">        .header p </span><span class="ch">{{</span><span class="ss"> font-size: 1.2em; opacity: 0.9; margin-bottom: 20px; </span><span class="ch">}}</span></span>
<span id="cb19-1006"><a href="#cb19-1006" aria-hidden="true" tabindex="-1"></a><span class="ss">        .stats </span><span class="ch">{{</span><span class="ss"> display: flex; justify-content: center; gap: 30px; margin-top: 25px; flex-wrap: wrap; </span><span class="ch">}}</span></span>
<span id="cb19-1007"><a href="#cb19-1007" aria-hidden="true" tabindex="-1"></a><span class="ss">        .stat-item </span><span class="ch">{{</span><span class="ss"> background: rgba(255,255,255,0.15); padding: 18px 28px; border-radius: 12px; backdrop-filter: blur(10px); font-size: 1.1em; </span><span class="ch">}}</span></span>
<span id="cb19-1008"><a href="#cb19-1008" aria-hidden="true" tabindex="-1"></a><span class="ss">        .search-section </span><span class="ch">{{</span><span class="ss"> padding: 30px; background: #f8f9fa; border-bottom: 1px solid #e9ecef; </span><span class="ch">}}</span></span>
<span id="cb19-1009"><a href="#cb19-1009" aria-hidden="true" tabindex="-1"></a><span class="ss">        .search-box </span><span class="ch">{{</span><span class="ss"> width: 100%; padding: 18px 25px; font-size: 16px; border: 2px solid #e9ecef; border-radius: 25px; outline: none; transition: all 0.3s ease; font-family: inherit; </span><span class="ch">}}</span></span>
<span id="cb19-1010"><a href="#cb19-1010" aria-hidden="true" tabindex="-1"></a><span class="ss">        .search-box:focus </span><span class="ch">{{</span><span class="ss"> border-color: #667eea; box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1); </span><span class="ch">}}</span></span>
<span id="cb19-1011"><a href="#cb19-1011" aria-hidden="true" tabindex="-1"></a><span class="ss">        .filter-section </span><span class="ch">{{</span></span>
<span id="cb19-1012"><a href="#cb19-1012" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 20px 30px;</span></span>
<span id="cb19-1013"><a href="#cb19-1013" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: flex;</span></span>
<span id="cb19-1014"><a href="#cb19-1014" aria-hidden="true" tabindex="-1"></a><span class="ss">            flex-wrap: wrap;</span></span>
<span id="cb19-1015"><a href="#cb19-1015" aria-hidden="true" tabindex="-1"></a><span class="ss">            gap: 12px;</span></span>
<span id="cb19-1016"><a href="#cb19-1016" aria-hidden="true" tabindex="-1"></a><span class="ss">            justify-content: center;</span></span>
<span id="cb19-1017"><a href="#cb19-1017" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #f8f9fa;</span></span>
<span id="cb19-1018"><a href="#cb19-1018" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-bottom: 1px solid #e9ecef;</span></span>
<span id="cb19-1019"><a href="#cb19-1019" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb19-1020"><a href="#cb19-1020" aria-hidden="true" tabindex="-1"></a><span class="ss">        .filter-btn </span><span class="ch">{{</span></span>
<span id="cb19-1021"><a href="#cb19-1021" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 10px 20px;</span></span>
<span id="cb19-1022"><a href="#cb19-1022" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: white;</span></span>
<span id="cb19-1023"><a href="#cb19-1023" aria-hidden="true" tabindex="-1"></a><span class="ss">            border: 2px solid #e9ecef;</span></span>
<span id="cb19-1024"><a href="#cb19-1024" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 25px;</span></span>
<span id="cb19-1025"><a href="#cb19-1025" aria-hidden="true" tabindex="-1"></a><span class="ss">            cursor: pointer;</span></span>
<span id="cb19-1026"><a href="#cb19-1026" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.95em;</span></span>
<span id="cb19-1027"><a href="#cb19-1027" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-weight: 500;</span></span>
<span id="cb19-1028"><a href="#cb19-1028" aria-hidden="true" tabindex="-1"></a><span class="ss">            transition: all 0.3s ease;</span></span>
<span id="cb19-1029"><a href="#cb19-1029" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-family: inherit;</span></span>
<span id="cb19-1030"><a href="#cb19-1030" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb19-1031"><a href="#cb19-1031" aria-hidden="true" tabindex="-1"></a><span class="ss">        .filter-btn.active, .filter-btn:hover </span><span class="ch">{{</span></span>
<span id="cb19-1032"><a href="#cb19-1032" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #667eea;</span></span>
<span id="cb19-1033"><a href="#cb19-1033" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: white;</span></span>
<span id="cb19-1034"><a href="#cb19-1034" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-color: #667eea;</span></span>
<span id="cb19-1035"><a href="#cb19-1035" aria-hidden="true" tabindex="-1"></a><span class="ss">            transform: translateY(-2px);</span></span>
<span id="cb19-1036"><a href="#cb19-1036" aria-hidden="true" tabindex="-1"></a><span class="ss">            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);</span></span>
<span id="cb19-1037"><a href="#cb19-1037" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb19-1038"><a href="#cb19-1038" aria-hidden="true" tabindex="-1"></a><span class="ss">        .conversations-grid </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb19-1039"><a href="#cb19-1039" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: grid; </span></span>
<span id="cb19-1040"><a href="#cb19-1040" aria-hidden="true" tabindex="-1"></a><span class="ss">            grid-template-columns: repeat(auto-fill, minmax(380px, 1fr)); </span></span>
<span id="cb19-1041"><a href="#cb19-1041" aria-hidden="true" tabindex="-1"></a><span class="ss">            gap: 25px; </span></span>
<span id="cb19-1042"><a href="#cb19-1042" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 35px;</span></span>
<span id="cb19-1043"><a href="#cb19-1043" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);</span></span>
<span id="cb19-1044"><a href="#cb19-1044" aria-hidden="true" tabindex="-1"></a><span class="ss">            min-height: 400px;</span></span>
<span id="cb19-1045"><a href="#cb19-1045" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb19-1046"><a href="#cb19-1046" aria-hidden="true" tabindex="-1"></a><span class="ss">        .conversation-card </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb19-1047"><a href="#cb19-1047" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: white; </span></span>
<span id="cb19-1048"><a href="#cb19-1048" aria-hidden="true" tabindex="-1"></a><span class="ss">            border: 1px solid #e9ecef; </span></span>
<span id="cb19-1049"><a href="#cb19-1049" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 15px; </span></span>
<span id="cb19-1050"><a href="#cb19-1050" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 25px; </span></span>
<span id="cb19-1051"><a href="#cb19-1051" aria-hidden="true" tabindex="-1"></a><span class="ss">            transition: all 0.4s ease; </span></span>
<span id="cb19-1052"><a href="#cb19-1052" aria-hidden="true" tabindex="-1"></a><span class="ss">            cursor: pointer; </span></span>
<span id="cb19-1053"><a href="#cb19-1053" aria-hidden="true" tabindex="-1"></a><span class="ss">            position: relative;</span></span>
<span id="cb19-1054"><a href="#cb19-1054" aria-hidden="true" tabindex="-1"></a><span class="ss">            box-shadow: 0 5px 15px rgba(0,0,0,0.08);</span></span>
<span id="cb19-1055"><a href="#cb19-1055" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb19-1056"><a href="#cb19-1056" aria-hidden="true" tabindex="-1"></a><span class="ss">        .conversation-card:hover </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb19-1057"><a href="#cb19-1057" aria-hidden="true" tabindex="-1"></a><span class="ss">            transform: translateY(-8px); </span></span>
<span id="cb19-1058"><a href="#cb19-1058" aria-hidden="true" tabindex="-1"></a><span class="ss">            box-shadow: 0 15px 35px rgba(0,0,0,0.15); </span></span>
<span id="cb19-1059"><a href="#cb19-1059" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-color: #667eea;</span></span>
<span id="cb19-1060"><a href="#cb19-1060" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb19-1061"><a href="#cb19-1061" aria-hidden="true" tabindex="-1"></a><span class="ss">        .card-header </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb19-1062"><a href="#cb19-1062" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: flex; </span></span>
<span id="cb19-1063"><a href="#cb19-1063" aria-hidden="true" tabindex="-1"></a><span class="ss">            justify-content: space-between; </span></span>
<span id="cb19-1064"><a href="#cb19-1064" aria-hidden="true" tabindex="-1"></a><span class="ss">            align-items: flex-start; </span></span>
<span id="cb19-1065"><a href="#cb19-1065" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-bottom: 18px; </span></span>
<span id="cb19-1066"><a href="#cb19-1066" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb19-1067"><a href="#cb19-1067" aria-hidden="true" tabindex="-1"></a><span class="ss">        .card-number </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb19-1068"><a href="#cb19-1068" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: linear-gradient(135deg, #667eea, #764ba2); </span></span>
<span id="cb19-1069"><a href="#cb19-1069" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: white; </span></span>
<span id="cb19-1070"><a href="#cb19-1070" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 8px 16px; </span></span>
<span id="cb19-1071"><a href="#cb19-1071" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 20px; </span></span>
<span id="cb19-1072"><a href="#cb19-1072" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.9em; </span></span>
<span id="cb19-1073"><a href="#cb19-1073" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-weight: bold;</span></span>
<span id="cb19-1074"><a href="#cb19-1074" aria-hidden="true" tabindex="-1"></a><span class="ss">            box-shadow: 0 3px 10px rgba(102, 126, 234, 0.3);</span></span>
<span id="cb19-1075"><a href="#cb19-1075" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb19-1076"><a href="#cb19-1076" aria-hidden="true" tabindex="-1"></a><span class="ss">        .card-source </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb19-1077"><a href="#cb19-1077" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #e3f2fd; </span></span>
<span id="cb19-1078"><a href="#cb19-1078" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #1976d2; </span></span>
<span id="cb19-1079"><a href="#cb19-1079" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 5px 12px; </span></span>
<span id="cb19-1080"><a href="#cb19-1080" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 12px; </span></span>
<span id="cb19-1081"><a href="#cb19-1081" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.85em; </span></span>
<span id="cb19-1082"><a href="#cb19-1082" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-weight: bold; </span></span>
<span id="cb19-1083"><a href="#cb19-1083" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-left: 10px;</span></span>
<span id="cb19-1084"><a href="#cb19-1084" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb19-1085"><a href="#cb19-1085" aria-hidden="true" tabindex="-1"></a><span class="ss">        .card-title </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb19-1086"><a href="#cb19-1086" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 1.3em; </span></span>
<span id="cb19-1087"><a href="#cb19-1087" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-weight: 600; </span></span>
<span id="cb19-1088"><a href="#cb19-1088" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #2c3e50; </span></span>
<span id="cb19-1089"><a href="#cb19-1089" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-bottom: 12px; </span></span>
<span id="cb19-1090"><a href="#cb19-1090" aria-hidden="true" tabindex="-1"></a><span class="ss">            line-height: 1.4;</span></span>
<span id="cb19-1091"><a href="#cb19-1091" aria-hidden="true" tabindex="-1"></a><span class="ss">            min-height: 3.6em;</span></span>
<span id="cb19-1092"><a href="#cb19-1092" aria-hidden="true" tabindex="-1"></a><span class="ss">            cursor: pointer;</span></span>
<span id="cb19-1093"><a href="#cb19-1093" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb19-1094"><a href="#cb19-1094" aria-hidden="true" tabindex="-1"></a><span class="ss">        .card-summary </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb19-1095"><a href="#cb19-1095" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #6c757d; </span></span>
<span id="cb19-1096"><a href="#cb19-1096" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.95em; </span></span>
<span id="cb19-1097"><a href="#cb19-1097" aria-hidden="true" tabindex="-1"></a><span class="ss">            line-height: 1.5; </span></span>
<span id="cb19-1098"><a href="#cb19-1098" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-bottom: 18px;</span></span>
<span id="cb19-1099"><a href="#cb19-1099" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: -webkit-box;</span></span>
<span id="cb19-1100"><a href="#cb19-1100" aria-hidden="true" tabindex="-1"></a><span class="ss">            -webkit-line-clamp: 3;</span></span>
<span id="cb19-1101"><a href="#cb19-1101" aria-hidden="true" tabindex="-1"></a><span class="ss">            -webkit-box-orient: vertical;</span></span>
<span id="cb19-1102"><a href="#cb19-1102" aria-hidden="true" tabindex="-1"></a><span class="ss">            overflow: hidden;</span></span>
<span id="cb19-1103"><a href="#cb19-1103" aria-hidden="true" tabindex="-1"></a><span class="ss">            cursor: pointer;</span></span>
<span id="cb19-1104"><a href="#cb19-1104" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb19-1105"><a href="#cb19-1105" aria-hidden="true" tabindex="-1"></a><span class="ss">        .card-meta </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb19-1106"><a href="#cb19-1106" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: flex; </span></span>
<span id="cb19-1107"><a href="#cb19-1107" aria-hidden="true" tabindex="-1"></a><span class="ss">            justify-content: space-between; </span></span>
<span id="cb19-1108"><a href="#cb19-1108" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.85em; </span></span>
<span id="cb19-1109"><a href="#cb19-1109" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #868e96; </span></span>
<span id="cb19-1110"><a href="#cb19-1110" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-top: 1px solid #e9ecef; </span></span>
<span id="cb19-1111"><a href="#cb19-1111" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding-top: 18px;</span></span>
<span id="cb19-1112"><a href="#cb19-1112" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb19-1113"><a href="#cb19-1113" aria-hidden="true" tabindex="-1"></a><span class="ss">        .card-actions </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb19-1114"><a href="#cb19-1114" aria-hidden="true" tabindex="-1"></a><span class="ss">            position: absolute; </span></span>
<span id="cb19-1115"><a href="#cb19-1115" aria-hidden="true" tabindex="-1"></a><span class="ss">            top: 20px; </span></span>
<span id="cb19-1116"><a href="#cb19-1116" aria-hidden="true" tabindex="-1"></a><span class="ss">            right: 20px; </span></span>
<span id="cb19-1117"><a href="#cb19-1117" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: flex; </span></span>
<span id="cb19-1118"><a href="#cb19-1118" aria-hidden="true" tabindex="-1"></a><span class="ss">            gap: 8px; </span></span>
<span id="cb19-1119"><a href="#cb19-1119" aria-hidden="true" tabindex="-1"></a><span class="ss">            opacity: 0; </span></span>
<span id="cb19-1120"><a href="#cb19-1120" aria-hidden="true" tabindex="-1"></a><span class="ss">            transition: opacity 0.3s ease; </span></span>
<span id="cb19-1121"><a href="#cb19-1121" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb19-1122"><a href="#cb19-1122" aria-hidden="true" tabindex="-1"></a><span class="ss">        .conversation-card:hover .card-actions </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb19-1123"><a href="#cb19-1123" aria-hidden="true" tabindex="-1"></a><span class="ss">            opacity: 1; </span></span>
<span id="cb19-1124"><a href="#cb19-1124" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb19-1125"><a href="#cb19-1125" aria-hidden="true" tabindex="-1"></a><span class="ss">        .action-btn </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb19-1126"><a href="#cb19-1126" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: white; </span></span>
<span id="cb19-1127"><a href="#cb19-1127" aria-hidden="true" tabindex="-1"></a><span class="ss">            border: 2px solid #e9ecef; </span></span>
<span id="cb19-1128"><a href="#cb19-1128" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 8px; </span></span>
<span id="cb19-1129"><a href="#cb19-1129" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 6px 12px; </span></span>
<span id="cb19-1130"><a href="#cb19-1130" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.8em; </span></span>
<span id="cb19-1131"><a href="#cb19-1131" aria-hidden="true" tabindex="-1"></a><span class="ss">            cursor: pointer; </span></span>
<span id="cb19-1132"><a href="#cb19-1132" aria-hidden="true" tabindex="-1"></a><span class="ss">            transition: all 0.3s ease;</span></span>
<span id="cb19-1133"><a href="#cb19-1133" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-weight: 500;</span></span>
<span id="cb19-1134"><a href="#cb19-1134" aria-hidden="true" tabindex="-1"></a><span class="ss">            text-decoration: none;</span></span>
<span id="cb19-1135"><a href="#cb19-1135" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #333;</span></span>
<span id="cb19-1136"><a href="#cb19-1136" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: inline-block;</span></span>
<span id="cb19-1137"><a href="#cb19-1137" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb19-1138"><a href="#cb19-1138" aria-hidden="true" tabindex="-1"></a><span class="ss">        .action-btn:hover </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb19-1139"><a href="#cb19-1139" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #667eea; </span></span>
<span id="cb19-1140"><a href="#cb19-1140" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: white; </span></span>
<span id="cb19-1141"><a href="#cb19-1141" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-color: #667eea;</span></span>
<span id="cb19-1142"><a href="#cb19-1142" aria-hidden="true" tabindex="-1"></a><span class="ss">            transform: scale(1.05);</span></span>
<span id="cb19-1143"><a href="#cb19-1143" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb19-1144"><a href="#cb19-1144" aria-hidden="true" tabindex="-1"></a><span class="ss">        .recent-badge </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb19-1145"><a href="#cb19-1145" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #ff6b6b; </span></span>
<span id="cb19-1146"><a href="#cb19-1146" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: white; </span></span>
<span id="cb19-1147"><a href="#cb19-1147" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 3px 10px; </span></span>
<span id="cb19-1148"><a href="#cb19-1148" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 12px; </span></span>
<span id="cb19-1149"><a href="#cb19-1149" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.75em; </span></span>
<span id="cb19-1150"><a href="#cb19-1150" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-left: 8px;</span></span>
<span id="cb19-1151"><a href="#cb19-1151" aria-hidden="true" tabindex="-1"></a><span class="ss">            animation: pulse 2s infinite;</span></span>
<span id="cb19-1152"><a href="#cb19-1152" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb19-1153"><a href="#cb19-1153" aria-hidden="true" tabindex="-1"></a><span class="ss">        .no-results </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb19-1154"><a href="#cb19-1154" aria-hidden="true" tabindex="-1"></a><span class="ss">            text-align: center; </span></span>
<span id="cb19-1155"><a href="#cb19-1155" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 60px 20px; </span></span>
<span id="cb19-1156"><a href="#cb19-1156" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #6c757d;</span></span>
<span id="cb19-1157"><a href="#cb19-1157" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 1.1em;</span></span>
<span id="cb19-1158"><a href="#cb19-1158" aria-hidden="true" tabindex="-1"></a><span class="ss">            grid-column: 1 / -1;</span></span>
<span id="cb19-1159"><a href="#cb19-1159" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb19-1160"><a href="#cb19-1160" aria-hidden="true" tabindex="-1"></a><span class="ss">        @keyframes pulse </span><span class="ch">{{</span></span>
<span id="cb19-1161"><a href="#cb19-1161" aria-hidden="true" tabindex="-1"></a><span class="ss">            0% </span><span class="ch">{{</span><span class="ss"> transform: scale(1); </span><span class="ch">}}</span></span>
<span id="cb19-1162"><a href="#cb19-1162" aria-hidden="true" tabindex="-1"></a><span class="ss">            50% </span><span class="ch">{{</span><span class="ss"> transform: scale(1.05); </span><span class="ch">}}</span></span>
<span id="cb19-1163"><a href="#cb19-1163" aria-hidden="true" tabindex="-1"></a><span class="ss">            100% </span><span class="ch">{{</span><span class="ss"> transform: scale(1); </span><span class="ch">}}</span></span>
<span id="cb19-1164"><a href="#cb19-1164" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb19-1165"><a href="#cb19-1165" aria-hidden="true" tabindex="-1"></a><span class="ss">        .category-badge </span><span class="ch">{{</span></span>
<span id="cb19-1166"><a href="#cb19-1166" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: inline-block;</span></span>
<span id="cb19-1167"><a href="#cb19-1167" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #e3f2fd;</span></span>
<span id="cb19-1168"><a href="#cb19-1168" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #1976d2;</span></span>
<span id="cb19-1169"><a href="#cb19-1169" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 4px 10px;</span></span>
<span id="cb19-1170"><a href="#cb19-1170" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 12px;</span></span>
<span id="cb19-1171"><a href="#cb19-1171" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.8em;</span></span>
<span id="cb19-1172"><a href="#cb19-1172" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-left: 8px;</span></span>
<span id="cb19-1173"><a href="#cb19-1173" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-weight: 500;</span></span>
<span id="cb19-1174"><a href="#cb19-1174" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb19-1175"><a href="#cb19-1175" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb19-1176"><a href="#cb19-1176" aria-hidden="true" tabindex="-1"></a><span class="ss">        .direct-link </span><span class="ch">{{</span></span>
<span id="cb19-1177"><a href="#cb19-1177" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: inline-block;</span></span>
<span id="cb19-1178"><a href="#cb19-1178" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin: 5px;</span></span>
<span id="cb19-1179"><a href="#cb19-1179" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 8px 15px;</span></span>
<span id="cb19-1180"><a href="#cb19-1180" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #28a745;</span></span>
<span id="cb19-1181"><a href="#cb19-1181" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: white;</span></span>
<span id="cb19-1182"><a href="#cb19-1182" aria-hidden="true" tabindex="-1"></a><span class="ss">            text-decoration: none;</span></span>
<span id="cb19-1183"><a href="#cb19-1183" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 5px;</span></span>
<span id="cb19-1184"><a href="#cb19-1184" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.9em;</span></span>
<span id="cb19-1185"><a href="#cb19-1185" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb19-1186"><a href="#cb19-1186" aria-hidden="true" tabindex="-1"></a><span class="ss">        .direct-link:hover </span><span class="ch">{{</span></span>
<span id="cb19-1187"><a href="#cb19-1187" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #218838;</span></span>
<span id="cb19-1188"><a href="#cb19-1188" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb19-1189"><a href="#cb19-1189" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb19-1190"><a href="#cb19-1190" aria-hidden="true" tabindex="-1"></a><span class="ss">        .html-btn </span><span class="ch">{{</span></span>
<span id="cb19-1191"><a href="#cb19-1191" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #17a2b8;</span></span>
<span id="cb19-1192"><a href="#cb19-1192" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: white;</span></span>
<span id="cb19-1193"><a href="#cb19-1193" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb19-1194"><a href="#cb19-1194" aria-hidden="true" tabindex="-1"></a><span class="ss">        .html-btn:hover </span><span class="ch">{{</span></span>
<span id="cb19-1195"><a href="#cb19-1195" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #138496;</span></span>
<span id="cb19-1196"><a href="#cb19-1196" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb19-1197"><a href="#cb19-1197" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;/style&gt;</span></span>
<span id="cb19-1198"><a href="#cb19-1198" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;/head&gt;</span></span>
<span id="cb19-1199"><a href="#cb19-1199" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;body&gt;</span></span>
<span id="cb19-1200"><a href="#cb19-1200" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;div class=&quot;container&quot;&gt;</span></span>
<span id="cb19-1201"><a href="#cb19-1201" aria-hidden="true" tabindex="-1"></a><span class="ss">        &lt;div class=&quot;header&quot;&gt;</span></span>
<span id="cb19-1202"><a href="#cb19-1202" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;h1&gt;üìö √çndice Combinado de Conversas&lt;/h1&gt;</span></span>
<span id="cb19-1203"><a href="#cb19-1203" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;p&gt;Qwen3 ‚Ä¢ ChatGPT ‚Ä¢ DeepSeek ‚Ä¢ Grok ‚Ä¢ COM HTML (Pandoc)&lt;/p&gt;</span></span>
<span id="cb19-1204"><a href="#cb19-1204" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;div class=&quot;stats&quot;&gt;</span></span>
<span id="cb19-1205"><a href="#cb19-1205" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;div class=&quot;stat-item&quot;&gt;</span></span>
<span id="cb19-1206"><a href="#cb19-1206" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;strong&gt;Total:&lt;/strong&gt; &lt;span id=&quot;total-count&quot;&gt;</span><span class="sc">{</span><span class="bu">len</span>(<span class="va">self</span>.all_conversations)<span class="sc">}</span><span class="ss">&lt;/span&gt; conversas</span></span>
<span id="cb19-1207"><a href="#cb19-1207" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;/div&gt;</span></span>
<span id="cb19-1208"><a href="#cb19-1208" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;div class=&quot;stat-item&quot;&gt;</span></span>
<span id="cb19-1209"><a href="#cb19-1209" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;strong&gt;Ordena√ß√£o:&lt;/strong&gt; Mais Recentes Primeiro</span></span>
<span id="cb19-1210"><a href="#cb19-1210" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;/div&gt;</span></span>
<span id="cb19-1211"><a href="#cb19-1211" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;div class=&quot;stat-item&quot;&gt;</span></span>
<span id="cb19-1212"><a href="#cb19-1212" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;strong&gt;Atualizado:&lt;/strong&gt; </span><span class="sc">{</span>datetime<span class="sc">.</span>now()<span class="sc">.</span>strftime(<span class="st">&#39;</span><span class="sc">%d</span><span class="st">/%m/%Y %H:%M&#39;</span>)<span class="sc">}</span></span>
<span id="cb19-1213"><a href="#cb19-1213" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;/div&gt;</span></span>
<span id="cb19-1214"><a href="#cb19-1214" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;/div&gt;</span></span>
<span id="cb19-1215"><a href="#cb19-1215" aria-hidden="true" tabindex="-1"></a><span class="ss">        &lt;/div&gt;</span></span>
<span id="cb19-1216"><a href="#cb19-1216" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb19-1217"><a href="#cb19-1217" aria-hidden="true" tabindex="-1"></a><span class="ss">        &lt;div class=&quot;search-section&quot;&gt;</span></span>
<span id="cb19-1218"><a href="#cb19-1218" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;input type=&quot;text&quot; id=&quot;searchInput&quot; class=&quot;search-box&quot; placeholder=&quot;üîç Pesquisar por t√≠tulo, conte√∫do ou categoria...&quot;&gt;</span></span>
<span id="cb19-1219"><a href="#cb19-1219" aria-hidden="true" tabindex="-1"></a><span class="ss">        &lt;/div&gt;</span></span>
<span id="cb19-1220"><a href="#cb19-1220" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb19-1221"><a href="#cb19-1221" aria-hidden="true" tabindex="-1"></a><span class="ss">        &lt;div class=&quot;filter-section&quot;&gt;</span></span>
<span id="cb19-1222"><a href="#cb19-1222" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;button class=&quot;filter-btn active&quot; data-filter=&quot;todas&quot;&gt;Todas (</span><span class="sc">{</span><span class="bu">len</span>(<span class="va">self</span>.all_conversations)<span class="sc">}</span><span class="ss">)&lt;/button&gt;</span></span>
<span id="cb19-1223"><a href="#cb19-1223" aria-hidden="true" tabindex="-1"></a><span class="ss">&quot;&quot;&quot;</span></span>
<span id="cb19-1224"><a href="#cb19-1224" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-1225"><a href="#cb19-1225" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> category, count <span class="kw">in</span> category_stats.items():</span>
<span id="cb19-1226"><a href="#cb19-1226" aria-hidden="true" tabindex="-1"></a>            html_content <span class="op">+=</span> <span class="ss">f&#39;&lt;button class=&quot;filter-btn&quot; data-filter=&quot;</span><span class="sc">{</span>category<span class="sc">.</span>lower()<span class="sc">}</span><span class="ss">&quot;&gt;</span><span class="sc">{</span>category<span class="sc">}</span><span class="ss"> (</span><span class="sc">{</span>count<span class="sc">}</span><span class="ss">)&lt;/button&gt;</span><span class="ch">\n</span><span class="ss">&#39;</span></span>
<span id="cb19-1227"><a href="#cb19-1227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1228"><a href="#cb19-1228" aria-hidden="true" tabindex="-1"></a>        html_content <span class="op">+=</span> <span class="st">&quot;&quot;&quot;</span></span>
<span id="cb19-1229"><a href="#cb19-1229" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;/div&gt;</span></span>
<span id="cb19-1230"><a href="#cb19-1230" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb19-1231"><a href="#cb19-1231" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;div style=&quot;text-align: center; padding: 15px; background: #e9ecef; border-bottom: 1px solid #ddd;&quot;&gt;</span></span>
<span id="cb19-1232"><a href="#cb19-1232" aria-hidden="true" tabindex="-1"></a><span class="st">            &lt;strong&gt;Acesso R√°pido:&lt;/strong&gt;</span></span>
<span id="cb19-1233"><a href="#cb19-1233" aria-hidden="true" tabindex="-1"></a><span class="st">            &lt;a href=&quot;combined_markdown/&quot; class=&quot;direct-link&quot; target=&quot;_blank&quot;&gt;üìÅ Markdown&lt;/a&gt;</span></span>
<span id="cb19-1234"><a href="#cb19-1234" aria-hidden="true" tabindex="-1"></a><span class="st">            &lt;a href=&quot;combined_html/&quot; class=&quot;direct-link&quot; target=&quot;_blank&quot;&gt;üåê HTML&lt;/a&gt;</span></span>
<span id="cb19-1235"><a href="#cb19-1235" aria-hidden="true" tabindex="-1"></a><span class="st">            &lt;a href=&quot;combined_pdfs/&quot; class=&quot;direct-link&quot; target=&quot;_blank&quot;&gt;üìä PDFs&lt;/a&gt;</span></span>
<span id="cb19-1236"><a href="#cb19-1236" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;/div&gt;</span></span>
<span id="cb19-1237"><a href="#cb19-1237" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb19-1238"><a href="#cb19-1238" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;div class=&quot;conversations-grid&quot; id=&quot;conversationsGrid&quot;&gt;</span></span>
<span id="cb19-1239"><a href="#cb19-1239" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;&quot;&quot;</span></span>
<span id="cb19-1240"><a href="#cb19-1240" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-1241"><a href="#cb19-1241" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, conv <span class="kw">in</span> <span class="bu">enumerate</span>(<span class="va">self</span>.all_conversations):</span>
<span id="cb19-1242"><a href="#cb19-1242" aria-hidden="true" tabindex="-1"></a>            safe_title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(conv[<span class="st">&#39;title&#39;</span>])</span>
<span id="cb19-1243"><a href="#cb19-1243" aria-hidden="true" tabindex="-1"></a>            filename <span class="op">=</span> <span class="ss">f&quot;</span><span class="sc">{</span>conv[<span class="st">&#39;number&#39;</span>]<span class="sc">:03d}</span><span class="ss">_</span><span class="sc">{</span>conv[<span class="st">&#39;source&#39;</span>]<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>safe_title<span class="sc">}</span><span class="ss">&quot;</span></span>
<span id="cb19-1244"><a href="#cb19-1244" aria-hidden="true" tabindex="-1"></a>            recent_badge <span class="op">=</span> <span class="st">&quot;&lt;span class=&#39;recent-badge&#39;&gt;NOVO&lt;/span&gt;&quot;</span> <span class="cf">if</span> i <span class="op">&lt;</span> <span class="dv">5</span> <span class="cf">else</span> <span class="st">&quot;&quot;</span></span>
<span id="cb19-1245"><a href="#cb19-1245" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb19-1246"><a href="#cb19-1246" aria-hidden="true" tabindex="-1"></a>            summary <span class="op">=</span> conv.get(<span class="st">&#39;summary&#39;</span>, <span class="st">&#39;Sem resumo dispon√≠vel&#39;</span>)</span>
<span id="cb19-1247"><a href="#cb19-1247" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">len</span>(summary) <span class="op">&gt;</span> <span class="dv">150</span>:</span>
<span id="cb19-1248"><a href="#cb19-1248" aria-hidden="true" tabindex="-1"></a>                summary <span class="op">=</span> summary[:<span class="dv">150</span>] <span class="op">+</span> <span class="st">&quot;...&quot;</span></span>
<span id="cb19-1249"><a href="#cb19-1249" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb19-1250"><a href="#cb19-1250" aria-hidden="true" tabindex="-1"></a>            html_content <span class="op">+=</span> <span class="ss">f&quot;&quot;&quot;</span></span>
<span id="cb19-1251"><a href="#cb19-1251" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;div class=&quot;conversation-card&quot; data-title=&quot;</span><span class="sc">{</span>conv[<span class="st">&#39;title&#39;</span>]<span class="sc">}</span><span class="ss">&quot; data-summary=&quot;</span><span class="sc">{</span>summary<span class="sc">}</span><span class="ss">&quot; data-source=&quot;</span><span class="sc">{</span>conv[<span class="st">&#39;source&#39;</span>]<span class="sc">.</span>lower()<span class="sc">}</span><span class="ss">&quot; data-category=&quot;</span><span class="sc">{</span>conv[<span class="st">&#39;category&#39;</span>]<span class="sc">.</span>lower()<span class="sc">}</span><span class="ss">&quot;&gt;</span></span>
<span id="cb19-1252"><a href="#cb19-1252" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;div class=&quot;card-header&quot;&gt;</span></span>
<span id="cb19-1253"><a href="#cb19-1253" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;div class=&quot;card-number&quot;&gt;#</span><span class="sc">{</span>conv[<span class="st">&#39;number&#39;</span>]<span class="sc">}</span><span class="ss"> </span><span class="sc">{</span>recent_badge<span class="sc">}</span><span class="ss">&lt;/div&gt;</span></span>
<span id="cb19-1254"><a href="#cb19-1254" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;div class=&quot;card-actions&quot;&gt;</span></span>
<span id="cb19-1255"><a href="#cb19-1255" aria-hidden="true" tabindex="-1"></a><span class="ss">                        &lt;a href=&quot;combined_markdown/</span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">.md&quot; class=&quot;action-btn&quot; target=&quot;_blank&quot; onclick=&quot;event.stopPropagation();&quot;&gt;üìÑ MD&lt;/a&gt;</span></span>
<span id="cb19-1256"><a href="#cb19-1256" aria-hidden="true" tabindex="-1"></a><span class="ss">                        &lt;a href=&quot;combined_html/</span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">.html&quot; class=&quot;action-btn html-btn&quot; target=&quot;_blank&quot; onclick=&quot;event.stopPropagation();&quot;&gt;üåê HTML&lt;/a&gt;</span></span>
<span id="cb19-1257"><a href="#cb19-1257" aria-hidden="true" tabindex="-1"></a><span class="ss">                        &lt;a href=&quot;combined_pdfs/</span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">.pdf&quot; class=&quot;action-btn&quot; target=&quot;_blank&quot; onclick=&quot;event.stopPropagation();&quot;&gt;üìä PDF&lt;/a&gt;</span></span>
<span id="cb19-1258"><a href="#cb19-1258" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;/div&gt;</span></span>
<span id="cb19-1259"><a href="#cb19-1259" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;/div&gt;</span></span>
<span id="cb19-1260"><a href="#cb19-1260" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;div class=&quot;card-title&quot; onclick=&quot;openHTML(&#39;</span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">.html&#39;)&quot;&gt;</span><span class="sc">{</span>conv[<span class="st">&#39;title&#39;</span>]<span class="sc">}</span><span class="ss">&lt;/div&gt;</span></span>
<span id="cb19-1261"><a href="#cb19-1261" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;div&gt;</span></span>
<span id="cb19-1262"><a href="#cb19-1262" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;span class=&quot;card-source&quot;&gt;</span><span class="sc">{</span>conv[<span class="st">&#39;source&#39;</span>]<span class="sc">}</span><span class="ss">&lt;/span&gt;</span></span>
<span id="cb19-1263"><a href="#cb19-1263" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;span class=&quot;category-badge&quot;&gt;</span><span class="sc">{</span>conv[<span class="st">&#39;category&#39;</span>]<span class="sc">}</span><span class="ss">&lt;/span&gt;</span></span>
<span id="cb19-1264"><a href="#cb19-1264" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;/div&gt;</span></span>
<span id="cb19-1265"><a href="#cb19-1265" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;div class=&quot;card-summary&quot; onclick=&quot;openHTML(&#39;</span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">.html&#39;)&quot;&gt;</span><span class="sc">{</span>summary<span class="sc">}</span><span class="ss">&lt;/div&gt;</span></span>
<span id="cb19-1266"><a href="#cb19-1266" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;div class=&quot;card-meta&quot;&gt;</span></span>
<span id="cb19-1267"><a href="#cb19-1267" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;span&gt;üìÖ </span><span class="sc">{</span>conv<span class="sc">.</span>get(<span class="st">&#39;updated_at&#39;</span>) <span class="kw">or</span> conv<span class="sc">.</span>get(<span class="st">&#39;inserted_at&#39;</span>) <span class="kw">or</span> <span class="st">&#39;N/A&#39;</span><span class="sc">}</span><span class="ss">&lt;/span&gt;</span></span>
<span id="cb19-1268"><a href="#cb19-1268" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;span&gt;üí¨ </span><span class="sc">{</span><span class="bu">len</span>(conv[<span class="st">&#39;messages&#39;</span>])<span class="sc">}</span><span class="ss"> mensagens&lt;/span&gt;</span></span>
<span id="cb19-1269"><a href="#cb19-1269" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;/div&gt;</span></span>
<span id="cb19-1270"><a href="#cb19-1270" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;/div&gt;</span></span>
<span id="cb19-1271"><a href="#cb19-1271" aria-hidden="true" tabindex="-1"></a><span class="ss">            &quot;&quot;&quot;</span></span>
<span id="cb19-1272"><a href="#cb19-1272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1273"><a href="#cb19-1273" aria-hidden="true" tabindex="-1"></a>        html_content <span class="op">+=</span> <span class="st">&quot;&quot;&quot;</span></span>
<span id="cb19-1274"><a href="#cb19-1274" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;/div&gt;</span></span>
<span id="cb19-1275"><a href="#cb19-1275" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;/div&gt;</span></span>
<span id="cb19-1276"><a href="#cb19-1276" aria-hidden="true" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb19-1277"><a href="#cb19-1277" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;script&gt;</span></span>
<span id="cb19-1278"><a href="#cb19-1278" aria-hidden="true" tabindex="-1"></a><span class="st">        let currentFilter = &#39;todas&#39;;</span></span>
<span id="cb19-1279"><a href="#cb19-1279" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb19-1280"><a href="#cb19-1280" aria-hidden="true" tabindex="-1"></a><span class="st">        document.addEventListener(&#39;DOMContentLoaded&#39;, function() {</span></span>
<span id="cb19-1281"><a href="#cb19-1281" aria-hidden="true" tabindex="-1"></a><span class="st">            updateStats();</span></span>
<span id="cb19-1282"><a href="#cb19-1282" aria-hidden="true" tabindex="-1"></a><span class="st">        });</span></span>
<span id="cb19-1283"><a href="#cb19-1283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1284"><a href="#cb19-1284" aria-hidden="true" tabindex="-1"></a><span class="st">        document.querySelectorAll(&#39;.filter-btn&#39;).forEach(btn =&gt; {</span></span>
<span id="cb19-1285"><a href="#cb19-1285" aria-hidden="true" tabindex="-1"></a><span class="st">            btn.addEventListener(&#39;click&#39;, () =&gt; {</span></span>
<span id="cb19-1286"><a href="#cb19-1286" aria-hidden="true" tabindex="-1"></a><span class="st">                document.querySelectorAll(&#39;.filter-btn&#39;).forEach(b =&gt; b.classList.remove(&#39;active&#39;));</span></span>
<span id="cb19-1287"><a href="#cb19-1287" aria-hidden="true" tabindex="-1"></a><span class="st">                btn.classList.add(&#39;active&#39;);</span></span>
<span id="cb19-1288"><a href="#cb19-1288" aria-hidden="true" tabindex="-1"></a><span class="st">                currentFilter = btn.getAttribute(&#39;data-filter&#39;);</span></span>
<span id="cb19-1289"><a href="#cb19-1289" aria-hidden="true" tabindex="-1"></a><span class="st">                filterConversations();</span></span>
<span id="cb19-1290"><a href="#cb19-1290" aria-hidden="true" tabindex="-1"></a><span class="st">            });</span></span>
<span id="cb19-1291"><a href="#cb19-1291" aria-hidden="true" tabindex="-1"></a><span class="st">        });</span></span>
<span id="cb19-1292"><a href="#cb19-1292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1293"><a href="#cb19-1293" aria-hidden="true" tabindex="-1"></a><span class="st">        document.getElementById(&#39;searchInput&#39;).addEventListener(&#39;input&#39;, filterConversations);</span></span>
<span id="cb19-1294"><a href="#cb19-1294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1295"><a href="#cb19-1295" aria-hidden="true" tabindex="-1"></a><span class="st">        function filterConversations() {</span></span>
<span id="cb19-1296"><a href="#cb19-1296" aria-hidden="true" tabindex="-1"></a><span class="st">            const term = document.getElementById(&#39;searchInput&#39;).value.toLowerCase();</span></span>
<span id="cb19-1297"><a href="#cb19-1297" aria-hidden="true" tabindex="-1"></a><span class="st">            const cards = document.querySelectorAll(&#39;.conversation-card&#39;);</span></span>
<span id="cb19-1298"><a href="#cb19-1298" aria-hidden="true" tabindex="-1"></a><span class="st">            let visible = 0;</span></span>
<span id="cb19-1299"><a href="#cb19-1299" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb19-1300"><a href="#cb19-1300" aria-hidden="true" tabindex="-1"></a><span class="st">            cards.forEach(card =&gt; {</span></span>
<span id="cb19-1301"><a href="#cb19-1301" aria-hidden="true" tabindex="-1"></a><span class="st">                const title = card.getAttribute(&#39;data-title&#39;).toLowerCase();</span></span>
<span id="cb19-1302"><a href="#cb19-1302" aria-hidden="true" tabindex="-1"></a><span class="st">                const summary = card.getAttribute(&#39;data-summary&#39;).toLowerCase();</span></span>
<span id="cb19-1303"><a href="#cb19-1303" aria-hidden="true" tabindex="-1"></a><span class="st">                const source = card.getAttribute(&#39;data-source&#39;).toLowerCase();</span></span>
<span id="cb19-1304"><a href="#cb19-1304" aria-hidden="true" tabindex="-1"></a><span class="st">                const category = card.getAttribute(&#39;data-category&#39;).toLowerCase();</span></span>
<span id="cb19-1305"><a href="#cb19-1305" aria-hidden="true" tabindex="-1"></a><span class="st">                </span></span>
<span id="cb19-1306"><a href="#cb19-1306" aria-hidden="true" tabindex="-1"></a><span class="st">                const matchesSearch = (title.includes(term) || summary.includes(term) || category.includes(term) || source.includes(term));</span></span>
<span id="cb19-1307"><a href="#cb19-1307" aria-hidden="true" tabindex="-1"></a><span class="st">                const matchesCategory = (currentFilter === &#39;todas&#39; || category === currentFilter);</span></span>
<span id="cb19-1308"><a href="#cb19-1308" aria-hidden="true" tabindex="-1"></a><span class="st">                </span></span>
<span id="cb19-1309"><a href="#cb19-1309" aria-hidden="true" tabindex="-1"></a><span class="st">                if (matchesSearch &amp;&amp; matchesCategory) {</span></span>
<span id="cb19-1310"><a href="#cb19-1310" aria-hidden="true" tabindex="-1"></a><span class="st">                    card.style.display = &#39;block&#39;;</span></span>
<span id="cb19-1311"><a href="#cb19-1311" aria-hidden="true" tabindex="-1"></a><span class="st">                    visible++;</span></span>
<span id="cb19-1312"><a href="#cb19-1312" aria-hidden="true" tabindex="-1"></a><span class="st">                } else {</span></span>
<span id="cb19-1313"><a href="#cb19-1313" aria-hidden="true" tabindex="-1"></a><span class="st">                    card.style.display = &#39;none&#39;;</span></span>
<span id="cb19-1314"><a href="#cb19-1314" aria-hidden="true" tabindex="-1"></a><span class="st">                }</span></span>
<span id="cb19-1315"><a href="#cb19-1315" aria-hidden="true" tabindex="-1"></a><span class="st">            });</span></span>
<span id="cb19-1316"><a href="#cb19-1316" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb19-1317"><a href="#cb19-1317" aria-hidden="true" tabindex="-1"></a><span class="st">            updateStats(visible);</span></span>
<span id="cb19-1318"><a href="#cb19-1318" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb19-1319"><a href="#cb19-1319" aria-hidden="true" tabindex="-1"></a><span class="st">            const grid = document.getElementById(&#39;conversationsGrid&#39;);</span></span>
<span id="cb19-1320"><a href="#cb19-1320" aria-hidden="true" tabindex="-1"></a><span class="st">            const noResults = document.getElementById(&#39;no-results-message&#39;);</span></span>
<span id="cb19-1321"><a href="#cb19-1321" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb19-1322"><a href="#cb19-1322" aria-hidden="true" tabindex="-1"></a><span class="st">            if (visible === 0) {</span></span>
<span id="cb19-1323"><a href="#cb19-1323" aria-hidden="true" tabindex="-1"></a><span class="st">                if (!noResults) {</span></span>
<span id="cb19-1324"><a href="#cb19-1324" aria-hidden="true" tabindex="-1"></a><span class="st">                    const noResultsMsg = document.createElement(&#39;div&#39;);</span></span>
<span id="cb19-1325"><a href="#cb19-1325" aria-hidden="true" tabindex="-1"></a><span class="st">                    noResultsMsg.id = &#39;no-results-message&#39;;</span></span>
<span id="cb19-1326"><a href="#cb19-1326" aria-hidden="true" tabindex="-1"></a><span class="st">                    noResultsMsg.className = &#39;no-results&#39;;</span></span>
<span id="cb19-1327"><a href="#cb19-1327" aria-hidden="true" tabindex="-1"></a><span class="st">                    noResultsMsg.innerHTML = &#39;üîç Nenhuma conversa encontrada. Tente ajustar os filtros ou a pesquisa.&#39;;</span></span>
<span id="cb19-1328"><a href="#cb19-1328" aria-hidden="true" tabindex="-1"></a><span class="st">                    grid.appendChild(noResultsMsg);</span></span>
<span id="cb19-1329"><a href="#cb19-1329" aria-hidden="true" tabindex="-1"></a><span class="st">                }</span></span>
<span id="cb19-1330"><a href="#cb19-1330" aria-hidden="true" tabindex="-1"></a><span class="st">            } else if (noResults) {</span></span>
<span id="cb19-1331"><a href="#cb19-1331" aria-hidden="true" tabindex="-1"></a><span class="st">                noResults.remove();</span></span>
<span id="cb19-1332"><a href="#cb19-1332" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb19-1333"><a href="#cb19-1333" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb19-1334"><a href="#cb19-1334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1335"><a href="#cb19-1335" aria-hidden="true" tabindex="-1"></a><span class="st">        function updateStats(visibleCount = null) {</span></span>
<span id="cb19-1336"><a href="#cb19-1336" aria-hidden="true" tabindex="-1"></a><span class="st">            const totalElement = document.getElementById(&#39;total-count&#39;);</span></span>
<span id="cb19-1337"><a href="#cb19-1337" aria-hidden="true" tabindex="-1"></a><span class="st">            if (visibleCount !== null) {</span></span>
<span id="cb19-1338"><a href="#cb19-1338" aria-hidden="true" tabindex="-1"></a><span class="st">                totalElement.textContent = visibleCount;</span></span>
<span id="cb19-1339"><a href="#cb19-1339" aria-hidden="true" tabindex="-1"></a><span class="st">            } else {</span></span>
<span id="cb19-1340"><a href="#cb19-1340" aria-hidden="true" tabindex="-1"></a><span class="st">                totalElement.textContent = &quot;&quot;&quot;</span> <span class="op">+</span> <span class="bu">str</span>(<span class="bu">len</span>(<span class="va">self</span>.all_conversations)) <span class="op">+</span> <span class="st">&quot;&quot;&quot;;</span></span>
<span id="cb19-1341"><a href="#cb19-1341" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb19-1342"><a href="#cb19-1342" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb19-1343"><a href="#cb19-1343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1344"><a href="#cb19-1344" aria-hidden="true" tabindex="-1"></a><span class="st">        function openHTML(filename) {</span></span>
<span id="cb19-1345"><a href="#cb19-1345" aria-hidden="true" tabindex="-1"></a><span class="st">            const htmlUrl = &#39;combined_html/&#39; + filename;</span></span>
<span id="cb19-1346"><a href="#cb19-1346" aria-hidden="true" tabindex="-1"></a><span class="st">            console.log(&#39;Abrindo HTML:&#39;, htmlUrl);</span></span>
<span id="cb19-1347"><a href="#cb19-1347" aria-hidden="true" tabindex="-1"></a><span class="st">            window.open(htmlUrl, &#39;_blank&#39;);</span></span>
<span id="cb19-1348"><a href="#cb19-1348" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb19-1349"><a href="#cb19-1349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1350"><a href="#cb19-1350" aria-hidden="true" tabindex="-1"></a><span class="st">        function openMD(filename) {</span></span>
<span id="cb19-1351"><a href="#cb19-1351" aria-hidden="true" tabindex="-1"></a><span class="st">            const mdUrl = &#39;combined_markdown/&#39; + filename;</span></span>
<span id="cb19-1352"><a href="#cb19-1352" aria-hidden="true" tabindex="-1"></a><span class="st">            window.open(mdUrl, &#39;_blank&#39;);</span></span>
<span id="cb19-1353"><a href="#cb19-1353" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb19-1354"><a href="#cb19-1354" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb19-1355"><a href="#cb19-1355" aria-hidden="true" tabindex="-1"></a><span class="st">        function openPDF(filename) {</span></span>
<span id="cb19-1356"><a href="#cb19-1356" aria-hidden="true" tabindex="-1"></a><span class="st">            const pdfFile = filename.replace(&#39;.md&#39;, &#39;.pdf&#39;);</span></span>
<span id="cb19-1357"><a href="#cb19-1357" aria-hidden="true" tabindex="-1"></a><span class="st">            const pdfUrl = &#39;combined_pdfs/&#39; + pdfFile;</span></span>
<span id="cb19-1358"><a href="#cb19-1358" aria-hidden="true" tabindex="-1"></a><span class="st">            window.open(pdfUrl, &#39;_blank&#39;);</span></span>
<span id="cb19-1359"><a href="#cb19-1359" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb19-1360"><a href="#cb19-1360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1361"><a href="#cb19-1361" aria-hidden="true" tabindex="-1"></a><span class="st">        document.addEventListener(&#39;keydown&#39;, function(e) {</span></span>
<span id="cb19-1362"><a href="#cb19-1362" aria-hidden="true" tabindex="-1"></a><span class="st">            if (e.key === &#39;Escape&#39;) {</span></span>
<span id="cb19-1363"><a href="#cb19-1363" aria-hidden="true" tabindex="-1"></a><span class="st">                document.getElementById(&#39;searchInput&#39;).value = &#39;&#39;;</span></span>
<span id="cb19-1364"><a href="#cb19-1364" aria-hidden="true" tabindex="-1"></a><span class="st">                filterConversations();</span></span>
<span id="cb19-1365"><a href="#cb19-1365" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb19-1366"><a href="#cb19-1366" aria-hidden="true" tabindex="-1"></a><span class="st">        });</span></span>
<span id="cb19-1367"><a href="#cb19-1367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1368"><a href="#cb19-1368" aria-hidden="true" tabindex="-1"></a><span class="st">        document.querySelectorAll(&#39;.conversation-card&#39;).forEach(card =&gt; {</span></span>
<span id="cb19-1369"><a href="#cb19-1369" aria-hidden="true" tabindex="-1"></a><span class="st">            card.addEventListener(&#39;click&#39;, function(e) {</span></span>
<span id="cb19-1370"><a href="#cb19-1370" aria-hidden="true" tabindex="-1"></a><span class="st">                if (e.target.closest(&#39;.action-btn&#39;)) {</span></span>
<span id="cb19-1371"><a href="#cb19-1371" aria-hidden="true" tabindex="-1"></a><span class="st">                    return;</span></span>
<span id="cb19-1372"><a href="#cb19-1372" aria-hidden="true" tabindex="-1"></a><span class="st">                }</span></span>
<span id="cb19-1373"><a href="#cb19-1373" aria-hidden="true" tabindex="-1"></a><span class="st">                </span></span>
<span id="cb19-1374"><a href="#cb19-1374" aria-hidden="true" tabindex="-1"></a><span class="st">                const htmlBtn = this.querySelector(&#39;a.html-btn&#39;);</span></span>
<span id="cb19-1375"><a href="#cb19-1375" aria-hidden="true" tabindex="-1"></a><span class="st">                if (htmlBtn) {</span></span>
<span id="cb19-1376"><a href="#cb19-1376" aria-hidden="true" tabindex="-1"></a><span class="st">                    const htmlUrl = htmlBtn.getAttribute(&#39;href&#39;);</span></span>
<span id="cb19-1377"><a href="#cb19-1377" aria-hidden="true" tabindex="-1"></a><span class="st">                    window.open(htmlUrl, &#39;_blank&#39;);</span></span>
<span id="cb19-1378"><a href="#cb19-1378" aria-hidden="true" tabindex="-1"></a><span class="st">                }</span></span>
<span id="cb19-1379"><a href="#cb19-1379" aria-hidden="true" tabindex="-1"></a><span class="st">            });</span></span>
<span id="cb19-1380"><a href="#cb19-1380" aria-hidden="true" tabindex="-1"></a><span class="st">        });</span></span>
<span id="cb19-1381"><a href="#cb19-1381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1382"><a href="#cb19-1382" aria-hidden="true" tabindex="-1"></a><span class="st">        document.getElementById(&#39;searchInput&#39;).focus();</span></span>
<span id="cb19-1383"><a href="#cb19-1383" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb19-1384"><a href="#cb19-1384" aria-hidden="true" tabindex="-1"></a><span class="st">        console.log(&#39;√çndice carregado com&#39;, &quot;&quot;&quot;</span> <span class="op">+</span> <span class="bu">str</span>(<span class="bu">len</span>(<span class="va">self</span>.all_conversations)) <span class="op">+</span> <span class="st">&quot;&quot;&quot;, &#39;conversas&#39;);</span></span>
<span id="cb19-1385"><a href="#cb19-1385" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;/script&gt;</span></span>
<span id="cb19-1386"><a href="#cb19-1386" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;/body&gt;</span></span>
<span id="cb19-1387"><a href="#cb19-1387" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;/html&gt;</span></span>
<span id="cb19-1388"><a href="#cb19-1388" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;&quot;&quot;</span></span>
<span id="cb19-1389"><a href="#cb19-1389" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-1390"><a href="#cb19-1390" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> <span class="bu">open</span>(<span class="va">self</span>.index_file, <span class="st">&#39;w&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb19-1391"><a href="#cb19-1391" aria-hidden="true" tabindex="-1"></a>            f.write(html_content)</span>
<span id="cb19-1392"><a href="#cb19-1392" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ √çndice combinado criado: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>index_file<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb19-1393"><a href="#cb19-1393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1394"><a href="#cb19-1394" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> main():</span>
<span id="cb19-1395"><a href="#cb19-1395" aria-hidden="true" tabindex="-1"></a>    parser <span class="op">=</span> argparse.ArgumentParser(</span>
<span id="cb19-1396"><a href="#cb19-1396" aria-hidden="true" tabindex="-1"></a>        description<span class="op">=</span><span class="st">&quot;Processa exporta√ß√µes combinadas com exporta√ß√£o HTML via Pandoc.&quot;</span></span>
<span id="cb19-1397"><a href="#cb19-1397" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb19-1398"><a href="#cb19-1398" aria-hidden="true" tabindex="-1"></a>    parser.add_argument(<span class="st">&quot;--dry-run&quot;</span>, action<span class="op">=</span><span class="st">&quot;store_true&quot;</span>, <span class="bu">help</span><span class="op">=</span><span class="st">&quot;Executa sem salvar arquivos&quot;</span>)</span>
<span id="cb19-1399"><a href="#cb19-1399" aria-hidden="true" tabindex="-1"></a>    parser.add_argument(<span class="st">&quot;--force-overwrite&quot;</span>, action<span class="op">=</span><span class="st">&quot;store_true&quot;</span>, <span class="bu">help</span><span class="op">=</span><span class="st">&quot;Substitui arquivos existentes&quot;</span>)</span>
<span id="cb19-1400"><a href="#cb19-1400" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-1401"><a href="#cb19-1401" aria-hidden="true" tabindex="-1"></a>    args <span class="op">=</span> parser.parse_args()</span>
<span id="cb19-1402"><a href="#cb19-1402" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-1403"><a href="#cb19-1403" aria-hidden="true" tabindex="-1"></a>    system <span class="op">=</span> CombinedFragmentsSystem(</span>
<span id="cb19-1404"><a href="#cb19-1404" aria-hidden="true" tabindex="-1"></a>        dry_run<span class="op">=</span>args.dry_run,</span>
<span id="cb19-1405"><a href="#cb19-1405" aria-hidden="true" tabindex="-1"></a>        force_overwrite<span class="op">=</span>args.force_overwrite</span>
<span id="cb19-1406"><a href="#cb19-1406" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb19-1407"><a href="#cb19-1407" aria-hidden="true" tabindex="-1"></a>    system.run()</span>
<span id="cb19-1408"><a href="#cb19-1408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-1409"><a href="#cb19-1409" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&quot;__main__&quot;</span>:</span>
<span id="cb19-1410"><a href="#cb19-1410" aria-hidden="true" tabindex="-1"></a>    main()</span></code></pre></div>
<p>Agora o arquivo est√° <strong>completo</strong> com todos os m√©todos
necess√°rios! üöÄ</p>
<p><strong>Fluxo implementado:</strong> 1. <strong>ZIP ‚Üí
Processor</strong>: Extrai dados dos arquivos de exporta√ß√£o 2.
<strong>Processor ‚Üí Markdown</strong>: Gera arquivos MD com preserva√ß√£o
de formata√ß√£o<br />
3. <strong>Markdown ‚Üí HTML</strong>: Usa
<code>pandoc --standalone --mathjax</code> para convers√£o</p>
<p>Execute novamente:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> comb_fragments_system3_html_export.py <span class="at">--force-overwrite</span></span></code></pre></div>
<hr />
<h3 data-number="1.22.3" id="utilizador-2025-11-05-070749-deepseek-chat"><span class="header-section-number">1.22.3</span> üë§ Utilizador
<em>(2025-11-05 07:07:49)</em> <em>[deepseek-chat]</em></h3>
<p>üíæ Exportando para formatos‚Ä¶ ‚úÖ Markdown: 206 arquivos criados, 0
falhas em ‚Äòcombined_markdown‚Äô ‚úÖ Pandoc dispon√≠vel para convers√£o HTML
üîÑ Convertendo 564 arquivos Markdown para HTML com Pandoc‚Ä¶ ‚ùå Erro
inesperado no Pandoc para 001_ChatGPT_Editor .json visualiza√ß√£o.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 001_ChatGPT_Editor_.json_visualizacao.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
001_ChatGPT_Editor_.json_visualiza√ß√£o.md: unsupported operand type(s)
for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
002_ChatGPT_Comparar_convers√£o_MD_para_PDF.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
002_Qwen3_Sistema Combinado AI Chats.md: unsupported operand type(s) for
/: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
002_Qwen3_Sistema_Combinado_AI_Chats.md: unsupported operand type(s) for
/: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
003_ChatGPT_Exemplo.md_com_f√≥rmulas.md: unsupported operand type(s) for
/: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para 003_Qwen3_Python
Advanced File Explanation.md: unsupported operand type(s) for /: ‚Äòstr‚Äô
and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
003_Qwen3_Python_Advanced_File_Explanation.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
004_DeepSeek_Convert_HTML_to_PDF_with_Python_on_Windows.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
004_Qwen3_Converter Markdown PDF Windows Conda.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
004_Qwen3_Converter_Markdown_PDF_Windows_Conda.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
005_DeepSeek_Convert_Markdown_to_PDF_with_Pandoc_and_Python.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 005_Qwen3_Python Advanced Optimiza√ß√£o de Export Qwen.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 005_Qwen3_Python_Advanced_Optimizacao_de_Export_Qwen.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 006_ChatGPT_Integrar_fun√ß√£o_em_script.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
006_Qwen3_Convert MD to HTML and PDF.md: unsupported operand type(s) for
/: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
006_Qwen3_Convert_MD_to_HTML_and_PDF.md: unsupported operand type(s) for
/: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
007_Grok_github-pandoc.css_com_Pandoc._Tutorial.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
007_Qwen3_Dieta Saud√°vel para Pequeno-Almo√ßo.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
007_Qwen3_Dieta_Saudavel_para_Pequeno-Almoco.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
008_ChatGPT_Comparar convers√£o MD para PDF.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
008_ChatGPT_Comparar_conversao_MD_para_PDF.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
008_Grok_Git_Clone_SSL_Certificate_Error.md: unsupported operand type(s)
for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
009_ChatGPT_Exemplo.md com f√≥rmulas.md: unsupported operand type(s) for
/: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
009_ChatGPT_Exemplo.md_com_formulas.md: unsupported operand type(s) for
/: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
009_Grok_Verificar_pacotes_em_ambientes_Conda.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
010_DeepSeek_Convert HTML to PDF with Python on Windows.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
010_DeepSeek_Convert_HTML_to_PDF_with_Python_on_Windows.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
010_Grok_Selenium_Tutorial_for_Beginners_Portugues.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
011_DeepSeek_Convert Markdown to PDF with Pandoc and Python.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para
011_DeepSeek_Convert_Markdown_to_PDF_with_Pandoc_and_Python.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 011_Grok_Playwright_Tutorial_para_Iniciantes_Portugues.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 012_ChatGPT_Integrar fun√ß√£o em script.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
012_ChatGPT_Integrar_funcao_em_script.md: unsupported operand type(s)
for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
012_DeepSeek_Converter_md_contendo_emojis_para_pdf_(conda_windo.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para
013_DeepSeek_Convert_(msys2)<em>Markdown_with_Emojis_to_PDF.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 013_Grok_github-pandoc.css com Pandoc. Tutorial.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 013_Grok_github-pandoc.css_com_Pandoc._Tutorial.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 014_Grok_Git Clone SSL Certificate Error.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
014_Grok_Git_Clone_SSL_Certificate_Error.md: unsupported operand type(s)
for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
014_Grok_Troubleshooting_ModuleNotFoundError_in_Selenium.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
015_ChatGPT_Instalar_wkhtmltopdf_MSYS2.md: unsupported operand type(s)
for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
015_Grok_Verificar pacotes em ambientes Conda.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
015_Grok_Verificar_pacotes_em_ambientes_Conda.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
016_Grok_Instala√ß√£o_Playwright_no_MSYS2.md: unsupported operand type(s)
for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
016_Grok_Selenium Tutorial for Beginners Portugues.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
016_Grok_Selenium_Tutorial_for_Beginners_Portugues.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
017_Grok_Installing_Pandoc_on_MSYS2.md: unsupported operand type(s) for
/: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para 017_Grok_Playwright
Tutorial para Iniciantes Portugues.md: unsupported operand type(s) for
/: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
017_Grok_Playwright_Tutorial_para_Iniciantes_Portugues.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
018_ChatGPT_Converter_Markdown_para_PDF.md: unsupported operand type(s)
for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
018_DeepSeek_Converter md contendo emojis para pdf (conda.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para
018_DeepSeek_Converter_md_contendo_emojis_para_pdf</em>(conda_windo.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 019_DeepSeek_Convert (msys2) Markdown with Emojis to PDF.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 019_DeepSeek_Convert_(msys2)_Markdown_with_Emojis_to_PDF.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 019_DeepSeek_DeepSeek_Fragments_System_Code_Correction.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 020_DeepSeek_Convertendo_Markdown_com_Emojis_para_PDF.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 020_Grok_Troubleshooting ModuleNotFoundError in Selenium.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 020_Grok_Troubleshooting_ModuleNotFoundError_in_Selenium.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 021_ChatGPT_Instalar wkhtmltopdf MSYS2.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
021_ChatGPT_Instalar_wkhtmltopdf_MSYS2.md: unsupported operand type(s)
for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
021_Grok_Markdown_para_PDF_com_Emojis_Coloridos.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
022_Grok_Instalacao_Playwright_no_MSYS2.md: unsupported operand type(s)
for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
022_Grok_Instalando_Node.js_com_Chocolatey.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
022_Grok_Instala√ß√£o Playwright no MSYS2.md: unsupported operand type(s)
for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
023_DeepSeek_Cont5._Export_Grok.md: unsupported operand type(s) for /:
‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para 023_Grok_Installing
Pandoc on MSYS2.md: unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô
‚ùå Erro inesperado no Pandoc para
023_Grok_Installing_Pandoc_on_MSYS2.md: unsupported operand type(s) for
/: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
024_ChatGPT_Converter Markdown para PDF.md: unsupported operand type(s)
for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
024_ChatGPT_Converter_Markdown_para_PDF.md: unsupported operand type(s)
for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
024_DeepSeek_Cont4._Export_Grok.md: unsupported operand type(s) for /:
‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para 025_DeepSeek_DeepSeek
Fragments System Code Correction.md: unsupported operand type(s) for /:
‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
025_DeepSeek_DeepSeek_Fragments_System_Code_Correction.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
025_Grok_Convers√£o_PDF_para_Markdown_com_Pandoc.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
026_ChatGPT_Converter_md_para_pdf.md: unsupported operand type(s) for /:
‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
026_DeepSeek_Convertendo Markdown com Emojis para PDF.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
026_DeepSeek_Convertendo_Markdown_com_Emojis_para_PDF.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
027_ChatGPT_Markdown_com_emojis.md: unsupported operand type(s) for /:
‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para 027_Grok_Markdown para
PDF com Emojis Coloridos.md: unsupported operand type(s) for /: ‚Äòstr‚Äô
and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
027_Grok_Markdown_para_PDF_com_Emojis_Coloridos.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
028_DeepSeek_Cont3._Dashboard_Grok_para_exporta√ß√£o_de_conversas.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 028_Grok_Instalando Node.js com Chocolatey.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
028_Grok_Instalando_Node.js_com_Chocolatey.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
029_DeepSeek_Cont5. Export Grok.md: unsupported operand type(s) for /:
‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
029_DeepSeek_Cont5._Export_Grok.md: unsupported operand type(s) for /:
‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
029_DeepSeek_Continua√ß√£o_Export_Gork.md: unsupported operand type(s) for
/: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para 030_DeepSeek_Cont4.
Export Grok.md: unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå
Erro inesperado no Pandoc para 030_DeepSeek_Cont4._Export_Grok.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 030_DeepSeek_Exportando_hist√≥rico_do_Grok.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
031_Grok_Conversao_PDF_para_Markdown_com_Pandoc.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
031_Grok_Convers√£o PDF para Markdown com Pandoc.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
031_Grok_Linux_Process_Monitoring_com_VirusTotal.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
032_ChatGPT_Converter md para pdf.md: unsupported operand type(s) for /:
‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
032_ChatGPT_Converter_md_para_pdf.md: unsupported operand type(s) for /:
‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
032_DeepSeek_Exportar_hist√≥rico_do_DeepSeek_e_ChatGPT.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
033_ChatGPT_Download_hist√≥rico_autom√°tico.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
033_ChatGPT_Markdown com emojis.md: unsupported operand type(s) for /:
‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
033_ChatGPT_Markdown_com_emojis.md: unsupported operand type(s) for /:
‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para 034_DeepSeek_Cont3.
Dashboard Grok para exporta√ß√£o de conversas.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
034_DeepSeek_Cont3._Dashboard_Grok_para_exportacao_de_conversas.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 034_Grok_Exportando_Hist√≥rico_Grok_PDF_e_MD.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
035_ChatGPT_Erro_mamba_shell_n√£o_inicializado.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
035_DeepSeek_Continuacao_Export_Gork.md: unsupported operand type(s) for
/: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
035_DeepSeek_Continua√ß√£o Export Gork.md: unsupported operand type(s) for
/: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
036_DeepSeek_Exportando hist√≥rico do Grok.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
036_DeepSeek_Exportando_historico_do_Grok.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
036_Grok_Instalar_Ubuntu_Linux,_em_vez_do_windows.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
037_DeepSeek_Otimiza√ß√£o_de_configura√ß√£o_Mamba_no_Windows.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
037_Grok_Linux Process Monitoring com VirusTotal.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
037_Grok_Linux_Process_Monitoring_com_VirusTotal.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
038_DeepSeek_Exportar hist√≥rico do DeepSeek e ChatGPT.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
038_DeepSeek_Exportar_historico_do_DeepSeek_e_ChatGPT.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
038_Grok_APIs_Gratuitas_para_LLMs_em_Python.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
039_ChatGPT_Download hist√≥rico autom√°tico.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
039_ChatGPT_Download_historico_automatico.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
039_DeepSeek_Resolvendo_erro_de_pydantic_no_Miniconda.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
040_DeepSeek_Converter_Anaconda_para_Miniconda_no_Windows.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 040_Grok_Exportando Hist√≥rico Grok PDF e MD.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
040_Grok_Exportando_Historico_Grok_PDF_e_MD.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
041_ChatGPT_Erro mamba shell n√£o inicializado.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
041_ChatGPT_Erro_mamba_shell_nao_inicializado.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
041_Grok_Converter_Anaconda_para_Miniconda_no_Windows.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
042_Grok_Conda_vs_Virtualenv_Windows_Comparison.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
042_Grok_Instalar Ubuntu Linux, em vez do windows.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
042_Grok_Instalar_Ubuntu_Linux,_em_vez_do_windows.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
043_DeepSeek_Otimizacao_de_configuracao_Mamba_no_Windows.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
043_DeepSeek_Otimiza√ß√£o de configura√ß√£o Mamba no Windows.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
043_DeepSeek_Varias_quest√µes,<em>relacionadas_a_instala√ß√£o_no_cond.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para
044_DeepSeek_Corrigir_ambiente_CONDA_corrompido_passo_a_passo.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 044_Grok_APIs Gratuitas para LLMs em Python.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
044_Grok_APIs_Gratuitas_para_LLMs_em_Python.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
045_DeepSeek_Anaconda_Prompt_inicia_em_CWINDOWSsystem32.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
045_DeepSeek_Resolvendo erro de pydantic no Miniconda.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
045_DeepSeek_Resolvendo_erro_de_pydantic_no_Miniconda.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
046_ChatGPT_Problema_de_ativa√ß√£o_Windows.md: unsupported operand type(s)
for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
046_DeepSeek_Converter Anaconda para Miniconda no Windows.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para
046_DeepSeek_Converter_Anaconda_para_Miniconda_no_Windows.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 047_ChatGPT_Copia_e_redu√ß√£o_conda.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
047_Grok_Converter Anaconda para Miniconda no Windows.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
047_Grok_Converter_Anaconda_para_Miniconda_no_Windows.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
048_ChatGPT_Optimizar_conda_con_mamba.md: unsupported operand type(s)
for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para 048_Grok_Conda
vs Virtualenv Windows Comparison.md: unsupported operand type(s) for /:
‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
048_Grok_Conda_vs_Virtualenv_Windows_Comparison.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
049_DeepSeek_Varias quest√µes, relacionadas a instala√ß√£o no.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para
049_DeepSeek_Varias_questoes,<em>relacionadas_a_instalacao_no_cond.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 049_Grok_Conda_Environment_Inconsistency_Fixes.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 050_DeepSeek_Corrigir ambiente CONDA corrompido passo a
passo.md: unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro
inesperado no Pandoc para
050_DeepSeek_Corrigir_ambiente_CONDA_corrompido_passo_a_passo.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para
050_DeepSeek_Otimiza√ß√£o_de</em>.condarc_para_maior_velocidade.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 051_DeepSeek_Anaconda Prompt inicia em CWINDOWSsystem32.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 051_DeepSeek_Anaconda_Prompt_inicia_em_CWINDOWSsystem32.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 051_DeepSeek_Killing_Python_Processes_in_Windows_CMD.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 052_ChatGPT_Problema de ativa√ß√£o Windows.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
052_ChatGPT_Problema_de_ativacao_Windows.md: unsupported operand type(s)
for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
052_DeepSeek_Anaconda_Environment_Health_and_Repair_Report.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 053_ChatGPT_Copia e redu√ß√£o conda.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
053_ChatGPT_Copia_e_reducao_conda.md: unsupported operand type(s) for /:
‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
053_Grok_Listar_pacotes_Conda_por_tamanho.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
054_ChatGPT_Optimizar conda con mamba.md: unsupported operand type(s)
for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
054_ChatGPT_Optimizar_conda_con_mamba.md: unsupported operand type(s)
for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
054_DeepSeek_Soluci√≥n_de_problema_de_conda-libmamba-solver.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 055_DeepSeek_Medir_tempo_de_execu√ß√£o_de_comandos_Conda.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 055_Grok_Conda Environment Inconsistency Fixes.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 055_Grok_Conda_Environment_Inconsistency_Fixes.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para
056_DeepSeek_Otimizacao_de</em>.condarc_para_maior_velocidade.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 056_DeepSeek_Otimiza√ß√£o de .condarc para maior
velocidade.md: unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå
Erro inesperado no Pandoc para
056_Grok_Conda_Installation_Errors_and_Fixes.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
057_DeepSeek_Killing Python Processes in Windows CMD.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
057_DeepSeek_Killing_Python_Processes_in_Windows_CMD.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
057_Grok_Corrigir_Anaconda_Prompt_no_Windows.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
058_ChatGPT_Otimizar_Conda_no_Windows.md: unsupported operand type(s)
for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
058_DeepSeek_Anaconda Environment Health and Repair Report.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para
058_DeepSeek_Anaconda_Environment_Health_and_Repair_Report.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 059_Grok_Listar pacotes Conda por tamanho.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
059_Grok_Listar_pacotes_Conda_por_tamanho.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
059_Grok_SIC_Jornal_da_Noite_vs._RTP_Telejornal.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
060_DeepSeek_Solucion_de_problema_de_conda-libmamba-solver.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 060_DeepSeek_Soluci√≥n de problema de
conda-libmamba-solver.md: unsupported operand type(s) for /: ‚Äòstr‚Äô and
‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
060_Grok_Desinstalar_ou_Desativar_CCleaner_7.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
061_DeepSeek_Medir tempo de execu√ß√£o de comandos Conda.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
061_DeepSeek_Medir_tempo_de_execucao_de_comandos_Conda.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
061_Grok_Resolving_Anaconda_Installation_Permission_Error.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 062_Grok_Conda Installation Errors and Fixes.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
062_Grok_Conda_Installation_Errors_and_Fixes.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
062_Grok_Usando_Emojis_no_MSYS2_MinTTY.md: unsupported operand type(s)
for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
063_ChatGPT_Usar_emojis_no_MSYS2.md: unsupported operand type(s) for /:
‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para 063_Grok_Corrigir
Anaconda Prompt no Windows.md: unsupported operand type(s) for /: ‚Äòstr‚Äô
and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
063_Grok_Corrigir_Anaconda_Prompt_no_Windows.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
064_ChatGPT_Corrigir_erro_curl_msys2.md: unsupported operand type(s) for
/: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
064_ChatGPT_Otimizar Conda no Windows.md: unsupported operand type(s)
for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
064_ChatGPT_Otimizar_Conda_no_Windows.md: unsupported operand type(s)
for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
065_Grok_Corrigindo_Erro_SSL_no_MSYS2_Curl.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
065_Grok_SIC Jornal da Noite vs.¬†RTP Telejornal.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
065_Grok_SIC_Jornal_da_Noite_vs._RTP_Telejornal.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
066_DeepSeek_Corrigir_erro_SSL_no_MSYS2.md: unsupported operand type(s)
for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
066_Grok_Desinstalar ou Desativar CCleaner 7.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
066_Grok_Desinstalar_ou_Desativar_CCleaner_7.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
067_DeepSeek_Como_usar_emojis_no_MSYS2.md: unsupported operand type(s)
for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
067_Grok_Resolving Anaconda Installation Permission Error.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para
067_Grok_Resolving_Anaconda_Installation_Permission_Error.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 068_Grok_Melhores_IDEs_para_Python_em_2025.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
068_Grok_Usando Emojis no MSYS2 MinTTY.md: unsupported operand type(s)
for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
068_Grok_Usando_Emojis_no_MSYS2_MinTTY.md: unsupported operand type(s)
for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
069_ChatGPT_Usar emojis no MSYS2.md: unsupported operand type(s) for /:
‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
069_ChatGPT_Usar_emojis_no_MSYS2.md: unsupported operand type(s) for /:
‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
069_Grok_Compara√ß√£o_de_Resinas_Ep√≥xi_Tipos_e_Usos.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
070_ChatGPT_Corrigir erro curl msys2.md: unsupported operand type(s) for
/: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
070_ChatGPT_Corrigir_erro_curl_msys2.md: unsupported operand type(s) for
/: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
070_Grok_Alimentos_para_Sa√∫de_Card√≠aca.md: unsupported operand type(s)
for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
071_Grok_Corrigindo Erro SSL no MSYS2 Curl.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
071_Grok_Corrigindo_Erro_SSL_no_MSYS2_Curl.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
071_Grok_Verificando_Pacotes_no_MSYS2.md: unsupported operand type(s)
for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
072_DeepSeek_Corrigir erro SSL no MSYS2.md: unsupported operand type(s)
for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
072_DeepSeek_Corrigir_erro_SSL_no_MSYS2.md: unsupported operand type(s)
for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
072_Grok_Noto_Color_Emoji_Windows_10_Compatibilidade.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
073_DeepSeek_Como usar emojis no MSYS2.md: unsupported operand type(s)
for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
073_DeepSeek_Como_usar_emojis_no_MSYS2.md: unsupported operand type(s)
for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
073_DeepSeek_Remover_fontes_corrompidas_no_Windows_10.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
074_Grok_Corrigir_Prompt_Conda_no_PowerShell.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
074_Grok_Melhores IDEs para Python em 2025.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
074_Grok_Melhores_IDEs_para_Python_em_2025.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
075_Grok_Comparacao_de_Resinas_Epoxi_Tipos_e_Usos.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
075_Grok_Compara√ß√£o de Resinas Ep√≥xi Tipos e Usos.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
075_Grok_Usando_Emojis_no_MSYS2_Mintty.md: unsupported operand type(s)
for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
076_DeepSeek_Guia_Nutricional_de_Queijo_em_Portugal.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
076_Grok_Alimentos para Sa√∫de Card√≠aca.md: unsupported operand type(s)
for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
076_Grok_Alimentos_para_Saude_Cardiaca.md: unsupported operand type(s)
for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
077_ChatGPT_Queijo_e_colesterol_di√°rio.md: unsupported operand type(s)
for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
077_Grok_Verificando Pacotes no MSYS2.md: unsupported operand type(s)
for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
077_Grok_Verificando_Pacotes_no_MSYS2.md: unsupported operand type(s)
for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
078_ChatGPT_Supl._preven√ß√£o_cardiodiabetes..md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
078_Grok_Noto Color Emoji Windows 10 Compatibilidade.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
078_Grok_Noto_Color_Emoji_Windows_10_Compatibilidade.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
079_DeepSeek_Remover fontes corrompidas no Windows 10.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
079_DeepSeek_Remover_fontes_corrompidas_no_Windows_10.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
079_Grok_Queijos_Portugueses_Variedades,_Nutrientes,_Consum.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 080_DeepSeek_Treatment_of_Sudden_Hearing_Loss_Overview.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 080_Grok_Corrigir Prompt Conda no PowerShell.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
080_Grok_Corrigir_Prompt_Conda_no_PowerShell.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
081_DeepSeek_Converter_md_para_pdf_com_emojis.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
081_Grok_Usando Emojis no MSYS2 Mintty.md: unsupported operand type(s)
for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
081_Grok_Usando_Emojis_no_MSYS2_Mintty.md: unsupported operand type(s)
for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
082_ChatGPT_High_protein_diets.md: unsupported operand type(s) for /:
‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para 082_DeepSeek_Guia
Nutricional de Queijo em Portugal.md: unsupported operand type(s) for /:
‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
082_DeepSeek_Guia_Nutricional_de_Queijo_em_Portugal.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
083_ChatGPT_Queijo e colesterol di√°rio.md: unsupported operand type(s)
for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
083_ChatGPT_Queijo_e_colesterol_diario.md: unsupported operand type(s)
for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
083_Grok_MSYS2_Markdown_to_PDF_with_Emojis.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
084_ChatGPT_Avisos_LaTeX_no_Pandoc.md: unsupported operand type(s) for
/: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para 084_ChatGPT_Supl.
preven√ß√£o cardiodiabetes..md: unsupported operand type(s) for /: ‚Äòstr‚Äô
and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
084_ChatGPT_Supl._prevencao_cardiodiabetes..md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
085_Grok_Queijos Portugueses Variedades, Nutrientes,.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
085_Grok_Queijos_Portugueses_Variedades,_Nutrientes,_Consum.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 085_Grok_√âpoca_ideal_para_enxertar_laranjeira.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 086_DeepSeek_Treatment of Sudden Hearing Loss Overview.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 086_DeepSeek_Treatment_of_Sudden_Hearing_Loss_Overview.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 086_Grok_Temperatura_ideal_para_pesca_do_l√∫cio-perca.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 087_DeepSeek_Converter md para pdf com emojis.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 087_DeepSeek_Converter_md_para_pdf_com_emojis.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 087_DeepSeek_Guia_de_Congelamento_de_Pescados.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 088_ChatGPT_High protein diets.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
088_ChatGPT_High_protein_diets.md: unsupported operand type(s) for /:
‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
088_DeepSeek_Como_congelar_alimentos_pr√≥s_e_contras.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
089_Grok_Converting_Markdown_to_PDF_with_Emojis.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
089_Grok_MSYS2 Markdown to PDF with Emojis.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
089_Grok_MSYS2_Markdown_to_PDF_with_Emojis.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
090_ChatGPT_Avisos LaTeX no Pandoc.md: unsupported operand type(s) for
/: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
090_ChatGPT_Avisos_LaTeX_no_Pandoc.md: unsupported operand type(s) for
/: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
090_DeepSeek_Guia_de_Congelamento_de_Alimentos_Completo.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
091_DeepSeek_Converting_Markdown_to_PDF_with_Emojis.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
091_Grok_Epoca_ideal_para_enxertar_laranjeira.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
091_Grok_√âpoca ideal para enxertar laranjeira.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
092_DeepSeek_Corrigir_conflito_de_atualiza√ß√µes_MiKTeX_Windows.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 092_Grok_Temperatura ideal para pesca do l√∫cio-perca.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 092_Grok_Temperatura_ideal_para_pesca_do_lucio-perca.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 093_DeepSeek_Convertendo_Markdown_para_PDF_com_Pandoc.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 093_DeepSeek_Guia de Congelamento de Pescados.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 093_DeepSeek_Guia_de_Congelamento_de_Pescados.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 094_ChatGPT_Converter_emojis_para_PDF.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
094_DeepSeek_Como congelar alimentos pr√≥s e contras.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
094_DeepSeek_Como_congelar_alimentos_pros_e_contras.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
095_ChatGPT_Converter_md_para_pdf.md: unsupported operand type(s) for /:
‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para 095_Grok_Converting
Markdown to PDF with Emojis.md: unsupported operand type(s) for /: ‚Äòstr‚Äô
and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
095_Grok_Converting_Markdown_to_PDF_with_Emojis.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
096_DeepSeek_Guia de Congelamento de Alimentos Completo.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
096_DeepSeek_Guia_de_Congelamento_de_Alimentos_Completo.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
096_Grok_Markdown_to_PDF_Conversion_with_LuaLaTeX.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
097_DeepSeek_Converting Markdown to PDF with Emojis.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
097_DeepSeek_Converting_Markdown_to_PDF_with_Emojis.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
097_Grok_Pandoc_e_NotoColorEmoji_no_MSYS2.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
098_DeepSeek_Corrigir conflito de atualiza√ß√µes MiKTeX Windows.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para
098_DeepSeek_Corrigir_conflito_de_atualizacoes_MiKTeX_Windows.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 098_Grok_Converting_MD_to_PDF_with_Colored_Emojis.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 099_DeepSeek_Convertendo Markdown para PDF com Pandoc.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 099_DeepSeek_Convertendo_Markdown_para_PDF_com_Pandoc.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 099_Grok_Convers√£o_NotoColorEmoji_para_Windows_10.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 100_ChatGPT_Converter emojis para PDF.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
100_ChatGPT_Converter_emojis_para_PDF.md: unsupported operand type(s)
for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
100_DeepSeek_Resolving_Potrace_PNG_Format_Errors.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
101_ChatGPT_An√°lise_de_resultados_2025.md: unsupported operand type(s)
for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
101_ChatGPT_Converter md para pdf.md: unsupported operand type(s) for /:
‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
101_ChatGPT_Converter_md_para_pdf.md: unsupported operand type(s) for /:
‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
102_DeepSeek_Download_e_converter_Noto_Color_Emoji_para_Windows.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 102_Grok_Markdown to PDF Conversion with LuaLaTeX.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 102_Grok_Markdown_to_PDF_Conversion_with_LuaLaTeX.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 103_ChatGPT_Converter_NotoColorEmoji_TTF.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
103_Grok_Pandoc e NotoColorEmoji no MSYS2.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
103_Grok_Pandoc_e_NotoColorEmoji_no_MSYS2.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
104_ChatGPT_Limpar_no_Windows_10,_conda,_msys2,_choco.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
104_Grok_Converting MD to PDF with Colored Emojis.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
104_Grok_Converting_MD_to_PDF_with_Colored_Emojis.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
105_ChatGPT_Silicone_ideal_para_fita_LED.md: unsupported operand type(s)
for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
105_Grok_Conversao_NotoColorEmoji_para_Windows_10.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
105_Grok_Convers√£o NotoColorEmoji para Windows 10.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
106_DeepSeek_Resolving Potrace PNG Format Errors.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
106_DeepSeek_Resolving_Potrace_PNG_Format_Errors.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
106_Grok_Convers√£o_de_Fonte_Noto_Emoji_para_Windows.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
107_ChatGPT_Analise_de_resultados_2025.md: unsupported operand type(s)
for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
107_ChatGPT_An√°lise de resultados 2025.md: unsupported operand type(s)
for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
107_Grok_Teste_PYTHON,_exemplo_simples.md: unsupported operand type(s)
for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
108_DeepSeek_Download e converter Noto Color Emoji para Windows.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para
108_DeepSeek_Download_e_converter_Noto_Color_Emoji_para_Windows.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 108_DeepSeek_Instala√ß√£o_e_uso_do_emoji-builder_em_Python.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 109_ChatGPT_Converter NotoColorEmoji TTF.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
109_ChatGPT_Converter_NotoColorEmoji_TTF.md: unsupported operand type(s)
for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
109_Grok_Anaconda_Update_Solving_Environment_Issues.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
110_ChatGPT_Limpar no Windows 10, conda, msys2, choco.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
110_ChatGPT_Limpar_no_Windows_10,_conda,_msys2,_choco.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
110_Grok_Update_menuinst_for_Jupyter_Notebook.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
111_ChatGPT_Silicone ideal para fita LED.md: unsupported operand type(s)
for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
111_ChatGPT_Silicone_ideal_para_fita_LED.md: unsupported operand type(s)
for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
111_Grok_Abrir_Arquivos_Markdown_no_Windows.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
112_Grok_Conversao_de_Fonte_Noto_Emoji_para_Windows.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
112_Grok_Convers√£o de Fonte Noto Emoji para Windows.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
112_Grok_Windows_10_Support_Ends_2025.md: unsupported operand type(s)
for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
113_DeepSeek_Como_usar_emoji-builder_no_MSYS2.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
113_Grok_Teste PYTHON, exemplo simples.md: unsupported operand type(s)
for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
113_Grok_Teste_PYTHON,_exemplo_simples.md: unsupported operand type(s)
for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
114_ChatGPT_Instalar_Noto_Color_Emoji.md: unsupported operand type(s)
for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
114_DeepSeek_Instalacao_e_uso_do_emoji-builder_em_Python.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
114_DeepSeek_Instala√ß√£o e uso do emoji-builder em Python.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
115_Grok_Anaconda Update Solving Environment Issues.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
115_Grok_Anaconda_Update_Solving_Environment_Issues.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
115_Grok_Usar_entornos_virtuales_Python_en_MSYS2.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
116_Grok_Silicone_Soudal_Ideal_para_Fitas_LED.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
116_Grok_Update menuinst for Jupyter Notebook.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
116_Grok_Update_menuinst_for_Jupyter_Notebook.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
117_ChatGPT_Usar_Pandoc_no_MSYS2.md: unsupported operand type(s) for /:
‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para 117_Grok_Abrir
Arquivos Markdown no Windows.md: unsupported operand type(s) for /:
‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
117_Grok_Abrir_Arquivos_Markdown_no_Windows.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
118_DeepSeek_Instalar_Pandoc_en_Windows_con_Chocolatey.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
118_Grok_Windows 10 Support Ends 2025.md: unsupported operand type(s)
for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
118_Grok_Windows_10_Support_Ends_2025.md: unsupported operand type(s)
for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
119_DeepSeek_Como usar emoji-builder no MSYS2.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
119_DeepSeek_Como_usar_emoji-builder_no_MSYS2.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
119_DeepSeek_Grok_API_n√£o_dispon√≠vel_gratuitamente.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
120_ChatGPT_Instalar Noto Color Emoji.md: unsupported operand type(s)
for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
120_ChatGPT_Instalar_Noto_Color_Emoji.md: unsupported operand type(s)
for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
120_ChatGPT_Usar_Noto_Emoji_Pandoc.md: unsupported operand type(s) for
/: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
121_ChatGPT_Colar_fita_LED_220V.md: unsupported operand type(s) for /:
‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para 121_Grok_Usar entornos
virtuales Python en MSYS2.md: unsupported operand type(s) for /: ‚Äòstr‚Äô
and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
121_Grok_Usar_entornos_virtuales_Python_en_MSYS2.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
122_Grok_Instalando_Pandoc_no_Windows_com_Chocolatey.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
122_Grok_Silicone Soudal Ideal para Fitas LED.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
122_Grok_Silicone_Soudal_Ideal_para_Fitas_LED.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
123_ChatGPT_Usar Pandoc no MSYS2.md: unsupported operand type(s) for /:
‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
123_ChatGPT_Usar_Pandoc_no_MSYS2.md: unsupported operand type(s) for /:
‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
123_DeepSeek_Compara√ß√£o_entre_Ginkgo_Biloba_e_Betaistina.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
124_DeepSeek_Gen√©ricos_de_Diclofenac_mais_baratos_em_Portugal.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 124_DeepSeek_Instalar Pandoc en Windows con Chocolatey.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 124_DeepSeek_Instalar_Pandoc_en_Windows_con_Chocolatey.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 125_ChatGPT_Compara√ß√£o_ginkgo_biloba_beta-histina.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 125_DeepSeek_Grok API n√£o dispon√≠vel gratuitamente.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 125_DeepSeek_Grok_API_nao_disponivel_gratuitamente.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 126_ChatGPT_Usar Noto Emoji Pandoc.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
126_ChatGPT_Usar_Noto_Emoji_Pandoc.md: unsupported operand type(s) for
/: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
126_DeepSeek_Como_resetar_c√¢mera_TP-Link_Tapo_C310.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
127_ChatGPT_Colar fita LED 220V.md: unsupported operand type(s) for /:
‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
127_ChatGPT_Colar_fita_LED_220V.md: unsupported operand type(s) for /:
‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
127_ChatGPT_Significado_de_quebranto.md: unsupported operand type(s) for
/: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
128_DeepSeek_Como_resetar_c√¢mera_TP-Link_Tapo_C210.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
128_Grok_Instalando Pandoc no Windows com Chocolatey.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
128_Grok_Instalando_Pandoc_no_Windows_com_Chocolatey.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
129_ChatGPT_Reconfigurar_Tapo_C310.md: unsupported operand type(s) for
/: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
129_DeepSeek_Comparacao_entre_Ginkgo_Biloba_e_Betaistina.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
129_DeepSeek_Compara√ß√£o entre Ginkgo Biloba e Betaistina.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
130_ChatGPT_Antena_repetidora_passiva.md: unsupported operand type(s)
for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
130_DeepSeek_Genericos_de_Diclofenac_mais_baratos_em_Portugal.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 130_DeepSeek_Gen√©ricos de Diclofenac mais baratos em
Portugal.md: unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro
inesperado no Pandoc para
131_ChatGPT_Comparacao_ginkgo_biloba_beta-histina.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
131_ChatGPT_Compara√ß√£o ginkgo biloba beta-histina.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
131_ChatGPT_Op√ß√£o_gratuita_API_ChatGPT.md: unsupported operand type(s)
for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
132_ChatGPT_Autocolante_proibido_estacionamento.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
132_DeepSeek_Como resetar c√¢mera TP-Link Tapo C310.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
132_DeepSeek_Como_resetar_camera_TP-Link_Tapo_C310.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
133_ChatGPT_Significado de quebranto.md: unsupported operand type(s) for
/: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
133_ChatGPT_Significado_de_quebranto.md: unsupported operand type(s) for
/: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
133_DeepSeek_Uso_de_√°gua_na_Sikagard_570.md: unsupported operand type(s)
for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
134_ChatGPT_Custo_hora_advogado_Portugal.md: unsupported operand type(s)
for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
134_DeepSeek_Como resetar c√¢mera TP-Link Tapo C210.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
134_DeepSeek_Como_resetar_camera_TP-Link_Tapo_C210.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
135_ChatGPT_Mudar_de_Centro_Sa√∫de.md: unsupported operand type(s) for /:
‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
135_ChatGPT_Reconfigurar Tapo C310.md: unsupported operand type(s) for
/: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
135_ChatGPT_Reconfigurar_Tapo_C310.md: unsupported operand type(s) for
/: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para 136_ChatGPT_Antena
repetidora passiva.md: unsupported operand type(s) for /: ‚Äòstr‚Äô and
‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
136_ChatGPT_Antena_repetidora_passiva.md: unsupported operand type(s)
for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
136_DeepSeek_Proje√ß√£o_de_elei√ß√µes_legislativas_em_Portugal.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 137_ChatGPT_Elei√ß√µes_2025_em_Portugal.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
137_ChatGPT_Opcao_gratuita_API_ChatGPT.md: unsupported operand type(s)
for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
137_ChatGPT_Op√ß√£o gratuita API ChatGPT.md: unsupported operand type(s)
for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
138_ChatGPT_Autocolante proibido estacionamento.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
138_ChatGPT_Autocolante_proibido_estacionamento.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
138_DeepSeek_Causas_prov√°veis_de_corte_de_energia_em_Portugal.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 139_DeepSeek_Compara√ß√£o_de_pneus_Continental_e_Michelin.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 139_DeepSeek_Uso de √°gua na Sikagard 570.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
139_DeepSeek_Uso_de_agua_na_Sikagard_570.md: unsupported operand type(s)
for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
140_ChatGPT_Custo hora advogado Portugal.md: unsupported operand type(s)
for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
140_ChatGPT_Custo_hora_advogado_Portugal.md: unsupported operand type(s)
for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
140_DeepSeek_Pr√≥ximos_passos_na_guerra_comercial_EUA-China.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 141_ChatGPT_Mudar de Centro Sa√∫de.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
141_ChatGPT_Mudar_de_Centro_Saude.md: unsupported operand type(s) for /:
‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
141_DeepSeek_Terapia_de_Luz_Vermelha_Como_Usar_e_Benef√≠cios.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para
142_DeepSeek_Melhor_produto_natural_para_baixar_tens√£o_arterial.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para
142_DeepSeek_Projecao_de_eleicoes_legislativas_em_Portugal.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 142_DeepSeek_Proje√ß√£o de elei√ß√µes legislativas em
Portugal.md: unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro
inesperado no Pandoc para 143_ChatGPT_Eleicoes_2025_em_Portugal.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 143_ChatGPT_Elei√ß√µes 2025 em Portugal.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
143_DeepSeek_Preven√ß√£o_de_AVC_Medidas_de_longo_prazo.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
144_DeepSeek_Causas prov√°veis de corte de energia em Portugal.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para
144_DeepSeek_Causas_provaveis_de_corte_de_energia_em_Portugal.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 144_DeepSeek_Evolu√ß√£o_da_tens√£o_arterial_ao_longo_do_dia.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 145_DeepSeek_Comparacao_de_pneus_Continental_e_Michelin.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 145_DeepSeek_Compara√ß√£o de pneus Continental e Michelin.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para
145_DeepSeek_Perspectivas_futuras_dos_autom√≥veis_el√©tricos_em_P.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 146_DeepSeek_Problemas_dos_ve√≠culos_el√©tricos_observados.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para
146_DeepSeek_Proximos_passos_na_guerra_comercial_EUA-China.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 146_DeepSeek_Pr√≥ximos passos na guerra comercial
EUA-China.md: unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro
inesperado no Pandoc para
147_DeepSeek_BYD_ATTO_2__pre√ßo_e_caracteristicas_em_portugal.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 147_DeepSeek_Terapia de Luz Vermelha Como Usar e
Benef√≠cios.md: unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå
Erro inesperado no Pandoc para
147_DeepSeek_Terapia_de_Luz_Vermelha_Como_Usar_e_Beneficios.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para
148_DeepSeek_COMPARA√á√ÉO_entre_o_MG_MG4,_Citro√´n_√´-C3__e_o_Peuge.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 148_DeepSeek_Melhor produto natural para baixar tens√£o
arterial.md: unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro
inesperado no Pandoc para
148_DeepSeek_Melhor_produto_natural_para_baixar_tensao_arterial.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 149_DeepSeek_Prevencao_de_AVC_Medidas_de_longo_prazo.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 149_DeepSeek_Preven√ß√£o de AVC Medidas de longo prazo.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para
149_DeepSeek_Tabela_com_compara√ß√£o_dos_pre√ßos_e_caracteristicas.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 150_DeepSeek_Evolucao_da_tensao_arterial_ao_longo_do_dia.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 150_DeepSeek_Evolu√ß√£o da tens√£o arterial ao longo do dia.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para
150_DeepSeek_Tabela_com_pre√ßos_de_automoveis_plug-in_mais_barat.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 151_DeepSeek_Perspectivas futuras dos autom√≥veis el√©tricos
em.md: unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro
inesperado no Pandoc para
151_DeepSeek_Perspectivas_futuras_dos_automoveis_eletricos_em_P.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 151_DeepSeek_Que_automoveis_a_gasolina,_que_n.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 152_DeepSeek_carros_a_diesel_novos_em_Portuga.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 152_DeepSeek_Problemas dos ve√≠culos el√©tricos observados.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 152_DeepSeek_Problemas_dos_veiculos_eletricos_observados.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 153_DeepSeek_BYD ATTO 2 pre√ßo e caracteristicas em
portugal.md: unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro
inesperado no Pandoc para
153_DeepSeek_BYD_ATTO_2_preco_e_caracteristicas_em_portugal.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 153_DeepSeek_existe_fiat_500_a_diesel.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
154_DeepSeek_COMPARACAO_entre_o_MG_MG4,_Citroen_e-C3_e_o_Peugeo.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 154_DeepSeek_COMPARA√á√ÉO entre o MG MG4, Citro√´n √´-C3 e o.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 155_DeepSeek_Tabela com compara√ß√£o dos pre√ßos e.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para
155_DeepSeek_Tabela_com_comparacao_dos_precos_e_caracteristicas.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 156_DeepSeek_Tabela com pre√ßos de automoveis plug-in
mais.md: unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro
inesperado no Pandoc para
156_DeepSeek_Tabela_com_precos_de_automoveis_plug-in_mais_barat.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 157_DeepSeek_Que automoveis a gasolina, que n.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 157_DeepSeek_Que_automoveis_a_gasolina,<em>que_n.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 158_DeepSeek_carros a diesel novos em Portuga.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 158_DeepSeek_carros_a_diesel_novos_em_Portuga.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 159_DeepSeek_existe fiat 500 a diesel.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
159_DeepSeek_existe_fiat_500_a_diesel.md: unsupported operand type(s)
for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
160_DeepSeek_fiat 500 el√©ctrico.md: unsupported operand type(s) for /:
‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
160_DeepSeek_fiat_500_electrico.md: unsupported operand type(s) for /:
‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para 161_DeepSeek_Tabela
com compara√ß√£o dos pre√ßos.md: unsupported operand type(s) for /: ‚Äòstr‚Äô
and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
161_DeepSeek_Tabela_com_comparacao_dos_precos.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
162_DeepSeek_Yandex Browser vs firefox.md: unsupported operand type(s)
for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
162_DeepSeek_Yandex_Browser_vs_firefox.md: unsupported operand type(s)
for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
163_DeepSeek_Que automoveis a diesel que n√£o apresentam.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
163_DeepSeek_Que_automoveis_a_diesel_que_nao_apresentam_problem.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 164_DeepSeek_existe algum bloqueio internet r.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 164_DeepSeek_existe_algum_bloqueio_internet_r.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 165_DeepSeek_existe algum bloqueio internet r.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 165_DeepSeek_existe_algum_bloqueio_internet_r.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 166_DeepSeek_Quais os automoveis plug-in mais.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 166_DeepSeek_Quais_os_automoveis_plug-in_mais.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 167_Qwen3_Automoveis_Diesel_Fiaveis_em_Portugal.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 167_Qwen3_Autom√≥veis Diesel Fi√°veis em Portugal.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 168_DeepSeek_Que outros modelos e marcas de a.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 168_DeepSeek_Que_outros_modelos_e_marcas_de_a.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 169_DeepSeek_Quais s√£o os modelos e marcas d.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
169_DeepSeek_Quais_sao_os_modelos_e_marcas_d.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
170_Qwen3_Perguntas em Portugu√™s.md: unsupported operand type(s) for /:
‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
170_Qwen3_Perguntas_em_Portugues.md: unsupported operand type(s) for /:
‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para 171_DeepSeek_quais as
vantagens dos automovei.md: unsupported operand type(s) for /: ‚Äòstr‚Äô and
‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
171_DeepSeek_quais_as_vantagens_dos_automovei.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
172_DeepSeek_cervical cancer in vaccinated women following HPV.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para
172_DeepSeek_cervical_cancer_in_vaccinated_women_following_HPV.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 173_DeepSeek_citroen c3 aircross diesel vs peugeot 2008
diesel.md: unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro
inesperado no Pandoc para
173_DeepSeek_citroen_c3_aircross_diesel_vs_peugeot_2008_diesel.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 174_DeepSeek_Teste1.md: unsupported operand type(s) for /:
‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
175_ChatGPT_Necessidade de √°gua Arbequina.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
175_ChatGPT_Necessidade_de_agua_Arbequina.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
176_ChatGPT_Galega vs Arbequina.md: unsupported operand type(s) for /:
‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
176_ChatGPT_Galega_vs_Arbequina.md: unsupported operand type(s) for /:
‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para 177_ChatGPT_Pesca em
Barragens Temperatura da √Ågua.md: unsupported operand type(s) for /:
‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
177_ChatGPT_Pesca_em_Barragens_Temperatura_da_Agua.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
178_ChatGPT_Albufeira L√™ntica ou L√≥tica.md: unsupported operand type(s)
for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
178_ChatGPT_Albufeira_Lentica_ou_Lotica.md: unsupported operand type(s)
for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
179_ChatGPT_Resistencia_do_Fio_Nylon.md: unsupported operand type(s) for
/: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
179_ChatGPT_Resist√™ncia do Fio Nylon.md: unsupported operand type(s) for
/: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
180_ChatGPT_Crescimento da Lucioperca.md: unsupported operand type(s)
for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
180_ChatGPT_Crescimento_da_Lucioperca.md: unsupported operand type(s)
for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
181_ChatGPT_Estimativa de flutuadores de rede.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
181_ChatGPT_Estimativa_de_flutuadores_de_rede.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
182_ChatGPT_Peso da rede na √°gua..md: unsupported operand type(s) for /:
‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
182_ChatGPT_Peso_da_rede_na_agua..md: unsupported operand type(s) for /:
‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
183_ChatGPT_Flutuadores para redes de pesca.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
183_ChatGPT_Flutuadores_para_redes_de_pesca.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
184_ChatGPT_Surdez s√∫bita e mastoidite.md: unsupported operand type(s)
for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
184_ChatGPT_Surdez_subita_e_mastoidite.md: unsupported operand type(s)
for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
185_ChatGPT_Redes de emalhar conceitos fundamentais.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
185_ChatGPT_Redes_de_emalhar_conceitos_fundamentais.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
186_ChatGPT_Coeficiente Baranov k Lucioperca.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
186_ChatGPT_Coeficiente_Baranov_k_Lucioperca.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
187_ChatGPT_Colete Salva-Vidas Obligat√≥rio.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
187_ChatGPT_Colete_Salva-Vidas_Obligatorio.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
188_ChatGPT_SOHL Treatment Options.md: unsupported operand type(s) for
/: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
188_ChatGPT_SOHL_Treatment_Options.md: unsupported operand type(s) for
/: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para 189_ChatGPT_Surdez
S√∫bita Tratamento Ginko..md: unsupported operand type(s) for /: ‚Äòstr‚Äô
and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
189_ChatGPT_Surdez_Subita_Tratamento_Ginko..md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
190_ChatGPT_URDEZ TRATAMENTO GINKO BAILOBA.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
190_ChatGPT_URDEZ_TRATAMENTO_GINKO_BAILOBA.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
191_ChatGPT_Surdez S√∫bita e AVC.md: unsupported operand type(s) for /:
‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
191_ChatGPT_Surdez_Subita_e_AVC.md: unsupported operand type(s) for /:
‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para 192_ChatGPT_Ginkgo
Biloba Dosagem Segura.md: unsupported operand type(s) for /: ‚Äòstr‚Äô and
‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
192_ChatGPT_Ginkgo_Biloba_Dosagem_Segura.md: unsupported operand type(s)
for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
193_ChatGPT_Florigkel and otosclerosis..md: unsupported operand type(s)
for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
193_ChatGPT_Florigkel_and_otosclerosis..md: unsupported operand type(s)
for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
194_ChatGPT_Tohatsu MFS6DSS Overview.md: unsupported operand type(s) for
/: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
194_ChatGPT_Tohatsu_MFS6DSS_Overview.md: unsupported operand type(s) for
/: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para 195_ChatGPT_UISD
Treatment Options.md: unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô
‚ùå Erro inesperado no Pandoc para 195_ChatGPT_UISD_Treatment_Options.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 196_ChatGPT_mulher sonha com sexo.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
196_ChatGPT_mulher_sonha_com_sexo.md: unsupported operand type(s) for /:
‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para 197_ChatGPT_Pediatric
ILE for CCBS.md: unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå
Erro inesperado no Pandoc para 197_ChatGPT_Pediatric_ILE_for_CCBS.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 198_ChatGPT_SSNHL vs SOHL.md: unsupported operand type(s)
for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
198_ChatGPT_SSNHL_vs_SOHL.md: unsupported operand type(s) for /: ‚Äòstr‚Äô
and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para 199_ChatGPT_SOHL Treatment
Options.md: unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro
inesperado no Pandoc para 199_ChatGPT_SOHL_Treatment_Options.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 200_ChatGPT_CVD Prevention Strategies..md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
200_ChatGPT_CVD_Prevention_Strategies..md: unsupported operand type(s)
for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
201_ChatGPT_Surdez S√∫bita Unilateral.md: unsupported operand type(s) for
/: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
201_ChatGPT_Surdez_Subita_Unilateral.md: unsupported operand type(s) for
/: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
202_ChatGPT_L-Citrulline Benefits.md: unsupported operand type(s) for /:
‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
202_ChatGPT_L-Citrulline_Benefits.md: unsupported operand type(s) for /:
‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para 203_ChatGPT_Ginkgo
Biloba Dosage for Deafness.md: unsupported operand type(s) for /: ‚Äòstr‚Äô
and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
203_ChatGPT_Ginkgo_Biloba_Dosage_for_Deafness.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
204_ChatGPT_Python GUI Libraries Comparison.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
204_ChatGPT_Python_GUI_Libraries_Comparison.md: unsupported operand
type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
205_ChatGPT_Research Resources Articles &amp; Engines.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
205_ChatGPT_Research_Resources_Articles</em>&amp;_Engines.md:
unsupported operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no
Pandoc para 206_ChatGPT_Piribedil para surdez s√∫bita.md: unsupported
operand type(s) for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚ùå Erro inesperado no Pandoc para
206_ChatGPT_Piribedil_para_surdez_subita.md: unsupported operand type(s)
for /: ‚Äòstr‚Äô and ‚Äòstr‚Äô ‚úÖ HTML: 0 arquivos criados, 564 falhas em
‚Äòcombined_html‚Äô ‚úÖ CSV: 206 arquivos criados em ‚Äòcombined_csv‚Äô ‚úÖ JSON:
206 arquivos criados em ‚Äòcombined_json‚Äô ‚úÖ CSV √∫nico:
combined_all_conversations.csv ‚úÖ JSON √∫nico:
combined_all_conversations.json üéØ Criando √≠ndice HTML combinado‚Ä¶ ‚úÖ
√çndice combinado criado: index.html</p>
<p>üéâ SISTEMA COMBINADO FINALIZADO! üìÑ √çndice: index.html</p>
<hr />
<h3 data-number="1.22.4" id="deepseek-2025-11-05-070749-deepseek-chat"><span class="header-section-number">1.22.4</span> ü§ñ DeepSeek <em>(2025-11-05
07:07:49)</em> <em>[deepseek-chat]</em></h3>
<p>O problema persiste porque h√° um erro no m√©todo
<code>convert_markdown_to_html_pandoc</code>. Vou corrigir
especificamente esse m√©todo:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convert_markdown_to_html_pandoc(<span class="va">self</span>, md_file_path: Path) <span class="op">-&gt;</span> <span class="bu">bool</span>:</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Converte Markdown para HTML usando Pandoc --standalone --mathjax&quot;&quot;&quot;</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>        html_file <span class="op">=</span> <span class="va">self</span>.output_dirs[<span class="st">&#39;html&#39;</span>] <span class="op">/</span> md_file_path.with_suffix(<span class="st">&#39;.html&#39;</span>).name</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.force_overwrite <span class="kw">and</span> html_file.exists():</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚è≠Ô∏è HTML j√° existe: </span><span class="sc">{</span>html_file<span class="sc">.</span>name<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;üîß Convertendo com Pandoc: </span><span class="sc">{</span>md_file_path<span class="sc">.</span>name<span class="sc">}</span><span class="ss"> ‚Üí </span><span class="sc">{</span>html_file<span class="sc">.</span>name<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>        <span class="co"># CORRE√á√ÉO: Comando Pandoc simplificado e robusto</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>        cmd <span class="op">=</span> [</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;pandoc&#39;</span>, </span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>            <span class="bu">str</span>(md_file_path),</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;-f&#39;</span>, <span class="st">&#39;markdown+emoji&#39;</span>,</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;-t&#39;</span>, <span class="st">&#39;html5&#39;</span>,</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;--standalone&#39;</span>,</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;--mathjax&#39;</span>,</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;-o&#39;</span>, <span class="bu">str</span>(html_file)</span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>        <span class="co"># CORRE√á√ÉO: Execu√ß√£o mais robusta</span></span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>        process <span class="op">=</span> subprocess.Popen(</span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>            cmd,</span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>            stdout<span class="op">=</span>subprocess.PIPE,</span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>            stderr<span class="op">=</span>subprocess.PIPE,</span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>            text<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>            encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span></span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a>        stdout, stderr <span class="op">=</span> process.communicate(timeout<span class="op">=</span><span class="dv">30</span>)</span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> process.returncode <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ HTML gerado: </span><span class="sc">{</span>html_file<span class="sc">.</span>name<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚ùå Erro no Pandoc para </span><span class="sc">{</span>md_file_path<span class="sc">.</span>name<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>stderr<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb21-40"><a href="#cb21-40" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb21-41"><a href="#cb21-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> subprocess.TimeoutExpired:</span>
<span id="cb21-42"><a href="#cb21-42" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;‚è∞ Timeout no Pandoc para </span><span class="sc">{</span>md_file_path<span class="sc">.</span>name<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb21-43"><a href="#cb21-43" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb21-44"><a href="#cb21-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb21-45"><a href="#cb21-45" aria-hidden="true" tabindex="-1"></a>        <span class="co"># CORRE√á√ÉO: Mostrar apenas a mensagem de erro, sem opera√ß√µes com strings</span></span>
<span id="cb21-46"><a href="#cb21-46" aria-hidden="true" tabindex="-1"></a>        error_msg <span class="op">=</span> <span class="bu">str</span>(e)</span>
<span id="cb21-47"><a href="#cb21-47" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;‚ùå Erro inesperado no Pandoc para </span><span class="sc">{</span>md_file_path<span class="sc">.</span>name<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>error_msg<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb21-48"><a href="#cb21-48" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span></code></pre></div>
<p><strong>Problema identificado:</strong> O erro
<code>unsupported operand type(s) for /: &#39;str&#39; and &#39;str&#39;</code> estava
ocorrendo porque havia uma opera√ß√£o de divis√£o entre strings em algum
lugar do c√≥digo. A corre√ß√£o acima remove qualquer possibilidade
disso.</p>
<p><strong>Execute este comando de teste primeiro para verificar se o
Pandoc funciona:</strong></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Teste simples do Pandoc</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;# Teste&quot;</span> <span class="op">&gt;</span> test.md</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="ex">pandoc</span> test.md <span class="at">--standalone</span> <span class="at">--mathjax</span> <span class="at">-o</span> test.html</span></code></pre></div>
<p>Se isso funcionar, ent√£o o problema est√° no c√≥digo Python. Vou
fornecer uma vers√£o completamente corrigida do m√©todo:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convert_markdown_to_html_pandoc(<span class="va">self</span>, md_file_path: Path) <span class="op">-&gt;</span> <span class="bu">bool</span>:</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Converte Markdown para HTML usando Pandoc --standalone --mathjax - VERS√ÉO CORRIGIDA&quot;&quot;&quot;</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>        html_file <span class="op">=</span> <span class="va">self</span>.output_dirs[<span class="st">&#39;html&#39;</span>] <span class="op">/</span> md_file_path.with_suffix(<span class="st">&#39;.html&#39;</span>).name</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Verifica se j√° existe</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.force_overwrite <span class="kw">and</span> html_file.exists():</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚è≠Ô∏è HTML j√° existe: </span><span class="sc">{</span>html_file<span class="sc">.</span>name<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;üîß Convertendo: </span><span class="sc">{</span>md_file_path<span class="sc">.</span>name<span class="sc">}</span><span class="ss"> ‚Üí </span><span class="sc">{</span>html_file<span class="sc">.</span>name<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Comando Pandoc corrigido</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> subprocess.run([</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;pandoc&#39;</span>,</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>            <span class="bu">str</span>(md_file_path),</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;--from&#39;</span>, <span class="st">&#39;markdown+emoji&#39;</span>,</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;--to&#39;</span>, <span class="st">&#39;html5&#39;</span>, </span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;--standalone&#39;</span>,</span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;--mathjax&#39;</span>,</span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;--output&#39;</span>, <span class="bu">str</span>(html_file)</span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>        ], capture_output<span class="op">=</span><span class="va">True</span>, text<span class="op">=</span><span class="va">True</span>, timeout<span class="op">=</span><span class="dv">30</span>)</span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> result.returncode <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ Sucesso: </span><span class="sc">{</span>html_file<span class="sc">.</span>name<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚ùå Falha no Pandoc: </span><span class="sc">{</span>md_file_path<span class="sc">.</span>name<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> result.stderr:</span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;   Erro: </span><span class="sc">{</span>result<span class="sc">.</span>stderr[:<span class="dv">200</span>]<span class="sc">}</span><span class="ss">...&quot;</span>)  <span class="co"># Mostra apenas primeiros 200 chars</span></span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> subprocess.TimeoutExpired:</span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;‚è∞ Timeout: </span><span class="sc">{</span>md_file_path<span class="sc">.</span>name<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb23-35"><a href="#cb23-35" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb23-36"><a href="#cb23-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb23-37"><a href="#cb23-37" aria-hidden="true" tabindex="-1"></a>        <span class="co"># CORRE√á√ÉO CR√çTICA: Apenas mostra a mensagem de erro sem opera√ß√µes</span></span>
<span id="cb23-38"><a href="#cb23-38" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;‚ùå Erro geral: </span><span class="sc">{</span>md_file_path<span class="sc">.</span>name<span class="sc">}</span><span class="ss"> - </span><span class="sc">{</span><span class="bu">str</span>(e)<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb23-39"><a href="#cb23-39" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span></code></pre></div>
<p><strong>Se ainda n√£o funcionar, tente esta abordagem
alternativa:</strong></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> save_as_html_with_pandoc(<span class="va">self</span>):</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Converte arquivos Markdown para HTML usando Pandoc - ABORDAGEM ALTERNATIVA&quot;&quot;&quot;</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;üß™ [DRY-RUN] HTMLs seriam criados com Pandoc:&quot;</span>)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> conv <span class="kw">in</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>            safe_title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(conv[<span class="st">&#39;title&#39;</span>])</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>            filename <span class="op">=</span> <span class="ss">f&quot;</span><span class="sc">{</span>conv[<span class="st">&#39;number&#39;</span>]<span class="sc">:03d}</span><span class="ss">_</span><span class="sc">{</span>conv[<span class="st">&#39;source&#39;</span>]<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>safe_title<span class="sc">}</span><span class="ss">.html&quot;</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;   üåê </span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss"> (via Pandoc)&quot;</span>)</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.check_pandoc_available():</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;‚ùå Pandoc n√£o dispon√≠vel. HTMLs n√£o ser√£o gerados.&quot;</span>)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>    markdown_folder <span class="op">=</span> <span class="va">self</span>.output_dirs[<span class="st">&#39;markdown&#39;</span>]</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>    html_folder <span class="op">=</span> <span class="va">self</span>.output_dirs[<span class="st">&#39;html&#39;</span>]</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>    md_files <span class="op">=</span> <span class="bu">list</span>(Path(markdown_folder).glob(<span class="st">&quot;*.md&quot;</span>))</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> md_files:</span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;‚ùå Nenhum arquivo Markdown encontrado para convers√£o.&quot;</span>)</span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;üîÑ Convertendo </span><span class="sc">{</span><span class="bu">len</span>(md_files)<span class="sc">}</span><span class="ss"> arquivos Markdown para HTML com Pandoc...&quot;</span>)</span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>    converted_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>    failed_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> md_file <span class="kw">in</span> md_files:</span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a>            html_file <span class="op">=</span> html_folder <span class="op">/</span> md_file.with_suffix(<span class="st">&#39;.html&#39;</span>).name</span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.force_overwrite <span class="kw">and</span> html_file.exists():</span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;‚è≠Ô∏è J√° existe: </span><span class="sc">{</span>html_file<span class="sc">.</span>name<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a>                converted_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span></span>
<span id="cb24-37"><a href="#cb24-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-38"><a href="#cb24-38" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;üîß Processando: </span><span class="sc">{</span>md_file<span class="sc">.</span>name<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb24-39"><a href="#cb24-39" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-40"><a href="#cb24-40" aria-hidden="true" tabindex="-1"></a>            <span class="co"># COMANDO DIRETO E SIMPLES</span></span>
<span id="cb24-41"><a href="#cb24-41" aria-hidden="true" tabindex="-1"></a>            cmd <span class="op">=</span> <span class="ss">f&#39;pandoc &quot;</span><span class="sc">{</span>md_file<span class="sc">}</span><span class="ss">&quot; --standalone --mathjax -o &quot;</span><span class="sc">{</span>html_file<span class="sc">}</span><span class="ss">&quot;&#39;</span></span>
<span id="cb24-42"><a href="#cb24-42" aria-hidden="true" tabindex="-1"></a>            result <span class="op">=</span> subprocess.run(cmd, shell<span class="op">=</span><span class="va">True</span>, capture_output<span class="op">=</span><span class="va">True</span>, text<span class="op">=</span><span class="va">True</span>, timeout<span class="op">=</span><span class="dv">30</span>)</span>
<span id="cb24-43"><a href="#cb24-43" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-44"><a href="#cb24-44" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> result.returncode <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb24-45"><a href="#cb24-45" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ Criado: </span><span class="sc">{</span>html_file<span class="sc">.</span>name<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb24-46"><a href="#cb24-46" aria-hidden="true" tabindex="-1"></a>                converted_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb24-47"><a href="#cb24-47" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb24-48"><a href="#cb24-48" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;‚ùå Falha: </span><span class="sc">{</span>md_file<span class="sc">.</span>name<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb24-49"><a href="#cb24-49" aria-hidden="true" tabindex="-1"></a>                failed_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb24-50"><a href="#cb24-50" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb24-51"><a href="#cb24-51" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb24-52"><a href="#cb24-52" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚ùå Erro em </span><span class="sc">{</span>md_file<span class="sc">.</span>name<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span><span class="bu">str</span>(e)<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb24-53"><a href="#cb24-53" aria-hidden="true" tabindex="-1"></a>            failed_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb24-54"><a href="#cb24-54" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-55"><a href="#cb24-55" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ HTML: </span><span class="sc">{</span>converted_count<span class="sc">}</span><span class="ss"> arquivos criados, </span><span class="sc">{</span>failed_count<span class="sc">}</span><span class="ss"> falhas em &#39;</span><span class="sc">{</span>html_folder<span class="sc">}</span><span class="ss">&#39;&quot;</span>)</span></code></pre></div>
<p><strong>Execute o teste do Pandoc primeiro</strong> para verificar se
ele funciona no seu sistema, depois tente a vers√£o corrigida.</p>
<hr />
<h3 data-number="1.22.5" id="utilizador-2025-11-05-071149-deepseek-chat"><span class="header-section-number">1.22.5</span> üë§ Utilizador
<em>(2025-11-05 07:11:49)</em> <em>[deepseek-chat]</em></h3>
<p>Funcionou (Pesquisas) D:_DOCS__DOCS___D_C_G_Qwen_Op&gt;echo ‚Äú# Teste‚Äù
&gt; test.md</p>
<p>(Pesquisas) D:_DOCS__DOCS___D_C_G_Qwen_Op&gt;pandoc test.md
‚Äìstandalone ‚Äìmathjax -o test.html Assim pretendo o
comb_fragments_system3_html_export.py completo corrigido</p>
<hr />
<h3 data-number="1.22.6" id="deepseek-2025-11-05-071149-deepseek-chat"><span class="header-section-number">1.22.6</span> ü§ñ DeepSeek <em>(2025-11-05
07:11:49)</em> <em>[deepseek-chat]</em></h3>
<p>Perfeito! Vou fornecer o
<code>comb_fragments_system3_html_export.py</code> completo e
corrigido:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># comb_fragments_system3_html_export.py</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> zipfile</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> csv</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> argparse</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sys</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> webbrowser</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> shutil</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tempfile</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> traceback</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> subprocess</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Any, Optional</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> CombinedFragmentsSystem:</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, dry_run<span class="op">=</span><span class="va">False</span>, force_overwrite<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.data_dir <span class="op">=</span> Path(<span class="st">&quot;data&quot;</span>)</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.dry_run <span class="op">=</span> dry_run</span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.force_overwrite <span class="op">=</span> force_overwrite</span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Estrutura de pastas organizada</span></span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.output_dirs <span class="op">=</span> {</span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;markdown&#39;</span>: <span class="st">&quot;combined_markdown&quot;</span>,</span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;csv&#39;</span>: <span class="st">&quot;combined_csv&quot;</span>, </span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;json&#39;</span>: <span class="st">&quot;combined_json&quot;</span>,</span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;pdfs&#39;</span>: <span class="st">&quot;combined_pdfs&quot;</span>,</span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;html&#39;</span>: <span class="st">&quot;combined_html&quot;</span></span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.single_files <span class="op">=</span> {</span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;csv&#39;</span>: <span class="st">&quot;combined_all_conversations.csv&quot;</span>,</span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;json&#39;</span>: <span class="st">&quot;combined_all_conversations.json&quot;</span></span>
<span id="cb25-36"><a href="#cb25-36" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb25-37"><a href="#cb25-37" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-38"><a href="#cb25-38" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.index_file <span class="op">=</span> <span class="st">&quot;index.html&quot;</span></span>
<span id="cb25-39"><a href="#cb25-39" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.all_conversations <span class="op">=</span> []</span>
<span id="cb25-40"><a href="#cb25-40" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-41"><a href="#cb25-41" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Configura√ß√£o de processamento por fonte</span></span>
<span id="cb25-42"><a href="#cb25-42" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.processors <span class="op">=</span> {</span>
<span id="cb25-43"><a href="#cb25-43" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;qwen&#39;</span>: {</span>
<span id="cb25-44"><a href="#cb25-44" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;file&#39;</span>: <span class="st">&quot;chat-export.json&quot;</span>,</span>
<span id="cb25-45"><a href="#cb25-45" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;method&#39;</span>: <span class="va">self</span>.process_qwen_enhanced,</span>
<span id="cb25-46"><a href="#cb25-46" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;enabled&#39;</span>: <span class="va">True</span></span>
<span id="cb25-47"><a href="#cb25-47" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb25-48"><a href="#cb25-48" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;chatgpt&#39;</span>: {</span>
<span id="cb25-49"><a href="#cb25-49" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;file&#39;</span>: <span class="st">&quot;chatgpt.zip&quot;</span>, </span>
<span id="cb25-50"><a href="#cb25-50" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;method&#39;</span>: <span class="va">self</span>.process_chatgpt,</span>
<span id="cb25-51"><a href="#cb25-51" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;enabled&#39;</span>: <span class="va">True</span></span>
<span id="cb25-52"><a href="#cb25-52" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb25-53"><a href="#cb25-53" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;deepseek&#39;</span>: {</span>
<span id="cb25-54"><a href="#cb25-54" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;file&#39;</span>: <span class="st">&quot;deepseek_data.zip&quot;</span>,</span>
<span id="cb25-55"><a href="#cb25-55" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;method&#39;</span>: <span class="va">self</span>.process_deepseek,</span>
<span id="cb25-56"><a href="#cb25-56" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;enabled&#39;</span>: <span class="va">True</span></span>
<span id="cb25-57"><a href="#cb25-57" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb25-58"><a href="#cb25-58" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;grok&#39;</span>: {</span>
<span id="cb25-59"><a href="#cb25-59" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;file&#39;</span>: <span class="st">&quot;grok.zip&quot;</span>,</span>
<span id="cb25-60"><a href="#cb25-60" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;method&#39;</span>: <span class="va">self</span>.process_grok,</span>
<span id="cb25-61"><a href="#cb25-61" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;enabled&#39;</span>: <span class="va">True</span></span>
<span id="cb25-62"><a href="#cb25-62" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb25-63"><a href="#cb25-63" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb25-64"><a href="#cb25-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-65"><a href="#cb25-65" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> sanitize_filename(<span class="va">self</span>, text: <span class="bu">str</span>, max_len: <span class="bu">int</span> <span class="op">=</span> <span class="dv">50</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb25-66"><a href="#cb25-66" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Sanitiza nomes de arquivo PRESERVANDO EMOJIS&quot;&quot;&quot;</span></span>
<span id="cb25-67"><a href="#cb25-67" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> text <span class="kw">or</span> <span class="kw">not</span> <span class="bu">isinstance</span>(text, <span class="bu">str</span>):</span>
<span id="cb25-68"><a href="#cb25-68" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">&quot;conversa_sem_titulo&quot;</span></span>
<span id="cb25-69"><a href="#cb25-69" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-70"><a href="#cb25-70" aria-hidden="true" tabindex="-1"></a>        invalid_chars <span class="op">=</span> <span class="vs">r&#39;</span><span class="pp">[&lt;&gt;:&quot;/</span><span class="ch">\\</span><span class="pp">|?*</span><span class="ch">\x00</span><span class="pp">-</span><span class="ch">\x1F\x7F</span><span class="pp">]</span><span class="vs">&#39;</span></span>
<span id="cb25-71"><a href="#cb25-71" aria-hidden="true" tabindex="-1"></a>        sanitized <span class="op">=</span> re.sub(invalid_chars, <span class="st">&#39;&#39;</span>, text)</span>
<span id="cb25-72"><a href="#cb25-72" aria-hidden="true" tabindex="-1"></a>        sanitized <span class="op">=</span> re.sub(<span class="vs">r&#39;</span><span class="dv">\s</span><span class="op">+</span><span class="vs">&#39;</span>, <span class="st">&#39; &#39;</span>, sanitized.strip())</span>
<span id="cb25-73"><a href="#cb25-73" aria-hidden="true" tabindex="-1"></a>        sanitized <span class="op">=</span> sanitized.strip()</span>
<span id="cb25-74"><a href="#cb25-74" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-75"><a href="#cb25-75" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> sanitized:</span>
<span id="cb25-76"><a href="#cb25-76" aria-hidden="true" tabindex="-1"></a>            sanitized <span class="op">=</span> <span class="st">&quot;conversa_sem_titulo&quot;</span></span>
<span id="cb25-77"><a href="#cb25-77" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-78"><a href="#cb25-78" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(sanitized) <span class="op">&gt;</span> max_len:</span>
<span id="cb25-79"><a href="#cb25-79" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="st">&#39; &#39;</span> <span class="kw">in</span> sanitized[:max_len]:</span>
<span id="cb25-80"><a href="#cb25-80" aria-hidden="true" tabindex="-1"></a>                last_space <span class="op">=</span> sanitized[:max_len].rfind(<span class="st">&#39; &#39;</span>)</span>
<span id="cb25-81"><a href="#cb25-81" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> last_space <span class="op">&gt;</span> <span class="dv">10</span>:</span>
<span id="cb25-82"><a href="#cb25-82" aria-hidden="true" tabindex="-1"></a>                    sanitized <span class="op">=</span> sanitized[:last_space]</span>
<span id="cb25-83"><a href="#cb25-83" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb25-84"><a href="#cb25-84" aria-hidden="true" tabindex="-1"></a>                sanitized <span class="op">=</span> sanitized[:max_len]</span>
<span id="cb25-85"><a href="#cb25-85" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-86"><a href="#cb25-86" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> sanitized</span>
<span id="cb25-87"><a href="#cb25-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-88"><a href="#cb25-88" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> preserve_special_content(<span class="va">self</span>, content: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb25-89"><a href="#cb25-89" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Preserva f√≥rmulas matem√°ticas, c√≥digo e formata√ß√£o especial&quot;&quot;&quot;</span></span>
<span id="cb25-90"><a href="#cb25-90" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> content:</span>
<span id="cb25-91"><a href="#cb25-91" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">&quot;&quot;</span></span>
<span id="cb25-92"><a href="#cb25-92" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-93"><a href="#cb25-93" aria-hidden="true" tabindex="-1"></a>        preserved_content <span class="op">=</span> content</span>
<span id="cb25-94"><a href="#cb25-94" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-95"><a href="#cb25-95" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Corrige problemas com barras invertidas em LaTeX</span></span>
<span id="cb25-96"><a href="#cb25-96" aria-hidden="true" tabindex="-1"></a>        latex_corrections <span class="op">=</span> {</span>
<span id="cb25-97"><a href="#cb25-97" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;‚ôÄrac&#39;</span>: <span class="st">&#39;</span><span class="ch">\\</span><span class="st">frac&#39;</span>,</span>
<span id="cb25-98"><a href="#cb25-98" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;‚ôÇarepsilon&#39;</span>: <span class="st">&#39;</span><span class="ch">\\</span><span class="st">varepsilon&#39;</span>,</span>
<span id="cb25-99"><a href="#cb25-99" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;‚ôÇ&#39;</span>: <span class="st">&#39;</span><span class="ch">\\</span><span class="st">&#39;</span>,</span>
<span id="cb25-100"><a href="#cb25-100" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;‚ôÄ&#39;</span>: <span class="st">&#39;</span><span class="ch">\\</span><span class="st">&#39;</span></span>
<span id="cb25-101"><a href="#cb25-101" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb25-102"><a href="#cb25-102" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-103"><a href="#cb25-103" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> wrong, correct <span class="kw">in</span> latex_corrections.items():</span>
<span id="cb25-104"><a href="#cb25-104" aria-hidden="true" tabindex="-1"></a>            preserved_content <span class="op">=</span> preserved_content.replace(wrong, correct)</span>
<span id="cb25-105"><a href="#cb25-105" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-106"><a href="#cb25-106" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> preserved_content</span>
<span id="cb25-107"><a href="#cb25-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-108"><a href="#cb25-108" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> ensure_directories(<span class="va">self</span>):</span>
<span id="cb25-109"><a href="#cb25-109" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Cria todas as pastas necess√°rias&quot;&quot;&quot;</span></span>
<span id="cb25-110"><a href="#cb25-110" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb25-111"><a href="#cb25-111" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;DRY-RUN: Pastas seriam criadas:&quot;</span>)</span>
<span id="cb25-112"><a href="#cb25-112" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> folder <span class="kw">in</span> <span class="va">self</span>.output_dirs.values():</span>
<span id="cb25-113"><a href="#cb25-113" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;   </span><span class="sc">{</span>folder<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb25-114"><a href="#cb25-114" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb25-115"><a href="#cb25-115" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-116"><a href="#cb25-116" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> folder <span class="kw">in</span> <span class="va">self</span>.output_dirs.values():</span>
<span id="cb25-117"><a href="#cb25-117" aria-hidden="true" tabindex="-1"></a>            Path(folder).mkdir(parents<span class="op">=</span><span class="va">True</span>, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb25-118"><a href="#cb25-118" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;Pasta criada: </span><span class="sc">{</span>folder<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb25-119"><a href="#cb25-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-120"><a href="#cb25-120" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> run(<span class="va">self</span>):</span>
<span id="cb25-121"><a href="#cb25-121" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Executa o processamento completo&quot;&quot;&quot;</span></span>
<span id="cb25-122"><a href="#cb25-122" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;SISTEMA COMBINADO DE EXPORTA√á√ïES COM HTML (Qwen3, ChatGPT, DeepSeek, Grok)&quot;</span>)</span>
<span id="cb25-123"><a href="#cb25-123" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;=&quot;</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb25-124"><a href="#cb25-124" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-125"><a href="#cb25-125" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.data_dir.exists():</span>
<span id="cb25-126"><a href="#cb25-126" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;Pasta &#39;</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>data_dir<span class="sc">}</span><span class="ss">&#39; n√£o encontrada.&quot;</span>)</span>
<span id="cb25-127"><a href="#cb25-127" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;Crie a pasta &#39;data&#39; e coloque os arquivos de exporta√ß√£o:&quot;</span>)</span>
<span id="cb25-128"><a href="#cb25-128" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> source_name, config <span class="kw">in</span> <span class="va">self</span>.processors.items():</span>
<span id="cb25-129"><a href="#cb25-129" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;   - </span><span class="sc">{</span>config[<span class="st">&#39;file&#39;</span>]<span class="sc">}</span><span class="ss"> (para </span><span class="sc">{</span>source_name<span class="sc">.</span>upper()<span class="sc">}</span><span class="ss">)&quot;</span>)</span>
<span id="cb25-130"><a href="#cb25-130" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb25-131"><a href="#cb25-131" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-132"><a href="#cb25-132" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;Usando pasta de dados: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>data_dir<span class="sc">.</span>absolute()<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb25-133"><a href="#cb25-133" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-134"><a href="#cb25-134" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.ensure_directories()</span>
<span id="cb25-135"><a href="#cb25-135" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-136"><a href="#cb25-136" aria-hidden="true" tabindex="-1"></a>        processed_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb25-137"><a href="#cb25-137" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> source_name, config <span class="kw">in</span> <span class="va">self</span>.processors.items():</span>
<span id="cb25-138"><a href="#cb25-138" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> config[<span class="st">&#39;enabled&#39;</span>]:</span>
<span id="cb25-139"><a href="#cb25-139" aria-hidden="true" tabindex="-1"></a>                file_path <span class="op">=</span> <span class="va">self</span>.data_dir <span class="op">/</span> config[<span class="st">&#39;file&#39;</span>]</span>
<span id="cb25-140"><a href="#cb25-140" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> file_path.exists():</span>
<span id="cb25-141"><a href="#cb25-141" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="ch">\n</span><span class="ss">Processando </span><span class="sc">{</span>source_name<span class="sc">.</span>upper()<span class="sc">}</span><span class="ss">...&quot;</span>)</span>
<span id="cb25-142"><a href="#cb25-142" aria-hidden="true" tabindex="-1"></a>                    config[<span class="st">&#39;method&#39;</span>](file_path)</span>
<span id="cb25-143"><a href="#cb25-143" aria-hidden="true" tabindex="-1"></a>                    processed_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb25-144"><a href="#cb25-144" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb25-145"><a href="#cb25-145" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="sc">{</span>source_name<span class="sc">.</span>upper()<span class="sc">}</span><span class="ss">: arquivo n√£o encontrado - </span><span class="sc">{</span>file_path<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb25-146"><a href="#cb25-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-147"><a href="#cb25-147" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> processed_count <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb25-148"><a href="#cb25-148" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;Nenhum arquivo de exporta√ß√£o encontrado na pasta &#39;data&#39;.&quot;</span>)</span>
<span id="cb25-149"><a href="#cb25-149" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb25-150"><a href="#cb25-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-151"><a href="#cb25-151" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb25-152"><a href="#cb25-152" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;Nenhuma conversa foi extra√≠da dos arquivos.&quot;</span>)</span>
<span id="cb25-153"><a href="#cb25-153" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb25-154"><a href="#cb25-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-155"><a href="#cb25-155" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>._post_process_conversations()</span>
<span id="cb25-156"><a href="#cb25-156" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-157"><a href="#cb25-157" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.dry_run:</span>
<span id="cb25-158"><a href="#cb25-158" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>._export_all_formats()</span>
<span id="cb25-159"><a href="#cb25-159" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="ch">\n</span><span class="ss">üéâ SISTEMA COMBINADO FINALIZADO!&quot;</span>)</span>
<span id="cb25-160"><a href="#cb25-160" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;üìÑ √çndice: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>index_file<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb25-161"><a href="#cb25-161" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> Path(<span class="va">self</span>.index_file).exists():</span>
<span id="cb25-162"><a href="#cb25-162" aria-hidden="true" tabindex="-1"></a>                webbrowser.<span class="bu">open</span>(<span class="ss">f&#39;file://</span><span class="sc">{</span>Path(<span class="va">self</span>.index_file)<span class="sc">.</span>absolute()<span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb25-163"><a href="#cb25-163" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb25-164"><a href="#cb25-164" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="ch">\n</span><span class="ss">üß™ MODO DRY-RUN: Nenhum arquivo foi criado.&quot;</span>)</span>
<span id="cb25-165"><a href="#cb25-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-166"><a href="#cb25-166" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _post_process_conversations(<span class="va">self</span>):</span>
<span id="cb25-167"><a href="#cb25-167" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Processamento p√≥s-extra√ß√£o das conversas&quot;&quot;&quot;</span></span>
<span id="cb25-168"><a href="#cb25-168" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.all_conversations.sort(</span>
<span id="cb25-169"><a href="#cb25-169" aria-hidden="true" tabindex="-1"></a>            key<span class="op">=</span><span class="kw">lambda</span> x: <span class="va">self</span>.parse_timestamp_for_sorting(</span>
<span id="cb25-170"><a href="#cb25-170" aria-hidden="true" tabindex="-1"></a>                x.get(<span class="st">&#39;updated_at&#39;</span>) <span class="kw">or</span> x.get(<span class="st">&#39;inserted_at&#39;</span>) <span class="kw">or</span> x.get(<span class="st">&#39;created_at&#39;</span>)</span>
<span id="cb25-171"><a href="#cb25-171" aria-hidden="true" tabindex="-1"></a>            ),</span>
<span id="cb25-172"><a href="#cb25-172" aria-hidden="true" tabindex="-1"></a>            reverse<span class="op">=</span><span class="va">True</span></span>
<span id="cb25-173"><a href="#cb25-173" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb25-174"><a href="#cb25-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-175"><a href="#cb25-175" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, conv <span class="kw">in</span> <span class="bu">enumerate</span>(<span class="va">self</span>.all_conversations):</span>
<span id="cb25-176"><a href="#cb25-176" aria-hidden="true" tabindex="-1"></a>            conv[<span class="st">&#39;number&#39;</span>] <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb25-177"><a href="#cb25-177" aria-hidden="true" tabindex="-1"></a>            conv[<span class="st">&#39;category&#39;</span>] <span class="op">=</span> <span class="va">self</span>.categorize_conversation(conv[<span class="st">&#39;title&#39;</span>], conv.get(<span class="st">&#39;summary&#39;</span>, <span class="st">&#39;&#39;</span>))</span>
<span id="cb25-178"><a href="#cb25-178" aria-hidden="true" tabindex="-1"></a>            conv.setdefault(<span class="st">&#39;source&#39;</span>, <span class="st">&#39;Desconhecido&#39;</span>)</span>
<span id="cb25-179"><a href="#cb25-179" aria-hidden="true" tabindex="-1"></a>            conv.setdefault(<span class="st">&#39;messages&#39;</span>, [])</span>
<span id="cb25-180"><a href="#cb25-180" aria-hidden="true" tabindex="-1"></a>            conv.setdefault(<span class="st">&#39;summary&#39;</span>, conv[<span class="st">&#39;messages&#39;</span>][<span class="dv">0</span>][<span class="st">&#39;content&#39;</span>][:<span class="dv">100</span>] <span class="op">+</span> <span class="st">&quot;...&quot;</span> <span class="cf">if</span> conv[<span class="st">&#39;messages&#39;</span>] <span class="cf">else</span> <span class="st">&quot;Sem conte√∫do&quot;</span>)</span>
<span id="cb25-181"><a href="#cb25-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-182"><a href="#cb25-182" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;üìä Total combinado de conversas: </span><span class="sc">{</span><span class="bu">len</span>(<span class="va">self</span>.all_conversations)<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb25-183"><a href="#cb25-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-184"><a href="#cb25-184" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _export_all_formats(<span class="va">self</span>):</span>
<span id="cb25-185"><a href="#cb25-185" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Exporta para todos os formatos&quot;&quot;&quot;</span></span>
<span id="cb25-186"><a href="#cb25-186" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">üíæ Exportando para formatos...&quot;</span>)</span>
<span id="cb25-187"><a href="#cb25-187" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.save_as_markdown_enhanced()</span>
<span id="cb25-188"><a href="#cb25-188" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.save_as_html_with_pandoc()</span>
<span id="cb25-189"><a href="#cb25-189" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.save_as_csv() </span>
<span id="cb25-190"><a href="#cb25-190" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.save_as_json()</span>
<span id="cb25-191"><a href="#cb25-191" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.save_all_to_single_files()</span>
<span id="cb25-192"><a href="#cb25-192" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.create_searchable_index()</span>
<span id="cb25-193"><a href="#cb25-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-194"><a href="#cb25-194" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> check_pandoc_available(<span class="va">self</span>) <span class="op">-&gt;</span> <span class="bu">bool</span>:</span>
<span id="cb25-195"><a href="#cb25-195" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Verifica se Pandoc est√° dispon√≠vel&quot;&quot;&quot;</span></span>
<span id="cb25-196"><a href="#cb25-196" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb25-197"><a href="#cb25-197" aria-hidden="true" tabindex="-1"></a>            result <span class="op">=</span> subprocess.run(</span>
<span id="cb25-198"><a href="#cb25-198" aria-hidden="true" tabindex="-1"></a>                [<span class="st">&#39;pandoc&#39;</span>, <span class="st">&#39;--version&#39;</span>], </span>
<span id="cb25-199"><a href="#cb25-199" aria-hidden="true" tabindex="-1"></a>                capture_output<span class="op">=</span><span class="va">True</span>, </span>
<span id="cb25-200"><a href="#cb25-200" aria-hidden="true" tabindex="-1"></a>                text<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb25-201"><a href="#cb25-201" aria-hidden="true" tabindex="-1"></a>                timeout<span class="op">=</span><span class="dv">10</span></span>
<span id="cb25-202"><a href="#cb25-202" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb25-203"><a href="#cb25-203" aria-hidden="true" tabindex="-1"></a>            available <span class="op">=</span> result.returncode <span class="op">==</span> <span class="dv">0</span></span>
<span id="cb25-204"><a href="#cb25-204" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> available:</span>
<span id="cb25-205"><a href="#cb25-205" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;‚úÖ Pandoc dispon√≠vel para convers√£o HTML&quot;</span>)</span>
<span id="cb25-206"><a href="#cb25-206" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb25-207"><a href="#cb25-207" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;‚ö†Ô∏è Pandoc n√£o encontrado - HTML n√£o ser√° gerado&quot;</span>)</span>
<span id="cb25-208"><a href="#cb25-208" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> available</span>
<span id="cb25-209"><a href="#cb25-209" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> (subprocess.TimeoutExpired, <span class="pp">FileNotFoundError</span>, <span class="pp">Exception</span>) <span class="im">as</span> e:</span>
<span id="cb25-210"><a href="#cb25-210" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚ö†Ô∏è Pandoc n√£o dispon√≠vel: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb25-211"><a href="#cb25-211" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb25-212"><a href="#cb25-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-213"><a href="#cb25-213" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> save_as_html_with_pandoc(<span class="va">self</span>):</span>
<span id="cb25-214"><a href="#cb25-214" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Converte arquivos Markdown para HTML usando Pandoc --standalone --mathjax - VERS√ÉO CORRIGIDA&quot;&quot;&quot;</span></span>
<span id="cb25-215"><a href="#cb25-215" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb25-216"><a href="#cb25-216" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;üß™ [DRY-RUN] HTMLs seriam criados com Pandoc:&quot;</span>)</span>
<span id="cb25-217"><a href="#cb25-217" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> conv <span class="kw">in</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb25-218"><a href="#cb25-218" aria-hidden="true" tabindex="-1"></a>                safe_title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(conv[<span class="st">&#39;title&#39;</span>])</span>
<span id="cb25-219"><a href="#cb25-219" aria-hidden="true" tabindex="-1"></a>                filename <span class="op">=</span> <span class="ss">f&quot;</span><span class="sc">{</span>conv[<span class="st">&#39;number&#39;</span>]<span class="sc">:03d}</span><span class="ss">_</span><span class="sc">{</span>conv[<span class="st">&#39;source&#39;</span>]<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>safe_title<span class="sc">}</span><span class="ss">.html&quot;</span></span>
<span id="cb25-220"><a href="#cb25-220" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;   üåê </span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss"> (via Pandoc)&quot;</span>)</span>
<span id="cb25-221"><a href="#cb25-221" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb25-222"><a href="#cb25-222" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-223"><a href="#cb25-223" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.check_pandoc_available():</span>
<span id="cb25-224"><a href="#cb25-224" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;‚ùå Pandoc n√£o dispon√≠vel. HTMLs n√£o ser√£o gerados.&quot;</span>)</span>
<span id="cb25-225"><a href="#cb25-225" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb25-226"><a href="#cb25-226" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-227"><a href="#cb25-227" aria-hidden="true" tabindex="-1"></a>        markdown_folder <span class="op">=</span> <span class="va">self</span>.output_dirs[<span class="st">&#39;markdown&#39;</span>]</span>
<span id="cb25-228"><a href="#cb25-228" aria-hidden="true" tabindex="-1"></a>        html_folder <span class="op">=</span> <span class="va">self</span>.output_dirs[<span class="st">&#39;html&#39;</span>]</span>
<span id="cb25-229"><a href="#cb25-229" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-230"><a href="#cb25-230" aria-hidden="true" tabindex="-1"></a>        md_files <span class="op">=</span> <span class="bu">list</span>(Path(markdown_folder).glob(<span class="st">&quot;*.md&quot;</span>))</span>
<span id="cb25-231"><a href="#cb25-231" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-232"><a href="#cb25-232" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> md_files:</span>
<span id="cb25-233"><a href="#cb25-233" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;‚ùå Nenhum arquivo Markdown encontrado para convers√£o.&quot;</span>)</span>
<span id="cb25-234"><a href="#cb25-234" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb25-235"><a href="#cb25-235" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-236"><a href="#cb25-236" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;üîÑ Convertendo </span><span class="sc">{</span><span class="bu">len</span>(md_files)<span class="sc">}</span><span class="ss"> arquivos Markdown para HTML com Pandoc...&quot;</span>)</span>
<span id="cb25-237"><a href="#cb25-237" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-238"><a href="#cb25-238" aria-hidden="true" tabindex="-1"></a>        converted_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb25-239"><a href="#cb25-239" aria-hidden="true" tabindex="-1"></a>        failed_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb25-240"><a href="#cb25-240" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-241"><a href="#cb25-241" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> md_file <span class="kw">in</span> md_files:</span>
<span id="cb25-242"><a href="#cb25-242" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb25-243"><a href="#cb25-243" aria-hidden="true" tabindex="-1"></a>                html_file <span class="op">=</span> html_folder <span class="op">/</span> md_file.with_suffix(<span class="st">&#39;.html&#39;</span>).name</span>
<span id="cb25-244"><a href="#cb25-244" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb25-245"><a href="#cb25-245" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.force_overwrite <span class="kw">and</span> html_file.exists():</span>
<span id="cb25-246"><a href="#cb25-246" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="ss">f&quot;‚è≠Ô∏è J√° existe: </span><span class="sc">{</span>html_file<span class="sc">.</span>name<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb25-247"><a href="#cb25-247" aria-hidden="true" tabindex="-1"></a>                    converted_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb25-248"><a href="#cb25-248" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">continue</span></span>
<span id="cb25-249"><a href="#cb25-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-250"><a href="#cb25-250" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;üîß Processando: </span><span class="sc">{</span>md_file<span class="sc">.</span>name<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb25-251"><a href="#cb25-251" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb25-252"><a href="#cb25-252" aria-hidden="true" tabindex="-1"></a>                <span class="co"># COMANDO PANDOC CORRETO E SIMPLES</span></span>
<span id="cb25-253"><a href="#cb25-253" aria-hidden="true" tabindex="-1"></a>                cmd <span class="op">=</span> [</span>
<span id="cb25-254"><a href="#cb25-254" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;pandoc&#39;</span>,</span>
<span id="cb25-255"><a href="#cb25-255" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">str</span>(md_file),</span>
<span id="cb25-256"><a href="#cb25-256" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;--standalone&#39;</span>,</span>
<span id="cb25-257"><a href="#cb25-257" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;--mathjax&#39;</span>,</span>
<span id="cb25-258"><a href="#cb25-258" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;-o&#39;</span>, <span class="bu">str</span>(html_file)</span>
<span id="cb25-259"><a href="#cb25-259" aria-hidden="true" tabindex="-1"></a>                ]</span>
<span id="cb25-260"><a href="#cb25-260" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb25-261"><a href="#cb25-261" aria-hidden="true" tabindex="-1"></a>                result <span class="op">=</span> subprocess.run(cmd, capture_output<span class="op">=</span><span class="va">True</span>, text<span class="op">=</span><span class="va">True</span>, timeout<span class="op">=</span><span class="dv">30</span>)</span>
<span id="cb25-262"><a href="#cb25-262" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb25-263"><a href="#cb25-263" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> result.returncode <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb25-264"><a href="#cb25-264" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ Criado: </span><span class="sc">{</span>html_file<span class="sc">.</span>name<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb25-265"><a href="#cb25-265" aria-hidden="true" tabindex="-1"></a>                    converted_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb25-266"><a href="#cb25-266" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb25-267"><a href="#cb25-267" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="ss">f&quot;‚ùå Falha: </span><span class="sc">{</span>md_file<span class="sc">.</span>name<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb25-268"><a href="#cb25-268" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> result.stderr:</span>
<span id="cb25-269"><a href="#cb25-269" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># Mostra apenas o in√≠cio do erro para n√£o poluir o output</span></span>
<span id="cb25-270"><a href="#cb25-270" aria-hidden="true" tabindex="-1"></a>                        error_preview <span class="op">=</span> result.stderr[:<span class="dv">100</span>] <span class="op">+</span> <span class="st">&quot;...&quot;</span> <span class="cf">if</span> <span class="bu">len</span>(result.stderr) <span class="op">&gt;</span> <span class="dv">100</span> <span class="cf">else</span> result.stderr</span>
<span id="cb25-271"><a href="#cb25-271" aria-hidden="true" tabindex="-1"></a>                        <span class="bu">print</span>(<span class="ss">f&quot;   Erro: </span><span class="sc">{</span>error_preview<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb25-272"><a href="#cb25-272" aria-hidden="true" tabindex="-1"></a>                    failed_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb25-273"><a href="#cb25-273" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb25-274"><a href="#cb25-274" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span> subprocess.TimeoutExpired:</span>
<span id="cb25-275"><a href="#cb25-275" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;‚è∞ Timeout: </span><span class="sc">{</span>md_file<span class="sc">.</span>name<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb25-276"><a href="#cb25-276" aria-hidden="true" tabindex="-1"></a>                failed_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb25-277"><a href="#cb25-277" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb25-278"><a href="#cb25-278" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;‚ùå Erro em </span><span class="sc">{</span>md_file<span class="sc">.</span>name<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span><span class="bu">str</span>(e)<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb25-279"><a href="#cb25-279" aria-hidden="true" tabindex="-1"></a>                failed_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb25-280"><a href="#cb25-280" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb25-281"><a href="#cb25-281" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ HTML: </span><span class="sc">{</span>converted_count<span class="sc">}</span><span class="ss"> arquivos criados, </span><span class="sc">{</span>failed_count<span class="sc">}</span><span class="ss"> falhas em &#39;</span><span class="sc">{</span>html_folder<span class="sc">}</span><span class="ss">&#39;&quot;</span>)</span>
<span id="cb25-282"><a href="#cb25-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-283"><a href="#cb25-283" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> categorize_conversation(<span class="va">self</span>, title: <span class="bu">str</span>, summary: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb25-284"><a href="#cb25-284" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Categoriza√ß√£o otimizada com express√µes regulares&quot;&quot;&quot;</span></span>
<span id="cb25-285"><a href="#cb25-285" aria-hidden="true" tabindex="-1"></a>        text <span class="op">=</span> <span class="ss">f&quot;</span><span class="sc">{</span>title<span class="sc">}</span><span class="ss"> </span><span class="sc">{</span>summary<span class="sc">}</span><span class="ss">&quot;</span>.lower()</span>
<span id="cb25-286"><a href="#cb25-286" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-287"><a href="#cb25-287" aria-hidden="true" tabindex="-1"></a>        patterns <span class="op">=</span> {</span>
<span id="cb25-288"><a href="#cb25-288" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Tecnologia&#39;</span>: <span class="vs">r&#39;</span><span class="dv">\b</span><span class="kw">(</span><span class="vs">tecnologia</span><span class="cf">|</span><span class="vs">hardware</span><span class="cf">|</span><span class="vs">software</span><span class="cf">|</span><span class="vs">rede</span><span class="cf">|</span><span class="vs">internet</span><span class="cf">|</span><span class="vs">wifi</span><span class="cf">|</span><span class="vs">bluetooth</span><span class="cf">|</span><span class="pp">[45]</span><span class="vs">g</span><span class="cf">|</span><span class="vs">cloud</span><span class="cf">|</span><span class="vs">aws</span><span class="cf">|</span><span class="vs">azure</span><span class="cf">|</span><span class="vs">gcp</span><span class="cf">|</span><span class="vs">servidor</span><span class="cf">|</span><span class="vs">hosting</span><span class="cf">|</span><span class="vs">dom√≠nio</span><span class="cf">|</span><span class="vs">ssl</span><span class="cf">|</span><span class="vs">router</span><span class="cf">|</span><span class="vs">switch</span><span class="cf">|</span><span class="vs">firewall</span><span class="cf">|</span><span class="vs">iot</span><span class="cf">|</span><span class="vs">smartphone</span><span class="cf">|</span><span class="vs">tablet</span><span class="cf">|</span><span class="vs">navegador</span><span class="cf">|</span><span class="vs">browser</span><span class="cf">|</span><span class="vs">chrome</span><span class="cf">|</span><span class="vs">firefox</span><span class="cf">|</span><span class="vs">edge</span><span class="cf">|</span><span class="vs">safari</span><span class="cf">|</span><span class="vs">email</span><span class="cf">|</span><span class="vs">gmail</span><span class="cf">|</span><span class="vs">outlook</span><span class="cf">|</span><span class="vs">criptografia</span><span class="cf">|</span><span class="vs">seguran√ßa</span><span class="cf">|</span><span class="vs">ciberseguran√ßa</span><span class="cf">|</span><span class="vs">ransomware</span><span class="cf">|</span><span class="vs">phishing</span><span class="cf">|</span><span class="vs">autentica√ß√£o</span><span class="cf">|</span><span class="vs">2fa</span><span class="cf">|</span><span class="vs">biometria</span><span class="kw">)</span><span class="dv">\b</span><span class="vs">&#39;</span>,</span>
<span id="cb25-289"><a href="#cb25-289" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Sa√∫de&#39;</span>: <span class="vs">r&#39;</span><span class="dv">\b</span><span class="kw">(</span><span class="vs">sa√∫de</span><span class="cf">|</span><span class="vs">medicina</span><span class="cf">|</span><span class="vs">m√©dico</span><span class="cf">|</span><span class="vs">enfermagem</span><span class="cf">|</span><span class="vs">doen√ßa</span><span class="cf">|</span><span class="vs">v√≠rus</span><span class="cf">|</span><span class="vs">bact√©ria</span><span class="cf">|</span><span class="vs">vacina</span><span class="cf">|</span><span class="vs">covid</span><span class="cf">|</span><span class="vs">coronav√≠rus</span><span class="cf">|</span><span class="vs">gripe</span><span class="cf">|</span><span class="vs">febre</span><span class="cf">|</span><span class="vs">dor</span><span class="cf">|</span><span class="vs">an√°lise</span><span class="cf">|</span><span class="vs">exame</span><span class="cf">|</span><span class="vs">raio x</span><span class="cf">|</span><span class="vs">resson√¢ncia</span><span class="cf">|</span><span class="vs">hospital</span><span class="cf">|</span><span class="vs">cl√≠nica</span><span class="cf">|</span><span class="vs">farm√°cia</span><span class="cf">|</span><span class="vs">medicamento</span><span class="cf">|</span><span class="vs">rem√©dio</span><span class="cf">|</span><span class="vs">psicologia</span><span class="cf">|</span><span class="vs">terapia</span><span class="cf">|</span><span class="vs">bem-estar</span><span class="cf">|</span><span class="vs">nutri√ß√£o</span><span class="cf">|</span><span class="vs">dieta</span><span class="cf">|</span><span class="vs">exerc√≠cio</span><span class="cf">|</span><span class="vs">fitness</span><span class="cf">|</span><span class="vs">sono</span><span class="cf">|</span><span class="vs">sa√∫de mental</span><span class="kw">)</span><span class="dv">\b</span><span class="vs">&#39;</span>,</span>
<span id="cb25-290"><a href="#cb25-290" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Programa√ß√£o&#39;</span>: <span class="vs">r&#39;</span><span class="dv">\b</span><span class="kw">(</span><span class="vs">python</span><span class="cf">|</span><span class="vs">javascript</span><span class="cf">|</span><span class="vs">java</span><span class="cf">|</span><span class="vs">c</span><span class="ch">\+\+</span><span class="cf">|</span><span class="vs">c#</span><span class="cf">|</span><span class="vs">go</span><span class="cf">|</span><span class="vs">rust</span><span class="cf">|</span><span class="vs">lua</span><span class="cf">|</span><span class="vs">bash</span><span class="cf">|</span><span class="vs">script</span><span class="cf">|</span><span class="vs">debug</span><span class="cf">|</span><span class="vs">erro</span><span class="cf">|</span><span class="vs">conda</span><span class="cf">|</span><span class="vs">mamba</span><span class="cf">|</span><span class="vs">pandoc</span><span class="cf">|</span><span class="vs">msys2</span><span class="cf">|</span><span class="vs">spyder</span><span class="cf">|</span><span class="vs">jupyter</span><span class="cf">|</span><span class="vs">pip</span><span class="cf">|</span><span class="vs">venv</span><span class="cf">|</span><span class="vs">docker</span><span class="cf">|</span><span class="vs">git</span><span class="cf">|</span><span class="vs">github</span><span class="cf">|</span><span class="vs">vscode</span><span class="cf">|</span><span class="vs">ide</span><span class="cf">|</span><span class="vs">programa</span><span class="cf">|</span><span class="vs">c√≥digo</span><span class="cf">|</span><span class="vs">fun√ß√£o</span><span class="cf">|</span><span class="vs">classe</span><span class="cf">|</span><span class="vs">api</span><span class="cf">|</span><span class="vs">selenium</span><span class="cf">|</span><span class="vs">playwright</span><span class="kw">)</span><span class="dv">\b</span><span class="vs">&#39;</span>,</span>
<span id="cb25-291"><a href="#cb25-291" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Sistemas&#39;</span>: <span class="vs">r&#39;</span><span class="dv">\b</span><span class="kw">(</span><span class="vs">windows</span><span class="cf">|</span><span class="vs">linux</span><span class="cf">|</span><span class="vs">macos</span><span class="cf">|</span><span class="vs">so</span><span class="cf">|</span><span class="vs">sistema operacional</span><span class="cf">|</span><span class="vs">driver</span><span class="cf">|</span><span class="vs">registry</span><span class="cf">|</span><span class="vs">process</span><span class="cf">|</span><span class="vs">firewall</span><span class="cf">|</span><span class="vs">bios</span><span class="cf">|</span><span class="vs">boot</span><span class="cf">|</span><span class="vs">path</span><span class="cf">|</span><span class="vs">dll</span><span class="cf">|</span><span class="vs">exe</span><span class="cf">|</span><span class="vs">powershell</span><span class="cf">|</span><span class="vs">cmd</span><span class="cf">|</span><span class="vs">terminal</span><span class="cf">|</span><span class="vs">shell</span><span class="kw">)</span><span class="dv">\b</span><span class="vs">&#39;</span>,</span>
<span id="cb25-292"><a href="#cb25-292" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;IA&#39;</span>: <span class="vs">r&#39;</span><span class="dv">\b</span><span class="kw">(</span><span class="vs">ia</span><span class="cf">|</span><span class="vs">gpt</span><span class="cf">|</span><span class="vs">chatgpt</span><span class="cf">|</span><span class="vs">grok</span><span class="cf">|</span><span class="vs">qwen</span><span class="cf">|</span><span class="vs">deepseek</span><span class="cf">|</span><span class="vs">llm</span><span class="cf">|</span><span class="vs">modelo</span><span class="cf">|</span><span class="vs">prompt</span><span class="cf">|</span><span class="vs">token</span><span class="cf">|</span><span class="vs">embedding</span><span class="cf">|</span><span class="vs">fine-tune</span><span class="cf">|</span><span class="vs">neural</span><span class="cf">|</span><span class="vs">chatbot</span><span class="cf">|</span><span class="vs">intelig√™ncia artificial</span><span class="kw">)</span><span class="dv">\b</span><span class="vs">&#39;</span>,</span>
<span id="cb25-293"><a href="#cb25-293" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Dados&#39;</span>: <span class="vs">r&#39;</span><span class="dv">\b</span><span class="kw">(</span><span class="vs">dados</span><span class="cf">|</span><span class="vs">data</span><span class="cf">|</span><span class="vs">csv</span><span class="cf">|</span><span class="vs">json</span><span class="cf">|</span><span class="vs">pandas</span><span class="cf">|</span><span class="vs">numpy</span><span class="cf">|</span><span class="vs">excel</span><span class="cf">|</span><span class="vs">sql</span><span class="cf">|</span><span class="vs">banco</span><span class="cf">|</span><span class="vs">sqlite</span><span class="cf">|</span><span class="vs">postgres</span><span class="cf">|</span><span class="vs">visualiza√ß√£o</span><span class="cf">|</span><span class="vs">gr√°fico</span><span class="cf">|</span><span class="vs">tabela</span><span class="cf">|</span><span class="vs">an√°lise</span><span class="cf">|</span><span class="vs">etl</span><span class="cf">|</span><span class="vs">dashboard</span><span class="kw">)</span><span class="dv">\b</span><span class="vs">&#39;</span>,</span>
<span id="cb25-294"><a href="#cb25-294" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Geral&#39;</span>: <span class="vs">r&#39;</span><span class="dv">\b</span><span class="kw">(</span><span class="vs">geral</span><span class="cf">|</span><span class="vs">pergunta</span><span class="cf">|</span><span class="vs">ajuda</span><span class="cf">|</span><span class="vs">como fazer</span><span class="cf">|</span><span class="vs">explicar</span><span class="cf">|</span><span class="vs">resumo</span><span class="cf">|</span><span class="vs">tutorial b√°sico</span><span class="kw">)</span><span class="dv">\b</span><span class="vs">&#39;</span></span>
<span id="cb25-295"><a href="#cb25-295" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb25-296"><a href="#cb25-296" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-297"><a href="#cb25-297" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> category, pattern <span class="kw">in</span> patterns.items():</span>
<span id="cb25-298"><a href="#cb25-298" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> re.search(pattern, text, re.IGNORECASE):</span>
<span id="cb25-299"><a href="#cb25-299" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> category</span>
<span id="cb25-300"><a href="#cb25-300" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb25-301"><a href="#cb25-301" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">&#39;Outros&#39;</span></span>
<span id="cb25-302"><a href="#cb25-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-303"><a href="#cb25-303" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> parse_timestamp_for_sorting(<span class="va">self</span>, timestamp) <span class="op">-&gt;</span> datetime:</span>
<span id="cb25-304"><a href="#cb25-304" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> timestamp:</span>
<span id="cb25-305"><a href="#cb25-305" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> datetime.<span class="bu">min</span></span>
<span id="cb25-306"><a href="#cb25-306" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-307"><a href="#cb25-307" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb25-308"><a href="#cb25-308" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">isinstance</span>(timestamp, <span class="bu">str</span>):</span>
<span id="cb25-309"><a href="#cb25-309" aria-hidden="true" tabindex="-1"></a>                clean_ts <span class="op">=</span> timestamp.replace(<span class="st">&#39;T&#39;</span>, <span class="st">&#39; &#39;</span>).split(<span class="st">&#39;.&#39;</span>)[<span class="dv">0</span>].split(<span class="st">&#39;+&#39;</span>)[<span class="dv">0</span>]</span>
<span id="cb25-310"><a href="#cb25-310" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> clean_ts.endswith(<span class="st">&#39;Z&#39;</span>):</span>
<span id="cb25-311"><a href="#cb25-311" aria-hidden="true" tabindex="-1"></a>                    clean_ts <span class="op">=</span> clean_ts[:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb25-312"><a href="#cb25-312" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> datetime.fromisoformat(clean_ts)</span>
<span id="cb25-313"><a href="#cb25-313" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> <span class="bu">isinstance</span>(timestamp, (<span class="bu">int</span>, <span class="bu">float</span>)):</span>
<span id="cb25-314"><a href="#cb25-314" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> datetime.fromtimestamp(timestamp)</span>
<span id="cb25-315"><a href="#cb25-315" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span>:</span>
<span id="cb25-316"><a href="#cb25-316" aria-hidden="true" tabindex="-1"></a>            <span class="cf">pass</span></span>
<span id="cb25-317"><a href="#cb25-317" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-318"><a href="#cb25-318" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> datetime.<span class="bu">min</span></span>
<span id="cb25-319"><a href="#cb25-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-320"><a href="#cb25-320" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> format_timestamp(<span class="va">self</span>, timestamp) <span class="op">-&gt;</span> Optional[<span class="bu">str</span>]:</span>
<span id="cb25-321"><a href="#cb25-321" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> timestamp:</span>
<span id="cb25-322"><a href="#cb25-322" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb25-323"><a href="#cb25-323" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-324"><a href="#cb25-324" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb25-325"><a href="#cb25-325" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">isinstance</span>(timestamp, (<span class="bu">int</span>, <span class="bu">float</span>)):</span>
<span id="cb25-326"><a href="#cb25-326" aria-hidden="true" tabindex="-1"></a>                dt <span class="op">=</span> datetime.fromtimestamp(timestamp)</span>
<span id="cb25-327"><a href="#cb25-327" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> dt.strftime(<span class="st">&#39;%Y-%m-</span><span class="sc">%d</span><span class="st"> %H:%M:%S&#39;</span>)</span>
<span id="cb25-328"><a href="#cb25-328" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> <span class="bu">isinstance</span>(timestamp, <span class="bu">str</span>):</span>
<span id="cb25-329"><a href="#cb25-329" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="st">&#39;T&#39;</span> <span class="kw">in</span> timestamp:</span>
<span id="cb25-330"><a href="#cb25-330" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">return</span> timestamp.replace(<span class="st">&#39;T&#39;</span>, <span class="st">&#39; &#39;</span>).split(<span class="st">&#39;.&#39;</span>)[<span class="dv">0</span>]</span>
<span id="cb25-331"><a href="#cb25-331" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> timestamp</span>
<span id="cb25-332"><a href="#cb25-332" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span>:</span>
<span id="cb25-333"><a href="#cb25-333" aria-hidden="true" tabindex="-1"></a>            <span class="cf">pass</span></span>
<span id="cb25-334"><a href="#cb25-334" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-335"><a href="#cb25-335" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">str</span>(timestamp)</span>
<span id="cb25-336"><a href="#cb25-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-337"><a href="#cb25-337" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_enhanced_markdown_content(<span class="va">self</span>, conversation: Dict[<span class="bu">str</span>, Any]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb25-338"><a href="#cb25-338" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Gera conte√∫do Markdown com preserva√ß√£o total de formata√ß√£o&quot;&quot;&quot;</span></span>
<span id="cb25-339"><a href="#cb25-339" aria-hidden="true" tabindex="-1"></a>        lines <span class="op">=</span> [</span>
<span id="cb25-340"><a href="#cb25-340" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f&quot;# </span><span class="sc">{</span>conversation[<span class="st">&#39;title&#39;</span>]<span class="sc">}</span><span class="ss">&quot;</span>,</span>
<span id="cb25-341"><a href="#cb25-341" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;&quot;</span>,</span>
<span id="cb25-342"><a href="#cb25-342" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;## üìä Informa√ß√µes&quot;</span>,</span>
<span id="cb25-343"><a href="#cb25-343" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f&quot;- **N√∫mero:** #</span><span class="sc">{</span>conversation[<span class="st">&#39;number&#39;</span>]<span class="sc">}</span><span class="ss">&quot;</span>,</span>
<span id="cb25-344"><a href="#cb25-344" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f&quot;- **Origem:** </span><span class="sc">{</span>conversation[<span class="st">&#39;source&#39;</span>]<span class="sc">}</span><span class="ss">&quot;</span>,</span>
<span id="cb25-345"><a href="#cb25-345" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f&quot;- **Categoria:** </span><span class="sc">{</span>conversation[<span class="st">&#39;category&#39;</span>]<span class="sc">}</span><span class="ss">&quot;</span>,</span>
<span id="cb25-346"><a href="#cb25-346" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f&quot;- **ID:** </span><span class="sc">{</span>conversation<span class="sc">.</span>get(<span class="st">&#39;id&#39;</span>, <span class="st">&#39;N/A&#39;</span>)<span class="sc">}</span><span class="ss">&quot;</span>,</span>
<span id="cb25-347"><a href="#cb25-347" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f&quot;- **Criada em:** </span><span class="sc">{</span>conversation<span class="sc">.</span>get(<span class="st">&#39;inserted_at&#39;</span>) <span class="kw">or</span> conversation<span class="sc">.</span>get(<span class="st">&#39;created_at&#39;</span>) <span class="kw">or</span> <span class="st">&#39;N/A&#39;</span><span class="sc">}</span><span class="ss">&quot;</span>,</span>
<span id="cb25-348"><a href="#cb25-348" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb25-349"><a href="#cb25-349" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-350"><a href="#cb25-350" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> conversation.get(<span class="st">&#39;updated_at&#39;</span>):</span>
<span id="cb25-351"><a href="#cb25-351" aria-hidden="true" tabindex="-1"></a>            lines.append(<span class="ss">f&quot;- **Atualizada em:** </span><span class="sc">{</span>conversation[<span class="st">&#39;updated_at&#39;</span>]<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb25-352"><a href="#cb25-352" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-353"><a href="#cb25-353" aria-hidden="true" tabindex="-1"></a>        lines.extend([</span>
<span id="cb25-354"><a href="#cb25-354" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f&quot;- **Total de mensagens:** </span><span class="sc">{</span><span class="bu">len</span>(conversation[<span class="st">&#39;messages&#39;</span>])<span class="sc">}</span><span class="ss">&quot;</span>,</span>
<span id="cb25-355"><a href="#cb25-355" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f&quot;- **Resumo:** </span><span class="sc">{</span>conversation<span class="sc">.</span>get(<span class="st">&#39;summary&#39;</span>, <span class="st">&#39;Sem resumo&#39;</span>)<span class="sc">}</span><span class="ss">&quot;</span>,</span>
<span id="cb25-356"><a href="#cb25-356" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;&quot;</span>,</span>
<span id="cb25-357"><a href="#cb25-357" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;---&quot;</span>,</span>
<span id="cb25-358"><a href="#cb25-358" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;&quot;</span>,</span>
<span id="cb25-359"><a href="#cb25-359" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;## üó®Ô∏è Conversa&quot;</span>,</span>
<span id="cb25-360"><a href="#cb25-360" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;&quot;</span></span>
<span id="cb25-361"><a href="#cb25-361" aria-hidden="true" tabindex="-1"></a>        ])</span>
<span id="cb25-362"><a href="#cb25-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-363"><a href="#cb25-363" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, msg <span class="kw">in</span> <span class="bu">enumerate</span>(conversation[<span class="st">&#39;messages&#39;</span>], <span class="dv">1</span>):</span>
<span id="cb25-364"><a href="#cb25-364" aria-hidden="true" tabindex="-1"></a>            timestamp <span class="op">=</span> <span class="ss">f&quot; *(</span><span class="sc">{</span>msg[<span class="st">&#39;timestamp&#39;</span>]<span class="sc">}</span><span class="ss">)*&quot;</span> <span class="cf">if</span> msg[<span class="st">&#39;timestamp&#39;</span>] <span class="cf">else</span> <span class="st">&quot;&quot;</span></span>
<span id="cb25-365"><a href="#cb25-365" aria-hidden="true" tabindex="-1"></a>            model_info <span class="op">=</span> <span class="ss">f&quot; *[</span><span class="sc">{</span>msg<span class="sc">.</span>get(<span class="st">&#39;model&#39;</span>, <span class="st">&#39;&#39;</span>)<span class="sc">}</span><span class="ss">]*&quot;</span> <span class="cf">if</span> msg.get(<span class="st">&#39;model&#39;</span>) <span class="cf">else</span> <span class="st">&quot;&quot;</span></span>
<span id="cb25-366"><a href="#cb25-366" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-367"><a href="#cb25-367" aria-hidden="true" tabindex="-1"></a>            preserved_content <span class="op">=</span> <span class="va">self</span>.preserve_special_content(msg[<span class="st">&#39;content&#39;</span>])</span>
<span id="cb25-368"><a href="#cb25-368" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-369"><a href="#cb25-369" aria-hidden="true" tabindex="-1"></a>            lines.extend([</span>
<span id="cb25-370"><a href="#cb25-370" aria-hidden="true" tabindex="-1"></a>                <span class="ss">f&quot;### </span><span class="sc">{</span>msg[<span class="st">&#39;author&#39;</span>]<span class="sc">}{</span>timestamp<span class="sc">}{</span>model_info<span class="sc">}</span><span class="ss">&quot;</span>,</span>
<span id="cb25-371"><a href="#cb25-371" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;&quot;</span>,</span>
<span id="cb25-372"><a href="#cb25-372" aria-hidden="true" tabindex="-1"></a>                <span class="ss">f&quot;</span><span class="sc">{</span>preserved_content<span class="sc">}</span><span class="ss">&quot;</span>,</span>
<span id="cb25-373"><a href="#cb25-373" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;&quot;</span></span>
<span id="cb25-374"><a href="#cb25-374" aria-hidden="true" tabindex="-1"></a>            ])</span>
<span id="cb25-375"><a href="#cb25-375" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-376"><a href="#cb25-376" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> j <span class="op">&lt;</span> <span class="bu">len</span>(conversation[<span class="st">&#39;messages&#39;</span>]):</span>
<span id="cb25-377"><a href="#cb25-377" aria-hidden="true" tabindex="-1"></a>                lines.extend([<span class="st">&quot;---&quot;</span>, <span class="st">&quot;&quot;</span>])</span>
<span id="cb25-378"><a href="#cb25-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-379"><a href="#cb25-379" aria-hidden="true" tabindex="-1"></a>        lines.extend([</span>
<span id="cb25-380"><a href="#cb25-380" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;---&quot;</span>,</span>
<span id="cb25-381"><a href="#cb25-381" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;&quot;</span>,</span>
<span id="cb25-382"><a href="#cb25-382" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f&quot;*Conversa exportada do </span><span class="sc">{</span>conversation[<span class="st">&#39;source&#39;</span>]<span class="sc">}</span><span class="ss">*&quot;</span>,</span>
<span id="cb25-383"><a href="#cb25-383" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f&quot;*Processado em: </span><span class="sc">{</span>datetime<span class="sc">.</span>now()<span class="sc">.</span>strftime(<span class="st">&#39;</span><span class="sc">%d</span><span class="st">/%m/%Y %H:%M&#39;</span>)<span class="sc">}</span><span class="ss">*&quot;</span></span>
<span id="cb25-384"><a href="#cb25-384" aria-hidden="true" tabindex="-1"></a>        ])</span>
<span id="cb25-385"><a href="#cb25-385" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-386"><a href="#cb25-386" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>.join(lines)</span>
<span id="cb25-387"><a href="#cb25-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-388"><a href="#cb25-388" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> process_qwen_enhanced(<span class="va">self</span>, path: Path):</span>
<span id="cb25-389"><a href="#cb25-389" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Processa Qwen3 com preserva√ß√£o total de conte√∫do&quot;&quot;&quot;</span></span>
<span id="cb25-390"><a href="#cb25-390" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb25-391"><a href="#cb25-391" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;üß™ [DRY-RUN] Processaria Qwen3: </span><span class="sc">{</span>path<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb25-392"><a href="#cb25-392" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb25-393"><a href="#cb25-393" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-394"><a href="#cb25-394" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb25-395"><a href="#cb25-395" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(path, <span class="st">&#39;r&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb25-396"><a href="#cb25-396" aria-hidden="true" tabindex="-1"></a>                raw <span class="op">=</span> json.load(f)</span>
<span id="cb25-397"><a href="#cb25-397" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb25-398"><a href="#cb25-398" aria-hidden="true" tabindex="-1"></a>            data <span class="op">=</span> raw.get(<span class="st">&#39;data&#39;</span>, [])</span>
<span id="cb25-399"><a href="#cb25-399" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(data, <span class="bu">list</span>):</span>
<span id="cb25-400"><a href="#cb25-400" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;‚ö†Ô∏è  Qwen3: &#39;data&#39; n√£o √© uma lista.&quot;</span>)</span>
<span id="cb25-401"><a href="#cb25-401" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span></span>
<span id="cb25-402"><a href="#cb25-402" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb25-403"><a href="#cb25-403" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;üîç Qwen3: encontradas </span><span class="sc">{</span><span class="bu">len</span>(data)<span class="sc">}</span><span class="ss"> conversas.&quot;</span>)</span>
<span id="cb25-404"><a href="#cb25-404" aria-hidden="true" tabindex="-1"></a>            processed_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb25-405"><a href="#cb25-405" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-406"><a href="#cb25-406" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> i, conv <span class="kw">in</span> <span class="bu">enumerate</span>(data):</span>
<span id="cb25-407"><a href="#cb25-407" aria-hidden="true" tabindex="-1"></a>                title <span class="op">=</span> conv.get(<span class="st">&#39;title&#39;</span>, <span class="ss">f&#39;Conversa_Qwen_</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb25-408"><a href="#cb25-408" aria-hidden="true" tabindex="-1"></a>                title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(title)</span>
<span id="cb25-409"><a href="#cb25-409" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb25-410"><a href="#cb25-410" aria-hidden="true" tabindex="-1"></a>                history <span class="op">=</span> conv.get(<span class="st">&#39;chat&#39;</span>, {}).get(<span class="st">&#39;history&#39;</span>, {})</span>
<span id="cb25-411"><a href="#cb25-411" aria-hidden="true" tabindex="-1"></a>                messages <span class="op">=</span> []</span>
<span id="cb25-412"><a href="#cb25-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-413"><a href="#cb25-413" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="kw">not</span> history:</span>
<span id="cb25-414"><a href="#cb25-414" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">continue</span></span>
<span id="cb25-415"><a href="#cb25-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-416"><a href="#cb25-416" aria-hidden="true" tabindex="-1"></a>                messages_dict <span class="op">=</span> history.get(<span class="st">&#39;messages&#39;</span>, {})</span>
<span id="cb25-417"><a href="#cb25-417" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb25-418"><a href="#cb25-418" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(messages_dict, <span class="bu">dict</span>):</span>
<span id="cb25-419"><a href="#cb25-419" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">continue</span></span>
<span id="cb25-420"><a href="#cb25-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-421"><a href="#cb25-421" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;   üìù Conversa </span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">: &#39;</span><span class="sc">{</span>title<span class="sc">}</span><span class="ss">&#39; - </span><span class="sc">{</span><span class="bu">len</span>(messages_dict)<span class="sc">}</span><span class="ss"> mensagens&quot;</span>)</span>
<span id="cb25-422"><a href="#cb25-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-423"><a href="#cb25-423" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> message_id, message_data <span class="kw">in</span> messages_dict.items():</span>
<span id="cb25-424"><a href="#cb25-424" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(message_data, <span class="bu">dict</span>):</span>
<span id="cb25-425"><a href="#cb25-425" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb25-426"><a href="#cb25-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-427"><a href="#cb25-427" aria-hidden="true" tabindex="-1"></a>                    role <span class="op">=</span> message_data.get(<span class="st">&#39;role&#39;</span>, <span class="st">&#39;&#39;</span>)</span>
<span id="cb25-428"><a href="#cb25-428" aria-hidden="true" tabindex="-1"></a>                    content <span class="op">=</span> message_data.get(<span class="st">&#39;content&#39;</span>, <span class="st">&#39;&#39;</span>)</span>
<span id="cb25-429"><a href="#cb25-429" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb25-430"><a href="#cb25-430" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="kw">not</span> content <span class="kw">or</span> <span class="kw">not</span> role:</span>
<span id="cb25-431"><a href="#cb25-431" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb25-432"><a href="#cb25-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-433"><a href="#cb25-433" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> role <span class="op">==</span> <span class="st">&#39;user&#39;</span>:</span>
<span id="cb25-434"><a href="#cb25-434" aria-hidden="true" tabindex="-1"></a>                        author <span class="op">=</span> <span class="st">&quot;üë§ Utilizador&quot;</span></span>
<span id="cb25-435"><a href="#cb25-435" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">elif</span> role <span class="op">==</span> <span class="st">&#39;assistant&#39;</span>:</span>
<span id="cb25-436"><a href="#cb25-436" aria-hidden="true" tabindex="-1"></a>                        author <span class="op">=</span> <span class="st">&quot;ü§ñ Qwen3&quot;</span></span>
<span id="cb25-437"><a href="#cb25-437" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">else</span>:</span>
<span id="cb25-438"><a href="#cb25-438" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb25-439"><a href="#cb25-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-440"><a href="#cb25-440" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="bu">isinstance</span>(content, <span class="bu">list</span>):</span>
<span id="cb25-441"><a href="#cb25-441" aria-hidden="true" tabindex="-1"></a>                        text_parts <span class="op">=</span> []</span>
<span id="cb25-442"><a href="#cb25-442" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">for</span> block <span class="kw">in</span> content:</span>
<span id="cb25-443"><a href="#cb25-443" aria-hidden="true" tabindex="-1"></a>                            <span class="cf">if</span> <span class="bu">isinstance</span>(block, <span class="bu">dict</span>):</span>
<span id="cb25-444"><a href="#cb25-444" aria-hidden="true" tabindex="-1"></a>                                <span class="cf">if</span> block.get(<span class="st">&#39;type&#39;</span>) <span class="op">==</span> <span class="st">&#39;text&#39;</span>:</span>
<span id="cb25-445"><a href="#cb25-445" aria-hidden="true" tabindex="-1"></a>                                    text_parts.append(block.get(<span class="st">&#39;text&#39;</span>, <span class="st">&#39;&#39;</span>))</span>
<span id="cb25-446"><a href="#cb25-446" aria-hidden="true" tabindex="-1"></a>                                <span class="cf">elif</span> block.get(<span class="st">&#39;type&#39;</span>) <span class="op">==</span> <span class="st">&#39;image&#39;</span>:</span>
<span id="cb25-447"><a href="#cb25-447" aria-hidden="true" tabindex="-1"></a>                                    image_info <span class="op">=</span> block.get(<span class="st">&#39;image&#39;</span>, <span class="st">&#39;&#39;</span>)</span>
<span id="cb25-448"><a href="#cb25-448" aria-hidden="true" tabindex="-1"></a>                                    <span class="cf">if</span> image_info:</span>
<span id="cb25-449"><a href="#cb25-449" aria-hidden="true" tabindex="-1"></a>                                        text_parts.append(<span class="ss">f&quot;![Imagem](</span><span class="sc">{</span>image_info<span class="sc">}</span><span class="ss">)&quot;</span>)</span>
<span id="cb25-450"><a href="#cb25-450" aria-hidden="true" tabindex="-1"></a>                            <span class="cf">elif</span> <span class="bu">isinstance</span>(block, <span class="bu">str</span>):</span>
<span id="cb25-451"><a href="#cb25-451" aria-hidden="true" tabindex="-1"></a>                                text_parts.append(block)</span>
<span id="cb25-452"><a href="#cb25-452" aria-hidden="true" tabindex="-1"></a>                        final_content <span class="op">=</span> <span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>.join(text_parts).strip()</span>
<span id="cb25-453"><a href="#cb25-453" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">else</span>:</span>
<span id="cb25-454"><a href="#cb25-454" aria-hidden="true" tabindex="-1"></a>                        final_content <span class="op">=</span> <span class="bu">str</span>(content).strip()</span>
<span id="cb25-455"><a href="#cb25-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-456"><a href="#cb25-456" aria-hidden="true" tabindex="-1"></a>                    final_content <span class="op">=</span> <span class="va">self</span>.preserve_special_content(final_content)</span>
<span id="cb25-457"><a href="#cb25-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-458"><a href="#cb25-458" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="kw">not</span> final_content <span class="kw">or</span> final_content <span class="op">==</span> <span class="st">&#39;null&#39;</span>:</span>
<span id="cb25-459"><a href="#cb25-459" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb25-460"><a href="#cb25-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-461"><a href="#cb25-461" aria-hidden="true" tabindex="-1"></a>                    messages.append({</span>
<span id="cb25-462"><a href="#cb25-462" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;author&#39;</span>: author,</span>
<span id="cb25-463"><a href="#cb25-463" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;role&#39;</span>: role,</span>
<span id="cb25-464"><a href="#cb25-464" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;content&#39;</span>: final_content,</span>
<span id="cb25-465"><a href="#cb25-465" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;timestamp&#39;</span>: <span class="va">self</span>.format_timestamp(message_data.get(<span class="st">&#39;created_at&#39;</span>)),</span>
<span id="cb25-466"><a href="#cb25-466" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;model&#39;</span>: message_data.get(<span class="st">&#39;model&#39;</span>, <span class="st">&#39;Qwen3&#39;</span>)</span>
<span id="cb25-467"><a href="#cb25-467" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb25-468"><a href="#cb25-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-469"><a href="#cb25-469" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> messages:</span>
<span id="cb25-470"><a href="#cb25-470" aria-hidden="true" tabindex="-1"></a>                    messages.sort(key<span class="op">=</span><span class="kw">lambda</span> x: <span class="va">self</span>.parse_timestamp_for_sorting(x[<span class="st">&#39;timestamp&#39;</span>]))</span>
<span id="cb25-471"><a href="#cb25-471" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb25-472"><a href="#cb25-472" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.all_conversations.append({</span>
<span id="cb25-473"><a href="#cb25-473" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;title&#39;</span>: title,</span>
<span id="cb25-474"><a href="#cb25-474" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;source&#39;</span>: <span class="st">&#39;Qwen3&#39;</span>,</span>
<span id="cb25-475"><a href="#cb25-475" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;id&#39;</span>: conv.get(<span class="st">&#39;id&#39;</span>, <span class="ss">f&#39;qwen_</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">&#39;</span>),</span>
<span id="cb25-476"><a href="#cb25-476" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;inserted_at&#39;</span>: <span class="va">self</span>.format_timestamp(conv.get(<span class="st">&#39;created_at&#39;</span>)),</span>
<span id="cb25-477"><a href="#cb25-477" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;updated_at&#39;</span>: <span class="va">self</span>.format_timestamp(conv.get(<span class="st">&#39;updated_at&#39;</span>)),</span>
<span id="cb25-478"><a href="#cb25-478" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;messages&#39;</span>: messages,</span>
<span id="cb25-479"><a href="#cb25-479" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;summary&#39;</span>: messages[<span class="dv">0</span>][<span class="st">&#39;content&#39;</span>][:<span class="dv">100</span>] <span class="op">+</span> <span class="st">&quot;...&quot;</span> <span class="cf">if</span> messages <span class="cf">else</span> <span class="st">&quot;Sem conte√∫do&quot;</span>,</span>
<span id="cb25-480"><a href="#cb25-480" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;category&#39;</span>: <span class="st">&#39;Geral&#39;</span></span>
<span id="cb25-481"><a href="#cb25-481" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb25-482"><a href="#cb25-482" aria-hidden="true" tabindex="-1"></a>                    processed_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb25-483"><a href="#cb25-483" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="ss">f&quot;   ‚úÖ Adicionada: </span><span class="sc">{</span><span class="bu">len</span>(messages)<span class="sc">}</span><span class="ss"> mensagens&quot;</span>)</span>
<span id="cb25-484"><a href="#cb25-484" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb25-485"><a href="#cb25-485" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ Qwen3: </span><span class="sc">{</span>processed_count<span class="sc">}</span><span class="ss"> conversas processadas.&quot;</span>)</span>
<span id="cb25-486"><a href="#cb25-486" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-487"><a href="#cb25-487" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb25-488"><a href="#cb25-488" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚ùå Erro ao processar Qwen3: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb25-489"><a href="#cb25-489" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb25-490"><a href="#cb25-490" aria-hidden="true" tabindex="-1"></a>                traceback.print_exc()</span>
<span id="cb25-491"><a href="#cb25-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-492"><a href="#cb25-492" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> process_chatgpt(<span class="va">self</span>, path: Path):</span>
<span id="cb25-493"><a href="#cb25-493" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Processa exporta√ß√£o do ChatGPT&quot;&quot;&quot;</span></span>
<span id="cb25-494"><a href="#cb25-494" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb25-495"><a href="#cb25-495" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;üß™ [DRY-RUN] Processaria ChatGPT: </span><span class="sc">{</span>path<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb25-496"><a href="#cb25-496" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb25-497"><a href="#cb25-497" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-498"><a href="#cb25-498" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb25-499"><a href="#cb25-499" aria-hidden="true" tabindex="-1"></a>            temp_dir <span class="op">=</span> tempfile.mkdtemp(prefix<span class="op">=</span><span class="st">&quot;chatgpt_&quot;</span>)</span>
<span id="cb25-500"><a href="#cb25-500" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> zipfile.ZipFile(path, <span class="st">&#39;r&#39;</span>) <span class="im">as</span> z:</span>
<span id="cb25-501"><a href="#cb25-501" aria-hidden="true" tabindex="-1"></a>                z.extractall(temp_dir)</span>
<span id="cb25-502"><a href="#cb25-502" aria-hidden="true" tabindex="-1"></a>            convs_path <span class="op">=</span> Path(temp_dir) <span class="op">/</span> <span class="st">&quot;conversations.json&quot;</span></span>
<span id="cb25-503"><a href="#cb25-503" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> convs_path.exists():</span>
<span id="cb25-504"><a href="#cb25-504" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;‚ùå ChatGPT: conversations.json n√£o encontrado.&quot;</span>)</span>
<span id="cb25-505"><a href="#cb25-505" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span></span>
<span id="cb25-506"><a href="#cb25-506" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb25-507"><a href="#cb25-507" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(convs_path, <span class="st">&#39;r&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb25-508"><a href="#cb25-508" aria-hidden="true" tabindex="-1"></a>                data <span class="op">=</span> json.load(f)</span>
<span id="cb25-509"><a href="#cb25-509" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb25-510"><a href="#cb25-510" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(data, <span class="bu">list</span>):</span>
<span id="cb25-511"><a href="#cb25-511" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;‚ö†Ô∏è  ChatGPT: estrutura inesperada.&quot;</span>)</span>
<span id="cb25-512"><a href="#cb25-512" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span></span>
<span id="cb25-513"><a href="#cb25-513" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb25-514"><a href="#cb25-514" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;üîç ChatGPT: encontradas </span><span class="sc">{</span><span class="bu">len</span>(data)<span class="sc">}</span><span class="ss"> conversas.&quot;</span>)</span>
<span id="cb25-515"><a href="#cb25-515" aria-hidden="true" tabindex="-1"></a>            processed_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb25-516"><a href="#cb25-516" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-517"><a href="#cb25-517" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> i, conv <span class="kw">in</span> <span class="bu">enumerate</span>(data):</span>
<span id="cb25-518"><a href="#cb25-518" aria-hidden="true" tabindex="-1"></a>                title <span class="op">=</span> conv.get(<span class="st">&#39;title&#39;</span>, <span class="ss">f&#39;Conversa_ChatGPT_</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb25-519"><a href="#cb25-519" aria-hidden="true" tabindex="-1"></a>                title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(title)</span>
<span id="cb25-520"><a href="#cb25-520" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb25-521"><a href="#cb25-521" aria-hidden="true" tabindex="-1"></a>                messages <span class="op">=</span> []</span>
<span id="cb25-522"><a href="#cb25-522" aria-hidden="true" tabindex="-1"></a>                mapping <span class="op">=</span> conv.get(<span class="st">&#39;mapping&#39;</span>, {})</span>
<span id="cb25-523"><a href="#cb25-523" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb25-524"><a href="#cb25-524" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> msg_id, node <span class="kw">in</span> mapping.items():</span>
<span id="cb25-525"><a href="#cb25-525" aria-hidden="true" tabindex="-1"></a>                    msg_data <span class="op">=</span> node.get(<span class="st">&#39;message&#39;</span>)</span>
<span id="cb25-526"><a href="#cb25-526" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="kw">not</span> msg_data <span class="kw">or</span> <span class="kw">not</span> <span class="bu">isinstance</span>(msg_data, <span class="bu">dict</span>):</span>
<span id="cb25-527"><a href="#cb25-527" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb25-528"><a href="#cb25-528" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb25-529"><a href="#cb25-529" aria-hidden="true" tabindex="-1"></a>                    author_role <span class="op">=</span> msg_data.get(<span class="st">&#39;author&#39;</span>, {}).get(<span class="st">&#39;role&#39;</span>, <span class="st">&#39;&#39;</span>)</span>
<span id="cb25-530"><a href="#cb25-530" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> author_role <span class="op">==</span> <span class="st">&#39;user&#39;</span>:</span>
<span id="cb25-531"><a href="#cb25-531" aria-hidden="true" tabindex="-1"></a>                        author <span class="op">=</span> <span class="st">&quot;üë§ Utilizador&quot;</span></span>
<span id="cb25-532"><a href="#cb25-532" aria-hidden="true" tabindex="-1"></a>                        role <span class="op">=</span> <span class="st">&#39;user&#39;</span></span>
<span id="cb25-533"><a href="#cb25-533" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">elif</span> author_role <span class="op">==</span> <span class="st">&#39;assistant&#39;</span>:</span>
<span id="cb25-534"><a href="#cb25-534" aria-hidden="true" tabindex="-1"></a>                        author <span class="op">=</span> <span class="st">&quot;ü§ñ ChatGPT&quot;</span></span>
<span id="cb25-535"><a href="#cb25-535" aria-hidden="true" tabindex="-1"></a>                        role <span class="op">=</span> <span class="st">&#39;assistant&#39;</span></span>
<span id="cb25-536"><a href="#cb25-536" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">else</span>:</span>
<span id="cb25-537"><a href="#cb25-537" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb25-538"><a href="#cb25-538" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb25-539"><a href="#cb25-539" aria-hidden="true" tabindex="-1"></a>                    content_parts <span class="op">=</span> []</span>
<span id="cb25-540"><a href="#cb25-540" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">for</span> part <span class="kw">in</span> msg_data.get(<span class="st">&#39;content&#39;</span>, {}).get(<span class="st">&#39;parts&#39;</span>, []):</span>
<span id="cb25-541"><a href="#cb25-541" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">if</span> <span class="bu">isinstance</span>(part, <span class="bu">str</span>):</span>
<span id="cb25-542"><a href="#cb25-542" aria-hidden="true" tabindex="-1"></a>                            content_parts.append(part)</span>
<span id="cb25-543"><a href="#cb25-543" aria-hidden="true" tabindex="-1"></a>                    content <span class="op">=</span> <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>.join(content_parts).strip()</span>
<span id="cb25-544"><a href="#cb25-544" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb25-545"><a href="#cb25-545" aria-hidden="true" tabindex="-1"></a>                    content <span class="op">=</span> <span class="va">self</span>.preserve_special_content(content)</span>
<span id="cb25-546"><a href="#cb25-546" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb25-547"><a href="#cb25-547" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="kw">not</span> content:</span>
<span id="cb25-548"><a href="#cb25-548" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb25-549"><a href="#cb25-549" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb25-550"><a href="#cb25-550" aria-hidden="true" tabindex="-1"></a>                    messages.append({</span>
<span id="cb25-551"><a href="#cb25-551" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;author&#39;</span>: author,</span>
<span id="cb25-552"><a href="#cb25-552" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;role&#39;</span>: role,</span>
<span id="cb25-553"><a href="#cb25-553" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;content&#39;</span>: content,</span>
<span id="cb25-554"><a href="#cb25-554" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;timestamp&#39;</span>: <span class="va">self</span>.format_timestamp(msg_data.get(<span class="st">&#39;create_time&#39;</span>)),</span>
<span id="cb25-555"><a href="#cb25-555" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;model&#39;</span>: msg_data.get(<span class="st">&#39;model&#39;</span>, <span class="st">&#39;ChatGPT&#39;</span>)</span>
<span id="cb25-556"><a href="#cb25-556" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb25-557"><a href="#cb25-557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-558"><a href="#cb25-558" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> messages:</span>
<span id="cb25-559"><a href="#cb25-559" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.all_conversations.append({</span>
<span id="cb25-560"><a href="#cb25-560" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;title&#39;</span>: title,</span>
<span id="cb25-561"><a href="#cb25-561" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;source&#39;</span>: <span class="st">&#39;ChatGPT&#39;</span>,</span>
<span id="cb25-562"><a href="#cb25-562" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;id&#39;</span>: conv.get(<span class="st">&#39;id&#39;</span>, <span class="ss">f&#39;chatgpt_</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">&#39;</span>),</span>
<span id="cb25-563"><a href="#cb25-563" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;inserted_at&#39;</span>: <span class="va">self</span>.format_timestamp(conv.get(<span class="st">&#39;create_time&#39;</span>)),</span>
<span id="cb25-564"><a href="#cb25-564" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;updated_at&#39;</span>: <span class="va">self</span>.format_timestamp(conv.get(<span class="st">&#39;update_time&#39;</span>)),</span>
<span id="cb25-565"><a href="#cb25-565" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;messages&#39;</span>: messages,</span>
<span id="cb25-566"><a href="#cb25-566" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;summary&#39;</span>: messages[<span class="dv">0</span>][<span class="st">&#39;content&#39;</span>][:<span class="dv">100</span>] <span class="op">+</span> <span class="st">&quot;...&quot;</span> <span class="cf">if</span> messages <span class="cf">else</span> <span class="st">&quot;Sem conte√∫do&quot;</span>,</span>
<span id="cb25-567"><a href="#cb25-567" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;category&#39;</span>: <span class="st">&#39;Geral&#39;</span></span>
<span id="cb25-568"><a href="#cb25-568" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb25-569"><a href="#cb25-569" aria-hidden="true" tabindex="-1"></a>                    processed_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb25-570"><a href="#cb25-570" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb25-571"><a href="#cb25-571" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ ChatGPT: </span><span class="sc">{</span>processed_count<span class="sc">}</span><span class="ss"> conversas processadas.&quot;</span>)</span>
<span id="cb25-572"><a href="#cb25-572" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-573"><a href="#cb25-573" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb25-574"><a href="#cb25-574" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚ùå Erro ao processar ChatGPT: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb25-575"><a href="#cb25-575" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb25-576"><a href="#cb25-576" aria-hidden="true" tabindex="-1"></a>                traceback.print_exc()</span>
<span id="cb25-577"><a href="#cb25-577" aria-hidden="true" tabindex="-1"></a>        <span class="cf">finally</span>:</span>
<span id="cb25-578"><a href="#cb25-578" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="st">&#39;temp_dir&#39;</span> <span class="kw">in</span> <span class="bu">locals</span>():</span>
<span id="cb25-579"><a href="#cb25-579" aria-hidden="true" tabindex="-1"></a>                shutil.rmtree(temp_dir, ignore_errors<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb25-580"><a href="#cb25-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-581"><a href="#cb25-581" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> process_deepseek(<span class="va">self</span>, path: Path):</span>
<span id="cb25-582"><a href="#cb25-582" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Processa exporta√ß√£o do DeepSeek&quot;&quot;&quot;</span></span>
<span id="cb25-583"><a href="#cb25-583" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb25-584"><a href="#cb25-584" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;üß™ [DRY-RUN] Processaria DeepSeek: </span><span class="sc">{</span>path<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb25-585"><a href="#cb25-585" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb25-586"><a href="#cb25-586" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-587"><a href="#cb25-587" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb25-588"><a href="#cb25-588" aria-hidden="true" tabindex="-1"></a>            temp_dir <span class="op">=</span> tempfile.mkdtemp(prefix<span class="op">=</span><span class="st">&quot;deepseek_&quot;</span>)</span>
<span id="cb25-589"><a href="#cb25-589" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> zipfile.ZipFile(path, <span class="st">&#39;r&#39;</span>) <span class="im">as</span> z:</span>
<span id="cb25-590"><a href="#cb25-590" aria-hidden="true" tabindex="-1"></a>                z.extractall(temp_dir)</span>
<span id="cb25-591"><a href="#cb25-591" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb25-592"><a href="#cb25-592" aria-hidden="true" tabindex="-1"></a>            convs_path <span class="op">=</span> Path(temp_dir) <span class="op">/</span> <span class="st">&quot;conversations.json&quot;</span></span>
<span id="cb25-593"><a href="#cb25-593" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> convs_path.exists():</span>
<span id="cb25-594"><a href="#cb25-594" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;‚ùå DeepSeek: conversations.json n√£o encontrado.&quot;</span>)</span>
<span id="cb25-595"><a href="#cb25-595" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span></span>
<span id="cb25-596"><a href="#cb25-596" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb25-597"><a href="#cb25-597" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(convs_path, <span class="st">&#39;r&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb25-598"><a href="#cb25-598" aria-hidden="true" tabindex="-1"></a>                raw_data <span class="op">=</span> json.load(f)</span>
<span id="cb25-599"><a href="#cb25-599" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb25-600"><a href="#cb25-600" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">isinstance</span>(raw_data, <span class="bu">list</span>):</span>
<span id="cb25-601"><a href="#cb25-601" aria-hidden="true" tabindex="-1"></a>                data <span class="op">=</span> raw_data</span>
<span id="cb25-602"><a href="#cb25-602" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> <span class="bu">isinstance</span>(raw_data, <span class="bu">dict</span>) <span class="kw">and</span> <span class="st">&#39;data&#39;</span> <span class="kw">in</span> raw_data:</span>
<span id="cb25-603"><a href="#cb25-603" aria-hidden="true" tabindex="-1"></a>                data <span class="op">=</span> raw_data[<span class="st">&#39;data&#39;</span>]</span>
<span id="cb25-604"><a href="#cb25-604" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb25-605"><a href="#cb25-605" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;‚ö†Ô∏è  DeepSeek: estrutura inesperada.&quot;</span>)</span>
<span id="cb25-606"><a href="#cb25-606" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span></span>
<span id="cb25-607"><a href="#cb25-607" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb25-608"><a href="#cb25-608" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(data, <span class="bu">list</span>):</span>
<span id="cb25-609"><a href="#cb25-609" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;‚ö†Ô∏è  DeepSeek: &#39;data&#39; n√£o √© uma lista.&quot;</span>)</span>
<span id="cb25-610"><a href="#cb25-610" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span></span>
<span id="cb25-611"><a href="#cb25-611" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb25-612"><a href="#cb25-612" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;üîç DeepSeek: encontradas </span><span class="sc">{</span><span class="bu">len</span>(data)<span class="sc">}</span><span class="ss"> conversas.&quot;</span>)</span>
<span id="cb25-613"><a href="#cb25-613" aria-hidden="true" tabindex="-1"></a>            processed_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb25-614"><a href="#cb25-614" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-615"><a href="#cb25-615" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> i, conv <span class="kw">in</span> <span class="bu">enumerate</span>(data):</span>
<span id="cb25-616"><a href="#cb25-616" aria-hidden="true" tabindex="-1"></a>                title <span class="op">=</span> conv.get(<span class="st">&#39;title&#39;</span>, <span class="ss">f&#39;Conversa_DeepSeek_</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb25-617"><a href="#cb25-617" aria-hidden="true" tabindex="-1"></a>                title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(title)</span>
<span id="cb25-618"><a href="#cb25-618" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb25-619"><a href="#cb25-619" aria-hidden="true" tabindex="-1"></a>                messages <span class="op">=</span> []</span>
<span id="cb25-620"><a href="#cb25-620" aria-hidden="true" tabindex="-1"></a>                mapping <span class="op">=</span> conv.get(<span class="st">&#39;mapping&#39;</span>, {})</span>
<span id="cb25-621"><a href="#cb25-621" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb25-622"><a href="#cb25-622" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> node_id, node <span class="kw">in</span> mapping.items():</span>
<span id="cb25-623"><a href="#cb25-623" aria-hidden="true" tabindex="-1"></a>                    msg_data <span class="op">=</span> node.get(<span class="st">&#39;message&#39;</span>)</span>
<span id="cb25-624"><a href="#cb25-624" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="kw">not</span> msg_data <span class="kw">or</span> <span class="kw">not</span> <span class="bu">isinstance</span>(msg_data, <span class="bu">dict</span>):</span>
<span id="cb25-625"><a href="#cb25-625" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb25-626"><a href="#cb25-626" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb25-627"><a href="#cb25-627" aria-hidden="true" tabindex="-1"></a>                    fragments <span class="op">=</span> msg_data.get(<span class="st">&#39;fragments&#39;</span>, [])</span>
<span id="cb25-628"><a href="#cb25-628" aria-hidden="true" tabindex="-1"></a>                    content_parts <span class="op">=</span> []</span>
<span id="cb25-629"><a href="#cb25-629" aria-hidden="true" tabindex="-1"></a>                    msg_type <span class="op">=</span> <span class="va">None</span></span>
<span id="cb25-630"><a href="#cb25-630" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb25-631"><a href="#cb25-631" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">for</span> frag <span class="kw">in</span> fragments:</span>
<span id="cb25-632"><a href="#cb25-632" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">if</span> <span class="bu">isinstance</span>(frag, <span class="bu">dict</span>):</span>
<span id="cb25-633"><a href="#cb25-633" aria-hidden="true" tabindex="-1"></a>                            frag_type <span class="op">=</span> frag.get(<span class="st">&#39;type&#39;</span>, <span class="st">&#39;&#39;</span>).upper()</span>
<span id="cb25-634"><a href="#cb25-634" aria-hidden="true" tabindex="-1"></a>                            <span class="cf">if</span> frag_type <span class="kw">in</span> (<span class="st">&#39;REQUEST&#39;</span>, <span class="st">&#39;RESPONSE&#39;</span>):</span>
<span id="cb25-635"><a href="#cb25-635" aria-hidden="true" tabindex="-1"></a>                                msg_type <span class="op">=</span> frag_type</span>
<span id="cb25-636"><a href="#cb25-636" aria-hidden="true" tabindex="-1"></a>                            text <span class="op">=</span> frag.get(<span class="st">&#39;text&#39;</span>, <span class="st">&#39;&#39;</span>)</span>
<span id="cb25-637"><a href="#cb25-637" aria-hidden="true" tabindex="-1"></a>                            <span class="cf">if</span> text:</span>
<span id="cb25-638"><a href="#cb25-638" aria-hidden="true" tabindex="-1"></a>                                content_parts.append(text)</span>
<span id="cb25-639"><a href="#cb25-639" aria-hidden="true" tabindex="-1"></a>                            content <span class="op">=</span> frag.get(<span class="st">&#39;content&#39;</span>, <span class="st">&#39;&#39;</span>)</span>
<span id="cb25-640"><a href="#cb25-640" aria-hidden="true" tabindex="-1"></a>                            <span class="cf">if</span> content:</span>
<span id="cb25-641"><a href="#cb25-641" aria-hidden="true" tabindex="-1"></a>                                <span class="cf">if</span> <span class="bu">isinstance</span>(content, <span class="bu">list</span>):</span>
<span id="cb25-642"><a href="#cb25-642" aria-hidden="true" tabindex="-1"></a>                                    <span class="cf">for</span> item <span class="kw">in</span> content:</span>
<span id="cb25-643"><a href="#cb25-643" aria-hidden="true" tabindex="-1"></a>                                        <span class="cf">if</span> <span class="bu">isinstance</span>(item, <span class="bu">str</span>):</span>
<span id="cb25-644"><a href="#cb25-644" aria-hidden="true" tabindex="-1"></a>                                            content_parts.append(item)</span>
<span id="cb25-645"><a href="#cb25-645" aria-hidden="true" tabindex="-1"></a>                                        <span class="cf">elif</span> <span class="bu">isinstance</span>(item, <span class="bu">dict</span>):</span>
<span id="cb25-646"><a href="#cb25-646" aria-hidden="true" tabindex="-1"></a>                                            item_text <span class="op">=</span> item.get(<span class="st">&#39;text&#39;</span>, <span class="st">&#39;&#39;</span>)</span>
<span id="cb25-647"><a href="#cb25-647" aria-hidden="true" tabindex="-1"></a>                                            <span class="cf">if</span> item_text:</span>
<span id="cb25-648"><a href="#cb25-648" aria-hidden="true" tabindex="-1"></a>                                                content_parts.append(<span class="bu">str</span>(item_text))</span>
<span id="cb25-649"><a href="#cb25-649" aria-hidden="true" tabindex="-1"></a>                                <span class="cf">else</span>:</span>
<span id="cb25-650"><a href="#cb25-650" aria-hidden="true" tabindex="-1"></a>                                    content_parts.append(<span class="bu">str</span>(content))</span>
<span id="cb25-651"><a href="#cb25-651" aria-hidden="true" tabindex="-1"></a>                                    </span>
<span id="cb25-652"><a href="#cb25-652" aria-hidden="true" tabindex="-1"></a>                    content <span class="op">=</span> <span class="st">&#39; &#39;</span>.join(content_parts).strip()</span>
<span id="cb25-653"><a href="#cb25-653" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb25-654"><a href="#cb25-654" aria-hidden="true" tabindex="-1"></a>                    content <span class="op">=</span> <span class="va">self</span>.preserve_special_content(content)</span>
<span id="cb25-655"><a href="#cb25-655" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb25-656"><a href="#cb25-656" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="kw">not</span> content:</span>
<span id="cb25-657"><a href="#cb25-657" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb25-658"><a href="#cb25-658" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb25-659"><a href="#cb25-659" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> msg_type <span class="op">==</span> <span class="st">&#39;REQUEST&#39;</span>:</span>
<span id="cb25-660"><a href="#cb25-660" aria-hidden="true" tabindex="-1"></a>                        author <span class="op">=</span> <span class="st">&quot;üë§ Utilizador&quot;</span></span>
<span id="cb25-661"><a href="#cb25-661" aria-hidden="true" tabindex="-1"></a>                        role <span class="op">=</span> <span class="st">&#39;user&#39;</span></span>
<span id="cb25-662"><a href="#cb25-662" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">else</span>:</span>
<span id="cb25-663"><a href="#cb25-663" aria-hidden="true" tabindex="-1"></a>                        author <span class="op">=</span> <span class="st">&quot;ü§ñ DeepSeek&quot;</span></span>
<span id="cb25-664"><a href="#cb25-664" aria-hidden="true" tabindex="-1"></a>                        role <span class="op">=</span> <span class="st">&#39;assistant&#39;</span></span>
<span id="cb25-665"><a href="#cb25-665" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb25-666"><a href="#cb25-666" aria-hidden="true" tabindex="-1"></a>                    messages.append({</span>
<span id="cb25-667"><a href="#cb25-667" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;author&#39;</span>: author,</span>
<span id="cb25-668"><a href="#cb25-668" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;role&#39;</span>: role,</span>
<span id="cb25-669"><a href="#cb25-669" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;content&#39;</span>: content,</span>
<span id="cb25-670"><a href="#cb25-670" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;timestamp&#39;</span>: <span class="va">self</span>.format_timestamp(msg_data.get(<span class="st">&#39;inserted_at&#39;</span>)),</span>
<span id="cb25-671"><a href="#cb25-671" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;model&#39;</span>: msg_data.get(<span class="st">&#39;model&#39;</span>, <span class="st">&#39;DeepSeek&#39;</span>)</span>
<span id="cb25-672"><a href="#cb25-672" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb25-673"><a href="#cb25-673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-674"><a href="#cb25-674" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> messages:</span>
<span id="cb25-675"><a href="#cb25-675" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.all_conversations.append({</span>
<span id="cb25-676"><a href="#cb25-676" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;title&#39;</span>: title,</span>
<span id="cb25-677"><a href="#cb25-677" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;source&#39;</span>: <span class="st">&#39;DeepSeek&#39;</span>,</span>
<span id="cb25-678"><a href="#cb25-678" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;id&#39;</span>: conv.get(<span class="st">&#39;id&#39;</span>, <span class="ss">f&#39;deepseek_</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">&#39;</span>),</span>
<span id="cb25-679"><a href="#cb25-679" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;inserted_at&#39;</span>: <span class="va">self</span>.format_timestamp(conv.get(<span class="st">&#39;inserted_at&#39;</span>)),</span>
<span id="cb25-680"><a href="#cb25-680" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;updated_at&#39;</span>: <span class="va">self</span>.format_timestamp(conv.get(<span class="st">&#39;updated_at&#39;</span>)),</span>
<span id="cb25-681"><a href="#cb25-681" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;messages&#39;</span>: messages,</span>
<span id="cb25-682"><a href="#cb25-682" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;summary&#39;</span>: messages[<span class="dv">0</span>][<span class="st">&#39;content&#39;</span>][:<span class="dv">100</span>] <span class="op">+</span> <span class="st">&quot;...&quot;</span> <span class="cf">if</span> messages <span class="cf">else</span> <span class="st">&quot;Sem conte√∫do&quot;</span>,</span>
<span id="cb25-683"><a href="#cb25-683" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;category&#39;</span>: <span class="st">&#39;Geral&#39;</span></span>
<span id="cb25-684"><a href="#cb25-684" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb25-685"><a href="#cb25-685" aria-hidden="true" tabindex="-1"></a>                    processed_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb25-686"><a href="#cb25-686" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb25-687"><a href="#cb25-687" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ DeepSeek: </span><span class="sc">{</span>processed_count<span class="sc">}</span><span class="ss"> conversas processadas.&quot;</span>)</span>
<span id="cb25-688"><a href="#cb25-688" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-689"><a href="#cb25-689" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb25-690"><a href="#cb25-690" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚ùå Erro ao processar DeepSeek: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb25-691"><a href="#cb25-691" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb25-692"><a href="#cb25-692" aria-hidden="true" tabindex="-1"></a>                traceback.print_exc()</span>
<span id="cb25-693"><a href="#cb25-693" aria-hidden="true" tabindex="-1"></a>        <span class="cf">finally</span>:</span>
<span id="cb25-694"><a href="#cb25-694" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="st">&#39;temp_dir&#39;</span> <span class="kw">in</span> <span class="bu">locals</span>():</span>
<span id="cb25-695"><a href="#cb25-695" aria-hidden="true" tabindex="-1"></a>                shutil.rmtree(temp_dir, ignore_errors<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb25-696"><a href="#cb25-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-697"><a href="#cb25-697" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> process_grok(<span class="va">self</span>, path: Path):</span>
<span id="cb25-698"><a href="#cb25-698" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Processa exporta√ß√£o do Grok&quot;&quot;&quot;</span></span>
<span id="cb25-699"><a href="#cb25-699" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb25-700"><a href="#cb25-700" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;üß™ [DRY-RUN] Processaria Grok: </span><span class="sc">{</span>path<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb25-701"><a href="#cb25-701" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb25-702"><a href="#cb25-702" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-703"><a href="#cb25-703" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb25-704"><a href="#cb25-704" aria-hidden="true" tabindex="-1"></a>            temp_dir <span class="op">=</span> tempfile.mkdtemp(prefix<span class="op">=</span><span class="st">&quot;grok_&quot;</span>)</span>
<span id="cb25-705"><a href="#cb25-705" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> zipfile.ZipFile(path, <span class="st">&#39;r&#39;</span>) <span class="im">as</span> z:</span>
<span id="cb25-706"><a href="#cb25-706" aria-hidden="true" tabindex="-1"></a>                z.extractall(temp_dir)</span>
<span id="cb25-707"><a href="#cb25-707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-708"><a href="#cb25-708" aria-hidden="true" tabindex="-1"></a>            target_file <span class="op">=</span> <span class="va">None</span></span>
<span id="cb25-709"><a href="#cb25-709" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> root, _, files <span class="kw">in</span> os.walk(temp_dir):</span>
<span id="cb25-710"><a href="#cb25-710" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> <span class="bu">file</span> <span class="kw">in</span> files:</span>
<span id="cb25-711"><a href="#cb25-711" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="bu">file</span> <span class="op">==</span> <span class="st">&quot;prod-grok-backend.json&quot;</span>:</span>
<span id="cb25-712"><a href="#cb25-712" aria-hidden="true" tabindex="-1"></a>                        target_file <span class="op">=</span> Path(root) <span class="op">/</span> <span class="bu">file</span></span>
<span id="cb25-713"><a href="#cb25-713" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">break</span></span>
<span id="cb25-714"><a href="#cb25-714" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> target_file:</span>
<span id="cb25-715"><a href="#cb25-715" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">break</span></span>
<span id="cb25-716"><a href="#cb25-716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-717"><a href="#cb25-717" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> target_file:</span>
<span id="cb25-718"><a href="#cb25-718" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;‚ùå Grok: ficheiro &#39;prod-grok-backend.json&#39; n√£o encontrado no ZIP.&quot;</span>)</span>
<span id="cb25-719"><a href="#cb25-719" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span></span>
<span id="cb25-720"><a href="#cb25-720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-721"><a href="#cb25-721" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;üîç Grok: carregando </span><span class="sc">{</span>target_file<span class="sc">.</span>name<span class="sc">}</span><span class="ss">...&quot;</span>)</span>
<span id="cb25-722"><a href="#cb25-722" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(target_file, <span class="st">&#39;r&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb25-723"><a href="#cb25-723" aria-hidden="true" tabindex="-1"></a>                data <span class="op">=</span> json.load(f)</span>
<span id="cb25-724"><a href="#cb25-724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-725"><a href="#cb25-725" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(data, <span class="bu">dict</span>) <span class="kw">or</span> <span class="st">&#39;conversations&#39;</span> <span class="kw">not</span> <span class="kw">in</span> data:</span>
<span id="cb25-726"><a href="#cb25-726" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;‚ùå Grok: estrutura inesperada ‚Äî chave &#39;conversations&#39; n√£o encontrada.&quot;</span>)</span>
<span id="cb25-727"><a href="#cb25-727" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span></span>
<span id="cb25-728"><a href="#cb25-728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-729"><a href="#cb25-729" aria-hidden="true" tabindex="-1"></a>            conversations_list <span class="op">=</span> data[<span class="st">&#39;conversations&#39;</span>]</span>
<span id="cb25-730"><a href="#cb25-730" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(conversations_list, <span class="bu">list</span>):</span>
<span id="cb25-731"><a href="#cb25-731" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;‚ùå Grok: &#39;conversations&#39; n√£o √© uma lista.&quot;</span>)</span>
<span id="cb25-732"><a href="#cb25-732" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span></span>
<span id="cb25-733"><a href="#cb25-733" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-734"><a href="#cb25-734" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;üìä Grok: encontradas </span><span class="sc">{</span><span class="bu">len</span>(conversations_list)<span class="sc">}</span><span class="ss"> conversas.&quot;</span>)</span>
<span id="cb25-735"><a href="#cb25-735" aria-hidden="true" tabindex="-1"></a>            total_convs <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb25-736"><a href="#cb25-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-737"><a href="#cb25-737" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> item <span class="kw">in</span> conversations_list:</span>
<span id="cb25-738"><a href="#cb25-738" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(item, <span class="bu">dict</span>):</span>
<span id="cb25-739"><a href="#cb25-739" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">continue</span></span>
<span id="cb25-740"><a href="#cb25-740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-741"><a href="#cb25-741" aria-hidden="true" tabindex="-1"></a>                conv_meta <span class="op">=</span> item.get(<span class="st">&#39;conversation&#39;</span>)</span>
<span id="cb25-742"><a href="#cb25-742" aria-hidden="true" tabindex="-1"></a>                responses <span class="op">=</span> item.get(<span class="st">&#39;responses&#39;</span>, [])</span>
<span id="cb25-743"><a href="#cb25-743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-744"><a href="#cb25-744" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(conv_meta, <span class="bu">dict</span>) <span class="kw">or</span> <span class="kw">not</span> <span class="bu">isinstance</span>(responses, <span class="bu">list</span>) <span class="kw">or</span> <span class="kw">not</span> responses:</span>
<span id="cb25-745"><a href="#cb25-745" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">continue</span></span>
<span id="cb25-746"><a href="#cb25-746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-747"><a href="#cb25-747" aria-hidden="true" tabindex="-1"></a>                conv_id <span class="op">=</span> conv_meta.get(<span class="st">&#39;id&#39;</span>)</span>
<span id="cb25-748"><a href="#cb25-748" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="kw">not</span> conv_id:</span>
<span id="cb25-749"><a href="#cb25-749" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">continue</span></span>
<span id="cb25-750"><a href="#cb25-750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-751"><a href="#cb25-751" aria-hidden="true" tabindex="-1"></a>                title <span class="op">=</span> conv_meta.get(<span class="st">&#39;title&#39;</span>, <span class="ss">f&quot;Conversa Grok </span><span class="sc">{</span>total_convs <span class="op">+</span> <span class="dv">1</span><span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb25-752"><a href="#cb25-752" aria-hidden="true" tabindex="-1"></a>                title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(title)</span>
<span id="cb25-753"><a href="#cb25-753" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb25-754"><a href="#cb25-754" aria-hidden="true" tabindex="-1"></a>                create_time_str <span class="op">=</span> conv_meta.get(<span class="st">&#39;create_time&#39;</span>)</span>
<span id="cb25-755"><a href="#cb25-755" aria-hidden="true" tabindex="-1"></a>                modify_time_str <span class="op">=</span> conv_meta.get(<span class="st">&#39;modify_time&#39;</span>)</span>
<span id="cb25-756"><a href="#cb25-756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-757"><a href="#cb25-757" aria-hidden="true" tabindex="-1"></a>                <span class="kw">def</span> format_iso_timestamp(ts_str):</span>
<span id="cb25-758"><a href="#cb25-758" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="kw">not</span> ts_str:</span>
<span id="cb25-759"><a href="#cb25-759" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb25-760"><a href="#cb25-760" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">try</span>:</span>
<span id="cb25-761"><a href="#cb25-761" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">if</span> <span class="st">&#39;.&#39;</span> <span class="kw">in</span> ts_str:</span>
<span id="cb25-762"><a href="#cb25-762" aria-hidden="true" tabindex="-1"></a>                            ts_str <span class="op">=</span> ts_str.split(<span class="st">&#39;.&#39;</span>)[<span class="dv">0</span>] <span class="op">+</span> <span class="st">&#39;Z&#39;</span></span>
<span id="cb25-763"><a href="#cb25-763" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">return</span> <span class="va">self</span>.format_timestamp(ts_str)</span>
<span id="cb25-764"><a href="#cb25-764" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">except</span>:</span>
<span id="cb25-765"><a href="#cb25-765" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">return</span> <span class="bu">str</span>(ts_str)</span>
<span id="cb25-766"><a href="#cb25-766" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-767"><a href="#cb25-767" aria-hidden="true" tabindex="-1"></a>                inserted_at <span class="op">=</span> format_iso_timestamp(create_time_str)</span>
<span id="cb25-768"><a href="#cb25-768" aria-hidden="true" tabindex="-1"></a>                updated_at <span class="op">=</span> format_iso_timestamp(modify_time_str)</span>
<span id="cb25-769"><a href="#cb25-769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-770"><a href="#cb25-770" aria-hidden="true" tabindex="-1"></a>                messages <span class="op">=</span> []</span>
<span id="cb25-771"><a href="#cb25-771" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> resp <span class="kw">in</span> responses:</span>
<span id="cb25-772"><a href="#cb25-772" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(resp, <span class="bu">dict</span>):</span>
<span id="cb25-773"><a href="#cb25-773" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb25-774"><a href="#cb25-774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-775"><a href="#cb25-775" aria-hidden="true" tabindex="-1"></a>                    resp_data <span class="op">=</span> resp.get(<span class="st">&#39;response&#39;</span>)</span>
<span id="cb25-776"><a href="#cb25-776" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(resp_data, <span class="bu">dict</span>):</span>
<span id="cb25-777"><a href="#cb25-777" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb25-778"><a href="#cb25-778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-779"><a href="#cb25-779" aria-hidden="true" tabindex="-1"></a>                    sender <span class="op">=</span> resp_data.get(<span class="st">&#39;sender&#39;</span>, <span class="st">&#39;&#39;</span>).upper()</span>
<span id="cb25-780"><a href="#cb25-780" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> sender <span class="op">==</span> <span class="st">&#39;HUMAN&#39;</span>:</span>
<span id="cb25-781"><a href="#cb25-781" aria-hidden="true" tabindex="-1"></a>                        author <span class="op">=</span> <span class="st">&quot;üë§ Utilizador&quot;</span></span>
<span id="cb25-782"><a href="#cb25-782" aria-hidden="true" tabindex="-1"></a>                        role <span class="op">=</span> <span class="st">&quot;user&quot;</span></span>
<span id="cb25-783"><a href="#cb25-783" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">elif</span> sender <span class="op">==</span> <span class="st">&#39;ASSISTANT&#39;</span>:</span>
<span id="cb25-784"><a href="#cb25-784" aria-hidden="true" tabindex="-1"></a>                        author <span class="op">=</span> <span class="st">&quot;ü§ñ Grok&quot;</span></span>
<span id="cb25-785"><a href="#cb25-785" aria-hidden="true" tabindex="-1"></a>                        role <span class="op">=</span> <span class="st">&quot;assistant&quot;</span></span>
<span id="cb25-786"><a href="#cb25-786" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">else</span>:</span>
<span id="cb25-787"><a href="#cb25-787" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb25-788"><a href="#cb25-788" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-789"><a href="#cb25-789" aria-hidden="true" tabindex="-1"></a>                    content <span class="op">=</span> <span class="bu">str</span>(resp_data.get(<span class="st">&#39;message&#39;</span>, <span class="st">&#39;&#39;</span>)).strip()</span>
<span id="cb25-790"><a href="#cb25-790" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb25-791"><a href="#cb25-791" aria-hidden="true" tabindex="-1"></a>                    content <span class="op">=</span> <span class="va">self</span>.preserve_special_content(content)</span>
<span id="cb25-792"><a href="#cb25-792" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb25-793"><a href="#cb25-793" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="kw">not</span> content:</span>
<span id="cb25-794"><a href="#cb25-794" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb25-795"><a href="#cb25-795" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-796"><a href="#cb25-796" aria-hidden="true" tabindex="-1"></a>                    create_time <span class="op">=</span> resp_data.get(<span class="st">&#39;create_time&#39;</span>)</span>
<span id="cb25-797"><a href="#cb25-797" aria-hidden="true" tabindex="-1"></a>                    timestamp_ms <span class="op">=</span> <span class="va">None</span></span>
<span id="cb25-798"><a href="#cb25-798" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="bu">isinstance</span>(create_time, <span class="bu">dict</span>) <span class="kw">and</span> <span class="st">&#39;$date&#39;</span> <span class="kw">in</span> create_time:</span>
<span id="cb25-799"><a href="#cb25-799" aria-hidden="true" tabindex="-1"></a>                        date_obj <span class="op">=</span> create_time[<span class="st">&#39;$date&#39;</span>]</span>
<span id="cb25-800"><a href="#cb25-800" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">if</span> <span class="bu">isinstance</span>(date_obj, <span class="bu">dict</span>) <span class="kw">and</span> <span class="st">&#39;$numberLong&#39;</span> <span class="kw">in</span> date_obj:</span>
<span id="cb25-801"><a href="#cb25-801" aria-hidden="true" tabindex="-1"></a>                            <span class="cf">try</span>:</span>
<span id="cb25-802"><a href="#cb25-802" aria-hidden="true" tabindex="-1"></a>                                timestamp_ms <span class="op">=</span> <span class="bu">int</span>(date_obj[<span class="st">&#39;$numberLong&#39;</span>])</span>
<span id="cb25-803"><a href="#cb25-803" aria-hidden="true" tabindex="-1"></a>                            <span class="cf">except</span>:</span>
<span id="cb25-804"><a href="#cb25-804" aria-hidden="true" tabindex="-1"></a>                                <span class="cf">pass</span></span>
<span id="cb25-805"><a href="#cb25-805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-806"><a href="#cb25-806" aria-hidden="true" tabindex="-1"></a>                    messages.append({</span>
<span id="cb25-807"><a href="#cb25-807" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;author&#39;</span>: author,</span>
<span id="cb25-808"><a href="#cb25-808" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;role&#39;</span>: role,</span>
<span id="cb25-809"><a href="#cb25-809" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;content&#39;</span>: content,</span>
<span id="cb25-810"><a href="#cb25-810" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;timestamp&#39;</span>: <span class="va">self</span>.format_timestamp(timestamp_ms <span class="op">/</span> <span class="fl">1000.0</span> <span class="cf">if</span> timestamp_ms <span class="cf">else</span> <span class="va">None</span>),</span>
<span id="cb25-811"><a href="#cb25-811" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;model&#39;</span>: <span class="st">&#39;Grok&#39;</span></span>
<span id="cb25-812"><a href="#cb25-812" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb25-813"><a href="#cb25-813" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-814"><a href="#cb25-814" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> messages:</span>
<span id="cb25-815"><a href="#cb25-815" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.all_conversations.append({</span>
<span id="cb25-816"><a href="#cb25-816" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;title&#39;</span>: title,</span>
<span id="cb25-817"><a href="#cb25-817" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;source&#39;</span>: <span class="st">&#39;Grok&#39;</span>,</span>
<span id="cb25-818"><a href="#cb25-818" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;id&#39;</span>: conv_id,</span>
<span id="cb25-819"><a href="#cb25-819" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;inserted_at&#39;</span>: inserted_at,</span>
<span id="cb25-820"><a href="#cb25-820" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;updated_at&#39;</span>: updated_at,</span>
<span id="cb25-821"><a href="#cb25-821" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;messages&#39;</span>: messages,</span>
<span id="cb25-822"><a href="#cb25-822" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;summary&#39;</span>: messages[<span class="dv">0</span>][<span class="st">&#39;content&#39;</span>][:<span class="dv">100</span>] <span class="op">+</span> <span class="st">&quot;...&quot;</span> <span class="cf">if</span> messages <span class="cf">else</span> <span class="st">&quot;Sem conte√∫do&quot;</span>,</span>
<span id="cb25-823"><a href="#cb25-823" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;category&#39;</span>: <span class="st">&#39;Geral&#39;</span></span>
<span id="cb25-824"><a href="#cb25-824" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb25-825"><a href="#cb25-825" aria-hidden="true" tabindex="-1"></a>                    total_convs <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb25-826"><a href="#cb25-826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-827"><a href="#cb25-827" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> total_convs <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb25-828"><a href="#cb25-828" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ Grok: processadas </span><span class="sc">{</span>total_convs<span class="sc">}</span><span class="ss"> conversas.&quot;</span>)</span>
<span id="cb25-829"><a href="#cb25-829" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb25-830"><a href="#cb25-830" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;‚ùå Grok: nenhuma conversa v√°lida encontrada.&quot;</span>)</span>
<span id="cb25-831"><a href="#cb25-831" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-832"><a href="#cb25-832" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb25-833"><a href="#cb25-833" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;‚ùå Erro ao processar Grok: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb25-834"><a href="#cb25-834" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb25-835"><a href="#cb25-835" aria-hidden="true" tabindex="-1"></a>                traceback.print_exc()</span>
<span id="cb25-836"><a href="#cb25-836" aria-hidden="true" tabindex="-1"></a>        <span class="cf">finally</span>:</span>
<span id="cb25-837"><a href="#cb25-837" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="st">&#39;temp_dir&#39;</span> <span class="kw">in</span> <span class="bu">locals</span>():</span>
<span id="cb25-838"><a href="#cb25-838" aria-hidden="true" tabindex="-1"></a>                shutil.rmtree(temp_dir, ignore_errors<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb25-839"><a href="#cb25-839" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-840"><a href="#cb25-840" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> save_as_markdown_enhanced(<span class="va">self</span>):</span>
<span id="cb25-841"><a href="#cb25-841" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Salva conversas com preserva√ß√£o total de formata√ß√£o&quot;&quot;&quot;</span></span>
<span id="cb25-842"><a href="#cb25-842" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb25-843"><a href="#cb25-843" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;üß™ [DRY-RUN] Markdowns seriam criados:&quot;</span>)</span>
<span id="cb25-844"><a href="#cb25-844" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> conv <span class="kw">in</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb25-845"><a href="#cb25-845" aria-hidden="true" tabindex="-1"></a>                safe_title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(conv[<span class="st">&#39;title&#39;</span>])</span>
<span id="cb25-846"><a href="#cb25-846" aria-hidden="true" tabindex="-1"></a>                filename <span class="op">=</span> <span class="ss">f&quot;</span><span class="sc">{</span>conv[<span class="st">&#39;number&#39;</span>]<span class="sc">:03d}</span><span class="ss">_</span><span class="sc">{</span>conv[<span class="st">&#39;source&#39;</span>]<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>safe_title<span class="sc">}</span><span class="ss">.md&quot;</span></span>
<span id="cb25-847"><a href="#cb25-847" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;   üìÑ </span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb25-848"><a href="#cb25-848" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb25-849"><a href="#cb25-849" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-850"><a href="#cb25-850" aria-hidden="true" tabindex="-1"></a>        folder <span class="op">=</span> <span class="va">self</span>.output_dirs[<span class="st">&#39;markdown&#39;</span>]</span>
<span id="cb25-851"><a href="#cb25-851" aria-hidden="true" tabindex="-1"></a>        saved_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb25-852"><a href="#cb25-852" aria-hidden="true" tabindex="-1"></a>        failed_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb25-853"><a href="#cb25-853" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-854"><a href="#cb25-854" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> conv <span class="kw">in</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb25-855"><a href="#cb25-855" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb25-856"><a href="#cb25-856" aria-hidden="true" tabindex="-1"></a>                safe_title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(conv[<span class="st">&#39;title&#39;</span>])</span>
<span id="cb25-857"><a href="#cb25-857" aria-hidden="true" tabindex="-1"></a>                filename <span class="op">=</span> <span class="ss">f&quot;</span><span class="sc">{</span>conv[<span class="st">&#39;number&#39;</span>]<span class="sc">:03d}</span><span class="ss">_</span><span class="sc">{</span>conv[<span class="st">&#39;source&#39;</span>]<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>safe_title<span class="sc">}</span><span class="ss">.md&quot;</span></span>
<span id="cb25-858"><a href="#cb25-858" aria-hidden="true" tabindex="-1"></a>                filepath <span class="op">=</span> Path(folder) <span class="op">/</span> filename</span>
<span id="cb25-859"><a href="#cb25-859" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb25-860"><a href="#cb25-860" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.force_overwrite <span class="kw">and</span> filepath.exists():</span>
<span id="cb25-861"><a href="#cb25-861" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">continue</span></span>
<span id="cb25-862"><a href="#cb25-862" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb25-863"><a href="#cb25-863" aria-hidden="true" tabindex="-1"></a>                markdown_content <span class="op">=</span> <span class="va">self</span>.create_enhanced_markdown_content(conv)</span>
<span id="cb25-864"><a href="#cb25-864" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb25-865"><a href="#cb25-865" aria-hidden="true" tabindex="-1"></a>                <span class="cf">with</span> <span class="bu">open</span>(filepath, <span class="st">&#39;w&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb25-866"><a href="#cb25-866" aria-hidden="true" tabindex="-1"></a>                    f.write(markdown_content)</span>
<span id="cb25-867"><a href="#cb25-867" aria-hidden="true" tabindex="-1"></a>                saved_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb25-868"><a href="#cb25-868" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb25-869"><a href="#cb25-869" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb25-870"><a href="#cb25-870" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;‚ùå Erro ao salvar conversa </span><span class="sc">{</span>conv[<span class="st">&#39;number&#39;</span>]<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb25-871"><a href="#cb25-871" aria-hidden="true" tabindex="-1"></a>                failed_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb25-872"><a href="#cb25-872" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span></span>
<span id="cb25-873"><a href="#cb25-873" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb25-874"><a href="#cb25-874" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ Markdown: </span><span class="sc">{</span>saved_count<span class="sc">}</span><span class="ss"> arquivos criados, </span><span class="sc">{</span>failed_count<span class="sc">}</span><span class="ss"> falhas em &#39;</span><span class="sc">{</span>folder<span class="sc">}</span><span class="ss">&#39;&quot;</span>)</span>
<span id="cb25-875"><a href="#cb25-875" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-876"><a href="#cb25-876" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> save_as_csv(<span class="va">self</span>):</span>
<span id="cb25-877"><a href="#cb25-877" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Salva conversas em arquivos CSV individuais&quot;&quot;&quot;</span></span>
<span id="cb25-878"><a href="#cb25-878" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb25-879"><a href="#cb25-879" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;üß™ [DRY-RUN] CSVs seriam criados:&quot;</span>)</span>
<span id="cb25-880"><a href="#cb25-880" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> conv <span class="kw">in</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb25-881"><a href="#cb25-881" aria-hidden="true" tabindex="-1"></a>                safe_title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(conv[<span class="st">&#39;title&#39;</span>])</span>
<span id="cb25-882"><a href="#cb25-882" aria-hidden="true" tabindex="-1"></a>                filename <span class="op">=</span> <span class="ss">f&quot;</span><span class="sc">{</span>conv[<span class="st">&#39;number&#39;</span>]<span class="sc">:03d}</span><span class="ss">_</span><span class="sc">{</span>conv[<span class="st">&#39;source&#39;</span>]<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>safe_title<span class="sc">}</span><span class="ss">.csv&quot;</span></span>
<span id="cb25-883"><a href="#cb25-883" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;   üìä </span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb25-884"><a href="#cb25-884" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb25-885"><a href="#cb25-885" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-886"><a href="#cb25-886" aria-hidden="true" tabindex="-1"></a>        folder <span class="op">=</span> <span class="va">self</span>.output_dirs[<span class="st">&#39;csv&#39;</span>]</span>
<span id="cb25-887"><a href="#cb25-887" aria-hidden="true" tabindex="-1"></a>        saved_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb25-888"><a href="#cb25-888" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-889"><a href="#cb25-889" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> conv <span class="kw">in</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb25-890"><a href="#cb25-890" aria-hidden="true" tabindex="-1"></a>            safe_title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(conv[<span class="st">&#39;title&#39;</span>])</span>
<span id="cb25-891"><a href="#cb25-891" aria-hidden="true" tabindex="-1"></a>            filename <span class="op">=</span> <span class="ss">f&quot;</span><span class="sc">{</span>conv[<span class="st">&#39;number&#39;</span>]<span class="sc">:03d}</span><span class="ss">_</span><span class="sc">{</span>conv[<span class="st">&#39;source&#39;</span>]<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>safe_title<span class="sc">}</span><span class="ss">.csv&quot;</span></span>
<span id="cb25-892"><a href="#cb25-892" aria-hidden="true" tabindex="-1"></a>            filepath <span class="op">=</span> Path(folder) <span class="op">/</span> filename</span>
<span id="cb25-893"><a href="#cb25-893" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-894"><a href="#cb25-894" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.force_overwrite <span class="kw">and</span> filepath.exists():</span>
<span id="cb25-895"><a href="#cb25-895" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span></span>
<span id="cb25-896"><a href="#cb25-896" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb25-897"><a href="#cb25-897" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(filepath, <span class="st">&#39;w&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>, newline<span class="op">=</span><span class="st">&#39;&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb25-898"><a href="#cb25-898" aria-hidden="true" tabindex="-1"></a>                writer <span class="op">=</span> csv.DictWriter(f, fieldnames<span class="op">=</span>[</span>
<span id="cb25-899"><a href="#cb25-899" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;node_id&#39;</span>, <span class="st">&#39;author&#39;</span>, <span class="st">&#39;role&#39;</span>, <span class="st">&#39;timestamp&#39;</span>, <span class="st">&#39;model&#39;</span>, <span class="st">&#39;content&#39;</span></span>
<span id="cb25-900"><a href="#cb25-900" aria-hidden="true" tabindex="-1"></a>                ])</span>
<span id="cb25-901"><a href="#cb25-901" aria-hidden="true" tabindex="-1"></a>                writer.writeheader()</span>
<span id="cb25-902"><a href="#cb25-902" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> i, msg <span class="kw">in</span> <span class="bu">enumerate</span>(conv[<span class="st">&#39;messages&#39;</span>]):</span>
<span id="cb25-903"><a href="#cb25-903" aria-hidden="true" tabindex="-1"></a>                    writer.writerow({</span>
<span id="cb25-904"><a href="#cb25-904" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;node_id&#39;</span>: <span class="bu">str</span>(i),</span>
<span id="cb25-905"><a href="#cb25-905" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;author&#39;</span>: msg[<span class="st">&#39;author&#39;</span>],</span>
<span id="cb25-906"><a href="#cb25-906" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;role&#39;</span>: msg[<span class="st">&#39;role&#39;</span>],</span>
<span id="cb25-907"><a href="#cb25-907" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;timestamp&#39;</span>: msg[<span class="st">&#39;timestamp&#39;</span>],</span>
<span id="cb25-908"><a href="#cb25-908" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;model&#39;</span>: msg[<span class="st">&#39;model&#39;</span>],</span>
<span id="cb25-909"><a href="#cb25-909" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;content&#39;</span>: msg[<span class="st">&#39;content&#39;</span>]</span>
<span id="cb25-910"><a href="#cb25-910" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb25-911"><a href="#cb25-911" aria-hidden="true" tabindex="-1"></a>            saved_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb25-912"><a href="#cb25-912" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-913"><a href="#cb25-913" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ CSV: </span><span class="sc">{</span>saved_count<span class="sc">}</span><span class="ss"> arquivos criados em &#39;</span><span class="sc">{</span>folder<span class="sc">}</span><span class="ss">&#39;&quot;</span>)</span>
<span id="cb25-914"><a href="#cb25-914" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-915"><a href="#cb25-915" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> save_as_json(<span class="va">self</span>):</span>
<span id="cb25-916"><a href="#cb25-916" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Salva conversas em arquivos JSON individuais&quot;&quot;&quot;</span></span>
<span id="cb25-917"><a href="#cb25-917" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb25-918"><a href="#cb25-918" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;üß™ [DRY-RUN] JSONs seriam criados:&quot;</span>)</span>
<span id="cb25-919"><a href="#cb25-919" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> conv <span class="kw">in</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb25-920"><a href="#cb25-920" aria-hidden="true" tabindex="-1"></a>                safe_title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(conv[<span class="st">&#39;title&#39;</span>])</span>
<span id="cb25-921"><a href="#cb25-921" aria-hidden="true" tabindex="-1"></a>                filename <span class="op">=</span> <span class="ss">f&quot;</span><span class="sc">{</span>conv[<span class="st">&#39;number&#39;</span>]<span class="sc">:03d}</span><span class="ss">_</span><span class="sc">{</span>conv[<span class="st">&#39;source&#39;</span>]<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>safe_title<span class="sc">}</span><span class="ss">.json&quot;</span></span>
<span id="cb25-922"><a href="#cb25-922" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;   üìã </span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb25-923"><a href="#cb25-923" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb25-924"><a href="#cb25-924" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-925"><a href="#cb25-925" aria-hidden="true" tabindex="-1"></a>        folder <span class="op">=</span> <span class="va">self</span>.output_dirs[<span class="st">&#39;json&#39;</span>]</span>
<span id="cb25-926"><a href="#cb25-926" aria-hidden="true" tabindex="-1"></a>        saved_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb25-927"><a href="#cb25-927" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-928"><a href="#cb25-928" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> conv <span class="kw">in</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb25-929"><a href="#cb25-929" aria-hidden="true" tabindex="-1"></a>            safe_title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(conv[<span class="st">&#39;title&#39;</span>])</span>
<span id="cb25-930"><a href="#cb25-930" aria-hidden="true" tabindex="-1"></a>            filename <span class="op">=</span> <span class="ss">f&quot;</span><span class="sc">{</span>conv[<span class="st">&#39;number&#39;</span>]<span class="sc">:03d}</span><span class="ss">_</span><span class="sc">{</span>conv[<span class="st">&#39;source&#39;</span>]<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>safe_title<span class="sc">}</span><span class="ss">.json&quot;</span></span>
<span id="cb25-931"><a href="#cb25-931" aria-hidden="true" tabindex="-1"></a>            filepath <span class="op">=</span> Path(folder) <span class="op">/</span> filename</span>
<span id="cb25-932"><a href="#cb25-932" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-933"><a href="#cb25-933" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.force_overwrite <span class="kw">and</span> filepath.exists():</span>
<span id="cb25-934"><a href="#cb25-934" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span></span>
<span id="cb25-935"><a href="#cb25-935" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb25-936"><a href="#cb25-936" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(filepath, <span class="st">&#39;w&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb25-937"><a href="#cb25-937" aria-hidden="true" tabindex="-1"></a>                json.dump(conv, f, ensure_ascii<span class="op">=</span><span class="va">False</span>, indent<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb25-938"><a href="#cb25-938" aria-hidden="true" tabindex="-1"></a>            saved_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb25-939"><a href="#cb25-939" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-940"><a href="#cb25-940" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ JSON: </span><span class="sc">{</span>saved_count<span class="sc">}</span><span class="ss"> arquivos criados em &#39;</span><span class="sc">{</span>folder<span class="sc">}</span><span class="ss">&#39;&quot;</span>)</span>
<span id="cb25-941"><a href="#cb25-941" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-942"><a href="#cb25-942" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> save_all_to_single_files(<span class="va">self</span>):</span>
<span id="cb25-943"><a href="#cb25-943" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Salva todas as conversas em arquivos √∫nicos CSV e JSON&quot;&quot;&quot;</span></span>
<span id="cb25-944"><a href="#cb25-944" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb25-945"><a href="#cb25-945" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;üß™ [DRY-RUN] Arquivos √∫nicos seriam criados:&quot;</span>)</span>
<span id="cb25-946"><a href="#cb25-946" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;   üìÅ </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>single_files[<span class="st">&#39;csv&#39;</span>]<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb25-947"><a href="#cb25-947" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;   üìÅ </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>single_files[<span class="st">&#39;json&#39;</span>]<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb25-948"><a href="#cb25-948" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb25-949"><a href="#cb25-949" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-950"><a href="#cb25-950" aria-hidden="true" tabindex="-1"></a>        <span class="co"># CSV √∫nico</span></span>
<span id="cb25-951"><a href="#cb25-951" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> <span class="bu">open</span>(<span class="va">self</span>.single_files[<span class="st">&#39;csv&#39;</span>], <span class="st">&#39;w&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>, newline<span class="op">=</span><span class="st">&#39;&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb25-952"><a href="#cb25-952" aria-hidden="true" tabindex="-1"></a>            fieldnames <span class="op">=</span> [</span>
<span id="cb25-953"><a href="#cb25-953" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;conversation_number&#39;</span>, <span class="st">&#39;source&#39;</span>, <span class="st">&#39;conversation_title&#39;</span>, <span class="st">&#39;category&#39;</span>,</span>
<span id="cb25-954"><a href="#cb25-954" aria-hidden="true" tabindex="-1"></a>                <span class="st">&#39;author&#39;</span>, <span class="st">&#39;role&#39;</span>, <span class="st">&#39;timestamp&#39;</span>, <span class="st">&#39;model&#39;</span>, <span class="st">&#39;content&#39;</span></span>
<span id="cb25-955"><a href="#cb25-955" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb25-956"><a href="#cb25-956" aria-hidden="true" tabindex="-1"></a>            writer <span class="op">=</span> csv.DictWriter(f, fieldnames<span class="op">=</span>fieldnames)</span>
<span id="cb25-957"><a href="#cb25-957" aria-hidden="true" tabindex="-1"></a>            writer.writeheader()</span>
<span id="cb25-958"><a href="#cb25-958" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> conv <span class="kw">in</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb25-959"><a href="#cb25-959" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> msg <span class="kw">in</span> conv[<span class="st">&#39;messages&#39;</span>]:</span>
<span id="cb25-960"><a href="#cb25-960" aria-hidden="true" tabindex="-1"></a>                    writer.writerow({</span>
<span id="cb25-961"><a href="#cb25-961" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;conversation_number&#39;</span>: conv[<span class="st">&#39;number&#39;</span>],</span>
<span id="cb25-962"><a href="#cb25-962" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;source&#39;</span>: conv[<span class="st">&#39;source&#39;</span>],</span>
<span id="cb25-963"><a href="#cb25-963" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;conversation_title&#39;</span>: conv[<span class="st">&#39;title&#39;</span>],</span>
<span id="cb25-964"><a href="#cb25-964" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;category&#39;</span>: conv[<span class="st">&#39;category&#39;</span>],</span>
<span id="cb25-965"><a href="#cb25-965" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;author&#39;</span>: msg[<span class="st">&#39;author&#39;</span>],</span>
<span id="cb25-966"><a href="#cb25-966" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;role&#39;</span>: msg[<span class="st">&#39;role&#39;</span>],</span>
<span id="cb25-967"><a href="#cb25-967" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;timestamp&#39;</span>: msg[<span class="st">&#39;timestamp&#39;</span>],</span>
<span id="cb25-968"><a href="#cb25-968" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;model&#39;</span>: msg[<span class="st">&#39;model&#39;</span>],</span>
<span id="cb25-969"><a href="#cb25-969" aria-hidden="true" tabindex="-1"></a>                        <span class="st">&#39;content&#39;</span>: msg[<span class="st">&#39;content&#39;</span>]</span>
<span id="cb25-970"><a href="#cb25-970" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb25-971"><a href="#cb25-971" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ CSV √∫nico: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>single_files[<span class="st">&#39;csv&#39;</span>]<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb25-972"><a href="#cb25-972" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-973"><a href="#cb25-973" aria-hidden="true" tabindex="-1"></a>        <span class="co"># JSON √∫nico</span></span>
<span id="cb25-974"><a href="#cb25-974" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> <span class="bu">open</span>(<span class="va">self</span>.single_files[<span class="st">&#39;json&#39;</span>], <span class="st">&#39;w&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb25-975"><a href="#cb25-975" aria-hidden="true" tabindex="-1"></a>            json.dump(<span class="va">self</span>.all_conversations, f, ensure_ascii<span class="op">=</span><span class="va">False</span>, indent<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb25-976"><a href="#cb25-976" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ JSON √∫nico: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>single_files[<span class="st">&#39;json&#39;</span>]<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb25-977"><a href="#cb25-977" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-978"><a href="#cb25-978" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_searchable_index(<span class="va">self</span>):</span>
<span id="cb25-979"><a href="#cb25-979" aria-hidden="true" tabindex="-1"></a>        <span class="co">&quot;&quot;&quot;Cria √≠ndice HTML pesquis√°vel com links para HTML&quot;&quot;&quot;</span></span>
<span id="cb25-980"><a href="#cb25-980" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb25-981"><a href="#cb25-981" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;üß™ [DRY-RUN] √çndice HTML seria criado: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>index_file<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb25-982"><a href="#cb25-982" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb25-983"><a href="#cb25-983" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-984"><a href="#cb25-984" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;üéØ Criando √≠ndice HTML combinado...&quot;</span>)</span>
<span id="cb25-985"><a href="#cb25-985" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-986"><a href="#cb25-986" aria-hidden="true" tabindex="-1"></a>        category_stats <span class="op">=</span> {}</span>
<span id="cb25-987"><a href="#cb25-987" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> conv <span class="kw">in</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb25-988"><a href="#cb25-988" aria-hidden="true" tabindex="-1"></a>            cat <span class="op">=</span> conv[<span class="st">&#39;category&#39;</span>]</span>
<span id="cb25-989"><a href="#cb25-989" aria-hidden="true" tabindex="-1"></a>            category_stats[cat] <span class="op">=</span> category_stats.get(cat, <span class="dv">0</span>) <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb25-990"><a href="#cb25-990" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-991"><a href="#cb25-991" aria-hidden="true" tabindex="-1"></a>        html_content <span class="op">=</span> <span class="ss">f&quot;&quot;&quot;&lt;!DOCTYPE html&gt;</span></span>
<span id="cb25-992"><a href="#cb25-992" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;html lang=&quot;pt-PT&quot;&gt;</span></span>
<span id="cb25-993"><a href="#cb25-993" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;head&gt;</span></span>
<span id="cb25-994"><a href="#cb25-994" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span></span>
<span id="cb25-995"><a href="#cb25-995" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span></span>
<span id="cb25-996"><a href="#cb25-996" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;title&gt;√çndice Combinado - AI Chats&lt;/title&gt;</span></span>
<span id="cb25-997"><a href="#cb25-997" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;style&gt;</span></span>
<span id="cb25-998"><a href="#cb25-998" aria-hidden="true" tabindex="-1"></a><span class="ss">        * </span><span class="ch">{{</span><span class="ss"> margin: 0; padding: 0; box-sizing: border-box; </span><span class="ch">}}</span></span>
<span id="cb25-999"><a href="#cb25-999" aria-hidden="true" tabindex="-1"></a><span class="ss">        body </span><span class="ch">{{</span><span class="ss"> font-family: &#39;Segoe UI&#39;, Tahoma, Geneva, Verdana, sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; padding: 20px; color: #333; </span><span class="ch">}}</span></span>
<span id="cb25-1000"><a href="#cb25-1000" aria-hidden="true" tabindex="-1"></a><span class="ss">        .container </span><span class="ch">{{</span><span class="ss"> max-width: 1400px; margin: 0 auto; background: white; border-radius: 15px; box-shadow: 0 20px 40px rgba(0,0,0,0.1); overflow: hidden; </span><span class="ch">}}</span></span>
<span id="cb25-1001"><a href="#cb25-1001" aria-hidden="true" tabindex="-1"></a><span class="ss">        .header </span><span class="ch">{{</span><span class="ss"> background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 40px; text-align: center; </span><span class="ch">}}</span></span>
<span id="cb25-1002"><a href="#cb25-1002" aria-hidden="true" tabindex="-1"></a><span class="ss">        .header h1 </span><span class="ch">{{</span><span class="ss"> font-size: 2.8em; margin-bottom: 15px; font-weight: 300; </span><span class="ch">}}</span></span>
<span id="cb25-1003"><a href="#cb25-1003" aria-hidden="true" tabindex="-1"></a><span class="ss">        .header p </span><span class="ch">{{</span><span class="ss"> font-size: 1.2em; opacity: 0.9; margin-bottom: 20px; </span><span class="ch">}}</span></span>
<span id="cb25-1004"><a href="#cb25-1004" aria-hidden="true" tabindex="-1"></a><span class="ss">        .stats </span><span class="ch">{{</span><span class="ss"> display: flex; justify-content: center; gap: 30px; margin-top: 25px; flex-wrap: wrap; </span><span class="ch">}}</span></span>
<span id="cb25-1005"><a href="#cb25-1005" aria-hidden="true" tabindex="-1"></a><span class="ss">        .stat-item </span><span class="ch">{{</span><span class="ss"> background: rgba(255,255,255,0.15); padding: 18px 28px; border-radius: 12px; backdrop-filter: blur(10px); font-size: 1.1em; </span><span class="ch">}}</span></span>
<span id="cb25-1006"><a href="#cb25-1006" aria-hidden="true" tabindex="-1"></a><span class="ss">        .search-section </span><span class="ch">{{</span><span class="ss"> padding: 30px; background: #f8f9fa; border-bottom: 1px solid #e9ecef; </span><span class="ch">}}</span></span>
<span id="cb25-1007"><a href="#cb25-1007" aria-hidden="true" tabindex="-1"></a><span class="ss">        .search-box </span><span class="ch">{{</span><span class="ss"> width: 100%; padding: 18px 25px; font-size: 16px; border: 2px solid #e9ecef; border-radius: 25px; outline: none; transition: all 0.3s ease; font-family: inherit; </span><span class="ch">}}</span></span>
<span id="cb25-1008"><a href="#cb25-1008" aria-hidden="true" tabindex="-1"></a><span class="ss">        .search-box:focus </span><span class="ch">{{</span><span class="ss"> border-color: #667eea; box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1); </span><span class="ch">}}</span></span>
<span id="cb25-1009"><a href="#cb25-1009" aria-hidden="true" tabindex="-1"></a><span class="ss">        .filter-section </span><span class="ch">{{</span></span>
<span id="cb25-1010"><a href="#cb25-1010" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 20px 30px;</span></span>
<span id="cb25-1011"><a href="#cb25-1011" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: flex;</span></span>
<span id="cb25-1012"><a href="#cb25-1012" aria-hidden="true" tabindex="-1"></a><span class="ss">            flex-wrap: wrap;</span></span>
<span id="cb25-1013"><a href="#cb25-1013" aria-hidden="true" tabindex="-1"></a><span class="ss">            gap: 12px;</span></span>
<span id="cb25-1014"><a href="#cb25-1014" aria-hidden="true" tabindex="-1"></a><span class="ss">            justify-content: center;</span></span>
<span id="cb25-1015"><a href="#cb25-1015" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #f8f9fa;</span></span>
<span id="cb25-1016"><a href="#cb25-1016" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-bottom: 1px solid #e9ecef;</span></span>
<span id="cb25-1017"><a href="#cb25-1017" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-1018"><a href="#cb25-1018" aria-hidden="true" tabindex="-1"></a><span class="ss">        .filter-btn </span><span class="ch">{{</span></span>
<span id="cb25-1019"><a href="#cb25-1019" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 10px 20px;</span></span>
<span id="cb25-1020"><a href="#cb25-1020" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: white;</span></span>
<span id="cb25-1021"><a href="#cb25-1021" aria-hidden="true" tabindex="-1"></a><span class="ss">            border: 2px solid #e9ecef;</span></span>
<span id="cb25-1022"><a href="#cb25-1022" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 25px;</span></span>
<span id="cb25-1023"><a href="#cb25-1023" aria-hidden="true" tabindex="-1"></a><span class="ss">            cursor: pointer;</span></span>
<span id="cb25-1024"><a href="#cb25-1024" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.95em;</span></span>
<span id="cb25-1025"><a href="#cb25-1025" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-weight: 500;</span></span>
<span id="cb25-1026"><a href="#cb25-1026" aria-hidden="true" tabindex="-1"></a><span class="ss">            transition: all 0.3s ease;</span></span>
<span id="cb25-1027"><a href="#cb25-1027" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-family: inherit;</span></span>
<span id="cb25-1028"><a href="#cb25-1028" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-1029"><a href="#cb25-1029" aria-hidden="true" tabindex="-1"></a><span class="ss">        .filter-btn.active, .filter-btn:hover </span><span class="ch">{{</span></span>
<span id="cb25-1030"><a href="#cb25-1030" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #667eea;</span></span>
<span id="cb25-1031"><a href="#cb25-1031" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: white;</span></span>
<span id="cb25-1032"><a href="#cb25-1032" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-color: #667eea;</span></span>
<span id="cb25-1033"><a href="#cb25-1033" aria-hidden="true" tabindex="-1"></a><span class="ss">            transform: translateY(-2px);</span></span>
<span id="cb25-1034"><a href="#cb25-1034" aria-hidden="true" tabindex="-1"></a><span class="ss">            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);</span></span>
<span id="cb25-1035"><a href="#cb25-1035" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-1036"><a href="#cb25-1036" aria-hidden="true" tabindex="-1"></a><span class="ss">        .conversations-grid </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb25-1037"><a href="#cb25-1037" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: grid; </span></span>
<span id="cb25-1038"><a href="#cb25-1038" aria-hidden="true" tabindex="-1"></a><span class="ss">            grid-template-columns: repeat(auto-fill, minmax(380px, 1fr)); </span></span>
<span id="cb25-1039"><a href="#cb25-1039" aria-hidden="true" tabindex="-1"></a><span class="ss">            gap: 25px; </span></span>
<span id="cb25-1040"><a href="#cb25-1040" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 35px;</span></span>
<span id="cb25-1041"><a href="#cb25-1041" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);</span></span>
<span id="cb25-1042"><a href="#cb25-1042" aria-hidden="true" tabindex="-1"></a><span class="ss">            min-height: 400px;</span></span>
<span id="cb25-1043"><a href="#cb25-1043" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-1044"><a href="#cb25-1044" aria-hidden="true" tabindex="-1"></a><span class="ss">        .conversation-card </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb25-1045"><a href="#cb25-1045" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: white; </span></span>
<span id="cb25-1046"><a href="#cb25-1046" aria-hidden="true" tabindex="-1"></a><span class="ss">            border: 1px solid #e9ecef; </span></span>
<span id="cb25-1047"><a href="#cb25-1047" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 15px; </span></span>
<span id="cb25-1048"><a href="#cb25-1048" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 25px; </span></span>
<span id="cb25-1049"><a href="#cb25-1049" aria-hidden="true" tabindex="-1"></a><span class="ss">            transition: all 0.4s ease; </span></span>
<span id="cb25-1050"><a href="#cb25-1050" aria-hidden="true" tabindex="-1"></a><span class="ss">            cursor: pointer; </span></span>
<span id="cb25-1051"><a href="#cb25-1051" aria-hidden="true" tabindex="-1"></a><span class="ss">            position: relative;</span></span>
<span id="cb25-1052"><a href="#cb25-1052" aria-hidden="true" tabindex="-1"></a><span class="ss">            box-shadow: 0 5px 15px rgba(0,0,0,0.08);</span></span>
<span id="cb25-1053"><a href="#cb25-1053" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-1054"><a href="#cb25-1054" aria-hidden="true" tabindex="-1"></a><span class="ss">        .conversation-card:hover </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb25-1055"><a href="#cb25-1055" aria-hidden="true" tabindex="-1"></a><span class="ss">            transform: translateY(-8px); </span></span>
<span id="cb25-1056"><a href="#cb25-1056" aria-hidden="true" tabindex="-1"></a><span class="ss">            box-shadow: 0 15px 35px rgba(0,0,0,0.15); </span></span>
<span id="cb25-1057"><a href="#cb25-1057" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-color: #667eea;</span></span>
<span id="cb25-1058"><a href="#cb25-1058" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-1059"><a href="#cb25-1059" aria-hidden="true" tabindex="-1"></a><span class="ss">        .card-header </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb25-1060"><a href="#cb25-1060" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: flex; </span></span>
<span id="cb25-1061"><a href="#cb25-1061" aria-hidden="true" tabindex="-1"></a><span class="ss">            justify-content: space-between; </span></span>
<span id="cb25-1062"><a href="#cb25-1062" aria-hidden="true" tabindex="-1"></a><span class="ss">            align-items: flex-start; </span></span>
<span id="cb25-1063"><a href="#cb25-1063" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-bottom: 18px; </span></span>
<span id="cb25-1064"><a href="#cb25-1064" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-1065"><a href="#cb25-1065" aria-hidden="true" tabindex="-1"></a><span class="ss">        .card-number </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb25-1066"><a href="#cb25-1066" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: linear-gradient(135deg, #667eea, #764ba2); </span></span>
<span id="cb25-1067"><a href="#cb25-1067" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: white; </span></span>
<span id="cb25-1068"><a href="#cb25-1068" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 8px 16px; </span></span>
<span id="cb25-1069"><a href="#cb25-1069" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 20px; </span></span>
<span id="cb25-1070"><a href="#cb25-1070" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.9em; </span></span>
<span id="cb25-1071"><a href="#cb25-1071" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-weight: bold;</span></span>
<span id="cb25-1072"><a href="#cb25-1072" aria-hidden="true" tabindex="-1"></a><span class="ss">            box-shadow: 0 3px 10px rgba(102, 126, 234, 0.3);</span></span>
<span id="cb25-1073"><a href="#cb25-1073" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-1074"><a href="#cb25-1074" aria-hidden="true" tabindex="-1"></a><span class="ss">        .card-source </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb25-1075"><a href="#cb25-1075" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #e3f2fd; </span></span>
<span id="cb25-1076"><a href="#cb25-1076" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #1976d2; </span></span>
<span id="cb25-1077"><a href="#cb25-1077" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 5px 12px; </span></span>
<span id="cb25-1078"><a href="#cb25-1078" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 12px; </span></span>
<span id="cb25-1079"><a href="#cb25-1079" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.85em; </span></span>
<span id="cb25-1080"><a href="#cb25-1080" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-weight: bold; </span></span>
<span id="cb25-1081"><a href="#cb25-1081" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-left: 10px;</span></span>
<span id="cb25-1082"><a href="#cb25-1082" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-1083"><a href="#cb25-1083" aria-hidden="true" tabindex="-1"></a><span class="ss">        .card-title </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb25-1084"><a href="#cb25-1084" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 1.3em; </span></span>
<span id="cb25-1085"><a href="#cb25-1085" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-weight: 600; </span></span>
<span id="cb25-1086"><a href="#cb25-1086" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #2c3e50; </span></span>
<span id="cb25-1087"><a href="#cb25-1087" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-bottom: 12px; </span></span>
<span id="cb25-1088"><a href="#cb25-1088" aria-hidden="true" tabindex="-1"></a><span class="ss">            line-height: 1.4;</span></span>
<span id="cb25-1089"><a href="#cb25-1089" aria-hidden="true" tabindex="-1"></a><span class="ss">            min-height: 3.6em;</span></span>
<span id="cb25-1090"><a href="#cb25-1090" aria-hidden="true" tabindex="-1"></a><span class="ss">            cursor: pointer;</span></span>
<span id="cb25-1091"><a href="#cb25-1091" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-1092"><a href="#cb25-1092" aria-hidden="true" tabindex="-1"></a><span class="ss">        .card-summary </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb25-1093"><a href="#cb25-1093" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #6c757d; </span></span>
<span id="cb25-1094"><a href="#cb25-1094" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.95em; </span></span>
<span id="cb25-1095"><a href="#cb25-1095" aria-hidden="true" tabindex="-1"></a><span class="ss">            line-height: 1.5; </span></span>
<span id="cb25-1096"><a href="#cb25-1096" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-bottom: 18px;</span></span>
<span id="cb25-1097"><a href="#cb25-1097" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: -webkit-box;</span></span>
<span id="cb25-1098"><a href="#cb25-1098" aria-hidden="true" tabindex="-1"></a><span class="ss">            -webkit-line-clamp: 3;</span></span>
<span id="cb25-1099"><a href="#cb25-1099" aria-hidden="true" tabindex="-1"></a><span class="ss">            -webkit-box-orient: vertical;</span></span>
<span id="cb25-1100"><a href="#cb25-1100" aria-hidden="true" tabindex="-1"></a><span class="ss">            overflow: hidden;</span></span>
<span id="cb25-1101"><a href="#cb25-1101" aria-hidden="true" tabindex="-1"></a><span class="ss">            cursor: pointer;</span></span>
<span id="cb25-1102"><a href="#cb25-1102" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-1103"><a href="#cb25-1103" aria-hidden="true" tabindex="-1"></a><span class="ss">        .card-meta </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb25-1104"><a href="#cb25-1104" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: flex; </span></span>
<span id="cb25-1105"><a href="#cb25-1105" aria-hidden="true" tabindex="-1"></a><span class="ss">            justify-content: space-between; </span></span>
<span id="cb25-1106"><a href="#cb25-1106" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.85em; </span></span>
<span id="cb25-1107"><a href="#cb25-1107" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #868e96; </span></span>
<span id="cb25-1108"><a href="#cb25-1108" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-top: 1px solid #e9ecef; </span></span>
<span id="cb25-1109"><a href="#cb25-1109" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding-top: 18px;</span></span>
<span id="cb25-1110"><a href="#cb25-1110" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-1111"><a href="#cb25-1111" aria-hidden="true" tabindex="-1"></a><span class="ss">        .card-actions </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb25-1112"><a href="#cb25-1112" aria-hidden="true" tabindex="-1"></a><span class="ss">            position: absolute; </span></span>
<span id="cb25-1113"><a href="#cb25-1113" aria-hidden="true" tabindex="-1"></a><span class="ss">            top: 20px; </span></span>
<span id="cb25-1114"><a href="#cb25-1114" aria-hidden="true" tabindex="-1"></a><span class="ss">            right: 20px; </span></span>
<span id="cb25-1115"><a href="#cb25-1115" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: flex; </span></span>
<span id="cb25-1116"><a href="#cb25-1116" aria-hidden="true" tabindex="-1"></a><span class="ss">            gap: 8px; </span></span>
<span id="cb25-1117"><a href="#cb25-1117" aria-hidden="true" tabindex="-1"></a><span class="ss">            opacity: 0; </span></span>
<span id="cb25-1118"><a href="#cb25-1118" aria-hidden="true" tabindex="-1"></a><span class="ss">            transition: opacity 0.3s ease; </span></span>
<span id="cb25-1119"><a href="#cb25-1119" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-1120"><a href="#cb25-1120" aria-hidden="true" tabindex="-1"></a><span class="ss">        .conversation-card:hover .card-actions </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb25-1121"><a href="#cb25-1121" aria-hidden="true" tabindex="-1"></a><span class="ss">            opacity: 1; </span></span>
<span id="cb25-1122"><a href="#cb25-1122" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-1123"><a href="#cb25-1123" aria-hidden="true" tabindex="-1"></a><span class="ss">        .action-btn </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb25-1124"><a href="#cb25-1124" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: white; </span></span>
<span id="cb25-1125"><a href="#cb25-1125" aria-hidden="true" tabindex="-1"></a><span class="ss">            border: 2px solid #e9ecef; </span></span>
<span id="cb25-1126"><a href="#cb25-1126" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 8px; </span></span>
<span id="cb25-1127"><a href="#cb25-1127" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 6px 12px; </span></span>
<span id="cb25-1128"><a href="#cb25-1128" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.8em; </span></span>
<span id="cb25-1129"><a href="#cb25-1129" aria-hidden="true" tabindex="-1"></a><span class="ss">            cursor: pointer; </span></span>
<span id="cb25-1130"><a href="#cb25-1130" aria-hidden="true" tabindex="-1"></a><span class="ss">            transition: all 0.3s ease;</span></span>
<span id="cb25-1131"><a href="#cb25-1131" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-weight: 500;</span></span>
<span id="cb25-1132"><a href="#cb25-1132" aria-hidden="true" tabindex="-1"></a><span class="ss">            text-decoration: none;</span></span>
<span id="cb25-1133"><a href="#cb25-1133" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #333;</span></span>
<span id="cb25-1134"><a href="#cb25-1134" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: inline-block;</span></span>
<span id="cb25-1135"><a href="#cb25-1135" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-1136"><a href="#cb25-1136" aria-hidden="true" tabindex="-1"></a><span class="ss">        .action-btn:hover </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb25-1137"><a href="#cb25-1137" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #667eea; </span></span>
<span id="cb25-1138"><a href="#cb25-1138" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: white; </span></span>
<span id="cb25-1139"><a href="#cb25-1139" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-color: #667eea;</span></span>
<span id="cb25-1140"><a href="#cb25-1140" aria-hidden="true" tabindex="-1"></a><span class="ss">            transform: scale(1.05);</span></span>
<span id="cb25-1141"><a href="#cb25-1141" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-1142"><a href="#cb25-1142" aria-hidden="true" tabindex="-1"></a><span class="ss">        .recent-badge </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb25-1143"><a href="#cb25-1143" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #ff6b6b; </span></span>
<span id="cb25-1144"><a href="#cb25-1144" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: white; </span></span>
<span id="cb25-1145"><a href="#cb25-1145" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 3px 10px; </span></span>
<span id="cb25-1146"><a href="#cb25-1146" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 12px; </span></span>
<span id="cb25-1147"><a href="#cb25-1147" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.75em; </span></span>
<span id="cb25-1148"><a href="#cb25-1148" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-left: 8px;</span></span>
<span id="cb25-1149"><a href="#cb25-1149" aria-hidden="true" tabindex="-1"></a><span class="ss">            animation: pulse 2s infinite;</span></span>
<span id="cb25-1150"><a href="#cb25-1150" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-1151"><a href="#cb25-1151" aria-hidden="true" tabindex="-1"></a><span class="ss">        .no-results </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb25-1152"><a href="#cb25-1152" aria-hidden="true" tabindex="-1"></a><span class="ss">            text-align: center; </span></span>
<span id="cb25-1153"><a href="#cb25-1153" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 60px 20px; </span></span>
<span id="cb25-1154"><a href="#cb25-1154" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #6c757d;</span></span>
<span id="cb25-1155"><a href="#cb25-1155" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 1.1em;</span></span>
<span id="cb25-1156"><a href="#cb25-1156" aria-hidden="true" tabindex="-1"></a><span class="ss">            grid-column: 1 / -1;</span></span>
<span id="cb25-1157"><a href="#cb25-1157" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-1158"><a href="#cb25-1158" aria-hidden="true" tabindex="-1"></a><span class="ss">        @keyframes pulse </span><span class="ch">{{</span></span>
<span id="cb25-1159"><a href="#cb25-1159" aria-hidden="true" tabindex="-1"></a><span class="ss">            0% </span><span class="ch">{{</span><span class="ss"> transform: scale(1); </span><span class="ch">}}</span></span>
<span id="cb25-1160"><a href="#cb25-1160" aria-hidden="true" tabindex="-1"></a><span class="ss">            50% </span><span class="ch">{{</span><span class="ss"> transform: scale(1.05); </span><span class="ch">}}</span></span>
<span id="cb25-1161"><a href="#cb25-1161" aria-hidden="true" tabindex="-1"></a><span class="ss">            100% </span><span class="ch">{{</span><span class="ss"> transform: scale(1); </span><span class="ch">}}</span></span>
<span id="cb25-1162"><a href="#cb25-1162" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-1163"><a href="#cb25-1163" aria-hidden="true" tabindex="-1"></a><span class="ss">        .category-badge </span><span class="ch">{{</span></span>
<span id="cb25-1164"><a href="#cb25-1164" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: inline-block;</span></span>
<span id="cb25-1165"><a href="#cb25-1165" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #e3f2fd;</span></span>
<span id="cb25-1166"><a href="#cb25-1166" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #1976d2;</span></span>
<span id="cb25-1167"><a href="#cb25-1167" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 4px 10px;</span></span>
<span id="cb25-1168"><a href="#cb25-1168" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 12px;</span></span>
<span id="cb25-1169"><a href="#cb25-1169" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.8em;</span></span>
<span id="cb25-1170"><a href="#cb25-1170" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-left: 8px;</span></span>
<span id="cb25-1171"><a href="#cb25-1171" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-weight: 500;</span></span>
<span id="cb25-1172"><a href="#cb25-1172" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-1173"><a href="#cb25-1173" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb25-1174"><a href="#cb25-1174" aria-hidden="true" tabindex="-1"></a><span class="ss">        .direct-link </span><span class="ch">{{</span></span>
<span id="cb25-1175"><a href="#cb25-1175" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: inline-block;</span></span>
<span id="cb25-1176"><a href="#cb25-1176" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin: 5px;</span></span>
<span id="cb25-1177"><a href="#cb25-1177" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 8px 15px;</span></span>
<span id="cb25-1178"><a href="#cb25-1178" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #28a745;</span></span>
<span id="cb25-1179"><a href="#cb25-1179" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: white;</span></span>
<span id="cb25-1180"><a href="#cb25-1180" aria-hidden="true" tabindex="-1"></a><span class="ss">            text-decoration: none;</span></span>
<span id="cb25-1181"><a href="#cb25-1181" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 5px;</span></span>
<span id="cb25-1182"><a href="#cb25-1182" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.9em;</span></span>
<span id="cb25-1183"><a href="#cb25-1183" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-1184"><a href="#cb25-1184" aria-hidden="true" tabindex="-1"></a><span class="ss">        .direct-link:hover </span><span class="ch">{{</span></span>
<span id="cb25-1185"><a href="#cb25-1185" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #218838;</span></span>
<span id="cb25-1186"><a href="#cb25-1186" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-1187"><a href="#cb25-1187" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb25-1188"><a href="#cb25-1188" aria-hidden="true" tabindex="-1"></a><span class="ss">        .html-btn </span><span class="ch">{{</span></span>
<span id="cb25-1189"><a href="#cb25-1189" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #17a2b8;</span></span>
<span id="cb25-1190"><a href="#cb25-1190" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: white;</span></span>
<span id="cb25-1191"><a href="#cb25-1191" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-1192"><a href="#cb25-1192" aria-hidden="true" tabindex="-1"></a><span class="ss">        .html-btn:hover </span><span class="ch">{{</span></span>
<span id="cb25-1193"><a href="#cb25-1193" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #138496;</span></span>
<span id="cb25-1194"><a href="#cb25-1194" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-1195"><a href="#cb25-1195" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;/style&gt;</span></span>
<span id="cb25-1196"><a href="#cb25-1196" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;/head&gt;</span></span>
<span id="cb25-1197"><a href="#cb25-1197" aria-hidden="true" tabindex="-1"></a><span class="ss">&lt;body&gt;</span></span>
<span id="cb25-1198"><a href="#cb25-1198" aria-hidden="true" tabindex="-1"></a><span class="ss">    &lt;div class=&quot;container&quot;&gt;</span></span>
<span id="cb25-1199"><a href="#cb25-1199" aria-hidden="true" tabindex="-1"></a><span class="ss">        &lt;div class=&quot;header&quot;&gt;</span></span>
<span id="cb25-1200"><a href="#cb25-1200" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;h1&gt;üìö √çndice Combinado de Conversas&lt;/h1&gt;</span></span>
<span id="cb25-1201"><a href="#cb25-1201" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;p&gt;Qwen3 ‚Ä¢ ChatGPT ‚Ä¢ DeepSeek ‚Ä¢ Grok ‚Ä¢ COM HTML (Pandoc)&lt;/p&gt;</span></span>
<span id="cb25-1202"><a href="#cb25-1202" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;div class=&quot;stats&quot;&gt;</span></span>
<span id="cb25-1203"><a href="#cb25-1203" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;div class=&quot;stat-item&quot;&gt;</span></span>
<span id="cb25-1204"><a href="#cb25-1204" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;strong&gt;Total:&lt;/strong&gt; &lt;span id=&quot;total-count&quot;&gt;</span><span class="sc">{</span><span class="bu">len</span>(<span class="va">self</span>.all_conversations)<span class="sc">}</span><span class="ss">&lt;/span&gt; conversas</span></span>
<span id="cb25-1205"><a href="#cb25-1205" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;/div&gt;</span></span>
<span id="cb25-1206"><a href="#cb25-1206" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;div class=&quot;stat-item&quot;&gt;</span></span>
<span id="cb25-1207"><a href="#cb25-1207" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;strong&gt;Ordena√ß√£o:&lt;/strong&gt; Mais Recentes Primeiro</span></span>
<span id="cb25-1208"><a href="#cb25-1208" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;/div&gt;</span></span>
<span id="cb25-1209"><a href="#cb25-1209" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;div class=&quot;stat-item&quot;&gt;</span></span>
<span id="cb25-1210"><a href="#cb25-1210" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;strong&gt;Atualizado:&lt;/strong&gt; </span><span class="sc">{</span>datetime<span class="sc">.</span>now()<span class="sc">.</span>strftime(<span class="st">&#39;</span><span class="sc">%d</span><span class="st">/%m/%Y %H:%M&#39;</span>)<span class="sc">}</span></span>
<span id="cb25-1211"><a href="#cb25-1211" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;/div&gt;</span></span>
<span id="cb25-1212"><a href="#cb25-1212" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;/div&gt;</span></span>
<span id="cb25-1213"><a href="#cb25-1213" aria-hidden="true" tabindex="-1"></a><span class="ss">        &lt;/div&gt;</span></span>
<span id="cb25-1214"><a href="#cb25-1214" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb25-1215"><a href="#cb25-1215" aria-hidden="true" tabindex="-1"></a><span class="ss">        &lt;div class=&quot;search-section&quot;&gt;</span></span>
<span id="cb25-1216"><a href="#cb25-1216" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;input type=&quot;text&quot; id=&quot;searchInput&quot; class=&quot;search-box&quot; placeholder=&quot;üîç Pesquisar por t√≠tulo, conte√∫do ou categoria...&quot;&gt;</span></span>
<span id="cb25-1217"><a href="#cb25-1217" aria-hidden="true" tabindex="-1"></a><span class="ss">        &lt;/div&gt;</span></span>
<span id="cb25-1218"><a href="#cb25-1218" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb25-1219"><a href="#cb25-1219" aria-hidden="true" tabindex="-1"></a><span class="ss">        &lt;div class=&quot;filter-section&quot;&gt;</span></span>
<span id="cb25-1220"><a href="#cb25-1220" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;button class=&quot;filter-btn active&quot; data-filter=&quot;todas&quot;&gt;Todas (</span><span class="sc">{</span><span class="bu">len</span>(<span class="va">self</span>.all_conversations)<span class="sc">}</span><span class="ss">)&lt;/button&gt;</span></span>
<span id="cb25-1221"><a href="#cb25-1221" aria-hidden="true" tabindex="-1"></a><span class="ss">&quot;&quot;&quot;</span></span>
<span id="cb25-1222"><a href="#cb25-1222" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-1223"><a href="#cb25-1223" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> category, count <span class="kw">in</span> category_stats.items():</span>
<span id="cb25-1224"><a href="#cb25-1224" aria-hidden="true" tabindex="-1"></a>            html_content <span class="op">+=</span> <span class="ss">f&#39;&lt;button class=&quot;filter-btn&quot; data-filter=&quot;</span><span class="sc">{</span>category<span class="sc">.</span>lower()<span class="sc">}</span><span class="ss">&quot;&gt;</span><span class="sc">{</span>category<span class="sc">}</span><span class="ss"> (</span><span class="sc">{</span>count<span class="sc">}</span><span class="ss">)&lt;/button&gt;</span><span class="ch">\n</span><span class="ss">&#39;</span></span>
<span id="cb25-1225"><a href="#cb25-1225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1226"><a href="#cb25-1226" aria-hidden="true" tabindex="-1"></a>        html_content <span class="op">+=</span> <span class="st">&quot;&quot;&quot;</span></span>
<span id="cb25-1227"><a href="#cb25-1227" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;/div&gt;</span></span>
<span id="cb25-1228"><a href="#cb25-1228" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb25-1229"><a href="#cb25-1229" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;div style=&quot;text-align: center; padding: 15px; background: #e9ecef; border-bottom: 1px solid #ddd;&quot;&gt;</span></span>
<span id="cb25-1230"><a href="#cb25-1230" aria-hidden="true" tabindex="-1"></a><span class="st">            &lt;strong&gt;Acesso R√°pido:&lt;/strong&gt;</span></span>
<span id="cb25-1231"><a href="#cb25-1231" aria-hidden="true" tabindex="-1"></a><span class="st">            &lt;a href=&quot;combined_markdown/&quot; class=&quot;direct-link&quot; target=&quot;_blank&quot;&gt;üìÅ Markdown&lt;/a&gt;</span></span>
<span id="cb25-1232"><a href="#cb25-1232" aria-hidden="true" tabindex="-1"></a><span class="st">            &lt;a href=&quot;combined_html/&quot; class=&quot;direct-link&quot; target=&quot;_blank&quot;&gt;üåê HTML&lt;/a&gt;</span></span>
<span id="cb25-1233"><a href="#cb25-1233" aria-hidden="true" tabindex="-1"></a><span class="st">            &lt;a href=&quot;combined_pdfs/&quot; class=&quot;direct-link&quot; target=&quot;_blank&quot;&gt;üìä PDFs&lt;/a&gt;</span></span>
<span id="cb25-1234"><a href="#cb25-1234" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;/div&gt;</span></span>
<span id="cb25-1235"><a href="#cb25-1235" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb25-1236"><a href="#cb25-1236" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;div class=&quot;conversations-grid&quot; id=&quot;conversationsGrid&quot;&gt;</span></span>
<span id="cb25-1237"><a href="#cb25-1237" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;&quot;&quot;</span></span>
<span id="cb25-1238"><a href="#cb25-1238" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-1239"><a href="#cb25-1239" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, conv <span class="kw">in</span> <span class="bu">enumerate</span>(<span class="va">self</span>.all_conversations):</span>
<span id="cb25-1240"><a href="#cb25-1240" aria-hidden="true" tabindex="-1"></a>            safe_title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(conv[<span class="st">&#39;title&#39;</span>])</span>
<span id="cb25-1241"><a href="#cb25-1241" aria-hidden="true" tabindex="-1"></a>            filename <span class="op">=</span> <span class="ss">f&quot;</span><span class="sc">{</span>conv[<span class="st">&#39;number&#39;</span>]<span class="sc">:03d}</span><span class="ss">_</span><span class="sc">{</span>conv[<span class="st">&#39;source&#39;</span>]<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>safe_title<span class="sc">}</span><span class="ss">&quot;</span></span>
<span id="cb25-1242"><a href="#cb25-1242" aria-hidden="true" tabindex="-1"></a>            recent_badge <span class="op">=</span> <span class="st">&quot;&lt;span class=&#39;recent-badge&#39;&gt;NOVO&lt;/span&gt;&quot;</span> <span class="cf">if</span> i <span class="op">&lt;</span> <span class="dv">5</span> <span class="cf">else</span> <span class="st">&quot;&quot;</span></span>
<span id="cb25-1243"><a href="#cb25-1243" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-1244"><a href="#cb25-1244" aria-hidden="true" tabindex="-1"></a>            summary <span class="op">=</span> conv.get(<span class="st">&#39;summary&#39;</span>, <span class="st">&#39;Sem resumo dispon√≠vel&#39;</span>)</span>
<span id="cb25-1245"><a href="#cb25-1245" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">len</span>(summary) <span class="op">&gt;</span> <span class="dv">150</span>:</span>
<span id="cb25-1246"><a href="#cb25-1246" aria-hidden="true" tabindex="-1"></a>                summary <span class="op">=</span> summary[:<span class="dv">150</span>] <span class="op">+</span> <span class="st">&quot;...&quot;</span></span>
<span id="cb25-1247"><a href="#cb25-1247" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-1248"><a href="#cb25-1248" aria-hidden="true" tabindex="-1"></a>            html_content <span class="op">+=</span> <span class="ss">f&quot;&quot;&quot;</span></span>
<span id="cb25-1249"><a href="#cb25-1249" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;div class=&quot;conversation-card&quot; data-title=&quot;</span><span class="sc">{</span>conv[<span class="st">&#39;title&#39;</span>]<span class="sc">}</span><span class="ss">&quot; data-summary=&quot;</span><span class="sc">{</span>summary<span class="sc">}</span><span class="ss">&quot; data-source=&quot;</span><span class="sc">{</span>conv[<span class="st">&#39;source&#39;</span>]<span class="sc">.</span>lower()<span class="sc">}</span><span class="ss">&quot; data-category=&quot;</span><span class="sc">{</span>conv[<span class="st">&#39;category&#39;</span>]<span class="sc">.</span>lower()<span class="sc">}</span><span class="ss">&quot;&gt;</span></span>
<span id="cb25-1250"><a href="#cb25-1250" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;div class=&quot;card-header&quot;&gt;</span></span>
<span id="cb25-1251"><a href="#cb25-1251" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;div class=&quot;card-number&quot;&gt;#</span><span class="sc">{</span>conv[<span class="st">&#39;number&#39;</span>]<span class="sc">}</span><span class="ss"> </span><span class="sc">{</span>recent_badge<span class="sc">}</span><span class="ss">&lt;/div&gt;</span></span>
<span id="cb25-1252"><a href="#cb25-1252" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;div class=&quot;card-actions&quot;&gt;</span></span>
<span id="cb25-1253"><a href="#cb25-1253" aria-hidden="true" tabindex="-1"></a><span class="ss">                        &lt;a href=&quot;combined_markdown/</span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">.md&quot; class=&quot;action-btn&quot; target=&quot;_blank&quot; onclick=&quot;event.stopPropagation();&quot;&gt;üìÑ MD&lt;/a&gt;</span></span>
<span id="cb25-1254"><a href="#cb25-1254" aria-hidden="true" tabindex="-1"></a><span class="ss">                        &lt;a href=&quot;combined_html/</span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">.html&quot; class=&quot;action-btn html-btn&quot; target=&quot;_blank&quot; onclick=&quot;event.stopPropagation();&quot;&gt;üåê HTML&lt;/a&gt;</span></span>
<span id="cb25-1255"><a href="#cb25-1255" aria-hidden="true" tabindex="-1"></a><span class="ss">                        &lt;a href=&quot;combined_pdfs/</span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">.pdf&quot; class=&quot;action-btn&quot; target=&quot;_blank&quot; onclick=&quot;event.stopPropagation();&quot;&gt;üìä PDF&lt;/a&gt;</span></span>
<span id="cb25-1256"><a href="#cb25-1256" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;/div&gt;</span></span>
<span id="cb25-1257"><a href="#cb25-1257" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;/div&gt;</span></span>
<span id="cb25-1258"><a href="#cb25-1258" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;div class=&quot;card-title&quot; onclick=&quot;openHTML(&#39;</span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">.html&#39;)&quot;&gt;</span><span class="sc">{</span>conv[<span class="st">&#39;title&#39;</span>]<span class="sc">}</span><span class="ss">&lt;/div&gt;</span></span>
<span id="cb25-1259"><a href="#cb25-1259" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;div&gt;</span></span>
<span id="cb25-1260"><a href="#cb25-1260" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;span class=&quot;card-source&quot;&gt;</span><span class="sc">{</span>conv[<span class="st">&#39;source&#39;</span>]<span class="sc">}</span><span class="ss">&lt;/span&gt;</span></span>
<span id="cb25-1261"><a href="#cb25-1261" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;span class=&quot;category-badge&quot;&gt;</span><span class="sc">{</span>conv[<span class="st">&#39;category&#39;</span>]<span class="sc">}</span><span class="ss">&lt;/span&gt;</span></span>
<span id="cb25-1262"><a href="#cb25-1262" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;/div&gt;</span></span>
<span id="cb25-1263"><a href="#cb25-1263" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;div class=&quot;card-summary&quot; onclick=&quot;openHTML(&#39;</span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">.html&#39;)&quot;&gt;</span><span class="sc">{</span>summary<span class="sc">}</span><span class="ss">&lt;/div&gt;</span></span>
<span id="cb25-1264"><a href="#cb25-1264" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;div class=&quot;card-meta&quot;&gt;</span></span>
<span id="cb25-1265"><a href="#cb25-1265" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;span&gt;üìÖ </span><span class="sc">{</span>conv<span class="sc">.</span>get(<span class="st">&#39;updated_at&#39;</span>) <span class="kw">or</span> conv<span class="sc">.</span>get(<span class="st">&#39;inserted_at&#39;</span>) <span class="kw">or</span> <span class="st">&#39;N/A&#39;</span><span class="sc">}</span><span class="ss">&lt;/span&gt;</span></span>
<span id="cb25-1266"><a href="#cb25-1266" aria-hidden="true" tabindex="-1"></a><span class="ss">                    &lt;span&gt;üí¨ </span><span class="sc">{</span><span class="bu">len</span>(conv[<span class="st">&#39;messages&#39;</span>])<span class="sc">}</span><span class="ss"> mensagens&lt;/span&gt;</span></span>
<span id="cb25-1267"><a href="#cb25-1267" aria-hidden="true" tabindex="-1"></a><span class="ss">                &lt;/div&gt;</span></span>
<span id="cb25-1268"><a href="#cb25-1268" aria-hidden="true" tabindex="-1"></a><span class="ss">            &lt;/div&gt;</span></span>
<span id="cb25-1269"><a href="#cb25-1269" aria-hidden="true" tabindex="-1"></a><span class="ss">            &quot;&quot;&quot;</span></span>
<span id="cb25-1270"><a href="#cb25-1270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1271"><a href="#cb25-1271" aria-hidden="true" tabindex="-1"></a>        html_content <span class="op">+=</span> <span class="st">&quot;&quot;&quot;</span></span>
<span id="cb25-1272"><a href="#cb25-1272" aria-hidden="true" tabindex="-1"></a><span class="st">        &lt;/div&gt;</span></span>
<span id="cb25-1273"><a href="#cb25-1273" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;/div&gt;</span></span>
<span id="cb25-1274"><a href="#cb25-1274" aria-hidden="true" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb25-1275"><a href="#cb25-1275" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;script&gt;</span></span>
<span id="cb25-1276"><a href="#cb25-1276" aria-hidden="true" tabindex="-1"></a><span class="st">        let currentFilter = &#39;todas&#39;;</span></span>
<span id="cb25-1277"><a href="#cb25-1277" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb25-1278"><a href="#cb25-1278" aria-hidden="true" tabindex="-1"></a><span class="st">        document.addEventListener(&#39;DOMContentLoaded&#39;, function() {</span></span>
<span id="cb25-1279"><a href="#cb25-1279" aria-hidden="true" tabindex="-1"></a><span class="st">            updateStats();</span></span>
<span id="cb25-1280"><a href="#cb25-1280" aria-hidden="true" tabindex="-1"></a><span class="st">        });</span></span>
<span id="cb25-1281"><a href="#cb25-1281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1282"><a href="#cb25-1282" aria-hidden="true" tabindex="-1"></a><span class="st">        document.querySelectorAll(&#39;.filter-btn&#39;).forEach(btn =&gt; {</span></span>
<span id="cb25-1283"><a href="#cb25-1283" aria-hidden="true" tabindex="-1"></a><span class="st">            btn.addEventListener(&#39;click&#39;, () =&gt; {</span></span>
<span id="cb25-1284"><a href="#cb25-1284" aria-hidden="true" tabindex="-1"></a><span class="st">                document.querySelectorAll(&#39;.filter-btn&#39;).forEach(b =&gt; b.classList.remove(&#39;active&#39;));</span></span>
<span id="cb25-1285"><a href="#cb25-1285" aria-hidden="true" tabindex="-1"></a><span class="st">                btn.classList.add(&#39;active&#39;);</span></span>
<span id="cb25-1286"><a href="#cb25-1286" aria-hidden="true" tabindex="-1"></a><span class="st">                currentFilter = btn.getAttribute(&#39;data-filter&#39;);</span></span>
<span id="cb25-1287"><a href="#cb25-1287" aria-hidden="true" tabindex="-1"></a><span class="st">                filterConversations();</span></span>
<span id="cb25-1288"><a href="#cb25-1288" aria-hidden="true" tabindex="-1"></a><span class="st">            });</span></span>
<span id="cb25-1289"><a href="#cb25-1289" aria-hidden="true" tabindex="-1"></a><span class="st">        });</span></span>
<span id="cb25-1290"><a href="#cb25-1290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1291"><a href="#cb25-1291" aria-hidden="true" tabindex="-1"></a><span class="st">        document.getElementById(&#39;searchInput&#39;).addEventListener(&#39;input&#39;, filterConversations);</span></span>
<span id="cb25-1292"><a href="#cb25-1292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1293"><a href="#cb25-1293" aria-hidden="true" tabindex="-1"></a><span class="st">        function filterConversations() {</span></span>
<span id="cb25-1294"><a href="#cb25-1294" aria-hidden="true" tabindex="-1"></a><span class="st">            const term = document.getElementById(&#39;searchInput&#39;).value.toLowerCase();</span></span>
<span id="cb25-1295"><a href="#cb25-1295" aria-hidden="true" tabindex="-1"></a><span class="st">            const cards = document.querySelectorAll(&#39;.conversation-card&#39;);</span></span>
<span id="cb25-1296"><a href="#cb25-1296" aria-hidden="true" tabindex="-1"></a><span class="st">            let visible = 0;</span></span>
<span id="cb25-1297"><a href="#cb25-1297" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb25-1298"><a href="#cb25-1298" aria-hidden="true" tabindex="-1"></a><span class="st">            cards.forEach(card =&gt; {</span></span>
<span id="cb25-1299"><a href="#cb25-1299" aria-hidden="true" tabindex="-1"></a><span class="st">                const title = card.getAttribute(&#39;data-title&#39;).toLowerCase();</span></span>
<span id="cb25-1300"><a href="#cb25-1300" aria-hidden="true" tabindex="-1"></a><span class="st">                const summary = card.getAttribute(&#39;data-summary&#39;).toLowerCase();</span></span>
<span id="cb25-1301"><a href="#cb25-1301" aria-hidden="true" tabindex="-1"></a><span class="st">                const source = card.getAttribute(&#39;data-source&#39;).toLowerCase();</span></span>
<span id="cb25-1302"><a href="#cb25-1302" aria-hidden="true" tabindex="-1"></a><span class="st">                const category = card.getAttribute(&#39;data-category&#39;).toLowerCase();</span></span>
<span id="cb25-1303"><a href="#cb25-1303" aria-hidden="true" tabindex="-1"></a><span class="st">                </span></span>
<span id="cb25-1304"><a href="#cb25-1304" aria-hidden="true" tabindex="-1"></a><span class="st">                const matchesSearch = (title.includes(term) || summary.includes(term) || category.includes(term) || source.includes(term));</span></span>
<span id="cb25-1305"><a href="#cb25-1305" aria-hidden="true" tabindex="-1"></a><span class="st">                const matchesCategory = (currentFilter === &#39;todas&#39; || category === currentFilter);</span></span>
<span id="cb25-1306"><a href="#cb25-1306" aria-hidden="true" tabindex="-1"></a><span class="st">                </span></span>
<span id="cb25-1307"><a href="#cb25-1307" aria-hidden="true" tabindex="-1"></a><span class="st">                if (matchesSearch &amp;&amp; matchesCategory) {</span></span>
<span id="cb25-1308"><a href="#cb25-1308" aria-hidden="true" tabindex="-1"></a><span class="st">                    card.style.display = &#39;block&#39;;</span></span>
<span id="cb25-1309"><a href="#cb25-1309" aria-hidden="true" tabindex="-1"></a><span class="st">                    visible++;</span></span>
<span id="cb25-1310"><a href="#cb25-1310" aria-hidden="true" tabindex="-1"></a><span class="st">                } else {</span></span>
<span id="cb25-1311"><a href="#cb25-1311" aria-hidden="true" tabindex="-1"></a><span class="st">                    card.style.display = &#39;none&#39;;</span></span>
<span id="cb25-1312"><a href="#cb25-1312" aria-hidden="true" tabindex="-1"></a><span class="st">                }</span></span>
<span id="cb25-1313"><a href="#cb25-1313" aria-hidden="true" tabindex="-1"></a><span class="st">            });</span></span>
<span id="cb25-1314"><a href="#cb25-1314" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb25-1315"><a href="#cb25-1315" aria-hidden="true" tabindex="-1"></a><span class="st">            updateStats(visible);</span></span>
<span id="cb25-1316"><a href="#cb25-1316" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb25-1317"><a href="#cb25-1317" aria-hidden="true" tabindex="-1"></a><span class="st">            const grid = document.getElementById(&#39;conversationsGrid&#39;);</span></span>
<span id="cb25-1318"><a href="#cb25-1318" aria-hidden="true" tabindex="-1"></a><span class="st">            const noResults = document.getElementById(&#39;no-results-message&#39;);</span></span>
<span id="cb25-1319"><a href="#cb25-1319" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb25-1320"><a href="#cb25-1320" aria-hidden="true" tabindex="-1"></a><span class="st">            if (visible === 0) {</span></span>
<span id="cb25-1321"><a href="#cb25-1321" aria-hidden="true" tabindex="-1"></a><span class="st">                if (!noResults) {</span></span>
<span id="cb25-1322"><a href="#cb25-1322" aria-hidden="true" tabindex="-1"></a><span class="st">                    const noResultsMsg = document.createElement(&#39;div&#39;);</span></span>
<span id="cb25-1323"><a href="#cb25-1323" aria-hidden="true" tabindex="-1"></a><span class="st">                    noResultsMsg.id = &#39;no-results-message&#39;;</span></span>
<span id="cb25-1324"><a href="#cb25-1324" aria-hidden="true" tabindex="-1"></a><span class="st">                    noResultsMsg.className = &#39;no-results&#39;;</span></span>
<span id="cb25-1325"><a href="#cb25-1325" aria-hidden="true" tabindex="-1"></a><span class="st">                    noResultsMsg.innerHTML = &#39;üîç Nenhuma conversa encontrada. Tente ajustar os filtros ou a pesquisa.&#39;;</span></span>
<span id="cb25-1326"><a href="#cb25-1326" aria-hidden="true" tabindex="-1"></a><span class="st">                    grid.appendChild(noResultsMsg);</span></span>
<span id="cb25-1327"><a href="#cb25-1327" aria-hidden="true" tabindex="-1"></a><span class="st">                }</span></span>
<span id="cb25-1328"><a href="#cb25-1328" aria-hidden="true" tabindex="-1"></a><span class="st">            } else if (noResults) {</span></span>
<span id="cb25-1329"><a href="#cb25-1329" aria-hidden="true" tabindex="-1"></a><span class="st">                noResults.remove();</span></span>
<span id="cb25-1330"><a href="#cb25-1330" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb25-1331"><a href="#cb25-1331" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb25-1332"><a href="#cb25-1332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1333"><a href="#cb25-1333" aria-hidden="true" tabindex="-1"></a><span class="st">        function updateStats(visibleCount = null) {</span></span>
<span id="cb25-1334"><a href="#cb25-1334" aria-hidden="true" tabindex="-1"></a><span class="st">            const totalElement = document.getElementById(&#39;total-count&#39;);</span></span>
<span id="cb25-1335"><a href="#cb25-1335" aria-hidden="true" tabindex="-1"></a><span class="st">            if (visibleCount !== null) {</span></span>
<span id="cb25-1336"><a href="#cb25-1336" aria-hidden="true" tabindex="-1"></a><span class="st">                totalElement.textContent = visibleCount;</span></span>
<span id="cb25-1337"><a href="#cb25-1337" aria-hidden="true" tabindex="-1"></a><span class="st">            } else {</span></span>
<span id="cb25-1338"><a href="#cb25-1338" aria-hidden="true" tabindex="-1"></a><span class="st">                totalElement.textContent = &quot;&quot;&quot;</span> <span class="op">+</span> <span class="bu">str</span>(<span class="bu">len</span>(<span class="va">self</span>.all_conversations)) <span class="op">+</span> <span class="st">&quot;&quot;&quot;;</span></span>
<span id="cb25-1339"><a href="#cb25-1339" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb25-1340"><a href="#cb25-1340" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb25-1341"><a href="#cb25-1341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1342"><a href="#cb25-1342" aria-hidden="true" tabindex="-1"></a><span class="st">        function openHTML(filename) {</span></span>
<span id="cb25-1343"><a href="#cb25-1343" aria-hidden="true" tabindex="-1"></a><span class="st">            const htmlUrl = &#39;combined_html/&#39; + filename;</span></span>
<span id="cb25-1344"><a href="#cb25-1344" aria-hidden="true" tabindex="-1"></a><span class="st">            console.log(&#39;Abrindo HTML:&#39;, htmlUrl);</span></span>
<span id="cb25-1345"><a href="#cb25-1345" aria-hidden="true" tabindex="-1"></a><span class="st">            window.open(htmlUrl, &#39;_blank&#39;);</span></span>
<span id="cb25-1346"><a href="#cb25-1346" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb25-1347"><a href="#cb25-1347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1348"><a href="#cb25-1348" aria-hidden="true" tabindex="-1"></a><span class="st">        function openMD(filename) {</span></span>
<span id="cb25-1349"><a href="#cb25-1349" aria-hidden="true" tabindex="-1"></a><span class="st">            const mdUrl = &#39;combined_markdown/&#39; + filename;</span></span>
<span id="cb25-1350"><a href="#cb25-1350" aria-hidden="true" tabindex="-1"></a><span class="st">            window.open(mdUrl, &#39;_blank&#39;);</span></span>
<span id="cb25-1351"><a href="#cb25-1351" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb25-1352"><a href="#cb25-1352" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb25-1353"><a href="#cb25-1353" aria-hidden="true" tabindex="-1"></a><span class="st">        function openPDF(filename) {</span></span>
<span id="cb25-1354"><a href="#cb25-1354" aria-hidden="true" tabindex="-1"></a><span class="st">            const pdfFile = filename.replace(&#39;.md&#39;, &#39;.pdf&#39;);</span></span>
<span id="cb25-1355"><a href="#cb25-1355" aria-hidden="true" tabindex="-1"></a><span class="st">            const pdfUrl = &#39;combined_pdfs/&#39; + pdfFile;</span></span>
<span id="cb25-1356"><a href="#cb25-1356" aria-hidden="true" tabindex="-1"></a><span class="st">            window.open(pdfUrl, &#39;_blank&#39;);</span></span>
<span id="cb25-1357"><a href="#cb25-1357" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb25-1358"><a href="#cb25-1358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1359"><a href="#cb25-1359" aria-hidden="true" tabindex="-1"></a><span class="st">        document.addEventListener(&#39;keydown&#39;, function(e) {</span></span>
<span id="cb25-1360"><a href="#cb25-1360" aria-hidden="true" tabindex="-1"></a><span class="st">            if (e.key === &#39;Escape&#39;) {</span></span>
<span id="cb25-1361"><a href="#cb25-1361" aria-hidden="true" tabindex="-1"></a><span class="st">                document.getElementById(&#39;searchInput&#39;).value = &#39;&#39;;</span></span>
<span id="cb25-1362"><a href="#cb25-1362" aria-hidden="true" tabindex="-1"></a><span class="st">                filterConversations();</span></span>
<span id="cb25-1363"><a href="#cb25-1363" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb25-1364"><a href="#cb25-1364" aria-hidden="true" tabindex="-1"></a><span class="st">        });</span></span>
<span id="cb25-1365"><a href="#cb25-1365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1366"><a href="#cb25-1366" aria-hidden="true" tabindex="-1"></a><span class="st">        document.querySelectorAll(&#39;.conversation-card&#39;).forEach(card =&gt; {</span></span>
<span id="cb25-1367"><a href="#cb25-1367" aria-hidden="true" tabindex="-1"></a><span class="st">            card.addEventListener(&#39;click&#39;, function(e) {</span></span>
<span id="cb25-1368"><a href="#cb25-1368" aria-hidden="true" tabindex="-1"></a><span class="st">                if (e.target.closest(&#39;.action-btn&#39;)) {</span></span>
<span id="cb25-1369"><a href="#cb25-1369" aria-hidden="true" tabindex="-1"></a><span class="st">                    return;</span></span>
<span id="cb25-1370"><a href="#cb25-1370" aria-hidden="true" tabindex="-1"></a><span class="st">                }</span></span>
<span id="cb25-1371"><a href="#cb25-1371" aria-hidden="true" tabindex="-1"></a><span class="st">                </span></span>
<span id="cb25-1372"><a href="#cb25-1372" aria-hidden="true" tabindex="-1"></a><span class="st">                const htmlBtn = this.querySelector(&#39;a.html-btn&#39;);</span></span>
<span id="cb25-1373"><a href="#cb25-1373" aria-hidden="true" tabindex="-1"></a><span class="st">                if (htmlBtn) {</span></span>
<span id="cb25-1374"><a href="#cb25-1374" aria-hidden="true" tabindex="-1"></a><span class="st">                    const htmlUrl = htmlBtn.getAttribute(&#39;href&#39;);</span></span>
<span id="cb25-1375"><a href="#cb25-1375" aria-hidden="true" tabindex="-1"></a><span class="st">                    window.open(htmlUrl, &#39;_blank&#39;);</span></span>
<span id="cb25-1376"><a href="#cb25-1376" aria-hidden="true" tabindex="-1"></a><span class="st">                }</span></span>
<span id="cb25-1377"><a href="#cb25-1377" aria-hidden="true" tabindex="-1"></a><span class="st">            });</span></span>
<span id="cb25-1378"><a href="#cb25-1378" aria-hidden="true" tabindex="-1"></a><span class="st">        });</span></span>
<span id="cb25-1379"><a href="#cb25-1379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1380"><a href="#cb25-1380" aria-hidden="true" tabindex="-1"></a><span class="st">        document.getElementById(&#39;searchInput&#39;).focus();</span></span>
<span id="cb25-1381"><a href="#cb25-1381" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb25-1382"><a href="#cb25-1382" aria-hidden="true" tabindex="-1"></a><span class="st">        console.log(&#39;√çndice carregado com&#39;, &quot;&quot;&quot;</span> <span class="op">+</span> <span class="bu">str</span>(<span class="bu">len</span>(<span class="va">self</span>.all_conversations)) <span class="op">+</span> <span class="st">&quot;&quot;&quot;, &#39;conversas&#39;);</span></span>
<span id="cb25-1383"><a href="#cb25-1383" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;/script&gt;</span></span>
<span id="cb25-1384"><a href="#cb25-1384" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;/body&gt;</span></span>
<span id="cb25-1385"><a href="#cb25-1385" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;/html&gt;</span></span>
<span id="cb25-1386"><a href="#cb25-1386" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;&quot;&quot;</span></span>
<span id="cb25-1387"><a href="#cb25-1387" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-1388"><a href="#cb25-1388" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> <span class="bu">open</span>(<span class="va">self</span>.index_file, <span class="st">&#39;w&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb25-1389"><a href="#cb25-1389" aria-hidden="true" tabindex="-1"></a>            f.write(html_content)</span>
<span id="cb25-1390"><a href="#cb25-1390" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;‚úÖ √çndice combinado criado: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>index_file<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb25-1391"><a href="#cb25-1391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1392"><a href="#cb25-1392" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> main():</span>
<span id="cb25-1393"><a href="#cb25-1393" aria-hidden="true" tabindex="-1"></a>    parser <span class="op">=</span> argparse.ArgumentParser(</span>
<span id="cb25-1394"><a href="#cb25-1394" aria-hidden="true" tabindex="-1"></a>        description<span class="op">=</span><span class="st">&quot;Processa exporta√ß√µes combinadas com exporta√ß√£o HTML via Pandoc.&quot;</span></span>
<span id="cb25-1395"><a href="#cb25-1395" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb25-1396"><a href="#cb25-1396" aria-hidden="true" tabindex="-1"></a>    parser.add_argument(<span class="st">&quot;--dry-run&quot;</span>, action<span class="op">=</span><span class="st">&quot;store_true&quot;</span>, <span class="bu">help</span><span class="op">=</span><span class="st">&quot;Executa sem salvar arquivos&quot;</span>)</span>
<span id="cb25-1397"><a href="#cb25-1397" aria-hidden="true" tabindex="-1"></a>    parser.add_argument(<span class="st">&quot;--force-overwrite&quot;</span>, action<span class="op">=</span><span class="st">&quot;store_true&quot;</span>, <span class="bu">help</span><span class="op">=</span><span class="st">&quot;Substitui arquivos existentes&quot;</span>)</span>
<span id="cb25-1398"><a href="#cb25-1398" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-1399"><a href="#cb25-1399" aria-hidden="true" tabindex="-1"></a>    args <span class="op">=</span> parser.parse_args()</span>
<span id="cb25-1400"><a href="#cb25-1400" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-1401"><a href="#cb25-1401" aria-hidden="true" tabindex="-1"></a>    system <span class="op">=</span> CombinedFragmentsSystem(</span>
<span id="cb25-1402"><a href="#cb25-1402" aria-hidden="true" tabindex="-1"></a>        dry_run<span class="op">=</span>args.dry_run,</span>
<span id="cb25-1403"><a href="#cb25-1403" aria-hidden="true" tabindex="-1"></a>        force_overwrite<span class="op">=</span>args.force_overwrite</span>
<span id="cb25-1404"><a href="#cb25-1404" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb25-1405"><a href="#cb25-1405" aria-hidden="true" tabindex="-1"></a>    system.run()</span>
<span id="cb25-1406"><a href="#cb25-1406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1407"><a href="#cb25-1407" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&quot;__main__&quot;</span>:</span>
<span id="cb25-1408"><a href="#cb25-1408" aria-hidden="true" tabindex="-1"></a>    main()</span></code></pre></div>
<h2 data-number="1.23" id="principais-corre√ß√µes-implementadas-1"><span class="header-section-number">1.23</span> üöÄ <strong>Principais
Corre√ß√µes Implementadas:</strong></h2>
<h3 data-number="1.23.1" id="convers√£o-pandoc-corrigida"><span class="header-section-number">1.23.1</span> <strong>‚úÖ Convers√£o Pandoc
Corrigida:</strong></h3>
<ul>
<li><strong>Comando simplificado</strong>:
<code>pandoc arquivo.md --standalone --mathjax -o arquivo.html</code></li>
<li><strong>Tratamento de erros robusto</strong>: Sem opera√ß√µes
problem√°ticas com strings</li>
<li><strong>Timeout adequado</strong>: 30 segundos por arquivo</li>
<li><strong>Logs claros</strong>: Mostra sucessos e falhas de forma
organizada</li>
</ul>
<h3 data-number="1.23.2" id="fluxo-completo"><span class="header-section-number">1.23.2</span> <strong>üéØ Fluxo
Completo:</strong></h3>
<ol type="1">
<li><strong>ZIP ‚Üí Processor</strong>: Extrai dados dos arquivos de
exporta√ß√£o</li>
<li><strong>Processor ‚Üí Markdown</strong>: Gera 206 arquivos MD com
formata√ß√£o preservada<br />
</li>
<li><strong>Markdown ‚Üí HTML</strong>: Converte com
<code>pandoc --standalone --mathjax</code></li>
</ol>
<h3 data-number="1.23.3" id="estrutura-de-pastas"><span class="header-section-number">1.23.3</span> <strong>üìÅ Estrutura de
Pastas:</strong></h3>
<ul>
<li><code>combined_markdown/</code> - Arquivos Markdown</li>
<li><code>combined_html/</code> - HTMLs gerados pelo Pandoc</li>
<li><code>combined_pdfs/</code> - PDFs (para gerar depois com
comb_pdf_direct5)</li>
<li><code>combined_csv/</code>, <code>combined_json/</code> - Outros
formatos</li>
<li><code>index.html</code> - √çndice naveg√°vel</li>
</ul>
<p><strong>Execute agora:</strong></p>
<div class="sourceCode" id="cb26"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> comb_fragments_system3_html_export.py <span class="at">--force-overwrite</span></span></code></pre></div>
<p>Agora deve funcionar perfeitamente! üéâ</p>
<hr />
<p><em>Conversa exportada do DeepSeek</em> <em>Processado em: 24/11/2025
22:27</em></p>

        <script id="fixed-toc-script">
        document.addEventListener('DOMContentLoaded', function() {
            const toc = document.getElementById('TOC');
            if (toc) {
                const tocTitle = toc.querySelector('h2');
                if (tocTitle) {
                    const toggleBtn = document.createElement('button');
                    toggleBtn.innerHTML = '‚ò∞';
                    toggleBtn.className = 'toc-toggle-btn';
                    toggleBtn.title = 'Minimizar/Expandir TOC';
                    let isMinimized = false;
                    toggleBtn.addEventListener('click', function(e) {
                        e.stopPropagation();
                        isMinimized = !isMinimized;
                        if (isMinimized) {
                            toc.classList.add('toc-minimized');
                        } else {
                            toc.classList.remove('toc-minimized');
                        }
                    });
                    tocTitle.appendChild(toggleBtn);
                }
            }
            
            // SCROLLSPY
            const sections = document.querySelectorAll('h1, h2, h3, h4, h5');
            const tocLinks = document.querySelectorAll('#TOC a');
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const id = entry.target.getAttribute('id');
                        tocLinks.forEach(link => {
                            link.classList.remove('active');
                            if (link.getAttribute('href') === '#' + id) {
                                link.classList.add('active');
                            }
                        });
                    }
                });
            }, { 
                rootMargin: '-20% 0px -60% 0px', 
                threshold: 0 
            });
            
            sections.forEach(section => {
                if (section.id) observer.observe(section);
            });
            
            // Scroll suave
            tocLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const targetId = link.getAttribute('href').substring(1);
                    const targetElement = document.getElementById(targetId);
                    if (targetElement) {
                        const offsetTop = targetElement.offsetTop - 80;
                        window.scrollTo({ top: offsetTop, behavior: 'smooth' });
                    }
                });
            });
            
            // BOT√ÉO VOLTAR AO TOPO
            const backToTopBtn = document.createElement('button');
            backToTopBtn.className = 'back-to-top-content';
            backToTopBtn.innerHTML = '‚Üë';
            backToTopBtn.title = 'Voltar ao Topo';
            document.body.appendChild(backToTopBtn);
            
            window.addEventListener('scroll', () => {
                if (window.pageYOffset > 300) {
                    backToTopBtn.classList.add('show');
                } else {
                    backToTopBtn.classList.remove('show');
                }
            });
            
            backToTopBtn.addEventListener('click', () => {
                window.scrollTo({ top: 0, behavior: 'smooth' });
            });
        });
        </script>
        
</body>
</html>
