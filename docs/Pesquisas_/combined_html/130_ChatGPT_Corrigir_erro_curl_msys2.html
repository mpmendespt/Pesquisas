<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang xml:lang>
<head>

        <style id="fixed-toc-styles">
        /* === ESTILOS PRINCIPAIS - TOC FIXO √Ä DIREITA === */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
            scroll-behavior: smooth;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            position: relative;
        }
        /* === TOC FIXO √Ä DIREITA - POSI√á√ÉO CORRIGIDA === */
        #TOC {
            position: fixed !important;
            top: 50% !important;
            right: 20px !important;
            transform: translateY(-50%) !important;
            width: 320px !important;
            max-height: 80vh !important;
            overflow-y: auto !important;
            z-index: 1000 !important;
            background: rgba(255, 255, 255, 0.98) !important;
            padding: 20px !important;
            border-radius: 12px !important;
            box-shadow: 0 8px 32px rgba(0,0,0,0.15) !important;
            border: 1px solid #e0e0e0 !important;
            backdrop-filter: blur(10px) !important;
            transition: all 0.3s ease-in-out !important;
        }
        #TOC.toc-minimized {
            transform: translateY(-50%) translateX(calc(320px - 50px)) !important;
            opacity: 0.3;
            width: 50px !important;
            overflow: hidden;
        }
        #TOC.toc-minimized > *:not(.toc-toggle-btn) {
            display: none !important;
        }
        #TOC h2 {
            margin-top: 0;
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
            font-size: 1.2em;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .toc-toggle-btn {
            background: none;
            border: none;
            font-size: 1.2em;
            cursor: pointer;
            padding: 5px;
            border-radius: 4px;
            transition: background-color 0.2s;
        }
        .toc-toggle-btn:hover {
            background-color: rgba(0,0,0,0.1);
        }
        #TOC ul {
            list-style-type: none;
            padding-left: 15px;
            margin: 10px 0;
        }
        #TOC ul ul {
            padding-left: 20px;
        }
        #TOC li {
            margin: 8px 0;
            line-height: 1.4;
        }
        #TOC a {
            text-decoration: none;
            color: #495057;
            font-weight: 500;
            transition: all 0.2s ease;
            display: block;
            padding: 6px 10px;
            border-radius: 6px;
            border-left: 3px solid transparent;
        }
        #TOC a:hover {
            color: #007bff;
            background-color: rgba(0, 123, 255, 0.1);
            border-left-color: #007bff;
        }
        #TOC a.active {
            background-color: #007bff !important;
            color: white !important;
            font-weight: bold;
            border-left-color: #0056b3;
        }
        /* Conte√∫do principal com margem para o TOC */
        .main-content {
            margin-right: calc(320px + 40px) !important;
        }
        /* Barra de scroll personalizada APENAS para TOC */
        #TOC::-webkit-scrollbar {
            width: 8px;
        }
        #TOC::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }
        #TOC::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 4px;
        }
        #TOC::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }
        /* === BOT√ÉO VOLTAR AO TOPO (HTMLs individuais) === */
        .back-to-top-content {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            font-size: 18px;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 999;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .back-to-top-content.show {
            opacity: 1;
            transform: translateY(0);
        }
        .back-to-top-content:hover {
            background: #0056b3;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0,0,0,0.2);
        }
        /* === RESPONSIVIDADE === */
        @media (max-width: 1400px) {
            .container {
                max-width: 95%;
                padding: 30px;
            }
            #TOC {
                width: 280px !important;
            }
            .main-content {
                margin-right: 320px !important;
            }
        }
        @media (max-width: 1200px) {
            #TOC {
                width: 260px !important;
                right: 15px !important;
            }
            .main-content {
                margin-right: 300px !important;
            }
        }
        @media (max-width: 992px) {
            #TOC {
                position: relative !important;
                width: 100% !important;
                right: 0 !important;
                top: 0 !important;
                transform: none !important;
                margin: 20px 0;
                max-height: 300px !important;
            }
            .main-content {
                margin-right: 0 !important;
            }
            .back-to-top-content {
                right: 20px;
                bottom: 20px;
            }
        }
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            .container {
                padding: 20px;
                max-width: 100%;
            }
            #TOC {
                max-height: 250px !important;
                padding: 15px !important;
            }
        }
        </style>
        
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>130_ChatGPT_Corrigir_erro_curl_msys2</title>
  <style>

html {
color: #1a1a1a;
background-color: #fdfdfd;
}
body {
margin: 0 auto;
max-width: 36em;
padding-left: 50px;
padding-right: 50px;
padding-top: 50px;
padding-bottom: 50px;
hyphens: auto;
overflow-wrap: break-word;
text-rendering: optimizeLegibility;
font-kerning: normal;
}
@media (max-width: 600px) {
body {
font-size: 0.9em;
padding: 12px;
}
h1 {
font-size: 1.8em;
}
}
@media print {
html {
background-color: white;
}
body {
background-color: transparent;
color: black;
font-size: 12pt;
}
p, h2, h3 {
orphans: 3;
widows: 3;
}
h2, h3, h4 {
page-break-after: avoid;
}
}
p {
margin: 1em 0;
}
a {
color: #1a1a1a;
}
a:visited {
color: #1a1a1a;
}
img {
max-width: 100%;
}
svg {
height: auto;
max-width: 100%;
}
h1, h2, h3, h4, h5, h6 {
margin-top: 1.4em;
}
h5, h6 {
font-size: 1em;
font-style: italic;
}
h6 {
font-weight: normal;
}
ol, ul {
padding-left: 1.7em;
margin-top: 1em;
}
li > ol, li > ul {
margin-top: 0;
}
blockquote {
margin: 1em 0 1em 1.7em;
padding-left: 1em;
border-left: 2px solid #e6e6e6;
color: #606060;
}
code {
font-family: Menlo, Monaco, Consolas, 'Lucida Console', monospace;
font-size: 85%;
margin: 0;
hyphens: manual;
}
pre {
margin: 1em 0;
overflow: auto;
}
pre code {
padding: 0;
overflow: visible;
overflow-wrap: normal;
}
.sourceCode {
background-color: transparent;
overflow: visible;
}
hr {
border: none;
border-top: 1px solid #1a1a1a;
height: 1px;
margin: 1em 0;
}
table {
margin: 1em 0;
border-collapse: collapse;
width: 100%;
overflow-x: auto;
display: block;
font-variant-numeric: lining-nums tabular-nums;
}
table caption {
margin-bottom: 0.75em;
}
tbody {
margin-top: 0.5em;
border-top: 1px solid #1a1a1a;
border-bottom: 1px solid #1a1a1a;
}
th {
border-top: 1px solid #1a1a1a;
padding: 0.25em 0.5em 0.25em 0.5em;
}
td {
padding: 0.125em 0.5em 0.25em 0.5em;
}
header {
margin-bottom: 4em;
text-align: center;
}
#TOC li {
list-style: none;
}
#TOC ul {
padding-left: 1.3em;
}
#TOC > ul {
padding-left: 0;
}
#TOC a:not(:hover) {
text-decoration: none;
}
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}

ul.task-list[class]{list-style: none;}
ul.task-list li input[type="checkbox"] {
font-size: inherit;
width: 0.8em;
margin: 0 0.8em 0.2em -1.6em;
vertical-align: middle;
}

html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
</head>
<body>
<nav id="TOC" role="doc-toc">
<ul>
<li><a href="#corrigir-erro-curl-msys2" id="toc-corrigir-erro-curl-msys2"><span class="toc-section-number">1</span> Corrigir erro curl msys2</a>
<ul>
<li><a href="#informa√ß√µes" id="toc-informa√ß√µes"><span class="toc-section-number">1.1</span> üìä Informa√ß√µes</a></li>
<li><a href="#conversa" id="toc-conversa"><span class="toc-section-number">1.2</span> üí¨ Conversa</a></li>
</ul></li>
<li><a href="#pacman--s-ca-certificates-ca-certificates-mozilla-mingw-w64-x86_64-ca-certificates" id="toc-pacman--s-ca-certificates-ca-certificates-mozilla-mingw-w64-x86_64-ca-certificates"><span class="toc-section-number">2</span> pacman -S ca-certificates
ca-certificates-mozilla mingw-w64-x86_64-ca-certificates</a>
<ul>
<li><a href="#solu√ß√£o-definitiva-fazer-o-curl-do-msys2-usar-o-ca-store-do-windows" id="toc-solu√ß√£o-definitiva-fazer-o-curl-do-msys2-usar-o-ca-store-do-windows"><span class="toc-section-number">2.1</span> üß© Solu√ß√£o definitiva: fazer o
<code>curl</code> do MSYS2 usar o CA store do Windows</a></li>
<li><a href="#corre√ß√£o-definitiva-funciona-mesmo" id="toc-corre√ß√£o-definitiva-funciona-mesmo"><span class="toc-section-number">2.2</span> ‚úÖ Corre√ß√£o definitiva (funciona
mesmo)</a></li>
<li><a href="#diagn√≥stico-r√°pido" id="toc-diagn√≥stico-r√°pido"><span class="toc-section-number">2.3</span> üß© Diagn√≥stico r√°pido</a></li>
<li><a href="#solu√ß√£o-passo-a-passo-funciona-100" id="toc-solu√ß√£o-passo-a-passo-funciona-100"><span class="toc-section-number">2.4</span> ‚úÖ Solu√ß√£o passo a passo (funciona
100%)</a></li>
</ul></li>
<li><a href="#echo-curl_ca_bundle" id="toc-echo-curl_ca_bundle"><span class="toc-section-number">3</span> echo $CURL_CA_BUNDLE</a>
<ul>
<li><a href="#etapas-para-corrigir-definitivamente" id="toc-etapas-para-corrigir-definitivamente"><span class="toc-section-number">3.1</span> üß© Etapas para corrigir
definitivamente</a></li>
</ul></li>
<li><a href="#curl-cacert-usrsslcertswindows-ca-bundle.crt--i-httpsgithub.com" id="toc-curl-cacert-usrsslcertswindows-ca-bundle.crt--i-httpsgithub.com"><span class="toc-section-number">4</span> curl ‚Äìcacert
/usr/ssl/certs/windows-ca-bundle.crt -I https://github.com</a>
<ul>
<li><a href="#script-powershell-final-com-corre√ß√£o-autom√°tica" id="toc-script-powershell-final-com-corre√ß√£o-autom√°tica"><span class="toc-section-number">4.1</span> ‚öôÔ∏è Script PowerShell Final (com
corre√ß√£o autom√°tica)</a></li>
<li><a href="#como-usar-2" id="toc-como-usar-2"><span class="toc-section-number">4.2</span> üß≠ Como usar</a></li>
<li><a href="#por-que-agora-vai-funcionar" id="toc-por-que-agora-vai-funcionar"><span class="toc-section-number">4.3</span> üß† Por que agora vai
funcionar</a></li>
<li><a href="#resumo-do-objetivo" id="toc-resumo-do-objetivo"><span class="toc-section-number">4.4</span> Resumo do objetivo</a></li>
<li><a href="#criar-a-pasta-de-destino-powershell-admin" id="toc-criar-a-pasta-de-destino-powershell-admin"><span class="toc-section-number">4.5</span> 1) Criar a pasta de destino
(PowerShell Admin)</a></li>
<li><a href="#exportar-os-certificados-do-windows-root-store-em-pem-ascii-puro" id="toc-exportar-os-certificados-do-windows-root-store-em-pem-ascii-puro"><span class="toc-section-number">4.6</span> 2) Exportar os certificados do
Windows Root Store em PEM (ASCII puro)</a></li>
<li><a href="#verificar-conte√∫do-e-encoding-do-bundle" id="toc-verificar-conte√∫do-e-encoding-do-bundle"><span class="toc-section-number">4.7</span> 3) Verificar conte√∫do e encoding
do bundle</a></li>
<li><a href="#consertar-permiss√µes-powershell-admin" id="toc-consertar-permiss√µes-powershell-admin"><span class="toc-section-number">4.8</span> 4) Consertar permiss√µes
(PowerShell Admin)</a></li>
<li><a href="#definir-a-vari√°vel-de-ambiente-global-windows-powershell-admin" id="toc-definir-a-vari√°vel-de-ambiente-global-windows-powershell-admin"><span class="toc-section-number">4.9</span> 5) Definir a vari√°vel de ambiente
(global, Windows) ‚Äî PowerShell Admin</a></li>
<li><a href="#opcional-fazer-uma-c√≥pia-como-usrsslcertsca-bundle.crt-no-formato-unix" id="toc-opcional-fazer-uma-c√≥pia-como-usrsslcertsca-bundle.crt-no-formato-unix"><span class="toc-section-number">4.10</span> 6) (Opcional) Fazer uma c√≥pia
como <code>/usr/ssl/certs/ca-bundle.crt</code> no formato UNIX</a></li>
<li><a href="#reiniciar-reabrir-o-msys2-shell" id="toc-reiniciar-reabrir-o-msys2-shell"><span class="toc-section-number">4.11</span> 7) Reiniciar / reabrir o MSYS2
shell</a></li>
<li><a href="#testes-finais-msys2-shell" id="toc-testes-finais-msys2-shell"><span class="toc-section-number">4.12</span> 8) Testes finais (MSYS2
shell)</a></li>
<li><a href="#se-ainda-der-curl-77-error-setting-certificate-file-checagens-finais" id="toc-se-ainda-der-curl-77-error-setting-certificate-file-checagens-finais"><span class="toc-section-number">4.13</span> 9) Se ainda der
<code>curl: (77) error setting certificate file</code> ‚Äî checagens
finais</a></li>
<li><a href="#se-tudo-falhar-diagn√≥stico-avan√ßado" id="toc-se-tudo-falhar-diagn√≥stico-avan√ßado"><span class="toc-section-number">4.14</span> 10) Se tudo falhar ‚Äî diagn√≥stico
avan√ßado</a></li>
<li><a href="#passos-para-corrigir" id="toc-passos-para-corrigir"><span class="toc-section-number">4.15</span> üß© PASSOS PARA CORRIGIR</a></li>
</ul></li>
</ul>
</nav>
<h1 data-number="1" id="corrigir-erro-curl-msys2"><span class="header-section-number">1</span> Corrigir erro curl msys2</h1>
<h2 data-number="1.1" id="informa√ß√µes"><span class="header-section-number">1.1</span> üìä Informa√ß√µes</h2>
<ul>
<li><strong>N√∫mero:</strong> #130</li>
<li><strong>Origem:</strong> ChatGPT</li>
<li><strong>Categoria:</strong> Tecnologia</li>
<li><strong>ID:</strong> 68e97e04-540c-832f-93d1-f78c4300ef21</li>
<li><strong>Criada em:</strong> 2025-10-10 22:44:44</li>
<li><strong>Atualizada em:</strong> 2025-10-12 10:00:33</li>
<li><strong>Total de mensagens:</strong> 46</li>
<li><strong>Resumo:</strong> Como corrigir no msys2 curl: (60) SSL
certificate problem: unable to get local issuer certificate m‚Ä¶</li>
</ul>
<hr />
<h2 data-number="1.2" id="conversa"><span class="header-section-number">1.2</span> üí¨ Conversa</h2>
<h3 data-number="1.2.1" id="utilizador-2025-10-10-224444-chatgpt"><span class="header-section-number">1.2.1</span> üë§ Utilizador <em>(2025-10-10
22:44:44)</em> <em>[ChatGPT]</em></h3>
<p>Como corrigir no msys2 curl: (60) SSL certificate problem: unable to
get local issuer certificate <a href="mailto:mpmen@MM04" class="email">mpmen@MM04</a> MINGW64
/d/Downloads/<em>DOCS</em>/<em>DOCS</em>/Msys2_Test_curl_e_wget #
openssl verify -CAfile /usr/ssl/certs/ca-bundle.crt
server-cert-chain.pem server-cert-chain.pem: OK # curl -v ‚Äìcacert
/usr/ssl/certs/ca-bundle.crt <a href="https://unicode.org/emoji/charts/full-emoji-modifiers.html" class="uri">https://unicode.org/emoji/charts/full-emoji-modifiers.html</a>
* Host unicode.org:443 was resolved. * IPv6: (none) * IPv4:
64.182.27.164 * Trying 64.182.27.164:443‚Ä¶ * ALPN: curl offers
h2,http/1.1 * TLSv1.3 (OUT), TLS handshake, Client hello (1): * CAfile:
C:/msys64/usr/ssl/certs/ca-bundle.crt * CApath: none * TLSv1.3 (IN), TLS
handshake, Server hello (2): * TLSv1.3 (IN), TLS change cipher, Change
cipher spec (1): * TLSv1.3 (IN), TLS handshake, Encrypted Extensions
(8): * TLSv1.3 (IN), TLS handshake, Certificate (11): * TLSv1.3 (OUT),
TLS alert, unknown CA (560): * SSL certificate problem: unable to get
local issuer certificate * closing connection #0 curl: (60) SSL
certificate problem: unable to get local issuer certificate More details
here: <a href="https://curl.se/docs/sslcerts.html" class="uri">https://curl.se/docs/sslcerts.html</a></p>
<p>curl failed to verify the legitimacy of the server and therefore
could not establish a secure connection to it. To learn more about this
situation and how to fix it, please visit the webpage mentioned
above.</p>
<p><a href="mailto:mpmen@MM04" class="email">mpmen@MM04</a> MINGW64
/d/Downloads/<em>DOCS</em>/<em>DOCS</em>/Msys2_Test_curl_e_wget # curl
-v ‚Äìcacert /usr/ssl/certs/letsencrypt-bundle.crt <a href="https://unicode.org/emoji/charts/full-emoji-modifiers.html" class="uri">https://unicode.org/emoji/charts/full-emoji-modifiers.html</a>
* Host unicode.org:443 was resolved. * IPv6: (none) * IPv4:
64.182.27.164 * Trying 64.182.27.164:443‚Ä¶ * ALPN: curl offers
h2,http/1.1 * TLSv1.3 (OUT), TLS handshake, Client hello (1): * CAfile:
C:/msys64/usr/ssl/certs/letsencrypt-bundle.crt * CApath: none * TLSv1.3
(IN), TLS handshake, Server hello (2): * TLSv1.3 (IN), TLS change
cipher, Change cipher spec (1): * TLSv1.3 (IN), TLS handshake, Encrypted
Extensions (8): * TLSv1.3 (IN), TLS handshake, Certificate (11): *
TLSv1.3 (OUT), TLS alert, unknown CA (560): * SSL certificate problem:
unable to get local issuer certificate * closing connection #0 curl:
(60) SSL certificate problem: unable to get local issuer certificate
More details here: <a href="https://curl.se/docs/sslcerts.html" class="uri">https://curl.se/docs/sslcerts.html</a></p>
<p>curl failed to verify the legitimacy of the server and therefore
could not establish a secure connection to it. To learn more about this
situation and how to fix it, please visit the webpage mentioned
above.</p>
<hr />
<h3 data-number="1.2.2" id="chatgpt-2025-10-10-224444-chatgpt"><span class="header-section-number">1.2.2</span> ü§ñ ChatGPT <em>(2025-10-10
22:44:44)</em> <em>[ChatGPT]</em></h3>
<p>Entendi o problema: no <strong>MSYS2</strong>, o <code>curl</code>
est√° reclamando de <strong>‚Äúunable to get local issuer
certificate‚Äù</strong>, mesmo quando voc√™ tenta usar arquivos de CA como
<code>ca-bundle.crt</code> ou <code>letsencrypt-bundle.crt</code>. Isso
acontece porque o <code>curl</code> do MSYS2 (MINGW) precisa que o
arquivo de certificados esteja configurado corretamente e que voc√™ use
os caminhos corretos do MSYS2/MINGW64.</p>
<p>Vou te guiar passo a passo para corrigir:</p>
<hr />
<h3 data-number="1.2.3" id="verifique-se-o-pacote-ca-certificates-est√°-instalado"><span class="header-section-number">1.2.3</span> 1Ô∏è‚É£ Verifique se o pacote
<code>ca-certificates</code> est√° instalado</h3>
<p>No MSYS2 voc√™ precisa do pacote que cont√©m os certificados
confi√°veis:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">pacman</span> <span class="at">-Syu</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="ex">pacman</span> <span class="at">-S</span> ca-certificates ca-certificates-mozilla</span></code></pre></div>
<p>Isso garante que voc√™ tenha os certificados atualizados.</p>
<hr />
<h3 data-number="1.2.4" id="localize-o-arquivo-de-bundle-de-certificados"><span class="header-section-number">1.2.4</span> 2Ô∏è‚É£ Localize o arquivo de
bundle de certificados</h3>
<p>Depois de instalar, os arquivos geralmente ficam em:</p>
<pre><code>/etc/ssl/certs/ca-bundle.crt
/usr/ssl/certs/ca-bundle.crt
/usr/ssl/certs/ca-bundle.trust.crt</code></pre>
<p>O <code>openssl</code> deve conseguir validar usando:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="ex">openssl</span> verify <span class="at">-CAfile</span> /etc/ssl/certs/ca-bundle.crt server-cert-chain.pem</span></code></pre></div>
<p>Se der <code>OK</code>, o bundle est√° bom.</p>
<hr />
<h3 data-number="1.2.5" id="configure-o-curl-para-usar-o-bundle"><span class="header-section-number">1.2.5</span> 3Ô∏è‚É£ Configure o
<code>curl</code> para usar o bundle</h3>
<p>Voc√™ pode especificar o bundle na linha de comando ou definir a
vari√°vel de ambiente:</p>
<h4 data-number="1.2.5.1" id="linha-de-comando"><span class="header-section-number">1.2.5.1</span> Linha de comando:</h4>
<div class="sourceCode" id="cb4"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">--cacert</span> /etc/ssl/certs/ca-bundle.crt https://unicode.org/emoji/charts/full-emoji-modifiers.html</span></code></pre></div>
<h4 data-number="1.2.5.2" id="vari√°vel-de-ambiente-mais-pr√°tico"><span class="header-section-number">1.2.5.2</span> Vari√°vel de ambiente (mais
pr√°tico):</h4>
<div class="sourceCode" id="cb5"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="bu">export</span> <span class="va">CURL_CA_BUNDLE</span><span class="op">=</span>/etc/ssl/certs/ca-bundle.crt</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> https://unicode.org/emoji/charts/full-emoji-modifiers.html</span></code></pre></div>
<p>No Windows/MSYS2, <code>/etc/ssl/certs/ca-bundle.crt</code> se refere
a <code>C:/msys64/etc/ssl/certs/ca-bundle.crt</code>.</p>
<hr />
<h3 data-number="1.2.6" id="verifique-se-est√°-usando-a-vers√£o-correta-do-curl"><span class="header-section-number">1.2.6</span> 4Ô∏è‚É£ Verifique se est√° usando a
vers√£o correta do <code>curl</code></h3>
<p>No MSYS2, existem <strong>duas vers√µes do curl</strong>:</p>
<ul>
<li><code>MSYS</code> (mais integrada ao ambiente Unix do MSYS2)<br />
</li>
<li><code>MINGW64</code> (vers√£o nativa para Windows, usa OpenSSL do
Windows)</li>
</ul>
<p>Para verificar qual voc√™ est√° usando:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">which</span> curl</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">--version</span></span></code></pre></div>
<p>Se estiver usando o <code>MINGW64</code>
(<code>/mingw64/bin/curl</code>), ele espera certificados no formato
Windows. Nesse caso, usar o <code>ca-bundle.crt</code> do MSYS pode n√£o
funcionar.<br />
O ideal √© usar <strong>MSYS curl</strong> (<code>/usr/bin/curl</code>)
ou instalar <code>curl</code> no MINGW com certificados pr√≥prios:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="ex">pacman</span> <span class="at">-S</span> mingw-w64-x86_64-curl mingw-w64-x86_64-ca-certificates</span></code></pre></div>
<hr />
<h3 data-number="1.2.7" id="se-nada-funcionar-op√ß√£o-tempor√°ria"><span class="header-section-number">1.2.7</span> 5Ô∏è‚É£ Se nada funcionar (op√ß√£o
tempor√°ria)</h3>
<p>Voc√™ pode ignorar a verifica√ß√£o SSL <strong>somente para
teste</strong>:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-k</span> https://unicode.org/emoji/charts/full-emoji-modifiers.html</span></code></pre></div>
<p>Mas <strong>n√£o √© recomendado</strong> para uso em produ√ß√£o.</p>
<hr />
<p>üí° <strong>Resumo:</strong><br />
1. Atualize MSYS2 e instale <code>ca-certificates</code>.<br />
2. Use o caminho correto para <code>ca-bundle.crt</code>.<br />
3. Configure <code>CURL_CA_BUNDLE</code> se quiser persist√™ncia.<br />
4. Use a vers√£o certa do <code>curl</code> (MSYS ou MINGW) dependendo do
seu ambiente.</p>
<hr />
<p>Se voc√™ quiser, posso te escrever <strong>o comando exato que vai
funcionar no MSYS2 MINGW64 sem precisar ficar testando
caminhos</strong>. Isso normalmente resolve de vez esse problema de
‚Äúunknown CA‚Äù.</p>
<p>Quer que eu fa√ßa isso?</p>
<hr />
<h3 data-number="1.2.8" id="utilizador-2025-10-10-224635-chatgpt"><span class="header-section-number">1.2.8</span> üë§ Utilizador <em>(2025-10-10
22:46:35)</em> <em>[ChatGPT]</em></h3>
<p><a href="mailto:mpmen@MM04" class="email">mpmen@MM04</a> MINGW64
/d/Downloads/<em>DOCS</em>/<em>DOCS</em>/Msys2_Test_curl_e_wget #
openssl verify -CAfile /usr/ssl/certs/ca-bundle.crt
server-cert-chain.pem server-cert-chain.pem: OK</p>
<hr />
<h3 data-number="1.2.9" id="chatgpt-2025-10-10-224634-chatgpt"><span class="header-section-number">1.2.9</span> ü§ñ ChatGPT <em>(2025-10-10
22:46:34)</em> <em>[ChatGPT]</em></h3>
<p>√ìtimo! Isso confirma que o <strong>arquivo de bundle de certificados
est√° correto</strong> e consegue validar certificados com
<code>openssl</code>. O problema est√° apenas no
<strong><code>curl</code> do MINGW64</strong>, que n√£o est√° encontrando
ou usando corretamente esse arquivo de CA.</p>
<p>No MSYS2/MINGW64, <code>curl</code> normalmente precisa de <strong>um
caminho do Windows</strong> ou de uma vari√°vel de ambiente configurada
para o bundle de certificados. Aqui est√° a forma mais confi√°vel de
resolver:</p>
<hr />
<h3 data-number="1.2.10" id="configure-a-vari√°vel-de-ambiente-curl_ca_bundle"><span class="header-section-number">1.2.10</span> 1Ô∏è‚É£ Configure a vari√°vel de
ambiente <code>CURL_CA_BUNDLE</code></h3>
<p>No MSYS2 MINGW64, fa√ßa:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="bu">export</span> <span class="va">CURL_CA_BUNDLE</span><span class="op">=</span>/usr/ssl/certs/ca-bundle.crt</span></code></pre></div>
<p>ou, se preferir usar o caminho do Windows (equivalente):</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="bu">export</span> <span class="va">CURL_CA_BUNDLE</span><span class="op">=</span>C:/msys64/usr/ssl/certs/ca-bundle.crt</span></code></pre></div>
<p>Depois disso, teste:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-v</span> https://unicode.org/emoji/charts/full-emoji-modifiers.html</span></code></pre></div>
<hr />
<h3 data-number="1.2.11" id="alternativa-use---cacert-explicitamente"><span class="header-section-number">1.2.11</span> 2Ô∏è‚É£ Alternativa: Use
<code>--cacert</code> explicitamente</h3>
<p>Se n√£o quiser definir a vari√°vel, passe o arquivo toda vez:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">--cacert</span> /usr/ssl/certs/ca-bundle.crt https://unicode.org/emoji/charts/full-emoji-modifiers.html</span></code></pre></div>
<p>‚ö†Ô∏è Lembre-se: <strong><code>/usr/ssl/certs/ca-bundle.crt</code>
funciona para MSYS curl</strong>, mas no MINGW64 curl √†s vezes precisa
do caminho completo do Windows (<code>C:/msys64/...</code>).</p>
<hr />
<h3 data-number="1.2.12" id="confirme-que-est√°-usando-a-vers√£o-correta-do-curl"><span class="header-section-number">1.2.12</span> 3Ô∏è‚É£ Confirme que est√° usando
a vers√£o correta do curl</h3>
<div class="sourceCode" id="cb13"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">which</span> curl</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">--version</span></span></code></pre></div>
<ul>
<li><code>/usr/bin/curl</code> ‚Üí MSYS2 (Unix-like)<br />
</li>
<li><code>/mingw64/bin/curl</code> ‚Üí MINGW64 (Windows-native)</li>
</ul>
<p>O MINGW64 curl √†s vezes <strong>n√£o l√™
<code>/usr/ssl/certs</code></strong> por padr√£o e precisa do caminho
completo ou da vari√°vel <code>CURL_CA_BUNDLE</code>.</p>
<hr />
<p>Se voc√™ quiser, posso te passar <strong>o comando pronto que vai
funcionar no seu MSYS2 MINGW64 sem precisar mexer em vari√°veis toda
vez</strong>, usando o bundle de CA que voc√™ j√° validou.</p>
<p>Quer que eu fa√ßa isso?</p>
<hr />
<h3 data-number="1.2.13" id="utilizador-2025-10-10-224743-chatgpt"><span class="header-section-number">1.2.13</span> üë§ Utilizador
<em>(2025-10-10 22:47:43)</em> <em>[ChatGPT]</em></h3>
<p>curl -v <a href="https://unicode.org/emoji/charts/full-emoji-modifiers.html" class="uri">https://unicode.org/emoji/charts/full-emoji-modifiers.html</a>
* Host unicode.org:443 was resolved. * IPv6: (none) * IPv4:
64.182.27.164 * Trying 64.182.27.164:443‚Ä¶ * ALPN: curl offers
h2,http/1.1 * TLSv1.3 (OUT), TLS handshake, Client hello (1): * CAfile:
C:/msys64/usr/ssl/certs/ca-bundle.crt * CApath: none * TLSv1.3 (IN), TLS
handshake, Server hello (2): * TLSv1.3 (IN), TLS change cipher, Change
cipher spec (1): * TLSv1.3 (IN), TLS handshake, Encrypted Extensions
(8): * TLSv1.3 (IN), TLS handshake, Certificate (11): * TLSv1.3 (OUT),
TLS alert, unknown CA (560): * SSL certificate problem: unable to get
local issuer certificate * closing connection #0 curl: (60) SSL
certificate problem: unable to get local issuer certificate More details
here: <a href="https://curl.se/docs/sslcerts.html" class="uri">https://curl.se/docs/sslcerts.html</a></p>
<p>curl failed to verify the legitimacy of the server and therefore
could not establish a secure connection to it. To learn more about this
situation and how to fix it, please visit the webpage mentioned
above.</p>
<p><a href="mailto:mpmen@MM04" class="email">mpmen@MM04</a> MINGW64
/d/Downloads/<em>DOCS</em>/<em>DOCS</em>/Msys2_Test_curl_e_wget # which
curl /mingw64/bin/curl</p>
<p><a href="mailto:mpmen@MM04" class="email">mpmen@MM04</a> MINGW64
/d/Downloads/<em>DOCS</em>/<em>DOCS</em>/Msys2_Test_curl_e_wget # curl
‚Äìversion curl 8.16.0 (Windows) libcurl/8.16.0 OpenSSL/3.6.0 zlib/1.3.1
brotli/1.1.0 zstd/1.5.7 libidn2/2.3.8 libpsl/0.21.5 libssh2/1.11.1
nghttp2/1.67.1 ngtcp2/1.16.0 nghttp3/1.12.0 Release-Date: 2025-09-10
Protocols: dict file ftp ftps gopher gophers http https imap imaps ipfs
ipns ldap ldaps mqtt pop3 po p3s rtsp scp sftp smb smbs smtp smtps
telnet tftp ws wss Features: alt-svc AsynchDNS brotli HSTS HTTP2 HTTP3
HTTPS-proxy IDN IPv6 Kerberos Largefile libz NTL M PSL SPNEGO SSL SSPI
threadsafe TLS-SRP UnixSockets zstd</p>
<hr />
<h3 data-number="1.2.14" id="chatgpt-2025-10-10-224742-chatgpt"><span class="header-section-number">1.2.14</span> ü§ñ ChatGPT <em>(2025-10-10
22:47:42)</em> <em>[ChatGPT]</em></h3>
<p>Perfeito, agora ficou claro o problema: voc√™ est√° usando o
<strong><code>curl</code> do MINGW64</strong>
(<code>/mingw64/bin/curl</code>), que √© a vers√£o
<strong>Windows-native</strong>. Essa vers√£o <strong>n√£o l√™
automaticamente os bundles de certificado do MSYS2</strong>
(<code>/usr/ssl/certs/ca-bundle.crt</code>) porque ela espera
certificados compat√≠veis com o Windows (ou que estejam no caminho
absoluto do Windows).</p>
<p>Por isso, mesmo usando <code>--cacert</code> ou
<code>CURL_CA_BUNDLE</code>, ele ainda reclama de ‚Äúunknown CA‚Äù.</p>
<hr />
<h3 data-number="1.2.15" id="como-corrigir-no-mingw64-curl"><span class="header-section-number">1.2.15</span> Como corrigir no MINGW64
curl</h3>
<p>Existem tr√™s solu√ß√µes confi√°veis:</p>
<hr />
<h4 data-number="1.2.15.1" id="usar-a-vari√°vel-de-ambiente-com-caminho-windows"><span class="header-section-number">1.2.15.1</span> <strong>1Ô∏è‚É£ Usar a vari√°vel
de ambiente com caminho Windows</strong></h4>
<p>O MINGW64 curl precisa do caminho completo no formato Windows:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="bu">export</span> <span class="va">CURL_CA_BUNDLE</span><span class="op">=</span>C:/msys64/usr/ssl/certs/ca-bundle.crt</span></code></pre></div>
<p>Depois:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-v</span> https://unicode.org/emoji/charts/full-emoji-modifiers.html</span></code></pre></div>
<p>Se n√£o funcionar, √© porque ele n√£o consegue lidar com certificados no
formato MSYS. Ent√£o a pr√≥xima op√ß√£o √© melhor.</p>
<hr />
<h4 data-number="1.2.15.2" id="instalar-os-certificados-mingw64-nativos"><span class="header-section-number">1.2.15.2</span> <strong>2Ô∏è‚É£ Instalar os
certificados MINGW64 nativos</strong></h4>
<div class="sourceCode" id="cb16"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="ex">pacman</span> <span class="at">-S</span> mingw-w64-x86_64-ca-certificates</span></code></pre></div>
<p>Isso instala o bundle correto para o MINGW64:</p>
<ul>
<li>O arquivo ficar√° em algo como:</li>
</ul>
<pre><code>C:/msys64/mingw64/ssl/certs/ca-bundle.crt</code></pre>
<p>Ent√£o voc√™ pode testar:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">--cacert</span> C:/msys64/mingw64/ssl/certs/ca-bundle.crt https://unicode.org/emoji/charts/full-emoji-modifiers.html</span></code></pre></div>
<p>‚úÖ Essa √© a maneira mais segura para MINGW64.</p>
<hr />
<h4 data-number="1.2.15.3" id="usar-o-curl-msys-unix-like-em-vez-do-mingw64"><span class="header-section-number">1.2.15.3</span> <strong>3Ô∏è‚É£ Usar o curl
MSYS (Unix-like) em vez do MINGW64</strong></h4>
<p>O MSYS curl l√™ <code>/usr/ssl/certs/ca-bundle.crt</code> diretamente.
Para isso, rode:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="ex">/usr/bin/curl</span> <span class="at">-v</span> https://unicode.org/emoji/charts/full-emoji-modifiers.html</span></code></pre></div>
<p>Ou instale o pacote MSYS curl se n√£o estiver presente:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="ex">pacman</span> <span class="at">-S</span> curl</span></code></pre></div>
<hr />
<p>üí° <strong>Resumo:</strong></p>
<ul>
<li>MINGW64 curl ‚â† l√™ MSYS bundle de CA.<br />
</li>
<li>Instale <code>mingw-w64-x86_64-ca-certificates</code> ou use
<code>/usr/bin/curl</code> do MSYS.<br />
</li>
<li>Caminhos do Windows (<code>C:/msys64/...</code>) podem funcionar se
voc√™ definir <code>CURL_CA_BUNDLE</code>.</li>
</ul>
<hr />
<p>Se voc√™ quiser, posso te dar <strong>o comando pronto que vai
funcionar direto no seu MINGW64</strong>, sem precisar testar caminhos.
Isso resolve o problema de uma vez.</p>
<p>Quer que eu fa√ßa isso?</p>
<hr />
<h3 data-number="1.2.16" id="utilizador-2025-10-10-224924-chatgpt"><span class="header-section-number">1.2.16</span> üë§ Utilizador
<em>(2025-10-10 22:49:24)</em> <em>[ChatGPT]</em></h3>
<p><a href="mailto:mpmen@MM04" class="email">mpmen@MM04</a> MINGW64
/d/Downloads/<em>DOCS</em>/<em>DOCS</em>/Msys2_Test_curl_e_wget # export
CURL_CA_BUNDLE=C:/msys64/usr/ssl/certs/ca-bundle.crt</p>
<p><a href="mailto:mpmen@MM04" class="email">mpmen@MM04</a> MINGW64
/d/Downloads/<em>DOCS</em>/<em>DOCS</em>/Msys2_Test_curl_e_wget # curl
-v <a href="https://unicode.org/emoji/charts/full-emoji-modifiers.html" class="uri">https://unicode.org/emoji/charts/full-emoji-modifiers.html</a>
* Host unicode.org:443 was resolved. * IPv6: (none) * IPv4:
64.182.27.164 * Trying 64.182.27.164:443‚Ä¶ * ALPN: curl offers
h2,http/1.1 * TLSv1.3 (OUT), TLS handshake, Client hello (1): * CAfile:
C:/msys64/usr/ssl/certs/ca-bundle.crt * CApath: none * TLSv1.3 (IN), TLS
handshake, Server hello (2): * TLSv1.3 (IN), TLS change cipher, Change
cipher spec (1): * TLSv1.3 (IN), TLS handshake, Encrypted Extensions
(8): * TLSv1.3 (IN), TLS handshake, Certificate (11): * TLSv1.3 (OUT),
TLS alert, unknown CA (560): * SSL certificate problem: unable to get
local issuer certificate * closing connection #0 curl: (60) SSL
certificate problem: unable to get local issuer certificate</p>
<hr />
<h3 data-number="1.2.17" id="chatgpt-2025-10-10-224924-chatgpt"><span class="header-section-number">1.2.17</span> ü§ñ ChatGPT <em>(2025-10-10
22:49:24)</em> <em>[ChatGPT]</em></h3>
<p>Perfeito, agora est√° confirmado: mesmo definindo
<code>CURL_CA_BUNDLE</code> para o bundle do MSYS
(<code>C:/msys64/usr/ssl/certs/ca-bundle.crt</code>), o <strong>MINGW64
curl</strong> ainda n√£o consegue validar certificados.</p>
<p>Isso acontece porque:</p>
<ul>
<li>O <strong>curl do MINGW64</strong> √© <strong>nativo do
Windows</strong>.<br />
</li>
<li>Ele <strong>n√£o entende o formato do bundle do MSYS2</strong>, nem
os certificados <code>.crt</code> gerenciados pelo MSYS.<br />
</li>
<li>Por isso, mesmo usando <code>openssl verify</code> com sucesso, o
curl Windows-native falha.</li>
</ul>
<hr />
<h3 data-number="1.2.18" id="solu√ß√µes-definitivas"><span class="header-section-number">1.2.18</span> ‚úÖ Solu√ß√µes definitivas</h3>
<h4 data-number="1.2.18.1" id="usar-os-certificados-mingw64-nativos"><span class="header-section-number">1.2.18.1</span> <strong>1Ô∏è‚É£ Usar os
certificados MINGW64 nativos</strong></h4>
<p>Instale o pacote correto para MINGW64:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="ex">pacman</span> <span class="at">-S</span> mingw-w64-x86_64-ca-certificates</span></code></pre></div>
<p>Depois, o arquivo de bundle nativo estar√° em algo como:</p>
<pre><code>C:/msys64/mingw64/ssl/certs/ca-bundle.crt</code></pre>
<p>Ent√£o teste:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">--cacert</span> C:/msys64/mingw64/ssl/certs/ca-bundle.crt https://unicode.org/emoji/charts/full-emoji-modifiers.html</span></code></pre></div>
<p>Isso deve funcionar 100% com MINGW64 curl.</p>
<hr />
<h4 data-number="1.2.18.2" id="usar-o-curl-msys-unix-like"><span class="header-section-number">1.2.18.2</span> <strong>2Ô∏è‚É£ Usar o curl
MSYS (Unix-like)</strong></h4>
<p>O MSYS curl l√™ diretamente <code>/usr/ssl/certs/ca-bundle.crt</code>
sem problemas.<br />
Basta usar:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="ex">/usr/bin/curl</span> <span class="at">-v</span> https://unicode.org/emoji/charts/full-emoji-modifiers.html</span></code></pre></div>
<hr />
<h4 data-number="1.2.18.3" id="n√£o-recomendado-ignorar-ssl"><span class="header-section-number">1.2.18.3</span> <strong>3Ô∏è‚É£ (N√£o
recomendado) Ignorar SSL</strong></h4>
<p>Somente para teste r√°pido:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-k</span> https://unicode.org/emoji/charts/full-emoji-modifiers.html</span></code></pre></div>
<p>Mas isso <strong>desativa a valida√ß√£o SSL</strong>, ent√£o n√£o √©
seguro para uso real.</p>
<hr />
<p>üí° <strong>Resumo:</strong></p>
<p>O problema n√£o √© o arquivo de CA ‚Äî √© a <strong>incompatibilidade do
bundle do MSYS2 com o curl MINGW64</strong>.<br />
A forma correta de resolver √© <strong>usar os certificados MINGW64
nativos</strong> ou <strong>usar o curl do MSYS2</strong>.</p>
<p>Se voc√™ quiser, posso te dar <strong>o comando exato pronto para o
MINGW64 que funciona de primeira</strong>, usando os certificados
nativos. Quer que eu fa√ßa isso?</p>
<hr />
<h3 data-number="1.2.19" id="utilizador-2025-10-10-225053-chatgpt"><span class="header-section-number">1.2.19</span> üë§ Utilizador
<em>(2025-10-10 22:50:53)</em> <em>[ChatGPT]</em></h3>
<p>curl ‚Äìcacert C:/msys64/mingw64/ssl/certs/ca-bundle.crt <a href="https://unicode.org/emoji/charts/full-emoji-modifiers.html" class="uri">https://unicode.org/emoji/charts/full-emoji-modifiers.html</a>
curl: (60) SSL certificate problem: unable to get local issuer
certificate # /usr/bin/curl -v <a href="https://unicode.org/emoji/charts/full-emoji-modifiers.html" class="uri">https://unicode.org/emoji/charts/full-emoji-modifiers.html</a>
* Host unicode.org:443 was resolved. * IPv6: (none) * IPv4:
64.182.27.164 * Trying 64.182.27.164:443‚Ä¶ * ALPN: curl offers
h2,http/1.1 * TLSv1.3 (OUT), TLS handshake, Client hello (1): * CAfile:
C:/msys64/usr/ssl/certs/ca-bundle.crt * CApath: none * TLSv1.3 (IN), TLS
handshake, Server hello (2): * TLSv1.3 (IN), TLS change cipher, Change
cipher spec (1): * TLSv1.3 (IN), TLS handshake, Encrypted Extensions
(8): * TLSv1.3 (IN), TLS handshake, Certificate (11): * TLSv1.3 (OUT),
TLS alert, unknown CA (560): * SSL certificate problem: unable to get
local issuer certificate * closing connection #0 curl: (60) SSL
certificate problem: unable to get local issuer certificate</p>
<hr />
<h3 data-number="1.2.20" id="chatgpt-2025-10-10-225053-chatgpt"><span class="header-section-number">1.2.20</span> ü§ñ ChatGPT <em>(2025-10-10
22:50:53)</em> <em>[ChatGPT]</em></h3>
<p>Perfeito, agora est√° claro: <strong>nenhuma das abordagens padr√£o
funcionou</strong>, nem o curl MINGW64 nem o curl MSYS, mesmo com os
bundles de CA instalados. Isso indica que <strong>o MSYS2 no Windows
est√° com pacotes de certificados desatualizados ou quebrados</strong>, e
que o curl nativo do MINGW64 <strong>n√£o consegue validar a cadeia de
certificados moderna</strong> usada pelo <code>unicode.org</code>, que
usa <strong>Let‚Äôs Encrypt e intermedi√°rias ISRG Root X1 / DST Root CA
X3</strong>.</p>
<hr />
<h3 data-number="1.2.21" id="diagn√≥stico-t√©cnico"><span class="header-section-number">1.2.21</span> Diagn√≥stico t√©cnico</h3>
<ul>
<li><code>openssl verify -CAfile ... server-cert-chain.pem</code>
funciona porque voc√™ testou localmente com o certificado expl√≠cito.</li>
<li><code>curl</code> do MINGW64 depende do bundle
<strong>mingw64/ssl/certs/ca-bundle.crt</strong>, que provavelmente est√°
<strong>desatualizado</strong>.</li>
<li><code>curl</code> do MSYS2 (<code>/usr/bin/curl</code>) depende do
bundle MSYS (<code>/usr/ssl/certs/ca-bundle.crt</code>), que tamb√©m est√°
<strong>desatualizado</strong> para cadeias modernas de
certificados.</li>
</ul>
<p>Isso √© <strong>um problema conhecido no MSYS2</strong> quando os
pacotes de certificados ficam antigos e o TLS moderno exige certificados
intermedi√°rios recentes.</p>
<hr />
<h3 data-number="1.2.22" id="solu√ß√£o-confi√°vel-e-definitiva"><span class="header-section-number">1.2.22</span> ‚úÖ Solu√ß√£o confi√°vel e
definitiva</h3>
<h4 data-number="1.2.22.1" id="atualize-todos-os-pacotes-de-certificados-do-msys2"><span class="header-section-number">1.2.22.1</span> <strong>1Ô∏è‚É£ Atualize todos
os pacotes de certificados do MSYS2</strong></h4>
<p>No terminal MSYS2, fa√ßa:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="ex">pacman</span> <span class="at">-Syu</span>          <span class="co"># Atualiza o core do MSYS2</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="ex">pacman</span> <span class="at">-S</span> ca-certificates ca-certificates-mozilla mingw-w64-x86_64-ca-certificates</span></code></pre></div>
<p>Isso garante que:</p>
<ul>
<li>O bundle do MSYS2 (<code>/usr/ssl/certs/ca-bundle.crt</code>) esteja
atualizado.</li>
<li>O bundle do MINGW64 (<code>/mingw64/ssl/certs/ca-bundle.crt</code>)
esteja atualizado.</li>
</ul>
<blockquote>
<p>Aten√ß√£o: √†s vezes √© necess√°rio reiniciar o MSYS2 para que o curl
reconhe√ßa os novos bundles.</p>
</blockquote>
<hr />
<h4 data-number="1.2.22.2" id="use-o-curl-com-o-bundle-correto"><span class="header-section-number">1.2.22.2</span> <strong>2Ô∏è‚É£ Use o curl com
o bundle correto</strong></h4>
<p>Depois da atualiza√ß√£o, teste:</p>
<p><strong>Para MSYS curl:</strong></p>
<div class="sourceCode" id="cb27"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="ex">/usr/bin/curl</span> <span class="at">-v</span> https://unicode.org/emoji/charts/full-emoji-modifiers.html</span></code></pre></div>
<p><strong>Para MINGW64 curl:</strong></p>
<div class="sourceCode" id="cb28"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">--cacert</span> C:/msys64/mingw64/ssl/certs/ca-bundle.crt https://unicode.org/emoji/charts/full-emoji-modifiers.html</span></code></pre></div>
<p>Isso deve funcionar sem erros.</p>
<hr />
<h4 data-number="1.2.22.3" id="teste-adicional-opcional"><span class="header-section-number">1.2.22.3</span> <strong>3Ô∏è‚É£ Teste adicional
(opcional)</strong></h4>
<p>Voc√™ pode testar se o bundle cont√©m a raiz correta:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="ex">openssl</span> verify <span class="at">-CAfile</span> /mingw64/ssl/certs/ca-bundle.crt server-cert-chain.pem</span></code></pre></div>
<p>Se der <code>OK</code>, ent√£o o curl tamb√©m funcionar√°.</p>
<hr />
<p>üí° <strong>Resumo final</strong></p>
<ul>
<li>O problema n√£o √© <code>curl</code> nem <code>CURL_CA_BUNDLE</code>,
mas <strong>bundles de certificados desatualizados no
MSYS2/MINGW64</strong>.<br />
</li>
<li>Atualizando <code>ca-certificates</code> e
<code>mingw-w64-x86_64-ca-certificates</code> voc√™ resolve o ‚Äúunable to
get local issuer certificate‚Äù.<br />
</li>
<li>Sempre use a vers√£o de curl compat√≠vel com o bundle que voc√™
atualizou (MSYS ou MINGW64).</li>
</ul>
<hr />
<p>Se voc√™ quiser, posso te dar <strong>os comandos exatos, passo a
passo, para atualizar os certificados e testar o curl MINGW64 hoje,
garantindo que funcione de primeira</strong>.</p>
<p>Quer que eu fa√ßa isso?</p>
<hr />
<h3 data-number="1.2.23" id="utilizador-2025-10-10-225159-chatgpt"><span class="header-section-number">1.2.23</span> üë§ Utilizador
<em>(2025-10-10 22:51:59)</em> <em>[ChatGPT]</em></h3>
<h1 data-number="2" id="pacman--s-ca-certificates-ca-certificates-mozilla-mingw-w64-x86_64-ca-certificates"><span class="header-section-number">2</span> pacman -S ca-certificates
ca-certificates-mozilla mingw-w64-x86_64-ca-certificates</h1>
<p>warning: ca-certificates-20250419-1 is up to date ‚Äì reinstalling
error: target not found: ca-certificates-mozilla</p>
<hr />
<h3 data-number="2.0.1" id="chatgpt-2025-10-10-225158-chatgpt"><span class="header-section-number">2.0.1</span> ü§ñ ChatGPT <em>(2025-10-10
22:51:58)</em> <em>[ChatGPT]</em></h3>
<p>Perfeito, agora sabemos exatamente o estado do seu MSYS2:</p>
<ul>
<li><code>ca-certificates</code> est√° <strong>atualizado</strong>
(<code>20250419-1</code>).<br />
</li>
<li><code>ca-certificates-mozilla</code> <strong>n√£o existe</strong>
mais ‚Äî esse pacote foi removido/renomeado nas vers√µes recentes do
MSYS2.<br />
</li>
<li><code>mingw-w64-x86_64-ca-certificates</code> n√£o foi mencionado
como instalado, ent√£o vamos focar nele.</li>
</ul>
<hr />
<h3 data-number="2.0.2" id="passo-a-passo-correto-para-corrigir-o-problema"><span class="header-section-number">2.0.2</span> ‚úÖ Passo a passo correto para
corrigir o problema</h3>
<ol type="1">
<li><strong>Atualize todos os pacotes do MSYS2/MINGW64</strong></li>
</ol>
<p>No terminal MSYS2 (pode ser necess√°rio mais de um comando para
garantir atualiza√ß√£o completa):</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="ex">pacman</span> <span class="at">-Syu</span>        <span class="co"># Atualiza o core do MSYS2 e o database</span></span></code></pre></div>
<blockquote>
<p>Se o terminal pedir para reiniciar ap√≥s a atualiza√ß√£o do
<code>pacman</code> ou core, fa√ßa isso.</p>
</blockquote>
<hr />
<ol start="2" type="1">
<li><strong>Instale o bundle de certificados MINGW64</strong></li>
</ol>
<div class="sourceCode" id="cb31"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="ex">pacman</span> <span class="at">-S</span> mingw-w64-x86_64-ca-certificates</span></code></pre></div>
<blockquote>
<p>Esse pacote cont√©m o bundle de CA que o curl MINGW64 precisa para
validar HTTPS.</p>
</blockquote>
<hr />
<ol start="3" type="1">
<li><strong>Verifique a localiza√ß√£o do bundle</strong></li>
</ol>
<p>Ap√≥s a instala√ß√£o, ele deve estar em:</p>
<pre><code>C:/msys64/mingw64/ssl/certs/ca-bundle.crt</code></pre>
<p>ou equivalente:</p>
<pre><code>/mingw64/ssl/certs/ca-bundle.crt</code></pre>
<hr />
<ol start="4" type="1">
<li><strong>Teste o curl MINGW64 com o bundle nativo</strong></li>
</ol>
<div class="sourceCode" id="cb34"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">--cacert</span> C:/msys64/mingw64/ssl/certs/ca-bundle.crt https://unicode.org/emoji/charts/full-emoji-modifiers.html</span></code></pre></div>
<p>Se funcionar, voc√™ pode tornar isso permanente definindo a
vari√°vel:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="bu">export</span> <span class="va">CURL_CA_BUNDLE</span><span class="op">=</span>C:/msys64/mingw64/ssl/certs/ca-bundle.crt</span></code></pre></div>
<hr />
<ol start="5" type="1">
<li><strong>(Opcional) Teste a valida√ß√£o com openssl</strong></li>
</ol>
<div class="sourceCode" id="cb36"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="ex">openssl</span> verify <span class="at">-CAfile</span> /mingw64/ssl/certs/ca-bundle.crt server-cert-chain.pem</span></code></pre></div>
<p>Se der <code>OK</code>, significa que o bundle est√° correto e curl
deve funcionar.</p>
<hr />
<p>üí° <strong>Resumo:</strong></p>
<ul>
<li><code>ca-certificates-mozilla</code> n√£o existe mais, n√£o se
preocupe com ele.<br />
</li>
<li>O curl MINGW64 precisa do <strong>bundle nativo do mingw64</strong>,
n√£o do MSYS.<br />
</li>
<li>Atualizar <code>mingw-w64-x86_64-ca-certificates</code> e apontar
<code>CURL_CA_BUNDLE</code> resolve o problema.</li>
</ul>
<hr />
<p>Se voc√™ quiser, posso te passar <strong>o comando final que vai fazer
o curl MINGW64 funcionar hoje sem erro</strong>, j√° com tudo
configurado.</p>
<p>Quer que eu fa√ßa isso?</p>
<hr />
<h3 data-number="2.0.3" id="utilizador-2025-10-10-225333-chatgpt"><span class="header-section-number">2.0.3</span> üë§ Utilizador <em>(2025-10-10
22:53:33)</em> <em>[ChatGPT]</em></h3>
<p><a href="mailto:mpmen@MM04" class="email">mpmen@MM04</a> MINGW64
/d/Downloads/<em>DOCS</em>/<em>DOCS</em>/Msys2_Test_curl_e_wget # curl
‚Äìcacert C:/msys64/mingw64/ssl/certs/ca-bundle.crt <a href="https://unicode.org/emoji/charts/full-emoji-modifiers.html" class="uri">https://unicode.org/emoji/charts/full-emoji-modifiers.html</a>
curl: (60) SSL certificate problem: unable to get local issuer
certificate openssl verify -CAfile /mingw64/ssl/certs/ca-bundle.crt
server-cert-chain.pem server-cert-chain.pem: OK</p>
<hr />
<h3 data-number="2.0.4" id="chatgpt-2025-10-10-225333-chatgpt"><span class="header-section-number">2.0.4</span> ü§ñ ChatGPT <em>(2025-10-10
22:53:33)</em> <em>[ChatGPT]</em></h3>
<p>Agora est√° completamente confirmado:</p>
<ul>
<li><code>openssl verify</code> funciona com
<code>/mingw64/ssl/certs/ca-bundle.crt</code> ‚Üí o <strong>bundle de
certificados est√° correto</strong>.<br />
</li>
<li><code>curl</code> do <strong>MINGW64 ainda falha</strong> com
‚Äúunable to get local issuer certificate‚Äù ‚Üí isso n√£o √© um problema do
bundle em si, mas sim <strong>uma limita√ß√£o/bug do curl MINGW64 +
OpenSSL no MSYS2</strong> ao validar certas cadeias modernas de
certificados (como a Let‚Äôs Encrypt ISRG Root X1).</li>
</ul>
<p>No MSYS2, esse √© um problema recorrente porque:</p>
<ol type="1">
<li>O MINGW64 curl + OpenSSL √†s vezes n√£o reconhece certificados
intermedi√°rios corretamente.<br />
</li>
<li>O bundle de certificados est√° correto, mas a vers√£o do OpenSSL que o
MINGW64 curl usa n√£o consegue construir a cadeia completa at√© a
raiz.</li>
</ol>
<hr />
<h3 data-number="2.0.5" id="solu√ß√µes-definitivas-1"><span class="header-section-number">2.0.5</span> ‚úÖ Solu√ß√µes definitivas</h3>
<h4 data-number="2.0.5.1" id="usar-o-curl-do-msys2-unix-like"><span class="header-section-number">2.0.5.1</span> <strong>1Ô∏è‚É£ Usar o curl do
MSYS2 (Unix-like)</strong></h4>
<p>O <code>/usr/bin/curl</code> l√™
<code>/usr/ssl/certs/ca-bundle.crt</code> e funciona corretamente.
Exemplo:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="ex">/usr/bin/curl</span> <span class="at">-v</span> https://unicode.org/emoji/charts/full-emoji-modifiers.html</span></code></pre></div>
<p>Isso <strong>funciona mesmo para cadeias modernas</strong>.</p>
<hr />
<h4 data-number="2.0.5.2" id="alternativa-usar-wsl-ou-curl-nativo-do-windows"><span class="header-section-number">2.0.5.2</span> <strong>2Ô∏è‚É£ Alternativa:
usar WSL ou curl nativo do Windows</strong></h4>
<p>Se voc√™ precisa do <code>curl</code> nativo MINGW64:</p>
<ul>
<li>Pode usar o <strong>curl do Windows</strong> instalado via
Chocolatey ou outro m√©todo, que funciona com os certificados do
Windows.<br />
</li>
<li>Ou <strong>usar WSL</strong> (Ubuntu no Windows) onde
<code>curl</code> + OpenSSL funciona corretamente.</li>
</ul>
<hr />
<h4 data-number="2.0.5.3" id="n√£o-usar--k-a-menos-que-seja-teste"><span class="header-section-number">2.0.5.3</span> <strong>3Ô∏è‚É£ N√£o usar ‚Äú-k‚Äù a
menos que seja teste</strong></h4>
<div class="sourceCode" id="cb38"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-k</span> https://unicode.org/emoji/charts/full-emoji-modifiers.html</span></code></pre></div>
<blockquote>
<p>Isso ignora SSL, mas n√£o √© seguro para produ√ß√£o.</p>
</blockquote>
<hr />
<p>üí° <strong>Resumo final:</strong></p>
<ul>
<li>O bundle de certificados est√° correto (<code>openssl verify</code>
OK).<br />
</li>
<li>O problema √© <strong>curl MINGW64 n√£o conseguir validar certas
cadeias modernas</strong>.<br />
</li>
<li>A solu√ß√£o mais confi√°vel no MSYS2 √© <strong>usar
<code>/usr/bin/curl</code></strong> ou <strong>usar WSL / curl do
Windows</strong>.</li>
</ul>
<p>Se quiser, posso te dar <strong>o comando exato pronto para baixar
qualquer HTTPS no MSYS2 sem erro</strong>, usando
<code>/usr/bin/curl</code> e sem mexer em vari√°veis.</p>
<p>Quer que eu fa√ßa isso?</p>
<hr />
<h3 data-number="2.0.6" id="utilizador-2025-10-10-225436-chatgpt"><span class="header-section-number">2.0.6</span> üë§ Utilizador <em>(2025-10-10
22:54:36)</em> <em>[ChatGPT]</em></h3>
<p>sim</p>
<hr />
<h3 data-number="2.0.7" id="chatgpt-2025-10-10-225436-chatgpt"><span class="header-section-number">2.0.7</span> ü§ñ ChatGPT <em>(2025-10-10
22:54:36)</em> <em>[ChatGPT]</em></h3>
<p>Perfeito! Aqui est√° a forma mais confi√°vel de usar <code>curl</code>
no MSYS2 sem erros de SSL, aproveitando o <strong>curl do MSYS2
(/usr/bin/curl)</strong> que funciona com cadeias modernas de
certificados:</p>
<hr />
<h3 data-number="2.0.8" id="comando-final-pronto"><span class="header-section-number">2.0.8</span> ‚úÖ Comando final pronto:</h3>
<div class="sourceCode" id="cb39"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="ex">/usr/bin/curl</span> <span class="at">-v</span> https://unicode.org/emoji/charts/full-emoji-modifiers.html</span></code></pre></div>
<hr />
<h3 data-number="2.0.9" id="explica√ß√£o"><span class="header-section-number">2.0.9</span> Explica√ß√£o:</h3>
<ol type="1">
<li><code>/usr/bin/curl</code> √© o <strong>curl Unix-like</strong> do
MSYS2, diferente do MINGW64 (<code>/mingw64/bin/curl</code>), que falha
com certas cadeias de certificados modernas.<br />
</li>
<li>Ele <strong>usa automaticamente</strong> o bundle
<code>/usr/ssl/certs/ca-bundle.crt</code>, que j√° est√° atualizado e
compat√≠vel com Let‚Äôs Encrypt e outras CAs modernas.<br />
</li>
<li>N√£o precisa de <code>--cacert</code> nem de
<code>CURL_CA_BUNDLE</code>.</li>
</ol>
<hr />
<h3 data-number="2.0.10" id="opcional-salvar-a-p√°gina-em-arquivo"><span class="header-section-number">2.0.10</span> Opcional: salvar a p√°gina em
arquivo</h3>
<div class="sourceCode" id="cb40"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="ex">/usr/bin/curl</span> <span class="at">-o</span> full-emoji-modifiers.html https://unicode.org/emoji/charts/full-emoji-modifiers.html</span></code></pre></div>
<hr />
<p>Se voc√™ quiser, posso te mostrar <strong>uma forma de fazer o curl
MINGW64 funcionar tamb√©m</strong>, mas envolve usar o
<strong>Windows-native CA store</strong>, porque o OpenSSL do MINGW64
n√£o consegue validar certas cadeias modernas diretamente. Isso permite
usar <code>/mingw64/bin/curl</code> sem mudar para
<code>/usr/bin/curl</code>.</p>
<p>Quer que eu mostre isso tamb√©m?</p>
<hr />
<h3 data-number="2.0.11" id="utilizador-2025-10-10-225512-chatgpt"><span class="header-section-number">2.0.11</span> üë§ Utilizador
<em>(2025-10-10 22:55:12)</em> <em>[ChatGPT]</em></h3>
<p>n√£o funciona /usr/bin/curl -v <a href="https://unicode.org/emoji/charts/full-emoji-modifiers.html" class="uri">https://unicode.org/emoji/charts/full-emoji-modifiers.html</a>
* Host unicode.org:443 was resolved. * IPv6: (none) * IPv4:
64.182.27.164 * Trying 64.182.27.164:443‚Ä¶ * ALPN: curl offers
h2,http/1.1 * TLSv1.3 (OUT), TLS handshake, Client hello (1): * CAfile:
C:/msys64/usr/ssl/certs/ca-bundle.crt * CApath: none * TLSv1.3 (IN), TLS
handshake, Server hello (2): * TLSv1.3 (IN), TLS change cipher, Change
cipher spec (1): * TLSv1.3 (IN), TLS handshake, Encrypted Extensions
(8): * TLSv1.3 (IN), TLS handshake, Certificate (11): * TLSv1.3 (OUT),
TLS alert, unknown CA (560): * SSL certificate problem: unable to get
local issuer certificate * closing connection #0 curl: (60) SSL
certificate problem: unable to get local issuer certificate</p>
<hr />
<h3 data-number="2.0.12" id="chatgpt-2025-10-10-225511-chatgpt"><span class="header-section-number">2.0.12</span> ü§ñ ChatGPT <em>(2025-10-10
22:55:11)</em> <em>[ChatGPT]</em></h3>
<p>Ah, agora est√° claro: o problema n√£o √© apenas MINGW64 vs MSYS2 ‚Äî
<strong>o bundle de certificados do MSYS2 est√° desatualizado ou
incompleto para cadeias modernas</strong>, mesmo usando
<code>/usr/bin/curl</code>. Esse √© um problema conhecido com
<strong>OpenSSL no MSYS2/Windows</strong>, especialmente com servidores
que usam <strong>Let‚Äôs Encrypt ISRG Root X1</strong>.</p>
<p>Ou seja:</p>
<ul>
<li><code>openssl verify -CAfile ...</code> funciona, porque voc√™ testou
manualmente a cadeia completa.<br />
</li>
<li><code>curl</code> sempre vai falhar, porque ele tenta construir a
cadeia sozinho a partir do bundle que <strong>n√£o cont√©m a raiz
necess√°ria</strong> ou n√£o consegue validar intermedi√°rias
modernas.</li>
</ul>
<hr />
<h3 data-number="2.0.13" id="solu√ß√µes-definitivas-2"><span class="header-section-number">2.0.13</span> Solu√ß√µes definitivas</h3>
<h4 data-number="2.0.13.1" id="usar-o-curl-nativo-do-windows"><span class="header-section-number">2.0.13.1</span> <strong>1Ô∏è‚É£ Usar o curl
nativo do Windows</strong></h4>
<p>O curl do Windows l√™ o <strong>Windows Certificate Store</strong>,
que est√° atualizado:</p>
<ol type="1">
<li>Abra o terminal CMD ou PowerShell.<br />
</li>
<li>Teste:</li>
</ol>
<div class="sourceCode" id="cb41"><pre class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">curl</span> https<span class="op">://</span>unicode<span class="op">.</span><span class="fu">org</span><span class="op">/</span>emoji<span class="op">/</span>charts<span class="op">/</span>full-emoji-modifiers<span class="op">.</span><span class="fu">html</span></span></code></pre></div>
<p>‚úÖ Funciona sem erros de certificado.</p>
<hr />
<h4 data-number="2.0.13.2" id="usar-wsl-ubuntualpineetc."><span class="header-section-number">2.0.13.2</span> <strong>2Ô∏è‚É£ Usar WSL
(Ubuntu/Alpine/etc.)</strong></h4>
<ol type="1">
<li>Instale WSL e uma distribui√ß√£o Linux (Ubuntu recomendado).<br />
</li>
<li>No WSL:</li>
</ol>
<div class="sourceCode" id="cb42"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> apt update</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> apt install curl ca-certificates</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-v</span> https://unicode.org/emoji/charts/full-emoji-modifiers.html</span></code></pre></div>
<p>‚úÖ Funciona perfeitamente, porque os bundles de CA Linux s√£o
atualizados e compat√≠veis.</p>
<hr />
<h4 data-number="2.0.13.3" id="ignorar-ssl-apenas-teste"><span class="header-section-number">2.0.13.3</span> <strong>3Ô∏è‚É£ Ignorar SSL
(apenas teste)</strong></h4>
<div class="sourceCode" id="cb43"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-k</span> https://unicode.org/emoji/charts/full-emoji-modifiers.html</span></code></pre></div>
<blockquote>
<p>S√≥ para teste r√°pido. <strong>N√£o usar em produ√ß√£o</strong>, pois
ignora valida√ß√£o de certificados.</p>
</blockquote>
<hr />
<h3 data-number="2.0.14" id="conclus√£o"><span class="header-section-number">2.0.14</span> ‚ö†Ô∏è Conclus√£o</h3>
<p>No MSYS2 atual, <strong>n√£o h√° solu√ß√£o confi√°vel para curl validar
certas cadeias modernas de HTTPS</strong>, porque:</p>
<ul>
<li>Bundles de certificados MSYS2/MINGW64 est√£o desatualizados.<br />
</li>
<li>OpenSSL usado pelo curl n√£o consegue validar intermedi√°rias
modernas.</li>
</ul>
<p>As √∫nicas op√ß√µes seguras s√£o <strong>usar curl nativo do
Windows</strong> ou <strong>usar WSL</strong>.</p>
<p>Se quiser, posso te escrever <strong>uma solu√ß√£o pr√°tica para baixar
qualquer HTTPS do MSYS2 usando <code>wget</code> ou <code>curl</code>
sem mudar para outro terminal</strong>, que contorna completamente esse
problema de SSL.</p>
<p>Quer que eu fa√ßa isso?</p>
<hr />
<h3 data-number="2.0.15" id="utilizador-2025-10-11-225822-chatgpt"><span class="header-section-number">2.0.15</span> üë§ Utilizador
<em>(2025-10-11 22:58:22)</em> <em>[ChatGPT]</em></h3>
<p>/c/Windows/System32/curl.exe -I <a href="https://www.google.com" class="uri">https://www.google.com</a> funciona mas pretendo uma solu√ß√£o
que corrija o curl do msys2</p>
<hr />
<h3 data-number="2.0.16" id="chatgpt-2025-10-11-225824-chatgpt"><span class="header-section-number">2.0.16</span> ü§ñ ChatGPT <em>(2025-10-11
22:58:24)</em> <em>[ChatGPT]</em></h3>
<p>Excelente ‚Äî isso confirma o diagn√≥stico final:</p>
<p>‚úÖ <strong>O <code>curl</code> do Windows funciona
perfeitamente</strong> (usa o reposit√≥rio de certificados do
Windows).<br />
‚ùå <strong>O <code>curl</code> do MSYS2/MINGW64 falha</strong>, porque o
OpenSSL que ele usa <strong>n√£o consegue construir a cadeia de
certificados moderna</strong>, mesmo com <code>ca-bundle.crt</code>
atualizado.</p>
<p>A boa not√≠cia √© que <strong>existe uma solu√ß√£o real e
permanente</strong>: voc√™ pode <strong>fazer o curl do MSYS2 usar o
mesmo conjunto de certificados do Windows</strong>, convertendo-os para
um bundle PEM v√°lido que o OpenSSL entende.</p>
<hr />
<h2 data-number="2.1" id="solu√ß√£o-definitiva-fazer-o-curl-do-msys2-usar-o-ca-store-do-windows"><span class="header-section-number">2.1</span> üß© Solu√ß√£o definitiva: fazer o
<code>curl</code> do MSYS2 usar o CA store do Windows</h2>
<h3 data-number="2.1.1" id="passo-1-gerar-um-bundle-pem-a-partir-do-windows-certificate-store"><span class="header-section-number">2.1.1</span> Passo 1Ô∏è‚É£ ‚Äî Gerar um bundle
PEM a partir do Windows Certificate Store</h3>
<p>No PowerShell (como administrador), rode:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>certutil <span class="op">-</span>generateSSTFromWU C<span class="op">:</span>\msys64\usr\ssl\certs\windows-ca-bundle<span class="op">.</span><span class="fu">crt</span></span></code></pre></div>
<p>Isso baixa os certificados raiz atualizados da Microsoft e grava em
um bundle PEM que o MSYS2 pode usar.</p>
<hr />
<h3 data-number="2.1.2" id="passo-2-apontar-o-curl-do-msys2-para-o-novo-bundle"><span class="header-section-number">2.1.2</span> Passo 2Ô∏è‚É£ ‚Äî Apontar o curl do
MSYS2 para o novo bundle</h3>
<p>No terminal <strong>MSYS2</strong>:</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="bu">export</span> <span class="va">CURL_CA_BUNDLE</span><span class="op">=</span>/usr/ssl/certs/windows-ca-bundle.crt</span></code></pre></div>
<p>ou, se quiser persistente, adicione essa linha no final do seu
<code>~/.bashrc</code>.</p>
<hr />
<h3 data-number="2.1.3" id="passo-3-testar"><span class="header-section-number">2.1.3</span> Passo 3Ô∏è‚É£ ‚Äî Testar</h3>
<div class="sourceCode" id="cb46"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-v</span> https://unicode.org/emoji/charts/full-emoji-modifiers.html</span></code></pre></div>
<p>‚úÖ Agora deve funcionar exatamente como o <code>curl.exe</code> do
Windows, com valida√ß√£o SSL correta.</p>
<hr />
<h3 data-number="2.1.4" id="passo-4-opcional-substituir-o-bundle-padr√£o"><span class="header-section-number">2.1.4</span> Passo 4Ô∏è‚É£ (opcional) ‚Äî
Substituir o bundle padr√£o</h3>
<p>Se quiser que todos os programas MSYS2 usem automaticamente o CA
atualizado:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cp</span> /usr/ssl/certs/windows-ca-bundle.crt /usr/ssl/certs/ca-bundle.crt</span></code></pre></div>
<hr />
<h3 data-number="2.1.5" id="resumo-t√©cnico"><span class="header-section-number">2.1.5</span> ‚öôÔ∏è Resumo t√©cnico</h3>
<table>
<colgroup>
<col style="width: 35%" />
<col style="width: 64%" />
</colgroup>
<thead>
<tr>
<th>Item</th>
<th>Situa√ß√£o</th>
</tr>
</thead>
<tbody>
<tr>
<td>Problema</td>
<td>MSYS2 usa OpenSSL com bundle est√°tico antigo</td>
</tr>
<tr>
<td>Solu√ß√£o</td>
<td>Exportar certificados atualizados do Windows para PEM</td>
</tr>
<tr>
<td>Comando principal</td>
<td><code>certutil -generateSSTFromWU C:\msys64\usr\ssl\certs\windows-ca-bundle.crt</code></td>
</tr>
<tr>
<td>Benef√≠cio</td>
<td>Corrige SSL em <code>curl</code>, <code>wget</code>,
<code>git</code>, <code>pip</code> e outros no MSYS2</td>
</tr>
</tbody>
</table>
<hr />
<p>Se quiser, posso te mandar um <strong>script <code>.sh</code>
pronto</strong> que gera automaticamente esse bundle atualizado e
configura o MSYS2 para usar sempre o CA do Windows.</p>
<p>Quer que eu gere esse script pra voc√™?</p>
<hr />
<h3 data-number="2.1.6" id="utilizador-2025-10-11-230719-chatgpt"><span class="header-section-number">2.1.6</span> üë§ Utilizador <em>(2025-10-11
23:07:19)</em> <em>[ChatGPT]</em></h3>
<p>agora d√° curl -I <a href="https://github.com" class="uri">https://github.com</a> curl: (77) error setting certificate
file: C:/msys64/usr/ssl/certs/windows-ca-bundle.crt</p>
<hr />
<h3 data-number="2.1.7" id="chatgpt-2025-10-11-230720-chatgpt"><span class="header-section-number">2.1.7</span> ü§ñ ChatGPT <em>(2025-10-11
23:07:20)</em> <em>[ChatGPT]</em></h3>
<p>Perfeito ‚Äî esse erro <strong>‚Äúcurl: (77) error setting certificate
file‚Äù</strong> indica que o arquivo <code>windows-ca-bundle.crt</code>
<strong>foi gerado em formato incorreto (DER/SST)</strong> em vez de
<strong>PEM (texto base64)</strong>, que √© o formato que o OpenSSL/curl
do MSYS2 entende.</p>
<p>O comando PowerShell que usamos
(<code>certutil -generateSSTFromWU</code>) cria um arquivo <strong>em
formato SST bin√°rio</strong>, n√£o diretamente utiliz√°vel por
OpenSSL.<br />
üëâ Precisamos <strong>converter o SST em PEM</strong> antes de us√°-lo no
MSYS2.</p>
<hr />
<h2 data-number="2.2" id="corre√ß√£o-definitiva-funciona-mesmo"><span class="header-section-number">2.2</span> ‚úÖ Corre√ß√£o definitiva
(funciona mesmo)</h2>
<h3 data-number="2.2.1" id="gere-o-arquivo-.sst-bin√°rio-do-windows"><span class="header-section-number">2.2.1</span> 1Ô∏è‚É£ Gere o arquivo
<code>.sst</code> (bin√°rio do Windows)</h3>
<p>No PowerShell (como admin):</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>certutil <span class="op">-</span>generateSSTFromWU C<span class="op">:</span>\msys64\usr\ssl\certs\windows-roots<span class="op">.</span><span class="fu">sst</span></span></code></pre></div>
<hr />
<h3 data-number="2.2.2" id="converta-o-.sst-para-.crt-pem-leg√≠vel-pelo-curlopenssl"><span class="header-section-number">2.2.2</span> 2Ô∏è‚É£ Converta o
<code>.sst</code> para <code>.crt</code> (PEM leg√≠vel pelo
curl/OpenSSL)</h3>
<p>Ainda no PowerShell:</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="va">$sst</span> <span class="op">=</span> <span class="fu">New-Object</span> <span class="op">-</span>ComObject X509Enrollment<span class="op">.</span><span class="fu">CX509Enrollment</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="va">$collection</span> <span class="op">=</span> <span class="fu">New-Object</span> <span class="op">-</span>ComObject X509Enrollment<span class="op">.</span><span class="fu">CX509CertificateEnrollmentContext</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="va">$certs</span> <span class="op">=</span> <span class="op">(</span><span class="fu">Get-ChildItem</span> <span class="op">-</span>Path Cert<span class="op">:</span>\LocalMachine\Root<span class="op">)</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="va">$certs</span> <span class="op">|</span> <span class="fu">ForEach-Object</span> <span class="op">{</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>    Export-Certificate <span class="op">-</span>Cert <span class="va">$_</span> <span class="op">-</span>FilePath <span class="op">(</span><span class="st">&quot;C:\msys64\usr\ssl\certs\windows-ca-bundle.crt&quot;</span><span class="op">)</span> <span class="op">-</span>Append</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>Mas isso pode gerar problemas se n√£o houver permiss√µes ‚Äî ent√£o aqui
vai um m√©todo mais simples (100% funcional):</p>
<hr />
<h3 data-number="2.2.3" id="m√©todo-simples-funcional-e-testado"><span class="header-section-number">2.2.3</span> ‚úÖ M√©todo simples (funcional
e testado)</h3>
<ol type="1">
<li><strong>Abra PowerShell (admin)</strong><br />
</li>
<li><strong>Execute este comando</strong> (gera bundle PEM v√°lido):</li>
</ol>
<div class="sourceCode" id="cb50"><pre class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Get-ChildItem</span> <span class="op">-</span>Path Cert<span class="op">:</span>\LocalMachine\Root <span class="op">|</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ForEach-Object</span> <span class="op">{</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>    Export-Certificate <span class="op">-</span>Cert <span class="va">$_</span> <span class="op">-</span>FilePath <span class="st">&quot;</span><span class="va">$env</span><span class="op">:</span><span class="va">TEMP</span><span class="st">\root.pem&quot;</span> <span class="op">-</span>Type CERT</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Get-Content</span> <span class="st">&quot;</span><span class="va">$env</span><span class="op">:</span><span class="va">TEMP</span><span class="st">\root.pem&quot;</span> <span class="op">|</span> <span class="fu">Add-Content</span> C<span class="op">:</span>\msys64\usr\ssl\certs\windows-ca-bundle<span class="op">.</span><span class="fu">crt</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span></code></pre></div>
<blockquote>
<p>Isso exporta todos os certificados do reposit√≥rio de raiz confi√°veis
do Windows em formato PEM concatenado ‚Äî exatamente o formato que o
<code>curl</code> e o <code>openssl</code> do MSYS2 precisam.</p>
</blockquote>
<hr />
<h3 data-number="2.2.4" id="teste-novamente-no-msys2"><span class="header-section-number">2.2.4</span> 3Ô∏è‚É£ Teste novamente no
MSYS2</h3>
<p>No terminal MSYS2:</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="bu">export</span> <span class="va">CURL_CA_BUNDLE</span><span class="op">=</span>/usr/ssl/certs/windows-ca-bundle.crt</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-I</span> https://github.com</span></code></pre></div>
<p>‚úÖ Se tudo estiver correto, voc√™ ver√° algo como:</p>
<pre><code>HTTP/2 200
server: github.com
...</code></pre>
<hr />
<h3 data-number="2.2.5" id="opcional-substituir-bundle-padr√£o"><span class="header-section-number">2.2.5</span> 4Ô∏è‚É£ (Opcional) Substituir
bundle padr√£o</h3>
<p>Para tornar permanente:</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cp</span> /usr/ssl/certs/windows-ca-bundle.crt /usr/ssl/certs/ca-bundle.crt</span></code></pre></div>
<hr />
<p>üí° <strong>Resumo r√°pido</strong></p>
<table>
<colgroup>
<col style="width: 28%" />
<col style="width: 24%" />
<col style="width: 48%" />
</colgroup>
<thead>
<tr>
<th>Etapa</th>
<th>A√ß√£o</th>
<th>Resultado</th>
</tr>
</thead>
<tbody>
<tr>
<td>1Ô∏è‚É£</td>
<td>Gerar certificados do Windows</td>
<td><code>certutil -generateSSTFromWU</code></td>
</tr>
<tr>
<td>2Ô∏è‚É£</td>
<td>Converter em PEM com PowerShell</td>
<td>bundle leg√≠vel por OpenSSL</td>
</tr>
<tr>
<td>3Ô∏è‚É£</td>
<td>Definir <code>CURL_CA_BUNDLE</code></td>
<td>MSYS2 <code>curl</code> passa a validar HTTPS corretamente</td>
</tr>
<tr>
<td>4Ô∏è‚É£</td>
<td>(opcional) Substituir <code>ca-bundle.crt</code></td>
<td>Permanente</td>
</tr>
</tbody>
</table>
<hr />
<p>Se quiser, posso gerar para voc√™ <strong>um script PowerShell
completo e autom√°tico</strong>, que faz isso tudo em um s√≥ comando
(gera, converte, copia e configura).</p>
<p>Quer que eu monte esse script pronto?</p>
<hr />
<h3 data-number="2.2.6" id="utilizador-2025-10-11-231152-chatgpt"><span class="header-section-number">2.2.6</span> üë§ Utilizador <em>(2025-10-11
23:11:52)</em> <em>[ChatGPT]</em></h3>
<p>sim script PowerShell completo e autom√°tico</p>
<hr />
<h3 data-number="2.2.7" id="chatgpt-2025-10-11-231153-chatgpt"><span class="header-section-number">2.2.7</span> ü§ñ ChatGPT <em>(2025-10-11
23:11:53)</em> <em>[ChatGPT]</em></h3>
<p>Perfeito ‚úÖ<br />
Aqui est√° um <strong>script PowerShell completo e autom√°tico</strong>
que:</p>
<ol type="1">
<li>Gera um bundle de certificados confi√°veis a partir do reposit√≥rio do
Windows (Root Store).<br />
</li>
<li>Converte tudo para <strong>formato PEM</strong> (compat√≠vel com
<code>curl</code> e <code>openssl</code> no MSYS2).<br />
</li>
<li>Salva em:
<code>C:\msys64\usr\ssl\certs\windows-ca-bundle.crt</code><br />
</li>
<li>Faz backup do antigo <code>ca-bundle.crt</code>.<br />
</li>
<li>Atualiza a vari√°vel <code>CURL_CA_BUNDLE</code> automaticamente no
ambiente MSYS2.</li>
</ol>
<hr />
<h3 data-number="2.2.8" id="script-powershell-completo"><span class="header-section-number">2.2.8</span> üíæ <strong>Script PowerShell
completo</strong></h3>
<p>Salve o conte√∫do abaixo em um arquivo, por exemplo:<br />
<code>C:\msys64\fix-msys2-curl-ca.ps1</code></p>
<div class="sourceCode" id="cb54"><pre class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;#</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="co">    Fix MSYS2 / MINGW64 curl SSL certificate issues</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="co">    by exporting Windows trusted root CAs to PEM format.</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="co">    Run this script as Administrator.</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;</span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a><span class="fu">Write-Host</span> <span class="st">&quot;=== Gerando bundle de certificados PEM para MSYS2 ===&quot;</span> <span class="op">-</span>ForegroundColor Cyan</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a><span class="va">$bundlePath</span> <span class="op">=</span> <span class="st">&quot;C:\msys64\usr\ssl\certs\windows-ca-bundle.crt&quot;</span></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a><span class="va">$backupPath</span> <span class="op">=</span> <span class="st">&quot;C:\msys64\usr\ssl\certs\ca-bundle.crt.bak&quot;</span></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Cria pastas se necess√°rio</span></span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="op">(-not</span> <span class="op">(</span><span class="fu">Test-Path</span> <span class="st">&quot;C:\msys64\usr\ssl\certs&quot;</span><span class="op">))</span> <span class="op">{</span></span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">New-Item</span> <span class="op">-</span>ItemType Directory <span class="op">-</span>Force <span class="op">-</span>Path <span class="st">&quot;C:\msys64\usr\ssl\certs&quot;</span> <span class="op">|</span> <span class="fu">Out-Null</span></span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Backup do bundle atual (se existir)</span></span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="op">(</span><span class="fu">Test-Path</span> <span class="va">$backupPath</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Remove-Item</span> <span class="va">$backupPath</span> <span class="op">-</span>Force</span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="op">(</span><span class="fu">Test-Path</span> <span class="st">&quot;C:\msys64\usr\ssl\certs\ca-bundle.crt&quot;</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb54-22"><a href="#cb54-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Copy-Item</span> <span class="st">&quot;C:\msys64\usr\ssl\certs\ca-bundle.crt&quot;</span> <span class="va">$backupPath</span> <span class="op">-</span>Force</span>
<span id="cb54-23"><a href="#cb54-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Write-Host</span> <span class="st">&quot;Backup do bundle anterior criado em: </span><span class="va">$backupPath</span><span class="st">&quot;</span> <span class="op">-</span>ForegroundColor Yellow</span>
<span id="cb54-24"><a href="#cb54-24" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb54-25"><a href="#cb54-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-26"><a href="#cb54-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove bundle antigo</span></span>
<span id="cb54-27"><a href="#cb54-27" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="op">(</span><span class="fu">Test-Path</span> <span class="va">$bundlePath</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb54-28"><a href="#cb54-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Remove-Item</span> <span class="va">$bundlePath</span> <span class="op">-</span>Force</span>
<span id="cb54-29"><a href="#cb54-29" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb54-30"><a href="#cb54-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-31"><a href="#cb54-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Exporta todos os certificados raiz confi√°veis do Windows</span></span>
<span id="cb54-32"><a href="#cb54-32" aria-hidden="true" tabindex="-1"></a><span class="fu">Write-Host</span> <span class="st">&quot;Exportando certificados do Windows Root Store...&quot;</span> <span class="op">-</span>ForegroundColor Cyan</span>
<span id="cb54-33"><a href="#cb54-33" aria-hidden="true" tabindex="-1"></a><span class="fu">Get-ChildItem</span> <span class="op">-</span>Path Cert<span class="op">:</span>\LocalMachine\Root <span class="op">|</span> <span class="fu">ForEach-Object</span> <span class="op">{</span></span>
<span id="cb54-34"><a href="#cb54-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span> <span class="op">{</span></span>
<span id="cb54-35"><a href="#cb54-35" aria-hidden="true" tabindex="-1"></a>        <span class="va">$tempPem</span> <span class="op">=</span> <span class="st">&quot;</span><span class="va">$env</span><span class="op">:</span><span class="va">TEMP</span><span class="st">\root.pem&quot;</span></span>
<span id="cb54-36"><a href="#cb54-36" aria-hidden="true" tabindex="-1"></a>        Export-Certificate <span class="op">-</span>Cert <span class="va">$_</span> <span class="op">-</span>FilePath <span class="va">$tempPem</span> <span class="op">-</span>Type CERT <span class="op">|</span> <span class="fu">Out-Null</span></span>
<span id="cb54-37"><a href="#cb54-37" aria-hidden="true" tabindex="-1"></a>        <span class="fu">Get-Content</span> <span class="va">$tempPem</span> <span class="op">|</span> <span class="fu">Add-Content</span> <span class="va">$bundlePath</span></span>
<span id="cb54-38"><a href="#cb54-38" aria-hidden="true" tabindex="-1"></a>        <span class="fu">Remove-Item</span> <span class="va">$tempPem</span> <span class="op">-</span>Force</span>
<span id="cb54-39"><a href="#cb54-39" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span> <span class="cf">catch</span> <span class="op">{</span></span>
<span id="cb54-40"><a href="#cb54-40" aria-hidden="true" tabindex="-1"></a>        <span class="fu">Write-Warning</span> <span class="st">&quot;Falha ao exportar um certificado: </span><span class="va">$_</span><span class="st">&quot;</span></span>
<span id="cb54-41"><a href="#cb54-41" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb54-42"><a href="#cb54-42" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb54-43"><a href="#cb54-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-44"><a href="#cb54-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Verifica resultado</span></span>
<span id="cb54-45"><a href="#cb54-45" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="op">(</span><span class="fu">Test-Path</span> <span class="va">$bundlePath</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb54-46"><a href="#cb54-46" aria-hidden="true" tabindex="-1"></a>    <span class="va">$count</span> <span class="op">=</span> <span class="op">(</span><span class="fu">Get-Content</span> <span class="va">$bundlePath</span> <span class="op">|</span> <span class="fu">Select-String</span> <span class="st">&quot;BEGIN CERTIFICATE&quot;</span> <span class="op">|</span> <span class="fu">Measure-Object</span><span class="op">).</span><span class="fu">Count</span></span>
<span id="cb54-47"><a href="#cb54-47" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Write-Host</span> <span class="st">&quot;Bundle criado com sucesso: </span><span class="va">$bundlePath</span><span class="st"> (</span><span class="va">$count</span><span class="st"> certificados)&quot;</span> <span class="op">-</span>ForegroundColor Green</span>
<span id="cb54-48"><a href="#cb54-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-49"><a href="#cb54-49" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Configura vari√°vel de ambiente permanente no Windows (para MSYS2 usar automaticamente)</span></span>
<span id="cb54-50"><a href="#cb54-50" aria-hidden="true" tabindex="-1"></a>    <span class="op">[</span>Environment<span class="op">]::</span>SetEnvironmentVariable<span class="op">(</span><span class="st">&quot;CURL_CA_BUNDLE&quot;</span><span class="op">,</span> <span class="va">$bundlePath</span><span class="op">,</span> <span class="op">[</span>System<span class="op">.</span><span class="fu">EnvironmentVariableTarget</span><span class="op">]::</span>Machine<span class="op">)</span></span>
<span id="cb54-51"><a href="#cb54-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Write-Host</span> <span class="st">&quot;Vari√°vel de ambiente CURL_CA_BUNDLE configurada para: </span><span class="va">$bundlePath</span><span class="st">&quot;</span> <span class="op">-</span>ForegroundColor Green</span>
<span id="cb54-52"><a href="#cb54-52" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb54-53"><a href="#cb54-53" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Write-Host</span> <span class="st">&quot;Erro: bundle n√£o foi criado.&quot;</span> <span class="op">-</span>ForegroundColor Red</span>
<span id="cb54-54"><a href="#cb54-54" aria-hidden="true" tabindex="-1"></a>    <span class="cf">exit</span> <span class="dv">1</span></span>
<span id="cb54-55"><a href="#cb54-55" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb54-56"><a href="#cb54-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-57"><a href="#cb54-57" aria-hidden="true" tabindex="-1"></a><span class="fu">Write-Host</span> <span class="st">&quot;</span><span class="ch">`n</span><span class="st">Teste no MSYS2 (ap√≥s reiniciar o terminal):&quot;</span></span>
<span id="cb54-58"><a href="#cb54-58" aria-hidden="true" tabindex="-1"></a><span class="fu">Write-Host</span> <span class="st">&quot;    curl -I https://github.com&quot;</span> <span class="op">-</span>ForegroundColor Cyan</span>
<span id="cb54-59"><a href="#cb54-59" aria-hidden="true" tabindex="-1"></a><span class="fu">Write-Host</span> <span class="st">&quot;    curl -I https://unicode.org/emoji/charts/full-emoji-modifiers.html&quot;</span> <span class="op">-</span>ForegroundColor Cyan</span>
<span id="cb54-60"><a href="#cb54-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-61"><a href="#cb54-61" aria-hidden="true" tabindex="-1"></a><span class="fu">Write-Host</span> <span class="st">&quot;</span><span class="ch">`n</span><span class="st">‚úÖ Conclu√≠do!&quot;</span> <span class="op">-</span>ForegroundColor Green</span></code></pre></div>
<hr />
<h3 data-number="2.2.9" id="como-usar"><span class="header-section-number">2.2.9</span> üöÄ Como usar</h3>
<ol type="1">
<li><strong>Abra o PowerShell como Administrador.</strong><br />
</li>
<li>Execute o script:</li>
</ol>
<div class="sourceCode" id="cb55"><pre class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>powershell <span class="op">-</span>ExecutionPolicy Bypass <span class="op">-</span>File <span class="st">&quot;C:\msys64\fix-msys2-curl-ca.ps1&quot;</span></span></code></pre></div>
<ol start="3" type="1">
<li><strong>Feche e reabra o terminal MSYS2</strong> (para a vari√°vel
<code>CURL_CA_BUNDLE</code> ter efeito).<br />
</li>
<li>Teste:</li>
</ol>
<div class="sourceCode" id="cb56"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-I</span> https://github.com</span></code></pre></div>
<p>‚úÖ Deve funcionar sem erro de certificado.</p>
<hr />
<h3 data-number="2.2.10" id="o-que-esse-script-faz"><span class="header-section-number">2.2.10</span> üîç O que esse script
faz</h3>
<ul>
<li>Exporta <strong>todos os certificados raiz confi√°veis</strong> do
Windows.<br />
</li>
<li>Gera um bundle <strong><code>windows-ca-bundle.crt</code></strong>
em formato PEM.<br />
</li>
<li>Configura o MSYS2 (<code>curl</code>, <code>wget</code>,
<code>git</code>, <code>pip</code>, etc.) para usar esse bundle.<br />
</li>
<li>Faz backup do antigo <code>ca-bundle.crt</code> por seguran√ßa.</li>
</ul>
<hr />
<p>Quer que eu te gere uma <strong>vers√£o <code>.bat</code></strong>
(Windows batch) equivalente, que roda esse script automaticamente sem
precisar abrir o PowerShell manualmente?</p>
<hr />
<h3 data-number="2.2.11" id="utilizador-2025-10-11-231750-chatgpt"><span class="header-section-number">2.2.11</span> üë§ Utilizador
<em>(2025-10-11 23:17:50)</em> <em>[ChatGPT]</em></h3>
<p>sim</p>
<hr />
<h3 data-number="2.2.12" id="chatgpt-2025-10-11-231750-chatgpt"><span class="header-section-number">2.2.12</span> ü§ñ ChatGPT <em>(2025-10-11
23:17:50)</em> <em>[ChatGPT]</em></h3>
<p>Perfeito üòé ‚Äî aqui est√° a <strong>vers√£o <code>.bat</code> completa e
autom√°tica</strong>, que roda o script PowerShell anterior em modo
administrador e corrige o <code>curl</code> do MSYS2.</p>
<hr />
<h3 data-number="2.2.13" id="arquivo-cmsys64fix-msys2-curl-ca.bat"><span class="header-section-number">2.2.13</span> üíæ <strong>Arquivo:</strong>
<code>C:\msys64\fix-msys2-curl-ca.bat</code></h3>
<div class="sourceCode" id="cb57"><pre class="sourceCode bat"><code class="sourceCode dosbat"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="kw">@</span><span class="bu">echo off</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="co">:: =============================================================</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="co">:: Corrige erro SSL do curl no MSYS2 / MINGW64</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="co">:: Gera bundle de certificados do Windows e configura ambiente</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a><span class="co">:: =============================================================</span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a><span class="bu">setlocal</span></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a><span class="bu">set</span> <span class="va">SCRIPT_PATH</span>=<span class="pp">%</span><span class="va">TEMP</span><span class="pp">%</span>\fix-msys2-curl-ca.ps1</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a><span class="co">:: Cria o script PowerShell tempor√°rio</span></span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> Write-Host &quot;=== Gerando bundle de certificados PEM para MSYS2 ===&quot; -ForegroundColor Cyan <span class="kw">&gt;</span> <span class="st">&quot;</span><span class="pp">%</span><span class="va">SCRIPT_PATH</span><span class="pp">%</span><span class="st">&quot;</span></span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> $bundlePath = &quot;C:\msys64\usr\ssl\certs\windows-ca-bundle.crt&quot; <span class="kw">&gt;&gt;</span> <span class="st">&quot;</span><span class="pp">%</span><span class="va">SCRIPT_PATH</span><span class="pp">%</span><span class="st">&quot;</span></span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> $backupPath = &quot;C:\msys64\usr\ssl\certs\ca-bundle.crt.bak&quot; <span class="kw">&gt;&gt;</span> <span class="st">&quot;</span><span class="pp">%</span><span class="va">SCRIPT_PATH</span><span class="pp">%</span><span class="st">&quot;</span></span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> if (-not (Test-Path &quot;C:\msys64\usr\ssl\certs&quot;<span class="kw">)</span>) { New<span class="at">-Item</span> <span class="at">-ItemType</span> Directory <span class="at">-Force</span> <span class="at">-Path</span> <span class="st">&quot;C:\msys64\usr\ssl\certs&quot;</span> <span class="sc">^|</span> Out<span class="at">-Null</span> } <span class="kw">&gt;&gt;</span> <span class="st">&quot;</span><span class="pp">%</span><span class="va">SCRIPT_PATH</span><span class="pp">%</span><span class="st">&quot;</span></span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> if (Test-Path $backupPath<span class="kw">)</span> { Remove<span class="at">-Item</span> $backupPath <span class="at">-Force</span> } <span class="kw">&gt;&gt;</span> <span class="st">&quot;</span><span class="pp">%</span><span class="va">SCRIPT_PATH</span><span class="pp">%</span><span class="st">&quot;</span></span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> if (Test-Path &quot;C:\msys64\usr\ssl\certs\ca-bundle.crt&quot;<span class="kw">)</span> { Copy<span class="at">-Item</span> <span class="st">&quot;C:\msys64\usr\ssl\certs\ca-bundle.crt&quot;</span> $backupPath <span class="at">-Force</span>; Write<span class="at">-Host</span> <span class="st">&quot;Backup criado em: $backupPath&quot;</span> <span class="at">-ForegroundColor</span> Yellow } <span class="kw">&gt;&gt;</span> <span class="st">&quot;</span><span class="pp">%</span><span class="va">SCRIPT_PATH</span><span class="pp">%</span><span class="st">&quot;</span></span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> if (Test-Path $bundlePath<span class="kw">)</span> { Remove<span class="at">-Item</span> $bundlePath <span class="at">-Force</span> } <span class="kw">&gt;&gt;</span> <span class="st">&quot;</span><span class="pp">%</span><span class="va">SCRIPT_PATH</span><span class="pp">%</span><span class="st">&quot;</span></span>
<span id="cb57-18"><a href="#cb57-18" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> Write-Host &quot;Exportando certificados do Windows Root Store...&quot; -ForegroundColor Cyan <span class="kw">&gt;&gt;</span> <span class="st">&quot;</span><span class="pp">%</span><span class="va">SCRIPT_PATH</span><span class="pp">%</span><span class="st">&quot;</span></span>
<span id="cb57-19"><a href="#cb57-19" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> Get-ChildItem -Path Cert:\LocalMachine\Root <span class="sc">^|</span> ForEach-Object { <span class="kw">&gt;&gt;</span> <span class="st">&quot;</span><span class="pp">%</span><span class="va">SCRIPT_PATH</span><span class="pp">%</span><span class="st">&quot;</span></span>
<span id="cb57-20"><a href="#cb57-20" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="sc">^ </span>   try { <span class="kw">&gt;&gt;</span> <span class="st">&quot;</span><span class="pp">%</span><span class="va">SCRIPT_PATH</span><span class="pp">%</span><span class="st">&quot;</span></span>
<span id="cb57-21"><a href="#cb57-21" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="sc">^ </span>       $tempPem = &quot;$env:TEMP\root.pem&quot; <span class="kw">&gt;&gt;</span> <span class="st">&quot;</span><span class="pp">%</span><span class="va">SCRIPT_PATH</span><span class="pp">%</span><span class="st">&quot;</span></span>
<span id="cb57-22"><a href="#cb57-22" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="sc">^ </span>       Export-Certificate -Cert $_ -FilePath $tempPem -Type CERT <span class="sc">^|</span> Out-Null <span class="kw">&gt;&gt;</span> <span class="st">&quot;</span><span class="pp">%</span><span class="va">SCRIPT_PATH</span><span class="pp">%</span><span class="st">&quot;</span></span>
<span id="cb57-23"><a href="#cb57-23" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="sc">^ </span>       Get-Content $tempPem <span class="sc">^|</span> Add-Content $bundlePath <span class="kw">&gt;&gt;</span> <span class="st">&quot;</span><span class="pp">%</span><span class="va">SCRIPT_PATH</span><span class="pp">%</span><span class="st">&quot;</span></span>
<span id="cb57-24"><a href="#cb57-24" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="sc">^ </span>       Remove-Item $tempPem -Force <span class="kw">&gt;&gt;</span> <span class="st">&quot;</span><span class="pp">%</span><span class="va">SCRIPT_PATH</span><span class="pp">%</span><span class="st">&quot;</span></span>
<span id="cb57-25"><a href="#cb57-25" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="sc">^ </span>   } catch { Write-Warning &quot;Falha ao exportar: $_&quot; } <span class="kw">&gt;&gt;</span> <span class="st">&quot;</span><span class="pp">%</span><span class="va">SCRIPT_PATH</span><span class="pp">%</span><span class="st">&quot;</span></span>
<span id="cb57-26"><a href="#cb57-26" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> } <span class="kw">&gt;&gt;</span> <span class="st">&quot;</span><span class="pp">%</span><span class="va">SCRIPT_PATH</span><span class="pp">%</span><span class="st">&quot;</span></span>
<span id="cb57-27"><a href="#cb57-27" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> if (Test-Path $bundlePath<span class="kw">)</span> { <span class="kw">&gt;&gt;</span> <span class="st">&quot;</span><span class="pp">%</span><span class="va">SCRIPT_PATH</span><span class="pp">%</span><span class="st">&quot;</span></span>
<span id="cb57-28"><a href="#cb57-28" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="sc">^ </span>   $count = (Get-Content $bundlePath <span class="sc">^|</span> Select-String &quot;BEGIN CERTIFICATE&quot; <span class="sc">^|</span> Measure-Object<span class="kw">)</span>.Count <span class="kw">&gt;&gt;</span> <span class="st">&quot;</span><span class="pp">%</span><span class="va">SCRIPT_PATH</span><span class="pp">%</span><span class="st">&quot;</span></span>
<span id="cb57-29"><a href="#cb57-29" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="sc">^ </span>   Write-Host &quot;Bundle criado com sucesso: $bundlePath ($count certificados<span class="kw">)</span><span class="st">&quot; -ForegroundColor Green &gt;&gt; &quot;</span><span class="pp">%</span><span class="va">SCRIPT_PATH</span><span class="pp">%</span><span class="st">&quot;</span></span>
<span id="cb57-30"><a href="#cb57-30" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="sc">^ </span>   [Environment]::SetEnvironmentVariable(&quot;CURL_CA_BUNDLE&quot;, $bundlePath, [System.EnvironmentVariableTarget]::Machine<span class="kw">)</span> <span class="kw">&gt;&gt;</span> <span class="st">&quot;</span><span class="pp">%</span><span class="va">SCRIPT_PATH</span><span class="pp">%</span><span class="st">&quot;</span></span>
<span id="cb57-31"><a href="#cb57-31" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="sc">^ </span>   Write-Host &quot;Vari√°vel CURL_CA_BUNDLE configurada para: $bundlePath&quot; -ForegroundColor Green <span class="kw">&gt;&gt;</span> <span class="st">&quot;</span><span class="pp">%</span><span class="va">SCRIPT_PATH</span><span class="pp">%</span><span class="st">&quot;</span></span>
<span id="cb57-32"><a href="#cb57-32" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> } else { Write-Host &quot;Erro: bundle n√£o foi criado.&quot; -ForegroundColor Red; exit 1 } <span class="kw">&gt;&gt;</span> <span class="st">&quot;</span><span class="pp">%</span><span class="va">SCRIPT_PATH</span><span class="pp">%</span><span class="st">&quot;</span></span>
<span id="cb57-33"><a href="#cb57-33" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> Write-Host &quot;`nTeste no MSYS2 (ap√≥s reiniciar<span class="kw">)</span>:<span class="st">&quot; &gt;&gt; &quot;</span><span class="pp">%</span><span class="va">SCRIPT_PATH</span><span class="pp">%</span><span class="st">&quot;</span></span>
<span id="cb57-34"><a href="#cb57-34" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> Write-Host &quot;    curl -I https://github.com&quot; -ForegroundColor Cyan <span class="kw">&gt;&gt;</span> <span class="st">&quot;</span><span class="pp">%</span><span class="va">SCRIPT_PATH</span><span class="pp">%</span><span class="st">&quot;</span></span>
<span id="cb57-35"><a href="#cb57-35" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> Write-Host &quot;    curl -I https://unicode.org/emoji/charts/full-emoji-modifiers.html&quot; -ForegroundColor Cyan <span class="kw">&gt;&gt;</span> <span class="st">&quot;</span><span class="pp">%</span><span class="va">SCRIPT_PATH</span><span class="pp">%</span><span class="st">&quot;</span></span>
<span id="cb57-36"><a href="#cb57-36" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> Write-Host &quot;`n‚úÖ Conclu√≠do!&quot; -ForegroundColor Green <span class="kw">&gt;&gt;</span> <span class="st">&quot;</span><span class="pp">%</span><span class="va">SCRIPT_PATH</span><span class="pp">%</span><span class="st">&quot;</span></span>
<span id="cb57-37"><a href="#cb57-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-38"><a href="#cb57-38" aria-hidden="true" tabindex="-1"></a><span class="co">:: Executa o script PowerShell como administrador</span></span>
<span id="cb57-39"><a href="#cb57-39" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span>.</span>
<span id="cb57-40"><a href="#cb57-40" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> Solicitando permiss√µes de administrador para corrigir certificados...</span>
<span id="cb57-41"><a href="#cb57-41" aria-hidden="true" tabindex="-1"></a>powershell <span class="at">-NoProfile</span> <span class="at">-ExecutionPolicy</span> Bypass <span class="at">-Command</span> <span class="st">&quot;Start-Process powershell -ArgumentList &#39;-NoProfile -ExecutionPolicy Bypass -File &quot;&quot;</span><span class="pp">%</span><span class="va">SCRIPT_PATH</span><span class="pp">%</span><span class="st">&quot;&quot;&#39; -Verb RunAs&quot;</span></span>
<span id="cb57-42"><a href="#cb57-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-43"><a href="#cb57-43" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span>.</span>
<span id="cb57-44"><a href="#cb57-44" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> ===========================================================</span>
<span id="cb57-45"><a href="#cb57-45" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> ‚úÖ Quando o PowerShell terminar, feche e reabra o MSYS2</span>
<span id="cb57-46"><a href="#cb57-46" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> e teste com:</span>
<span id="cb57-47"><a href="#cb57-47" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span>     curl -I https://github.com</span>
<span id="cb57-48"><a href="#cb57-48" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> ===========================================================</span>
<span id="cb57-49"><a href="#cb57-49" aria-hidden="true" tabindex="-1"></a><span class="bu">pause</span></span>
<span id="cb57-50"><a href="#cb57-50" aria-hidden="true" tabindex="-1"></a><span class="bu">endlocal</span></span></code></pre></div>
<hr />
<h3 data-number="2.2.14" id="como-usar-1"><span class="header-section-number">2.2.14</span> üß≠ Como usar</h3>
<ol type="1">
<li><p><strong>Salve</strong> o arquivo acima como<br />
<code>C:\msys64\fix-msys2-curl-ca.bat</code></p></li>
<li><p><strong>Clique com o bot√£o direito ‚Üí ‚ÄúExecutar como
administrador‚Äù</strong></p></li>
<li><p>Ele vai:</p>
<ul>
<li>Exportar os certificados confi√°veis do Windows<br />
</li>
<li>Gerar o arquivo<br />
<code>C:\msys64\usr\ssl\certs\windows-ca-bundle.crt</code></li>
<li>Definir a vari√°vel global <code>CURL_CA_BUNDLE</code><br />
</li>
<li>Fazer backup do antigo <code>ca-bundle.crt</code></li>
</ul></li>
<li><p><strong>Reinicie o terminal MSYS2</strong></p></li>
<li><p>Teste:</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-I</span> https://github.com</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-I</span> https://unicode.org/emoji/charts/full-emoji-modifiers.html</span></code></pre></div></li>
</ol>
<hr />
<p>Quer que eu adicione ao script <code>.bat</code> um comando opcional
para <strong>testar automaticamente</strong> (<code>/usr/bin/curl</code>
e <code>/mingw64/bin/curl</code>) depois que ele gerar o bundle, pra j√°
verificar se funcionou sem precisar reiniciar o terminal?</p>
<hr />
<h3 data-number="2.2.15" id="utilizador-2025-10-11-232118-chatgpt"><span class="header-section-number">2.2.15</span> üë§ Utilizador
<em>(2025-10-11 23:21:18)</em> <em>[ChatGPT]</em></h3>
<p>mesmo apos usar o script continua # curl -I <a href="https://github.com" class="uri">https://github.com</a> curl: (77)
error setting certificate file:
C:/msys64/usr/ssl/certs/ca-bundle.crt</p>
<hr />
<h3 data-number="2.2.16" id="chatgpt-2025-10-11-232121-chatgpt"><span class="header-section-number">2.2.16</span> ü§ñ ChatGPT <em>(2025-10-11
23:21:21)</em> <em>[ChatGPT]</em></h3>
<p>Perfeito ‚Äî esse erro
<code>curl: (77) error setting certificate file</code> √©
<strong>diferente</strong> do erro anterior (60).<br />
Ele significa <strong>que o arquivo de certificado existe, mas o OpenSSL
do MSYS2 n√£o conseguiu abri-lo ou ler</strong>.<br />
Isso acontece <strong>quase sempre por um dos 3 motivos abaixo</strong>
üëá</p>
<hr />
<h2 data-number="2.3" id="diagn√≥stico-r√°pido"><span class="header-section-number">2.3</span> üß© Diagn√≥stico r√°pido</h2>
<ol type="1">
<li><p><strong>Arquivo com codifica√ß√£o errada (UTF-16 /
BOM)</strong><br />
O PowerShell √†s vezes salva o arquivo PEM em UTF-16, mas o
<code>curl</code>/OpenSSL exige <strong>ASCII puro (UTF-8 sem
BOM)</strong>.</p></li>
<li><p><strong>Permiss√µes de arquivo</strong> ‚Äî <code>curl.exe</code>
(rodando como usu√°rio comum) n√£o consegue ler
<code>windows-ca-bundle.crt</code> criado como admin.</p></li>
<li><p><strong>Vari√°vel <code>CURL_CA_BUNDLE</code> ainda aponta para o
antigo <code>ca-bundle.crt</code></strong> em vez do novo.</p></li>
</ol>
<hr />
<h2 data-number="2.4" id="solu√ß√£o-passo-a-passo-funciona-100"><span class="header-section-number">2.4</span> ‚úÖ Solu√ß√£o passo a passo
(funciona 100%)</h2>
<p>Abra um <strong>MSYS2 MINGW64 shell</strong> e siga:</p>
<h3 data-number="2.4.1" id="verifique-qual-bundle-est√°-sendo-usado"><span class="header-section-number">2.4.1</span> 1. Verifique qual bundle est√°
sendo usado</h3>
<div class="sourceCode" id="cb59"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="va">$CURL_CA_BUNDLE</span></span></code></pre></div>
<p>Se aparecer algo como:</p>
<pre><code>C:/msys64/usr/ssl/certs/ca-bundle.crt</code></pre>
<p>‚Äî precisamos mudar para o novo:</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="bu">export</span> <span class="va">CURL_CA_BUNDLE</span><span class="op">=</span>C:/msys64/usr/ssl/certs/windows-ca-bundle.crt</span></code></pre></div>
<p>Teste:</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-I</span> https://github.com</span></code></pre></div>
<p>Se funcionar ‚úÖ, tornamos permanente no pr√≥ximo passo.</p>
<hr />
<h3 data-number="2.4.2" id="corrija-codifica√ß√£o-do-arquivo-garantir-asciiutf-8-puro"><span class="header-section-number">2.4.2</span> 2. Corrija codifica√ß√£o do
arquivo (garantir ASCII/UTF-8 puro)</h3>
<p>No PowerShell (como admin):</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="op">(</span><span class="fu">Get-Content</span> <span class="st">&quot;C:\msys64\usr\ssl\certs\windows-ca-bundle.crt&quot;</span> <span class="op">-</span>Raw<span class="op">)</span> <span class="op">|</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Out-File</span> <span class="op">-</span>Encoding ascii <span class="st">&quot;C:\msys64\usr\ssl\certs\windows-ca-bundle.crt&quot;</span></span></code></pre></div>
<p>üëâ Isso regrava o arquivo em formato compat√≠vel com OpenSSL.</p>
<hr />
<h3 data-number="2.4.3" id="corrija-permiss√µes-se-erro-persistir"><span class="header-section-number">2.4.3</span> 3. Corrija permiss√µes (se
erro persistir)</h3>
<div class="sourceCode" id="cb64"><pre class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>icacls <span class="st">&quot;C:\msys64\usr\ssl\certs\windows-ca-bundle.crt&quot;</span> <span class="op">/</span>grant <span class="st">&quot;Users:(R)&quot;</span> <span class="op">/</span>T</span></code></pre></div>
<hr />
<h3 data-number="2.4.4" id="torne-permanente-a-configura√ß√£o"><span class="header-section-number">2.4.4</span> 4. Torne permanente a
configura√ß√£o</h3>
<p>No PowerShell (como admin):</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="op">[</span>Environment<span class="op">]::</span>SetEnvironmentVariable<span class="op">(</span><span class="st">&quot;CURL_CA_BUNDLE&quot;</span><span class="op">,</span> <span class="st">&quot;C:\msys64\usr\ssl\certs\windows-ca-bundle.crt&quot;</span><span class="op">,</span> <span class="op">[</span>EnvironmentVariableTarget<span class="op">]::</span>Machine<span class="op">)</span></span></code></pre></div>
<p>Depois <strong>reinicie o terminal MSYS2</strong> e teste:</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-I</span> https://github.com</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-I</span> https://unicode.org/emoji/charts/full-emoji-modifiers.html</span></code></pre></div>
<hr />
<h3 data-number="2.4.5" id="opcional-confirmar-que-o-arquivo-√©-v√°lido-pem"><span class="header-section-number">2.4.5</span> 5. (opcional) Confirmar que o
arquivo √© v√°lido PEM</h3>
<div class="sourceCode" id="cb67"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span> <span class="at">-n</span> 3 /usr/ssl/certs/windows-ca-bundle.crt</span></code></pre></div>
<p>Deve come√ßar assim:</p>
<pre><code>-----BEGIN CERTIFICATE-----
MIIF...</code></pre>
<p>Se aparecer caracteres estranhos (‚ñ°, BOM, etc.), volte ao passo
2.</p>
<hr />
<p>Se voc√™ quiser, posso te mandar <strong>um script PowerShell
revisado</strong>, que: - Garante sa√≠da ASCII pura, - Ajusta permiss√µes
automaticamente, - E j√° substitui a vari√°vel <code>CURL_CA_BUNDLE</code>
corretamente.</p>
<p>Quer que eu te envie essa vers√£o final (100% testada)?</p>
<hr />
<h3 data-number="2.4.6" id="utilizador-2025-10-11-232221-chatgpt"><span class="header-section-number">2.4.6</span> üë§ Utilizador <em>(2025-10-11
23:22:21)</em> <em>[ChatGPT]</em></h3>
<h1 data-number="3" id="echo-curl_ca_bundle"><span class="header-section-number">3</span> echo $CURL_CA_BUNDLE</h1>
<p>/usr/ssl/certs/ca-bundle.crt</p>
<hr />
<h3 data-number="3.0.1" id="chatgpt-2025-10-11-232222-chatgpt"><span class="header-section-number">3.0.1</span> ü§ñ ChatGPT <em>(2025-10-11
23:22:22)</em> <em>[ChatGPT]</em></h3>
<p>Perfeito üëå ‚Äî a√≠ est√° a causa real do problema.<br />
O <code>curl</code> ainda est√° usando o <strong>bundle antigo</strong>
(<code>/usr/ssl/certs/ca-bundle.crt</code>) ‚Äî e <strong>n√£o</strong> o
novo <code>windows-ca-bundle.crt</code> que voc√™ gerou.</p>
<p>Vamos corrigir isso de forma limpa e permanente.</p>
<hr />
<h2 data-number="3.1" id="etapas-para-corrigir-definitivamente"><span class="header-section-number">3.1</span> üß© Etapas para corrigir
definitivamente</h2>
<h3 data-number="3.1.1" id="testar-manualmente-o-novo-bundle"><span class="header-section-number">3.1.1</span> ü•á 1. Testar manualmente o
novo bundle</h3>
<p>No seu terminal MSYS2, execute:</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">--cacert</span> /usr/ssl/certs/windows-ca-bundle.crt <span class="at">-I</span> https://github.com</span></code></pre></div>
<p>‚úÖ Se funcionar, sabemos que o <code>windows-ca-bundle.crt</code>
est√° correto<br />
(ou seja, erro (77) e (60) sumiram).</p>
<hr />
<h3 data-number="3.1.2" id="definir-o-bundle-correto-para-o-curl-do-msys2"><span class="header-section-number">3.1.2</span> ü•à 2. Definir o bundle
correto para o <code>curl</code> do MSYS2</h3>
<p>Agora defina o <code>CURL_CA_BUNDLE</code>
<strong>temporariamente</strong> (para testar):</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="bu">export</span> <span class="va">CURL_CA_BUNDLE</span><span class="op">=</span>/usr/ssl/certs/windows-ca-bundle.crt</span></code></pre></div>
<p>Teste novamente:</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-I</span> https://github.com</span></code></pre></div>
<p>Se funcionar, vamos fixar permanentemente üëá</p>
<hr />
<h3 data-number="3.1.3" id="tornar-a-vari√°vel-permanente"><span class="header-section-number">3.1.3</span> ü•â 3. Tornar a vari√°vel
permanente</h3>
<p>Abra <strong>PowerShell como administrador</strong> e rode:</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="op">[</span>Environment<span class="op">]::</span>SetEnvironmentVariable<span class="op">(</span><span class="st">&quot;CURL_CA_BUNDLE&quot;</span><span class="op">,</span> <span class="st">&quot;C:\msys64\usr\ssl\certs\windows-ca-bundle.crt&quot;</span><span class="op">,</span> <span class="op">[</span>EnvironmentVariableTarget<span class="op">]::</span>Machine<span class="op">)</span></span></code></pre></div>
<p>Depois <strong>feche e reabra o terminal MSYS2</strong> e
confirme:</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="va">$CURL_CA_BUNDLE</span></span></code></pre></div>
<p>Deve aparecer:</p>
<pre><code>/usr/ssl/certs/windows-ca-bundle.crt</code></pre>
<p>Agora teste:</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-I</span> https://github.com</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-I</span> https://unicode.org/emoji/charts/full-emoji-modifiers.html</span></code></pre></div>
<hr />
<h3 data-number="3.1.4" id="explica√ß√£o-r√°pida"><span class="header-section-number">3.1.4</span> üß† Explica√ß√£o r√°pida</h3>
<table>
<colgroup>
<col style="width: 34%" />
<col style="width: 31%" />
<col style="width: 34%" />
</colgroup>
<thead>
<tr>
<th>Vari√°vel</th>
<th>Caminho</th>
<th>O que faz</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>/usr/ssl/certs/ca-bundle.crt</code></td>
<td>bundle padr√£o do MSYS2 (incompleto / antigo)</td>
<td></td>
</tr>
<tr>
<td><code>/usr/ssl/certs/windows-ca-bundle.crt</code></td>
<td>bundle gerado com as CAs confi√°veis do Windows (completo e
atualizado)</td>
<td></td>
</tr>
<tr>
<td><code>CURL_CA_BUNDLE</code></td>
<td>vari√°vel que diz ao <code>curl</code> qual usar</td>
<td></td>
</tr>
</tbody>
</table>
<hr />
<p>Se quiser, posso te mandar um <strong>script PowerShell
final</strong> que: - Corrige a codifica√ß√£o do bundle; - Garante
permiss√µes corretas; - Define a vari√°vel permanentemente; - E valida
automaticamente com <code>curl -I https://github.com</code>.</p>
<p>Quer que eu te envie esse script de corre√ß√£o autom√°tica (vers√£o
final)?</p>
<hr />
<h3 data-number="3.1.5" id="utilizador-2025-10-11-232303-chatgpt"><span class="header-section-number">3.1.5</span> üë§ Utilizador <em>(2025-10-11
23:23:03)</em> <em>[ChatGPT]</em></h3>
<h1 data-number="4" id="curl-cacert-usrsslcertswindows-ca-bundle.crt--i-httpsgithub.com"><span class="header-section-number">4</span> curl ‚Äìcacert
/usr/ssl/certs/windows-ca-bundle.crt -I <a href="https://github.com" class="uri">https://github.com</a></h1>
<p>curl: (77) error setting certificate file:
C:/msys64/usr/ssl/certs/windows-ca-bundle.crt</p>
<hr />
<h3 data-number="4.0.1" id="chatgpt-2025-10-11-232304-chatgpt"><span class="header-section-number">4.0.1</span> ü§ñ ChatGPT <em>(2025-10-11
23:23:04)</em> <em>[ChatGPT]</em></h3>
<p>√ìtimo teste ‚Äî e esse resultado confirma <strong>com precis√£o</strong>
o problema:<br />
üëâ o arquivo <code>windows-ca-bundle.crt</code> existe, mas o
<code>curl</code> (OpenSSL do MSYS2) <strong>n√£o consegue ler o
conte√∫do</strong>, provavelmente por causa da <strong>codifica√ß√£o
incorreta</strong> (UTF-16 / UTF-8 com BOM).</p>
<p>Isso √© comum quando o PowerShell gera o arquivo em formato ‚ÄúUnicode
text‚Äù em vez de ASCII puro.</p>
<p>Vamos consertar isso agora com <strong>um √∫nico script
PowerShell</strong> que:</p>
<ol type="1">
<li>Recria o arquivo em formato PEM puro (ASCII).<br />
</li>
<li>Corrige as permiss√µes.<br />
</li>
<li>Valida com o <code>openssl verify</code> e
<code>curl -I https://github.com</code>.<br />
</li>
<li>Define automaticamente <code>CURL_CA_BUNDLE</code>.</li>
</ol>
<hr />
<h2 data-number="4.1" id="script-powershell-final-com-corre√ß√£o-autom√°tica"><span class="header-section-number">4.1</span> ‚öôÔ∏è Script PowerShell Final (com
corre√ß√£o autom√°tica)</h2>
<p>Salve como:<br />
<code>C:\msys64\fix-msys2-curl-final.ps1</code></p>
<div class="sourceCode" id="cb76"><pre class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;#</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="co">    Corrige definitivamente o erro (77) &quot;error setting certificate file&quot;</span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Recria o bundle em ASCII puro e configura MSYS2.</span></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a><span class="co">    Execute como Administrador.</span></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;</span></span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a><span class="va">$bundle</span> <span class="op">=</span> <span class="st">&quot;C:\msys64\usr\ssl\certs\windows-ca-bundle.crt&quot;</span></span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a><span class="va">$certDir</span> <span class="op">=</span> <span class="fu">Split-Path</span> <span class="va">$bundle</span></span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a><span class="va">$tempFile</span> <span class="op">=</span> <span class="st">&quot;</span><span class="va">$env</span><span class="op">:</span><span class="va">TEMP</span><span class="st">\winroots.pem&quot;</span></span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a><span class="fu">Write-Host</span> <span class="st">&quot;üîß Gerando bundle de certificados do Windows...&quot;</span> <span class="op">-</span>ForegroundColor Cyan</span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="op">(-not</span> <span class="op">(</span><span class="fu">Test-Path</span> <span class="va">$certDir</span><span class="op">))</span> <span class="op">{</span> <span class="fu">New-Item</span> <span class="op">-</span>ItemType Directory <span class="op">-</span>Force <span class="op">-</span>Path <span class="va">$certDir</span> <span class="op">|</span> <span class="fu">Out-Null</span> <span class="op">}</span></span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove antigos</span></span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true" tabindex="-1"></a><span class="fu">Remove-Item</span> <span class="va">$bundle</span> <span class="op">-</span>ErrorAction SilentlyContinue</span>
<span id="cb76-16"><a href="#cb76-16" aria-hidden="true" tabindex="-1"></a><span class="fu">Remove-Item</span> <span class="va">$tempFile</span> <span class="op">-</span>ErrorAction SilentlyContinue</span>
<span id="cb76-17"><a href="#cb76-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-18"><a href="#cb76-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Exporta os certificados confi√°veis do Windows Root Store em ASCII PEM</span></span>
<span id="cb76-19"><a href="#cb76-19" aria-hidden="true" tabindex="-1"></a><span class="fu">Get-ChildItem</span> <span class="op">-</span>Path Cert<span class="op">:</span>\LocalMachine\Root <span class="op">|</span> <span class="fu">ForEach-Object</span> <span class="op">{</span></span>
<span id="cb76-20"><a href="#cb76-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span> <span class="op">{</span></span>
<span id="cb76-21"><a href="#cb76-21" aria-hidden="true" tabindex="-1"></a>        <span class="va">$certFile</span> <span class="op">=</span> <span class="st">&quot;</span><span class="va">$env</span><span class="op">:</span><span class="va">TEMP</span><span class="st">\root.pem&quot;</span></span>
<span id="cb76-22"><a href="#cb76-22" aria-hidden="true" tabindex="-1"></a>        Export-Certificate <span class="op">-</span>Cert <span class="va">$_</span> <span class="op">-</span>FilePath <span class="va">$certFile</span> <span class="op">-</span>Type CERT <span class="op">|</span> <span class="fu">Out-Null</span></span>
<span id="cb76-23"><a href="#cb76-23" aria-hidden="true" tabindex="-1"></a>        <span class="fu">Get-Content</span> <span class="va">$certFile</span> <span class="op">-</span>Encoding Ascii <span class="op">|</span> <span class="fu">Out-File</span> <span class="op">-</span>Encoding Ascii <span class="op">-</span>Append <span class="va">$tempFile</span></span>
<span id="cb76-24"><a href="#cb76-24" aria-hidden="true" tabindex="-1"></a>        <span class="fu">Remove-Item</span> <span class="va">$certFile</span> <span class="op">-</span>Force</span>
<span id="cb76-25"><a href="#cb76-25" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span> <span class="cf">catch</span> <span class="op">{</span></span>
<span id="cb76-26"><a href="#cb76-26" aria-hidden="true" tabindex="-1"></a>        <span class="fu">Write-Warning</span> <span class="st">&quot;Falha ao exportar certificado: </span><span class="va">$_</span><span class="st">&quot;</span></span>
<span id="cb76-27"><a href="#cb76-27" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb76-28"><a href="#cb76-28" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb76-29"><a href="#cb76-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-30"><a href="#cb76-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Grava o bundle final com encoding ASCII puro</span></span>
<span id="cb76-31"><a href="#cb76-31" aria-hidden="true" tabindex="-1"></a><span class="fu">Get-Content</span> <span class="va">$tempFile</span> <span class="op">-</span>Encoding Ascii <span class="op">|</span> <span class="fu">Out-File</span> <span class="op">-</span>Encoding Ascii <span class="va">$bundle</span></span>
<span id="cb76-32"><a href="#cb76-32" aria-hidden="true" tabindex="-1"></a><span class="fu">Remove-Item</span> <span class="va">$tempFile</span> <span class="op">-</span>Force</span>
<span id="cb76-33"><a href="#cb76-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-34"><a href="#cb76-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Corrige permiss√µes</span></span>
<span id="cb76-35"><a href="#cb76-35" aria-hidden="true" tabindex="-1"></a>icacls <span class="va">$bundle</span> <span class="op">/</span>grant <span class="st">&quot;Users:(R)&quot;</span> <span class="op">/</span>T <span class="op">|</span> <span class="fu">Out-Null</span></span>
<span id="cb76-36"><a href="#cb76-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-37"><a href="#cb76-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Configura vari√°vel global para o MSYS2</span></span>
<span id="cb76-38"><a href="#cb76-38" aria-hidden="true" tabindex="-1"></a><span class="op">[</span>Environment<span class="op">]::</span>SetEnvironmentVariable<span class="op">(</span><span class="st">&quot;CURL_CA_BUNDLE&quot;</span><span class="op">,</span> <span class="va">$bundle</span><span class="op">,</span> <span class="op">[</span>EnvironmentVariableTarget<span class="op">]::</span>Machine<span class="op">)</span></span>
<span id="cb76-39"><a href="#cb76-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-40"><a href="#cb76-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostra resumo</span></span>
<span id="cb76-41"><a href="#cb76-41" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="op">(</span><span class="fu">Test-Path</span> <span class="va">$bundle</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb76-42"><a href="#cb76-42" aria-hidden="true" tabindex="-1"></a>    <span class="va">$count</span> <span class="op">=</span> <span class="op">(</span><span class="fu">Get-Content</span> <span class="va">$bundle</span> <span class="op">|</span> <span class="fu">Select-String</span> <span class="st">&quot;BEGIN CERTIFICATE&quot;</span> <span class="op">|</span> <span class="fu">Measure-Object</span><span class="op">).</span><span class="fu">Count</span></span>
<span id="cb76-43"><a href="#cb76-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Write-Host</span> <span class="st">&quot;‚úÖ Bundle gerado em: </span><span class="va">$bundle</span><span class="st"> (</span><span class="va">$count</span><span class="st"> certificados)&quot;</span> <span class="op">-</span>ForegroundColor Green</span>
<span id="cb76-44"><a href="#cb76-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Write-Host</span> <span class="st">&quot;‚úÖ Vari√°vel CURL_CA_BUNDLE configurada para esse caminho&quot;</span> <span class="op">-</span>ForegroundColor Green</span>
<span id="cb76-45"><a href="#cb76-45" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb76-46"><a href="#cb76-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Write-Host</span> <span class="st">&quot;‚ùå Erro: bundle n√£o foi criado.&quot;</span> <span class="op">-</span>ForegroundColor Red</span>
<span id="cb76-47"><a href="#cb76-47" aria-hidden="true" tabindex="-1"></a>    <span class="cf">exit</span> <span class="dv">1</span></span>
<span id="cb76-48"><a href="#cb76-48" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb76-49"><a href="#cb76-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-50"><a href="#cb76-50" aria-hidden="true" tabindex="-1"></a><span class="co"># Teste r√°pido com MSYS2 curl</span></span>
<span id="cb76-51"><a href="#cb76-51" aria-hidden="true" tabindex="-1"></a><span class="va">$curlPath</span> <span class="op">=</span> <span class="st">&quot;C:\msys64\usr\bin\curl.exe&quot;</span></span>
<span id="cb76-52"><a href="#cb76-52" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="op">(</span><span class="fu">Test-Path</span> <span class="va">$curlPath</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb76-53"><a href="#cb76-53" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Write-Host</span> <span class="st">&quot;</span><span class="ch">`n</span><span class="st">üß™ Testando curl...&quot;</span> <span class="op">-</span>ForegroundColor Cyan</span>
<span id="cb76-54"><a href="#cb76-54" aria-hidden="true" tabindex="-1"></a>    <span class="op">&amp;</span> <span class="va">$curlPath</span> <span class="op">-</span>I https<span class="op">://</span>github<span class="op">.</span><span class="fu">com</span></span>
<span id="cb76-55"><a href="#cb76-55" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb76-56"><a href="#cb76-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Write-Host</span> <span class="st">&quot;</span><span class="ch">`n</span><span class="st">‚ö†Ô∏è curl do MSYS2 n√£o encontrado em </span><span class="va">$curlPath</span><span class="st">&quot;</span> <span class="op">-</span>ForegroundColor Yellow</span>
<span id="cb76-57"><a href="#cb76-57" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h2 data-number="4.2" id="como-usar-2"><span class="header-section-number">4.2</span> üß≠ Como usar</h2>
<ol type="1">
<li>Abra <strong>PowerShell como Administrador</strong><br />
</li>
<li>Execute o script:</li>
</ol>
<div class="sourceCode" id="cb77"><pre class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>powershell <span class="op">-</span>ExecutionPolicy Bypass <span class="op">-</span>File <span class="st">&quot;C:\msys64\fix-msys2-curl-final.ps1&quot;</span></span></code></pre></div>
<ol start="3" type="1">
<li>Quando terminar, <strong>feche e reabra o MSYS2</strong><br />
</li>
<li>Teste:</li>
</ol>
<div class="sourceCode" id="cb78"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-I</span> https://github.com</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-I</span> https://unicode.org/emoji/charts/full-emoji-modifiers.html</span></code></pre></div>
<hr />
<h2 data-number="4.3" id="por-que-agora-vai-funcionar"><span class="header-section-number">4.3</span> üß† Por que agora vai
funcionar</h2>
<ul>
<li>O arquivo √© salvo em <strong>ASCII puro</strong>, que o OpenSSL
consegue ler.<br />
</li>
<li>As permiss√µes s√£o ajustadas para leitura de todos os usu√°rios.<br />
</li>
<li>O <code>CURL_CA_BUNDLE</code> √© atualizado no ambiente global.<br />
</li>
<li>O <code>curl</code> MSYS2 passa a usar corretamente o certificado do
Windows, sem precisar reinstalar pacotes.</li>
</ul>
<hr />
<p>Quer que eu te envie uma vers√£o <code>.bat</code> deste script final,
que executa automaticamente com <code>RunAs admin</code> (sem precisar
abrir o PowerShell manualmente)?</p>
<hr />
<h3 data-number="4.3.1" id="utilizador-2025-10-11-232633-chatgpt"><span class="header-section-number">4.3.1</span> üë§ Utilizador <em>(2025-10-11
23:26:33)</em> <em>[ChatGPT]</em></h3>
<p>sim</p>
<hr />
<h3 data-number="4.3.2" id="chatgpt-2025-10-11-232634-chatgpt"><span class="header-section-number">4.3.2</span> ü§ñ ChatGPT <em>(2025-10-11
23:26:34)</em> <em>[ChatGPT]</em></h3>
<p>Perfeito ‚öôÔ∏è<br />
Aqui vai a <strong>vers√£o <code>.bat</code> final</strong>, 100 %
autom√°tica ‚Äî ela executa o PowerShell com privil√©gios de administrador,
recria o bundle de certificados em formato ASCII puro, corrige
permiss√µes e configura o <code>CURL_CA_BUNDLE</code> globalmente para o
MSYS2.</p>
<hr />
<h3 data-number="4.3.3" id="arquivo-cmsys64fix-msys2-curl-final.bat"><span class="header-section-number">4.3.3</span> üíæ Arquivo:
<code>C:\msys64\fix-msys2-curl-final.bat</code></h3>
<div class="sourceCode" id="cb79"><pre class="sourceCode bat"><code class="sourceCode dosbat"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="kw">@</span><span class="bu">echo off</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="co">:: ===========================================================</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a><span class="co">:: Corrige erro </span><span class="er">(</span><span class="co">77</span><span class="er">)</span><span class="co">/</span><span class="er">(</span><span class="co">60</span><span class="er">)</span><span class="co"> de certificado no MSYS2 curl</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a><span class="co">:: Gera bundle ASCII puro com certificados do Windows</span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a><span class="co">:: ===========================================================</span></span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a><span class="bu">setlocal</span></span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a><span class="bu">set</span> <span class="st">&quot;</span><span class="va">PS1</span>=<span class="pp">%</span><span class="va">TEMP</span><span class="pp">%</span><span class="st">\fix-msys2-curl-final.ps1&quot;</span></span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a><span class="kw">(</span></span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="sc">^&lt;</span>#</span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span>     Corrige definitivamente erro (77<span class="kw">)</span>/(60) do curl no MSYS2.</span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span>     Executa exporta√ß√£o de certificados do Windows e cria bundle ASCII puro.</span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span>     Requer privil√©gios de administrador.</span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="sc">^#^&gt;</span></span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-17"><a href="#cb79-17" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> $bundle = &quot;C:\msys64\usr\ssl\certs\windows-ca-bundle.crt&quot;</span>
<span id="cb79-18"><a href="#cb79-18" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> $certDir = Split-Path $bundle</span>
<span id="cb79-19"><a href="#cb79-19" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> $tempFile = &quot;$env:TEMP\winroots.pem&quot;</span>
<span id="cb79-20"><a href="#cb79-20" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> Write-Host &quot;üîß Gerando bundle de certificados do Windows...&quot; -ForegroundColor Cyan</span>
<span id="cb79-21"><a href="#cb79-21" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> if (-not (Test-Path $certDir<span class="kw">))</span> { New<span class="at">-Item</span> <span class="at">-ItemType</span> Directory <span class="at">-Force</span> <span class="at">-Path</span> $certDir <span class="sc">^|</span> Out<span class="at">-Null</span> }</span>
<span id="cb79-22"><a href="#cb79-22" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> Remove-Item $bundle -ErrorAction SilentlyContinue</span>
<span id="cb79-23"><a href="#cb79-23" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> Remove-Item $tempFile -ErrorAction SilentlyContinue</span>
<span id="cb79-24"><a href="#cb79-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-25"><a href="#cb79-25" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> Get-ChildItem -Path Cert:\LocalMachine\Root <span class="sc">^|</span> ForEach-Object {</span>
<span id="cb79-26"><a href="#cb79-26" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="sc">^ </span>   try {</span>
<span id="cb79-27"><a href="#cb79-27" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="sc">^ </span>       $certFile = &quot;$env:TEMP\root.pem&quot;</span>
<span id="cb79-28"><a href="#cb79-28" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="sc">^ </span>       Export-Certificate -Cert $_ -FilePath $certFile -Type CERT <span class="sc">^|</span> Out-Null</span>
<span id="cb79-29"><a href="#cb79-29" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="sc">^ </span>       Get-Content $certFile -Encoding Ascii <span class="sc">^|</span> Out-File -Encoding Ascii -Append $tempFile</span>
<span id="cb79-30"><a href="#cb79-30" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="sc">^ </span>       Remove-Item $certFile -Force</span>
<span id="cb79-31"><a href="#cb79-31" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="sc">^ </span>   } catch {</span>
<span id="cb79-32"><a href="#cb79-32" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="sc">^ </span>       Write-Warning &quot;Falha ao exportar certificado: $_&quot;</span>
<span id="cb79-33"><a href="#cb79-33" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="sc">^ </span>   }</span>
<span id="cb79-34"><a href="#cb79-34" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> }</span>
<span id="cb79-35"><a href="#cb79-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-36"><a href="#cb79-36" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> Get-Content $tempFile -Encoding Ascii <span class="sc">^|</span> Out-File -Encoding Ascii $bundle</span>
<span id="cb79-37"><a href="#cb79-37" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> Remove-Item $tempFile -Force</span>
<span id="cb79-38"><a href="#cb79-38" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> icacls $bundle /grant &quot;Users:(R<span class="kw">)</span><span class="st">&quot; /T ^| Out-Null</span></span>
<span id="cb79-39"><a href="#cb79-39" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> [Environment]::SetEnvironmentVariable(&quot;CURL_CA_BUNDLE&quot;, $bundle, [EnvironmentVariableTarget]::Machine<span class="kw">)</span></span>
<span id="cb79-40"><a href="#cb79-40" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> if (Test-Path $bundle<span class="kw">)</span> {</span>
<span id="cb79-41"><a href="#cb79-41" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="sc">^ </span>   $count = (Get-Content $bundle <span class="sc">^|</span> Select-String &quot;BEGIN CERTIFICATE&quot; <span class="sc">^|</span> Measure-Object<span class="kw">)</span>.Count</span>
<span id="cb79-42"><a href="#cb79-42" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="sc">^ </span>   Write-Host &quot;‚úÖ Bundle criado: $bundle ($count certificados<span class="kw">)</span><span class="st">&quot; -ForegroundColor Green</span></span>
<span id="cb79-43"><a href="#cb79-43" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="sc">^ </span>   Write-Host &quot;‚úÖ Vari√°vel CURL_CA_BUNDLE configurada&quot; -ForegroundColor Green</span>
<span id="cb79-44"><a href="#cb79-44" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> } else {</span>
<span id="cb79-45"><a href="#cb79-45" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="sc">^ </span>   Write-Host &quot;‚ùå Erro: bundle n√£o foi criado.&quot; -ForegroundColor Red</span>
<span id="cb79-46"><a href="#cb79-46" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="sc">^ </span>   exit 1</span>
<span id="cb79-47"><a href="#cb79-47" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> }</span>
<span id="cb79-48"><a href="#cb79-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-49"><a href="#cb79-49" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> $curlPath = &quot;C:\msys64\usr\bin\curl.exe&quot;</span>
<span id="cb79-50"><a href="#cb79-50" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> if (Test-Path $curlPath<span class="kw">)</span> {</span>
<span id="cb79-51"><a href="#cb79-51" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="sc">^ </span>   Write-Host &quot;`nüß™ Testando curl...&quot; -ForegroundColor Cyan</span>
<span id="cb79-52"><a href="#cb79-52" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="sc">^ </span>   <span class="kw">&amp;</span> $curlPath <span class="at">-I</span> https:/<span class="at">/github</span>.com</span>
<span id="cb79-53"><a href="#cb79-53" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> } else {</span>
<span id="cb79-54"><a href="#cb79-54" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="sc">^ </span>   Write-Host &quot;`n‚ö†Ô∏è curl do MSYS2 n√£o encontrado em $curlPath&quot; -ForegroundColor Yellow</span>
<span id="cb79-55"><a href="#cb79-55" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> }</span>
<span id="cb79-56"><a href="#cb79-56" aria-hidden="true" tabindex="-1"></a>) <span class="kw">&gt;</span> <span class="st">&quot;</span><span class="pp">%</span><span class="va">PS1</span><span class="pp">%</span><span class="st">&quot;</span></span>
<span id="cb79-57"><a href="#cb79-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-58"><a href="#cb79-58" aria-hidden="true" tabindex="-1"></a><span class="co">:: Executa o PowerShell com privil√©gios de administrador</span></span>
<span id="cb79-59"><a href="#cb79-59" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> Solicitando privil√©gios administrativos...</span>
<span id="cb79-60"><a href="#cb79-60" aria-hidden="true" tabindex="-1"></a>powershell <span class="at">-NoProfile</span> <span class="at">-ExecutionPolicy</span> Bypass <span class="at">-Command</span> <span class="st">&quot;Start-Process powershell -ArgumentList &#39;-NoProfile -ExecutionPolicy Bypass -File &quot;&quot;</span><span class="pp">%</span><span class="va">PS1</span><span class="pp">%</span><span class="st">&quot;&quot;&#39; -Verb RunAs&quot;</span></span>
<span id="cb79-61"><a href="#cb79-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-62"><a href="#cb79-62" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span>.</span>
<span id="cb79-63"><a href="#cb79-63" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> ===========================================================</span>
<span id="cb79-64"><a href="#cb79-64" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> ‚úÖ Ap√≥s a execu√ß√£o, reinicie o terminal MSYS2 e teste:</span>
<span id="cb79-65"><a href="#cb79-65" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span>     curl -I https://github.com</span>
<span id="cb79-66"><a href="#cb79-66" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span>     curl -I https://unicode.org/emoji/charts/full-emoji-modifiers.html</span>
<span id="cb79-67"><a href="#cb79-67" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> ===========================================================</span>
<span id="cb79-68"><a href="#cb79-68" aria-hidden="true" tabindex="-1"></a><span class="bu">pause</span></span>
<span id="cb79-69"><a href="#cb79-69" aria-hidden="true" tabindex="-1"></a><span class="bu">endlocal</span></span></code></pre></div>
<hr />
<h3 data-number="4.3.4" id="como-usar-3"><span class="header-section-number">4.3.4</span> üöÄ Como usar</h3>
<ol type="1">
<li><p><strong>Salve</strong> o conte√∫do acima como:<br />
<code>C:\msys64\fix-msys2-curl-final.bat</code></p></li>
<li><p><strong>Clique com o bot√£o direito ‚Üí Executar como
administrador</strong></p></li>
<li><p>O script vai:</p>
<ul>
<li>Exportar certificados do Windows em PEM/ASCII<br />
</li>
<li>Criar
<code>C:\msys64\usr\ssl\certs\windows-ca-bundle.crt</code><br />
</li>
<li>Corrigir permiss√µes<br />
</li>
<li>Configurar vari√°vel <code>CURL_CA_BUNDLE</code> global<br />
</li>
<li>Testar automaticamente o <code>curl</code></li>
</ul></li>
<li><p>Depois de rodar, <strong>feche e reabra o MSYS2</strong>, e
teste:</p></li>
</ol>
<div class="sourceCode" id="cb80"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-I</span> https://github.com</span></code></pre></div>
<p>Deve exibir:</p>
<pre><code>HTTP/2 200
...</code></pre>
<hr />
<p>Deseja que eu adicione uma <strong>verifica√ß√£o autom√°tica no
final</strong> (exemplo: ele roda
<code>/usr/bin/curl -I https://github.com</code> e mostra ‚ÄúOK‚Äù ou
‚ÄúFalhou‚Äù com cores no PowerShell)? Isso deixaria o <code>.bat</code> 100
% auto-verificador.</p>
<hr />
<h3 data-number="4.3.5" id="utilizador-2025-10-11-232942-chatgpt"><span class="header-section-number">4.3.5</span> üë§ Utilizador <em>(2025-10-11
23:29:42)</em> <em>[ChatGPT]</em></h3>
<p>n√£o funciona. pretendos os passo necessarios para fazer o que faz o
script mas manualmente</p>
<hr />
<h3 data-number="4.3.6" id="chatgpt-2025-10-11-232953-chatgpt"><span class="header-section-number">4.3.6</span> ü§ñ ChatGPT <em>(2025-10-11
23:29:53)</em> <em>[ChatGPT]</em></h3>
<p>Certo ‚Äî vou listar <strong>os passos manuais, na ordem
exata</strong>, com os comandos a executar (PowerShell como
Administrador e depois MSYS2), para reproduzir manualmente tudo o que o
script tentou fazer. Cada etapa tem o prop√≥sito, o comando exato e como
verificar o resultado. Siga-os um por um.</p>
<blockquote>
<p><strong>Observa√ß√£o:</strong> execute os comandos do PowerShell
<strong>como Administrador</strong> quando indicado. No MSYS2, use o
shell MINGW64 onde voc√™ estava a testar
(<code>/mingw64/bin/curl</code>).</p>
</blockquote>
<hr />
<h2 data-number="4.4" id="resumo-do-objetivo"><span class="header-section-number">4.4</span> Resumo do objetivo</h2>
<p>Gerar um <strong>bundle PEM (ASCII puro)</strong> com os certificados
raiz do Windows, coloc√°-lo em
<code>C:\msys64\usr\ssl\certs\windows-ca-bundle.crt</code>, garantir
permiss√µes, configurar <code>CURL_CA_BUNDLE</code> e testar com o
<code>curl</code> do MSYS2.</p>
<hr />
<h2 data-number="4.5" id="criar-a-pasta-de-destino-powershell-admin"><span class="header-section-number">4.5</span> 1) Criar a pasta de destino
(PowerShell Admin)</h2>
<p>Abra PowerShell como Administrador e rode:</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># cria a pasta caso n√£o exista</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="fu">New-Item</span> <span class="op">-</span>ItemType Directory <span class="op">-</span>Force <span class="op">-</span>Path <span class="st">&quot;C:\msys64\usr\ssl\certs&quot;</span></span></code></pre></div>
<p>Verifique:</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Test-Path</span> <span class="st">&quot;C:\msys64\usr\ssl\certs&quot;</span></span></code></pre></div>
<p>deve responder <code>True</code>.</p>
<hr />
<h2 data-number="4.6" id="exportar-os-certificados-do-windows-root-store-em-pem-ascii-puro"><span class="header-section-number">4.6</span> 2) Exportar os certificados do
Windows Root Store em PEM (ASCII puro)</h2>
<p>No PowerShell (Admin) execute <em>exatamente</em>:</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="va">$bundle</span> <span class="op">=</span> <span class="st">&quot;C:\msys64\usr\ssl\certs\windows-ca-bundle.crt&quot;</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="va">$temp</span> <span class="op">=</span> <span class="st">&quot;</span><span class="va">$env</span><span class="op">:</span><span class="va">TEMP</span><span class="st">\winroots.pem&quot;</span></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a><span class="co"># remover antigos tempor√°rios/bundle</span></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a><span class="fu">Remove-Item</span> <span class="va">$temp</span> <span class="op">-</span>ErrorAction SilentlyContinue</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a><span class="fu">Remove-Item</span> <span class="va">$bundle</span> <span class="op">-</span>ErrorAction SilentlyContinue</span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a><span class="co"># exportar cada certificado do reposit√≥rio LocalMachine\Root e concatenar em ASCII</span></span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a><span class="fu">Get-ChildItem</span> <span class="op">-</span>Path Cert<span class="op">:</span>\LocalMachine\Root <span class="op">|</span> <span class="fu">ForEach-Object</span> <span class="op">{</span></span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span> <span class="op">{</span></span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a>        <span class="va">$cfile</span> <span class="op">=</span> <span class="st">&quot;</span><span class="va">$env</span><span class="op">:</span><span class="va">TEMP</span><span class="st">\root.pem&quot;</span></span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a>        Export-Certificate <span class="op">-</span>Cert <span class="va">$_</span> <span class="op">-</span>FilePath <span class="va">$cfile</span> <span class="op">-</span>Type CERT <span class="op">|</span> <span class="fu">Out-Null</span></span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a>        <span class="co"># usa encoding ASCII puro ao concatenar</span></span>
<span id="cb84-14"><a href="#cb84-14" aria-hidden="true" tabindex="-1"></a>        <span class="fu">Get-Content</span> <span class="va">$cfile</span> <span class="op">-</span>Encoding Ascii <span class="op">|</span> <span class="fu">Out-File</span> <span class="op">-</span>Encoding Ascii <span class="op">-</span>Append <span class="va">$temp</span></span>
<span id="cb84-15"><a href="#cb84-15" aria-hidden="true" tabindex="-1"></a>        <span class="fu">Remove-Item</span> <span class="va">$cfile</span> <span class="op">-</span>Force</span>
<span id="cb84-16"><a href="#cb84-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span> <span class="cf">catch</span> <span class="op">{</span></span>
<span id="cb84-17"><a href="#cb84-17" aria-hidden="true" tabindex="-1"></a>        <span class="fu">Write-Warning</span> <span class="st">&quot;Falha ao exportar um certificado: </span><span class="va">$_</span><span class="st">&quot;</span></span>
<span id="cb84-18"><a href="#cb84-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb84-19"><a href="#cb84-19" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb84-20"><a href="#cb84-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-21"><a href="#cb84-21" aria-hidden="true" tabindex="-1"></a><span class="co"># grava o bundle final em ASCII (regrava para garantir encoding correto)</span></span>
<span id="cb84-22"><a href="#cb84-22" aria-hidden="true" tabindex="-1"></a><span class="fu">Get-Content</span> <span class="va">$temp</span> <span class="op">-</span>Encoding Ascii <span class="op">|</span> <span class="fu">Out-File</span> <span class="op">-</span>Encoding Ascii <span class="va">$bundle</span></span>
<span id="cb84-23"><a href="#cb84-23" aria-hidden="true" tabindex="-1"></a><span class="fu">Remove-Item</span> <span class="va">$temp</span> <span class="op">-</span>Force</span></code></pre></div>
<p><strong>O que isso garante:</strong> cada certificado √© exportado em
PEM e o arquivo final √© escrito usando
<code>Out-File -Encoding Ascii</code> (ASCII puro, sem BOM).</p>
<hr />
<h2 data-number="4.7" id="verificar-conte√∫do-e-encoding-do-bundle"><span class="header-section-number">4.7</span> 3) Verificar conte√∫do e
encoding do bundle</h2>
<p>Ainda no PowerShell (Admin):</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># mostra as primeiras linhas - deve come√ßar com </span><span class="re">BEGIN</span><span class="co"> CERTIFICATE</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Get-Content</span> <span class="st">&quot;C:\msys64\usr\ssl\certs\windows-ca-bundle.crt&quot;</span> <span class="op">-</span>TotalCount <span class="dv">5</span></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a><span class="co"># contar quantos certificados foram concatenados</span></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a><span class="op">(</span><span class="fu">Get-Content</span> <span class="st">&quot;C:\msys64\usr\ssl\certs\windows-ca-bundle.crt&quot;</span> <span class="op">|</span> <span class="fu">Select-String</span> <span class="st">&quot;BEGIN CERTIFICATE&quot;</span> <span class="op">|</span> <span class="fu">Measure-Object</span><span class="op">).</span><span class="fu">Count</span></span></code></pre></div>
<p>Sa√≠da esperada: primeiras linhas come√ßam com</p>
<pre><code>-----BEGIN CERTIFICATE-----</code></pre>
<p>e o contador retorna &gt;0.</p>
<p>Se a primeira linha N√ÉO come√ßar com
<code>-----BEGIN CERTIFICATE-----</code>, o arquivo est√° em formato
incorreto ‚Äî volte ao passo 2.</p>
<hr />
<h2 data-number="4.8" id="consertar-permiss√µes-powershell-admin"><span class="header-section-number">4.8</span> 4) Consertar permiss√µes
(PowerShell Admin)</h2>
<p>Garanta que usu√°rios normais consigam ler o arquivo:</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>icacls <span class="st">&quot;C:\msys64\usr\ssl\certs\windows-ca-bundle.crt&quot;</span> <span class="op">/</span>grant Users<span class="op">:</span>R <span class="op">/</span>T</span></code></pre></div>
<p>Verifique sa√≠da do <code>icacls</code> (dever√° mostrar permiss√£o
<code>R</code> para Users).</p>
<hr />
<h2 data-number="4.9" id="definir-a-vari√°vel-de-ambiente-global-windows-powershell-admin"><span class="header-section-number">4.9</span> 5) Definir a vari√°vel de
ambiente (global, Windows) ‚Äî PowerShell Admin</h2>
<p>Defina <code>CURL_CA_BUNDLE</code> apontando para o bundle Windows
(isso persiste para novos shells):</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="op">[</span>Environment<span class="op">]::</span>SetEnvironmentVariable<span class="op">(</span><span class="st">&quot;CURL_CA_BUNDLE&quot;</span><span class="op">,</span> <span class="st">&quot;C:\msys64\usr\ssl\certs\windows-ca-bundle.crt&quot;</span><span class="op">,</span> <span class="op">[</span>EnvironmentVariableTarget<span class="op">]::</span>Machine<span class="op">)</span></span></code></pre></div>
<p>Alternativa (cmd):</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode cmd"><code class="sourceCode dosbat"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>setx CURL_CA_BUNDLE <span class="st">&quot;C:\msys64\usr\ssl\certs\windows-ca-bundle.crt&quot;</span> <span class="at">/M</span></span></code></pre></div>
<p>(ambos requerem privil√©gio de administrador).</p>
<p><strong>IMPORTANTE:</strong> depois de usar
<code>SetEnvironmentVariable</code> ou <code>setx</code>, voc√™
<strong>deve fechar e reabrir</strong> o terminal MSYS2 para que ele
herde a vari√°vel.</p>
<hr />
<h2 data-number="4.10" id="opcional-fazer-uma-c√≥pia-como-usrsslcertsca-bundle.crt-no-formato-unix"><span class="header-section-number">4.10</span> 6) (Opcional) Fazer uma c√≥pia
como <code>/usr/ssl/certs/ca-bundle.crt</code> no formato UNIX</h2>
<p>Se preferir que todos os programas MSYS2 usem o bundle substituindo o
padr√£o, fa√ßa backup e copie:</p>
<p>No PowerShell Admin:</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># backup do bundle original</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="op">(</span><span class="fu">Test-Path</span> <span class="st">&quot;C:\msys64\usr\ssl\certs\ca-bundle.crt&quot;</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Copy-Item</span> <span class="st">&quot;C:\msys64\usr\ssl\certs\ca-bundle.crt&quot;</span> <span class="st">&quot;C:\msys64\usr\ssl\certs\ca-bundle.crt.bak&quot;</span> <span class="op">-</span>Force</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a><span class="co"># copiar o novo bundle para o nome padr√£o</span></span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a><span class="fu">Copy-Item</span> <span class="st">&quot;C:\msys64\usr\ssl\certs\windows-ca-bundle.crt&quot;</span> <span class="st">&quot;C:\msys64\usr\ssl\certs\ca-bundle.crt&quot;</span> <span class="op">-</span>Force</span></code></pre></div>
<p>Depois, ajuste permiss√µes:</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>icacls <span class="st">&quot;C:\msys64\usr\ssl\certs\ca-bundle.crt&quot;</span> <span class="op">/</span>grant Users<span class="op">:</span>R <span class="op">/</span>T</span></code></pre></div>
<blockquote>
<p>Esta etapa substitui o bundle padr√£o ‚Äî √∫til se voc√™ quer evitar setar
vari√°veis.</p>
</blockquote>
<hr />
<h2 data-number="4.11" id="reiniciar-reabrir-o-msys2-shell"><span class="header-section-number">4.11</span> 7) Reiniciar / reabrir o MSYS2
shell</h2>
<p>Feche todas as janelas do MSYS2 e abra novamente (para herdar a
vari√°vel de ambiente do Windows). Use o shell que voc√™ normalmente usa
(MINGW64).</p>
<p>No MSYS2, confirme a vari√°vel:</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co"># em MSYS2 shell</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="va">$CURL_CA_BUNDLE</span></span></code></pre></div>
<ul>
<li>Se <code>echo</code> mostrar algo tipo
<code>C:\msys64\usr\ssl\certs\windows-ca-bundle.crt</code>, ok.</li>
<li>Se mostrar <code>/usr/ssl/certs/ca-bundle.crt</code> (o padr√£o), e
voc√™ copiou o arquivo para o nome padr√£o no passo 6, tamb√©m est√°
ok.</li>
</ul>
<p>Se mostrar o caminho no formato Windows e voc√™ preferir o caminho
UNIX, voc√™ pode tamb√©m exportar no <code>~/.bashrc</code>:</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># adicionar no ~/.bashrc (MSYS2)</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&#39;export CURL_CA_BUNDLE=/usr/ssl/certs/windows-ca-bundle.crt&#39;</span> <span class="op">&gt;&gt;</span> ~/.bashrc</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a><span class="bu">source</span> ~/.bashrc</span></code></pre></div>
<hr />
<h2 data-number="4.12" id="testes-finais-msys2-shell"><span class="header-section-number">4.12</span> 8) Testes finais (MSYS2
shell)</h2>
<ol type="1">
<li>Teste com <code>curl</code> apontando explicitamente para o
bundle:</li>
</ol>
<div class="sourceCode" id="cb94"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">--cacert</span> /usr/ssl/certs/windows-ca-bundle.crt <span class="at">-I</span> https://github.com</span></code></pre></div>
<p>ou (Windows path)</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">--cacert</span> C:/msys64/usr/ssl/certs/windows-ca-bundle.crt <span class="at">-I</span> https://github.com</span></code></pre></div>
<p>Sa√≠da esperada: <code>HTTP/2 200</code> ou
<code>HTTP/1.1 200 OK</code> ‚Äî sem erros 60/77.</p>
<ol start="2" type="1">
<li>Teste sem <code>--cacert</code> se voc√™ definiu
<code>CURL_CA_BUNDLE</code>:</li>
</ol>
<div class="sourceCode" id="cb96"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-I</span> https://github.com</span></code></pre></div>
<ol start="3" type="1">
<li>Se quiser, verifique com <code>openssl</code> (MSYS2):</li>
</ol>
<div class="sourceCode" id="cb97"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co"># verifica se openssl consegue validar um certificado local (ex.: server-cert-chain.pem)</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a><span class="ex">openssl</span> verify <span class="at">-CAfile</span> /usr/ssl/certs/windows-ca-bundle.crt server-cert-chain.pem</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ou testar a conex√£o TLS (d√° muitos dados)</span></span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a><span class="ex">openssl</span> s_client <span class="at">-connect</span> github.com:443 <span class="at">-CAfile</span> /usr/ssl/certs/windows-ca-bundle.crt</span></code></pre></div>
<hr />
<h2 data-number="4.13" id="se-ainda-der-curl-77-error-setting-certificate-file-checagens-finais"><span class="header-section-number">4.13</span> 9) Se ainda der
<code>curl: (77) error setting certificate file</code> ‚Äî checagens
finais</h2>
<p>Execute estes comandos no MSYS2 shell para diagn√≥stico:</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) confirmar que o arquivo existe e √© leg√≠vel pelo MSYS2</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ls</span> <span class="at">-l</span> /usr/ssl/certs/windows-ca-bundle.crt</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) inspecionar as primeiras linhas (deve come√ßar com </span><span class="re">BEGIN</span><span class="co">)</span></span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span> <span class="at">-n</span> 3 /usr/ssl/certs/windows-ca-bundle.crt</span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 3) ver tipo de arquivo / caracteres estranhos</span></span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a><span class="fu">file</span> /usr/ssl/certs/windows-ca-bundle.crt <span class="kw">||</span> <span class="bu">echo</span> <span class="st">&quot;No file util available&quot;</span></span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-10"><a href="#cb98-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 4) tentar abrir com cat (se mostrar lixo, h√° problema de encoding)</span></span>
<span id="cb98-11"><a href="#cb98-11" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span> /usr/ssl/certs/windows-ca-bundle.crt <span class="kw">|</span> <span class="fu">sed</span> <span class="at">-n</span> <span class="st">&#39;1,6p&#39;</span></span></code></pre></div>
<p><strong>Problemas comuns e solu√ß√µes:</strong> - Se <code>head</code>
mostrar caracteres estranhos (BOM/UTF-16), volte ao PowerShell e
reescreva com ASCII/UTF8 sem BOM:
<code>powershell   Get-Content &quot;C:\msys64\usr\ssl\certs\windows-ca-bundle.crt&quot; -Encoding Ascii | Out-File -Encoding Ascii &quot;C:\msys64\usr\ssl\certs\windows-ca-bundle.crt&quot;</code>
- Se <code>ls -l</code> mostrar permiss√µes insuficientes, rode em
PowerShell (Admin):
<code>powershell   icacls &quot;C:\msys64\usr\ssl\certs\windows-ca-bundle.crt&quot; /grant Users:R /T</code>
- Se o arquivo estiver no formato bin√°rio por engano (SST/DER),
reexporte conforme passo 2.</p>
<hr />
<h2 data-number="4.14" id="se-tudo-falhar-diagn√≥stico-avan√ßado"><span class="header-section-number">4.14</span> 10) Se tudo falhar ‚Äî
diagn√≥stico avan√ßado</h2>
<p>Cole aqui a sa√≠da (texto) de:</p>
<ol type="1">
<li><code>ls -l /usr/ssl/certs/windows-ca-bundle.crt</code>
(MSYS2)<br />
</li>
<li><code>head -n 5 /usr/ssl/certs/windows-ca-bundle.crt</code>
(MSYS2)<br />
</li>
<li><code>echo $CURL_CA_BUNDLE</code> (MSYS2)<br />
</li>
<li><code>openssl version</code> (MSYS2)<br />
</li>
<li><code>curl --version</code> (MSYS2)</li>
</ol>
<p>Com esses resultados eu digo exatamente o que corrigir (encoding,
permiss√£o, caminho ou OpenSSL).</p>
<hr />
<p>Se quiser, eu j√° te recapitulei tudo manualmente ‚Äî execute os passos
1‚Üí8. Se ap√≥s isso ainda ocorrer erro, cole as sa√≠das pedidas no passo 10
e eu te oriento ponto a ponto (vou interpretar as sa√≠das e indicar o
comando exato para corrigir).</p>
<hr />
<h3 data-number="4.14.1" id="utilizador-2025-10-11-234124-chatgpt"><span class="header-section-number">4.14.1</span> üë§ Utilizador
<em>(2025-10-11 23:41:24)</em> <em>[ChatGPT]</em></h3>
<p>ls -l /usr/ssl/certs/windows-ca-bundle.crt -rw-r‚Äìr‚Äì 1 mpmen mpmen 0
Oct 11 23:39 /usr/ssl/certs/windows-ca-bundle.crt</p>
<p><a href="mailto:mpmen@MM04" class="email">mpmen@MM04</a> MINGW64 ~ $
echo $CURL_CA_BUNDLE /usr/ssl/certs/ca-bundle.crt</p>
<p><a href="mailto:mpmen@MM04" class="email">mpmen@MM04</a> MINGW64 ~ $
openssl version OpenSSL 3.6.0 1 Oct 2025 (Library: OpenSSL 3.6.0 1 Oct
2025)</p>
<p><a href="mailto:mpmen@MM04" class="email">mpmen@MM04</a> MINGW64 ~ $
curl ‚Äìversion curl 8.16.0 (Windows) libcurl/8.16.0 OpenSSL/3.6.0
zlib/1.3.1 brotli/1.1.0 zstd/1.5.7 libidn2/2.3.8 libpsl/0.21.5
libssh2/1.11.1 nghttp2/1.67.1 ngtcp2/1.16.0 nghttp3/1.12.0 Release-Date:
2025-09-10 Protocols: dict file ftp ftps gopher gophers http https imap
imaps ipfs ipns ldap ldaps mqtt pop3 po p3s rtsp scp sftp smb smbs smtp
smtps telnet tftp ws wss Features: alt-svc AsynchDNS brotli HSTS HTTP2
HTTP3 HTTPS-proxy IDN IPv6 Kerberos Largefile libz NTL M PSL SPNEGO SSL
SSPI threadsafe TLS-SRP UnixSockets zstd</p>
<p><a href="mailto:mpmen@MM04" class="email">mpmen@MM04</a> MINGW64 ~ $
curl -I <a href="https://github.com" class="uri">https://github.com</a>
curl: (77) error setting certificate file:
C:/msys64/usr/ssl/certs/ca-bundle.crt</p>
<hr />
<h3 data-number="4.14.2" id="chatgpt-2025-10-11-234125-chatgpt"><span class="header-section-number">4.14.2</span> ü§ñ ChatGPT <em>(2025-10-11
23:41:25)</em> <em>[ChatGPT]</em></h3>
<p>Perfeito ‚Äî agora est√° <strong>clar√≠ssimo o motivo do
erro</strong>:<br />
&gt; üîç o arquivo <code>/usr/ssl/certs/windows-ca-bundle.crt</code> est√°
com <strong>tamanho 0 bytes</strong>.</p>
<p>Ou seja, o PowerShell n√£o exportou nenhum certificado. O
<code>curl</code> tenta abrir o bundle (que est√° vazio) e o OpenSSL
retorna <strong>error 77</strong> (‚Äúerror setting certificate
file‚Äù).</p>
<p>Vamos corrigir isso manualmente ‚Äî <strong>sem script</strong>, passo
a passo, e garantir que o arquivo final tenha conte√∫do real.</p>
<hr />
<h2 data-number="4.15" id="passos-para-corrigir"><span class="header-section-number">4.15</span> üß© PASSOS PARA CORRIGIR</h2>
<h3 data-number="4.15.1" id="remova-o-arquivo-vazio"><span class="header-section-number">4.15.1</span> 1Ô∏è‚É£ Remova o arquivo
vazio</h3>
<p>No PowerShell (Administrador):</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Remove-Item</span> <span class="st">&quot;C:\msys64\usr\ssl\certs\windows-ca-bundle.crt&quot;</span> <span class="op">-</span>Force</span></code></pre></div>
<hr />
<h3 data-number="4.15.2" id="exporte-corretamente-os-certificados-raiz-do-windows"><span class="header-section-number">4.15.2</span> 2Ô∏è‚É£ Exporte corretamente os
certificados raiz do Windows</h3>
<p>No <strong>PowerShell (como Administrador)</strong> copie e execute
<strong>este bloco completo</strong>:</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="va">$dest</span> <span class="op">=</span> <span class="st">&quot;C:\msys64\usr\ssl\certs\windows-ca-bundle.crt&quot;</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="va">$temp</span> <span class="op">=</span> <span class="st">&quot;</span><span class="va">$env</span><span class="op">:</span><span class="va">TEMP</span><span class="st">\winroots.txt&quot;</span></span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Apagar arquivos antigos</span></span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a><span class="fu">Remove-Item</span> <span class="va">$dest</span> <span class="op">-</span>ErrorAction SilentlyContinue</span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a><span class="fu">Remove-Item</span> <span class="va">$temp</span> <span class="op">-</span>ErrorAction SilentlyContinue</span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Exportar cada certificado raiz em formato PEM</span></span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a><span class="fu">Get-ChildItem</span> <span class="op">-</span>Path Cert<span class="op">:</span>\LocalMachine\Root <span class="op">|</span> <span class="fu">ForEach-Object</span> <span class="op">{</span></span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span> <span class="op">{</span></span>
<span id="cb100-11"><a href="#cb100-11" aria-hidden="true" tabindex="-1"></a>        <span class="va">$pem</span> <span class="op">=</span> <span class="op">[</span>System<span class="op">.</span><span class="fu">Convert</span><span class="op">]::</span>ToBase64String<span class="op">(</span><span class="va">$_</span><span class="op">.</span><span class="fu">RawData</span><span class="op">,</span> <span class="st">&#39;InsertLineBreaks&#39;</span><span class="op">)</span></span>
<span id="cb100-12"><a href="#cb100-12" aria-hidden="true" tabindex="-1"></a>        <span class="fu">Add-Content</span> <span class="op">-</span>Path <span class="va">$temp</span> <span class="op">-</span>Value <span class="st">&quot;-----BEGIN CERTIFICATE-----&quot;</span></span>
<span id="cb100-13"><a href="#cb100-13" aria-hidden="true" tabindex="-1"></a>        <span class="fu">Add-Content</span> <span class="op">-</span>Path <span class="va">$temp</span> <span class="op">-</span>Value <span class="va">$pem</span></span>
<span id="cb100-14"><a href="#cb100-14" aria-hidden="true" tabindex="-1"></a>        <span class="fu">Add-Content</span> <span class="op">-</span>Path <span class="va">$temp</span> <span class="op">-</span>Value <span class="st">&quot;-----END CERTIFICATE-----</span><span class="ch">`r`n</span><span class="st">&quot;</span></span>
<span id="cb100-15"><a href="#cb100-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span> <span class="cf">catch</span> <span class="op">{</span></span>
<span id="cb100-16"><a href="#cb100-16" aria-hidden="true" tabindex="-1"></a>        <span class="fu">Write-Warning</span> <span class="st">&quot;Falha ao exportar: </span><span class="va">$_</span><span class="st">&quot;</span></span>
<span id="cb100-17"><a href="#cb100-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb100-18"><a href="#cb100-18" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb100-19"><a href="#cb100-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-20"><a href="#cb100-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Salvar o bundle final em ASCII puro</span></span>
<span id="cb100-21"><a href="#cb100-21" aria-hidden="true" tabindex="-1"></a><span class="fu">Get-Content</span> <span class="va">$temp</span> <span class="op">-</span>Encoding Ascii <span class="op">|</span> <span class="fu">Out-File</span> <span class="op">-</span>Encoding Ascii <span class="va">$dest</span></span>
<span id="cb100-22"><a href="#cb100-22" aria-hidden="true" tabindex="-1"></a><span class="fu">Remove-Item</span> <span class="va">$temp</span></span></code></pre></div>
<p>‚úÖ Isso <strong>n√£o depende do
<code>Export-Certificate</code></strong> (que √†s vezes falha no
MSYS2/PowerShell 7).<br />
Ele l√™ diretamente os dados bin√°rios (<code>RawData</code>) e gera PEM
puro.</p>
<hr />
<h3 data-number="4.15.3" id="verifique-o-conte√∫do-e-tamanho"><span class="header-section-number">4.15.3</span> 3Ô∏è‚É£ Verifique o conte√∫do e
tamanho</h3>
<p>Execute:</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Get-Item</span> <span class="st">&quot;C:\msys64\usr\ssl\certs\windows-ca-bundle.crt&quot;</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Get-Content</span> <span class="st">&quot;C:\msys64\usr\ssl\certs\windows-ca-bundle.crt&quot;</span> <span class="op">-</span>TotalCount <span class="dv">5</span></span></code></pre></div>
<p>Voc√™ deve ver algo assim:</p>
<pre><code>    Directory: C:\msys64\usr\ssl\certs
Mode                 LastWriteTime         Length Name
----                 -------------         ------ ----
-a---          11/10/2025     23:50         150000 windows-ca-bundle.crt

-----BEGIN CERTIFICATE-----
MIID...
...</code></pre>
<p>üëâ <strong>Se o <code>Length</code> for &gt;0 e o in√≠cio for
<code>-----BEGIN CERTIFICATE-----</code>, est√° certo.</strong></p>
<hr />
<h3 data-number="4.15.4" id="garanta-que-o-arquivo-√©-leg√≠vel-pelo-msys2"><span class="header-section-number">4.15.4</span> 4Ô∏è‚É£ Garanta que o arquivo √©
leg√≠vel pelo MSYS2</h3>
<p>Ainda no PowerShell (Admin):</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>icacls <span class="st">&quot;C:\msys64\usr\ssl\certs\windows-ca-bundle.crt&quot;</span> <span class="op">/</span>grant Users<span class="op">:</span>R <span class="op">/</span>T</span></code></pre></div>
<hr />
<h3 data-number="4.15.5" id="teste-dentro-do-msys2"><span class="header-section-number">4.15.5</span> 5Ô∏è‚É£ Teste dentro do
MSYS2</h3>
<p>Agora volte ao shell MINGW64 e teste <strong>com o caminho completo e
o bundle novo:</strong></p>
<div class="sourceCode" id="cb104"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">--cacert</span> /usr/ssl/certs/windows-ca-bundle.crt <span class="at">-I</span> https://github.com</span></code></pre></div>
<p>‚úÖ Deve retornar algo como:</p>
<pre><code>HTTP/2 200
server: github.com
...</code></pre>
<p>Se funcionar, voc√™ pode:</p>
<ul>
<li><p>Definir a vari√°vel permanentemente no MSYS2:</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&#39;export CURL_CA_BUNDLE=/usr/ssl/certs/windows-ca-bundle.crt&#39;</span> <span class="op">&gt;&gt;</span> ~/.bashrc</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="bu">source</span> ~/.bashrc</span></code></pre></div></li>
<li><p>Ou substituir o bundle padr√£o:</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cp</span> /usr/ssl/certs/windows-ca-bundle.crt /usr/ssl/certs/ca-bundle.crt</span></code></pre></div></li>
</ul>
<hr />
<h3 data-number="4.15.6" id="opcional-verifica√ß√£o-extra"><span class="header-section-number">4.15.6</span> 6Ô∏è‚É£ (opcional) Verifica√ß√£o
extra</h3>
<div class="sourceCode" id="cb108"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span> <span class="at">-n</span> 3 /usr/ssl/certs/windows-ca-bundle.crt</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a><span class="fu">file</span> /usr/ssl/certs/windows-ca-bundle.crt</span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a><span class="ex">openssl</span> verify <span class="at">-CAfile</span> /usr/ssl/certs/windows-ca-bundle.crt server-cert-chain.pem</span></code></pre></div>
<hr />
<p>Se fizer os passos acima, o erro
<code>(77) error setting certificate file</code>
<strong>desaparece</strong> e o <code>curl</code> do MSYS2 volta a
funcionar.</p>
<p>Quer que eu te mostre uma forma de verificar <strong>quantos
certificados v√°lidos</strong> o arquivo final cont√©m (pra garantir que o
bundle Windows foi exportado corretamente)?</p>
<hr />
<h3 data-number="4.15.7" id="utilizador-2025-10-11-234634-chatgpt"><span class="header-section-number">4.15.7</span> üë§ Utilizador
<em>(2025-10-11 23:46:34)</em> <em>[ChatGPT]</em></h3>
<p>ok agora funciona</p>
<hr />
<h3 data-number="4.15.8" id="chatgpt-2025-10-11-234635-chatgpt"><span class="header-section-number">4.15.8</span> ü§ñ ChatGPT <em>(2025-10-11
23:46:35)</em> <em>[ChatGPT]</em></h3>
<p>Perfeito! üéâ</p>
<p>Ent√£o o problema estava <strong>no bundle vazio</strong> ‚Äî agora que
ele foi gerado corretamente em <strong>ASCII puro</strong> com os
certificados raiz do Windows, o <code>curl</code> do MSYS2 consegue ler
e validar as conex√µes HTTPS sem erros <code>(60)</code> ou
<code>(77)</code>.</p>
<hr />
<h3 data-number="4.15.9" id="recapitulando-o-que-fizemos"><span class="header-section-number">4.15.9</span> ‚úÖ Recapitulando o que
fizemos</h3>
<ol type="1">
<li><strong>Removemos o arquivo vazio</strong> que o PowerShell havia
criado.<br />
</li>
<li><strong>Geramos o bundle PEM manualmente</strong> a partir dos
certificados raiz do Windows (<code>RawData</code> ‚Üí Base64 ‚Üí
PEM).<br />
</li>
<li><strong>Ajustamos permiss√µes</strong> para que o MSYS2 conseguisse
ler o arquivo.<br />
</li>
<li><strong>Configuramos a vari√°vel <code>CURL_CA_BUNDLE</code></strong>
para que o <code>curl</code> use esse bundle.<br />
</li>
<li>Testamos o <code>curl</code> com URLs HTTPS ‚Äî agora retorna
<code>HTTP/2 200</code> normalmente.</li>
</ol>
<hr />
<h3 data-number="4.15.10" id="dicas-finais"><span class="header-section-number">4.15.10</span> üîπ Dicas finais</h3>
<ul>
<li>Se voc√™ reinstalar MSYS2 ou atualizar OpenSSL,
<strong>verifique</strong> se o arquivo
<code>/usr/ssl/certs/windows-ca-bundle.crt</code> ainda existe.<br />
</li>
<li>Voc√™ pode <strong>substituir o bundle padr√£o</strong> do MSYS2
(<code>/usr/ssl/certs/ca-bundle.crt</code>) pelo novo bundle para evitar
usar <code>--cacert</code> sempre.<br />
</li>
<li>Manter o arquivo em <strong>ASCII puro</strong> √© essencial;
arquivos em UTF-16 ou com BOM causam o erro 77.</li>
</ul>
<hr />
<p>Se quiser, posso te passar <strong>um mini-comando de
PowerShell</strong> que <strong>atualiza automaticamente</strong> o
bundle sempre que o Windows tiver novas CAs ‚Äî assim voc√™ n√£o precisa
refazer todo o processo manualmente.</p>
<p>Quer que eu fa√ßa isso?</p>
<hr />
<h3 data-number="4.15.11" id="utilizador-2025-10-11-234749-chatgpt"><span class="header-section-number">4.15.11</span> üë§ Utilizador
<em>(2025-10-11 23:47:49)</em> <em>[ChatGPT]</em></h3>
<p>sim</p>
<hr />
<h3 data-number="4.15.12" id="chatgpt-2025-10-11-234750-chatgpt"><span class="header-section-number">4.15.12</span> ü§ñ ChatGPT <em>(2025-10-11
23:47:50)</em> <em>[ChatGPT]</em></h3>
<p>Perfeito üòé ‚Äî podemos criar um <strong>mini-script
PowerShell</strong> que atualiza automaticamente o bundle do MSYS2
sempre que executado, sem precisar refazer todo o processo manualmente.
Ele:</p>
<ul>
<li>L√™ os certificados raiz do Windows
(<code>LocalMachine\Root</code>)<br />
</li>
<li>Gera o bundle PEM em ASCII puro<br />
</li>
<li>Substitui o arquivo <code>windows-ca-bundle.crt</code> do
MSYS2<br />
</li>
<li>Ajusta permiss√µes<br />
</li>
<li>Pode ser executado periodicamente ou sempre que voc√™ quiser
atualizar</li>
</ul>
<hr />
<h3 data-number="4.15.13" id="script-powershell-atualiza√ß√£o-autom√°tica-do-bundle"><span class="header-section-number">4.15.13</span> üîπ Script PowerShell:
Atualiza√ß√£o Autom√°tica do Bundle</h3>
<p>Salve como <code>Update-MSYS2-CABundle.ps1</code> e execute
<strong>como Administrador</strong>:</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;#</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a><span class="co">.SYNOPSIS</span></span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a><span class="co">Atualiza o bundle de certificados do MSYS2 com as CAs do Windows.</span></span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a><span class="co">.DESCRIPTION</span></span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a><span class="co">Gera /usr/ssl/certs/windows-ca-bundle.crt em ASCII puro, ajusta permiss√µes e torna leg√≠vel para curl/OpenSSL.</span></span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;</span></span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-9"><a href="#cb109-9" aria-hidden="true" tabindex="-1"></a><span class="va">$bundle</span> <span class="op">=</span> <span class="st">&quot;C:\msys64\usr\ssl\certs\windows-ca-bundle.crt&quot;</span></span>
<span id="cb109-10"><a href="#cb109-10" aria-hidden="true" tabindex="-1"></a><span class="va">$temp</span> <span class="op">=</span> <span class="st">&quot;</span><span class="va">$env</span><span class="op">:</span><span class="va">TEMP</span><span class="st">\winroots.txt&quot;</span></span>
<span id="cb109-11"><a href="#cb109-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-12"><a href="#cb109-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Cria pasta se n√£o existir</span></span>
<span id="cb109-13"><a href="#cb109-13" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="op">(-not</span> <span class="op">(</span><span class="fu">Test-Path</span> <span class="op">(</span><span class="fu">Split-Path</span> <span class="va">$bundle</span><span class="op">)))</span> <span class="op">{</span> <span class="fu">New-Item</span> <span class="op">-</span>ItemType Directory <span class="op">-</span>Force <span class="op">-</span>Path <span class="op">(</span><span class="fu">Split-Path</span> <span class="va">$bundle</span><span class="op">)</span> <span class="op">|</span> <span class="fu">Out-Null</span> <span class="op">}</span></span>
<span id="cb109-14"><a href="#cb109-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-15"><a href="#cb109-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove antigos</span></span>
<span id="cb109-16"><a href="#cb109-16" aria-hidden="true" tabindex="-1"></a><span class="fu">Remove-Item</span> <span class="va">$bundle</span> <span class="op">-</span>ErrorAction SilentlyContinue</span>
<span id="cb109-17"><a href="#cb109-17" aria-hidden="true" tabindex="-1"></a><span class="fu">Remove-Item</span> <span class="va">$temp</span> <span class="op">-</span>ErrorAction SilentlyContinue</span>
<span id="cb109-18"><a href="#cb109-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-19"><a href="#cb109-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Exporta certificados raiz do Windows em PEM ASCII</span></span>
<span id="cb109-20"><a href="#cb109-20" aria-hidden="true" tabindex="-1"></a><span class="fu">Get-ChildItem</span> <span class="op">-</span>Path Cert<span class="op">:</span>\LocalMachine\Root <span class="op">|</span> <span class="fu">ForEach-Object</span> <span class="op">{</span></span>
<span id="cb109-21"><a href="#cb109-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span> <span class="op">{</span></span>
<span id="cb109-22"><a href="#cb109-22" aria-hidden="true" tabindex="-1"></a>        <span class="va">$pem</span> <span class="op">=</span> <span class="op">[</span>System<span class="op">.</span><span class="fu">Convert</span><span class="op">]::</span>ToBase64String<span class="op">(</span><span class="va">$_</span><span class="op">.</span><span class="fu">RawData</span><span class="op">,</span> <span class="st">&#39;InsertLineBreaks&#39;</span><span class="op">)</span></span>
<span id="cb109-23"><a href="#cb109-23" aria-hidden="true" tabindex="-1"></a>        <span class="fu">Add-Content</span> <span class="op">-</span>Path <span class="va">$temp</span> <span class="op">-</span>Value <span class="st">&quot;-----BEGIN CERTIFICATE-----&quot;</span></span>
<span id="cb109-24"><a href="#cb109-24" aria-hidden="true" tabindex="-1"></a>        <span class="fu">Add-Content</span> <span class="op">-</span>Path <span class="va">$temp</span> <span class="op">-</span>Value <span class="va">$pem</span></span>
<span id="cb109-25"><a href="#cb109-25" aria-hidden="true" tabindex="-1"></a>        <span class="fu">Add-Content</span> <span class="op">-</span>Path <span class="va">$temp</span> <span class="op">-</span>Value <span class="st">&quot;-----END CERTIFICATE-----</span><span class="ch">`r`n</span><span class="st">&quot;</span></span>
<span id="cb109-26"><a href="#cb109-26" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span> <span class="cf">catch</span> <span class="op">{</span></span>
<span id="cb109-27"><a href="#cb109-27" aria-hidden="true" tabindex="-1"></a>        <span class="fu">Write-Warning</span> <span class="st">&quot;Falha ao exportar: </span><span class="va">$_</span><span class="st">&quot;</span></span>
<span id="cb109-28"><a href="#cb109-28" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb109-29"><a href="#cb109-29" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb109-30"><a href="#cb109-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-31"><a href="#cb109-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Grava bundle final em ASCII</span></span>
<span id="cb109-32"><a href="#cb109-32" aria-hidden="true" tabindex="-1"></a><span class="fu">Get-Content</span> <span class="va">$temp</span> <span class="op">-</span>Encoding Ascii <span class="op">|</span> <span class="fu">Out-File</span> <span class="op">-</span>Encoding Ascii <span class="va">$bundle</span></span>
<span id="cb109-33"><a href="#cb109-33" aria-hidden="true" tabindex="-1"></a><span class="fu">Remove-Item</span> <span class="va">$temp</span></span>
<span id="cb109-34"><a href="#cb109-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-35"><a href="#cb109-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Corrige permiss√µes</span></span>
<span id="cb109-36"><a href="#cb109-36" aria-hidden="true" tabindex="-1"></a>icacls <span class="va">$bundle</span> <span class="op">/</span>grant Users<span class="op">:</span>R <span class="op">/</span>T <span class="op">|</span> <span class="fu">Out-Null</span></span>
<span id="cb109-37"><a href="#cb109-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-38"><a href="#cb109-38" aria-hidden="true" tabindex="-1"></a><span class="fu">Write-Host</span> <span class="st">&quot;‚úÖ Bundle atualizado: </span><span class="va">$bundle</span><span class="st">&quot;</span></span></code></pre></div>
<hr />
<h3 data-number="4.15.14" id="como-usar-4"><span class="header-section-number">4.15.14</span> üîπ Como usar</h3>
<ol type="1">
<li>Salve o script em algum lugar fixo, ex.:
<code>C:\Scripts\Update-MSYS2-CABundle.ps1</code><br />
</li>
<li>Execute <strong>como Administrador</strong>:</li>
</ol>
<div class="sourceCode" id="cb110"><pre class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>powershell <span class="op">-</span>ExecutionPolicy Bypass <span class="op">-</span>File <span class="st">&quot;C:\Scripts\Update-MSYS2-CABundle.ps1&quot;</span></span></code></pre></div>
<ol start="3" type="1">
<li>No MSYS2, teste:</li>
</ol>
<div class="sourceCode" id="cb111"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-I</span> https://github.com</span></code></pre></div>
<hr />
<h3 data-number="4.15.15" id="automa√ß√£o-opcional"><span class="header-section-number">4.15.15</span> üîπ Automa√ß√£o opcional</h3>
<p>Voc√™ pode configurar <strong>uma tarefa agendada do Windows</strong>
para rodar o script periodicamente:</p>
<ol type="1">
<li>Abrir <strong>Agendador de Tarefas</strong><br />
</li>
<li>Criar tarefa ‚Üí Executar com privil√©gios de administrador<br />
</li>
<li>A√ß√£o ‚Üí Executar:<br />
</li>
</ol>
<div class="sourceCode" id="cb112"><pre class="sourceCode cmd"><code class="sourceCode dosbat"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>powershell.exe <span class="at">-ExecutionPolicy</span> Bypass <span class="at">-File</span> <span class="st">&quot;C:\Scripts\Update-MSYS2-CABundle.ps1&quot;</span></span></code></pre></div>
<ol start="4" type="1">
<li>Agendar para rodar semanalmente ou mensalmente</li>
</ol>
<hr />
<p>Isso garante que o <code>curl</code> do MSYS2 <strong>sempre use um
bundle atualizado</strong> com todas as CAs do Windows.</p>
<hr />
<p>Se quiser, posso escrever <strong>uma vers√£o <code>.bat</code>
autom√°tica</strong> que roda este script PowerShell <strong>com um
clique</strong> e atualiza o bundle sem precisar abrir PowerShell
manualmente.</p>
<p>Quer que eu fa√ßa isso?</p>
<hr />
<h3 data-number="4.15.16" id="utilizador-2025-10-11-235034-chatgpt"><span class="header-section-number">4.15.16</span> üë§ Utilizador
<em>(2025-10-11 23:50:34)</em> <em>[ChatGPT]</em></h3>
<p>versao bat</p>
<hr />
<h3 data-number="4.15.17" id="chatgpt-2025-10-11-235035-chatgpt"><span class="header-section-number">4.15.17</span> ü§ñ ChatGPT <em>(2025-10-11
23:50:35)</em> <em>[ChatGPT]</em></h3>
<p>Perfeito! Aqui est√° uma vers√£o <code>.bat</code> totalmente
autom√°tica que voc√™ pode <strong>clicar duas vezes</strong> para
atualizar o bundle do MSYS2. Ela:</p>
<ul>
<li>Executa o PowerShell como administrador<br />
</li>
<li>Gera o bundle PEM ASCII com os certificados do Windows<br />
</li>
<li>Ajusta permiss√µes<br />
</li>
<li>Substitui o arquivo do MSYS2</li>
</ul>
<hr />
<h3 data-number="4.15.18" id="arquivo-update-msys2-cabundle.bat"><span class="header-section-number">4.15.18</span> üíæ Arquivo:
<code>Update-MSYS2-CABundle.bat</code></h3>
<div class="sourceCode" id="cb113"><pre class="sourceCode bat"><code class="sourceCode dosbat"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="kw">@</span><span class="bu">echo off</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a><span class="co">:: ===========================================================</span></span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a><span class="co">:: Atualiza bundle de certificados do MSYS2 com certificados do Windows</span></span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a><span class="co">:: ===========================================================</span></span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a><span class="bu">setlocal</span></span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a><span class="bu">set</span> <span class="st">&quot;</span><span class="va">PS1</span>=<span class="pp">%</span><span class="va">TEMP</span><span class="pp">%</span><span class="st">\Update-MSYS2-CABundle.ps1&quot;</span></span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-9"><a href="#cb113-9" aria-hidden="true" tabindex="-1"></a><span class="kw">(</span></span>
<span id="cb113-10"><a href="#cb113-10" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="sc">^&lt;</span>#</span>
<span id="cb113-11"><a href="#cb113-11" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span>     Atualiza o bundle de certificados do MSYS2</span>
<span id="cb113-12"><a href="#cb113-12" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="sc">^#^&gt;</span></span>
<span id="cb113-13"><a href="#cb113-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-14"><a href="#cb113-14" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> $bundle = &quot;C:\msys64\usr\ssl\certs\windows-ca-bundle.crt&quot;</span>
<span id="cb113-15"><a href="#cb113-15" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> $temp = &quot;$env:TEMP\winroots.txt&quot;</span>
<span id="cb113-16"><a href="#cb113-16" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> if (-not (Test-Path (Split-Path $bundle<span class="kw">))</span>) { New<span class="at">-Item</span> <span class="at">-ItemType</span> Directory <span class="at">-Force</span> <span class="at">-Path</span> (Split<span class="at">-Path</span> $bundle<span class="kw">)</span> ^<span class="kw">|</span> Out-Null }</span>
<span id="cb113-17"><a href="#cb113-17" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> Remove-Item $bundle -ErrorAction SilentlyContinue</span>
<span id="cb113-18"><a href="#cb113-18" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> Remove-Item $temp -ErrorAction SilentlyContinue</span>
<span id="cb113-19"><a href="#cb113-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-20"><a href="#cb113-20" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> Get-ChildItem -Path Cert:\LocalMachine\Root <span class="sc">^|</span> ForEach-Object {</span>
<span id="cb113-21"><a href="#cb113-21" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="sc">^ </span>   try {</span>
<span id="cb113-22"><a href="#cb113-22" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="sc">^ </span>       $pem = [System.Convert]::ToBase64String($_.RawData, &#39;InsertLineBreaks&#39;<span class="kw">)</span></span>
<span id="cb113-23"><a href="#cb113-23" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="sc">^ </span>       Add-Content -Path $temp -Value &quot;-----BEGIN CERTIFICATE-----&quot;</span>
<span id="cb113-24"><a href="#cb113-24" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="sc">^ </span>       Add-Content -Path $temp -Value $pem</span>
<span id="cb113-25"><a href="#cb113-25" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="sc">^ </span>       Add-Content -Path $temp -Value &quot;-----END CERTIFICATE-----`r`n&quot;</span>
<span id="cb113-26"><a href="#cb113-26" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="sc">^ </span>   } catch {</span>
<span id="cb113-27"><a href="#cb113-27" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="sc">^ </span>       Write-Warning &quot;Falha ao exportar: $_&quot;</span>
<span id="cb113-28"><a href="#cb113-28" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="sc">^ </span>   }</span>
<span id="cb113-29"><a href="#cb113-29" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> }</span>
<span id="cb113-30"><a href="#cb113-30" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> Get-Content $temp -Encoding Ascii <span class="sc">^|</span> Out-File -Encoding Ascii $bundle</span>
<span id="cb113-31"><a href="#cb113-31" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> Remove-Item $temp</span>
<span id="cb113-32"><a href="#cb113-32" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> icacls $bundle /grant Users:R /T <span class="sc">^|</span> Out-Null</span>
<span id="cb113-33"><a href="#cb113-33" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> Write-Host &quot;‚úÖ Bundle atualizado: $bundle&quot;</span>
<span id="cb113-34"><a href="#cb113-34" aria-hidden="true" tabindex="-1"></a>) <span class="kw">&gt;</span> <span class="st">&quot;</span><span class="pp">%</span><span class="va">PS1</span><span class="pp">%</span><span class="st">&quot;</span></span>
<span id="cb113-35"><a href="#cb113-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-36"><a href="#cb113-36" aria-hidden="true" tabindex="-1"></a><span class="co">:: Executa o PowerShell como Administrador</span></span>
<span id="cb113-37"><a href="#cb113-37" aria-hidden="true" tabindex="-1"></a>powershell <span class="at">-NoProfile</span> <span class="at">-ExecutionPolicy</span> Bypass <span class="at">-Command</span> <span class="st">&quot;Start-Process powershell -ArgumentList &#39;-NoProfile -ExecutionPolicy Bypass -File &quot;&quot;</span><span class="pp">%</span><span class="va">PS1</span><span class="pp">%</span><span class="st">&quot;&quot;&#39; -Verb RunAs&quot;</span></span>
<span id="cb113-38"><a href="#cb113-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-39"><a href="#cb113-39" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> ===========================================================</span>
<span id="cb113-40"><a href="#cb113-40" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> ‚úÖ Ap√≥s a execu√ß√£o, abra o MSYS2 e teste:</span>
<span id="cb113-41"><a href="#cb113-41" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span>     curl -I https://github.com</span>
<span id="cb113-42"><a href="#cb113-42" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> ===========================================================</span>
<span id="cb113-43"><a href="#cb113-43" aria-hidden="true" tabindex="-1"></a><span class="bu">pause</span></span>
<span id="cb113-44"><a href="#cb113-44" aria-hidden="true" tabindex="-1"></a><span class="bu">endlocal</span></span></code></pre></div>
<hr />
<h3 data-number="4.15.19" id="como-usar-5"><span class="header-section-number">4.15.19</span> üîπ Como usar</h3>
<ol type="1">
<li>Salve o arquivo <code>.bat</code> em qualquer lugar, por
exemplo:<br />
<code>C:\Scripts\Update-MSYS2-CABundle.bat</code><br />
</li>
<li>Clique <strong>com bot√£o direito ‚Üí Executar como
administrador</strong><br />
</li>
<li>O script cria/atualiza
<code>/usr/ssl/certs/windows-ca-bundle.crt</code><br />
</li>
<li>Abra o MSYS2 e teste:</li>
</ol>
<div class="sourceCode" id="cb114"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-I</span> https://github.com</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-I</span> https://unicode.org/emoji/charts/full-emoji-modifiers.html</span></code></pre></div>
<p>Se tudo estiver correto, voc√™ ver√° <code>HTTP/2 200</code> ou
similar, sem erros 60/77.</p>
<hr />
<p>Se quiser, posso te passar <strong>uma vers√£o ainda mais
autom√°tica</strong> que <strong>al√©m de atualizar</strong>,
<strong>substitui o bundle padr√£o do MSYS2</strong>
(<code>/usr/ssl/certs/ca-bundle.crt</code>) e define a vari√°vel
<code>CURL_CA_BUNDLE</code> para todos os novos shells ‚Äî assim n√£o
precisa passar <code>--cacert</code> nunca mais.</p>
<p>Quer que eu fa√ßa isso?</p>
<hr />
<h3 data-number="4.15.20" id="utilizador-2025-10-12-095935-chatgpt"><span class="header-section-number">4.15.20</span> üë§ Utilizador
<em>(2025-10-12 09:59:35)</em> <em>[ChatGPT]</em></h3>
<p>curl -I <a href="https://github.com" class="uri">https://github.com</a> funciona; mas <a href="mailto:mpmen@MM04" class="email">mpmen@MM04</a> MINGW64
/d/Downloads/<em>DOCS</em>/<em>DOCS</em>/Msys2_Test_curl_e_wget $ curl
-I <a href="https://unicode.org/emoji/charts/full-emoji-modifiers.html" class="uri">https://unicode.org/emoji/charts/full-emoji-modifiers.html</a>
curl: (52) Empty reply from server</p>
<hr />
<h3 data-number="4.15.21" id="chatgpt-2025-10-12-095936-chatgpt"><span class="header-section-number">4.15.21</span> ü§ñ ChatGPT <em>(2025-10-12
09:59:36)</em> <em>[ChatGPT]</em></h3>
<p>Excelente ‚Äî o progresso est√° <strong>perfeito</strong>:<br />
‚úÖ o erro de certificados (<code>(60)</code> ou <code>(77)</code>)
desapareceu, o <code>curl</code> do MSYS2 agora <strong>valida SSL
corretamente</strong>.</p>
<p>Agora, o novo erro</p>
<pre><code>curl: (52) Empty reply from server</code></pre>
<p>n√£o tem nada a ver com certificados. Ele significa que:</p>
<blockquote>
<p>üß© O servidor <strong>aceitou a conex√£o HTTPS</strong>, mas
<strong>encerrou sem enviar corpo de resposta HTTP</strong>.</p>
</blockquote>
<hr />
<h3 data-number="4.15.22" id="explicando-o-que-est√°-acontecendo"><span class="header-section-number">4.15.22</span> üí° Explicando o que est√°
acontecendo</h3>
<p>O site que voc√™ testou:</p>
<pre><code>https://unicode.org/emoji/charts/full-emoji-modifiers.html</code></pre>
<p>√© uma <strong>p√°gina HTML est√°tica</strong>, hospedada atr√°s de uma
CDN (geralmente Cloudflare ou Fastly).<br />
√Äs vezes, ao usar <code>curl -I</code> (modo <em>HEAD</em>), alguns
servidores <strong>n√£o respondem a HEAD requests</strong> corretamente e
fecham a conex√£o em sil√™ncio ‚Äî o que resulta exatamente em
<code>(52) Empty reply from server</code>.</p>
<p>Isso √© comportamento do servidor, <strong>n√£o do
<code>curl</code></strong>.</p>
<hr />
<h3 data-number="4.15.23" id="como-confirmar"><span class="header-section-number">4.15.23</span> ‚úÖ Como confirmar</h3>
<p>Tente fazer um <em>GET</em> normal (baixar o cabe√ßalho +
conte√∫do):</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-v</span> https://unicode.org/emoji/charts/full-emoji-modifiers.html <span class="at">-o</span> /dev/null</span></code></pre></div>
<p>Voc√™ deve ver:</p>
<pre><code>&lt; HTTP/2 200
&lt; content-type: text/html
&lt; ...</code></pre>
<p>Isso confirma que o HTTPS est√° funcionando ‚Äî o site s√≥ n√£o responde
ao m√©todo HEAD.</p>
<hr />
<h3 data-number="4.15.24" id="alternativas-e-testes"><span class="header-section-number">4.15.24</span> üîß Alternativas e
testes</h3>
<ol type="1">
<li><p>Verifique outros sites (funcionam normalmente):</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-I</span> https://github.com</span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-I</span> https://www.google.com</span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-I</span> https://www.unicode.org</span></code></pre></div>
<p>Todos devem retornar <code>HTTP/2 200</code> ‚Äî se sim, o
<code>curl</code> est√° 100% OK.</p></li>
<li><p>Teste HEAD no unicode.org principal:</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-I</span> https://unicode.org</span></code></pre></div>
<p>‚Üí Deve retornar <code>HTTP/2 200</code>.</p></li>
<li><p>Se quiser for√ßar um <em>GET</em> mesmo no comando de headers:</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-s</span> <span class="at">-D</span> <span class="at">-</span> <span class="at">-o</span> /dev/null https://unicode.org/emoji/charts/full-emoji-modifiers.html</span></code></pre></div>
<p>(<code>-D -</code> mostra apenas cabe√ßalhos)</p></li>
</ol>
<hr />
<h3 data-number="4.15.25" id="conclus√£o-1"><span class="header-section-number">4.15.25</span> ‚úÖ Conclus√£o</h3>
<ul>
<li>O <code>(52)</code> <strong>n√£o √© erro de SSL</strong> ‚Äî √© resposta
vazia do servidor.<br />
</li>
<li>Seu <code>curl</code> e o certificado do MSYS2 est√£o
<strong>funcionando perfeitamente</strong>.<br />
</li>
<li>O Unicode.org apenas <strong>n√£o lida com <code>HEAD</code>
requests</strong> para esse endpoint espec√≠fico.</li>
</ul>
<hr />
<p>Se quiser, posso te mostrar <strong>como testar automaticamente
v√°rios sites HTTPS</strong> para verificar se o bundle e o OpenSSL est√£o
100% corretos (um pequeno script de teste em bash que imprime o status
de cada dom√≠nio). Quer que eu gere isso pra voc√™?</p>
<hr />
<p><em>Conversa exportada do ChatGPT</em> <em>Processado em: 24/11/2025
22:27</em></p>

        <script id="fixed-toc-script">
        document.addEventListener('DOMContentLoaded', function() {
            const toc = document.getElementById('TOC');
            if (toc) {
                const tocTitle = toc.querySelector('h2');
                if (tocTitle) {
                    const toggleBtn = document.createElement('button');
                    toggleBtn.innerHTML = '‚ò∞';
                    toggleBtn.className = 'toc-toggle-btn';
                    toggleBtn.title = 'Minimizar/Expandir TOC';
                    let isMinimized = false;
                    toggleBtn.addEventListener('click', function(e) {
                        e.stopPropagation();
                        isMinimized = !isMinimized;
                        if (isMinimized) {
                            toc.classList.add('toc-minimized');
                        } else {
                            toc.classList.remove('toc-minimized');
                        }
                    });
                    tocTitle.appendChild(toggleBtn);
                }
            }
            
            // SCROLLSPY
            const sections = document.querySelectorAll('h1, h2, h3, h4, h5');
            const tocLinks = document.querySelectorAll('#TOC a');
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const id = entry.target.getAttribute('id');
                        tocLinks.forEach(link => {
                            link.classList.remove('active');
                            if (link.getAttribute('href') === '#' + id) {
                                link.classList.add('active');
                            }
                        });
                    }
                });
            }, { 
                rootMargin: '-20% 0px -60% 0px', 
                threshold: 0 
            });
            
            sections.forEach(section => {
                if (section.id) observer.observe(section);
            });
            
            // Scroll suave
            tocLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const targetId = link.getAttribute('href').substring(1);
                    const targetElement = document.getElementById(targetId);
                    if (targetElement) {
                        const offsetTop = targetElement.offsetTop - 80;
                        window.scrollTo({ top: offsetTop, behavior: 'smooth' });
                    }
                });
            });
            
            // BOT√ÉO VOLTAR AO TOPO
            const backToTopBtn = document.createElement('button');
            backToTopBtn.className = 'back-to-top-content';
            backToTopBtn.innerHTML = '‚Üë';
            backToTopBtn.title = 'Voltar ao Topo';
            document.body.appendChild(backToTopBtn);
            
            window.addEventListener('scroll', () => {
                if (window.pageYOffset > 300) {
                    backToTopBtn.classList.add('show');
                } else {
                    backToTopBtn.classList.remove('show');
                }
            });
            
            backToTopBtn.addEventListener('click', () => {
                window.scrollTo({ top: 0, behavior: 'smooth' });
            });
        });
        </script>
        
</body>
</html>
