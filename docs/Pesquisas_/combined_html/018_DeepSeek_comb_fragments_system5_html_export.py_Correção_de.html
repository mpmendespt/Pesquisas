<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang xml:lang>
<head>

        <style id="fixed-toc-styles">
        /* === ESTILOS PRINCIPAIS - TOC FIXO √Ä DIREITA === */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
            scroll-behavior: smooth;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            position: relative;
        }
        /* === TOC FIXO √Ä DIREITA - POSI√á√ÉO CORRIGIDA === */
        #TOC {
            position: fixed !important;
            top: 50% !important;
            right: 20px !important;
            transform: translateY(-50%) !important;
            width: 320px !important;
            max-height: 80vh !important;
            overflow-y: auto !important;
            z-index: 1000 !important;
            background: rgba(255, 255, 255, 0.98) !important;
            padding: 20px !important;
            border-radius: 12px !important;
            box-shadow: 0 8px 32px rgba(0,0,0,0.15) !important;
            border: 1px solid #e0e0e0 !important;
            backdrop-filter: blur(10px) !important;
            transition: all 0.3s ease-in-out !important;
        }
        #TOC.toc-minimized {
            transform: translateY(-50%) translateX(calc(320px - 50px)) !important;
            opacity: 0.3;
            width: 50px !important;
            overflow: hidden;
        }
        #TOC.toc-minimized > *:not(.toc-toggle-btn) {
            display: none !important;
        }
        #TOC h2 {
            margin-top: 0;
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
            font-size: 1.2em;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .toc-toggle-btn {
            background: none;
            border: none;
            font-size: 1.2em;
            cursor: pointer;
            padding: 5px;
            border-radius: 4px;
            transition: background-color 0.2s;
        }
        .toc-toggle-btn:hover {
            background-color: rgba(0,0,0,0.1);
        }
        #TOC ul {
            list-style-type: none;
            padding-left: 15px;
            margin: 10px 0;
        }
        #TOC ul ul {
            padding-left: 20px;
        }
        #TOC li {
            margin: 8px 0;
            line-height: 1.4;
        }
        #TOC a {
            text-decoration: none;
            color: #495057;
            font-weight: 500;
            transition: all 0.2s ease;
            display: block;
            padding: 6px 10px;
            border-radius: 6px;
            border-left: 3px solid transparent;
        }
        #TOC a:hover {
            color: #007bff;
            background-color: rgba(0, 123, 255, 0.1);
            border-left-color: #007bff;
        }
        #TOC a.active {
            background-color: #007bff !important;
            color: white !important;
            font-weight: bold;
            border-left-color: #0056b3;
        }
        /* Conte√∫do principal com margem para o TOC */
        .main-content {
            margin-right: calc(320px + 40px) !important;
        }
        /* Barra de scroll personalizada APENAS para TOC */
        #TOC::-webkit-scrollbar {
            width: 8px;
        }
        #TOC::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }
        #TOC::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 4px;
        }
        #TOC::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }
        /* === BOT√ÉO VOLTAR AO TOPO (HTMLs individuais) === */
        .back-to-top-content {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            font-size: 18px;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 999;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .back-to-top-content.show {
            opacity: 1;
            transform: translateY(0);
        }
        .back-to-top-content:hover {
            background: #0056b3;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0,0,0,0.2);
        }
        /* === RESPONSIVIDADE === */
        @media (max-width: 1400px) {
            .container {
                max-width: 95%;
                padding: 30px;
            }
            #TOC {
                width: 280px !important;
            }
            .main-content {
                margin-right: 320px !important;
            }
        }
        @media (max-width: 1200px) {
            #TOC {
                width: 260px !important;
                right: 15px !important;
            }
            .main-content {
                margin-right: 300px !important;
            }
        }
        @media (max-width: 992px) {
            #TOC {
                position: relative !important;
                width: 100% !important;
                right: 0 !important;
                top: 0 !important;
                transform: none !important;
                margin: 20px 0;
                max-height: 300px !important;
            }
            .main-content {
                margin-right: 0 !important;
            }
            .back-to-top-content {
                right: 20px;
                bottom: 20px;
            }
        }
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            .container {
                padding: 20px;
                max-width: 100%;
            }
            #TOC {
                max-height: 250px !important;
                padding: 15px !important;
            }
        }
        </style>
        
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>018_DeepSeek_comb_fragments_system5_html_export.py_Corre√ß√£o_de</title>
  <style>

html {
color: #1a1a1a;
background-color: #fdfdfd;
}
body {
margin: 0 auto;
max-width: 36em;
padding-left: 50px;
padding-right: 50px;
padding-top: 50px;
padding-bottom: 50px;
hyphens: auto;
overflow-wrap: break-word;
text-rendering: optimizeLegibility;
font-kerning: normal;
}
@media (max-width: 600px) {
body {
font-size: 0.9em;
padding: 12px;
}
h1 {
font-size: 1.8em;
}
}
@media print {
html {
background-color: white;
}
body {
background-color: transparent;
color: black;
font-size: 12pt;
}
p, h2, h3 {
orphans: 3;
widows: 3;
}
h2, h3, h4 {
page-break-after: avoid;
}
}
p {
margin: 1em 0;
}
a {
color: #1a1a1a;
}
a:visited {
color: #1a1a1a;
}
img {
max-width: 100%;
}
svg {
height: auto;
max-width: 100%;
}
h1, h2, h3, h4, h5, h6 {
margin-top: 1.4em;
}
h5, h6 {
font-size: 1em;
font-style: italic;
}
h6 {
font-weight: normal;
}
ol, ul {
padding-left: 1.7em;
margin-top: 1em;
}
li > ol, li > ul {
margin-top: 0;
}
blockquote {
margin: 1em 0 1em 1.7em;
padding-left: 1em;
border-left: 2px solid #e6e6e6;
color: #606060;
}
code {
font-family: Menlo, Monaco, Consolas, 'Lucida Console', monospace;
font-size: 85%;
margin: 0;
hyphens: manual;
}
pre {
margin: 1em 0;
overflow: auto;
}
pre code {
padding: 0;
overflow: visible;
overflow-wrap: normal;
}
.sourceCode {
background-color: transparent;
overflow: visible;
}
hr {
border: none;
border-top: 1px solid #1a1a1a;
height: 1px;
margin: 1em 0;
}
table {
margin: 1em 0;
border-collapse: collapse;
width: 100%;
overflow-x: auto;
display: block;
font-variant-numeric: lining-nums tabular-nums;
}
table caption {
margin-bottom: 0.75em;
}
tbody {
margin-top: 0.5em;
border-top: 1px solid #1a1a1a;
border-bottom: 1px solid #1a1a1a;
}
th {
border-top: 1px solid #1a1a1a;
padding: 0.25em 0.5em 0.25em 0.5em;
}
td {
padding: 0.125em 0.5em 0.25em 0.5em;
}
header {
margin-bottom: 4em;
text-align: center;
}
#TOC li {
list-style: none;
}
#TOC ul {
padding-left: 1.3em;
}
#TOC > ul {
padding-left: 0;
}
#TOC a:not(:hover) {
text-decoration: none;
}
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}

ul.task-list[class]{list-style: none;}
ul.task-list li input[type="checkbox"] {
font-size: inherit;
width: 0.8em;
margin: 0 0.8em 0.2em -1.6em;
vertical-align: middle;
}

html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
</head>
<body>
<nav id="TOC" role="doc-toc">
<ul>
<li><a href="#comb_fragments_system5_html_export.py-corre√ß√£o-de-cores-em-html-gerado" id="toc-comb_fragments_system5_html_export.py-corre√ß√£o-de-cores-em-html-gerado"><span class="toc-section-number">1</span>
comb_fragments_system5_html_export.py Corre√ß√£o de cores em HTML
gerado</a>
<ul>
<li><a href="#informa√ß√µes" id="toc-informa√ß√µes"><span class="toc-section-number">1.1</span> üìä Informa√ß√µes</a></li>
<li><a href="#conversa" id="toc-conversa"><span class="toc-section-number">1.2</span> üí¨ Conversa</a></li>
</ul></li>
</ul>
</nav>
<h1 data-number="1" id="comb_fragments_system5_html_export.py-corre√ß√£o-de-cores-em-html-gerado"><span class="header-section-number">1</span>
comb_fragments_system5_html_export.py Corre√ß√£o de cores em HTML
gerado</h1>
<h2 data-number="1.1" id="informa√ß√µes"><span class="header-section-number">1.1</span> üìä Informa√ß√µes</h2>
<ul>
<li><strong>N√∫mero:</strong> #18</li>
<li><strong>Origem:</strong> DeepSeek</li>
<li><strong>Categoria:</strong> Sistemas</li>
<li><strong>ID:</strong> fd3f8056-b4e9-4de8-a66c-7ebdfe08d9b5</li>
<li><strong>Criada em:</strong> 2025-11-08 07:37:58</li>
<li><strong>Atualizada em:</strong> 2025-11-08 19:44:46</li>
<li><strong>Total de mensagens:</strong> 8</li>
<li><strong>Resumo:</strong> No comb_fragments_system5_html_export.py A
Convers√£o de md para html n√£o totalmente fiel porqu√™? Exe‚Ä¶</li>
</ul>
<hr />
<h2 data-number="1.2" id="conversa"><span class="header-section-number">1.2</span> üí¨ Conversa</h2>
<h3 data-number="1.2.1" id="utilizador-2025-11-08-073800-deepseek-reasoner"><span class="header-section-number">1.2.1</span> üë§ Utilizador <em>(2025-11-08
07:38:00)</em> <em>[deepseek-reasoner]</em></h3>
<p>No comb_fragments_system5_html_export.py A Convers√£o de md para html
n√£o totalmente fiel porqu√™? Exemplo: compara estes dois files:
001_Qwen3_Converter_MD_para_HTML_Preservando_Conte√∫do.md
001_Qwen3_Converter_MD_para_HTML_Preservando_Conte√∫do.html No html algum
texto tem a mesma cor do background por isso n√£o √© visivel. Como
corrigir?</p>
<hr />
<h3 data-number="1.2.2" id="deepseek-2025-11-08-073800-deepseek-reasoner"><span class="header-section-number">1.2.2</span> ü§ñ DeepSeek <em>(2025-11-08
07:38:00)</em> <em>[deepseek-reasoner]</em></h3>
<p>Vamos analisar o problema: no HTML gerado, algum texto tem a mesma
cor do fundo, tornando-o invis√≠vel.</p>
<p>Isso pode ser devido a v√°rios fatores, mas o mais comum √© que o CSS
est√° definindo uma cor de texto que n√£o contrasta com o fundo. No
c√≥digo, temos v√°rias camadas de CSS, tanto no m√©todo
<code>_inject_enhanced_css</code> quanto no
<code>_create_enhanced_html_template</code> e no
<code>_create_basic_html</code>.</p>
<p>Vamos focar no CSS injetado no m√©todo
<code>_inject_enhanced_css</code> e no template enhanced, pois √© o mais
prov√°vel de estar causando o problema.</p>
<p>No m√©todo <code>_inject_enhanced_css</code>, temos um trecho de CSS
que define:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode css"><code class="sourceCode css"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>body {</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">font-family</span><span class="ch">:</span> <span class="st">&#39;Segoe UI&#39;</span><span class="op">,</span> <span class="dv">Tahoma</span><span class="op">,</span> <span class="dv">Geneva</span><span class="op">,</span> <span class="dv">Verdana</span><span class="op">,</span> <span class="dv">sans-serif</span><span class="op">;</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">line-height</span><span class="ch">:</span> <span class="dv">1.6</span><span class="op">;</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">margin</span><span class="ch">:</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">padding</span><span class="ch">:</span> <span class="dv">20</span><span class="dt">px</span><span class="op">;</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">background-color</span><span class="ch">:</span> <span class="cn">#f5f5f5</span><span class="op">;</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">color</span><span class="ch">:</span> <span class="cn">#333</span><span class="op">;</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">max-width</span><span class="ch">:</span> <span class="dv">none</span><span class="op">;</span> <span class="co">/* Remove limita√ß√£o de largura - TELA COMPLETA */</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Aqui, a cor do texto √© <code>#333</code> (quase preto) e o fundo √©
<code>#f5f5f5</code> (cinza claro), o que deve ter bom contraste.</p>
<p>No entanto, note que no mesmo m√©todo, h√° estilos para
<code>pre</code> e <code>code</code>:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode css"><code class="sourceCode css"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>pre { </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">border-left</span><span class="ch">:</span> <span class="dv">4</span><span class="dt">px</span> <span class="dv">solid</span> <span class="cn">#3498db</span><span class="op">;</span> </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">background</span><span class="ch">:</span> <span class="cn">#2d2d2d</span><span class="op">;</span> </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">color</span><span class="ch">:</span> <span class="cn">#f8f8f2</span><span class="op">;</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">padding</span><span class="ch">:</span> <span class="dv">20</span><span class="dt">px</span><span class="op">;</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">border-radius</span><span class="ch">:</span> <span class="dv">8</span><span class="dt">px</span><span class="op">;</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">overflow-x</span><span class="ch">:</span> <span class="bu">auto</span><span class="op">;</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">font-family</span><span class="ch">:</span> <span class="st">&#39;Consolas&#39;</span><span class="op">,</span> <span class="st">&#39;Monaco&#39;</span><span class="op">,</span> <span class="st">&#39;Courier New&#39;</span><span class="op">,</span> <span class="dv">monospace</span><span class="op">;</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">line-height</span><span class="ch">:</span> <span class="dv">1.4</span><span class="op">;</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>code { </span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">background</span><span class="ch">:</span> <span class="cn">#e9ecef</span><span class="op">;</span> </span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">padding</span><span class="ch">:</span> <span class="dv">0.2</span><span class="dt">em</span> <span class="dv">0.4</span><span class="dt">em</span><span class="op">;</span> </span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">border-radius</span><span class="ch">:</span> <span class="dv">3</span><span class="dt">px</span><span class="op">;</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">font-family</span><span class="ch">:</span> <span class="st">&#39;Consolas&#39;</span><span class="op">,</span> <span class="st">&#39;Monaco&#39;</span><span class="op">,</span> <span class="st">&#39;Courier New&#39;</span><span class="op">,</span> <span class="dv">monospace</span><span class="op">;</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">color</span><span class="ch">:</span> <span class="cn">#c7254e</span><span class="op">;</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Aqui, o <code>pre</code> tem fundo escuro (<code>#2d2d2d</code>) e
texto claro (<code>#f8f8f2</code>), e o <code>code</code> tem fundo
cinza claro (<code>#e9ecef</code>) e texto vermelho escuro
(<code>#c7254e</code>). Isso parece correto.</p>
<p>Mas note que no template enhanced, h√° um estilo para
<code>pre code</code>:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode css"><code class="sourceCode css"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>pre code { </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">background</span><span class="ch">:</span> <span class="dv">none</span><span class="op">;</span> </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">color</span><span class="ch">:</span> <span class="bu">inherit</span><span class="op">;</span> </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">padding</span><span class="ch">:</span> <span class="dv">0</span><span class="op">;</span> </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Isso significa que dentro de um <code>pre</code>, o <code>code</code>
herda a cor do <code>pre</code> (que √© <code>#f8f8f2</code>) e o fundo √©
none, ent√£o usa o fundo do <code>pre</code> (escuro). Isso tamb√©m est√°
correto.</p>
<p>Outro lugar a verificar √© no m√©todo
<code>_create_enhanced_html_template</code> e
<code>_create_basic_html</code>. No enhanced template, temos:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode css"><code class="sourceCode css"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>code {</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">background</span><span class="ch">:</span> <span class="cn">#f4f4f4</span><span class="op">;</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">padding</span><span class="ch">:</span> <span class="dv">3</span><span class="dt">px</span> <span class="dv">8</span><span class="dt">px</span><span class="op">;</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">border-radius</span><span class="ch">:</span> <span class="dv">4</span><span class="dt">px</span><span class="op">;</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">font-family</span><span class="ch">:</span> <span class="st">&#39;Consolas&#39;</span><span class="op">,</span> <span class="st">&#39;Monaco&#39;</span><span class="op">,</span> <span class="st">&#39;Courier New&#39;</span><span class="op">,</span> <span class="dv">monospace</span><span class="op">;</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">color</span><span class="ch">:</span> <span class="cn">#c7254e</span><span class="op">;</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">font-size</span><span class="ch">:</span> <span class="dv">0.9</span><span class="dt">em</span><span class="op">;</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>pre {</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">background</span><span class="ch">:</span> <span class="cn">#2d2d2d</span><span class="op">;</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">color</span><span class="ch">:</span> <span class="cn">#f8f8f2</span><span class="op">;</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">padding</span><span class="ch">:</span> <span class="dv">20</span><span class="dt">px</span><span class="op">;</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">border-radius</span><span class="ch">:</span> <span class="dv">8</span><span class="dt">px</span><span class="op">;</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">overflow-x</span><span class="ch">:</span> <span class="bu">auto</span><span class="op">;</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">border-left</span><span class="ch">:</span> <span class="dv">5</span><span class="dt">px</span> <span class="dv">solid</span> <span class="cn">#3498db</span><span class="op">;</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">font-family</span><span class="ch">:</span> <span class="st">&#39;Consolas&#39;</span><span class="op">,</span> <span class="st">&#39;Monaco&#39;</span><span class="op">,</span> <span class="st">&#39;Courier New&#39;</span><span class="op">,</span> <span class="dv">monospace</span><span class="op">;</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">line-height</span><span class="ch">:</span> <span class="dv">1.4</span><span class="op">;</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>pre code {</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>    <span class="kw">background</span><span class="ch">:</span> <span class="dv">none</span><span class="op">;</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>    <span class="kw">color</span><span class="ch">:</span> <span class="bu">inherit</span><span class="op">;</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>    <span class="kw">padding</span><span class="ch">:</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Aqui, novamente, o <code>pre</code> tem fundo escuro e texto claro, e
o <code>code</code> dentro do <code>pre</code> herda a cor (clara) e
fundo none.</p>
<p>No basic HTML, temos:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode css"><code class="sourceCode css"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>pre { </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">white-space</span><span class="ch">:</span> <span class="dv">pre-wrap</span><span class="op">;</span> </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    word-wrap<span class="ch">:</span> <span class="dv">break-word</span><span class="op">;</span> </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">background</span><span class="ch">:</span> <span class="cn">white</span><span class="op">;</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">padding</span><span class="ch">:</span> <span class="dv">15</span><span class="dt">px</span><span class="op">;</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">border-radius</span><span class="ch">:</span> <span class="dv">5</span><span class="dt">px</span><span class="op">;</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">border</span><span class="ch">:</span> <span class="dv">1</span><span class="dt">px</span> <span class="dv">solid</span> <span class="cn">#ddd</span><span class="op">;</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Aqui, o <code>pre</code> tem fundo branco e a cor do texto n√£o est√°
definida, ent√£o herda do body (que no basic HTML n√£o est√° definida,
ent√£o √© a cor padr√£o do user agent, geralmente preta). Isso tamb√©m est√°
correto.</p>
<p>Portanto, o problema pode n√£o ser no CSS geral, mas em algum elemento
espec√≠fico. Pode ser que haja algum elemento com uma classe ou estilo
inline que est√° definindo uma cor de texto igual ao fundo.</p>
<p>Outra possibilidade √© que o Pandoc esteja gerando algum CSS adicional
que est√° sobrescrevendo o nosso. O Pandoc, quando usado com a op√ß√£o
<code>--standalone</code>, inclui seu pr√≥prio CSS. No entanto, no m√©todo
<code>_convert_with_pandoc_optimized</code> n√≥s usamos
<code>--standalone</code> e injetamos nosso CSS, o que deve sobrescrever
o CSS do Pandoc.</p>
<p>No entanto, note que no m√©todo <code>_inject_enhanced_css</code> n√≥s
injetamos o CSS no <code>&lt;head&gt;</code>, mas o Pandoc tamb√©m coloca
seu CSS no <code>&lt;head&gt;</code>. A ordem importa: o √∫ltimo CSS tem
prioridade. O nosso CSS √© injetado ap√≥s o CSS do Pandoc (pois n√≥s
substitu√≠mos o <code>&lt;/head&gt;</code> pelo nosso CSS e depois
<code>&lt;/head&gt;</code>). Ent√£o, nosso CSS deve estar sobrescrevendo
o do Pandoc.</p>
<p>Mas, se o Pandoc estiver gerando regras CSS mais espec√≠ficas, elas
podem sobrescrever as nossas. Por exemplo, se o Pandoc gerar:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode css"><code class="sourceCode css"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>body { <span class="kw">color</span><span class="ch">:</span> <span class="cn">black</span><span class="op">;</span> }</span></code></pre></div>
<p>e n√≥s tivermos:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode css"><code class="sourceCode css"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>body { <span class="kw">color</span><span class="ch">:</span> <span class="cn">#333</span><span class="op">;</span> }</span></code></pre></div>
<p>n√£o h√° problema, mas se o Pandoc gerar:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode css"><code class="sourceCode css"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>pre code { <span class="kw">color</span><span class="ch">:</span> <span class="cn">white</span><span class="op">;</span> }</span></code></pre></div>
<p>e n√≥s tivermos:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode css"><code class="sourceCode css"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>pre code { <span class="kw">color</span><span class="ch">:</span> <span class="bu">inherit</span><span class="op">;</span> }</span></code></pre></div>
<p>a regra do Pandoc pode ser mais espec√≠fica ou estar depois.</p>
<p>Uma maneira de diagnosticar √© inspecionar o elemento invis√≠vel no
navegador e ver qual regra CSS est√° sendo aplicada.</p>
<p>Como n√£o temos o HTML gerado, vamos tentar for√ßar nosso CSS a ser
mais espec√≠fico e garantir que as cores est√£o sendo aplicadas.</p>
<p>Vamos modificar o CSS no m√©todo <code>_inject_enhanced_css</code>
para ser mais espec√≠fico, usando <code>!important</code> nas cores de
texto e fundo para elementos <code>pre</code> e <code>code</code>? N√£o √©
a melhor pr√°tica, mas pode resolver se for um problema de
sobrescrita.</p>
<p>No entanto, note que o m√©todo <code>_inject_enhanced_css</code> j√°
est√° injetando CSS que sobrescreve o do Pandoc, mas talvez o Pandoc
esteja gerando regras com mais especificidade.</p>
<p>Vamos tentar aumentar a especificidade do nosso CSS, por exemplo,
usando <code>body pre</code> e <code>body code</code>.</p>
<p>Outra ideia: o problema pode estar em elementos que n√£o s√£o
<code>pre</code> ou <code>code</code>, mas talvez em
<code>blockquote</code> ou em algum outro elemento.</p>
<p>Vamos revisar o CSS para <code>blockquote</code>:</p>
<p>No m√©todo <code>_inject_enhanced_css</code>:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode css"><code class="sourceCode css"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>blockquote { </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">border-left</span><span class="ch">:</span> <span class="dv">4</span><span class="dt">px</span> <span class="dv">solid</span> <span class="cn">#3498db</span><span class="op">;</span> </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">margin</span><span class="ch">:</span> <span class="dv">25</span><span class="dt">px</span> <span class="dv">0</span><span class="op">;</span> </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">padding-left</span><span class="ch">:</span> <span class="dv">25</span><span class="dt">px</span><span class="op">;</span> </span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">color</span><span class="ch">:</span> <span class="cn">#7f8c8d</span><span class="op">;</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">font-style</span><span class="ch">:</span> <span class="dv">italic</span><span class="op">;</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">background</span><span class="ch">:</span> <span class="cn">#f8f9fa</span><span class="op">;</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">padding</span><span class="ch">:</span> <span class="dv">20</span><span class="dt">px</span><span class="op">;</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">border-radius</span><span class="ch">:</span> <span class="dv">0</span> <span class="dv">8</span><span class="dt">px</span> <span class="dv">8</span><span class="dt">px</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Aqui, a cor do texto √© <code>#7f8c8d</code> (cinza) e o fundo √©
<code>#f8f9fa</code> (cinza muito claro). O contraste √© menor, mas ainda
vis√≠vel. Se o problema for em blockquote, talvez seja necess√°rio
escurecer a cor.</p>
<p>Mas o problema √© descrito como ‚Äúalgum texto‚Äù e n√£o todo o
blockquote.</p>
<p>Sugiro:</p>
<ol type="1">
<li>Inspecionar o elemento invis√≠vel no navegador para ver qual regra
CSS est√° sendo aplicada.</li>
<li>Se n√£o for poss√≠vel, tentar for√ßar as cores com
<code>!important</code> temporariamente para ver se resolve.</li>
</ol>
<p>Vamos modificar o m√©todo <code>_inject_enhanced_css</code> para
adicionar <code>!important</code> nas cores de texto e fundo para os
elementos <code>body</code>, <code>pre</code>, <code>code</code> e
<code>blockquote</code>? Isso pode n√£o ser necess√°rio, mas para
diagn√≥stico, podemos tentar.</p>
<p>No entanto, como n√£o temos o contexto exato, vou propor uma corre√ß√£o
mais geral: garantir que todos os elementos de texto tenham uma cor
contrastante.</p>
<p>Vamos adicionar uma regra CSS no m√©todo
<code>_inject_enhanced_css</code> para for√ßar a cor do texto para todos
os elementos, mas isso √© muito invasivo. Em vez disso, vamos focar nos
elementos que podem estar sendo afetados.</p>
<p>Outra possibilidade: o Pandoc pode estar gerando classes CSS que n√£o
estamos estilizando. Por exemplo, ele pode gerar classes para syntax
highlighting. No m√©todo <code>_convert_with_pandoc_optimized</code>,
usamos <code>--syntax-highlighting=pygments</code>, que gera classes CSS
para o c√≥digo. Se n√£o temos o CSS para essas classes, pode ser que
algumas cores sejam inadequadas.</p>
<p>No entanto, o Pandoc geralmente inclui o CSS para syntax highlighting
quando usamos <code>--syntax-highlighting</code>? Sim, mas n√≥s estamos
injetando nosso CSS depois, que pode sobrescrever.</p>
<p>Mas note que no nosso CSS, n√≥s definimos:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode css"><code class="sourceCode css"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>pre { </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    ... </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    background<span class="in">:</span> <span class="pp">#2d2d2d</span>; </span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    color<span class="in">:</span> <span class="pp">#f8f8f2</span>;</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    ...</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>e para <code>code</code> dentro de <code>pre</code>:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode css"><code class="sourceCode css"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>pre code { </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">background</span><span class="ch">:</span> <span class="dv">none</span><span class="op">;</span> </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">color</span><span class="ch">:</span> <span class="bu">inherit</span><span class="op">;</span> </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Isso deve fazer com que o c√≥digo dentro do <code>pre</code> tenha a
mesma cor do <code>pre</code> (clara) e fundo escuro.</p>
<p>Se o problema for em c√≥digo com syntax highlighting, o Pandoc gera
spans com classes que definem cores. Nosso CSS n√£o define essas cores,
ent√£o o Pandoc as define. E se o tema do Pygments que o Pandoc usa for
claro, ent√£o as cores podem ser claras sobre o fundo escuro? N√£o, porque
o Pandoc deve usar um tema apropriado para o output. No entanto, o
Pandoc n√£o injeta CSS para syntax highlighting quando usamos
<code>--mathjax</code>? N√£o tenho certeza.</p>
<p>Na verdade, o Pandoc pode estar gerando um CSS que define cores para
as classes de syntax highlighting, e se esse CSS for gerado depois do
nosso, pode sobrescrever as cores.</p>
<p>Vamos tentar for√ßar a cor do texto no c√≥digo para ser clara, mesmo
para os spans com classes, com:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode css"><code class="sourceCode css"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>pre code <span class="op">*</span> {</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">color</span><span class="ch">:</span> <span class="bu">inherit</span> <span class="at">!important</span><span class="op">;</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Isso √© um pouco radical, mas garante que todo texto dentro de
<code>pre code</code> ter√° a mesma cor.</p>
<p>Vamos modificar o CSS no m√©todo
<code>_inject_enhanced_css</code>:</p>
<p>Adicione:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode css"><code class="sourceCode css"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>pre code <span class="op">*</span> {</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">color</span><span class="ch">:</span> <span class="bu">inherit</span> <span class="at">!important</span><span class="op">;</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>E tamb√©m, para garantir que o fundo n√£o seja alterado:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode css"><code class="sourceCode css"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>pre code <span class="op">*</span> {</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">color</span><span class="ch">:</span> <span class="bu">inherit</span> <span class="at">!important</span><span class="op">;</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">background</span><span class="ch">:</span> <span class="bu">inherit</span> <span class="at">!important</span><span class="op">;</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Isso deve for√ßar todos os elementos dentro de <code>pre code</code> a
herdar a cor e o fundo.</p>
<p>Outra ideia: em vez de confiar no Pandoc para syntax highlighting,
podemos desativar o syntax highlighting e usar apenas o nosso estilo.
Mas isso n√£o √© ideal.</p>
<p>Vamos tentar a abordagem de for√ßar a heran√ßa.</p>
<p>Modifique o m√©todo <code>_inject_enhanced_css</code> para
adicionar:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode css"><code class="sourceCode css"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>        pre code <span class="op">*</span> {</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>            <span class="kw">color</span><span class="ch">:</span> <span class="bu">inherit</span> <span class="at">!important</span><span class="op">;</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>            <span class="kw">background</span><span class="ch">:</span> <span class="bu">inherit</span> <span class="at">!important</span><span class="op">;</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>        }</span></code></pre></div>
<p>Isso deve garantir que qualquer elemento dentro de
<code>pre code</code> (como spans gerados pelo syntax highlighting)
herdem a cor e o fundo do <code>pre code</code>.</p>
<p>Al√©m disso, vamos fazer o mesmo para <code>code</code> (inline) para
garantir:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode css"><code class="sourceCode css"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>code <span class="op">*</span> {</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">color</span><span class="ch">:</span> <span class="bu">inherit</span> <span class="at">!important</span><span class="op">;</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">background</span><span class="ch">:</span> <span class="bu">inherit</span> <span class="at">!important</span><span class="op">;</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Mas note que o <code>code</code> inline pode ter fundo cinza e texto
vermelho, e n√£o queremos herdar o fundo do body. Ent√£o, talvez n√£o seja
uma boa ideia para o <code>code</code> inline.</p>
<p>Vamos restringir ao <code>pre code</code> e ver se resolve.</p>
<p>Outra possibilidade: o problema pode n√£o ser no c√≥digo, mas em outros
elementos. Se for um problema de syntax highlighting, a solu√ß√£o acima
deve ajudar.</p>
<p>Vamos implementar essa mudan√ßa e ver se resolve.</p>
<p>Altera√ß√£o no m√©todo <code>_inject_enhanced_css</code>:</p>
<p>No final do CSS, dentro da tag <style>, adicione:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode css"><code class="sourceCode css"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>        <span class="co">/* FOR√áAR HERAN√áA NO C√ìDIGO PARA EVITAR CORES INVIS√çVEIS */</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>        pre code <span class="op">*</span> {</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>            <span class="kw">color</span><span class="ch">:</span> <span class="bu">inherit</span> <span class="at">!important</span><span class="op">;</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>            <span class="kw">background</span><span class="ch">:</span> <span class="bu">inherit</span> <span class="at">!important</span><span class="op">;</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>        }</span></code></pre></div>
<p>Isso deve garantir que todo o texto dentro de um bloco de c√≥digo
tenha a mesma cor do bloco.</p>
<p>Se o problema for em outro elemento, precisaremos de mais
informa√ß√µes.</p>
<p>Vamos atualizar o c√≥digo accordingly.</p>
<p>Al√©m disso, note que o m√©todo
<code>_create_enhanced_html_template</code> tamb√©m tem seu pr√≥prio CSS.
Vamos adicionar a mesma regra nele, para o caso de estarmos usando o
fallback.</p>
<p>No m√©todo <code>_create_enhanced_html_template</code>, adicione a
mesma regra no CSS.</p>
<p>E no m√©todo <code>_create_basic_html</code>? Talvez, mas o basic HTML
n√£o usa syntax highlighting, ent√£o talvez n√£o seja necess√°rio.</p>
<p>Vamos focar nos dois primeiros.</p>
<p>Vou agora fornecer o c√≥digo modificado para o m√©todo
<code>_inject_enhanced_css</code> e
<code>_create_enhanced_html_template</code>.</p>
<p>No m√©todo <code>_inject_enhanced_css</code>:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _inject_enhanced_css(<span class="va">self</span>, html_content: <span class="bu">str</span>) <span class="op">-></span> <span class="bu">str</span>:</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Injeta CSS personalizado aprimorado para TOC flutuante e layout de tela completa"""</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>        enhanced_css <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="st">        <style></span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="st">            ... [todo o CSS anterior] ...</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="st">            /* FOR√áAR HERAN√áA NO C√ìDIGO PARA EVITAR CORES INVIS√çVEIS */</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="st">            pre code * {</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="st">                color: inherit !important;</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="st">                background: inherit !important;</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="st">        </style></span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="st">        """</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>        ... [restante do m√©todo] ...</span></code></pre></div>
<p>No m√©todo <code>_create_enhanced_html_template</code>:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _create_enhanced_html_template(<span class="va">self</span>, content: <span class="bu">str</span>, title: <span class="bu">str</span>) <span class="op">-></span> <span class="bu">str</span>:</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>        ... [c√≥digo anterior] ...</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>        <span class="op"><</span>style<span class="op">></span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>            ... [todo o CSS anterior] ...</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>            <span class="op">/*</span> FOR√áAR HERAN√áA NO C√ìDIGO PARA EVITAR CORES INVIS√çVEIS <span class="op">*/</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>            pre code <span class="op">*</span> {</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>                color: inherit <span class="op">!</span>important<span class="op">;</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>                background: inherit <span class="op">!</span>important<span class="op">;</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>        <span class="op"></</span>style<span class="op">></span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>        ... [restante do m√©todo] ...</span></code></pre></div>
<p>Vamos fazer essa altera√ß√£o e ver se resolve o problema.</p>
<p>Se n√£o resolver, talvez seja necess√°rio inspecionar o HTML gerado
para identificar o elemento problem√°tico.</p>
<p>Espero que isso ajude. O problema que voc√™ identificou √© comum em
convers√µes de Markdown para HTML quando h√° blocos de c√≥digo com syntax
highlighting. O Pandoc est√° aplicando classes CSS para syntax
highlighting que n√£o est√£o sendo estilizadas corretamente no seu CSS
personalizado.</p>
<p>Vou fornecer uma corre√ß√£o para o CSS que resolve o problema das cores
de texto invis√≠veis:</p>
<p><strong>Atualize o m√©todo <code>_inject_enhanced_css</code> no seu
c√≥digo:</strong></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> _inject_enhanced_css(<span class="va">self</span>, html_content: <span class="bu">str</span>) <span class="op">-></span> <span class="bu">str</span>:</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Injeta CSS personalizado aprimorado para TOC flutuante e layout de tela completa"""</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    enhanced_css <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="st">    <style></span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="st">        /* [MANTENHA TODO O CSS EXISTENTE...] */</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="st">        /* CORRE√á√ÉO CR√çTICA: Syntax highlighting do Pandoc */</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="st">        .sourceCode { </span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="st">            background: #2d2d2d !important; </span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="st">            color: #f8f8f2 !important;</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="st">        /* Garantir que TODO o texto dentro de pre/code seja vis√≠vel */</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a><span class="st">        pre, code, .sourceCode, .sourceCode pre, .sourceCode code {</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a><span class="st">            color: #f8f8f2 !important;</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a><span class="st">            background-color: #2d2d2d !important;</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a><span class="st">        /* Corre√ß√£o para spans de syntax highlighting */</span></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a><span class="st">        .sourceCode .kw { color: #ff79c6 !important; } /* keywords */</span></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a><span class="st">        .sourceCode .dt { color: #8be9fd !important; } /* types */</span></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a><span class="st">        .sourceCode .dv { color: #bd93f9 !important; } /* values */</span></span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a><span class="st">        .sourceCode .bn { color: #bd93f9 !important; } /* numbers */</span></span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a><span class="st">        .sourceCode .fl { color: #bd93f9 !important; } /* floats */</span></span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a><span class="st">        .sourceCode .ch { color: #f1fa8c !important; } /* chars */</span></span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a><span class="st">        .sourceCode .st { color: #f1fa8c !important; } /* strings */</span></span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a><span class="st">        .sourceCode .co { color: #6272a4 !important; } /* comments */</span></span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a><span class="st">        .sourceCode .ot { color: #50fa7b !important; } /* other */</span></span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a><span class="st">        .sourceCode .al { color: #ff5555 !important; } /* alerts */</span></span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a><span class="st">        .sourceCode .fu { color: #50fa7b !important; } /* functions */</span></span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a><span class="st">        .sourceCode .re { color: #f1fa8c !important; } /* regex */</span></span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a><span class="st">        .sourceCode .er { color: #ff5555 !important; } /* errors */</span></span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a><span class="st">        /* Garantir que texto normal em blocos de c√≥digo seja vis√≠vel */</span></span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a><span class="st">        .sourceCode span {</span></span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a><span class="st">            color: #f8f8f2 !important;</span></span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a><span class="st">            background: transparent !important;</span></span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb21-40"><a href="#cb21-40" aria-hidden="true" tabindex="-1"></a><span class="st">        /* Fallback para qualquer elemento de c√≥digo n√£o estilizado */</span></span>
<span id="cb21-41"><a href="#cb21-41" aria-hidden="true" tabindex="-1"></a><span class="st">        .sourceCode * {</span></span>
<span id="cb21-42"><a href="#cb21-42" aria-hidden="true" tabindex="-1"></a><span class="st">            color: inherit !important;</span></span>
<span id="cb21-43"><a href="#cb21-43" aria-hidden="true" tabindex="-1"></a><span class="st">            background: transparent !important;</span></span>
<span id="cb21-44"><a href="#cb21-44" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb21-45"><a href="#cb21-45" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb21-46"><a href="#cb21-46" aria-hidden="true" tabindex="-1"></a><span class="st">        /* Corre√ß√£o adicional para blocos de c√≥digo gerais */</span></span>
<span id="cb21-47"><a href="#cb21-47" aria-hidden="true" tabindex="-1"></a><span class="st">        div.sourceCode {</span></span>
<span id="cb21-48"><a href="#cb21-48" aria-hidden="true" tabindex="-1"></a><span class="st">            border-left: 4px solid #3498db;</span></span>
<span id="cb21-49"><a href="#cb21-49" aria-hidden="true" tabindex="-1"></a><span class="st">            background: #2d2d2d !important;</span></span>
<span id="cb21-50"><a href="#cb21-50" aria-hidden="true" tabindex="-1"></a><span class="st">            color: #f8f8f2 !important;</span></span>
<span id="cb21-51"><a href="#cb21-51" aria-hidden="true" tabindex="-1"></a><span class="st">            margin: 1.5em 0;</span></span>
<span id="cb21-52"><a href="#cb21-52" aria-hidden="true" tabindex="-1"></a><span class="st">            border-radius: 8px;</span></span>
<span id="cb21-53"><a href="#cb21-53" aria-hidden="true" tabindex="-1"></a><span class="st">            overflow: hidden;</span></span>
<span id="cb21-54"><a href="#cb21-54" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb21-55"><a href="#cb21-55" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb21-56"><a href="#cb21-56" aria-hidden="true" tabindex="-1"></a><span class="st">        div.sourceCode pre {</span></span>
<span id="cb21-57"><a href="#cb21-57" aria-hidden="true" tabindex="-1"></a><span class="st">            margin: 0;</span></span>
<span id="cb21-58"><a href="#cb21-58" aria-hidden="true" tabindex="-1"></a><span class="st">            padding: 20px;</span></span>
<span id="cb21-59"><a href="#cb21-59" aria-hidden="true" tabindex="-1"></a><span class="st">            background: transparent !important;</span></span>
<span id="cb21-60"><a href="#cb21-60" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb21-61"><a href="#cb21-61" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb21-62"><a href="#cb21-62" aria-hidden="true" tabindex="-1"></a><span class="st">        /* Melhorar contraste para texto normal em todas as situa√ß√µes */</span></span>
<span id="cb21-63"><a href="#cb21-63" aria-hidden="true" tabindex="-1"></a><span class="st">        body, .container, .main-content {</span></span>
<span id="cb21-64"><a href="#cb21-64" aria-hidden="true" tabindex="-1"></a><span class="st">            color: #2c3e50 !important;</span></span>
<span id="cb21-65"><a href="#cb21-65" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb21-66"><a href="#cb21-66" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb21-67"><a href="#cb21-67" aria-hidden="true" tabindex="-1"></a><span class="st">        p, li, td, th, div, span {</span></span>
<span id="cb21-68"><a href="#cb21-68" aria-hidden="true" tabindex="-1"></a><span class="st">            color: #2c3e50 !important;</span></span>
<span id="cb21-69"><a href="#cb21-69" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb21-70"><a href="#cb21-70" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb21-71"><a href="#cb21-71" aria-hidden="true" tabindex="-1"></a><span class="st">        /* Garantir que links sejam vis√≠veis */</span></span>
<span id="cb21-72"><a href="#cb21-72" aria-hidden="true" tabindex="-1"></a><span class="st">        a {</span></span>
<span id="cb21-73"><a href="#cb21-73" aria-hidden="true" tabindex="-1"></a><span class="st">            color: #3498db !important;</span></span>
<span id="cb21-74"><a href="#cb21-74" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb21-75"><a href="#cb21-75" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb21-76"><a href="#cb21-76" aria-hidden="true" tabindex="-1"></a><span class="st">        a:hover {</span></span>
<span id="cb21-77"><a href="#cb21-77" aria-hidden="true" tabindex="-1"></a><span class="st">            color: #2980b9 !important;</span></span>
<span id="cb21-78"><a href="#cb21-78" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb21-79"><a href="#cb21-79" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb21-80"><a href="#cb21-80" aria-hidden="true" tabindex="-1"></a><span class="st">        /* Corre√ß√£o para elementos MathJax */</span></span>
<span id="cb21-81"><a href="#cb21-81" aria-hidden="true" tabindex="-1"></a><span class="st">        .math, .math display, mjx-container {</span></span>
<span id="cb21-82"><a href="#cb21-82" aria-hidden="true" tabindex="-1"></a><span class="st">            color: #2c3e50 !important;</span></span>
<span id="cb21-83"><a href="#cb21-83" aria-hidden="true" tabindex="-1"></a><span class="st">            background: transparent !important;</span></span>
<span id="cb21-84"><a href="#cb21-84" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb21-85"><a href="#cb21-85" aria-hidden="true" tabindex="-1"></a><span class="st">    </style></span></span>
<span id="cb21-86"><a href="#cb21-86" aria-hidden="true" tabindex="-1"></a><span class="st">    """</span></span>
<span id="cb21-87"><a href="#cb21-87" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-88"><a href="#cb21-88" aria-hidden="true" tabindex="-1"></a>    <span class="co"># [MANTENHA O RESTO DO M√âTODO INALTERADO...]</span></span></code></pre></div>
<p><strong>Tamb√©m atualize o m√©todo
<code>_create_enhanced_html_template</code> com as mesmas
corre√ß√µes:</strong></p>
<p>Adicione este CSS no template enhanced (procure a se√ß√£o de estilo e
adicione estas regras):</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode css"><code class="sourceCode css"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* CORRE√á√ÉO CR√çTICA: Garantir visibilidade do texto */</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">.sourceCode</span><span class="op">,</span> pre<span class="op">,</span> code {</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">color</span><span class="ch">:</span> <span class="cn">#f8f8f2</span> <span class="at">!important</span><span class="op">;</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">background-color</span><span class="ch">:</span> <span class="cn">#2d2d2d</span> <span class="at">!important</span><span class="op">;</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="fu">.sourceCode</span> span {</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">color</span><span class="ch">:</span> <span class="cn">#f8f8f2</span> <span class="at">!important</span><span class="op">;</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">background</span><span class="ch">:</span> <span class="dv">transparent</span> <span class="at">!important</span><span class="op">;</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a><span class="co">/* Corre√ß√£o para syntax highlighting */</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="fu">.sourceCode</span> <span class="fu">.kw</span> { <span class="kw">color</span><span class="ch">:</span> <span class="cn">#ff79c6</span> <span class="at">!important</span><span class="op">;</span> }</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a><span class="fu">.sourceCode</span> <span class="fu">.dt</span> { <span class="kw">color</span><span class="ch">:</span> <span class="cn">#8be9fd</span> <span class="at">!important</span><span class="op">;</span> }</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a><span class="fu">.sourceCode</span> <span class="fu">.dv</span> { <span class="kw">color</span><span class="ch">:</span> <span class="cn">#bd93f9</span> <span class="at">!important</span><span class="op">;</span> }</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a><span class="fu">.sourceCode</span> <span class="fu">.bn</span> { <span class="kw">color</span><span class="ch">:</span> <span class="cn">#bd93f9</span> <span class="at">!important</span><span class="op">;</span> }</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a><span class="fu">.sourceCode</span> <span class="fu">.fl</span> { <span class="kw">color</span><span class="ch">:</span> <span class="cn">#bd93f9</span> <span class="at">!important</span><span class="op">;</span> }</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a><span class="fu">.sourceCode</span> <span class="fu">.ch</span> { <span class="kw">color</span><span class="ch">:</span> <span class="cn">#f1fa8c</span> <span class="at">!important</span><span class="op">;</span> }</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a><span class="fu">.sourceCode</span> <span class="fu">.st</span> { <span class="kw">color</span><span class="ch">:</span> <span class="cn">#f1fa8c</span> <span class="at">!important</span><span class="op">;</span> }</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a><span class="fu">.sourceCode</span> <span class="fu">.co</span> { <span class="kw">color</span><span class="ch">:</span> <span class="cn">#6272a4</span> <span class="at">!important</span><span class="op">;</span> }</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a><span class="fu">.sourceCode</span> <span class="fu">.ot</span> { <span class="kw">color</span><span class="ch">:</span> <span class="cn">#50fa7b</span> <span class="at">!important</span><span class="op">;</span> }</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a><span class="fu">.sourceCode</span> <span class="fu">.al</span> { <span class="kw">color</span><span class="ch">:</span> <span class="cn">#ff5555</span> <span class="at">!important</span><span class="op">;</span> }</span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a><span class="fu">.sourceCode</span> <span class="fu">.fu</span> { <span class="kw">color</span><span class="ch">:</span> <span class="cn">#50fa7b</span> <span class="at">!important</span><span class="op">;</span> }</span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a><span class="fu">.sourceCode</span> <span class="fu">.re</span> { <span class="kw">color</span><span class="ch">:</span> <span class="cn">#f1fa8c</span> <span class="at">!important</span><span class="op">;</span> }</span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a><span class="fu">.sourceCode</span> <span class="fu">.er</span> { <span class="kw">color</span><span class="ch">:</span> <span class="cn">#ff5555</span> <span class="at">!important</span><span class="op">;</span> }</span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a><span class="co">/* Garantir contraste para texto normal */</span></span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>body<span class="op">,</span> <span class="fu">.container</span> {</span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a>    <span class="kw">color</span><span class="ch">:</span> <span class="cn">#2c3e50</span> <span class="at">!important</span><span class="op">;</span></span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a>p<span class="op">,</span> li<span class="op">,</span> td<span class="op">,</span> th {</span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a>    <span class="kw">color</span><span class="ch">:</span> <span class="cn">#2c3e50</span> <span class="at">!important</span><span class="op">;</span></span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><strong>E no m√©todo <code>_create_basic_html</code>,
adicione:</strong></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode css"><code class="sourceCode css"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* Corre√ß√£o b√°sica para garantir visibilidade */</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>pre<span class="op">,</span> code {</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">color</span><span class="ch">:</span> <span class="cn">#333</span> <span class="at">!important</span><span class="op">;</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">background</span><span class="ch">:</span> <span class="cn">white</span> <span class="at">!important</span><span class="op">;</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>body {</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">color</span><span class="ch">:</span> <span class="cn">#333</span> <span class="at">!important</span><span class="op">;</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><strong>Problemas espec√≠ficos que estas corre√ß√µes
resolvem:</strong></p>
<ol type="1">
<li><strong>Syntax Highlighting do Pandoc</strong>: O Pandoc gera
classes CSS como <code>.sourceCode</code>, <code>.kw</code>,
<code>.dt</code>, etc., que n√£o estavam sendo estilizadas</li>
<li><strong>Fundo escuro com texto escuro</strong>: Garante que o texto
em blocos de c√≥digo escuros seja claro</li>
<li><strong>Heran√ßa de cores</strong>: For√ßa cores espec√≠ficas com
<code>!important</code> para sobrescrever estilos problem√°ticos</li>
<li><strong>Contraste geral</strong>: Garante que todo texto normal
tenha contraste adequado</li>
</ol>
<p><strong>Execute novamente o script</strong> e os arquivos HTML
gerados devem ter todo o texto vis√≠vel com cores adequadas. O problema
espec√≠fico que voc√™ mencionou (texto com a mesma cor do background) ser√°
resolvido pelas regras <code>!important</code> que for√ßam cores
contrastantes.</p>
<p>Se ainda houver problemas espec√≠ficos em alguns arquivos, me avise e
posso fornecer corre√ß√µes mais direcionadas.</p>
<hr></hr>
<h3 data-number="1.2.3" id="utilizador-2025-11-08-075154-deepseek-reasoner"><span class="header-section-number">1.2.3</span> üë§ Utilizador <em>(2025-11-08
07:51:54)</em> <em>[deepseek-reasoner]</em></h3>
<p>Pretendo um comb_fragments_system5_html_export.py completo e
funcional</p>
<hr></hr>
<h3 data-number="1.2.4" id="deepseek-2025-11-08-075154-deepseek-reasoner"><span class="header-section-number">1.2.4</span> ü§ñ DeepSeek <em>(2025-11-08
07:51:54)</em> <em>[deepseek-reasoner]</em></h3>
<p>Vamos corrigir o problema de cores no HTML gerado, garantindo que
todo o texto seja vis√≠vel. O problema principal √© que o Pandoc gera
classes para syntax highlighting que n√£o est√£o sendo estilizadas no
nosso CSS. Vamos adicionar regras CSS para todas essas classes,
garantindo contraste adequado.</p>
<p>Al√©m disso, vamos ajustar o CSS para garantir que o texto normal
(fora de blocos de c√≥digo) tamb√©m tenha boa legibilidade.</p>
<p>Vou fornecer o c√≥digo completo do arquivo com as corre√ß√µes
necess√°rias. As principais altera√ß√µes ser√£o:</p>
<ol type="1">
<li>Adicionar regras CSS para as classes de syntax highlighting do
Pandoc (como .kw, .dt, .dv, etc.) no m√©todo
<code>_inject_enhanced_css</code>.</li>
<li>Garantir que os blocos de c√≥digo tenham fundo escuro e texto
claro.</li>
<li>Garantir que o texto normal tenha contraste adequado (preto ou cinza
escuro sobre fundo branco).</li>
</ol>
<p>Vou tamb√©m ajustar o m√©todo
<code>_create_enhanced_html_template</code> e
<code>_create_basic_html</code> para incluir as mesmas corre√ß√µes.</p>
<p>Como o c√≥digo √© muito longo, vou focar nas partes que foram
alteradas. No entanto, fornecerei o arquivo completo para garantir que
n√£o haja erros de integra√ß√£o.</p>
<p>Aqui est√° o c√≥digo completo do
<code>comb_fragments_system5_html_export.py</code> com as corre√ß√µes:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># comb_fragments_system5_html_export.py</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> zipfile</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> csv</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> argparse</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sys</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> webbrowser</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> shutil</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tempfile</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> traceback</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> subprocess</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Any, Optional</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> markdown</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> logging</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> CombinedFragmentsSystem:</span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, dry_run<span class="op">=</span><span class="va">False</span>, force_overwrite<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.data_dir <span class="op">=</span> Path(<span class="st">"data"</span>)</span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.dry_run <span class="op">=</span> dry_run</span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.force_overwrite <span class="op">=</span> force_overwrite</span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Configurar logging</span></span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>        logging.basicConfig(level<span class="op">=</span>logging.INFO, <span class="bu">format</span><span class="op">=</span><span class="st">'</span><span class="sc">%(asctime)s</span><span class="st"> - </span><span class="sc">%(levelname)s</span><span class="st"> - </span><span class="sc">%(message)s</span><span class="st">'</span>)</span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.logger <span class="op">=</span> logging.getLogger(<span class="va">__name__</span>)</span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Estrutura de pastas organizada</span></span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.output_dirs <span class="op">=</span> {</span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a>            <span class="st">'markdown'</span>: <span class="st">"combined_markdown"</span>,</span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a>            <span class="st">'csv'</span>: <span class="st">"combined_csv"</span>, </span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a>            <span class="st">'json'</span>: <span class="st">"combined_json"</span>,</span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a>            <span class="st">'pdfs'</span>: <span class="st">"combined_pdfs"</span>,</span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a>            <span class="st">'html'</span>: <span class="st">"combined_html"</span></span>
<span id="cb24-37"><a href="#cb24-37" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb24-38"><a href="#cb24-38" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-39"><a href="#cb24-39" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.single_files <span class="op">=</span> {</span>
<span id="cb24-40"><a href="#cb24-40" aria-hidden="true" tabindex="-1"></a>            <span class="st">'csv'</span>: <span class="st">"combined_all_conversations.csv"</span>,</span>
<span id="cb24-41"><a href="#cb24-41" aria-hidden="true" tabindex="-1"></a>            <span class="st">'json'</span>: <span class="st">"combined_all_conversations.json"</span></span>
<span id="cb24-42"><a href="#cb24-42" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb24-43"><a href="#cb24-43" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-44"><a href="#cb24-44" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.index_file <span class="op">=</span> <span class="st">"index.html"</span></span>
<span id="cb24-45"><a href="#cb24-45" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.all_conversations <span class="op">=</span> []</span>
<span id="cb24-46"><a href="#cb24-46" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-47"><a href="#cb24-47" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Configura√ß√£o de processamento por fonte</span></span>
<span id="cb24-48"><a href="#cb24-48" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.processors <span class="op">=</span> {</span>
<span id="cb24-49"><a href="#cb24-49" aria-hidden="true" tabindex="-1"></a>            <span class="st">'qwen'</span>: {</span>
<span id="cb24-50"><a href="#cb24-50" aria-hidden="true" tabindex="-1"></a>                <span class="st">'file'</span>: <span class="st">"chat-export.json"</span>,</span>
<span id="cb24-51"><a href="#cb24-51" aria-hidden="true" tabindex="-1"></a>                <span class="st">'method'</span>: <span class="va">self</span>.process_qwen_corrected,</span>
<span id="cb24-52"><a href="#cb24-52" aria-hidden="true" tabindex="-1"></a>                <span class="st">'enabled'</span>: <span class="va">True</span></span>
<span id="cb24-53"><a href="#cb24-53" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb24-54"><a href="#cb24-54" aria-hidden="true" tabindex="-1"></a>            <span class="st">'chatgpt'</span>: {</span>
<span id="cb24-55"><a href="#cb24-55" aria-hidden="true" tabindex="-1"></a>                <span class="st">'file'</span>: <span class="st">"chatgpt.zip"</span>, </span>
<span id="cb24-56"><a href="#cb24-56" aria-hidden="true" tabindex="-1"></a>                <span class="st">'method'</span>: <span class="va">self</span>.process_chatgpt,</span>
<span id="cb24-57"><a href="#cb24-57" aria-hidden="true" tabindex="-1"></a>                <span class="st">'enabled'</span>: <span class="va">True</span></span>
<span id="cb24-58"><a href="#cb24-58" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb24-59"><a href="#cb24-59" aria-hidden="true" tabindex="-1"></a>            <span class="st">'deepseek'</span>: {</span>
<span id="cb24-60"><a href="#cb24-60" aria-hidden="true" tabindex="-1"></a>                <span class="st">'file'</span>: <span class="st">"deepseek_data.zip"</span>,</span>
<span id="cb24-61"><a href="#cb24-61" aria-hidden="true" tabindex="-1"></a>                <span class="st">'method'</span>: <span class="va">self</span>.process_deepseek,</span>
<span id="cb24-62"><a href="#cb24-62" aria-hidden="true" tabindex="-1"></a>                <span class="st">'enabled'</span>: <span class="va">True</span></span>
<span id="cb24-63"><a href="#cb24-63" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb24-64"><a href="#cb24-64" aria-hidden="true" tabindex="-1"></a>            <span class="st">'grok'</span>: {</span>
<span id="cb24-65"><a href="#cb24-65" aria-hidden="true" tabindex="-1"></a>                <span class="st">'file'</span>: <span class="st">"grok.zip"</span>,</span>
<span id="cb24-66"><a href="#cb24-66" aria-hidden="true" tabindex="-1"></a>                <span class="st">'method'</span>: <span class="va">self</span>.process_grok,</span>
<span id="cb24-67"><a href="#cb24-67" aria-hidden="true" tabindex="-1"></a>                <span class="st">'enabled'</span>: <span class="va">True</span></span>
<span id="cb24-68"><a href="#cb24-68" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb24-69"><a href="#cb24-69" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb24-70"><a href="#cb24-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-71"><a href="#cb24-71" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> sanitize_filename(<span class="va">self</span>, text: <span class="bu">str</span>, max_len: <span class="bu">int</span> <span class="op">=</span> <span class="dv">50</span>) <span class="op">-></span> <span class="bu">str</span>:</span>
<span id="cb24-72"><a href="#cb24-72" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Sanitiza nomes de arquivo REMOVENDO ESPA√áOS e preservando emojis"""</span></span>
<span id="cb24-73"><a href="#cb24-73" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> text <span class="kw">or</span> <span class="kw">not</span> <span class="bu">isinstance</span>(text, <span class="bu">str</span>):</span>
<span id="cb24-74"><a href="#cb24-74" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">"conversa_sem_titulo"</span></span>
<span id="cb24-75"><a href="#cb24-75" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-76"><a href="#cb24-76" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Remove caracteres inv√°lidos</span></span>
<span id="cb24-77"><a href="#cb24-77" aria-hidden="true" tabindex="-1"></a>        invalid_chars <span class="op">=</span> <span class="vs">r'</span><span class="pp">[<>:"/</span><span class="ch">\\</span><span class="pp">|?*</span><span class="ch">\x00</span><span class="pp">-</span><span class="ch">\x1F\x7F</span><span class="dv">\s</span><span class="pp">]</span><span class="vs">'</span>  <span class="co"># Inclui \s para remover espa√ßos</span></span>
<span id="cb24-78"><a href="#cb24-78" aria-hidden="true" tabindex="-1"></a>        sanitized <span class="op">=</span> re.sub(invalid_chars, <span class="st">'_'</span>, text)  <span class="co"># Substitui espa√ßos por underscores</span></span>
<span id="cb24-79"><a href="#cb24-79" aria-hidden="true" tabindex="-1"></a>        sanitized <span class="op">=</span> re.sub(<span class="vs">r'_</span><span class="op">+</span><span class="vs">'</span>, <span class="st">'_'</span>, sanitized)  <span class="co"># Remove underscores duplicados</span></span>
<span id="cb24-80"><a href="#cb24-80" aria-hidden="true" tabindex="-1"></a>        sanitized <span class="op">=</span> sanitized.strip(<span class="st">'_'</span>)  <span class="co"># Remove underscores no in√≠cio e fim</span></span>
<span id="cb24-81"><a href="#cb24-81" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-82"><a href="#cb24-82" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> sanitized:</span>
<span id="cb24-83"><a href="#cb24-83" aria-hidden="true" tabindex="-1"></a>            sanitized <span class="op">=</span> <span class="st">"conversa_sem_titulo"</span></span>
<span id="cb24-84"><a href="#cb24-84" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-85"><a href="#cb24-85" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Limita o comprimento</span></span>
<span id="cb24-86"><a href="#cb24-86" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(sanitized) <span class="op">></span> max_len:</span>
<span id="cb24-87"><a href="#cb24-87" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Tenta cortar em um ponto l√≥gico (underscore)</span></span>
<span id="cb24-88"><a href="#cb24-88" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="st">'_'</span> <span class="kw">in</span> sanitized[:max_len]:</span>
<span id="cb24-89"><a href="#cb24-89" aria-hidden="true" tabindex="-1"></a>                last_underscore <span class="op">=</span> sanitized[:max_len].rfind(<span class="st">'_'</span>)</span>
<span id="cb24-90"><a href="#cb24-90" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> last_underscore <span class="op">></span> <span class="dv">10</span>:</span>
<span id="cb24-91"><a href="#cb24-91" aria-hidden="true" tabindex="-1"></a>                    sanitized <span class="op">=</span> sanitized[:last_underscore]</span>
<span id="cb24-92"><a href="#cb24-92" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb24-93"><a href="#cb24-93" aria-hidden="true" tabindex="-1"></a>                sanitized <span class="op">=</span> sanitized[:max_len]</span>
<span id="cb24-94"><a href="#cb24-94" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-95"><a href="#cb24-95" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> sanitized</span>
<span id="cb24-96"><a href="#cb24-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-97"><a href="#cb24-97" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> preserve_original_title(<span class="va">self</span>, text: <span class="bu">str</span>) <span class="op">-></span> <span class="bu">str</span>:</span>
<span id="cb24-98"><a href="#cb24-98" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Preserva o t√≠tulo original com espa√ßos, apenas removendo caracteres realmente inv√°lidos"""</span></span>
<span id="cb24-99"><a href="#cb24-99" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> text <span class="kw">or</span> <span class="kw">not</span> <span class="bu">isinstance</span>(text, <span class="bu">str</span>):</span>
<span id="cb24-100"><a href="#cb24-100" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">"Conversa sem t√≠tulo"</span></span>
<span id="cb24-101"><a href="#cb24-101" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-102"><a href="#cb24-102" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Remove apenas caracteres realmente problem√°ticos, mantendo espa√ßos</span></span>
<span id="cb24-103"><a href="#cb24-103" aria-hidden="true" tabindex="-1"></a>        invalid_chars <span class="op">=</span> <span class="vs">r'</span><span class="pp">[<>:"/</span><span class="ch">\\</span><span class="pp">|?*</span><span class="ch">\x00</span><span class="pp">-</span><span class="ch">\x1F\x7F</span><span class="pp">]</span><span class="vs">'</span></span>
<span id="cb24-104"><a href="#cb24-104" aria-hidden="true" tabindex="-1"></a>        sanitized <span class="op">=</span> re.sub(invalid_chars, <span class="st">''</span>, text)</span>
<span id="cb24-105"><a href="#cb24-105" aria-hidden="true" tabindex="-1"></a>        sanitized <span class="op">=</span> re.sub(<span class="vs">r'</span><span class="dv">\s</span><span class="op">+</span><span class="vs">'</span>, <span class="st">' '</span>, sanitized.strip())</span>
<span id="cb24-106"><a href="#cb24-106" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-107"><a href="#cb24-107" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> sanitized:</span>
<span id="cb24-108"><a href="#cb24-108" aria-hidden="true" tabindex="-1"></a>            sanitized <span class="op">=</span> <span class="st">"Conversa sem t√≠tulo"</span></span>
<span id="cb24-109"><a href="#cb24-109" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-110"><a href="#cb24-110" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> sanitized</span>
<span id="cb24-111"><a href="#cb24-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-112"><a href="#cb24-112" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> preserve_special_content(<span class="va">self</span>, content: <span class="bu">str</span>) <span class="op">-></span> <span class="bu">str</span>:</span>
<span id="cb24-113"><a href="#cb24-113" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Preserva f√≥rmulas matem√°ticas, c√≥digo e formata√ß√£o especial"""</span></span>
<span id="cb24-114"><a href="#cb24-114" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> content:</span>
<span id="cb24-115"><a href="#cb24-115" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">""</span></span>
<span id="cb24-116"><a href="#cb24-116" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-117"><a href="#cb24-117" aria-hidden="true" tabindex="-1"></a>        preserved_content <span class="op">=</span> content</span>
<span id="cb24-118"><a href="#cb24-118" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-119"><a href="#cb24-119" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Corrige problemas com barras invertidas em LaTeX</span></span>
<span id="cb24-120"><a href="#cb24-120" aria-hidden="true" tabindex="-1"></a>        latex_corrections <span class="op">=</span> {</span>
<span id="cb24-121"><a href="#cb24-121" aria-hidden="true" tabindex="-1"></a>            <span class="st">'√¢¬ô¬Ärac'</span>: <span class="st">'</span><span class="ch">\\</span><span class="st">frac'</span>,</span>
<span id="cb24-122"><a href="#cb24-122" aria-hidden="true" tabindex="-1"></a>            <span class="st">'√¢¬ô¬Çarepsilon'</span>: <span class="st">'</span><span class="ch">\\</span><span class="st">varepsilon'</span>,</span>
<span id="cb24-123"><a href="#cb24-123" aria-hidden="true" tabindex="-1"></a>            <span class="st">'√¢¬ô¬Ç'</span>: <span class="st">'</span><span class="ch">\\</span><span class="st">'</span>,</span>
<span id="cb24-124"><a href="#cb24-124" aria-hidden="true" tabindex="-1"></a>            <span class="st">'√¢¬ô¬Ä'</span>: <span class="st">'</span><span class="ch">\\</span><span class="st">'</span></span>
<span id="cb24-125"><a href="#cb24-125" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb24-126"><a href="#cb24-126" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-127"><a href="#cb24-127" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> wrong, correct <span class="kw">in</span> latex_corrections.items():</span>
<span id="cb24-128"><a href="#cb24-128" aria-hidden="true" tabindex="-1"></a>            preserved_content <span class="op">=</span> preserved_content.replace(wrong, correct)</span>
<span id="cb24-129"><a href="#cb24-129" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-130"><a href="#cb24-130" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> preserved_content</span>
<span id="cb24-131"><a href="#cb24-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-132"><a href="#cb24-132" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> ensure_directories(<span class="va">self</span>):</span>
<span id="cb24-133"><a href="#cb24-133" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Cria todas as pastas necess√°rias"""</span></span>
<span id="cb24-134"><a href="#cb24-134" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb24-135"><a href="#cb24-135" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="st">"DRY-RUN: Pastas seriam criadas:"</span>)</span>
<span id="cb24-136"><a href="#cb24-136" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> folder <span class="kw">in</span> <span class="va">self</span>.output_dirs.values():</span>
<span id="cb24-137"><a href="#cb24-137" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.info(<span class="ss">f"   </span><span class="sc">{</span>folder<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb24-138"><a href="#cb24-138" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb24-139"><a href="#cb24-139" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-140"><a href="#cb24-140" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> folder <span class="kw">in</span> <span class="va">self</span>.output_dirs.values():</span>
<span id="cb24-141"><a href="#cb24-141" aria-hidden="true" tabindex="-1"></a>            Path(folder).mkdir(parents<span class="op">=</span><span class="va">True</span>, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb24-142"><a href="#cb24-142" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="ss">f"Pasta criada: </span><span class="sc">{</span>folder<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb24-143"><a href="#cb24-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-144"><a href="#cb24-144" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> run(<span class="va">self</span>):</span>
<span id="cb24-145"><a href="#cb24-145" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Executa o processamento completo"""</span></span>
<span id="cb24-146"><a href="#cb24-146" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.logger.info(<span class="st">"SISTEMA COMBINADO DE EXPORTA√á√ïES COM HTML (Qwen3, ChatGPT, DeepSeek, Grok)"</span>)</span>
<span id="cb24-147"><a href="#cb24-147" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.logger.info(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb24-148"><a href="#cb24-148" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-149"><a href="#cb24-149" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.data_dir.exists():</span>
<span id="cb24-150"><a href="#cb24-150" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.error(<span class="ss">f"Pasta '</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>data_dir<span class="sc">}</span><span class="ss">' n√£o encontrada."</span>)</span>
<span id="cb24-151"><a href="#cb24-151" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="st">"Crie a pasta 'data' e coloque os arquivos de exporta√ß√£o:"</span>)</span>
<span id="cb24-152"><a href="#cb24-152" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> source_name, config <span class="kw">in</span> <span class="va">self</span>.processors.items():</span>
<span id="cb24-153"><a href="#cb24-153" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.info(<span class="ss">f"   - </span><span class="sc">{</span>config[<span class="st">'file'</span>]<span class="sc">}</span><span class="ss"> (para </span><span class="sc">{</span>source_name<span class="sc">.</span>upper()<span class="sc">}</span><span class="ss">)"</span>)</span>
<span id="cb24-154"><a href="#cb24-154" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb24-155"><a href="#cb24-155" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-156"><a href="#cb24-156" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.logger.info(<span class="ss">f"Usando pasta de dados: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>data_dir<span class="sc">.</span>absolute()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb24-157"><a href="#cb24-157" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-158"><a href="#cb24-158" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.ensure_directories()</span>
<span id="cb24-159"><a href="#cb24-159" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-160"><a href="#cb24-160" aria-hidden="true" tabindex="-1"></a>        processed_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb24-161"><a href="#cb24-161" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> source_name, config <span class="kw">in</span> <span class="va">self</span>.processors.items():</span>
<span id="cb24-162"><a href="#cb24-162" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> config[<span class="st">'enabled'</span>]:</span>
<span id="cb24-163"><a href="#cb24-163" aria-hidden="true" tabindex="-1"></a>                file_path <span class="op">=</span> <span class="va">self</span>.data_dir <span class="op">/</span> config[<span class="st">'file'</span>]</span>
<span id="cb24-164"><a href="#cb24-164" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> file_path.exists():</span>
<span id="cb24-165"><a href="#cb24-165" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.logger.info(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Processando </span><span class="sc">{</span>source_name<span class="sc">.</span>upper()<span class="sc">}</span><span class="ss">..."</span>)</span>
<span id="cb24-166"><a href="#cb24-166" aria-hidden="true" tabindex="-1"></a>                    config[<span class="st">'method'</span>](file_path)</span>
<span id="cb24-167"><a href="#cb24-167" aria-hidden="true" tabindex="-1"></a>                    processed_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb24-168"><a href="#cb24-168" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb24-169"><a href="#cb24-169" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.logger.warning(<span class="ss">f"</span><span class="sc">{</span>source_name<span class="sc">.</span>upper()<span class="sc">}</span><span class="ss">: arquivo n√£o encontrado - </span><span class="sc">{</span>file_path<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb24-170"><a href="#cb24-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-171"><a href="#cb24-171" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> processed_count <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb24-172"><a href="#cb24-172" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.error(<span class="st">"Nenhum arquivo de exporta√ß√£o encontrado na pasta 'data'."</span>)</span>
<span id="cb24-173"><a href="#cb24-173" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb24-174"><a href="#cb24-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-175"><a href="#cb24-175" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb24-176"><a href="#cb24-176" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.error(<span class="st">"Nenhuma conversa foi extra√≠da dos arquivos."</span>)</span>
<span id="cb24-177"><a href="#cb24-177" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb24-178"><a href="#cb24-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-179"><a href="#cb24-179" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>._post_process_conversations()</span>
<span id="cb24-180"><a href="#cb24-180" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-181"><a href="#cb24-181" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.dry_run:</span>
<span id="cb24-182"><a href="#cb24-182" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>._export_all_formats()</span>
<span id="cb24-183"><a href="#cb24-183" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">üéâ SISTEMA COMBINADO FINALIZADO!"</span>)</span>
<span id="cb24-184"><a href="#cb24-184" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="ss">f"üìÑ √çndice: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>index_file<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb24-185"><a href="#cb24-185" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> Path(<span class="va">self</span>.index_file).exists():</span>
<span id="cb24-186"><a href="#cb24-186" aria-hidden="true" tabindex="-1"></a>                webbrowser.<span class="bu">open</span>(<span class="ss">f'file://</span><span class="sc">{</span>Path(<span class="va">self</span>.index_file)<span class="sc">.</span>absolute()<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb24-187"><a href="#cb24-187" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb24-188"><a href="#cb24-188" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">üîÆ MODO DRY-RUN: Nenhum arquivo foi criado."</span>)</span>
<span id="cb24-189"><a href="#cb24-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-190"><a href="#cb24-190" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _post_process_conversations(<span class="va">self</span>):</span>
<span id="cb24-191"><a href="#cb24-191" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Processamento p√≥s-extra√ß√£o das conversas"""</span></span>
<span id="cb24-192"><a href="#cb24-192" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.all_conversations.sort(</span>
<span id="cb24-193"><a href="#cb24-193" aria-hidden="true" tabindex="-1"></a>            key<span class="op">=</span><span class="kw">lambda</span> x: <span class="va">self</span>.parse_timestamp_for_sorting(</span>
<span id="cb24-194"><a href="#cb24-194" aria-hidden="true" tabindex="-1"></a>                x.get(<span class="st">'updated_at'</span>) <span class="kw">or</span> x.get(<span class="st">'inserted_at'</span>) <span class="kw">or</span> x.get(<span class="st">'created_at'</span>)</span>
<span id="cb24-195"><a href="#cb24-195" aria-hidden="true" tabindex="-1"></a>            ),</span>
<span id="cb24-196"><a href="#cb24-196" aria-hidden="true" tabindex="-1"></a>            reverse<span class="op">=</span><span class="va">True</span></span>
<span id="cb24-197"><a href="#cb24-197" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb24-198"><a href="#cb24-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-199"><a href="#cb24-199" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, conv <span class="kw">in</span> <span class="bu">enumerate</span>(<span class="va">self</span>.all_conversations):</span>
<span id="cb24-200"><a href="#cb24-200" aria-hidden="true" tabindex="-1"></a>            conv[<span class="st">'number'</span>] <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb24-201"><a href="#cb24-201" aria-hidden="true" tabindex="-1"></a>            conv[<span class="st">'category'</span>] <span class="op">=</span> <span class="va">self</span>.categorize_conversation(conv[<span class="st">'title'</span>], conv.get(<span class="st">'summary'</span>, <span class="st">''</span>))</span>
<span id="cb24-202"><a href="#cb24-202" aria-hidden="true" tabindex="-1"></a>            conv.setdefault(<span class="st">'source'</span>, <span class="st">'Desconhecido'</span>)</span>
<span id="cb24-203"><a href="#cb24-203" aria-hidden="true" tabindex="-1"></a>            conv.setdefault(<span class="st">'messages'</span>, [])</span>
<span id="cb24-204"><a href="#cb24-204" aria-hidden="true" tabindex="-1"></a>            conv.setdefault(<span class="st">'summary'</span>, conv[<span class="st">'messages'</span>][<span class="dv">0</span>][<span class="st">'content'</span>][:<span class="dv">100</span>] <span class="op">+</span> <span class="st">"..."</span> <span class="cf">if</span> conv[<span class="st">'messages'</span>] <span class="cf">else</span> <span class="st">"Sem conte√∫do"</span>)</span>
<span id="cb24-205"><a href="#cb24-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-206"><a href="#cb24-206" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.logger.info(<span class="ss">f"üìä Total combinado de conversas: </span><span class="sc">{</span><span class="bu">len</span>(<span class="va">self</span>.all_conversations)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb24-207"><a href="#cb24-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-208"><a href="#cb24-208" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _export_all_formats(<span class="va">self</span>):</span>
<span id="cb24-209"><a href="#cb24-209" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Exporta para todos os formatos"""</span></span>
<span id="cb24-210"><a href="#cb24-210" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.logger.info(<span class="st">"</span><span class="ch">\n</span><span class="st">üîÑ Exportando para formatos..."</span>)</span>
<span id="cb24-211"><a href="#cb24-211" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.save_as_markdown_enhanced()</span>
<span id="cb24-212"><a href="#cb24-212" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.save_as_html_robust()</span>
<span id="cb24-213"><a href="#cb24-213" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.save_as_csv() </span>
<span id="cb24-214"><a href="#cb24-214" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.save_as_json()</span>
<span id="cb24-215"><a href="#cb24-215" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.save_all_to_single_files()</span>
<span id="cb24-216"><a href="#cb24-216" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.create_searchable_index()</span>
<span id="cb24-217"><a href="#cb24-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-218"><a href="#cb24-218" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _get_pandoc_version(<span class="va">self</span>) <span class="op">-></span> Optional[<span class="bu">tuple</span>]:</span>
<span id="cb24-219"><a href="#cb24-219" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Obt√©m a vers√£o do Pandoc para compatibilidade"""</span></span>
<span id="cb24-220"><a href="#cb24-220" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb24-221"><a href="#cb24-221" aria-hidden="true" tabindex="-1"></a>            result <span class="op">=</span> subprocess.run([<span class="st">'pandoc'</span>, <span class="st">'--version'</span>], capture_output<span class="op">=</span><span class="va">True</span>, text<span class="op">=</span><span class="va">True</span>, encoding<span class="op">=</span><span class="st">'utf-8'</span>)</span>
<span id="cb24-222"><a href="#cb24-222" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> result.returncode <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb24-223"><a href="#cb24-223" aria-hidden="true" tabindex="-1"></a>                first_line <span class="op">=</span> result.stdout.split(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)[<span class="dv">0</span>]</span>
<span id="cb24-224"><a href="#cb24-224" aria-hidden="true" tabindex="-1"></a>                version_str <span class="op">=</span> first_line.split()[<span class="dv">1</span>]</span>
<span id="cb24-225"><a href="#cb24-225" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="bu">tuple</span>(<span class="bu">map</span>(<span class="bu">int</span>, version_str.split(<span class="st">'.'</span>)))</span>
<span id="cb24-226"><a href="#cb24-226" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span>:</span>
<span id="cb24-227"><a href="#cb24-227" aria-hidden="true" tabindex="-1"></a>            <span class="cf">pass</span></span>
<span id="cb24-228"><a href="#cb24-228" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb24-229"><a href="#cb24-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-230"><a href="#cb24-230" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _convert_with_pandoc_optimized(<span class="va">self</span>, md_file_path: <span class="bu">str</span>) <span class="op">-></span> Optional[<span class="bu">str</span>]:</span>
<span id="cb24-231"><a href="#cb24-231" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Convers√£o OTIMIZADA com Pandoc usando todas as op√ß√µes avan√ßadas"""</span></span>
<span id="cb24-232"><a href="#cb24-232" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb24-233"><a href="#cb24-233" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="ss">f"üîß Convertendo com Pandoc otimizado: </span><span class="sc">{</span>Path(md_file_path)<span class="sc">.</span>name<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb24-234"><a href="#cb24-234" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-235"><a href="#cb24-235" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Verifica se o arquivo MathJax local existe</span></span>
<span id="cb24-236"><a href="#cb24-236" aria-hidden="true" tabindex="-1"></a>            mathjax_path <span class="op">=</span> Path(<span class="st">"assets/tex-mml-chtml.js"</span>)</span>
<span id="cb24-237"><a href="#cb24-237" aria-hidden="true" tabindex="-1"></a>            mathjax_arg <span class="op">=</span> <span class="ss">f"assets/tex-mml-chtml.js"</span> <span class="cf">if</span> mathjax_path.exists() <span class="cf">else</span> <span class="st">""</span></span>
<span id="cb24-238"><a href="#cb24-238" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-239"><a href="#cb24-239" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Comandos base</span></span>
<span id="cb24-240"><a href="#cb24-240" aria-hidden="true" tabindex="-1"></a>            command <span class="op">=</span> [</span>
<span id="cb24-241"><a href="#cb24-241" aria-hidden="true" tabindex="-1"></a>                <span class="st">'pandoc'</span>, </span>
<span id="cb24-242"><a href="#cb24-242" aria-hidden="true" tabindex="-1"></a>                <span class="bu">str</span>(md_file_path),</span>
<span id="cb24-243"><a href="#cb24-243" aria-hidden="true" tabindex="-1"></a>                <span class="st">'--from'</span>, <span class="st">'markdown+emoji+autolink_bare_uris+tex_math_single_backslash'</span>,</span>
<span id="cb24-244"><a href="#cb24-244" aria-hidden="true" tabindex="-1"></a>                <span class="st">'--to'</span>, <span class="st">'html5'</span>,</span>
<span id="cb24-245"><a href="#cb24-245" aria-hidden="true" tabindex="-1"></a>                <span class="st">'--standalone'</span>,</span>
<span id="cb24-246"><a href="#cb24-246" aria-hidden="true" tabindex="-1"></a>                <span class="st">'--mathjax'</span> <span class="cf">if</span> <span class="kw">not</span> mathjax_path.exists() <span class="cf">else</span> <span class="ss">f'--mathjax=</span><span class="sc">{</span>mathjax_arg<span class="sc">}</span><span class="ss">'</span>,</span>
<span id="cb24-247"><a href="#cb24-247" aria-hidden="true" tabindex="-1"></a>                <span class="st">'--table-of-contents'</span>,</span>
<span id="cb24-248"><a href="#cb24-248" aria-hidden="true" tabindex="-1"></a>                <span class="st">'--toc-depth=3'</span>,  <span class="co"># ALTERADO: de 2 para 3</span></span>
<span id="cb24-249"><a href="#cb24-249" aria-hidden="true" tabindex="-1"></a>                <span class="st">'--number-sections'</span></span>
<span id="cb24-250"><a href="#cb24-250" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb24-251"><a href="#cb24-251" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-252"><a href="#cb24-252" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Verifica vers√£o do Pandoc para recursos avan√ßados</span></span>
<span id="cb24-253"><a href="#cb24-253" aria-hidden="true" tabindex="-1"></a>            pandoc_version <span class="op">=</span> <span class="va">self</span>._get_pandoc_version()</span>
<span id="cb24-254"><a href="#cb24-254" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-255"><a href="#cb24-255" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Adiciona --embed-resources apenas se suportado (Pandoc 2.19+)</span></span>
<span id="cb24-256"><a href="#cb24-256" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> pandoc_version <span class="kw">and</span> pandoc_version <span class="op">>=</span> (<span class="dv">2</span>, <span class="dv">19</span>):</span>
<span id="cb24-257"><a href="#cb24-257" aria-hidden="true" tabindex="-1"></a>                command.append(<span class="st">'--embed-resources'</span>)</span>
<span id="cb24-258"><a href="#cb24-258" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.info(<span class="st">"‚úÖ Usando --embed-resources (Pandoc 2.19+)"</span>)</span>
<span id="cb24-259"><a href="#cb24-259" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb24-260"><a href="#cb24-260" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.info(<span class="st">"‚ÑπÔ∏è  --embed-resources n√£o suportado, usando recursos externos"</span>)</span>
<span id="cb24-261"><a href="#cb24-261" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-262"><a href="#cb24-262" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Adiciona syntax highlighting</span></span>
<span id="cb24-263"><a href="#cb24-263" aria-hidden="true" tabindex="-1"></a>            command.extend([<span class="st">'--syntax-highlighting=pygments'</span>])</span>
<span id="cb24-264"><a href="#cb24-264" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-265"><a href="#cb24-265" aria-hidden="true" tabindex="-1"></a>            result <span class="op">=</span> subprocess.run(</span>
<span id="cb24-266"><a href="#cb24-266" aria-hidden="true" tabindex="-1"></a>                command, </span>
<span id="cb24-267"><a href="#cb24-267" aria-hidden="true" tabindex="-1"></a>                capture_output<span class="op">=</span><span class="va">True</span>, </span>
<span id="cb24-268"><a href="#cb24-268" aria-hidden="true" tabindex="-1"></a>                text<span class="op">=</span><span class="va">True</span>, </span>
<span id="cb24-269"><a href="#cb24-269" aria-hidden="true" tabindex="-1"></a>                encoding<span class="op">=</span><span class="st">'utf-8'</span>, </span>
<span id="cb24-270"><a href="#cb24-270" aria-hidden="true" tabindex="-1"></a>                timeout<span class="op">=</span><span class="dv">180</span></span>
<span id="cb24-271"><a href="#cb24-271" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb24-272"><a href="#cb24-272" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-273"><a href="#cb24-273" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> result.returncode <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb24-274"><a href="#cb24-274" aria-hidden="true" tabindex="-1"></a>                html_content <span class="op">=</span> result.stdout</span>
<span id="cb24-275"><a href="#cb24-275" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb24-276"><a href="#cb24-276" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Aplica otimiza√ß√µes adicionais</span></span>
<span id="cb24-277"><a href="#cb24-277" aria-hidden="true" tabindex="-1"></a>                html_content <span class="op">=</span> <span class="va">self</span>._optimize_html_content(html_content)</span>
<span id="cb24-278"><a href="#cb24-278" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> html_content</span>
<span id="cb24-279"><a href="#cb24-279" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb24-280"><a href="#cb24-280" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.warning(<span class="ss">f"‚ö†Ô∏è Pandoc otimizado falhou, tentando m√©todo b√°sico: </span><span class="sc">{</span>result<span class="sc">.</span>stderr[:<span class="dv">200</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb24-281"><a href="#cb24-281" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="va">self</span>._convert_with_pandoc_basic(md_file_path)</span>
<span id="cb24-282"><a href="#cb24-282" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb24-283"><a href="#cb24-283" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> subprocess.TimeoutExpired:</span>
<span id="cb24-284"><a href="#cb24-284" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.error(<span class="st">"‚ùå Timeout no Pandoc otimizado"</span>)</span>
<span id="cb24-285"><a href="#cb24-285" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">self</span>._convert_with_pandoc_basic(md_file_path)</span>
<span id="cb24-286"><a href="#cb24-286" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb24-287"><a href="#cb24-287" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.error(<span class="ss">f"‚ùå Erro no Pandoc otimizado: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb24-288"><a href="#cb24-288" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">self</span>._convert_with_pandoc_basic(md_file_path)</span>
<span id="cb24-289"><a href="#cb24-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-290"><a href="#cb24-290" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _convert_with_pandoc_basic(<span class="va">self</span>, md_file_path: <span class="bu">str</span>) <span class="op">-></span> Optional[<span class="bu">str</span>]:</span>
<span id="cb24-291"><a href="#cb24-291" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""M√©todo b√°sico de fallback para Pandoc com TOC e numera√ß√£o"""</span></span>
<span id="cb24-292"><a href="#cb24-292" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb24-293"><a href="#cb24-293" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="ss">f"üîß Tentando convers√£o b√°sica: </span><span class="sc">{</span>Path(md_file_path)<span class="sc">.</span>name<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb24-294"><a href="#cb24-294" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-295"><a href="#cb24-295" aria-hidden="true" tabindex="-1"></a>            mathjax_path <span class="op">=</span> Path(<span class="st">"assets/tex-mml-chtml.js"</span>)</span>
<span id="cb24-296"><a href="#cb24-296" aria-hidden="true" tabindex="-1"></a>            mathjax_arg <span class="op">=</span> <span class="ss">f"assets/tex-mml-chtml.js"</span> <span class="cf">if</span> mathjax_path.exists() <span class="cf">else</span> <span class="st">""</span></span>
<span id="cb24-297"><a href="#cb24-297" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-298"><a href="#cb24-298" aria-hidden="true" tabindex="-1"></a>            command <span class="op">=</span> [</span>
<span id="cb24-299"><a href="#cb24-299" aria-hidden="true" tabindex="-1"></a>                <span class="st">'pandoc'</span>, </span>
<span id="cb24-300"><a href="#cb24-300" aria-hidden="true" tabindex="-1"></a>                <span class="bu">str</span>(md_file_path),</span>
<span id="cb24-301"><a href="#cb24-301" aria-hidden="true" tabindex="-1"></a>                <span class="st">'--from'</span>, <span class="st">'markdown'</span>,</span>
<span id="cb24-302"><a href="#cb24-302" aria-hidden="true" tabindex="-1"></a>                <span class="st">'--to'</span>, <span class="st">'html5'</span>,</span>
<span id="cb24-303"><a href="#cb24-303" aria-hidden="true" tabindex="-1"></a>                <span class="st">'--standalone'</span>,</span>
<span id="cb24-304"><a href="#cb24-304" aria-hidden="true" tabindex="-1"></a>                <span class="st">'--table-of-contents'</span>,</span>
<span id="cb24-305"><a href="#cb24-305" aria-hidden="true" tabindex="-1"></a>                <span class="st">'--toc-depth=3'</span>,  <span class="co"># ALTERADO: de 2 para 3</span></span>
<span id="cb24-306"><a href="#cb24-306" aria-hidden="true" tabindex="-1"></a>                <span class="st">'--number-sections'</span>,</span>
<span id="cb24-307"><a href="#cb24-307" aria-hidden="true" tabindex="-1"></a>                <span class="st">'--mathjax'</span> <span class="cf">if</span> <span class="kw">not</span> mathjax_path.exists() <span class="cf">else</span> <span class="ss">f'--mathjax=</span><span class="sc">{</span>mathjax_arg<span class="sc">}</span><span class="ss">'</span></span>
<span id="cb24-308"><a href="#cb24-308" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb24-309"><a href="#cb24-309" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-310"><a href="#cb24-310" aria-hidden="true" tabindex="-1"></a>            result <span class="op">=</span> subprocess.run(</span>
<span id="cb24-311"><a href="#cb24-311" aria-hidden="true" tabindex="-1"></a>                command, </span>
<span id="cb24-312"><a href="#cb24-312" aria-hidden="true" tabindex="-1"></a>                capture_output<span class="op">=</span><span class="va">True</span>, </span>
<span id="cb24-313"><a href="#cb24-313" aria-hidden="true" tabindex="-1"></a>                text<span class="op">=</span><span class="va">True</span>, </span>
<span id="cb24-314"><a href="#cb24-314" aria-hidden="true" tabindex="-1"></a>                encoding<span class="op">=</span><span class="st">'utf-8'</span>, </span>
<span id="cb24-315"><a href="#cb24-315" aria-hidden="true" tabindex="-1"></a>                timeout<span class="op">=</span><span class="dv">120</span></span>
<span id="cb24-316"><a href="#cb24-316" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb24-317"><a href="#cb24-317" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-318"><a href="#cb24-318" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> result.returncode <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb24-319"><a href="#cb24-319" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="va">self</span>._optimize_html_content(result.stdout)</span>
<span id="cb24-320"><a href="#cb24-320" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb24-321"><a href="#cb24-321" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.warning(<span class="ss">f"‚ö†Ô∏è Pandoc b√°sico falhou, usando fallback Python: </span><span class="sc">{</span>result<span class="sc">.</span>stderr[:<span class="dv">200</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb24-322"><a href="#cb24-322" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="va">self</span>._convert_with_fallback(md_file_path)</span>
<span id="cb24-323"><a href="#cb24-323" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb24-324"><a href="#cb24-324" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb24-325"><a href="#cb24-325" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.error(<span class="ss">f"‚ùå Erro no Pandoc b√°sico: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb24-326"><a href="#cb24-326" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">self</span>._convert_with_fallback(md_file_path)</span>
<span id="cb24-327"><a href="#cb24-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-328"><a href="#cb24-328" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _optimize_html_content(<span class="va">self</span>, html_content: <span class="bu">str</span>) <span class="op">-></span> <span class="bu">str</span>:</span>
<span id="cb24-329"><a href="#cb24-329" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Aplica otimiza√ß√µes finais ao conte√∫do HTML"""</span></span>
<span id="cb24-330"><a href="#cb24-330" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Adiciona viewport para responsividade</span></span>
<span id="cb24-331"><a href="#cb24-331" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">'<head>

        <style id="fixed-toc-styles">
        /* === ESTILOS PRINCIPAIS - TOC FIXO √Ä DIREITA === */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
            scroll-behavior: smooth;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            position: relative;
        }
        /* === TOC FIXO √Ä DIREITA - POSI√á√ÉO CORRIGIDA === */
        #TOC {
            position: fixed !important;
            top: 50% !important;
            right: 20px !important;
            transform: translateY(-50%) !important;
            width: 320px !important;
            max-height: 80vh !important;
            overflow-y: auto !important;
            z-index: 1000 !important;
            background: rgba(255, 255, 255, 0.98) !important;
            padding: 20px !important;
            border-radius: 12px !important;
            box-shadow: 0 8px 32px rgba(0,0,0,0.15) !important;
            border: 1px solid #e0e0e0 !important;
            backdrop-filter: blur(10px) !important;
            transition: all 0.3s ease-in-out !important;
        }
        #TOC.toc-minimized {
            transform: translateY(-50%) translateX(calc(320px - 50px)) !important;
            opacity: 0.3;
            width: 50px !important;
            overflow: hidden;
        }
        #TOC.toc-minimized > *:not(.toc-toggle-btn) {
            display: none !important;
        }
        #TOC h2 {
            margin-top: 0;
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
            font-size: 1.2em;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .toc-toggle-btn {
            background: none;
            border: none;
            font-size: 1.2em;
            cursor: pointer;
            padding: 5px;
            border-radius: 4px;
            transition: background-color 0.2s;
        }
        .toc-toggle-btn:hover {
            background-color: rgba(0,0,0,0.1);
        }
        #TOC ul {
            list-style-type: none;
            padding-left: 15px;
            margin: 10px 0;
        }
        #TOC ul ul {
            padding-left: 20px;
        }
        #TOC li {
            margin: 8px 0;
            line-height: 1.4;
        }
        #TOC a {
            text-decoration: none;
            color: #495057;
            font-weight: 500;
            transition: all 0.2s ease;
            display: block;
            padding: 6px 10px;
            border-radius: 6px;
            border-left: 3px solid transparent;
        }
        #TOC a:hover {
            color: #007bff;
            background-color: rgba(0, 123, 255, 0.1);
            border-left-color: #007bff;
        }
        #TOC a.active {
            background-color: #007bff !important;
            color: white !important;
            font-weight: bold;
            border-left-color: #0056b3;
        }
        /* Conte√∫do principal com margem para o TOC */
        .main-content {
            margin-right: calc(320px + 40px) !important;
        }
        /* Barra de scroll personalizada APENAS para TOC */
        #TOC::-webkit-scrollbar {
            width: 8px;
        }
        #TOC::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }
        #TOC::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 4px;
        }
        #TOC::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }
        /* === BOT√ÉO VOLTAR AO TOPO (HTMLs individuais) === */
        .back-to-top-content {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            font-size: 18px;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 999;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .back-to-top-content.show {
            opacity: 1;
            transform: translateY(0);
        }
        .back-to-top-content:hover {
            background: #0056b3;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0,0,0,0.2);
        }
        /* === RESPONSIVIDADE === */
        @media (max-width: 1400px) {
            .container {
                max-width: 95%;
                padding: 30px;
            }
            #TOC {
                width: 280px !important;
            }
            .main-content {
                margin-right: 320px !important;
            }
        }
        @media (max-width: 1200px) {
            #TOC {
                width: 260px !important;
                right: 15px !important;
            }
            .main-content {
                margin-right: 300px !important;
            }
        }
        @media (max-width: 992px) {
            #TOC {
                position: relative !important;
                width: 100% !important;
                right: 0 !important;
                top: 0 !important;
                transform: none !important;
                margin: 20px 0;
                max-height: 300px !important;
            }
            .main-content {
                margin-right: 0 !important;
            }
            .back-to-top-content {
                right: 20px;
                bottom: 20px;
            }
        }
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            .container {
                padding: 20px;
                max-width: 100%;
            }
            #TOC {
                max-height: 250px !important;
                padding: 15px !important;
            }
        }
        </style>
        '</span> <span class="kw">in</span> html_content <span class="kw">and</span> <span class="st">'viewport'</span> <span class="kw">not</span> <span class="kw">in</span> html_content:</span>
<span id="cb24-332"><a href="#cb24-332" aria-hidden="true" tabindex="-1"></a>            viewport_meta <span class="op">=</span> <span class="st">'<meta name="viewport" content="width=device-width, initial-scale=1.0">'</span></span>
<span id="cb24-333"><a href="#cb24-333" aria-hidden="true" tabindex="-1"></a>            html_content <span class="op">=</span> html_content.replace(<span class="st">'<head>

        <style id="fixed-toc-styles">
        /* === ESTILOS PRINCIPAIS - TOC FIXO √Ä DIREITA === */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
            scroll-behavior: smooth;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            position: relative;
        }
        /* === TOC FIXO √Ä DIREITA - POSI√á√ÉO CORRIGIDA === */
        #TOC {
            position: fixed !important;
            top: 50% !important;
            right: 20px !important;
            transform: translateY(-50%) !important;
            width: 320px !important;
            max-height: 80vh !important;
            overflow-y: auto !important;
            z-index: 1000 !important;
            background: rgba(255, 255, 255, 0.98) !important;
            padding: 20px !important;
            border-radius: 12px !important;
            box-shadow: 0 8px 32px rgba(0,0,0,0.15) !important;
            border: 1px solid #e0e0e0 !important;
            backdrop-filter: blur(10px) !important;
            transition: all 0.3s ease-in-out !important;
        }
        #TOC.toc-minimized {
            transform: translateY(-50%) translateX(calc(320px - 50px)) !important;
            opacity: 0.3;
            width: 50px !important;
            overflow: hidden;
        }
        #TOC.toc-minimized > *:not(.toc-toggle-btn) {
            display: none !important;
        }
        #TOC h2 {
            margin-top: 0;
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
            font-size: 1.2em;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .toc-toggle-btn {
            background: none;
            border: none;
            font-size: 1.2em;
            cursor: pointer;
            padding: 5px;
            border-radius: 4px;
            transition: background-color 0.2s;
        }
        .toc-toggle-btn:hover {
            background-color: rgba(0,0,0,0.1);
        }
        #TOC ul {
            list-style-type: none;
            padding-left: 15px;
            margin: 10px 0;
        }
        #TOC ul ul {
            padding-left: 20px;
        }
        #TOC li {
            margin: 8px 0;
            line-height: 1.4;
        }
        #TOC a {
            text-decoration: none;
            color: #495057;
            font-weight: 500;
            transition: all 0.2s ease;
            display: block;
            padding: 6px 10px;
            border-radius: 6px;
            border-left: 3px solid transparent;
        }
        #TOC a:hover {
            color: #007bff;
            background-color: rgba(0, 123, 255, 0.1);
            border-left-color: #007bff;
        }
        #TOC a.active {
            background-color: #007bff !important;
            color: white !important;
            font-weight: bold;
            border-left-color: #0056b3;
        }
        /* Conte√∫do principal com margem para o TOC */
        .main-content {
            margin-right: calc(320px + 40px) !important;
        }
        /* Barra de scroll personalizada APENAS para TOC */
        #TOC::-webkit-scrollbar {
            width: 8px;
        }
        #TOC::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }
        #TOC::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 4px;
        }
        #TOC::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }
        /* === BOT√ÉO VOLTAR AO TOPO (HTMLs individuais) === */
        .back-to-top-content {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            font-size: 18px;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 999;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .back-to-top-content.show {
            opacity: 1;
            transform: translateY(0);
        }
        .back-to-top-content:hover {
            background: #0056b3;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0,0,0,0.2);
        }
        /* === RESPONSIVIDADE === */
        @media (max-width: 1400px) {
            .container {
                max-width: 95%;
                padding: 30px;
            }
            #TOC {
                width: 280px !important;
            }
            .main-content {
                margin-right: 320px !important;
            }
        }
        @media (max-width: 1200px) {
            #TOC {
                width: 260px !important;
                right: 15px !important;
            }
            .main-content {
                margin-right: 300px !important;
            }
        }
        @media (max-width: 992px) {
            #TOC {
                position: relative !important;
                width: 100% !important;
                right: 0 !important;
                top: 0 !important;
                transform: none !important;
                margin: 20px 0;
                max-height: 300px !important;
            }
            .main-content {
                margin-right: 0 !important;
            }
            .back-to-top-content {
                right: 20px;
                bottom: 20px;
            }
        }
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            .container {
                padding: 20px;
                max-width: 100%;
            }
            #TOC {
                max-height: 250px !important;
                padding: 15px !important;
            }
        }
        </style>
        '</span>, <span class="ss">f'<head>

        <style id="fixed-toc-styles">
        /* === ESTILOS PRINCIPAIS - TOC FIXO √Ä DIREITA === */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
            scroll-behavior: smooth;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            position: relative;
        }
        /* === TOC FIXO √Ä DIREITA - POSI√á√ÉO CORRIGIDA === */
        #TOC {
            position: fixed !important;
            top: 50% !important;
            right: 20px !important;
            transform: translateY(-50%) !important;
            width: 320px !important;
            max-height: 80vh !important;
            overflow-y: auto !important;
            z-index: 1000 !important;
            background: rgba(255, 255, 255, 0.98) !important;
            padding: 20px !important;
            border-radius: 12px !important;
            box-shadow: 0 8px 32px rgba(0,0,0,0.15) !important;
            border: 1px solid #e0e0e0 !important;
            backdrop-filter: blur(10px) !important;
            transition: all 0.3s ease-in-out !important;
        }
        #TOC.toc-minimized {
            transform: translateY(-50%) translateX(calc(320px - 50px)) !important;
            opacity: 0.3;
            width: 50px !important;
            overflow: hidden;
        }
        #TOC.toc-minimized > *:not(.toc-toggle-btn) {
            display: none !important;
        }
        #TOC h2 {
            margin-top: 0;
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
            font-size: 1.2em;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .toc-toggle-btn {
            background: none;
            border: none;
            font-size: 1.2em;
            cursor: pointer;
            padding: 5px;
            border-radius: 4px;
            transition: background-color 0.2s;
        }
        .toc-toggle-btn:hover {
            background-color: rgba(0,0,0,0.1);
        }
        #TOC ul {
            list-style-type: none;
            padding-left: 15px;
            margin: 10px 0;
        }
        #TOC ul ul {
            padding-left: 20px;
        }
        #TOC li {
            margin: 8px 0;
            line-height: 1.4;
        }
        #TOC a {
            text-decoration: none;
            color: #495057;
            font-weight: 500;
            transition: all 0.2s ease;
            display: block;
            padding: 6px 10px;
            border-radius: 6px;
            border-left: 3px solid transparent;
        }
        #TOC a:hover {
            color: #007bff;
            background-color: rgba(0, 123, 255, 0.1);
            border-left-color: #007bff;
        }
        #TOC a.active {
            background-color: #007bff !important;
            color: white !important;
            font-weight: bold;
            border-left-color: #0056b3;
        }
        /* Conte√∫do principal com margem para o TOC */
        .main-content {
            margin-right: calc(320px + 40px) !important;
        }
        /* Barra de scroll personalizada APENAS para TOC */
        #TOC::-webkit-scrollbar {
            width: 8px;
        }
        #TOC::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }
        #TOC::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 4px;
        }
        #TOC::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }
        /* === BOT√ÉO VOLTAR AO TOPO (HTMLs individuais) === */
        .back-to-top-content {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            font-size: 18px;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 999;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .back-to-top-content.show {
            opacity: 1;
            transform: translateY(0);
        }
        .back-to-top-content:hover {
            background: #0056b3;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0,0,0,0.2);
        }
        /* === RESPONSIVIDADE === */
        @media (max-width: 1400px) {
            .container {
                max-width: 95%;
                padding: 30px;
            }
            #TOC {
                width: 280px !important;
            }
            .main-content {
                margin-right: 320px !important;
            }
        }
        @media (max-width: 1200px) {
            #TOC {
                width: 260px !important;
                right: 15px !important;
            }
            .main-content {
                margin-right: 300px !important;
            }
        }
        @media (max-width: 992px) {
            #TOC {
                position: relative !important;
                width: 100% !important;
                right: 0 !important;
                top: 0 !important;
                transform: none !important;
                margin: 20px 0;
                max-height: 300px !important;
            }
            .main-content {
                margin-right: 0 !important;
            }
            .back-to-top-content {
                right: 20px;
                bottom: 20px;
            }
        }
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            .container {
                padding: 20px;
                max-width: 100%;
            }
            #TOC {
                max-height: 250px !important;
                padding: 15px !important;
            }
        }
        </style>
        </span><span class="ch">\n</span><span class="ss">    </span><span class="sc">{</span>viewport_meta<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb24-334"><a href="#cb24-334" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-335"><a href="#cb24-335" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Melhora acessibilidade</span></span>
<span id="cb24-336"><a href="#cb24-336" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">'<html'</span> <span class="kw">in</span> html_content <span class="kw">and</span> <span class="st">'lang'</span> <span class="kw">not</span> <span class="kw">in</span> html_content:</span>
<span id="cb24-337"><a href="#cb24-337" aria-hidden="true" tabindex="-1"></a>            html_content <span class="op">=</span> html_content.replace(<span class="st">'<html>'</span>, <span class="st">'<html lang="pt-BR">'</span>)</span>
<span id="cb24-338"><a href="#cb24-338" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-339"><a href="#cb24-339" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Adiciona CSS personalizado para melhorar TOC e numera√ß√£o</span></span>
<span id="cb24-340"><a href="#cb24-340" aria-hidden="true" tabindex="-1"></a>        html_content <span class="op">=</span> <span class="va">self</span>._inject_enhanced_css(html_content)</span>
<span id="cb24-341"><a href="#cb24-341" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-342"><a href="#cb24-342" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Otimiza TOC gerado pelo Pandoc</span></span>
<span id="cb24-343"><a href="#cb24-343" aria-hidden="true" tabindex="-1"></a>        html_content <span class="op">=</span> <span class="va">self</span>._enhance_toc_styling(html_content)</span>
<span id="cb24-344"><a href="#cb24-344" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-345"><a href="#cb24-345" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> html_content</span>
<span id="cb24-346"><a href="#cb24-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-347"><a href="#cb24-347" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _inject_enhanced_css(<span class="va">self</span>, html_content: <span class="bu">str</span>) <span class="op">-></span> <span class="bu">str</span>:</span>
<span id="cb24-348"><a href="#cb24-348" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Injeta CSS personalizado aprimorado para TOC flutuante e layout de tela completa"""</span></span>
<span id="cb24-349"><a href="#cb24-349" aria-hidden="true" tabindex="-1"></a>        enhanced_css <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb24-350"><a href="#cb24-350" aria-hidden="true" tabindex="-1"></a><span class="st">        <style></span></span>
<span id="cb24-351"><a href="#cb24-351" aria-hidden="true" tabindex="-1"></a><span class="st">            /* LAYOUT DE TELA COMPLETA OTIMIZADO */</span></span>
<span id="cb24-352"><a href="#cb24-352" aria-hidden="true" tabindex="-1"></a><span class="st">            body {</span></span>
<span id="cb24-353"><a href="#cb24-353" aria-hidden="true" tabindex="-1"></a><span class="st">                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;</span></span>
<span id="cb24-354"><a href="#cb24-354" aria-hidden="true" tabindex="-1"></a><span class="st">                line-height: 1.6;</span></span>
<span id="cb24-355"><a href="#cb24-355" aria-hidden="true" tabindex="-1"></a><span class="st">                margin: 0;</span></span>
<span id="cb24-356"><a href="#cb24-356" aria-hidden="true" tabindex="-1"></a><span class="st">                padding: 20px;</span></span>
<span id="cb24-357"><a href="#cb24-357" aria-hidden="true" tabindex="-1"></a><span class="st">                background-color: #f5f5f5;</span></span>
<span id="cb24-358"><a href="#cb24-358" aria-hidden="true" tabindex="-1"></a><span class="st">                color: #333;</span></span>
<span id="cb24-359"><a href="#cb24-359" aria-hidden="true" tabindex="-1"></a><span class="st">                max-width: none; /* Remove limita√ß√£o de largura - TELA COMPLETA */</span></span>
<span id="cb24-360"><a href="#cb24-360" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb24-361"><a href="#cb24-361" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb24-362"><a href="#cb24-362" aria-hidden="true" tabindex="-1"></a><span class="st">            .container {</span></span>
<span id="cb24-363"><a href="#cb24-363" aria-hidden="true" tabindex="-1"></a><span class="st">                max-width: 95%; /* Usa quase toda a largura dispon√≠vel */</span></span>
<span id="cb24-364"><a href="#cb24-364" aria-hidden="true" tabindex="-1"></a><span class="st">                margin: 0 auto;</span></span>
<span id="cb24-365"><a href="#cb24-365" aria-hidden="true" tabindex="-1"></a><span class="st">                background: white;</span></span>
<span id="cb24-366"><a href="#cb24-366" aria-hidden="true" tabindex="-1"></a><span class="st">                padding: 40px;</span></span>
<span id="cb24-367"><a href="#cb24-367" aria-hidden="true" tabindex="-1"></a><span class="st">                border-radius: 10px;</span></span>
<span id="cb24-368"><a href="#cb24-368" aria-hidden="true" tabindex="-1"></a><span class="st">                box-shadow: 0 5px 20px rgba(0,0,0,0.1);</span></span>
<span id="cb24-369"><a href="#cb24-369" aria-hidden="true" tabindex="-1"></a><span class="st">                position: relative; /* Para posicionamento do TOC */</span></span>
<span id="cb24-370"><a href="#cb24-370" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb24-371"><a href="#cb24-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-372"><a href="#cb24-372" aria-hidden="true" tabindex="-1"></a><span class="st">            /* TOC FLUTUANTE OTIMIZADO */</span></span>
<span id="cb24-373"><a href="#cb24-373" aria-hidden="true" tabindex="-1"></a><span class="st">            #TOC {</span></span>
<span id="cb24-374"><a href="#cb24-374" aria-hidden="true" tabindex="-1"></a><span class="st">                background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);</span></span>
<span id="cb24-375"><a href="#cb24-375" aria-hidden="true" tabindex="-1"></a><span class="st">                border: 1px solid #dee2e6;</span></span>
<span id="cb24-376"><a href="#cb24-376" aria-hidden="true" tabindex="-1"></a><span class="st">                border-radius: 8px;</span></span>
<span id="cb24-377"><a href="#cb24-377" aria-hidden="true" tabindex="-1"></a><span class="st">                padding: 20px;</span></span>
<span id="cb24-378"><a href="#cb24-378" aria-hidden="true" tabindex="-1"></a><span class="st">                margin: 20px 0;</span></span>
<span id="cb24-379"><a href="#cb24-379" aria-hidden="true" tabindex="-1"></a><span class="st">                box-shadow: 0 2px 10px rgba(0,0,0,0.1);</span></span>
<span id="cb24-380"><a href="#cb24-380" aria-hidden="true" tabindex="-1"></a><span class="st">                float: right; /* FLUTUA √Ä DIREITA */</span></span>
<span id="cb24-381"><a href="#cb24-381" aria-hidden="true" tabindex="-1"></a><span class="st">                width: 320px; /* Largura fixa para TOC */</span></span>
<span id="cb24-382"><a href="#cb24-382" aria-hidden="true" tabindex="-1"></a><span class="st">                margin-left: 30px;</span></span>
<span id="cb24-383"><a href="#cb24-383" aria-hidden="true" tabindex="-1"></a><span class="st">                margin-bottom: 30px;</span></span>
<span id="cb24-384"><a href="#cb24-384" aria-hidden="true" tabindex="-1"></a><span class="st">                position: relative;</span></span>
<span id="cb24-385"><a href="#cb24-385" aria-hidden="true" tabindex="-1"></a><span class="st">                z-index: 100;</span></span>
<span id="cb24-386"><a href="#cb24-386" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb24-387"><a href="#cb24-387" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb24-388"><a href="#cb24-388" aria-hidden="true" tabindex="-1"></a><span class="st">            #TOC ul {</span></span>
<span id="cb24-389"><a href="#cb24-389" aria-hidden="true" tabindex="-1"></a><span class="st">                list-style-type: none;</span></span>
<span id="cb24-390"><a href="#cb24-390" aria-hidden="true" tabindex="-1"></a><span class="st">                padding-left: 15px;</span></span>
<span id="cb24-391"><a href="#cb24-391" aria-hidden="true" tabindex="-1"></a><span class="st">                margin: 10px 0;</span></span>
<span id="cb24-392"><a href="#cb24-392" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb24-393"><a href="#cb24-393" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb24-394"><a href="#cb24-394" aria-hidden="true" tabindex="-1"></a><span class="st">            #TOC ul ul {</span></span>
<span id="cb24-395"><a href="#cb24-395" aria-hidden="true" tabindex="-1"></a><span class="st">                padding-left: 25px;</span></span>
<span id="cb24-396"><a href="#cb24-396" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb24-397"><a href="#cb24-397" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb24-398"><a href="#cb24-398" aria-hidden="true" tabindex="-1"></a><span class="st">            #TOC ul ul ul {</span></span>
<span id="cb24-399"><a href="#cb24-399" aria-hidden="true" tabindex="-1"></a><span class="st">                padding-left: 35px; /* Mais indenta√ß√£o para n√≠vel 3 */</span></span>
<span id="cb24-400"><a href="#cb24-400" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb24-401"><a href="#cb24-401" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb24-402"><a href="#cb24-402" aria-hidden="true" tabindex="-1"></a><span class="st">            #TOC li {</span></span>
<span id="cb24-403"><a href="#cb24-403" aria-hidden="true" tabindex="-1"></a><span class="st">                margin: 8px 0;</span></span>
<span id="cb24-404"><a href="#cb24-404" aria-hidden="true" tabindex="-1"></a><span class="st">                line-height: 1.4;</span></span>
<span id="cb24-405"><a href="#cb24-405" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb24-406"><a href="#cb24-406" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb24-407"><a href="#cb24-407" aria-hidden="true" tabindex="-1"></a><span class="st">            #TOC a {</span></span>
<span id="cb24-408"><a href="#cb24-408" aria-hidden="true" tabindex="-1"></a><span class="st">                text-decoration: none;</span></span>
<span id="cb24-409"><a href="#cb24-409" aria-hidden="true" tabindex="-1"></a><span class="st">                color: #495057;</span></span>
<span id="cb24-410"><a href="#cb24-410" aria-hidden="true" tabindex="-1"></a><span class="st">                font-weight: 500;</span></span>
<span id="cb24-411"><a href="#cb24-411" aria-hidden="true" tabindex="-1"></a><span class="st">                transition: color 0.2s ease;</span></span>
<span id="cb24-412"><a href="#cb24-412" aria-hidden="true" tabindex="-1"></a><span class="st">                display: block;</span></span>
<span id="cb24-413"><a href="#cb24-413" aria-hidden="true" tabindex="-1"></a><span class="st">                padding: 4px 8px;</span></span>
<span id="cb24-414"><a href="#cb24-414" aria-hidden="true" tabindex="-1"></a><span class="st">                border-radius: 4px;</span></span>
<span id="cb24-415"><a href="#cb24-415" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb24-416"><a href="#cb24-416" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb24-417"><a href="#cb24-417" aria-hidden="true" tabindex="-1"></a><span class="st">            #TOC a:hover {</span></span>
<span id="cb24-418"><a href="#cb24-418" aria-hidden="true" tabindex="-1"></a><span class="st">                color: #007bff;</span></span>
<span id="cb24-419"><a href="#cb24-419" aria-hidden="true" tabindex="-1"></a><span class="st">                background-color: rgba(0, 123, 255, 0.1);</span></span>
<span id="cb24-420"><a href="#cb24-420" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb24-421"><a href="#cb24-421" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb24-422"><a href="#cb24-422" aria-hidden="true" tabindex="-1"></a><span class="st">            #TOC > ul > li > a {</span></span>
<span id="cb24-423"><a href="#cb24-423" aria-hidden="true" tabindex="-1"></a><span class="st">                font-weight: 600;</span></span>
<span id="cb24-424"><a href="#cb24-424" aria-hidden="true" tabindex="-1"></a><span class="st">                color: #2c3e50;</span></span>
<span id="cb24-425"><a href="#cb24-425" aria-hidden="true" tabindex="-1"></a><span class="st">                border-left: 3px solid #3498db;</span></span>
<span id="cb24-426"><a href="#cb24-426" aria-hidden="true" tabindex="-1"></a><span class="st">                padding-left: 12px;</span></span>
<span id="cb24-427"><a href="#cb24-427" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb24-428"><a href="#cb24-428" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb24-429"><a href="#cb24-429" aria-hidden="true" tabindex="-1"></a><span class="st">            /* CLEARFIX PARA LAYOUT COM TOC FLUTUANTE */</span></span>
<span id="cb24-430"><a href="#cb24-430" aria-hidden="true" tabindex="-1"></a><span class="st">            .main-content {</span></span>
<span id="cb24-431"><a href="#cb24-431" aria-hidden="true" tabindex="-1"></a><span class="st">                overflow: hidden; /* PREVINE PROBLEMAS COM ELEMENTOS FLUTUANTES */</span></span>
<span id="cb24-432"><a href="#cb24-432" aria-hidden="true" tabindex="-1"></a><span class="st">                position: relative;</span></span>
<span id="cb24-433"><a href="#cb24-433" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb24-434"><a href="#cb24-434" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb24-435"><a href="#cb24-435" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Estilos para numera√ß√£o de se√ß√µes */</span></span>
<span id="cb24-436"><a href="#cb24-436" aria-hidden="true" tabindex="-1"></a><span class="st">            .header-section-number {</span></span>
<span id="cb24-437"><a href="#cb24-437" aria-hidden="true" tabindex="-1"></a><span class="st">                color: #3498db;</span></span>
<span id="cb24-438"><a href="#cb24-438" aria-hidden="true" tabindex="-1"></a><span class="st">                font-weight: bold;</span></span>
<span id="cb24-439"><a href="#cb24-439" aria-hidden="true" tabindex="-1"></a><span class="st">                margin-right: 8px;</span></span>
<span id="cb24-440"><a href="#cb24-440" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb24-441"><a href="#cb24-441" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb24-442"><a href="#cb24-442" aria-hidden="true" tabindex="-1"></a><span class="st">            h1 .header-section-number {</span></span>
<span id="cb24-443"><a href="#cb24-443" aria-hidden="true" tabindex="-1"></a><span class="st">                font-size: 0.9em;</span></span>
<span id="cb24-444"><a href="#cb24-444" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb24-445"><a href="#cb24-445" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb24-446"><a href="#cb24-446" aria-hidden="true" tabindex="-1"></a><span class="st">            h2 .header-section-number {</span></span>
<span id="cb24-447"><a href="#cb24-447" aria-hidden="true" tabindex="-1"></a><span class="st">                font-size: 0.85em;</span></span>
<span id="cb24-448"><a href="#cb24-448" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb24-449"><a href="#cb24-449" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb24-450"><a href="#cb24-450" aria-hidden="true" tabindex="-1"></a><span class="st">            h3 .header-section-number {</span></span>
<span id="cb24-451"><a href="#cb24-451" aria-hidden="true" tabindex="-1"></a><span class="st">                font-size: 0.8em;</span></span>
<span id="cb24-452"><a href="#cb24-452" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb24-453"><a href="#cb24-453" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb24-454"><a href="#cb24-454" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Melhorias para c√≥digo e matem√°tica */</span></span>
<span id="cb24-455"><a href="#cb24-455" aria-hidden="true" tabindex="-1"></a><span class="st">            .math { display: block; text-align: center; margin: 1.5em 0; }</span></span>
<span id="cb24-456"><a href="#cb24-456" aria-hidden="true" tabindex="-1"></a><span class="st">            .math inline { display: inline-block; }</span></span>
<span id="cb24-457"><a href="#cb24-457" aria-hidden="true" tabindex="-1"></a><span class="st">            pre { </span></span>
<span id="cb24-458"><a href="#cb24-458" aria-hidden="true" tabindex="-1"></a><span class="st">                border-left: 4px solid #3498db; </span></span>
<span id="cb24-459"><a href="#cb24-459" aria-hidden="true" tabindex="-1"></a><span class="st">                background: #2d2d2d; </span></span>
<span id="cb24-460"><a href="#cb24-460" aria-hidden="true" tabindex="-1"></a><span class="st">                color: #f8f8f2;</span></span>
<span id="cb24-461"><a href="#cb24-461" aria-hidden="true" tabindex="-1"></a><span class="st">                padding: 20px;</span></span>
<span id="cb24-462"><a href="#cb24-462" aria-hidden="true" tabindex="-1"></a><span class="st">                border-radius: 8px;</span></span>
<span id="cb24-463"><a href="#cb24-463" aria-hidden="true" tabindex="-1"></a><span class="st">                overflow-x: auto;</span></span>
<span id="cb24-464"><a href="#cb24-464" aria-hidden="true" tabindex="-1"></a><span class="st">                font-family: 'Consolas', 'Monaco', 'Courier New', monospace;</span></span>
<span id="cb24-465"><a href="#cb24-465" aria-hidden="true" tabindex="-1"></a><span class="st">                line-height: 1.4;</span></span>
<span id="cb24-466"><a href="#cb24-466" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb24-467"><a href="#cb24-467" aria-hidden="true" tabindex="-1"></a><span class="st">            code { </span></span>
<span id="cb24-468"><a href="#cb24-468" aria-hidden="true" tabindex="-1"></a><span class="st">                background: #e9ecef; </span></span>
<span id="cb24-469"><a href="#cb24-469" aria-hidden="true" tabindex="-1"></a><span class="st">                padding: 0.2em 0.4em; </span></span>
<span id="cb24-470"><a href="#cb24-470" aria-hidden="true" tabindex="-1"></a><span class="st">                border-radius: 3px;</span></span>
<span id="cb24-471"><a href="#cb24-471" aria-hidden="true" tabindex="-1"></a><span class="st">                font-family: 'Consolas', 'Monaco', 'Courier New', monospace;</span></span>
<span id="cb24-472"><a href="#cb24-472" aria-hidden="true" tabindex="-1"></a><span class="st">                color: #c7254e;</span></span>
<span id="cb24-473"><a href="#cb24-473" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb24-474"><a href="#cb24-474" aria-hidden="true" tabindex="-1"></a><span class="st">            pre code { </span></span>
<span id="cb24-475"><a href="#cb24-475" aria-hidden="true" tabindex="-1"></a><span class="st">                background: none; </span></span>
<span id="cb24-476"><a href="#cb24-476" aria-hidden="true" tabindex="-1"></a><span class="st">                color: inherit; </span></span>
<span id="cb24-477"><a href="#cb24-477" aria-hidden="true" tabindex="-1"></a><span class="st">                padding: 0; </span></span>
<span id="cb24-478"><a href="#cb24-478" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb24-479"><a href="#cb24-479" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb24-480"><a href="#cb24-480" aria-hidden="true" tabindex="-1"></a><span class="st">            /* CORRE√á√ÉO CR√çTICA: Syntax highlighting do Pandoc */</span></span>
<span id="cb24-481"><a href="#cb24-481" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode { </span></span>
<span id="cb24-482"><a href="#cb24-482" aria-hidden="true" tabindex="-1"></a><span class="st">                background: #2d2d2d !important; </span></span>
<span id="cb24-483"><a href="#cb24-483" aria-hidden="true" tabindex="-1"></a><span class="st">                color: #f8f8f2 !important;</span></span>
<span id="cb24-484"><a href="#cb24-484" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb24-485"><a href="#cb24-485" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb24-486"><a href="#cb24-486" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Garantir que TODO o texto dentro de pre/code seja vis√≠vel */</span></span>
<span id="cb24-487"><a href="#cb24-487" aria-hidden="true" tabindex="-1"></a><span class="st">            pre, code, .sourceCode, .sourceCode pre, .sourceCode code {</span></span>
<span id="cb24-488"><a href="#cb24-488" aria-hidden="true" tabindex="-1"></a><span class="st">                color: #f8f8f2 !important;</span></span>
<span id="cb24-489"><a href="#cb24-489" aria-hidden="true" tabindex="-1"></a><span class="st">                background-color: #2d2d2d !important;</span></span>
<span id="cb24-490"><a href="#cb24-490" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb24-491"><a href="#cb24-491" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb24-492"><a href="#cb24-492" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Corre√ß√£o para spans de syntax highlighting */</span></span>
<span id="cb24-493"><a href="#cb24-493" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode .kw { color: #ff79c6 !important; } /* keywords */</span></span>
<span id="cb24-494"><a href="#cb24-494" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode .dt { color: #8be9fd !important; } /* types */</span></span>
<span id="cb24-495"><a href="#cb24-495" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode .dv { color: #bd93f9 !important; } /* values */</span></span>
<span id="cb24-496"><a href="#cb24-496" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode .bn { color: #bd93f9 !important; } /* numbers */</span></span>
<span id="cb24-497"><a href="#cb24-497" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode .fl { color: #bd93f9 !important; } /* floats */</span></span>
<span id="cb24-498"><a href="#cb24-498" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode .ch { color: #f1fa8c !important; } /* chars */</span></span>
<span id="cb24-499"><a href="#cb24-499" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode .st { color: #f1fa8c !important; } /* strings */</span></span>
<span id="cb24-500"><a href="#cb24-500" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode .co { color: #6272a4 !important; } /* comments */</span></span>
<span id="cb24-501"><a href="#cb24-501" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode .ot { color: #50fa7b !important; } /* other */</span></span>
<span id="cb24-502"><a href="#cb24-502" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode .al { color: #ff5555 !important; } /* alerts */</span></span>
<span id="cb24-503"><a href="#cb24-503" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode .fu { color: #50fa7b !important; } /* functions */</span></span>
<span id="cb24-504"><a href="#cb24-504" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode .re { color: #f1fa8c !important; } /* regex */</span></span>
<span id="cb24-505"><a href="#cb24-505" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode .er { color: #ff5555 !important; } /* errors */</span></span>
<span id="cb24-506"><a href="#cb24-506" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb24-507"><a href="#cb24-507" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Garantir que texto normal em blocos de c√≥digo seja vis√≠vel */</span></span>
<span id="cb24-508"><a href="#cb24-508" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode span {</span></span>
<span id="cb24-509"><a href="#cb24-509" aria-hidden="true" tabindex="-1"></a><span class="st">                color: #f8f8f2 !important;</span></span>
<span id="cb24-510"><a href="#cb24-510" aria-hidden="true" tabindex="-1"></a><span class="st">                background: transparent !important;</span></span>
<span id="cb24-511"><a href="#cb24-511" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb24-512"><a href="#cb24-512" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb24-513"><a href="#cb24-513" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Fallback para qualquer elemento de c√≥digo n√£o estilizado */</span></span>
<span id="cb24-514"><a href="#cb24-514" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode * {</span></span>
<span id="cb24-515"><a href="#cb24-515" aria-hidden="true" tabindex="-1"></a><span class="st">                color: inherit !important;</span></span>
<span id="cb24-516"><a href="#cb24-516" aria-hidden="true" tabindex="-1"></a><span class="st">                background: transparent !important;</span></span>
<span id="cb24-517"><a href="#cb24-517" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb24-518"><a href="#cb24-518" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb24-519"><a href="#cb24-519" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Corre√ß√£o adicional para blocos de c√≥digo gerais */</span></span>
<span id="cb24-520"><a href="#cb24-520" aria-hidden="true" tabindex="-1"></a><span class="st">            div.sourceCode {</span></span>
<span id="cb24-521"><a href="#cb24-521" aria-hidden="true" tabindex="-1"></a><span class="st">                border-left: 4px solid #3498db;</span></span>
<span id="cb24-522"><a href="#cb24-522" aria-hidden="true" tabindex="-1"></a><span class="st">                background: #2d2d2d !important;</span></span>
<span id="cb24-523"><a href="#cb24-523" aria-hidden="true" tabindex="-1"></a><span class="st">                color: #f8f8f2 !important;</span></span>
<span id="cb24-524"><a href="#cb24-524" aria-hidden="true" tabindex="-1"></a><span class="st">                margin: 1.5em 0;</span></span>
<span id="cb24-525"><a href="#cb24-525" aria-hidden="true" tabindex="-1"></a><span class="st">                border-radius: 8px;</span></span>
<span id="cb24-526"><a href="#cb24-526" aria-hidden="true" tabindex="-1"></a><span class="st">                overflow: hidden;</span></span>
<span id="cb24-527"><a href="#cb24-527" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb24-528"><a href="#cb24-528" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb24-529"><a href="#cb24-529" aria-hidden="true" tabindex="-1"></a><span class="st">            div.sourceCode pre {</span></span>
<span id="cb24-530"><a href="#cb24-530" aria-hidden="true" tabindex="-1"></a><span class="st">                margin: 0;</span></span>
<span id="cb24-531"><a href="#cb24-531" aria-hidden="true" tabindex="-1"></a><span class="st">                padding: 20px;</span></span>
<span id="cb24-532"><a href="#cb24-532" aria-hidden="true" tabindex="-1"></a><span class="st">                background: transparent !important;</span></span>
<span id="cb24-533"><a href="#cb24-533" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb24-534"><a href="#cb24-534" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb24-535"><a href="#cb24-535" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Melhorar contraste para texto normal em todas as situa√ß√µes */</span></span>
<span id="cb24-536"><a href="#cb24-536" aria-hidden="true" tabindex="-1"></a><span class="st">            body, .container, .main-content {</span></span>
<span id="cb24-537"><a href="#cb24-537" aria-hidden="true" tabindex="-1"></a><span class="st">                color: #2c3e50 !important;</span></span>
<span id="cb24-538"><a href="#cb24-538" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb24-539"><a href="#cb24-539" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb24-540"><a href="#cb24-540" aria-hidden="true" tabindex="-1"></a><span class="st">            p, li, td, th, div, span {</span></span>
<span id="cb24-541"><a href="#cb24-541" aria-hidden="true" tabindex="-1"></a><span class="st">                color: #2c3e50 !important;</span></span>
<span id="cb24-542"><a href="#cb24-542" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb24-543"><a href="#cb24-543" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb24-544"><a href="#cb24-544" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Garantir que links sejam vis√≠veis */</span></span>
<span id="cb24-545"><a href="#cb24-545" aria-hidden="true" tabindex="-1"></a><span class="st">            a {</span></span>
<span id="cb24-546"><a href="#cb24-546" aria-hidden="true" tabindex="-1"></a><span class="st">                color: #3498db !important;</span></span>
<span id="cb24-547"><a href="#cb24-547" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb24-548"><a href="#cb24-548" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb24-549"><a href="#cb24-549" aria-hidden="true" tabindex="-1"></a><span class="st">            a:hover {</span></span>
<span id="cb24-550"><a href="#cb24-550" aria-hidden="true" tabindex="-1"></a><span class="st">                color: #2980b9 !important;</span></span>
<span id="cb24-551"><a href="#cb24-551" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb24-552"><a href="#cb24-552" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb24-553"><a href="#cb24-553" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Corre√ß√£o para elementos MathJax */</span></span>
<span id="cb24-554"><a href="#cb24-554" aria-hidden="true" tabindex="-1"></a><span class="st">            .math, .math display, mjx-container {</span></span>
<span id="cb24-555"><a href="#cb24-555" aria-hidden="true" tabindex="-1"></a><span class="st">                color: #2c3e50 !important;</span></span>
<span id="cb24-556"><a href="#cb24-556" aria-hidden="true" tabindex="-1"></a><span class="st">                background: transparent !important;</span></span>
<span id="cb24-557"><a href="#cb24-557" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb24-558"><a href="#cb24-558" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb24-559"><a href="#cb24-559" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Melhorias responsivas */</span></span>
<span id="cb24-560"><a href="#cb24-560" aria-hidden="true" tabindex="-1"></a><span class="st">            @media (max-width: 1400px) {</span></span>
<span id="cb24-561"><a href="#cb24-561" aria-hidden="true" tabindex="-1"></a><span class="st">                .container {</span></span>
<span id="cb24-562"><a href="#cb24-562" aria-hidden="true" tabindex="-1"></a><span class="st">                    max-width: 98%;</span></span>
<span id="cb24-563"><a href="#cb24-563" aria-hidden="true" tabindex="-1"></a><span class="st">                    padding: 30px;</span></span>
<span id="cb24-564"><a href="#cb24-564" aria-hidden="true" tabindex="-1"></a><span class="st">                }</span></span>
<span id="cb24-565"><a href="#cb24-565" aria-hidden="true" tabindex="-1"></a><span class="st">                #TOC {</span></span>
<span id="cb24-566"><a href="#cb24-566" aria-hidden="true" tabindex="-1"></a><span class="st">                    width: 280px; /* Reduz um pouco em telas menores */</span></span>
<span id="cb24-567"><a href="#cb24-567" aria-hidden="true" tabindex="-1"></a><span class="st">                }</span></span>
<span id="cb24-568"><a href="#cb24-568" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb24-569"><a href="#cb24-569" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb24-570"><a href="#cb24-570" aria-hidden="true" tabindex="-1"></a><span class="st">            @media (max-width: 1200px) {</span></span>
<span id="cb24-571"><a href="#cb24-571" aria-hidden="true" tabindex="-1"></a><span class="st">                #TOC {</span></span>
<span id="cb24-572"><a href="#cb24-572" aria-hidden="true" tabindex="-1"></a><span class="st">                    float: none;</span></span>
<span id="cb24-573"><a href="#cb24-573" aria-hidden="true" tabindex="-1"></a><span class="st">                    width: auto;</span></span>
<span id="cb24-574"><a href="#cb24-574" aria-hidden="true" tabindex="-1"></a><span class="st">                    margin: 20px 0;</span></span>
<span id="cb24-575"><a href="#cb24-575" aria-hidden="true" tabindex="-1"></a><span class="st">                    position: static;</span></span>
<span id="cb24-576"><a href="#cb24-576" aria-hidden="true" tabindex="-1"></a><span class="st">                }</span></span>
<span id="cb24-577"><a href="#cb24-577" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb24-578"><a href="#cb24-578" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb24-579"><a href="#cb24-579" aria-hidden="true" tabindex="-1"></a><span class="st">            @media (max-width: 768px) {</span></span>
<span id="cb24-580"><a href="#cb24-580" aria-hidden="true" tabindex="-1"></a><span class="st">                body { padding: 10px; font-size: 14px; }</span></span>
<span id="cb24-581"><a href="#cb24-581" aria-hidden="true" tabindex="-1"></a><span class="st">                .container { padding: 20px; max-width: 100%; }</span></span>
<span id="cb24-582"><a href="#cb24-582" aria-hidden="true" tabindex="-1"></a><span class="st">                pre { font-size: 12px; padding: 15px; }</span></span>
<span id="cb24-583"><a href="#cb24-583" aria-hidden="true" tabindex="-1"></a><span class="st">                #TOC { padding: 15px; }</span></span>
<span id="cb24-584"><a href="#cb24-584" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb24-585"><a href="#cb24-585" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb24-586"><a href="#cb24-586" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Melhorias para tabelas */</span></span>
<span id="cb24-587"><a href="#cb24-587" aria-hidden="true" tabindex="-1"></a><span class="st">            table { </span></span>
<span id="cb24-588"><a href="#cb24-588" aria-hidden="true" tabindex="-1"></a><span class="st">                width: 100%; </span></span>
<span id="cb24-589"><a href="#cb24-589" aria-hidden="true" tabindex="-1"></a><span class="st">                border-collapse: collapse; </span></span>
<span id="cb24-590"><a href="#cb24-590" aria-hidden="true" tabindex="-1"></a><span class="st">                margin: 1.5em 0;</span></span>
<span id="cb24-591"><a href="#cb24-591" aria-hidden="true" tabindex="-1"></a><span class="st">                box-shadow: 0 2px 5px rgba(0,0,0,0.1);</span></span>
<span id="cb24-592"><a href="#cb24-592" aria-hidden="true" tabindex="-1"></a><span class="st">                border-radius: 8px;</span></span>
<span id="cb24-593"><a href="#cb24-593" aria-hidden="true" tabindex="-1"></a><span class="st">                overflow: hidden;</span></span>
<span id="cb24-594"><a href="#cb24-594" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb24-595"><a href="#cb24-595" aria-hidden="true" tabindex="-1"></a><span class="st">            th, td { </span></span>
<span id="cb24-596"><a href="#cb24-596" aria-hidden="true" tabindex="-1"></a><span class="st">                border: 1px solid #dee2e6; </span></span>
<span id="cb24-597"><a href="#cb24-597" aria-hidden="true" tabindex="-1"></a><span class="st">                padding: 12px 15px; </span></span>
<span id="cb24-598"><a href="#cb24-598" aria-hidden="true" tabindex="-1"></a><span class="st">                text-align: left; </span></span>
<span id="cb24-599"><a href="#cb24-599" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb24-600"><a href="#cb24-600" aria-hidden="true" tabindex="-1"></a><span class="st">            th { </span></span>
<span id="cb24-601"><a href="#cb24-601" aria-hidden="true" tabindex="-1"></a><span class="st">                background: linear-gradient(135deg, #3498db, #2980b9);</span></span>
<span id="cb24-602"><a href="#cb24-602" aria-hidden="true" tabindex="-1"></a><span class="st">                color: white; </span></span>
<span id="cb24-603"><a href="#cb24-603" aria-hidden="true" tabindex="-1"></a><span class="st">                font-weight: bold;</span></span>
<span id="cb24-604"><a href="#cb24-604" aria-hidden="true" tabindex="-1"></a><span class="st">                text-transform: uppercase;</span></span>
<span id="cb24-605"><a href="#cb24-605" aria-hidden="true" tabindex="-1"></a><span class="st">                font-size: 0.9em;</span></span>
<span id="cb24-606"><a href="#cb24-606" aria-hidden="true" tabindex="-1"></a><span class="st">                letter-spacing: 0.5px;</span></span>
<span id="cb24-607"><a href="#cb24-607" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb24-608"><a href="#cb24-608" aria-hidden="true" tabindex="-1"></a><span class="st">            tr:nth-child(even) { </span></span>
<span id="cb24-609"><a href="#cb24-609" aria-hidden="true" tabindex="-1"></a><span class="st">                background-color: #f8f9fa; </span></span>
<span id="cb24-610"><a href="#cb24-610" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb24-611"><a href="#cb24-611" aria-hidden="true" tabindex="-1"></a><span class="st">            tr:hover { </span></span>
<span id="cb24-612"><a href="#cb24-612" aria-hidden="true" tabindex="-1"></a><span class="st">                background-color: #e3f2fd; </span></span>
<span id="cb24-613"><a href="#cb24-613" aria-hidden="true" tabindex="-1"></a><span class="st">                transition: background-color 0.2s ease;</span></span>
<span id="cb24-614"><a href="#cb24-614" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb24-615"><a href="#cb24-615" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb24-616"><a href="#cb24-616" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Melhorias para blocos de cita√ß√£o */</span></span>
<span id="cb24-617"><a href="#cb24-617" aria-hidden="true" tabindex="-1"></a><span class="st">            blockquote { </span></span>
<span id="cb24-618"><a href="#cb24-618" aria-hidden="true" tabindex="-1"></a><span class="st">                border-left: 4px solid #3498db; </span></span>
<span id="cb24-619"><a href="#cb24-619" aria-hidden="true" tabindex="-1"></a><span class="st">                margin: 25px 0; </span></span>
<span id="cb24-620"><a href="#cb24-620" aria-hidden="true" tabindex="-1"></a><span class="st">                padding-left: 25px; </span></span>
<span id="cb24-621"><a href="#cb24-621" aria-hidden="true" tabindex="-1"></a><span class="st">                color: #7f8c8d;</span></span>
<span id="cb24-622"><a href="#cb24-622" aria-hidden="true" tabindex="-1"></a><span class="st">                font-style: italic;</span></span>
<span id="cb24-623"><a href="#cb24-623" aria-hidden="true" tabindex="-1"></a><span class="st">                background: #f8f9fa;</span></span>
<span id="cb24-624"><a href="#cb24-624" aria-hidden="true" tabindex="-1"></a><span class="st">                padding: 20px;</span></span>
<span id="cb24-625"><a href="#cb24-625" aria-hidden="true" tabindex="-1"></a><span class="st">                border-radius: 0 8px 8px 0;</span></span>
<span id="cb24-626"><a href="#cb24-626" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb24-627"><a href="#cb24-627" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb24-628"><a href="#cb24-628" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Cabe√ßalhos com numera√ß√£o */</span></span>
<span id="cb24-629"><a href="#cb24-629" aria-hidden="true" tabindex="-1"></a><span class="st">            h1, h2, h3, h4, h5 { </span></span>
<span id="cb24-630"><a href="#cb24-630" aria-hidden="true" tabindex="-1"></a><span class="st">                color: #2c3e50; </span></span>
<span id="cb24-631"><a href="#cb24-631" aria-hidden="true" tabindex="-1"></a><span class="st">                margin-top: 1.8em;</span></span>
<span id="cb24-632"><a href="#cb24-632" aria-hidden="true" tabindex="-1"></a><span class="st">                border-bottom: 1px solid #e9ecef;</span></span>
<span id="cb24-633"><a href="#cb24-633" aria-hidden="true" tabindex="-1"></a><span class="st">                padding-bottom: 0.5em;</span></span>
<span id="cb24-634"><a href="#cb24-634" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb24-635"><a href="#cb24-635" aria-hidden="true" tabindex="-1"></a><span class="st">            h1 { </span></span>
<span id="cb24-636"><a href="#cb24-636" aria-hidden="true" tabindex="-1"></a><span class="st">                border-bottom: 3px solid #3498db; </span></span>
<span id="cb24-637"><a href="#cb24-637" aria-hidden="true" tabindex="-1"></a><span class="st">                padding-bottom: 15px; </span></span>
<span id="cb24-638"><a href="#cb24-638" aria-hidden="true" tabindex="-1"></a><span class="st">                color: #2c3e50;</span></span>
<span id="cb24-639"><a href="#cb24-639" aria-hidden="true" tabindex="-1"></a><span class="st">                font-size: 2.2em;</span></span>
<span id="cb24-640"><a href="#cb24-640" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb24-641"><a href="#cb24-641" aria-hidden="true" tabindex="-1"></a><span class="st">            h2 {</span></span>
<span id="cb24-642"><a href="#cb24-642" aria-hidden="true" tabindex="-1"></a><span class="st">                border-left: 4px solid #3498db;</span></span>
<span id="cb24-643"><a href="#cb24-643" aria-hidden="true" tabindex="-1"></a><span class="st">                padding-left: 15px;</span></span>
<span id="cb24-644"><a href="#cb24-644" aria-hidden="true" tabindex="-1"></a><span class="st">                margin-top: 2em;</span></span>
<span id="cb24-645"><a href="#cb24-645" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb24-646"><a href="#cb24-646" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb24-647"><a href="#cb24-647" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Scroll suave para links do TOC */</span></span>
<span id="cb24-648"><a href="#cb24-648" aria-hidden="true" tabindex="-1"></a><span class="st">            html {</span></span>
<span id="cb24-649"><a href="#cb24-649" aria-hidden="true" tabindex="-1"></a><span class="st">                scroll-behavior: smooth;</span></span>
<span id="cb24-650"><a href="#cb24-650" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb24-651"><a href="#cb24-651" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb24-652"><a href="#cb24-652" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Estilo para quando o TOC √© muito grande */</span></span>
<span id="cb24-653"><a href="#cb24-653" aria-hidden="true" tabindex="-1"></a><span class="st">            #TOC:has(ul ul ul ul) {</span></span>
<span id="cb24-654"><a href="#cb24-654" aria-hidden="true" tabindex="-1"></a><span class="st">                max-height: 80vh;</span></span>
<span id="cb24-655"><a href="#cb24-655" aria-hidden="true" tabindex="-1"></a><span class="st">                overflow-y: auto;</span></span>
<span id="cb24-656"><a href="#cb24-656" aria-hidden="true" tabindex="-1"></a><span class="st">                position: sticky;</span></span>
<span id="cb24-657"><a href="#cb24-657" aria-hidden="true" tabindex="-1"></a><span class="st">                top: 20px;</span></span>
<span id="cb24-658"><a href="#cb24-658" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb24-659"><a href="#cb24-659" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb24-660"><a href="#cb24-660" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Indicador visual para se√ß√£o ativa no TOC */</span></span>
<span id="cb24-661"><a href="#cb24-661" aria-hidden="true" tabindex="-1"></a><span class="st">            #TOC a.active {</span></span>
<span id="cb24-662"><a href="#cb24-662" aria-hidden="true" tabindex="-1"></a><span class="st">                background-color: #007bff;</span></span>
<span id="cb24-663"><a href="#cb24-663" aria-hidden="true" tabindex="-1"></a><span class="st">                color: white;</span></span>
<span id="cb24-664"><a href="#cb24-664" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb24-665"><a href="#cb24-665" aria-hidden="true" tabindex="-1"></a><span class="st">        </style></span></span>
<span id="cb24-666"><a href="#cb24-666" aria-hidden="true" tabindex="-1"></a><span class="st">        """</span></span>
<span id="cb24-667"><a href="#cb24-667" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-668"><a href="#cb24-668" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">'</head>'</span> <span class="kw">in</span> html_content:</span>
<span id="cb24-669"><a href="#cb24-669" aria-hidden="true" tabindex="-1"></a>            html_content <span class="op">=</span> html_content.replace(<span class="st">'</head>'</span>, <span class="ss">f'</span><span class="sc">{</span>enhanced_css<span class="sc">}</span><span class="ch">\n</span><span class="ss"></head>'</span>)</span>
<span id="cb24-670"><a href="#cb24-670" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="st">'<head>

        <style id="fixed-toc-styles">
        /* === ESTILOS PRINCIPAIS - TOC FIXO √Ä DIREITA === */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
            scroll-behavior: smooth;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            position: relative;
        }
        /* === TOC FIXO √Ä DIREITA - POSI√á√ÉO CORRIGIDA === */
        #TOC {
            position: fixed !important;
            top: 50% !important;
            right: 20px !important;
            transform: translateY(-50%) !important;
            width: 320px !important;
            max-height: 80vh !important;
            overflow-y: auto !important;
            z-index: 1000 !important;
            background: rgba(255, 255, 255, 0.98) !important;
            padding: 20px !important;
            border-radius: 12px !important;
            box-shadow: 0 8px 32px rgba(0,0,0,0.15) !important;
            border: 1px solid #e0e0e0 !important;
            backdrop-filter: blur(10px) !important;
            transition: all 0.3s ease-in-out !important;
        }
        #TOC.toc-minimized {
            transform: translateY(-50%) translateX(calc(320px - 50px)) !important;
            opacity: 0.3;
            width: 50px !important;
            overflow: hidden;
        }
        #TOC.toc-minimized > *:not(.toc-toggle-btn) {
            display: none !important;
        }
        #TOC h2 {
            margin-top: 0;
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
            font-size: 1.2em;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .toc-toggle-btn {
            background: none;
            border: none;
            font-size: 1.2em;
            cursor: pointer;
            padding: 5px;
            border-radius: 4px;
            transition: background-color 0.2s;
        }
        .toc-toggle-btn:hover {
            background-color: rgba(0,0,0,0.1);
        }
        #TOC ul {
            list-style-type: none;
            padding-left: 15px;
            margin: 10px 0;
        }
        #TOC ul ul {
            padding-left: 20px;
        }
        #TOC li {
            margin: 8px 0;
            line-height: 1.4;
        }
        #TOC a {
            text-decoration: none;
            color: #495057;
            font-weight: 500;
            transition: all 0.2s ease;
            display: block;
            padding: 6px 10px;
            border-radius: 6px;
            border-left: 3px solid transparent;
        }
        #TOC a:hover {
            color: #007bff;
            background-color: rgba(0, 123, 255, 0.1);
            border-left-color: #007bff;
        }
        #TOC a.active {
            background-color: #007bff !important;
            color: white !important;
            font-weight: bold;
            border-left-color: #0056b3;
        }
        /* Conte√∫do principal com margem para o TOC */
        .main-content {
            margin-right: calc(320px + 40px) !important;
        }
        /* Barra de scroll personalizada APENAS para TOC */
        #TOC::-webkit-scrollbar {
            width: 8px;
        }
        #TOC::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }
        #TOC::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 4px;
        }
        #TOC::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }
        /* === BOT√ÉO VOLTAR AO TOPO (HTMLs individuais) === */
        .back-to-top-content {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            font-size: 18px;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 999;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .back-to-top-content.show {
            opacity: 1;
            transform: translateY(0);
        }
        .back-to-top-content:hover {
            background: #0056b3;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0,0,0,0.2);
        }
        /* === RESPONSIVIDADE === */
        @media (max-width: 1400px) {
            .container {
                max-width: 95%;
                padding: 30px;
            }
            #TOC {
                width: 280px !important;
            }
            .main-content {
                margin-right: 320px !important;
            }
        }
        @media (max-width: 1200px) {
            #TOC {
                width: 260px !important;
                right: 15px !important;
            }
            .main-content {
                margin-right: 300px !important;
            }
        }
        @media (max-width: 992px) {
            #TOC {
                position: relative !important;
                width: 100% !important;
                right: 0 !important;
                top: 0 !important;
                transform: none !important;
                margin: 20px 0;
                max-height: 300px !important;
            }
            .main-content {
                margin-right: 0 !important;
            }
            .back-to-top-content {
                right: 20px;
                bottom: 20px;
            }
        }
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            .container {
                padding: 20px;
                max-width: 100%;
            }
            #TOC {
                max-height: 250px !important;
                padding: 15px !important;
            }
        }
        </style>
        '</span> <span class="kw">in</span> html_content:</span>
<span id="cb24-671"><a href="#cb24-671" aria-hidden="true" tabindex="-1"></a>            html_content <span class="op">=</span> html_content.replace(<span class="st">'<head>

        <style id="fixed-toc-styles">
        /* === ESTILOS PRINCIPAIS - TOC FIXO √Ä DIREITA === */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
            scroll-behavior: smooth;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            position: relative;
        }
        /* === TOC FIXO √Ä DIREITA - POSI√á√ÉO CORRIGIDA === */
        #TOC {
            position: fixed !important;
            top: 50% !important;
            right: 20px !important;
            transform: translateY(-50%) !important;
            width: 320px !important;
            max-height: 80vh !important;
            overflow-y: auto !important;
            z-index: 1000 !important;
            background: rgba(255, 255, 255, 0.98) !important;
            padding: 20px !important;
            border-radius: 12px !important;
            box-shadow: 0 8px 32px rgba(0,0,0,0.15) !important;
            border: 1px solid #e0e0e0 !important;
            backdrop-filter: blur(10px) !important;
            transition: all 0.3s ease-in-out !important;
        }
        #TOC.toc-minimized {
            transform: translateY(-50%) translateX(calc(320px - 50px)) !important;
            opacity: 0.3;
            width: 50px !important;
            overflow: hidden;
        }
        #TOC.toc-minimized > *:not(.toc-toggle-btn) {
            display: none !important;
        }
        #TOC h2 {
            margin-top: 0;
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
            font-size: 1.2em;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .toc-toggle-btn {
            background: none;
            border: none;
            font-size: 1.2em;
            cursor: pointer;
            padding: 5px;
            border-radius: 4px;
            transition: background-color 0.2s;
        }
        .toc-toggle-btn:hover {
            background-color: rgba(0,0,0,0.1);
        }
        #TOC ul {
            list-style-type: none;
            padding-left: 15px;
            margin: 10px 0;
        }
        #TOC ul ul {
            padding-left: 20px;
        }
        #TOC li {
            margin: 8px 0;
            line-height: 1.4;
        }
        #TOC a {
            text-decoration: none;
            color: #495057;
            font-weight: 500;
            transition: all 0.2s ease;
            display: block;
            padding: 6px 10px;
            border-radius: 6px;
            border-left: 3px solid transparent;
        }
        #TOC a:hover {
            color: #007bff;
            background-color: rgba(0, 123, 255, 0.1);
            border-left-color: #007bff;
        }
        #TOC a.active {
            background-color: #007bff !important;
            color: white !important;
            font-weight: bold;
            border-left-color: #0056b3;
        }
        /* Conte√∫do principal com margem para o TOC */
        .main-content {
            margin-right: calc(320px + 40px) !important;
        }
        /* Barra de scroll personalizada APENAS para TOC */
        #TOC::-webkit-scrollbar {
            width: 8px;
        }
        #TOC::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }
        #TOC::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 4px;
        }
        #TOC::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }
        /* === BOT√ÉO VOLTAR AO TOPO (HTMLs individuais) === */
        .back-to-top-content {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            font-size: 18px;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 999;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .back-to-top-content.show {
            opacity: 1;
            transform: translateY(0);
        }
        .back-to-top-content:hover {
            background: #0056b3;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0,0,0,0.2);
        }
        /* === RESPONSIVIDADE === */
        @media (max-width: 1400px) {
            .container {
                max-width: 95%;
                padding: 30px;
            }
            #TOC {
                width: 280px !important;
            }
            .main-content {
                margin-right: 320px !important;
            }
        }
        @media (max-width: 1200px) {
            #TOC {
                width: 260px !important;
                right: 15px !important;
            }
            .main-content {
                margin-right: 300px !important;
            }
        }
        @media (max-width: 992px) {
            #TOC {
                position: relative !important;
                width: 100% !important;
                right: 0 !important;
                top: 0 !important;
                transform: none !important;
                margin: 20px 0;
                max-height: 300px !important;
            }
            .main-content {
                margin-right: 0 !important;
            }
            .back-to-top-content {
                right: 20px;
                bottom: 20px;
            }
        }
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            .container {
                padding: 20px;
                max-width: 100%;
            }
            #TOC {
                max-height: 250px !important;
                padding: 15px !important;
            }
        }
        </style>
        '</span>, <span class="ss">f'<head>

        <style id="fixed-toc-styles">
        /* === ESTILOS PRINCIPAIS - TOC FIXO √Ä DIREITA === */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
            scroll-behavior: smooth;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            position: relative;
        }
        /* === TOC FIXO √Ä DIREITA - POSI√á√ÉO CORRIGIDA === */
        #TOC {
            position: fixed !important;
            top: 50% !important;
            right: 20px !important;
            transform: translateY(-50%) !important;
            width: 320px !important;
            max-height: 80vh !important;
            overflow-y: auto !important;
            z-index: 1000 !important;
            background: rgba(255, 255, 255, 0.98) !important;
            padding: 20px !important;
            border-radius: 12px !important;
            box-shadow: 0 8px 32px rgba(0,0,0,0.15) !important;
            border: 1px solid #e0e0e0 !important;
            backdrop-filter: blur(10px) !important;
            transition: all 0.3s ease-in-out !important;
        }
        #TOC.toc-minimized {
            transform: translateY(-50%) translateX(calc(320px - 50px)) !important;
            opacity: 0.3;
            width: 50px !important;
            overflow: hidden;
        }
        #TOC.toc-minimized > *:not(.toc-toggle-btn) {
            display: none !important;
        }
        #TOC h2 {
            margin-top: 0;
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
            font-size: 1.2em;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .toc-toggle-btn {
            background: none;
            border: none;
            font-size: 1.2em;
            cursor: pointer;
            padding: 5px;
            border-radius: 4px;
            transition: background-color 0.2s;
        }
        .toc-toggle-btn:hover {
            background-color: rgba(0,0,0,0.1);
        }
        #TOC ul {
            list-style-type: none;
            padding-left: 15px;
            margin: 10px 0;
        }
        #TOC ul ul {
            padding-left: 20px;
        }
        #TOC li {
            margin: 8px 0;
            line-height: 1.4;
        }
        #TOC a {
            text-decoration: none;
            color: #495057;
            font-weight: 500;
            transition: all 0.2s ease;
            display: block;
            padding: 6px 10px;
            border-radius: 6px;
            border-left: 3px solid transparent;
        }
        #TOC a:hover {
            color: #007bff;
            background-color: rgba(0, 123, 255, 0.1);
            border-left-color: #007bff;
        }
        #TOC a.active {
            background-color: #007bff !important;
            color: white !important;
            font-weight: bold;
            border-left-color: #0056b3;
        }
        /* Conte√∫do principal com margem para o TOC */
        .main-content {
            margin-right: calc(320px + 40px) !important;
        }
        /* Barra de scroll personalizada APENAS para TOC */
        #TOC::-webkit-scrollbar {
            width: 8px;
        }
        #TOC::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }
        #TOC::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 4px;
        }
        #TOC::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }
        /* === BOT√ÉO VOLTAR AO TOPO (HTMLs individuais) === */
        .back-to-top-content {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            font-size: 18px;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 999;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .back-to-top-content.show {
            opacity: 1;
            transform: translateY(0);
        }
        .back-to-top-content:hover {
            background: #0056b3;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0,0,0,0.2);
        }
        /* === RESPONSIVIDADE === */
        @media (max-width: 1400px) {
            .container {
                max-width: 95%;
                padding: 30px;
            }
            #TOC {
                width: 280px !important;
            }
            .main-content {
                margin-right: 320px !important;
            }
        }
        @media (max-width: 1200px) {
            #TOC {
                width: 260px !important;
                right: 15px !important;
            }
            .main-content {
                margin-right: 300px !important;
            }
        }
        @media (max-width: 992px) {
            #TOC {
                position: relative !important;
                width: 100% !important;
                right: 0 !important;
                top: 0 !important;
                transform: none !important;
                margin: 20px 0;
                max-height: 300px !important;
            }
            .main-content {
                margin-right: 0 !important;
            }
            .back-to-top-content {
                right: 20px;
                bottom: 20px;
            }
        }
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            .container {
                padding: 20px;
                max-width: 100%;
            }
            #TOC {
                max-height: 250px !important;
                padding: 15px !important;
            }
        }
        </style>
        </span><span class="ch">\n</span><span class="sc">{</span>enhanced_css<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb24-672"><a href="#cb24-672" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb24-673"><a href="#cb24-673" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="st">'<body>'</span> <span class="kw">in</span> html_content:</span>
<span id="cb24-674"><a href="#cb24-674" aria-hidden="true" tabindex="-1"></a>                html_content <span class="op">=</span> html_content.replace(<span class="st">'<body>'</span>, <span class="ss">f'<head>

        <style id="fixed-toc-styles">
        /* === ESTILOS PRINCIPAIS - TOC FIXO √Ä DIREITA === */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
            scroll-behavior: smooth;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            position: relative;
        }
        /* === TOC FIXO √Ä DIREITA - POSI√á√ÉO CORRIGIDA === */
        #TOC {
            position: fixed !important;
            top: 50% !important;
            right: 20px !important;
            transform: translateY(-50%) !important;
            width: 320px !important;
            max-height: 80vh !important;
            overflow-y: auto !important;
            z-index: 1000 !important;
            background: rgba(255, 255, 255, 0.98) !important;
            padding: 20px !important;
            border-radius: 12px !important;
            box-shadow: 0 8px 32px rgba(0,0,0,0.15) !important;
            border: 1px solid #e0e0e0 !important;
            backdrop-filter: blur(10px) !important;
            transition: all 0.3s ease-in-out !important;
        }
        #TOC.toc-minimized {
            transform: translateY(-50%) translateX(calc(320px - 50px)) !important;
            opacity: 0.3;
            width: 50px !important;
            overflow: hidden;
        }
        #TOC.toc-minimized > *:not(.toc-toggle-btn) {
            display: none !important;
        }
        #TOC h2 {
            margin-top: 0;
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
            font-size: 1.2em;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .toc-toggle-btn {
            background: none;
            border: none;
            font-size: 1.2em;
            cursor: pointer;
            padding: 5px;
            border-radius: 4px;
            transition: background-color 0.2s;
        }
        .toc-toggle-btn:hover {
            background-color: rgba(0,0,0,0.1);
        }
        #TOC ul {
            list-style-type: none;
            padding-left: 15px;
            margin: 10px 0;
        }
        #TOC ul ul {
            padding-left: 20px;
        }
        #TOC li {
            margin: 8px 0;
            line-height: 1.4;
        }
        #TOC a {
            text-decoration: none;
            color: #495057;
            font-weight: 500;
            transition: all 0.2s ease;
            display: block;
            padding: 6px 10px;
            border-radius: 6px;
            border-left: 3px solid transparent;
        }
        #TOC a:hover {
            color: #007bff;
            background-color: rgba(0, 123, 255, 0.1);
            border-left-color: #007bff;
        }
        #TOC a.active {
            background-color: #007bff !important;
            color: white !important;
            font-weight: bold;
            border-left-color: #0056b3;
        }
        /* Conte√∫do principal com margem para o TOC */
        .main-content {
            margin-right: calc(320px + 40px) !important;
        }
        /* Barra de scroll personalizada APENAS para TOC */
        #TOC::-webkit-scrollbar {
            width: 8px;
        }
        #TOC::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }
        #TOC::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 4px;
        }
        #TOC::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }
        /* === BOT√ÉO VOLTAR AO TOPO (HTMLs individuais) === */
        .back-to-top-content {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            font-size: 18px;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 999;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .back-to-top-content.show {
            opacity: 1;
            transform: translateY(0);
        }
        .back-to-top-content:hover {
            background: #0056b3;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0,0,0,0.2);
        }
        /* === RESPONSIVIDADE === */
        @media (max-width: 1400px) {
            .container {
                max-width: 95%;
                padding: 30px;
            }
            #TOC {
                width: 280px !important;
            }
            .main-content {
                margin-right: 320px !important;
            }
        }
        @media (max-width: 1200px) {
            #TOC {
                width: 260px !important;
                right: 15px !important;
            }
            .main-content {
                margin-right: 300px !important;
            }
        }
        @media (max-width: 992px) {
            #TOC {
                position: relative !important;
                width: 100% !important;
                right: 0 !important;
                top: 0 !important;
                transform: none !important;
                margin: 20px 0;
                max-height: 300px !important;
            }
            .main-content {
                margin-right: 0 !important;
            }
            .back-to-top-content {
                right: 20px;
                bottom: 20px;
            }
        }
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            .container {
                padding: 20px;
                max-width: 100%;
            }
            #TOC {
                max-height: 250px !important;
                padding: 15px !important;
            }
        }
        </style>
        </span><span class="ch">\n</span><span class="sc">{</span>enhanced_css<span class="sc">}</span><span class="ch">\n</span><span class="ss"></head></span><span class="ch">\n</span><span class="ss"><body>'</span>)</span>
<span id="cb24-675"><a href="#cb24-675" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb24-676"><a href="#cb24-676" aria-hidden="true" tabindex="-1"></a>                html_content <span class="op">=</span> <span class="ss">f'<head>

        <style id="fixed-toc-styles">
        /* === ESTILOS PRINCIPAIS - TOC FIXO √Ä DIREITA === */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
            scroll-behavior: smooth;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            position: relative;
        }
        /* === TOC FIXO √Ä DIREITA - POSI√á√ÉO CORRIGIDA === */
        #TOC {
            position: fixed !important;
            top: 50% !important;
            right: 20px !important;
            transform: translateY(-50%) !important;
            width: 320px !important;
            max-height: 80vh !important;
            overflow-y: auto !important;
            z-index: 1000 !important;
            background: rgba(255, 255, 255, 0.98) !important;
            padding: 20px !important;
            border-radius: 12px !important;
            box-shadow: 0 8px 32px rgba(0,0,0,0.15) !important;
            border: 1px solid #e0e0e0 !important;
            backdrop-filter: blur(10px) !important;
            transition: all 0.3s ease-in-out !important;
        }
        #TOC.toc-minimized {
            transform: translateY(-50%) translateX(calc(320px - 50px)) !important;
            opacity: 0.3;
            width: 50px !important;
            overflow: hidden;
        }
        #TOC.toc-minimized > *:not(.toc-toggle-btn) {
            display: none !important;
        }
        #TOC h2 {
            margin-top: 0;
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
            font-size: 1.2em;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .toc-toggle-btn {
            background: none;
            border: none;
            font-size: 1.2em;
            cursor: pointer;
            padding: 5px;
            border-radius: 4px;
            transition: background-color 0.2s;
        }
        .toc-toggle-btn:hover {
            background-color: rgba(0,0,0,0.1);
        }
        #TOC ul {
            list-style-type: none;
            padding-left: 15px;
            margin: 10px 0;
        }
        #TOC ul ul {
            padding-left: 20px;
        }
        #TOC li {
            margin: 8px 0;
            line-height: 1.4;
        }
        #TOC a {
            text-decoration: none;
            color: #495057;
            font-weight: 500;
            transition: all 0.2s ease;
            display: block;
            padding: 6px 10px;
            border-radius: 6px;
            border-left: 3px solid transparent;
        }
        #TOC a:hover {
            color: #007bff;
            background-color: rgba(0, 123, 255, 0.1);
            border-left-color: #007bff;
        }
        #TOC a.active {
            background-color: #007bff !important;
            color: white !important;
            font-weight: bold;
            border-left-color: #0056b3;
        }
        /* Conte√∫do principal com margem para o TOC */
        .main-content {
            margin-right: calc(320px + 40px) !important;
        }
        /* Barra de scroll personalizada APENAS para TOC */
        #TOC::-webkit-scrollbar {
            width: 8px;
        }
        #TOC::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }
        #TOC::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 4px;
        }
        #TOC::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }
        /* === BOT√ÉO VOLTAR AO TOPO (HTMLs individuais) === */
        .back-to-top-content {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            font-size: 18px;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 999;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .back-to-top-content.show {
            opacity: 1;
            transform: translateY(0);
        }
        .back-to-top-content:hover {
            background: #0056b3;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0,0,0,0.2);
        }
        /* === RESPONSIVIDADE === */
        @media (max-width: 1400px) {
            .container {
                max-width: 95%;
                padding: 30px;
            }
            #TOC {
                width: 280px !important;
            }
            .main-content {
                margin-right: 320px !important;
            }
        }
        @media (max-width: 1200px) {
            #TOC {
                width: 260px !important;
                right: 15px !important;
            }
            .main-content {
                margin-right: 300px !important;
            }
        }
        @media (max-width: 992px) {
            #TOC {
                position: relative !important;
                width: 100% !important;
                right: 0 !important;
                top: 0 !important;
                transform: none !important;
                margin: 20px 0;
                max-height: 300px !important;
            }
            .main-content {
                margin-right: 0 !important;
            }
            .back-to-top-content {
                right: 20px;
                bottom: 20px;
            }
        }
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            .container {
                padding: 20px;
                max-width: 100%;
            }
            #TOC {
                max-height: 250px !important;
                padding: 15px !important;
            }
        }
        </style>
        </span><span class="ch">\n</span><span class="sc">{</span>enhanced_css<span class="sc">}</span><span class="ch">\n</span><span class="ss"></head></span><span class="ch">\n</span><span class="ss"><body></span><span class="ch">\n</span><span class="sc">{</span>html_content<span class="sc">}</span><span class="ch">\n</span><span class="ss">
        <script id="fixed-toc-script">
        document.addEventListener('DOMContentLoaded', function() {
            const toc = document.getElementById('TOC');
            if (toc) {
                const tocTitle = toc.querySelector('h2');
                if (tocTitle) {
                    const toggleBtn = document.createElement('button');
                    toggleBtn.innerHTML = '‚ò∞';
                    toggleBtn.className = 'toc-toggle-btn';
                    toggleBtn.title = 'Minimizar/Expandir TOC';
                    let isMinimized = false;
                    toggleBtn.addEventListener('click', function(e) {
                        e.stopPropagation();
                        isMinimized = !isMinimized;
                        if (isMinimized) {
                            toc.classList.add('toc-minimized');
                        } else {
                            toc.classList.remove('toc-minimized');
                        }
                    });
                    tocTitle.appendChild(toggleBtn);
                }
            }
            
            // SCROLLSPY
            const sections = document.querySelectorAll('h1, h2, h3, h4, h5');
            const tocLinks = document.querySelectorAll('#TOC a');
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const id = entry.target.getAttribute('id');
                        tocLinks.forEach(link => {
                            link.classList.remove('active');
                            if (link.getAttribute('href') === '#' + id) {
                                link.classList.add('active');
                            }
                        });
                    }
                });
            }, { 
                rootMargin: '-20% 0px -60% 0px', 
                threshold: 0 
            });
            
            sections.forEach(section => {
                if (section.id) observer.observe(section);
            });
            
            // Scroll suave
            tocLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const targetId = link.getAttribute('href').substring(1);
                    const targetElement = document.getElementById(targetId);
                    if (targetElement) {
                        const offsetTop = targetElement.offsetTop - 80;
                        window.scrollTo({ top: offsetTop, behavior: 'smooth' });
                    }
                });
            });
            
            // BOT√ÉO VOLTAR AO TOPO
            const backToTopBtn = document.createElement('button');
            backToTopBtn.className = 'back-to-top-content';
            backToTopBtn.innerHTML = '‚Üë';
            backToTopBtn.title = 'Voltar ao Topo';
            document.body.appendChild(backToTopBtn);
            
            window.addEventListener('scroll', () => {
                if (window.pageYOffset > 300) {
                    backToTopBtn.classList.add('show');
                } else {
                    backToTopBtn.classList.remove('show');
                }
            });
            
            backToTopBtn.addEventListener('click', () => {
                window.scrollTo({ top: 0, behavior: 'smooth' });
            });
        });
        </script>
        
</body>'</span></span>
<span id="cb24-677"><a href="#cb24-677" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb24-678"><a href="#cb24-678" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> html_content</span>
<span id="cb24-679"><a href="#cb24-679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-680"><a href="#cb24-680" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _enhance_toc_styling(<span class="va">self</span>, html_content: <span class="bu">str</span>) <span class="op">-></span> <span class="bu">str</span>:</span>
<span id="cb24-681"><a href="#cb24-681" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Melhora o estilo do Table of Contents gerado pelo Pandoc"""</span></span>
<span id="cb24-682"><a href="#cb24-682" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Adiciona t√≠tulo ao TOC se n√£o existir</span></span>
<span id="cb24-683"><a href="#cb24-683" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">'<div id="TOC">'</span> <span class="kw">in</span> html_content <span class="kw">and</span> <span class="st">'Table of Contents'</span> <span class="kw">not</span> <span class="kw">in</span> html_content:</span>
<span id="cb24-684"><a href="#cb24-684" aria-hidden="true" tabindex="-1"></a>            html_content <span class="op">=</span> html_content.replace(</span>
<span id="cb24-685"><a href="#cb24-685" aria-hidden="true" tabindex="-1"></a>                <span class="st">'<div id="TOC">'</span>, </span>
<span id="cb24-686"><a href="#cb24-686" aria-hidden="true" tabindex="-1"></a>                <span class="st">'<div id="TOC"><h2 style="margin-top: 0; color: #2c3e50; border-bottom: 2px solid #3498db; padding-bottom: 10px;">üìë Table of Contents</h2>'</span></span>
<span id="cb24-687"><a href="#cb24-687" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb24-688"><a href="#cb24-688" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-689"><a href="#cb24-689" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Adiciona wrapper para conte√∫do principal com clearfix</span></span>
<span id="cb24-690"><a href="#cb24-690" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">'<div id="TOC">'</span> <span class="kw">in</span> html_content <span class="kw">and</span> <span class="st">'<body>'</span> <span class="kw">in</span> html_content:</span>
<span id="cb24-691"><a href="#cb24-691" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Encontra o TOC e envolve o conte√∫do restante</span></span>
<span id="cb24-692"><a href="#cb24-692" aria-hidden="true" tabindex="-1"></a>            toc_end <span class="op">=</span> html_content.find(<span class="st">'</div>'</span>, html_content.find(<span class="st">'<div id="TOC">'</span>)) <span class="op">+</span> <span class="dv">6</span></span>
<span id="cb24-693"><a href="#cb24-693" aria-hidden="true" tabindex="-1"></a>            body_content <span class="op">=</span> html_content[toc_end:]</span>
<span id="cb24-694"><a href="#cb24-694" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="st">'<div class="main-content">'</span> <span class="kw">not</span> <span class="kw">in</span> body_content:</span>
<span id="cb24-695"><a href="#cb24-695" aria-hidden="true" tabindex="-1"></a>                html_content <span class="op">=</span> html_content[:toc_end] <span class="op">+</span> <span class="st">'</span><span class="ch">\n</span><span class="st"><div class="main-content">'</span> <span class="op">+</span> body_content <span class="op">+</span> <span class="st">'</span><span class="ch">\n</span><span class="st"></div>'</span></span>
<span id="cb24-696"><a href="#cb24-696" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-697"><a href="#cb24-697" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> html_content</span>
<span id="cb24-698"><a href="#cb24-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-699"><a href="#cb24-699" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _convert_with_fallback(<span class="va">self</span>, md_file_path: <span class="bu">str</span>) <span class="op">-></span> <span class="bu">str</span>:</span>
<span id="cb24-700"><a href="#cb24-700" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Fallback para convers√£o quando Pandoc falha"""</span></span>
<span id="cb24-701"><a href="#cb24-701" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb24-702"><a href="#cb24-702" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(md_file_path, <span class="st">'r'</span>, encoding<span class="op">=</span><span class="st">'utf-8'</span>) <span class="im">as</span> f:</span>
<span id="cb24-703"><a href="#cb24-703" aria-hidden="true" tabindex="-1"></a>                md_content <span class="op">=</span> f.read()</span>
<span id="cb24-704"><a href="#cb24-704" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-705"><a href="#cb24-705" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Extens√µes avan√ßadas para melhor convers√£o</span></span>
<span id="cb24-706"><a href="#cb24-706" aria-hidden="true" tabindex="-1"></a>            extensions <span class="op">=</span> [</span>
<span id="cb24-707"><a href="#cb24-707" aria-hidden="true" tabindex="-1"></a>                <span class="st">'extra'</span>, <span class="st">'tables'</span>, <span class="st">'fenced_code'</span>, <span class="st">'codehilite'</span>, </span>
<span id="cb24-708"><a href="#cb24-708" aria-hidden="true" tabindex="-1"></a>                <span class="st">'toc'</span>, <span class="st">'md_in_html'</span>, <span class="st">'attr_list'</span></span>
<span id="cb24-709"><a href="#cb24-709" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb24-710"><a href="#cb24-710" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-711"><a href="#cb24-711" aria-hidden="true" tabindex="-1"></a>            html_content <span class="op">=</span> markdown.markdown(</span>
<span id="cb24-712"><a href="#cb24-712" aria-hidden="true" tabindex="-1"></a>                md_content,</span>
<span id="cb24-713"><a href="#cb24-713" aria-hidden="true" tabindex="-1"></a>                extensions<span class="op">=</span>extensions,</span>
<span id="cb24-714"><a href="#cb24-714" aria-hidden="true" tabindex="-1"></a>                output_format<span class="op">=</span><span class="st">'html5'</span></span>
<span id="cb24-715"><a href="#cb24-715" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb24-716"><a href="#cb24-716" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-717"><a href="#cb24-717" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">self</span>._create_enhanced_html_template(html_content, Path(md_file_path).name)</span>
<span id="cb24-718"><a href="#cb24-718" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-719"><a href="#cb24-719" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb24-720"><a href="#cb24-720" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.error(<span class="ss">f"‚ùå Fallback tamb√©m falhou: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb24-721"><a href="#cb24-721" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">self</span>._create_basic_html(md_content, Path(md_file_path).name)</span>
<span id="cb24-722"><a href="#cb24-722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-723"><a href="#cb24-723" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _create_enhanced_html_template(<span class="va">self</span>, content: <span class="bu">str</span>, title: <span class="bu">str</span>) <span class="op">-></span> <span class="bu">str</span>:</span>
<span id="cb24-724"><a href="#cb24-724" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Template HTML aprimorado com suporte a MathJax local/online e TOC flutuante"""</span></span>
<span id="cb24-725"><a href="#cb24-725" aria-hidden="true" tabindex="-1"></a>        mathjax_src <span class="op">=</span> <span class="st">"assets/tex-mml-chtml.js"</span> <span class="cf">if</span> Path(<span class="st">"assets/tex-mml-chtml.js"</span>).exists() <span class="cf">else</span> <span class="st">"https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"</span></span>
<span id="cb24-726"><a href="#cb24-726" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-727"><a href="#cb24-727" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="ss">f"""<!DOCTYPE html></span></span>
<span id="cb24-728"><a href="#cb24-728" aria-hidden="true" tabindex="-1"></a><span class="ss"><html lang="pt-BR"></span></span>
<span id="cb24-729"><a href="#cb24-729" aria-hidden="true" tabindex="-1"></a><span class="ss"><head>

        <style id="fixed-toc-styles">
        /* === ESTILOS PRINCIPAIS - TOC FIXO √Ä DIREITA === */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
            scroll-behavior: smooth;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            position: relative;
        }
        /* === TOC FIXO √Ä DIREITA - POSI√á√ÉO CORRIGIDA === */
        #TOC {
            position: fixed !important;
            top: 50% !important;
            right: 20px !important;
            transform: translateY(-50%) !important;
            width: 320px !important;
            max-height: 80vh !important;
            overflow-y: auto !important;
            z-index: 1000 !important;
            background: rgba(255, 255, 255, 0.98) !important;
            padding: 20px !important;
            border-radius: 12px !important;
            box-shadow: 0 8px 32px rgba(0,0,0,0.15) !important;
            border: 1px solid #e0e0e0 !important;
            backdrop-filter: blur(10px) !important;
            transition: all 0.3s ease-in-out !important;
        }
        #TOC.toc-minimized {
            transform: translateY(-50%) translateX(calc(320px - 50px)) !important;
            opacity: 0.3;
            width: 50px !important;
            overflow: hidden;
        }
        #TOC.toc-minimized > *:not(.toc-toggle-btn) {
            display: none !important;
        }
        #TOC h2 {
            margin-top: 0;
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
            font-size: 1.2em;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .toc-toggle-btn {
            background: none;
            border: none;
            font-size: 1.2em;
            cursor: pointer;
            padding: 5px;
            border-radius: 4px;
            transition: background-color 0.2s;
        }
        .toc-toggle-btn:hover {
            background-color: rgba(0,0,0,0.1);
        }
        #TOC ul {
            list-style-type: none;
            padding-left: 15px;
            margin: 10px 0;
        }
        #TOC ul ul {
            padding-left: 20px;
        }
        #TOC li {
            margin: 8px 0;
            line-height: 1.4;
        }
        #TOC a {
            text-decoration: none;
            color: #495057;
            font-weight: 500;
            transition: all 0.2s ease;
            display: block;
            padding: 6px 10px;
            border-radius: 6px;
            border-left: 3px solid transparent;
        }
        #TOC a:hover {
            color: #007bff;
            background-color: rgba(0, 123, 255, 0.1);
            border-left-color: #007bff;
        }
        #TOC a.active {
            background-color: #007bff !important;
            color: white !important;
            font-weight: bold;
            border-left-color: #0056b3;
        }
        /* Conte√∫do principal com margem para o TOC */
        .main-content {
            margin-right: calc(320px + 40px) !important;
        }
        /* Barra de scroll personalizada APENAS para TOC */
        #TOC::-webkit-scrollbar {
            width: 8px;
        }
        #TOC::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }
        #TOC::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 4px;
        }
        #TOC::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }
        /* === BOT√ÉO VOLTAR AO TOPO (HTMLs individuais) === */
        .back-to-top-content {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            font-size: 18px;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 999;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .back-to-top-content.show {
            opacity: 1;
            transform: translateY(0);
        }
        .back-to-top-content:hover {
            background: #0056b3;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0,0,0,0.2);
        }
        /* === RESPONSIVIDADE === */
        @media (max-width: 1400px) {
            .container {
                max-width: 95%;
                padding: 30px;
            }
            #TOC {
                width: 280px !important;
            }
            .main-content {
                margin-right: 320px !important;
            }
        }
        @media (max-width: 1200px) {
            #TOC {
                width: 260px !important;
                right: 15px !important;
            }
            .main-content {
                margin-right: 300px !important;
            }
        }
        @media (max-width: 992px) {
            #TOC {
                position: relative !important;
                width: 100% !important;
                right: 0 !important;
                top: 0 !important;
                transform: none !important;
                margin: 20px 0;
                max-height: 300px !important;
            }
            .main-content {
                margin-right: 0 !important;
            }
            .back-to-top-content {
                right: 20px;
                bottom: 20px;
            }
        }
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            .container {
                padding: 20px;
                max-width: 100%;
            }
            #TOC {
                max-height: 250px !important;
                padding: 15px !important;
            }
        }
        </style>
        </span></span>
<span id="cb24-730"><a href="#cb24-730" aria-hidden="true" tabindex="-1"></a><span class="ss">    <meta charset="UTF-8"></span></span>
<span id="cb24-731"><a href="#cb24-731" aria-hidden="true" tabindex="-1"></a><span class="ss">    <meta name="viewport" content="width=device-width, initial-scale=1.0"></span></span>
<span id="cb24-732"><a href="#cb24-732" aria-hidden="true" tabindex="-1"></a><span class="ss">    <title></span><span class="sc">{</span>title<span class="sc">}</span><span class="ss"></title></span></span>
<span id="cb24-733"><a href="#cb24-733" aria-hidden="true" tabindex="-1"></a><span class="ss">    <style></span></span>
<span id="cb24-734"><a href="#cb24-734" aria-hidden="true" tabindex="-1"></a><span class="ss">        /* LAYOUT DE TELA COMPLETA OTIMIZADO */</span></span>
<span id="cb24-735"><a href="#cb24-735" aria-hidden="true" tabindex="-1"></a><span class="ss">        body </span><span class="ch">{{</span></span>
<span id="cb24-736"><a href="#cb24-736" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;</span></span>
<span id="cb24-737"><a href="#cb24-737" aria-hidden="true" tabindex="-1"></a><span class="ss">            line-height: 1.6;</span></span>
<span id="cb24-738"><a href="#cb24-738" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin: 0;</span></span>
<span id="cb24-739"><a href="#cb24-739" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 20px;</span></span>
<span id="cb24-740"><a href="#cb24-740" aria-hidden="true" tabindex="-1"></a><span class="ss">            background-color: #f5f5f5;</span></span>
<span id="cb24-741"><a href="#cb24-741" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #333;</span></span>
<span id="cb24-742"><a href="#cb24-742" aria-hidden="true" tabindex="-1"></a><span class="ss">            max-width: none; /* Remove limita√ß√£o de largura - TELA COMPLETA */</span></span>
<span id="cb24-743"><a href="#cb24-743" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb24-744"><a href="#cb24-744" aria-hidden="true" tabindex="-1"></a><span class="ss">        .container </span><span class="ch">{{</span></span>
<span id="cb24-745"><a href="#cb24-745" aria-hidden="true" tabindex="-1"></a><span class="ss">            max-width: 95%; /* Usa quase toda a largura dispon√≠vel */</span></span>
<span id="cb24-746"><a href="#cb24-746" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin: 0 auto;</span></span>
<span id="cb24-747"><a href="#cb24-747" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: white;</span></span>
<span id="cb24-748"><a href="#cb24-748" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 40px;</span></span>
<span id="cb24-749"><a href="#cb24-749" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 10px;</span></span>
<span id="cb24-750"><a href="#cb24-750" aria-hidden="true" tabindex="-1"></a><span class="ss">            box-shadow: 0 5px 20px rgba(0,0,0,0.1);</span></span>
<span id="cb24-751"><a href="#cb24-751" aria-hidden="true" tabindex="-1"></a><span class="ss">            position: relative; /* Para posicionamento do TOC */</span></span>
<span id="cb24-752"><a href="#cb24-752" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb24-753"><a href="#cb24-753" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb24-754"><a href="#cb24-754" aria-hidden="true" tabindex="-1"></a><span class="ss">        /* TOC FLUTUANTE MANUAL */</span></span>
<span id="cb24-755"><a href="#cb24-755" aria-hidden="true" tabindex="-1"></a><span class="ss">        .toc </span><span class="ch">{{</span></span>
<span id="cb24-756"><a href="#cb24-756" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);</span></span>
<span id="cb24-757"><a href="#cb24-757" aria-hidden="true" tabindex="-1"></a><span class="ss">            border: 1px solid #dee2e6;</span></span>
<span id="cb24-758"><a href="#cb24-758" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 8px;</span></span>
<span id="cb24-759"><a href="#cb24-759" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 20px;</span></span>
<span id="cb24-760"><a href="#cb24-760" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin: 20px 0;</span></span>
<span id="cb24-761"><a href="#cb24-761" aria-hidden="true" tabindex="-1"></a><span class="ss">            box-shadow: 0 2px 10px rgba(0,0,0,0.1);</span></span>
<span id="cb24-762"><a href="#cb24-762" aria-hidden="true" tabindex="-1"></a><span class="ss">            float: right; /* FLUTUA √Ä DIREITA */</span></span>
<span id="cb24-763"><a href="#cb24-763" aria-hidden="true" tabindex="-1"></a><span class="ss">            width: 320px; /* Largura fixa para TOC */</span></span>
<span id="cb24-764"><a href="#cb24-764" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-left: 30px;</span></span>
<span id="cb24-765"><a href="#cb24-765" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-bottom: 30px;</span></span>
<span id="cb24-766"><a href="#cb24-766" aria-hidden="true" tabindex="-1"></a><span class="ss">            position: relative;</span></span>
<span id="cb24-767"><a href="#cb24-767" aria-hidden="true" tabindex="-1"></a><span class="ss">            z-index: 100;</span></span>
<span id="cb24-768"><a href="#cb24-768" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb24-769"><a href="#cb24-769" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb24-770"><a href="#cb24-770" aria-hidden="true" tabindex="-1"></a><span class="ss">        .toc h2 </span><span class="ch">{{</span></span>
<span id="cb24-771"><a href="#cb24-771" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-top: 0;</span></span>
<span id="cb24-772"><a href="#cb24-772" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #2c3e50;</span></span>
<span id="cb24-773"><a href="#cb24-773" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-bottom: 2px solid #3498db;</span></span>
<span id="cb24-774"><a href="#cb24-774" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding-bottom: 10px;</span></span>
<span id="cb24-775"><a href="#cb24-775" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb24-776"><a href="#cb24-776" aria-hidden="true" tabindex="-1"></a><span class="ss">        .toc ul </span><span class="ch">{{</span></span>
<span id="cb24-777"><a href="#cb24-777" aria-hidden="true" tabindex="-1"></a><span class="ss">            list-style-type: none;</span></span>
<span id="cb24-778"><a href="#cb24-778" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding-left: 15px;</span></span>
<span id="cb24-779"><a href="#cb24-779" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb24-780"><a href="#cb24-780" aria-hidden="true" tabindex="-1"></a><span class="ss">        .toc ul ul </span><span class="ch">{{</span></span>
<span id="cb24-781"><a href="#cb24-781" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding-left: 25px;</span></span>
<span id="cb24-782"><a href="#cb24-782" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb24-783"><a href="#cb24-783" aria-hidden="true" tabindex="-1"></a><span class="ss">        .toc ul ul ul </span><span class="ch">{{</span></span>
<span id="cb24-784"><a href="#cb24-784" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding-left: 35px; /* Mais indenta√ß√£o para n√≠vel 3 */</span></span>
<span id="cb24-785"><a href="#cb24-785" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb24-786"><a href="#cb24-786" aria-hidden="true" tabindex="-1"></a><span class="ss">        .toc li </span><span class="ch">{{</span></span>
<span id="cb24-787"><a href="#cb24-787" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin: 8px 0;</span></span>
<span id="cb24-788"><a href="#cb24-788" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb24-789"><a href="#cb24-789" aria-hidden="true" tabindex="-1"></a><span class="ss">        .toc a </span><span class="ch">{{</span></span>
<span id="cb24-790"><a href="#cb24-790" aria-hidden="true" tabindex="-1"></a><span class="ss">            text-decoration: none;</span></span>
<span id="cb24-791"><a href="#cb24-791" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #495057;</span></span>
<span id="cb24-792"><a href="#cb24-792" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-weight: 500;</span></span>
<span id="cb24-793"><a href="#cb24-793" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: block;</span></span>
<span id="cb24-794"><a href="#cb24-794" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 4px 8px;</span></span>
<span id="cb24-795"><a href="#cb24-795" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 4px;</span></span>
<span id="cb24-796"><a href="#cb24-796" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb24-797"><a href="#cb24-797" aria-hidden="true" tabindex="-1"></a><span class="ss">        .toc a:hover </span><span class="ch">{{</span></span>
<span id="cb24-798"><a href="#cb24-798" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #007bff;</span></span>
<span id="cb24-799"><a href="#cb24-799" aria-hidden="true" tabindex="-1"></a><span class="ss">            background-color: rgba(0, 123, 255, 0.1);</span></span>
<span id="cb24-800"><a href="#cb24-800" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb24-801"><a href="#cb24-801" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb24-802"><a href="#cb24-802" aria-hidden="true" tabindex="-1"></a><span class="ss">        /* CLEARFIX PARA LAYOUT COM TOC FLUTUANTE */</span></span>
<span id="cb24-803"><a href="#cb24-803" aria-hidden="true" tabindex="-1"></a><span class="ss">        .main-content </span><span class="ch">{{</span></span>
<span id="cb24-804"><a href="#cb24-804" aria-hidden="true" tabindex="-1"></a><span class="ss">            overflow: hidden; /* PREVINE PROBLEMAS COM ELEMENTOS FLUTUANTES */</span></span>
<span id="cb24-805"><a href="#cb24-805" aria-hidden="true" tabindex="-1"></a><span class="ss">            position: relative;</span></span>
<span id="cb24-806"><a href="#cb24-806" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb24-807"><a href="#cb24-807" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb24-808"><a href="#cb24-808" aria-hidden="true" tabindex="-1"></a><span class="ss">        h1, h2, h3, h4, h5 </span><span class="ch">{{</span></span>
<span id="cb24-809"><a href="#cb24-809" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #2c3e50;</span></span>
<span id="cb24-810"><a href="#cb24-810" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-top: 1.8em;</span></span>
<span id="cb24-811"><a href="#cb24-811" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb24-812"><a href="#cb24-812" aria-hidden="true" tabindex="-1"></a><span class="ss">        h1 </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb24-813"><a href="#cb24-813" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-bottom: 3px solid #3498db; </span></span>
<span id="cb24-814"><a href="#cb24-814" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding-bottom: 15px; </span></span>
<span id="cb24-815"><a href="#cb24-815" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #2c3e50;</span></span>
<span id="cb24-816"><a href="#cb24-816" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 2.2em;</span></span>
<span id="cb24-817"><a href="#cb24-817" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb24-818"><a href="#cb24-818" aria-hidden="true" tabindex="-1"></a><span class="ss">        h2 </span><span class="ch">{{</span></span>
<span id="cb24-819"><a href="#cb24-819" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-left: 4px solid #3498db;</span></span>
<span id="cb24-820"><a href="#cb24-820" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding-left: 15px;</span></span>
<span id="cb24-821"><a href="#cb24-821" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-top: 2em;</span></span>
<span id="cb24-822"><a href="#cb24-822" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb24-823"><a href="#cb24-823" aria-hidden="true" tabindex="-1"></a><span class="ss">        code </span><span class="ch">{{</span></span>
<span id="cb24-824"><a href="#cb24-824" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #f4f4f4;</span></span>
<span id="cb24-825"><a href="#cb24-825" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 3px 8px;</span></span>
<span id="cb24-826"><a href="#cb24-826" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 4px;</span></span>
<span id="cb24-827"><a href="#cb24-827" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;</span></span>
<span id="cb24-828"><a href="#cb24-828" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #c7254e;</span></span>
<span id="cb24-829"><a href="#cb24-829" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.9em;</span></span>
<span id="cb24-830"><a href="#cb24-830" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb24-831"><a href="#cb24-831" aria-hidden="true" tabindex="-1"></a><span class="ss">        pre </span><span class="ch">{{</span></span>
<span id="cb24-832"><a href="#cb24-832" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #2d2d2d;</span></span>
<span id="cb24-833"><a href="#cb24-833" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #f8f8f2;</span></span>
<span id="cb24-834"><a href="#cb24-834" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 20px;</span></span>
<span id="cb24-835"><a href="#cb24-835" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 8px;</span></span>
<span id="cb24-836"><a href="#cb24-836" aria-hidden="true" tabindex="-1"></a><span class="ss">            overflow-x: auto;</span></span>
<span id="cb24-837"><a href="#cb24-837" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-left: 5px solid #3498db;</span></span>
<span id="cb24-838"><a href="#cb24-838" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;</span></span>
<span id="cb24-839"><a href="#cb24-839" aria-hidden="true" tabindex="-1"></a><span class="ss">            line-height: 1.4;</span></span>
<span id="cb24-840"><a href="#cb24-840" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb24-841"><a href="#cb24-841" aria-hidden="true" tabindex="-1"></a><span class="ss">        pre code </span><span class="ch">{{</span></span>
<span id="cb24-842"><a href="#cb24-842" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: none;</span></span>
<span id="cb24-843"><a href="#cb24-843" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: inherit;</span></span>
<span id="cb24-844"><a href="#cb24-844" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 0;</span></span>
<span id="cb24-845"><a href="#cb24-845" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb24-846"><a href="#cb24-846" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb24-847"><a href="#cb24-847" aria-hidden="true" tabindex="-1"></a><span class="ss">        /* CORRE√á√ÉO CR√çTICA: Garantir visibilidade do texto */</span></span>
<span id="cb24-848"><a href="#cb24-848" aria-hidden="true" tabindex="-1"></a><span class="ss">        .sourceCode, pre, code </span><span class="ch">{{</span></span>
<span id="cb24-849"><a href="#cb24-849" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #f8f8f2 !important;</span></span>
<span id="cb24-850"><a href="#cb24-850" aria-hidden="true" tabindex="-1"></a><span class="ss">            background-color: #2d2d2d !important;</span></span>
<span id="cb24-851"><a href="#cb24-851" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb24-852"><a href="#cb24-852" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-853"><a href="#cb24-853" aria-hidden="true" tabindex="-1"></a><span class="ss">        .sourceCode span </span><span class="ch">{{</span></span>
<span id="cb24-854"><a href="#cb24-854" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #f8f8f2 !important;</span></span>
<span id="cb24-855"><a href="#cb24-855" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: transparent !important;</span></span>
<span id="cb24-856"><a href="#cb24-856" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb24-857"><a href="#cb24-857" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-858"><a href="#cb24-858" aria-hidden="true" tabindex="-1"></a><span class="ss">        /* Corre√ß√£o para syntax highlighting */</span></span>
<span id="cb24-859"><a href="#cb24-859" aria-hidden="true" tabindex="-1"></a><span class="ss">        .sourceCode .kw </span><span class="ch">{{</span><span class="ss"> color: #ff79c6 !important; </span><span class="ch">}}</span></span>
<span id="cb24-860"><a href="#cb24-860" aria-hidden="true" tabindex="-1"></a><span class="ss">        .sourceCode .dt </span><span class="ch">{{</span><span class="ss"> color: #8be9fd !important; </span><span class="ch">}}</span></span>
<span id="cb24-861"><a href="#cb24-861" aria-hidden="true" tabindex="-1"></a><span class="ss">        .sourceCode .dv </span><span class="ch">{{</span><span class="ss"> color: #bd93f9 !important; </span><span class="ch">}}</span></span>
<span id="cb24-862"><a href="#cb24-862" aria-hidden="true" tabindex="-1"></a><span class="ss">        .sourceCode .bn </span><span class="ch">{{</span><span class="ss"> color: #bd93f9 !important; </span><span class="ch">}}</span></span>
<span id="cb24-863"><a href="#cb24-863" aria-hidden="true" tabindex="-1"></a><span class="ss">        .sourceCode .fl </span><span class="ch">{{</span><span class="ss"> color: #bd93f9 !important; </span><span class="ch">}}</span></span>
<span id="cb24-864"><a href="#cb24-864" aria-hidden="true" tabindex="-1"></a><span class="ss">        .sourceCode .ch </span><span class="ch">{{</span><span class="ss"> color: #f1fa8c !important; </span><span class="ch">}}</span></span>
<span id="cb24-865"><a href="#cb24-865" aria-hidden="true" tabindex="-1"></a><span class="ss">        .sourceCode .st </span><span class="ch">{{</span><span class="ss"> color: #f1fa8c !important; </span><span class="ch">}}</span></span>
<span id="cb24-866"><a href="#cb24-866" aria-hidden="true" tabindex="-1"></a><span class="ss">        .sourceCode .co </span><span class="ch">{{</span><span class="ss"> color: #6272a4 !important; </span><span class="ch">}}</span></span>
<span id="cb24-867"><a href="#cb24-867" aria-hidden="true" tabindex="-1"></a><span class="ss">        .sourceCode .ot </span><span class="ch">{{</span><span class="ss"> color: #50fa7b !important; </span><span class="ch">}}</span></span>
<span id="cb24-868"><a href="#cb24-868" aria-hidden="true" tabindex="-1"></a><span class="ss">        .sourceCode .al </span><span class="ch">{{</span><span class="ss"> color: #ff5555 !important; </span><span class="ch">}}</span></span>
<span id="cb24-869"><a href="#cb24-869" aria-hidden="true" tabindex="-1"></a><span class="ss">        .sourceCode .fu </span><span class="ch">{{</span><span class="ss"> color: #50fa7b !important; </span><span class="ch">}}</span></span>
<span id="cb24-870"><a href="#cb24-870" aria-hidden="true" tabindex="-1"></a><span class="ss">        .sourceCode .re </span><span class="ch">{{</span><span class="ss"> color: #f1fa8c !important; </span><span class="ch">}}</span></span>
<span id="cb24-871"><a href="#cb24-871" aria-hidden="true" tabindex="-1"></a><span class="ss">        .sourceCode .er </span><span class="ch">{{</span><span class="ss"> color: #ff5555 !important; </span><span class="ch">}}</span></span>
<span id="cb24-872"><a href="#cb24-872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-873"><a href="#cb24-873" aria-hidden="true" tabindex="-1"></a><span class="ss">        /* Garantir contraste para texto normal */</span></span>
<span id="cb24-874"><a href="#cb24-874" aria-hidden="true" tabindex="-1"></a><span class="ss">        body, .container </span><span class="ch">{{</span></span>
<span id="cb24-875"><a href="#cb24-875" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #2c3e50 !important;</span></span>
<span id="cb24-876"><a href="#cb24-876" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb24-877"><a href="#cb24-877" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-878"><a href="#cb24-878" aria-hidden="true" tabindex="-1"></a><span class="ss">        p, li, td, th </span><span class="ch">{{</span></span>
<span id="cb24-879"><a href="#cb24-879" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #2c3e50 !important;</span></span>
<span id="cb24-880"><a href="#cb24-880" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb24-881"><a href="#cb24-881" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb24-882"><a href="#cb24-882" aria-hidden="true" tabindex="-1"></a><span class="ss">        blockquote </span><span class="ch">{{</span></span>
<span id="cb24-883"><a href="#cb24-883" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-left: 4px solid #3498db;</span></span>
<span id="cb24-884"><a href="#cb24-884" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin: 25px 0;</span></span>
<span id="cb24-885"><a href="#cb24-885" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding-left: 25px;</span></span>
<span id="cb24-886"><a href="#cb24-886" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #7f8c8d;</span></span>
<span id="cb24-887"><a href="#cb24-887" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-style: italic;</span></span>
<span id="cb24-888"><a href="#cb24-888" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #f8f9fa;</span></span>
<span id="cb24-889"><a href="#cb24-889" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 20px;</span></span>
<span id="cb24-890"><a href="#cb24-890" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 0 8px 8px 0;</span></span>
<span id="cb24-891"><a href="#cb24-891" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb24-892"><a href="#cb24-892" aria-hidden="true" tabindex="-1"></a><span class="ss">        table </span><span class="ch">{{</span></span>
<span id="cb24-893"><a href="#cb24-893" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-collapse: collapse;</span></span>
<span id="cb24-894"><a href="#cb24-894" aria-hidden="true" tabindex="-1"></a><span class="ss">            width: 100%;</span></span>
<span id="cb24-895"><a href="#cb24-895" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin: 1.5em 0;</span></span>
<span id="cb24-896"><a href="#cb24-896" aria-hidden="true" tabindex="-1"></a><span class="ss">            box-shadow: 0 2px 5px rgba(0,0,0,0.1);</span></span>
<span id="cb24-897"><a href="#cb24-897" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 8px;</span></span>
<span id="cb24-898"><a href="#cb24-898" aria-hidden="true" tabindex="-1"></a><span class="ss">            overflow: hidden;</span></span>
<span id="cb24-899"><a href="#cb24-899" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb24-900"><a href="#cb24-900" aria-hidden="true" tabindex="-1"></a><span class="ss">        th, td </span><span class="ch">{{</span></span>
<span id="cb24-901"><a href="#cb24-901" aria-hidden="true" tabindex="-1"></a><span class="ss">            border: 1px solid #ddd;</span></span>
<span id="cb24-902"><a href="#cb24-902" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 15px;</span></span>
<span id="cb24-903"><a href="#cb24-903" aria-hidden="true" tabindex="-1"></a><span class="ss">            text-align: left;</span></span>
<span id="cb24-904"><a href="#cb24-904" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb24-905"><a href="#cb24-905" aria-hidden="true" tabindex="-1"></a><span class="ss">        th </span><span class="ch">{{</span></span>
<span id="cb24-906"><a href="#cb24-906" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: linear-gradient(135deg, #3498db, #2980b9);</span></span>
<span id="cb24-907"><a href="#cb24-907" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: white;</span></span>
<span id="cb24-908"><a href="#cb24-908" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-weight: bold;</span></span>
<span id="cb24-909"><a href="#cb24-909" aria-hidden="true" tabindex="-1"></a><span class="ss">            text-transform: uppercase;</span></span>
<span id="cb24-910"><a href="#cb24-910" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.9em;</span></span>
<span id="cb24-911"><a href="#cb24-911" aria-hidden="true" tabindex="-1"></a><span class="ss">            letter-spacing: 0.5px;</span></span>
<span id="cb24-912"><a href="#cb24-912" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb24-913"><a href="#cb24-913" aria-hidden="true" tabindex="-1"></a><span class="ss">        tr:nth-child(even) </span><span class="ch">{{</span></span>
<span id="cb24-914"><a href="#cb24-914" aria-hidden="true" tabindex="-1"></a><span class="ss">            background-color: #f8f9fa;</span></span>
<span id="cb24-915"><a href="#cb24-915" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb24-916"><a href="#cb24-916" aria-hidden="true" tabindex="-1"></a><span class="ss">        tr:hover </span><span class="ch">{{</span></span>
<span id="cb24-917"><a href="#cb24-917" aria-hidden="true" tabindex="-1"></a><span class="ss">            background-color: #e3f2fd;</span></span>
<span id="cb24-918"><a href="#cb24-918" aria-hidden="true" tabindex="-1"></a><span class="ss">            transition: background-color 0.2s ease;</span></span>
<span id="cb24-919"><a href="#cb24-919" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb24-920"><a href="#cb24-920" aria-hidden="true" tabindex="-1"></a><span class="ss">        .math </span><span class="ch">{{</span></span>
<span id="cb24-921"><a href="#cb24-921" aria-hidden="true" tabindex="-1"></a><span class="ss">            text-align: center;</span></span>
<span id="cb24-922"><a href="#cb24-922" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin: 1.5em 0;</span></span>
<span id="cb24-923"><a href="#cb24-923" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 15px;</span></span>
<span id="cb24-924"><a href="#cb24-924" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #f8f9fa;</span></span>
<span id="cb24-925"><a href="#cb24-925" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 8px;</span></span>
<span id="cb24-926"><a href="#cb24-926" aria-hidden="true" tabindex="-1"></a><span class="ss">            overflow-x: auto;</span></span>
<span id="cb24-927"><a href="#cb24-927" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb24-928"><a href="#cb24-928" aria-hidden="true" tabindex="-1"></a><span class="ss">        .message-header </span><span class="ch">{{</span></span>
<span id="cb24-929"><a href="#cb24-929" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: flex;</span></span>
<span id="cb24-930"><a href="#cb24-930" aria-hidden="true" tabindex="-1"></a><span class="ss">            justify-content: space-between;</span></span>
<span id="cb24-931"><a href="#cb24-931" aria-hidden="true" tabindex="-1"></a><span class="ss">            align-items: center;</span></span>
<span id="cb24-932"><a href="#cb24-932" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-bottom: 15px;</span></span>
<span id="cb24-933"><a href="#cb24-933" aria-hidden="true" tabindex="-1"></a><span class="ss">            flex-wrap: wrap;</span></span>
<span id="cb24-934"><a href="#cb24-934" aria-hidden="true" tabindex="-1"></a><span class="ss">            gap: 10px;</span></span>
<span id="cb24-935"><a href="#cb24-935" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb24-936"><a href="#cb24-936" aria-hidden="true" tabindex="-1"></a><span class="ss">        .author </span><span class="ch">{{</span></span>
<span id="cb24-937"><a href="#cb24-937" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-weight: bold;</span></span>
<span id="cb24-938"><a href="#cb24-938" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #2c3e50;</span></span>
<span id="cb24-939"><a href="#cb24-939" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 1.1em;</span></span>
<span id="cb24-940"><a href="#cb24-940" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb24-941"><a href="#cb24-941" aria-hidden="true" tabindex="-1"></a><span class="ss">        .timestamp </span><span class="ch">{{</span></span>
<span id="cb24-942"><a href="#cb24-942" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #7f8c8d;</span></span>
<span id="cb24-943"><a href="#cb24-943" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.9em;</span></span>
<span id="cb24-944"><a href="#cb24-944" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #e9ecef;</span></span>
<span id="cb24-945"><a href="#cb24-945" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 4px 8px;</span></span>
<span id="cb24-946"><a href="#cb24-946" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 4px;</span></span>
<span id="cb24-947"><a href="#cb24-947" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb24-948"><a href="#cb24-948" aria-hidden="true" tabindex="-1"></a><span class="ss">        .message-content </span><span class="ch">{{</span></span>
<span id="cb24-949"><a href="#cb24-949" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #f8f9fa;</span></span>
<span id="cb24-950"><a href="#cb24-950" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 20px;</span></span>
<span id="cb24-951"><a href="#cb24-951" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 8px;</span></span>
<span id="cb24-952"><a href="#cb24-952" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-left: 4px solid #3498db;</span></span>
<span id="cb24-953"><a href="#cb24-953" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-bottom: 20px;</span></span>
<span id="cb24-954"><a href="#cb24-954" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb24-955"><a href="#cb24-955" aria-hidden="true" tabindex="-1"></a><span class="ss">        .metadata </span><span class="ch">{{</span></span>
<span id="cb24-956"><a href="#cb24-956" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #e8f4fd;</span></span>
<span id="cb24-957"><a href="#cb24-957" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 15px;</span></span>
<span id="cb24-958"><a href="#cb24-958" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 8px;</span></span>
<span id="cb24-959"><a href="#cb24-959" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-bottom: 25px;</span></span>
<span id="cb24-960"><a href="#cb24-960" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-left: 4px solid #3498db;</span></span>
<span id="cb24-961"><a href="#cb24-961" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb24-962"><a href="#cb24-962" aria-hidden="true" tabindex="-1"></a><span class="ss">        .metadata h3 </span><span class="ch">{{</span></span>
<span id="cb24-963"><a href="#cb24-963" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-top: 0;</span></span>
<span id="cb24-964"><a href="#cb24-964" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #2c3e50;</span></span>
<span id="cb24-965"><a href="#cb24-965" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb24-966"><a href="#cb24-966" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb24-967"><a href="#cb24-967" aria-hidden="true" tabindex="-1"></a><span class="ss">        /* Melhorias responsivas */</span></span>
<span id="cb24-968"><a href="#cb24-968" aria-hidden="true" tabindex="-1"></a><span class="ss">        @media (max-width: 1400px) </span><span class="ch">{{</span></span>
<span id="cb24-969"><a href="#cb24-969" aria-hidden="true" tabindex="-1"></a><span class="ss">            .container </span><span class="ch">{{</span></span>
<span id="cb24-970"><a href="#cb24-970" aria-hidden="true" tabindex="-1"></a><span class="ss">                max-width: 98%;</span></span>
<span id="cb24-971"><a href="#cb24-971" aria-hidden="true" tabindex="-1"></a><span class="ss">                padding: 30px;</span></span>
<span id="cb24-972"><a href="#cb24-972" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span><span class="ch">}}</span></span>
<span id="cb24-973"><a href="#cb24-973" aria-hidden="true" tabindex="-1"></a><span class="ss">            .toc </span><span class="ch">{{</span></span>
<span id="cb24-974"><a href="#cb24-974" aria-hidden="true" tabindex="-1"></a><span class="ss">                width: 280px; /* Reduz um pouco em telas menores */</span></span>
<span id="cb24-975"><a href="#cb24-975" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span><span class="ch">}}</span></span>
<span id="cb24-976"><a href="#cb24-976" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb24-977"><a href="#cb24-977" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb24-978"><a href="#cb24-978" aria-hidden="true" tabindex="-1"></a><span class="ss">        @media (max-width: 1200px) </span><span class="ch">{{</span></span>
<span id="cb24-979"><a href="#cb24-979" aria-hidden="true" tabindex="-1"></a><span class="ss">            .toc </span><span class="ch">{{</span></span>
<span id="cb24-980"><a href="#cb24-980" aria-hidden="true" tabindex="-1"></a><span class="ss">                float: none;</span></span>
<span id="cb24-981"><a href="#cb24-981" aria-hidden="true" tabindex="-1"></a><span class="ss">                width: auto;</span></span>
<span id="cb24-982"><a href="#cb24-982" aria-hidden="true" tabindex="-1"></a><span class="ss">                margin: 20px 0;</span></span>
<span id="cb24-983"><a href="#cb24-983" aria-hidden="true" tabindex="-1"></a><span class="ss">                position: static;</span></span>
<span id="cb24-984"><a href="#cb24-984" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span><span class="ch">}}</span></span>
<span id="cb24-985"><a href="#cb24-985" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb24-986"><a href="#cb24-986" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb24-987"><a href="#cb24-987" aria-hidden="true" tabindex="-1"></a><span class="ss">        @media (max-width: 768px) </span><span class="ch">{{</span></span>
<span id="cb24-988"><a href="#cb24-988" aria-hidden="true" tabindex="-1"></a><span class="ss">            .container </span><span class="ch">{{</span></span>
<span id="cb24-989"><a href="#cb24-989" aria-hidden="true" tabindex="-1"></a><span class="ss">                padding: 20px;</span></span>
<span id="cb24-990"><a href="#cb24-990" aria-hidden="true" tabindex="-1"></a><span class="ss">                max-width: 100%;</span></span>
<span id="cb24-991"><a href="#cb24-991" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span><span class="ch">}}</span></span>
<span id="cb24-992"><a href="#cb24-992" aria-hidden="true" tabindex="-1"></a><span class="ss">            body </span><span class="ch">{{</span></span>
<span id="cb24-993"><a href="#cb24-993" aria-hidden="true" tabindex="-1"></a><span class="ss">                padding: 10px;</span></span>
<span id="cb24-994"><a href="#cb24-994" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span><span class="ch">}}</span></span>
<span id="cb24-995"><a href="#cb24-995" aria-hidden="true" tabindex="-1"></a><span class="ss">            h1 </span><span class="ch">{{</span></span>
<span id="cb24-996"><a href="#cb24-996" aria-hidden="true" tabindex="-1"></a><span class="ss">                font-size: 1.8em;</span></span>
<span id="cb24-997"><a href="#cb24-997" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span><span class="ch">}}</span></span>
<span id="cb24-998"><a href="#cb24-998" aria-hidden="true" tabindex="-1"></a><span class="ss">            .message-header </span><span class="ch">{{</span></span>
<span id="cb24-999"><a href="#cb24-999" aria-hidden="true" tabindex="-1"></a><span class="ss">                flex-direction: column;</span></span>
<span id="cb24-1000"><a href="#cb24-1000" aria-hidden="true" tabindex="-1"></a><span class="ss">                align-items: flex-start;</span></span>
<span id="cb24-1001"><a href="#cb24-1001" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span><span class="ch">}}</span></span>
<span id="cb24-1002"><a href="#cb24-1002" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb24-1003"><a href="#cb24-1003" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb24-1004"><a href="#cb24-1004" aria-hidden="true" tabindex="-1"></a><span class="ss">        /* Scroll suave */</span></span>
<span id="cb24-1005"><a href="#cb24-1005" aria-hidden="true" tabindex="-1"></a><span class="ss">        html </span><span class="ch">{{</span></span>
<span id="cb24-1006"><a href="#cb24-1006" aria-hidden="true" tabindex="-1"></a><span class="ss">            scroll-behavior: smooth;</span></span>
<span id="cb24-1007"><a href="#cb24-1007" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb24-1008"><a href="#cb24-1008" aria-hidden="true" tabindex="-1"></a><span class="ss">    </style></span></span>
<span id="cb24-1009"><a href="#cb24-1009" aria-hidden="true" tabindex="-1"></a><span class="ss"></head></span></span>
<span id="cb24-1010"><a href="#cb24-1010" aria-hidden="true" tabindex="-1"></a><span class="ss"><body></span></span>
<span id="cb24-1011"><a href="#cb24-1011" aria-hidden="true" tabindex="-1"></a><span class="ss">    <div class="container"></span></span>
<span id="cb24-1012"><a href="#cb24-1012" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="sc">{</span>content<span class="sc">}</span></span>
<span id="cb24-1013"><a href="#cb24-1013" aria-hidden="true" tabindex="-1"></a><span class="ss">    </div></span></span>
<span id="cb24-1014"><a href="#cb24-1014" aria-hidden="true" tabindex="-1"></a><span class="ss">    <script></span></span>
<span id="cb24-1015"><a href="#cb24-1015" aria-hidden="true" tabindex="-1"></a><span class="ss">        // Configura√ß√£o MathJax para melhor renderiza√ß√£o</span></span>
<span id="cb24-1016"><a href="#cb24-1016" aria-hidden="true" tabindex="-1"></a><span class="ss">        window.MathJax = </span><span class="ch">{{</span></span>
<span id="cb24-1017"><a href="#cb24-1017" aria-hidden="true" tabindex="-1"></a><span class="ss">            tex: </span><span class="ch">{{</span></span>
<span id="cb24-1018"><a href="#cb24-1018" aria-hidden="true" tabindex="-1"></a><span class="ss">                inlineMath: [['$', '$'], ['</span><span class="ch">\\</span><span class="ss">(', '</span><span class="ch">\\</span><span class="ss">)']],</span></span>
<span id="cb24-1019"><a href="#cb24-1019" aria-hidden="true" tabindex="-1"></a><span class="ss">                displayMath: [['$$', '$$'], ['</span><span class="ch">\\</span><span class="ss">[', '</span><span class="ch">\\</span><span class="ss">]']],</span></span>
<span id="cb24-1020"><a href="#cb24-1020" aria-hidden="true" tabindex="-1"></a><span class="ss">                processEscapes: true,</span></span>
<span id="cb24-1021"><a href="#cb24-1021" aria-hidden="true" tabindex="-1"></a><span class="ss">                tags: 'ams'</span></span>
<span id="cb24-1022"><a href="#cb24-1022" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span><span class="ch">}}</span><span class="ss">,</span></span>
<span id="cb24-1023"><a href="#cb24-1023" aria-hidden="true" tabindex="-1"></a><span class="ss">            options: </span><span class="ch">{{</span></span>
<span id="cb24-1024"><a href="#cb24-1024" aria-hidden="true" tabindex="-1"></a><span class="ss">                skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre'],</span></span>
<span id="cb24-1025"><a href="#cb24-1025" aria-hidden="true" tabindex="-1"></a><span class="ss">                renderActions: </span><span class="ch">{{</span></span>
<span id="cb24-1026"><a href="#cb24-1026" aria-hidden="true" tabindex="-1"></a><span class="ss">                    addMenu: [0, '', '']</span></span>
<span id="cb24-1027"><a href="#cb24-1027" aria-hidden="true" tabindex="-1"></a><span class="ss">                </span><span class="ch">}}</span></span>
<span id="cb24-1028"><a href="#cb24-1028" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span><span class="ch">}}</span><span class="ss">,</span></span>
<span id="cb24-1029"><a href="#cb24-1029" aria-hidden="true" tabindex="-1"></a><span class="ss">            startup: </span><span class="ch">{{</span></span>
<span id="cb24-1030"><a href="#cb24-1030" aria-hidden="true" tabindex="-1"></a><span class="ss">                pageReady() </span><span class="ch">{{</span></span>
<span id="cb24-1031"><a href="#cb24-1031" aria-hidden="true" tabindex="-1"></a><span class="ss">                    return MathJax.startup.defaultPageReady().then(() => </span><span class="ch">{{</span></span>
<span id="cb24-1032"><a href="#cb24-1032" aria-hidden="true" tabindex="-1"></a><span class="ss">                        console.log('MathJax carregado com sucesso');</span></span>
<span id="cb24-1033"><a href="#cb24-1033" aria-hidden="true" tabindex="-1"></a><span class="ss">                    </span><span class="ch">}}</span><span class="ss">);</span></span>
<span id="cb24-1034"><a href="#cb24-1034" aria-hidden="true" tabindex="-1"></a><span class="ss">                </span><span class="ch">}}</span></span>
<span id="cb24-1035"><a href="#cb24-1035" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span><span class="ch">}}</span></span>
<span id="cb24-1036"><a href="#cb24-1036" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span><span class="ss">;</span></span>
<span id="cb24-1037"><a href="#cb24-1037" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb24-1038"><a href="#cb24-1038" aria-hidden="true" tabindex="-1"></a><span class="ss">        // Script para destacar se√ß√£o ativa no TOC (se existir)</span></span>
<span id="cb24-1039"><a href="#cb24-1039" aria-hidden="true" tabindex="-1"></a><span class="ss">        document.addEventListener('DOMContentLoaded', function() </span><span class="ch">{{</span></span>
<span id="cb24-1040"><a href="#cb24-1040" aria-hidden="true" tabindex="-1"></a><span class="ss">            const tocLinks = document.querySelectorAll('#TOC a, .toc a');</span></span>
<span id="cb24-1041"><a href="#cb24-1041" aria-hidden="true" tabindex="-1"></a><span class="ss">            const sections = document.querySelectorAll('h1, h2, h3, h4, h5');</span></span>
<span id="cb24-1042"><a href="#cb24-1042" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span></span>
<span id="cb24-1043"><a href="#cb24-1043" aria-hidden="true" tabindex="-1"></a><span class="ss">            function highlightActiveSection() </span><span class="ch">{{</span></span>
<span id="cb24-1044"><a href="#cb24-1044" aria-hidden="true" tabindex="-1"></a><span class="ss">                let currentSection = '';</span></span>
<span id="cb24-1045"><a href="#cb24-1045" aria-hidden="true" tabindex="-1"></a><span class="ss">                const scrollY = window.pageYOffset;</span></span>
<span id="cb24-1046"><a href="#cb24-1046" aria-hidden="true" tabindex="-1"></a><span class="ss">                </span></span>
<span id="cb24-1047"><a href="#cb24-1047" aria-hidden="true" tabindex="-1"></a><span class="ss">                sections.forEach(section => </span><span class="ch">{{</span></span>
<span id="cb24-1048"><a href="#cb24-1048" aria-hidden="true" tabindex="-1"></a><span class="ss">                    const sectionTop = section.offsetTop - 100;</span></span>
<span id="cb24-1049"><a href="#cb24-1049" aria-hidden="true" tabindex="-1"></a><span class="ss">                    if (scrollY >= sectionTop) </span><span class="ch">{{</span></span>
<span id="cb24-1050"><a href="#cb24-1050" aria-hidden="true" tabindex="-1"></a><span class="ss">                        currentSection = section.getAttribute('id');</span></span>
<span id="cb24-1051"><a href="#cb24-1051" aria-hidden="true" tabindex="-1"></a><span class="ss">                    </span><span class="ch">}}</span></span>
<span id="cb24-1052"><a href="#cb24-1052" aria-hidden="true" tabindex="-1"></a><span class="ss">                </span><span class="ch">}}</span><span class="ss">);</span></span>
<span id="cb24-1053"><a href="#cb24-1053" aria-hidden="true" tabindex="-1"></a><span class="ss">                </span></span>
<span id="cb24-1054"><a href="#cb24-1054" aria-hidden="true" tabindex="-1"></a><span class="ss">                tocLinks.forEach(link => </span><span class="ch">{{</span></span>
<span id="cb24-1055"><a href="#cb24-1055" aria-hidden="true" tabindex="-1"></a><span class="ss">                    link.classList.remove('active');</span></span>
<span id="cb24-1056"><a href="#cb24-1056" aria-hidden="true" tabindex="-1"></a><span class="ss">                    if (link.getAttribute('href') === '#' + currentSection) </span><span class="ch">{{</span></span>
<span id="cb24-1057"><a href="#cb24-1057" aria-hidden="true" tabindex="-1"></a><span class="ss">                        link.classList.add('active');</span></span>
<span id="cb24-1058"><a href="#cb24-1058" aria-hidden="true" tabindex="-1"></a><span class="ss">                    </span><span class="ch">}}</span></span>
<span id="cb24-1059"><a href="#cb24-1059" aria-hidden="true" tabindex="-1"></a><span class="ss">                </span><span class="ch">}}</span><span class="ss">);</span></span>
<span id="cb24-1060"><a href="#cb24-1060" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span><span class="ch">}}</span></span>
<span id="cb24-1061"><a href="#cb24-1061" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span></span>
<span id="cb24-1062"><a href="#cb24-1062" aria-hidden="true" tabindex="-1"></a><span class="ss">            if (tocLinks.length > 0) </span><span class="ch">{{</span></span>
<span id="cb24-1063"><a href="#cb24-1063" aria-hidden="true" tabindex="-1"></a><span class="ss">                window.addEventListener('scroll', highlightActiveSection);</span></span>
<span id="cb24-1064"><a href="#cb24-1064" aria-hidden="true" tabindex="-1"></a><span class="ss">                highlightActiveSection(); // Chamar inicialmente</span></span>
<span id="cb24-1065"><a href="#cb24-1065" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span><span class="ch">}}</span></span>
<span id="cb24-1066"><a href="#cb24-1066" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span><span class="ss">);</span></span>
<span id="cb24-1067"><a href="#cb24-1067" aria-hidden="true" tabindex="-1"></a><span class="ss">    </script></span></span>
<span id="cb24-1068"><a href="#cb24-1068" aria-hidden="true" tabindex="-1"></a><span class="ss">    <script src="</span><span class="sc">{</span>mathjax_src<span class="sc">}</span><span class="ss">" async></script></span></span>
<span id="cb24-1069"><a href="#cb24-1069" aria-hidden="true" tabindex="-1"></a><span class="ss">
        <script id="fixed-toc-script">
        document.addEventListener('DOMContentLoaded', function() {
            const toc = document.getElementById('TOC');
            if (toc) {
                const tocTitle = toc.querySelector('h2');
                if (tocTitle) {
                    const toggleBtn = document.createElement('button');
                    toggleBtn.innerHTML = '‚ò∞';
                    toggleBtn.className = 'toc-toggle-btn';
                    toggleBtn.title = 'Minimizar/Expandir TOC';
                    let isMinimized = false;
                    toggleBtn.addEventListener('click', function(e) {
                        e.stopPropagation();
                        isMinimized = !isMinimized;
                        if (isMinimized) {
                            toc.classList.add('toc-minimized');
                        } else {
                            toc.classList.remove('toc-minimized');
                        }
                    });
                    tocTitle.appendChild(toggleBtn);
                }
            }
            
            // SCROLLSPY
            const sections = document.querySelectorAll('h1, h2, h3, h4, h5');
            const tocLinks = document.querySelectorAll('#TOC a');
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const id = entry.target.getAttribute('id');
                        tocLinks.forEach(link => {
                            link.classList.remove('active');
                            if (link.getAttribute('href') === '#' + id) {
                                link.classList.add('active');
                            }
                        });
                    }
                });
            }, { 
                rootMargin: '-20% 0px -60% 0px', 
                threshold: 0 
            });
            
            sections.forEach(section => {
                if (section.id) observer.observe(section);
            });
            
            // Scroll suave
            tocLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const targetId = link.getAttribute('href').substring(1);
                    const targetElement = document.getElementById(targetId);
                    if (targetElement) {
                        const offsetTop = targetElement.offsetTop - 80;
                        window.scrollTo({ top: offsetTop, behavior: 'smooth' });
                    }
                });
            });
            
            // BOT√ÉO VOLTAR AO TOPO
            const backToTopBtn = document.createElement('button');
            backToTopBtn.className = 'back-to-top-content';
            backToTopBtn.innerHTML = '‚Üë';
            backToTopBtn.title = 'Voltar ao Topo';
            document.body.appendChild(backToTopBtn);
            
            window.addEventListener('scroll', () => {
                if (window.pageYOffset > 300) {
                    backToTopBtn.classList.add('show');
                } else {
                    backToTopBtn.classList.remove('show');
                }
            });
            
            backToTopBtn.addEventListener('click', () => {
                window.scrollTo({ top: 0, behavior: 'smooth' });
            });
        });
        </script>
        
</body></span></span>
<span id="cb24-1070"><a href="#cb24-1070" aria-hidden="true" tabindex="-1"></a><span class="ss"></html>"""</span></span>
<span id="cb24-1071"><a href="#cb24-1071" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-1072"><a href="#cb24-1072" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _create_basic_html(<span class="va">self</span>, content: <span class="bu">str</span>, title: <span class="bu">str</span>) <span class="op">-></span> <span class="bu">str</span>:</span>
<span id="cb24-1073"><a href="#cb24-1073" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""HTML b√°sico de √∫ltimo recurso com MathJax"""</span></span>
<span id="cb24-1074"><a href="#cb24-1074" aria-hidden="true" tabindex="-1"></a>        mathjax_src <span class="op">=</span> <span class="st">"assets/tex-mml-chtml.js"</span> <span class="cf">if</span> Path(<span class="st">"assets/tex-mml-chtml.js"</span>).exists() <span class="cf">else</span> <span class="st">"https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"</span></span>
<span id="cb24-1075"><a href="#cb24-1075" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-1076"><a href="#cb24-1076" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="ss">f"""<!DOCTYPE html></span></span>
<span id="cb24-1077"><a href="#cb24-1077" aria-hidden="true" tabindex="-1"></a><span class="ss"><html></span></span>
<span id="cb24-1078"><a href="#cb24-1078" aria-hidden="true" tabindex="-1"></a><span class="ss"><head>

        <style id="fixed-toc-styles">
        /* === ESTILOS PRINCIPAIS - TOC FIXO √Ä DIREITA === */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
            scroll-behavior: smooth;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            position: relative;
        }
        /* === TOC FIXO √Ä DIREITA - POSI√á√ÉO CORRIGIDA === */
        #TOC {
            position: fixed !important;
            top: 50% !important;
            right: 20px !important;
            transform: translateY(-50%) !important;
            width: 320px !important;
            max-height: 80vh !important;
            overflow-y: auto !important;
            z-index: 1000 !important;
            background: rgba(255, 255, 255, 0.98) !important;
            padding: 20px !important;
            border-radius: 12px !important;
            box-shadow: 0 8px 32px rgba(0,0,0,0.15) !important;
            border: 1px solid #e0e0e0 !important;
            backdrop-filter: blur(10px) !important;
            transition: all 0.3s ease-in-out !important;
        }
        #TOC.toc-minimized {
            transform: translateY(-50%) translateX(calc(320px - 50px)) !important;
            opacity: 0.3;
            width: 50px !important;
            overflow: hidden;
        }
        #TOC.toc-minimized > *:not(.toc-toggle-btn) {
            display: none !important;
        }
        #TOC h2 {
            margin-top: 0;
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
            font-size: 1.2em;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .toc-toggle-btn {
            background: none;
            border: none;
            font-size: 1.2em;
            cursor: pointer;
            padding: 5px;
            border-radius: 4px;
            transition: background-color 0.2s;
        }
        .toc-toggle-btn:hover {
            background-color: rgba(0,0,0,0.1);
        }
        #TOC ul {
            list-style-type: none;
            padding-left: 15px;
            margin: 10px 0;
        }
        #TOC ul ul {
            padding-left: 20px;
        }
        #TOC li {
            margin: 8px 0;
            line-height: 1.4;
        }
        #TOC a {
            text-decoration: none;
            color: #495057;
            font-weight: 500;
            transition: all 0.2s ease;
            display: block;
            padding: 6px 10px;
            border-radius: 6px;
            border-left: 3px solid transparent;
        }
        #TOC a:hover {
            color: #007bff;
            background-color: rgba(0, 123, 255, 0.1);
            border-left-color: #007bff;
        }
        #TOC a.active {
            background-color: #007bff !important;
            color: white !important;
            font-weight: bold;
            border-left-color: #0056b3;
        }
        /* Conte√∫do principal com margem para o TOC */
        .main-content {
            margin-right: calc(320px + 40px) !important;
        }
        /* Barra de scroll personalizada APENAS para TOC */
        #TOC::-webkit-scrollbar {
            width: 8px;
        }
        #TOC::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }
        #TOC::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 4px;
        }
        #TOC::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }
        /* === BOT√ÉO VOLTAR AO TOPO (HTMLs individuais) === */
        .back-to-top-content {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            font-size: 18px;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 999;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .back-to-top-content.show {
            opacity: 1;
            transform: translateY(0);
        }
        .back-to-top-content:hover {
            background: #0056b3;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0,0,0,0.2);
        }
        /* === RESPONSIVIDADE === */
        @media (max-width: 1400px) {
            .container {
                max-width: 95%;
                padding: 30px;
            }
            #TOC {
                width: 280px !important;
            }
            .main-content {
                margin-right: 320px !important;
            }
        }
        @media (max-width: 1200px) {
            #TOC {
                width: 260px !important;
                right: 15px !important;
            }
            .main-content {
                margin-right: 300px !important;
            }
        }
        @media (max-width: 992px) {
            #TOC {
                position: relative !important;
                width: 100% !important;
                right: 0 !important;
                top: 0 !important;
                transform: none !important;
                margin: 20px 0;
                max-height: 300px !important;
            }
            .main-content {
                margin-right: 0 !important;
            }
            .back-to-top-content {
                right: 20px;
                bottom: 20px;
            }
        }
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            .container {
                padding: 20px;
                max-width: 100%;
            }
            #TOC {
                max-height: 250px !important;
                padding: 15px !important;
            }
        }
        </style>
        </span></span>
<span id="cb24-1079"><a href="#cb24-1079" aria-hidden="true" tabindex="-1"></a><span class="ss">    <meta charset="UTF-8"></span></span>
<span id="cb24-1080"><a href="#cb24-1080" aria-hidden="true" tabindex="-1"></a><span class="ss">    <title></span><span class="sc">{</span>title<span class="sc">}</span><span class="ss"></title></span></span>
<span id="cb24-1081"><a href="#cb24-1081" aria-hidden="true" tabindex="-1"></a><span class="ss">    <style></span></span>
<span id="cb24-1082"><a href="#cb24-1082" aria-hidden="true" tabindex="-1"></a><span class="ss">        body </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb24-1083"><a href="#cb24-1083" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; </span></span>
<span id="cb24-1084"><a href="#cb24-1084" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 20px; </span></span>
<span id="cb24-1085"><a href="#cb24-1085" aria-hidden="true" tabindex="-1"></a><span class="ss">            line-height: 1.6;</span></span>
<span id="cb24-1086"><a href="#cb24-1086" aria-hidden="true" tabindex="-1"></a><span class="ss">            background-color: #f5f5f5;</span></span>
<span id="cb24-1087"><a href="#cb24-1087" aria-hidden="true" tabindex="-1"></a><span class="ss">            max-width: none; /* Remove limita√ß√£o de largura - TELA COMPLETA */</span></span>
<span id="cb24-1088"><a href="#cb24-1088" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb24-1089"><a href="#cb24-1089" aria-hidden="true" tabindex="-1"></a><span class="ss">        pre </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb24-1090"><a href="#cb24-1090" aria-hidden="true" tabindex="-1"></a><span class="ss">            white-space: pre-wrap; </span></span>
<span id="cb24-1091"><a href="#cb24-1091" aria-hidden="true" tabindex="-1"></a><span class="ss">            word-wrap: break-word; </span></span>
<span id="cb24-1092"><a href="#cb24-1092" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: white;</span></span>
<span id="cb24-1093"><a href="#cb24-1093" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 15px;</span></span>
<span id="cb24-1094"><a href="#cb24-1094" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 5px;</span></span>
<span id="cb24-1095"><a href="#cb24-1095" aria-hidden="true" tabindex="-1"></a><span class="ss">            border: 1px solid #ddd;</span></span>
<span id="cb24-1096"><a href="#cb24-1096" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb24-1097"><a href="#cb24-1097" aria-hidden="true" tabindex="-1"></a><span class="ss">        .container </span><span class="ch">{{</span></span>
<span id="cb24-1098"><a href="#cb24-1098" aria-hidden="true" tabindex="-1"></a><span class="ss">            max-width: 95%; /* Usa quase toda a largura dispon√≠vel */</span></span>
<span id="cb24-1099"><a href="#cb24-1099" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin: 0 auto;</span></span>
<span id="cb24-1100"><a href="#cb24-1100" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: white;</span></span>
<span id="cb24-1101"><a href="#cb24-1101" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 30px;</span></span>
<span id="cb24-1102"><a href="#cb24-1102" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 8px;</span></span>
<span id="cb24-1103"><a href="#cb24-1103" aria-hidden="true" tabindex="-1"></a><span class="ss">            box-shadow: 0 2px 10px rgba(0,0,0,0.1);</span></span>
<span id="cb24-1104"><a href="#cb24-1104" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb24-1105"><a href="#cb24-1105" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb24-1106"><a href="#cb24-1106" aria-hidden="true" tabindex="-1"></a><span class="ss">        /* Corre√ß√£o b√°sica para garantir visibilidade */</span></span>
<span id="cb24-1107"><a href="#cb24-1107" aria-hidden="true" tabindex="-1"></a><span class="ss">        pre, code </span><span class="ch">{{</span></span>
<span id="cb24-1108"><a href="#cb24-1108" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #333 !important;</span></span>
<span id="cb24-1109"><a href="#cb24-1109" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: white !important;</span></span>
<span id="cb24-1110"><a href="#cb24-1110" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb24-1111"><a href="#cb24-1111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-1112"><a href="#cb24-1112" aria-hidden="true" tabindex="-1"></a><span class="ss">        body </span><span class="ch">{{</span></span>
<span id="cb24-1113"><a href="#cb24-1113" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #333 !important;</span></span>
<span id="cb24-1114"><a href="#cb24-1114" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb24-1115"><a href="#cb24-1115" aria-hidden="true" tabindex="-1"></a><span class="ss">    </style></span></span>
<span id="cb24-1116"><a href="#cb24-1116" aria-hidden="true" tabindex="-1"></a><span class="ss">    <script></span></span>
<span id="cb24-1117"><a href="#cb24-1117" aria-hidden="true" tabindex="-1"></a><span class="ss">        window.MathJax = </span><span class="ch">{{</span></span>
<span id="cb24-1118"><a href="#cb24-1118" aria-hidden="true" tabindex="-1"></a><span class="ss">            tex: </span><span class="ch">{{</span></span>
<span id="cb24-1119"><a href="#cb24-1119" aria-hidden="true" tabindex="-1"></a><span class="ss">                inlineMath: [['$', '$'], ['</span><span class="ch">\\</span><span class="ss">(', '</span><span class="ch">\\</span><span class="ss">)']],</span></span>
<span id="cb24-1120"><a href="#cb24-1120" aria-hidden="true" tabindex="-1"></a><span class="ss">                displayMath: [['$$', '$$'], ['</span><span class="ch">\\</span><span class="ss">[', '</span><span class="ch">\\</span><span class="ss">]']],</span></span>
<span id="cb24-1121"><a href="#cb24-1121" aria-hidden="true" tabindex="-1"></a><span class="ss">                processEscapes: true</span></span>
<span id="cb24-1122"><a href="#cb24-1122" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span><span class="ch">}}</span></span>
<span id="cb24-1123"><a href="#cb24-1123" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span><span class="ss">;</span></span>
<span id="cb24-1124"><a href="#cb24-1124" aria-hidden="true" tabindex="-1"></a><span class="ss">    </script></span></span>
<span id="cb24-1125"><a href="#cb24-1125" aria-hidden="true" tabindex="-1"></a><span class="ss">    <script src="</span><span class="sc">{</span>mathjax_src<span class="sc">}</span><span class="ss">" async></script></span></span>
<span id="cb24-1126"><a href="#cb24-1126" aria-hidden="true" tabindex="-1"></a><span class="ss"></head></span></span>
<span id="cb24-1127"><a href="#cb24-1127" aria-hidden="true" tabindex="-1"></a><span class="ss"><body></span></span>
<span id="cb24-1128"><a href="#cb24-1128" aria-hidden="true" tabindex="-1"></a><span class="ss">    <div class="container"></span></span>
<span id="cb24-1129"><a href="#cb24-1129" aria-hidden="true" tabindex="-1"></a><span class="ss">        <pre></span><span class="sc">{</span>content<span class="sc">}</span><span class="ss"></pre></span></span>
<span id="cb24-1130"><a href="#cb24-1130" aria-hidden="true" tabindex="-1"></a><span class="ss">    </div></span></span>
<span id="cb24-1131"><a href="#cb24-1131" aria-hidden="true" tabindex="-1"></a><span class="ss">
        <script id="fixed-toc-script">
        document.addEventListener('DOMContentLoaded', function() {
            const toc = document.getElementById('TOC');
            if (toc) {
                const tocTitle = toc.querySelector('h2');
                if (tocTitle) {
                    const toggleBtn = document.createElement('button');
                    toggleBtn.innerHTML = '‚ò∞';
                    toggleBtn.className = 'toc-toggle-btn';
                    toggleBtn.title = 'Minimizar/Expandir TOC';
                    let isMinimized = false;
                    toggleBtn.addEventListener('click', function(e) {
                        e.stopPropagation();
                        isMinimized = !isMinimized;
                        if (isMinimized) {
                            toc.classList.add('toc-minimized');
                        } else {
                            toc.classList.remove('toc-minimized');
                        }
                    });
                    tocTitle.appendChild(toggleBtn);
                }
            }
            
            // SCROLLSPY
            const sections = document.querySelectorAll('h1, h2, h3, h4, h5');
            const tocLinks = document.querySelectorAll('#TOC a');
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const id = entry.target.getAttribute('id');
                        tocLinks.forEach(link => {
                            link.classList.remove('active');
                            if (link.getAttribute('href') === '#' + id) {
                                link.classList.add('active');
                            }
                        });
                    }
                });
            }, { 
                rootMargin: '-20% 0px -60% 0px', 
                threshold: 0 
            });
            
            sections.forEach(section => {
                if (section.id) observer.observe(section);
            });
            
            // Scroll suave
            tocLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const targetId = link.getAttribute('href').substring(1);
                    const targetElement = document.getElementById(targetId);
                    if (targetElement) {
                        const offsetTop = targetElement.offsetTop - 80;
                        window.scrollTo({ top: offsetTop, behavior: 'smooth' });
                    }
                });
            });
            
            // BOT√ÉO VOLTAR AO TOPO
            const backToTopBtn = document.createElement('button');
            backToTopBtn.className = 'back-to-top-content';
            backToTopBtn.innerHTML = '‚Üë';
            backToTopBtn.title = 'Voltar ao Topo';
            document.body.appendChild(backToTopBtn);
            
            window.addEventListener('scroll', () => {
                if (window.pageYOffset > 300) {
                    backToTopBtn.classList.add('show');
                } else {
                    backToTopBtn.classList.remove('show');
                }
            });
            
            backToTopBtn.addEventListener('click', () => {
                window.scrollTo({ top: 0, behavior: 'smooth' });
            });
        });
        </script>
        
</body></span></span>
<span id="cb24-1132"><a href="#cb24-1132" aria-hidden="true" tabindex="-1"></a><span class="ss"></html>"""</span></span>
<span id="cb24-1133"><a href="#cb24-1133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-1134"><a href="#cb24-1134" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> save_as_html_robust(<span class="va">self</span>):</span>
<span id="cb24-1135"><a href="#cb24-1135" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""M√©todo ROBUSTO para convers√£o HTML - VERS√ÉO OTIMIZADA"""</span></span>
<span id="cb24-1136"><a href="#cb24-1136" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb24-1137"><a href="#cb24-1137" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="st">"üîÆ [DRY-RUN] HTMLs seriam criados:"</span>)</span>
<span id="cb24-1138"><a href="#cb24-1138" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> conv <span class="kw">in</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb24-1139"><a href="#cb24-1139" aria-hidden="true" tabindex="-1"></a>                safe_title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(conv[<span class="st">'title'</span>])</span>
<span id="cb24-1140"><a href="#cb24-1140" aria-hidden="true" tabindex="-1"></a>                filename <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>conv[<span class="st">'number'</span>]<span class="sc">:03d}</span><span class="ss">_</span><span class="sc">{</span>conv[<span class="st">'source'</span>]<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>safe_title<span class="sc">}</span><span class="ss">.html"</span></span>
<span id="cb24-1141"><a href="#cb24-1141" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.info(<span class="ss">f"   üåê </span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb24-1142"><a href="#cb24-1142" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb24-1143"><a href="#cb24-1143" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-1144"><a href="#cb24-1144" aria-hidden="true" tabindex="-1"></a>        markdown_folder <span class="op">=</span> Path(<span class="va">self</span>.output_dirs[<span class="st">'markdown'</span>])</span>
<span id="cb24-1145"><a href="#cb24-1145" aria-hidden="true" tabindex="-1"></a>        html_folder <span class="op">=</span> Path(<span class="va">self</span>.output_dirs[<span class="st">'html'</span>])</span>
<span id="cb24-1146"><a href="#cb24-1146" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-1147"><a href="#cb24-1147" aria-hidden="true" tabindex="-1"></a>        md_files <span class="op">=</span> <span class="bu">list</span>(markdown_folder.glob(<span class="st">"*.md"</span>))</span>
<span id="cb24-1148"><a href="#cb24-1148" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-1149"><a href="#cb24-1149" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> md_files:</span>
<span id="cb24-1150"><a href="#cb24-1150" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.error(<span class="st">"‚ùå Nenhum arquivo Markdown encontrado para convers√£o."</span>)</span>
<span id="cb24-1151"><a href="#cb24-1151" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb24-1152"><a href="#cb24-1152" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-1153"><a href="#cb24-1153" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.logger.info(<span class="ss">f"üîÑ Convertendo </span><span class="sc">{</span><span class="bu">len</span>(md_files)<span class="sc">}</span><span class="ss"> arquivos Markdown para HTML (OTIMIZADO)..."</span>)</span>
<span id="cb24-1154"><a href="#cb24-1154" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-1155"><a href="#cb24-1155" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Verifica se Pandoc est√° dispon√≠vel</span></span>
<span id="cb24-1156"><a href="#cb24-1156" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb24-1157"><a href="#cb24-1157" aria-hidden="true" tabindex="-1"></a>            subprocess.run([<span class="st">'pandoc'</span>, <span class="st">'--version'</span>], capture_output<span class="op">=</span><span class="va">True</span>, check<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb24-1158"><a href="#cb24-1158" aria-hidden="true" tabindex="-1"></a>            pandoc_available <span class="op">=</span> <span class="va">True</span></span>
<span id="cb24-1159"><a href="#cb24-1159" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="st">"‚úÖ Pandoc dispon√≠vel - usando convers√£o otimizada"</span>)</span>
<span id="cb24-1160"><a href="#cb24-1160" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span>:</span>
<span id="cb24-1161"><a href="#cb24-1161" aria-hidden="true" tabindex="-1"></a>            pandoc_available <span class="op">=</span> <span class="va">False</span></span>
<span id="cb24-1162"><a href="#cb24-1162" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.warning(<span class="st">"‚ö†Ô∏è Pandoc n√£o dispon√≠vel - usando fallback Python"</span>)</span>
<span id="cb24-1163"><a href="#cb24-1163" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-1164"><a href="#cb24-1164" aria-hidden="true" tabindex="-1"></a>        converted_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb24-1165"><a href="#cb24-1165" aria-hidden="true" tabindex="-1"></a>        failed_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb24-1166"><a href="#cb24-1166" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-1167"><a href="#cb24-1167" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> md_file <span class="kw">in</span> md_files:</span>
<span id="cb24-1168"><a href="#cb24-1168" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb24-1169"><a href="#cb24-1169" aria-hidden="true" tabindex="-1"></a>                html_file <span class="op">=</span> html_folder <span class="op">/</span> md_file.with_suffix(<span class="st">'.html'</span>).name</span>
<span id="cb24-1170"><a href="#cb24-1170" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb24-1171"><a href="#cb24-1171" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.force_overwrite <span class="kw">and</span> html_file.exists():</span>
<span id="cb24-1172"><a href="#cb24-1172" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.logger.info(<span class="ss">f"‚è≠Ô∏è  J√° existe: </span><span class="sc">{</span>html_file<span class="sc">.</span>name<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb24-1173"><a href="#cb24-1173" aria-hidden="true" tabindex="-1"></a>                    converted_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb24-1174"><a href="#cb24-1174" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">continue</span></span>
<span id="cb24-1175"><a href="#cb24-1175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-1176"><a href="#cb24-1176" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.info(<span class="ss">f"üìÑ Processando: </span><span class="sc">{</span>md_file<span class="sc">.</span>name<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb24-1177"><a href="#cb24-1177" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb24-1178"><a href="#cb24-1178" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> pandoc_available:</span>
<span id="cb24-1179"><a href="#cb24-1179" aria-hidden="true" tabindex="-1"></a>                    html_content <span class="op">=</span> <span class="va">self</span>._convert_with_pandoc_optimized(<span class="bu">str</span>(md_file))</span>
<span id="cb24-1180"><a href="#cb24-1180" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb24-1181"><a href="#cb24-1181" aria-hidden="true" tabindex="-1"></a>                    html_content <span class="op">=</span> <span class="va">self</span>._convert_with_fallback(<span class="bu">str</span>(md_file))</span>
<span id="cb24-1182"><a href="#cb24-1182" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb24-1183"><a href="#cb24-1183" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> html_content:</span>
<span id="cb24-1184"><a href="#cb24-1184" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">with</span> <span class="bu">open</span>(html_file, <span class="st">'w'</span>, encoding<span class="op">=</span><span class="st">'utf-8'</span>) <span class="im">as</span> f:</span>
<span id="cb24-1185"><a href="#cb24-1185" aria-hidden="true" tabindex="-1"></a>                        f.write(html_content)</span>
<span id="cb24-1186"><a href="#cb24-1186" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb24-1187"><a href="#cb24-1187" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.logger.info(<span class="ss">f"‚úÖ Criado: </span><span class="sc">{</span>html_file<span class="sc">.</span>name<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb24-1188"><a href="#cb24-1188" aria-hidden="true" tabindex="-1"></a>                    converted_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb24-1189"><a href="#cb24-1189" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb24-1190"><a href="#cb24-1190" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.logger.error(<span class="ss">f"‚ùå Falha na convers√£o: </span><span class="sc">{</span>md_file<span class="sc">.</span>name<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb24-1191"><a href="#cb24-1191" aria-hidden="true" tabindex="-1"></a>                    failed_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb24-1192"><a href="#cb24-1192" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb24-1193"><a href="#cb24-1193" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb24-1194"><a href="#cb24-1194" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.error(<span class="ss">f"‚ùå Erro em </span><span class="sc">{</span>md_file<span class="sc">.</span>name<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span><span class="bu">str</span>(e)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb24-1195"><a href="#cb24-1195" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.error(traceback.format_exc())</span>
<span id="cb24-1196"><a href="#cb24-1196" aria-hidden="true" tabindex="-1"></a>                failed_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb24-1197"><a href="#cb24-1197" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb24-1198"><a href="#cb24-1198" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.logger.info(<span class="ss">f"üìä HTML: </span><span class="sc">{</span>converted_count<span class="sc">}</span><span class="ss"> arquivos criados, </span><span class="sc">{</span>failed_count<span class="sc">}</span><span class="ss"> falhas em '</span><span class="sc">{</span>html_folder<span class="sc">}</span><span class="ss">'"</span>)</span>
<span id="cb24-1199"><a href="#cb24-1199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-1200"><a href="#cb24-1200" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> categorize_conversation(<span class="va">self</span>, title: <span class="bu">str</span>, summary: <span class="bu">str</span>) <span class="op">-></span> <span class="bu">str</span>:</span>
<span id="cb24-1201"><a href="#cb24-1201" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Categoriza√ß√£o otimizada com express√µes regulares"""</span></span>
<span id="cb24-1202"><a href="#cb24-1202" aria-hidden="true" tabindex="-1"></a>        text <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>title<span class="sc">}</span><span class="ss"> </span><span class="sc">{</span>summary<span class="sc">}</span><span class="ss">"</span>.lower()</span>
<span id="cb24-1203"><a href="#cb24-1203" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-1204"><a href="#cb24-1204" aria-hidden="true" tabindex="-1"></a>        patterns <span class="op">=</span> {</span>
<span id="cb24-1205"><a href="#cb24-1205" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Tecnologia'</span>: <span class="vs">r'</span><span class="dv">\b</span><span class="kw">(</span><span class="vs">tecnologia</span><span class="cf">|</span><span class="vs">hardware</span><span class="cf">|</span><span class="vs">software</span><span class="cf">|</span><span class="vs">rede</span><span class="cf">|</span><span class="vs">internet</span><span class="cf">|</span><span class="vs">wifi</span><span class="cf">|</span><span class="vs">bluetooth</span><span class="cf">|</span><span class="pp">[45]</span><span class="vs">g</span><span class="cf">|</span><span class="vs">cloud</span><span class="cf">|</span><span class="vs">aws</span><span class="cf">|</span><span class="vs">azure</span><span class="cf">|</span><span class="vs">gcp</span><span class="cf">|</span><span class="vs">servidor</span><span class="cf">|</span><span class="vs">hosting</span><span class="cf">|</span><span class="vs">dom√≠nio</span><span class="cf">|</span><span class="vs">ssl</span><span class="cf">|</span><span class="vs">router</span><span class="cf">|</span><span class="vs">switch</span><span class="cf">|</span><span class="vs">firewall</span><span class="cf">|</span><span class="vs">iot</span><span class="cf">|</span><span class="vs">smartphone</span><span class="cf">|</span><span class="vs">tablet</span><span class="cf">|</span><span class="vs">navegador</span><span class="cf">|</span><span class="vs">browser</span><span class="cf">|</span><span class="vs">chrome</span><span class="cf">|</span><span class="vs">firefox</span><span class="cf">|</span><span class="vs">edge</span><span class="cf">|</span><span class="vs">safari</span><span class="cf">|</span><span class="vs">email</span><span class="cf">|</span><span class="vs">gmail</span><span class="cf">|</span><span class="vs">outlook</span><span class="cf">|</span><span class="vs">criptografia</span><span class="cf">|</span><span class="vs">seguran√ßa</span><span class="cf">|</span><span class="vs">ciberseguran√ßa</span><span class="cf">|</span><span class="vs">ransomware</span><span class="cf">|</span><span class="vs">phishing</span><span class="cf">|</span><span class="vs">autentica√ß√£o</span><span class="cf">|</span><span class="vs">2fa</span><span class="cf">|</span><span class="vs">biometria</span><span class="kw">)</span><span class="dv">\b</span><span class="vs">'</span>,</span>
<span id="cb24-1206"><a href="#cb24-1206" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Sa√∫de'</span>: <span class="vs">r'</span><span class="dv">\b</span><span class="kw">(</span><span class="vs">sa√∫de</span><span class="cf">|</span><span class="vs">medicina</span><span class="cf">|</span><span class="vs">m√©dico</span><span class="cf">|</span><span class="vs">enfermagem</span><span class="cf">|</span><span class="vs">doen√ßa</span><span class="cf">|</span><span class="vs">v√≠rus</span><span class="cf">|</span><span class="vs">bact√©ria</span><span class="cf">|</span><span class="vs">vacina</span><span class="cf">|</span><span class="vs">covid</span><span class="cf">|</span><span class="vs">coronav√≠rus</span><span class="cf">|</span><span class="vs">gripe</span><span class="cf">|</span><span class="vs">febre</span><span class="cf">|</span><span class="vs">dor</span><span class="cf">|</span><span class="vs">an√°lise</span><span class="cf">|</span><span class="vs">exame</span><span class="cf">|</span><span class="vs">raio x</span><span class="cf">|</span><span class="vs">resson√¢ncia</span><span class="cf">|</span><span class="vs">hospital</span><span class="cf">|</span><span class="vs">cl√≠nica</span><span class="cf">|</span><span class="vs">farm√°cia</span><span class="cf">|</span><span class="vs">medicamento</span><span class="cf">|</span><span class="vs">rem√©dio</span><span class="cf">|</span><span class="vs">psicologia</span><span class="cf">|</span><span class="vs">terapia</span><span class="cf">|</span><span class="vs">bem-estar</span><span class="cf">|</span><span class="vs">nutri√ß√£o</span><span class="cf">|</span><span class="vs">dieta</span><span class="cf">|</span><span class="vs">exerc√≠cio</span><span class="cf">|</span><span class="vs">fitness</span><span class="cf">|</span><span class="vs">sono</span><span class="cf">|</span><span class="vs">sa√∫de mental</span><span class="kw">)</span><span class="dv">\b</span><span class="vs">'</span>,</span>
<span id="cb24-1207"><a href="#cb24-1207" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Programa√ß√£o'</span>: <span class="vs">r'</span><span class="dv">\b</span><span class="kw">(</span><span class="vs">python</span><span class="cf">|</span><span class="vs">javascript</span><span class="cf">|</span><span class="vs">java</span><span class="cf">|</span><span class="vs">c</span><span class="ch">\+\+</span><span class="cf">|</span><span class="vs">c#</span><span class="cf">|</span><span class="vs">go</span><span class="cf">|</span><span class="vs">rust</span><span class="cf">|</span><span class="vs">lua</span><span class="cf">|</span><span class="vs">bash</span><span class="cf">|</span><span class="vs">script</span><span class="cf">|</span><span class="vs">debug</span><span class="cf">|</span><span class="vs">erro</span><span class="cf">|</span><span class="vs">conda</span><span class="cf">|</span><span class="vs">mamba</span><span class="cf">|</span><span class="vs">pandoc</span><span class="cf">|</span><span class="vs">msys2</span><span class="cf">|</span><span class="vs">spyder</span><span class="cf">|</span><span class="vs">jupyter</span><span class="cf">|</span><span class="vs">pip</span><span class="cf">|</span><span class="vs">venv</span><span class="cf">|</span><span class="vs">docker</span><span class="cf">|</span><span class="vs">git</span><span class="cf">|</span><span class="vs">github</span><span class="cf">|</span><span class="vs">vscode</span><span class="cf">|</span><span class="vs">ide</span><span class="cf">|</span><span class="vs">programa</span><span class="cf">|</span><span class="vs">c√≥digo</span><span class="cf">|</span><span class="vs">fun√ß√£o</span><span class="cf">|</span><span class="vs">classe</span><span class="cf">|</span><span class="vs">api</span><span class="cf">|</span><span class="vs">selenium</span><span class="cf">|</span><span class="vs">playwright</span><span class="kw">)</span><span class="dv">\b</span><span class="vs">'</span>,</span>
<span id="cb24-1208"><a href="#cb24-1208" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Sistemas'</span>: <span class="vs">r'</span><span class="dv">\b</span><span class="kw">(</span><span class="vs">windows</span><span class="cf">|</span><span class="vs">linux</span><span class="cf">|</span><span class="vs">macos</span><span class="cf">|</span><span class="vs">so</span><span class="cf">|</span><span class="vs">sistema operacional</span><span class="cf">|</span><span class="vs">driver</span><span class="cf">|</span><span class="vs">registry</span><span class="cf">|</span><span class="vs">process</span><span class="cf">|</span><span class="vs">firewall</span><span class="cf">|</span><span class="vs">bios</span><span class="cf">|</span><span class="vs">boot</span><span class="cf">|</span><span class="vs">path</span><span class="cf">|</span><span class="vs">dll</span><span class="cf">|</span><span class="vs">exe</span><span class="cf">|</span><span class="vs">powershell</span><span class="cf">|</span><span class="vs">cmd</span><span class="cf">|</span><span class="vs">terminal</span><span class="cf">|</span><span class="vs">shell</span><span class="kw">)</span><span class="dv">\b</span><span class="vs">'</span>,</span>
<span id="cb24-1209"><a href="#cb24-1209" aria-hidden="true" tabindex="-1"></a>            <span class="st">'IA'</span>: <span class="vs">r'</span><span class="dv">\b</span><span class="kw">(</span><span class="vs">ia</span><span class="cf">|</span><span class="vs">gpt</span><span class="cf">|</span><span class="vs">chatgpt</span><span class="cf">|</span><span class="vs">grok</span><span class="cf">|</span><span class="vs">qwen</span><span class="cf">|</span><span class="vs">deepseek</span><span class="cf">|</span><span class="vs">llm</span><span class="cf">|</span><span class="vs">modelo</span><span class="cf">|</span><span class="vs">prompt</span><span class="cf">|</span><span class="vs">token</span><span class="cf">|</span><span class="vs">embedding</span><span class="cf">|</span><span class="vs">fine-tune</span><span class="cf">|</span><span class="vs">neural</span><span class="cf">|</span><span class="vs">chatbot</span><span class="cf">|</span><span class="vs">intelig√™ncia artificial</span><span class="kw">)</span><span class="dv">\b</span><span class="vs">'</span>,</span>
<span id="cb24-1210"><a href="#cb24-1210" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Dados'</span>: <span class="vs">r'</span><span class="dv">\b</span><span class="kw">(</span><span class="vs">dados</span><span class="cf">|</span><span class="vs">data</span><span class="cf">|</span><span class="vs">csv</span><span class="cf">|</span><span class="vs">json</span><span class="cf">|</span><span class="vs">pandas</span><span class="cf">|</span><span class="vs">numpy</span><span class="cf">|</span><span class="vs">excel</span><span class="cf">|</span><span class="vs">sql</span><span class="cf">|</span><span class="vs">banco</span><span class="cf">|</span><span class="vs">sqlite</span><span class="cf">|</span><span class="vs">postgres</span><span class="cf">|</span><span class="vs">visualiza√ß√£o</span><span class="cf">|</span><span class="vs">gr√°fico</span><span class="cf">|</span><span class="vs">tabela</span><span class="cf">|</span><span class="vs">an√°lise</span><span class="cf">|</span><span class="vs">etl</span><span class="cf">|</span><span class="vs">dashboard</span><span class="kw">)</span><span class="dv">\b</span><span class="vs">'</span>,</span>
<span id="cb24-1211"><a href="#cb24-1211" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Geral'</span>: <span class="vs">r'</span><span class="dv">\b</span><span class="kw">(</span><span class="vs">geral</span><span class="cf">|</span><span class="vs">pergunta</span><span class="cf">|</span><span class="vs">ajuda</span><span class="cf">|</span><span class="vs">como fazer</span><span class="cf">|</span><span class="vs">explicar</span><span class="cf">|</span><span class="vs">resumo</span><span class="cf">|</span><span class="vs">tutorial b√°sico</span><span class="kw">)</span><span class="dv">\b</span><span class="vs">'</span></span>
<span id="cb24-1212"><a href="#cb24-1212" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb24-1213"><a href="#cb24-1213" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-1214"><a href="#cb24-1214" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> category, pattern <span class="kw">in</span> patterns.items():</span>
<span id="cb24-1215"><a href="#cb24-1215" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> re.search(pattern, text, re.IGNORECASE):</span>
<span id="cb24-1216"><a href="#cb24-1216" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> category</span>
<span id="cb24-1217"><a href="#cb24-1217" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb24-1218"><a href="#cb24-1218" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">'Outros'</span></span>
<span id="cb24-1219"><a href="#cb24-1219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-1220"><a href="#cb24-1220" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> parse_timestamp_for_sorting(<span class="va">self</span>, timestamp) <span class="op">-></span> datetime:</span>
<span id="cb24-1221"><a href="#cb24-1221" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> timestamp:</span>
<span id="cb24-1222"><a href="#cb24-1222" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> datetime.<span class="bu">min</span></span>
<span id="cb24-1223"><a href="#cb24-1223" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-1224"><a href="#cb24-1224" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb24-1225"><a href="#cb24-1225" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">isinstance</span>(timestamp, <span class="bu">str</span>):</span>
<span id="cb24-1226"><a href="#cb24-1226" aria-hidden="true" tabindex="-1"></a>                clean_ts <span class="op">=</span> timestamp.replace(<span class="st">'T'</span>, <span class="st">' '</span>).split(<span class="st">'.'</span>)[<span class="dv">0</span>].split(<span class="st">'+'</span>)[<span class="dv">0</span>]</span>
<span id="cb24-1227"><a href="#cb24-1227" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> clean_ts.endswith(<span class="st">'Z'</span>):</span>
<span id="cb24-1228"><a href="#cb24-1228" aria-hidden="true" tabindex="-1"></a>                    clean_ts <span class="op">=</span> clean_ts[:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb24-1229"><a href="#cb24-1229" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> datetime.fromisoformat(clean_ts)</span>
<span id="cb24-1230"><a href="#cb24-1230" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> <span class="bu">isinstance</span>(timestamp, (<span class="bu">int</span>, <span class="bu">float</span>)):</span>
<span id="cb24-1231"><a href="#cb24-1231" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> datetime.fromtimestamp(timestamp)</span>
<span id="cb24-1232"><a href="#cb24-1232" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span>:</span>
<span id="cb24-1233"><a href="#cb24-1233" aria-hidden="true" tabindex="-1"></a>            <span class="cf">pass</span></span>
<span id="cb24-1234"><a href="#cb24-1234" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-1235"><a href="#cb24-1235" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> datetime.<span class="bu">min</span></span>
<span id="cb24-1236"><a href="#cb24-1236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-1237"><a href="#cb24-1237" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> format_timestamp(<span class="va">self</span>, timestamp) <span class="op">-></span> Optional[<span class="bu">str</span>]:</span>
<span id="cb24-1238"><a href="#cb24-1238" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> timestamp:</span>
<span id="cb24-1239"><a href="#cb24-1239" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb24-1240"><a href="#cb24-1240" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-1241"><a href="#cb24-1241" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb24-1242"><a href="#cb24-1242" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">isinstance</span>(timestamp, (<span class="bu">int</span>, <span class="bu">float</span>)):</span>
<span id="cb24-1243"><a href="#cb24-1243" aria-hidden="true" tabindex="-1"></a>                dt <span class="op">=</span> datetime.fromtimestamp(timestamp)</span>
<span id="cb24-1244"><a href="#cb24-1244" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> dt.strftime(<span class="st">'%Y-%m-</span><span class="sc">%d</span><span class="st"> %H:%M:%S'</span>)</span>
<span id="cb24-1245"><a href="#cb24-1245" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> <span class="bu">isinstance</span>(timestamp, <span class="bu">str</span>):</span>
<span id="cb24-1246"><a href="#cb24-1246" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="st">'T'</span> <span class="kw">in</span> timestamp:</span>
<span id="cb24-1247"><a href="#cb24-1247" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">return</span> timestamp.replace(<span class="st">'T'</span>, <span class="st">' '</span>).split(<span class="st">'.'</span>)[<span class="dv">0</span>]</span>
<span id="cb24-1248"><a href="#cb24-1248" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> timestamp</span>
<span id="cb24-1249"><a href="#cb24-1249" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span>:</span>
<span id="cb24-1250"><a href="#cb24-1250" aria-hidden="true" tabindex="-1"></a>            <span class="cf">pass</span></span>
<span id="cb24-1251"><a href="#cb24-1251" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-1252"><a href="#cb24-1252" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">str</span>(timestamp)</span>
<span id="cb24-1253"><a href="#cb24-1253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-1254"><a href="#cb24-1254" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_enhanced_markdown_content(<span class="va">self</span>, conversation: Dict[<span class="bu">str</span>, Any]) <span class="op">-></span> <span class="bu">str</span>:</span>
<span id="cb24-1255"><a href="#cb24-1255" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Gera conte√∫do Markdown com preserva√ß√£o total de formata√ß√£o"""</span></span>
<span id="cb24-1256"><a href="#cb24-1256" aria-hidden="true" tabindex="-1"></a>        lines <span class="op">=</span> [</span>
<span id="cb24-1257"><a href="#cb24-1257" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f"# </span><span class="sc">{</span>conversation[<span class="st">'title'</span>]<span class="sc">}</span><span class="ss">"</span>,</span>
<span id="cb24-1258"><a href="#cb24-1258" aria-hidden="true" tabindex="-1"></a>            <span class="st">""</span>,</span>
<span id="cb24-1259"><a href="#cb24-1259" aria-hidden="true" tabindex="-1"></a>            <span class="st">"## üìä Informa√ß√µes"</span>,</span>
<span id="cb24-1260"><a href="#cb24-1260" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f"- **N√∫mero:** #</span><span class="sc">{</span>conversation[<span class="st">'number'</span>]<span class="sc">}</span><span class="ss">"</span>,</span>
<span id="cb24-1261"><a href="#cb24-1261" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f"- **Origem:** </span><span class="sc">{</span>conversation[<span class="st">'source'</span>]<span class="sc">}</span><span class="ss">"</span>,</span>
<span id="cb24-1262"><a href="#cb24-1262" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f"- **Categoria:** </span><span class="sc">{</span>conversation[<span class="st">'category'</span>]<span class="sc">}</span><span class="ss">"</span>,</span>
<span id="cb24-1263"><a href="#cb24-1263" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f"- **ID:** </span><span class="sc">{</span>conversation<span class="sc">.</span>get(<span class="st">'id'</span>, <span class="st">'N/A'</span>)<span class="sc">}</span><span class="ss">"</span>,</span>
<span id="cb24-1264"><a href="#cb24-1264" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f"- **Criada em:** </span><span class="sc">{</span>conversation<span class="sc">.</span>get(<span class="st">'inserted_at'</span>) <span class="kw">or</span> conversation<span class="sc">.</span>get(<span class="st">'created_at'</span>) <span class="kw">or</span> <span class="st">'N/A'</span><span class="sc">}</span><span class="ss">"</span>,</span>
<span id="cb24-1265"><a href="#cb24-1265" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb24-1266"><a href="#cb24-1266" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-1267"><a href="#cb24-1267" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> conversation.get(<span class="st">'updated_at'</span>):</span>
<span id="cb24-1268"><a href="#cb24-1268" aria-hidden="true" tabindex="-1"></a>            lines.append(<span class="ss">f"- **Atualizada em:** </span><span class="sc">{</span>conversation[<span class="st">'updated_at'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb24-1269"><a href="#cb24-1269" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-1270"><a href="#cb24-1270" aria-hidden="true" tabindex="-1"></a>        lines.extend([</span>
<span id="cb24-1271"><a href="#cb24-1271" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f"- **Total de mensagens:** </span><span class="sc">{</span><span class="bu">len</span>(conversation[<span class="st">'messages'</span>])<span class="sc">}</span><span class="ss">"</span>,</span>
<span id="cb24-1272"><a href="#cb24-1272" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f"- **Resumo:** </span><span class="sc">{</span>conversation<span class="sc">.</span>get(<span class="st">'summary'</span>, <span class="st">'Sem resumo'</span>)<span class="sc">}</span><span class="ss">"</span>,</span>
<span id="cb24-1273"><a href="#cb24-1273" aria-hidden="true" tabindex="-1"></a>            <span class="st">""</span>,</span>
<span id="cb24-1274"><a href="#cb24-1274" aria-hidden="true" tabindex="-1"></a>            <span class="st">"---"</span>,</span>
<span id="cb24-1275"><a href="#cb24-1275" aria-hidden="true" tabindex="-1"></a>            <span class="st">""</span>,</span>
<span id="cb24-1276"><a href="#cb24-1276" aria-hidden="true" tabindex="-1"></a>            <span class="st">"## üí¨ Conversa"</span>,</span>
<span id="cb24-1277"><a href="#cb24-1277" aria-hidden="true" tabindex="-1"></a>            <span class="st">""</span></span>
<span id="cb24-1278"><a href="#cb24-1278" aria-hidden="true" tabindex="-1"></a>        ])</span>
<span id="cb24-1279"><a href="#cb24-1279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-1280"><a href="#cb24-1280" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, msg <span class="kw">in</span> <span class="bu">enumerate</span>(conversation[<span class="st">'messages'</span>], <span class="dv">1</span>):</span>
<span id="cb24-1281"><a href="#cb24-1281" aria-hidden="true" tabindex="-1"></a>            timestamp <span class="op">=</span> <span class="ss">f" *(</span><span class="sc">{</span>msg[<span class="st">'timestamp'</span>]<span class="sc">}</span><span class="ss">)*"</span> <span class="cf">if</span> msg[<span class="st">'timestamp'</span>] <span class="cf">else</span> <span class="st">""</span></span>
<span id="cb24-1282"><a href="#cb24-1282" aria-hidden="true" tabindex="-1"></a>            model_info <span class="op">=</span> <span class="ss">f" *[</span><span class="sc">{</span>msg<span class="sc">.</span>get(<span class="st">'model'</span>, <span class="st">''</span>)<span class="sc">}</span><span class="ss">]*"</span> <span class="cf">if</span> msg.get(<span class="st">'model'</span>) <span class="cf">else</span> <span class="st">""</span></span>
<span id="cb24-1283"><a href="#cb24-1283" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-1284"><a href="#cb24-1284" aria-hidden="true" tabindex="-1"></a>            preserved_content <span class="op">=</span> <span class="va">self</span>.preserve_special_content(msg[<span class="st">'content'</span>])</span>
<span id="cb24-1285"><a href="#cb24-1285" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-1286"><a href="#cb24-1286" aria-hidden="true" tabindex="-1"></a>            lines.extend([</span>
<span id="cb24-1287"><a href="#cb24-1287" aria-hidden="true" tabindex="-1"></a>                <span class="ss">f"### </span><span class="sc">{</span>msg[<span class="st">'author'</span>]<span class="sc">}{</span>timestamp<span class="sc">}{</span>model_info<span class="sc">}</span><span class="ss">"</span>,</span>
<span id="cb24-1288"><a href="#cb24-1288" aria-hidden="true" tabindex="-1"></a>                <span class="st">""</span>,</span>
<span id="cb24-1289"><a href="#cb24-1289" aria-hidden="true" tabindex="-1"></a>                <span class="ss">f"</span><span class="sc">{</span>preserved_content<span class="sc">}</span><span class="ss">"</span>,</span>
<span id="cb24-1290"><a href="#cb24-1290" aria-hidden="true" tabindex="-1"></a>                <span class="st">""</span></span>
<span id="cb24-1291"><a href="#cb24-1291" aria-hidden="true" tabindex="-1"></a>            ])</span>
<span id="cb24-1292"><a href="#cb24-1292" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-1293"><a href="#cb24-1293" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> j <span class="op"><</span> <span class="bu">len</span>(conversation[<span class="st">'messages'</span>]):</span>
<span id="cb24-1294"><a href="#cb24-1294" aria-hidden="true" tabindex="-1"></a>                lines.extend([<span class="st">"---"</span>, <span class="st">""</span>])</span>
<span id="cb24-1295"><a href="#cb24-1295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-1296"><a href="#cb24-1296" aria-hidden="true" tabindex="-1"></a>        lines.extend([</span>
<span id="cb24-1297"><a href="#cb24-1297" aria-hidden="true" tabindex="-1"></a>            <span class="st">"---"</span>,</span>
<span id="cb24-1298"><a href="#cb24-1298" aria-hidden="true" tabindex="-1"></a>            <span class="st">""</span>,</span>
<span id="cb24-1299"><a href="#cb24-1299" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f"*Conversa exportada do </span><span class="sc">{</span>conversation[<span class="st">'source'</span>]<span class="sc">}</span><span class="ss">*"</span>,</span>
<span id="cb24-1300"><a href="#cb24-1300" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f"*Processado em: </span><span class="sc">{</span>datetime<span class="sc">.</span>now()<span class="sc">.</span>strftime(<span class="st">'</span><span class="sc">%d</span><span class="st">/%m/%Y %H:%M'</span>)<span class="sc">}</span><span class="ss">*"</span></span>
<span id="cb24-1301"><a href="#cb24-1301" aria-hidden="true" tabindex="-1"></a>        ])</span>
<span id="cb24-1302"><a href="#cb24-1302" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-1303"><a href="#cb24-1303" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">'</span><span class="ch">\n</span><span class="st">'</span>.join(lines)</span>
<span id="cb24-1304"><a href="#cb24-1304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-1305"><a href="#cb24-1305" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> process_qwen_corrected(<span class="va">self</span>, path: Path):</span>
<span id="cb24-1306"><a href="#cb24-1306" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Processa Qwen3 com corre√ß√£o para content_list - VERS√ÉO CORRIGIDA"""</span></span>
<span id="cb24-1307"><a href="#cb24-1307" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb24-1308"><a href="#cb24-1308" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="ss">f"üîÆ [DRY-RUN] Processaria Qwen3: </span><span class="sc">{</span>path<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb24-1309"><a href="#cb24-1309" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb24-1310"><a href="#cb24-1310" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-1311"><a href="#cb24-1311" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb24-1312"><a href="#cb24-1312" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(path, <span class="st">'r'</span>, encoding<span class="op">=</span><span class="st">'utf-8'</span>) <span class="im">as</span> f:</span>
<span id="cb24-1313"><a href="#cb24-1313" aria-hidden="true" tabindex="-1"></a>                raw_data <span class="op">=</span> json.load(f)</span>
<span id="cb24-1314"><a href="#cb24-1314" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb24-1315"><a href="#cb24-1315" aria-hidden="true" tabindex="-1"></a>            <span class="co"># DEBUG: Salvar estrutura completa para an√°lise</span></span>
<span id="cb24-1316"><a href="#cb24-1316" aria-hidden="true" tabindex="-1"></a>            debug_file <span class="op">=</span> Path(<span class="st">"qwen_debug_structure.json"</span>)</span>
<span id="cb24-1317"><a href="#cb24-1317" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(debug_file, <span class="st">'w'</span>, encoding<span class="op">=</span><span class="st">'utf-8'</span>) <span class="im">as</span> f:</span>
<span id="cb24-1318"><a href="#cb24-1318" aria-hidden="true" tabindex="-1"></a>                json.dump(raw_data, f, indent<span class="op">=</span><span class="dv">2</span>, ensure_ascii<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb24-1319"><a href="#cb24-1319" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="ss">f"üîç Estrutura Qwen salva em: </span><span class="sc">{</span>debug_file<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb24-1320"><a href="#cb24-1320" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-1321"><a href="#cb24-1321" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Extrair conversas</span></span>
<span id="cb24-1322"><a href="#cb24-1322" aria-hidden="true" tabindex="-1"></a>            conversations <span class="op">=</span> []</span>
<span id="cb24-1323"><a href="#cb24-1323" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-1324"><a href="#cb24-1324" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="st">'data'</span> <span class="kw">in</span> raw_data <span class="kw">and</span> <span class="bu">isinstance</span>(raw_data[<span class="st">'data'</span>], <span class="bu">list</span>):</span>
<span id="cb24-1325"><a href="#cb24-1325" aria-hidden="true" tabindex="-1"></a>                conversations <span class="op">=</span> raw_data[<span class="st">'data'</span>]</span>
<span id="cb24-1326"><a href="#cb24-1326" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.info(<span class="ss">f"üìÅ Estrutura 1: </span><span class="sc">{</span><span class="bu">len</span>(conversations)<span class="sc">}</span><span class="ss"> conversas em 'data'"</span>)</span>
<span id="cb24-1327"><a href="#cb24-1327" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> <span class="bu">isinstance</span>(raw_data, <span class="bu">list</span>):</span>
<span id="cb24-1328"><a href="#cb24-1328" aria-hidden="true" tabindex="-1"></a>                conversations <span class="op">=</span> raw_data</span>
<span id="cb24-1329"><a href="#cb24-1329" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.info(<span class="ss">f"üìÅ Estrutura 2: </span><span class="sc">{</span><span class="bu">len</span>(conversations)<span class="sc">}</span><span class="ss"> conversas na raiz"</span>)</span>
<span id="cb24-1330"><a href="#cb24-1330" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb24-1331"><a href="#cb24-1331" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> key, value <span class="kw">in</span> raw_data.items():</span>
<span id="cb24-1332"><a href="#cb24-1332" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="bu">isinstance</span>(value, <span class="bu">list</span>) <span class="kw">and</span> <span class="bu">len</span>(value) <span class="op">></span> <span class="dv">0</span>:</span>
<span id="cb24-1333"><a href="#cb24-1333" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">if</span> <span class="bu">isinstance</span>(value[<span class="dv">0</span>], <span class="bu">dict</span>) <span class="kw">and</span> <span class="bu">any</span>(k <span class="kw">in</span> value[<span class="dv">0</span>] <span class="cf">for</span> k <span class="kw">in</span> [<span class="st">'title'</span>, <span class="st">'chat'</span>, <span class="st">'messages'</span>]):</span>
<span id="cb24-1334"><a href="#cb24-1334" aria-hidden="true" tabindex="-1"></a>                            conversations <span class="op">=</span> value</span>
<span id="cb24-1335"><a href="#cb24-1335" aria-hidden="true" tabindex="-1"></a>                            <span class="va">self</span>.logger.info(<span class="ss">f"üìÅ Estrutura alternativa: </span><span class="sc">{</span><span class="bu">len</span>(conversations)<span class="sc">}</span><span class="ss"> conversas em '</span><span class="sc">{</span>key<span class="sc">}</span><span class="ss">'"</span>)</span>
<span id="cb24-1336"><a href="#cb24-1336" aria-hidden="true" tabindex="-1"></a>                            <span class="cf">break</span></span>
<span id="cb24-1337"><a href="#cb24-1337" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-1338"><a href="#cb24-1338" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> conversations:</span>
<span id="cb24-1339"><a href="#cb24-1339" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.error(<span class="st">"‚ùå Nenhuma conversa encontrada no arquivo Qwen"</span>)</span>
<span id="cb24-1340"><a href="#cb24-1340" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span></span>
<span id="cb24-1341"><a href="#cb24-1341" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb24-1342"><a href="#cb24-1342" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="ss">f"üîç Qwen: encontradas </span><span class="sc">{</span><span class="bu">len</span>(conversations)<span class="sc">}</span><span class="ss"> conversas."</span>)</span>
<span id="cb24-1343"><a href="#cb24-1343" aria-hidden="true" tabindex="-1"></a>            processed_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb24-1344"><a href="#cb24-1344" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-1345"><a href="#cb24-1345" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> i, conv <span class="kw">in</span> <span class="bu">enumerate</span>(conversations):</span>
<span id="cb24-1346"><a href="#cb24-1346" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(conv, <span class="bu">dict</span>):</span>
<span id="cb24-1347"><a href="#cb24-1347" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">continue</span></span>
<span id="cb24-1348"><a href="#cb24-1348" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb24-1349"><a href="#cb24-1349" aria-hidden="true" tabindex="-1"></a>                original_title <span class="op">=</span> conv.get(<span class="st">'title'</span>, <span class="ss">f'Conversa Qwen </span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb24-1350"><a href="#cb24-1350" aria-hidden="true" tabindex="-1"></a>                clean_title <span class="op">=</span> <span class="va">self</span>.preserve_original_title(original_title)</span>
<span id="cb24-1351"><a href="#cb24-1351" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb24-1352"><a href="#cb24-1352" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.info(<span class="ss">f"   üîç Processando: '</span><span class="sc">{</span>clean_title<span class="sc">}</span><span class="ss">'"</span>)</span>
<span id="cb24-1353"><a href="#cb24-1353" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb24-1354"><a href="#cb24-1354" aria-hidden="true" tabindex="-1"></a>                <span class="co"># EXTRA√á√ÉO CORRIGIDA - foco em content_list</span></span>
<span id="cb24-1355"><a href="#cb24-1355" aria-hidden="true" tabindex="-1"></a>                messages <span class="op">=</span> <span class="va">self</span>._extract_qwen_messages_corrected(conv, clean_title, i)</span>
<span id="cb24-1356"><a href="#cb24-1356" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb24-1357"><a href="#cb24-1357" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> messages:</span>
<span id="cb24-1358"><a href="#cb24-1358" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># Ordenar mensagens por timestamp</span></span>
<span id="cb24-1359"><a href="#cb24-1359" aria-hidden="true" tabindex="-1"></a>                    messages.sort(key<span class="op">=</span><span class="kw">lambda</span> x: <span class="va">self</span>.parse_timestamp_for_sorting(x[<span class="st">'timestamp'</span>]))</span>
<span id="cb24-1360"><a href="#cb24-1360" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb24-1361"><a href="#cb24-1361" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.all_conversations.append({</span>
<span id="cb24-1362"><a href="#cb24-1362" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'title'</span>: clean_title,</span>
<span id="cb24-1363"><a href="#cb24-1363" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'source'</span>: <span class="st">'Qwen3'</span>,</span>
<span id="cb24-1364"><a href="#cb24-1364" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'id'</span>: conv.get(<span class="st">'id'</span>, <span class="ss">f'qwen_</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">'</span>),</span>
<span id="cb24-1365"><a href="#cb24-1365" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'inserted_at'</span>: <span class="va">self</span>.format_timestamp(conv.get(<span class="st">'created_at'</span>)),</span>
<span id="cb24-1366"><a href="#cb24-1366" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'updated_at'</span>: <span class="va">self</span>.format_timestamp(conv.get(<span class="st">'updated_at'</span>)),</span>
<span id="cb24-1367"><a href="#cb24-1367" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'messages'</span>: messages,</span>
<span id="cb24-1368"><a href="#cb24-1368" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'summary'</span>: messages[<span class="dv">0</span>][<span class="st">'content'</span>][:<span class="dv">100</span>] <span class="op">+</span> <span class="st">"..."</span> <span class="cf">if</span> messages <span class="cf">else</span> <span class="st">"Sem conte√∫do"</span>,</span>
<span id="cb24-1369"><a href="#cb24-1369" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'category'</span>: <span class="va">self</span>.categorize_conversation(clean_title, messages[<span class="dv">0</span>][<span class="st">'content'</span>][:<span class="dv">100</span>] <span class="cf">if</span> messages <span class="cf">else</span> <span class="st">""</span>)</span>
<span id="cb24-1370"><a href="#cb24-1370" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb24-1371"><a href="#cb24-1371" aria-hidden="true" tabindex="-1"></a>                    processed_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb24-1372"><a href="#cb24-1372" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.logger.info(<span class="ss">f"   ‚úÖ Adicionada: </span><span class="sc">{</span><span class="bu">len</span>(messages)<span class="sc">}</span><span class="ss"> mensagens"</span>)</span>
<span id="cb24-1373"><a href="#cb24-1373" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb24-1374"><a href="#cb24-1374" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.logger.warning(<span class="ss">f"   ‚ùå Conversa </span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">: nenhuma mensagem extra√≠da"</span>)</span>
<span id="cb24-1375"><a href="#cb24-1375" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb24-1376"><a href="#cb24-1376" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="ss">f"‚úÖ Qwen3: </span><span class="sc">{</span>processed_count<span class="sc">}</span><span class="ss"> conversas processadas."</span>)</span>
<span id="cb24-1377"><a href="#cb24-1377" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-1378"><a href="#cb24-1378" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb24-1379"><a href="#cb24-1379" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.error(<span class="ss">f"‚ùå Erro ao processar Qwen3: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb24-1380"><a href="#cb24-1380" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.error(traceback.format_exc())</span>
<span id="cb24-1381"><a href="#cb24-1381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-1382"><a href="#cb24-1382" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _extract_qwen_messages_corrected(<span class="va">self</span>, conv: Dict[<span class="bu">str</span>, Any], clean_title: <span class="bu">str</span>, conv_index: <span class="bu">int</span>) <span class="op">-></span> List[Dict[<span class="bu">str</span>, Any]]:</span>
<span id="cb24-1383"><a href="#cb24-1383" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Extrai mensagens do Qwen com corre√ß√£o para content_list"""</span></span>
<span id="cb24-1384"><a href="#cb24-1384" aria-hidden="true" tabindex="-1"></a>        all_messages <span class="op">=</span> []</span>
<span id="cb24-1385"><a href="#cb24-1385" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-1386"><a href="#cb24-1386" aria-hidden="true" tabindex="-1"></a>        <span class="co"># ESTRAT√âGIA PRINCIPAL: Buscar em toda a estrutura por mensagens</span></span>
<span id="cb24-1387"><a href="#cb24-1387" aria-hidden="true" tabindex="-1"></a>        <span class="kw">def</span> extract_from_object(obj, path<span class="op">=</span><span class="st">""</span>):</span>
<span id="cb24-1388"><a href="#cb24-1388" aria-hidden="true" tabindex="-1"></a>            messages_found <span class="op">=</span> []</span>
<span id="cb24-1389"><a href="#cb24-1389" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-1390"><a href="#cb24-1390" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">isinstance</span>(obj, <span class="bu">dict</span>):</span>
<span id="cb24-1391"><a href="#cb24-1391" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Verificar se √© uma mensagem com content_list (CASO CORRIGIDO)</span></span>
<span id="cb24-1392"><a href="#cb24-1392" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="va">self</span>._is_qwen_message_with_content(obj):</span>
<span id="cb24-1393"><a href="#cb24-1393" aria-hidden="true" tabindex="-1"></a>                    message <span class="op">=</span> <span class="va">self</span>._create_message_from_qwen_object(obj)</span>
<span id="cb24-1394"><a href="#cb24-1394" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> message:</span>
<span id="cb24-1395"><a href="#cb24-1395" aria-hidden="true" tabindex="-1"></a>                        messages_found.append(message)</span>
<span id="cb24-1396"><a href="#cb24-1396" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb24-1397"><a href="#cb24-1397" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Buscar recursivamente</span></span>
<span id="cb24-1398"><a href="#cb24-1398" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> key, value <span class="kw">in</span> obj.items():</span>
<span id="cb24-1399"><a href="#cb24-1399" aria-hidden="true" tabindex="-1"></a>                    messages_found.extend(extract_from_object(value, <span class="ss">f"</span><span class="sc">{</span>path<span class="sc">}</span><span class="ss">.</span><span class="sc">{</span>key<span class="sc">}</span><span class="ss">"</span>))</span>
<span id="cb24-1400"><a href="#cb24-1400" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb24-1401"><a href="#cb24-1401" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> <span class="bu">isinstance</span>(obj, <span class="bu">list</span>):</span>
<span id="cb24-1402"><a href="#cb24-1402" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> item <span class="kw">in</span> obj:</span>
<span id="cb24-1403"><a href="#cb24-1403" aria-hidden="true" tabindex="-1"></a>                    messages_found.extend(extract_from_object(item, path))</span>
<span id="cb24-1404"><a href="#cb24-1404" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb24-1405"><a href="#cb24-1405" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> messages_found</span>
<span id="cb24-1406"><a href="#cb24-1406" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-1407"><a href="#cb24-1407" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Aplicar extra√ß√£o recursiva</span></span>
<span id="cb24-1408"><a href="#cb24-1408" aria-hidden="true" tabindex="-1"></a>        all_messages <span class="op">=</span> extract_from_object(conv, <span class="st">"root"</span>)</span>
<span id="cb24-1409"><a href="#cb24-1409" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-1410"><a href="#cb24-1410" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Remover duplicatas</span></span>
<span id="cb24-1411"><a href="#cb24-1411" aria-hidden="true" tabindex="-1"></a>        unique_messages <span class="op">=</span> <span class="va">self</span>._remove_duplicate_messages(all_messages)</span>
<span id="cb24-1412"><a href="#cb24-1412" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-1413"><a href="#cb24-1413" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(unique_messages) <span class="op">!=</span> <span class="bu">len</span>(all_messages):</span>
<span id="cb24-1414"><a href="#cb24-1414" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="ss">f"         üîÑ Removidas </span><span class="sc">{</span><span class="bu">len</span>(all_messages) <span class="op">-</span> <span class="bu">len</span>(unique_messages)<span class="sc">}</span><span class="ss"> mensagens duplicadas"</span>)</span>
<span id="cb24-1415"><a href="#cb24-1415" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-1416"><a href="#cb24-1416" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> unique_messages</span>
<span id="cb24-1417"><a href="#cb24-1417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-1418"><a href="#cb24-1418" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _is_qwen_message_with_content(<span class="va">self</span>, obj: Dict) <span class="op">-></span> <span class="bu">bool</span>:</span>
<span id="cb24-1419"><a href="#cb24-1419" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Verifica se √© uma mensagem Qwen v√°lida (incluindo content_list)"""</span></span>
<span id="cb24-1420"><a href="#cb24-1420" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Verificar campos b√°sicos de mensagem</span></span>
<span id="cb24-1421"><a href="#cb24-1421" aria-hidden="true" tabindex="-1"></a>        has_basic_structure <span class="op">=</span> (<span class="st">'role'</span> <span class="kw">in</span> obj <span class="kw">and</span> <span class="st">'content'</span> <span class="kw">in</span> obj)</span>
<span id="cb24-1422"><a href="#cb24-1422" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-1423"><a href="#cb24-1423" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Verificar se tem content_list (CORRE√á√ÉO DO PROBLEMA)</span></span>
<span id="cb24-1424"><a href="#cb24-1424" aria-hidden="true" tabindex="-1"></a>        has_content_list <span class="op">=</span> <span class="st">'content_list'</span> <span class="kw">in</span> obj <span class="kw">and</span> <span class="bu">isinstance</span>(obj[<span class="st">'content_list'</span>], <span class="bu">list</span>)</span>
<span id="cb24-1425"><a href="#cb24-1425" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-1426"><a href="#cb24-1426" aria-hidden="true" tabindex="-1"></a>        <span class="co"># √â uma mensagem v√°lida se tiver estrutura b√°sica E (conte√∫do n√£o vazio OU content_list)</span></span>
<span id="cb24-1427"><a href="#cb24-1427" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> (has_basic_structure <span class="kw">and</span> </span>
<span id="cb24-1428"><a href="#cb24-1428" aria-hidden="true" tabindex="-1"></a>                (obj.get(<span class="st">'content'</span>) <span class="kw">or</span> has_content_list) <span class="kw">and</span></span>
<span id="cb24-1429"><a href="#cb24-1429" aria-hidden="true" tabindex="-1"></a>                obj.get(<span class="st">'role'</span>) <span class="kw">in</span> [<span class="st">'user'</span>, <span class="st">'assistant'</span>])</span>
<span id="cb24-1430"><a href="#cb24-1430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-1431"><a href="#cb24-1431" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _create_message_from_qwen_object(<span class="va">self</span>, obj: Dict) <span class="op">-></span> Optional[Dict[<span class="bu">str</span>, Any]]:</span>
<span id="cb24-1432"><a href="#cb24-1432" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Cria uma mensagem a partir de um objeto Qwen, priorizando content_list"""</span></span>
<span id="cb24-1433"><a href="#cb24-1433" aria-hidden="true" tabindex="-1"></a>        role <span class="op">=</span> obj.get(<span class="st">'role'</span>, <span class="st">''</span>)</span>
<span id="cb24-1434"><a href="#cb24-1434" aria-hidden="true" tabindex="-1"></a>        content <span class="op">=</span> obj.get(<span class="st">'content'</span>, <span class="st">''</span>)</span>
<span id="cb24-1435"><a href="#cb24-1435" aria-hidden="true" tabindex="-1"></a>        content_list <span class="op">=</span> obj.get(<span class="st">'content_list'</span>, [])</span>
<span id="cb24-1436"><a href="#cb24-1436" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-1437"><a href="#cb24-1437" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> role:</span>
<span id="cb24-1438"><a href="#cb24-1438" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb24-1439"><a href="#cb24-1439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-1440"><a href="#cb24-1440" aria-hidden="true" tabindex="-1"></a>        <span class="co"># CORRE√á√ÉO PRINCIPAL: Priorizar content_list quando content estiver vazio</span></span>
<span id="cb24-1441"><a href="#cb24-1441" aria-hidden="true" tabindex="-1"></a>        final_content <span class="op">=</span> <span class="st">""</span></span>
<span id="cb24-1442"><a href="#cb24-1442" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-1443"><a href="#cb24-1443" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> content_list <span class="kw">and</span> <span class="bu">isinstance</span>(content_list, <span class="bu">list</span>):</span>
<span id="cb24-1444"><a href="#cb24-1444" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Extrair conte√∫do de content_list</span></span>
<span id="cb24-1445"><a href="#cb24-1445" aria-hidden="true" tabindex="-1"></a>            content_parts <span class="op">=</span> []</span>
<span id="cb24-1446"><a href="#cb24-1446" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> content_item <span class="kw">in</span> content_list:</span>
<span id="cb24-1447"><a href="#cb24-1447" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="bu">isinstance</span>(content_item, <span class="bu">dict</span>):</span>
<span id="cb24-1448"><a href="#cb24-1448" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># Verificar diferentes estruturas de content_list</span></span>
<span id="cb24-1449"><a href="#cb24-1449" aria-hidden="true" tabindex="-1"></a>                    item_content <span class="op">=</span> content_item.get(<span class="st">'content'</span>, <span class="st">''</span>)</span>
<span id="cb24-1450"><a href="#cb24-1450" aria-hidden="true" tabindex="-1"></a>                    item_text <span class="op">=</span> content_item.get(<span class="st">'text'</span>, <span class="st">''</span>)</span>
<span id="cb24-1451"><a href="#cb24-1451" aria-hidden="true" tabindex="-1"></a>                    item_type <span class="op">=</span> content_item.get(<span class="st">'type'</span>, <span class="st">''</span>)</span>
<span id="cb24-1452"><a href="#cb24-1452" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb24-1453"><a href="#cb24-1453" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> item_content:</span>
<span id="cb24-1454"><a href="#cb24-1454" aria-hidden="true" tabindex="-1"></a>                        content_parts.append(<span class="bu">str</span>(item_content))</span>
<span id="cb24-1455"><a href="#cb24-1455" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">elif</span> item_text:</span>
<span id="cb24-1456"><a href="#cb24-1456" aria-hidden="true" tabindex="-1"></a>                        content_parts.append(<span class="bu">str</span>(item_text))</span>
<span id="cb24-1457"><a href="#cb24-1457" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">elif</span> item_type <span class="op">==</span> <span class="st">'text'</span> <span class="kw">and</span> <span class="st">'text'</span> <span class="kw">in</span> content_item:</span>
<span id="cb24-1458"><a href="#cb24-1458" aria-hidden="true" tabindex="-1"></a>                        content_parts.append(<span class="bu">str</span>(content_item[<span class="st">'text'</span>]))</span>
<span id="cb24-1459"><a href="#cb24-1459" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-1460"><a href="#cb24-1460" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> content_parts:</span>
<span id="cb24-1461"><a href="#cb24-1461" aria-hidden="true" tabindex="-1"></a>                final_content <span class="op">=</span> <span class="st">'</span><span class="ch">\n</span><span class="st">'</span>.join(content_parts).strip()</span>
<span id="cb24-1462"><a href="#cb24-1462" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-1463"><a href="#cb24-1463" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Se content_list n√£o forneceu conte√∫do, usar o campo content tradicional</span></span>
<span id="cb24-1464"><a href="#cb24-1464" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> final_content <span class="kw">and</span> content:</span>
<span id="cb24-1465"><a href="#cb24-1465" aria-hidden="true" tabindex="-1"></a>            final_content <span class="op">=</span> <span class="bu">str</span>(content).strip()</span>
<span id="cb24-1466"><a href="#cb24-1466" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-1467"><a href="#cb24-1467" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Se ainda n√£o tem conte√∫do, pular</span></span>
<span id="cb24-1468"><a href="#cb24-1468" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> final_content <span class="kw">or</span> final_content <span class="op">==</span> <span class="st">'null'</span>:</span>
<span id="cb24-1469"><a href="#cb24-1469" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb24-1470"><a href="#cb24-1470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-1471"><a href="#cb24-1471" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Determinar autor</span></span>
<span id="cb24-1472"><a href="#cb24-1472" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> role <span class="op">==</span> <span class="st">'user'</span>:</span>
<span id="cb24-1473"><a href="#cb24-1473" aria-hidden="true" tabindex="-1"></a>            author <span class="op">=</span> <span class="st">"üë§ Utilizador"</span></span>
<span id="cb24-1474"><a href="#cb24-1474" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> role <span class="op">==</span> <span class="st">'assistant'</span>:</span>
<span id="cb24-1475"><a href="#cb24-1475" aria-hidden="true" tabindex="-1"></a>            author <span class="op">=</span> <span class="st">"ü§ñ Qwen3"</span></span>
<span id="cb24-1476"><a href="#cb24-1476" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb24-1477"><a href="#cb24-1477" aria-hidden="true" tabindex="-1"></a>            author <span class="op">=</span> <span class="ss">f"üîπ </span><span class="sc">{</span>role<span class="sc">.</span>title()<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb24-1478"><a href="#cb24-1478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-1479"><a href="#cb24-1479" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Processar conte√∫do especial</span></span>
<span id="cb24-1480"><a href="#cb24-1480" aria-hidden="true" tabindex="-1"></a>        final_content <span class="op">=</span> <span class="va">self</span>.preserve_special_content(final_content)</span>
<span id="cb24-1481"><a href="#cb24-1481" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-1482"><a href="#cb24-1482" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb24-1483"><a href="#cb24-1483" aria-hidden="true" tabindex="-1"></a>            <span class="st">'author'</span>: author,</span>
<span id="cb24-1484"><a href="#cb24-1484" aria-hidden="true" tabindex="-1"></a>            <span class="st">'role'</span>: role,</span>
<span id="cb24-1485"><a href="#cb24-1485" aria-hidden="true" tabindex="-1"></a>            <span class="st">'content'</span>: final_content,</span>
<span id="cb24-1486"><a href="#cb24-1486" aria-hidden="true" tabindex="-1"></a>            <span class="st">'timestamp'</span>: <span class="va">self</span>.format_timestamp(obj.get(<span class="st">'created_at'</span>)),</span>
<span id="cb24-1487"><a href="#cb24-1487" aria-hidden="true" tabindex="-1"></a>            <span class="st">'model'</span>: obj.get(<span class="st">'model'</span>, <span class="st">'Qwen3'</span>)</span>
<span id="cb24-1488"><a href="#cb24-1488" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb24-1489"><a href="#cb24-1489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-1490"><a href="#cb24-1490" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _remove_duplicate_messages(<span class="va">self</span>, messages: List[Dict[<span class="bu">str</span>, Any]]) <span class="op">-></span> List[Dict[<span class="bu">str</span>, Any]]:</span>
<span id="cb24-1491"><a href="#cb24-1491" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Remove mensagens duplicadas baseadas no conte√∫do"""</span></span>
<span id="cb24-1492"><a href="#cb24-1492" aria-hidden="true" tabindex="-1"></a>        seen <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb24-1493"><a href="#cb24-1493" aria-hidden="true" tabindex="-1"></a>        unique_messages <span class="op">=</span> []</span>
<span id="cb24-1494"><a href="#cb24-1494" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-1495"><a href="#cb24-1495" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> msg <span class="kw">in</span> messages:</span>
<span id="cb24-1496"><a href="#cb24-1496" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Criar uma chave √∫nica baseada no conte√∫do e timestamp</span></span>
<span id="cb24-1497"><a href="#cb24-1497" aria-hidden="true" tabindex="-1"></a>            content_key <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>msg[<span class="st">'content'</span>][:<span class="dv">100</span>]<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>msg[<span class="st">'timestamp'</span>]<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb24-1498"><a href="#cb24-1498" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-1499"><a href="#cb24-1499" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> content_key <span class="kw">not</span> <span class="kw">in</span> seen:</span>
<span id="cb24-1500"><a href="#cb24-1500" aria-hidden="true" tabindex="-1"></a>                seen.add(content_key)</span>
<span id="cb24-1501"><a href="#cb24-1501" aria-hidden="true" tabindex="-1"></a>                unique_messages.append(msg)</span>
<span id="cb24-1502"><a href="#cb24-1502" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-1503"><a href="#cb24-1503" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> unique_messages</span>
<span id="cb24-1504"><a href="#cb24-1504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-1505"><a href="#cb24-1505" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> process_chatgpt(<span class="va">self</span>, path: Path):</span>
<span id="cb24-1506"><a href="#cb24-1506" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Processa exporta√ß√£o do ChatGPT"""</span></span>
<span id="cb24-1507"><a href="#cb24-1507" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb24-1508"><a href="#cb24-1508" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="ss">f"üîÆ [DRY-RUN] Processaria ChatGPT: </span><span class="sc">{</span>path<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb24-1509"><a href="#cb24-1509" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb24-1510"><a href="#cb24-1510" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-1511"><a href="#cb24-1511" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb24-1512"><a href="#cb24-1512" aria-hidden="true" tabindex="-1"></a>            temp_dir <span class="op">=</span> tempfile.mkdtemp(prefix<span class="op">=</span><span class="st">"chatgpt_"</span>)</span>
<span id="cb24-1513"><a href="#cb24-1513" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> zipfile.ZipFile(path, <span class="st">'r'</span>) <span class="im">as</span> z:</span>
<span id="cb24-1514"><a href="#cb24-1514" aria-hidden="true" tabindex="-1"></a>                z.extractall(temp_dir)</span>
<span id="cb24-1515"><a href="#cb24-1515" aria-hidden="true" tabindex="-1"></a>            convs_path <span class="op">=</span> Path(temp_dir) <span class="op">/</span> <span class="st">"conversations.json"</span></span>
<span id="cb24-1516"><a href="#cb24-1516" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> convs_path.exists():</span>
<span id="cb24-1517"><a href="#cb24-1517" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.error(<span class="st">"‚ùå ChatGPT: conversations.json n√£o encontrado."</span>)</span>
<span id="cb24-1518"><a href="#cb24-1518" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span></span>
<span id="cb24-1519"><a href="#cb24-1519" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb24-1520"><a href="#cb24-1520" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(convs_path, <span class="st">'r'</span>, encoding<span class="op">=</span><span class="st">'utf-8'</span>) <span class="im">as</span> f:</span>
<span id="cb24-1521"><a href="#cb24-1521" aria-hidden="true" tabindex="-1"></a>                data <span class="op">=</span> json.load(f)</span>
<span id="cb24-1522"><a href="#cb24-1522" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb24-1523"><a href="#cb24-1523" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(data, <span class="bu">list</span>):</span>
<span id="cb24-1524"><a href="#cb24-1524" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.warning(<span class="st">"‚ö†Ô∏è  ChatGPT: estrutura inesperada."</span>)</span>
<span id="cb24-1525"><a href="#cb24-1525" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span></span>
<span id="cb24-1526"><a href="#cb24-1526" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb24-1527"><a href="#cb24-1527" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="ss">f"üîç ChatGPT: encontradas </span><span class="sc">{</span><span class="bu">len</span>(data)<span class="sc">}</span><span class="ss"> conversas."</span>)</span>
<span id="cb24-1528"><a href="#cb24-1528" aria-hidden="true" tabindex="-1"></a>            processed_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb24-1529"><a href="#cb24-1529" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-1530"><a href="#cb24-1530" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> i, conv <span class="kw">in</span> <span class="bu">enumerate</span>(data):</span>
<span id="cb24-1531"><a href="#cb24-1531" aria-hidden="true" tabindex="-1"></a>                original_title <span class="op">=</span> conv.get(<span class="st">'title'</span>, <span class="ss">f'Conversa ChatGPT </span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb24-1532"><a href="#cb24-1532" aria-hidden="true" tabindex="-1"></a>                <span class="co"># PRESERVA t√≠tulo original com espa√ßos</span></span>
<span id="cb24-1533"><a href="#cb24-1533" aria-hidden="true" tabindex="-1"></a>                clean_title <span class="op">=</span> <span class="va">self</span>.preserve_original_title(original_title)</span>
<span id="cb24-1534"><a href="#cb24-1534" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb24-1535"><a href="#cb24-1535" aria-hidden="true" tabindex="-1"></a>                messages <span class="op">=</span> []</span>
<span id="cb24-1536"><a href="#cb24-1536" aria-hidden="true" tabindex="-1"></a>                mapping <span class="op">=</span> conv.get(<span class="st">'mapping'</span>, {})</span>
<span id="cb24-1537"><a href="#cb24-1537" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb24-1538"><a href="#cb24-1538" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> msg_id, node <span class="kw">in</span> mapping.items():</span>
<span id="cb24-1539"><a href="#cb24-1539" aria-hidden="true" tabindex="-1"></a>                    msg_data <span class="op">=</span> node.get(<span class="st">'message'</span>)</span>
<span id="cb24-1540"><a href="#cb24-1540" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="kw">not</span> msg_data <span class="kw">or</span> <span class="kw">not</span> <span class="bu">isinstance</span>(msg_data, <span class="bu">dict</span>):</span>
<span id="cb24-1541"><a href="#cb24-1541" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb24-1542"><a href="#cb24-1542" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb24-1543"><a href="#cb24-1543" aria-hidden="true" tabindex="-1"></a>                    author_role <span class="op">=</span> msg_data.get(<span class="st">'author'</span>, {}).get(<span class="st">'role'</span>, <span class="st">''</span>)</span>
<span id="cb24-1544"><a href="#cb24-1544" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> author_role <span class="op">==</span> <span class="st">'user'</span>:</span>
<span id="cb24-1545"><a href="#cb24-1545" aria-hidden="true" tabindex="-1"></a>                        author <span class="op">=</span> <span class="st">"üë§ Utilizador"</span></span>
<span id="cb24-1546"><a href="#cb24-1546" aria-hidden="true" tabindex="-1"></a>                        role <span class="op">=</span> <span class="st">'user'</span></span>
<span id="cb24-1547"><a href="#cb24-1547" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">elif</span> author_role <span class="op">==</span> <span class="st">'assistant'</span>:</span>
<span id="cb24-1548"><a href="#cb24-1548" aria-hidden="true" tabindex="-1"></a>                        author <span class="op">=</span> <span class="st">"ü§ñ ChatGPT"</span></span>
<span id="cb24-1549"><a href="#cb24-1549" aria-hidden="true" tabindex="-1"></a>                        role <span class="op">=</span> <span class="st">'assistant'</span></span>
<span id="cb24-1550"><a href="#cb24-1550" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">else</span>:</span>
<span id="cb24-1551"><a href="#cb24-1551" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb24-1552"><a href="#cb24-1552" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb24-1553"><a href="#cb24-1553" aria-hidden="true" tabindex="-1"></a>                    content_parts <span class="op">=</span> []</span>
<span id="cb24-1554"><a href="#cb24-1554" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">for</span> part <span class="kw">in</span> msg_data.get(<span class="st">'content'</span>, {}).get(<span class="st">'parts'</span>, []):</span>
<span id="cb24-1555"><a href="#cb24-1555" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">if</span> <span class="bu">isinstance</span>(part, <span class="bu">str</span>):</span>
<span id="cb24-1556"><a href="#cb24-1556" aria-hidden="true" tabindex="-1"></a>                            content_parts.append(part)</span>
<span id="cb24-1557"><a href="#cb24-1557" aria-hidden="true" tabindex="-1"></a>                    content <span class="op">=</span> <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>.join(content_parts).strip()</span>
<span id="cb24-1558"><a href="#cb24-1558" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb24-1559"><a href="#cb24-1559" aria-hidden="true" tabindex="-1"></a>                    content <span class="op">=</span> <span class="va">self</span>.preserve_special_content(content)</span>
<span id="cb24-1560"><a href="#cb24-1560" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb24-1561"><a href="#cb24-1561" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="kw">not</span> content:</span>
<span id="cb24-1562"><a href="#cb24-1562" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb24-1563"><a href="#cb24-1563" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb24-1564"><a href="#cb24-1564" aria-hidden="true" tabindex="-1"></a>                    messages.append({</span>
<span id="cb24-1565"><a href="#cb24-1565" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'author'</span>: author,</span>
<span id="cb24-1566"><a href="#cb24-1566" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'role'</span>: role,</span>
<span id="cb24-1567"><a href="#cb24-1567" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'content'</span>: content,</span>
<span id="cb24-1568"><a href="#cb24-1568" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'timestamp'</span>: <span class="va">self</span>.format_timestamp(msg_data.get(<span class="st">'create_time'</span>)),</span>
<span id="cb24-1569"><a href="#cb24-1569" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'model'</span>: msg_data.get(<span class="st">'model'</span>, <span class="st">'ChatGPT'</span>)</span>
<span id="cb24-1570"><a href="#cb24-1570" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb24-1571"><a href="#cb24-1571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-1572"><a href="#cb24-1572" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> messages:</span>
<span id="cb24-1573"><a href="#cb24-1573" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.all_conversations.append({</span>
<span id="cb24-1574"><a href="#cb24-1574" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'title'</span>: clean_title,  <span class="co"># T√≠tulo ORIGINAL com espa√ßos</span></span>
<span id="cb24-1575"><a href="#cb24-1575" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'source'</span>: <span class="st">'ChatGPT'</span>,</span>
<span id="cb24-1576"><a href="#cb24-1576" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'id'</span>: conv.get(<span class="st">'id'</span>, <span class="ss">f'chatgpt_</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">'</span>),</span>
<span id="cb24-1577"><a href="#cb24-1577" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'inserted_at'</span>: <span class="va">self</span>.format_timestamp(conv.get(<span class="st">'create_time'</span>)),</span>
<span id="cb24-1578"><a href="#cb24-1578" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'updated_at'</span>: <span class="va">self</span>.format_timestamp(conv.get(<span class="st">'update_time'</span>)),</span>
<span id="cb24-1579"><a href="#cb24-1579" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'messages'</span>: messages,</span>
<span id="cb24-1580"><a href="#cb24-1580" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'summary'</span>: messages[<span class="dv">0</span>][<span class="st">'content'</span>][:<span class="dv">100</span>] <span class="op">+</span> <span class="st">"..."</span> <span class="cf">if</span> messages <span class="cf">else</span> <span class="st">"Sem conte√∫do"</span>,</span>
<span id="cb24-1581"><a href="#cb24-1581" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'category'</span>: <span class="st">'Geral'</span></span>
<span id="cb24-1582"><a href="#cb24-1582" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb24-1583"><a href="#cb24-1583" aria-hidden="true" tabindex="-1"></a>                    processed_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb24-1584"><a href="#cb24-1584" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb24-1585"><a href="#cb24-1585" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="ss">f"‚úÖ ChatGPT: </span><span class="sc">{</span>processed_count<span class="sc">}</span><span class="ss"> conversas processadas."</span>)</span>
<span id="cb24-1586"><a href="#cb24-1586" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-1587"><a href="#cb24-1587" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb24-1588"><a href="#cb24-1588" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.error(<span class="ss">f"‚ùå Erro ao processar ChatGPT: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb24-1589"><a href="#cb24-1589" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb24-1590"><a href="#cb24-1590" aria-hidden="true" tabindex="-1"></a>                traceback.print_exc()</span>
<span id="cb24-1591"><a href="#cb24-1591" aria-hidden="true" tabindex="-1"></a>        <span class="cf">finally</span>:</span>
<span id="cb24-1592"><a href="#cb24-1592" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="st">'temp_dir'</span> <span class="kw">in</span> <span class="bu">locals</span>():</span>
<span id="cb24-1593"><a href="#cb24-1593" aria-hidden="true" tabindex="-1"></a>                shutil.rmtree(temp_dir, ignore_errors<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb24-1594"><a href="#cb24-1594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-1595"><a href="#cb24-1595" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> process_deepseek(<span class="va">self</span>, path: Path):</span>
<span id="cb24-1596"><a href="#cb24-1596" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Processa exporta√ß√£o do DeepSeek"""</span></span>
<span id="cb24-1597"><a href="#cb24-1597" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb24-1598"><a href="#cb24-1598" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="ss">f"üîÆ [DRY-RUN] Processaria DeepSeek: </span><span class="sc">{</span>path<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb24-1599"><a href="#cb24-1599" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb24-1600"><a href="#cb24-1600" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-1601"><a href="#cb24-1601" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb24-1602"><a href="#cb24-1602" aria-hidden="true" tabindex="-1"></a>            temp_dir <span class="op">=</span> tempfile.mkdtemp(prefix<span class="op">=</span><span class="st">"deepseek_"</span>)</span>
<span id="cb24-1603"><a href="#cb24-1603" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> zipfile.ZipFile(path, <span class="st">'r'</span>) <span class="im">as</span> z:</span>
<span id="cb24-1604"><a href="#cb24-1604" aria-hidden="true" tabindex="-1"></a>                z.extractall(temp_dir)</span>
<span id="cb24-1605"><a href="#cb24-1605" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb24-1606"><a href="#cb24-1606" aria-hidden="true" tabindex="-1"></a>            convs_path <span class="op">=</span> Path(temp_dir) <span class="op">/</span> <span class="st">"conversations.json"</span></span>
<span id="cb24-1607"><a href="#cb24-1607" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> convs_path.exists():</span>
<span id="cb24-1608"><a href="#cb24-1608" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.error(<span class="st">"‚ùå DeepSeek: conversations.json n√£o encontrado."</span>)</span>
<span id="cb24-1609"><a href="#cb24-1609" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span></span>
<span id="cb24-1610"><a href="#cb24-1610" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb24-1611"><a href="#cb24-1611" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(convs_path, <span class="st">'r'</span>, encoding<span class="op">=</span><span class="st">'utf-8'</span>) <span class="im">as</span> f:</span>
<span id="cb24-1612"><a href="#cb24-1612" aria-hidden="true" tabindex="-1"></a>                raw_data <span class="op">=</span> json.load(f)</span>
<span id="cb24-1613"><a href="#cb24-1613" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb24-1614"><a href="#cb24-1614" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">isinstance</span>(raw_data, <span class="bu">list</span>):</span>
<span id="cb24-1615"><a href="#cb24-1615" aria-hidden="true" tabindex="-1"></a>                data <span class="op">=</span> raw_data</span>
<span id="cb24-1616"><a href="#cb24-1616" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> <span class="bu">isinstance</span>(raw_data, <span class="bu">dict</span>) <span class="kw">and</span> <span class="st">'data'</span> <span class="kw">in</span> raw_data:</span>
<span id="cb24-1617"><a href="#cb24-1617" aria-hidden="true" tabindex="-1"></a>                data <span class="op">=</span> raw_data[<span class="st">'data'</span>]</span>
<span id="cb24-1618"><a href="#cb24-1618" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb24-1619"><a href="#cb24-1619" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.warning(<span class="st">"‚ö†Ô∏è  DeepSeek: estrutura inesperada."</span>)</span>
<span id="cb24-1620"><a href="#cb24-1620" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span></span>
<span id="cb24-1621"><a href="#cb24-1621" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb24-1622"><a href="#cb24-1622" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(data, <span class="bu">list</span>):</span>
<span id="cb24-1623"><a href="#cb24-1623" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.warning(<span class="st">"‚ö†Ô∏è  DeepSeek: 'data' n√£o √© uma lista."</span>)</span>
<span id="cb24-1624"><a href="#cb24-1624" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span></span>
<span id="cb24-1625"><a href="#cb24-1625" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb24-1626"><a href="#cb24-1626" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="ss">f"üîç DeepSeek: encontradas </span><span class="sc">{</span><span class="bu">len</span>(data)<span class="sc">}</span><span class="ss"> conversas."</span>)</span>
<span id="cb24-1627"><a href="#cb24-1627" aria-hidden="true" tabindex="-1"></a>            processed_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb24-1628"><a href="#cb24-1628" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-1629"><a href="#cb24-1629" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> i, conv <span class="kw">in</span> <span class="bu">enumerate</span>(data):</span>
<span id="cb24-1630"><a href="#cb24-1630" aria-hidden="true" tabindex="-1"></a>                original_title <span class="op">=</span> conv.get(<span class="st">'title'</span>, <span class="ss">f'Conversa DeepSeek </span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb24-1631"><a href="#cb24-1631" aria-hidden="true" tabindex="-1"></a>                <span class="co"># PRESERVA t√≠tulo original com espa√ßos</span></span>
<span id="cb24-1632"><a href="#cb24-1632" aria-hidden="true" tabindex="-1"></a>                clean_title <span class="op">=</span> <span class="va">self</span>.preserve_original_title(original_title)</span>
<span id="cb24-1633"><a href="#cb24-1633" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb24-1634"><a href="#cb24-1634" aria-hidden="true" tabindex="-1"></a>                messages <span class="op">=</span> []</span>
<span id="cb24-1635"><a href="#cb24-1635" aria-hidden="true" tabindex="-1"></a>                mapping <span class="op">=</span> conv.get(<span class="st">'mapping'</span>, {})</span>
<span id="cb24-1636"><a href="#cb24-1636" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb24-1637"><a href="#cb24-1637" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> node_id, node <span class="kw">in</span> mapping.items():</span>
<span id="cb24-1638"><a href="#cb24-1638" aria-hidden="true" tabindex="-1"></a>                    msg_data <span class="op">=</span> node.get(<span class="st">'message'</span>)</span>
<span id="cb24-1639"><a href="#cb24-1639" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="kw">not</span> msg_data <span class="kw">or</span> <span class="kw">not</span> <span class="bu">isinstance</span>(msg_data, <span class="bu">dict</span>):</span>
<span id="cb24-1640"><a href="#cb24-1640" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb24-1641"><a href="#cb24-1641" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb24-1642"><a href="#cb24-1642" aria-hidden="true" tabindex="-1"></a>                    fragments <span class="op">=</span> msg_data.get(<span class="st">'fragments'</span>, [])</span>
<span id="cb24-1643"><a href="#cb24-1643" aria-hidden="true" tabindex="-1"></a>                    content_parts <span class="op">=</span> []</span>
<span id="cb24-1644"><a href="#cb24-1644" aria-hidden="true" tabindex="-1"></a>                    msg_type <span class="op">=</span> <span class="va">None</span></span>
<span id="cb24-1645"><a href="#cb24-1645" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb24-1646"><a href="#cb24-1646" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">for</span> frag <span class="kw">in</span> fragments:</span>
<span id="cb24-1647"><a href="#cb24-1647" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">if</span> <span class="bu">isinstance</span>(frag, <span class="bu">dict</span>):</span>
<span id="cb24-1648"><a href="#cb24-1648" aria-hidden="true" tabindex="-1"></a>                            frag_type <span class="op">=</span> frag.get(<span class="st">'type'</span>, <span class="st">''</span>).upper()</span>
<span id="cb24-1649"><a href="#cb24-1649" aria-hidden="true" tabindex="-1"></a>                            <span class="cf">if</span> frag_type <span class="kw">in</span> (<span class="st">'REQUEST'</span>, <span class="st">'RESPONSE'</span>):</span>
<span id="cb24-1650"><a href="#cb24-1650" aria-hidden="true" tabindex="-1"></a>                                msg_type <span class="op">=</span> frag_type</span>
<span id="cb24-1651"><a href="#cb24-1651" aria-hidden="true" tabindex="-1"></a>                            text <span class="op">=</span> frag.get(<span class="st">'text'</span>, <span class="st">''</span>)</span>
<span id="cb24-1652"><a href="#cb24-1652" aria-hidden="true" tabindex="-1"></a>                            <span class="cf">if</span> text:</span>
<span id="cb24-1653"><a href="#cb24-1653" aria-hidden="true" tabindex="-1"></a>                                content_parts.append(text)</span>
<span id="cb24-1654"><a href="#cb24-1654" aria-hidden="true" tabindex="-1"></a>                            content <span class="op">=</span> frag.get(<span class="st">'content'</span>, <span class="st">''</span>)</span>
<span id="cb24-1655"><a href="#cb24-1655" aria-hidden="true" tabindex="-1"></a>                            <span class="cf">if</span> content:</span>
<span id="cb24-1656"><a href="#cb24-1656" aria-hidden="true" tabindex="-1"></a>                                <span class="cf">if</span> <span class="bu">isinstance</span>(content, <span class="bu">list</span>):</span>
<span id="cb24-1657"><a href="#cb24-1657" aria-hidden="true" tabindex="-1"></a>                                    <span class="cf">for</span> item <span class="kw">in</span> content:</span>
<span id="cb24-1658"><a href="#cb24-1658" aria-hidden="true" tabindex="-1"></a>                                        <span class="cf">if</span> <span class="bu">isinstance</span>(item, <span class="bu">str</span>):</span>
<span id="cb24-1659"><a href="#cb24-1659" aria-hidden="true" tabindex="-1"></a>                                            content_parts.append(item)</span>
<span id="cb24-1660"><a href="#cb24-1660" aria-hidden="true" tabindex="-1"></a>                                        <span class="cf">elif</span> <span class="bu">isinstance</span>(item, <span class="bu">dict</span>):</span>
<span id="cb24-1661"><a href="#cb24-1661" aria-hidden="true" tabindex="-1"></a>                                            item_text <span class="op">=</span> item.get(<span class="st">'text'</span>, <span class="st">''</span>)</span>
<span id="cb24-1662"><a href="#cb24-1662" aria-hidden="true" tabindex="-1"></a>                                            <span class="cf">if</span> item_text:</span>
<span id="cb24-1663"><a href="#cb24-1663" aria-hidden="true" tabindex="-1"></a>                                                content_parts.append(<span class="bu">str</span>(item_text))</span>
<span id="cb24-1664"><a href="#cb24-1664" aria-hidden="true" tabindex="-1"></a>                                <span class="cf">else</span>:</span>
<span id="cb24-1665"><a href="#cb24-1665" aria-hidden="true" tabindex="-1"></a>                                    content_parts.append(<span class="bu">str</span>(content))</span>
<span id="cb24-1666"><a href="#cb24-1666" aria-hidden="true" tabindex="-1"></a>                                    </span>
<span id="cb24-1667"><a href="#cb24-1667" aria-hidden="true" tabindex="-1"></a>                    content <span class="op">=</span> <span class="st">' '</span>.join(content_parts).strip()</span>
<span id="cb24-1668"><a href="#cb24-1668" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb24-1669"><a href="#cb24-1669" aria-hidden="true" tabindex="-1"></a>                    content <span class="op">=</span> <span class="va">self</span>.preserve_special_content(content)</span>
<span id="cb24-1670"><a href="#cb24-1670" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb24-1671"><a href="#cb24-1671" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="kw">not</span> content:</span>
<span id="cb24-1672"><a href="#cb24-1672" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb24-1673"><a href="#cb24-1673" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb24-1674"><a href="#cb24-1674" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> msg_type <span class="op">==</span> <span class="st">'REQUEST'</span>:</span>
<span id="cb24-1675"><a href="#cb24-1675" aria-hidden="true" tabindex="-1"></a>                        author <span class="op">=</span> <span class="st">"üë§ Utilizador"</span></span>
<span id="cb24-1676"><a href="#cb24-1676" aria-hidden="true" tabindex="-1"></a>                        role <span class="op">=</span> <span class="st">'user'</span></span>
<span id="cb24-1677"><a href="#cb24-1677" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">else</span>:</span>
<span id="cb24-1678"><a href="#cb24-1678" aria-hidden="true" tabindex="-1"></a>                        author <span class="op">=</span> <span class="st">"ü§ñ DeepSeek"</span></span>
<span id="cb24-1679"><a href="#cb24-1679" aria-hidden="true" tabindex="-1"></a>                        role <span class="op">=</span> <span class="st">'assistant'</span></span>
<span id="cb24-1680"><a href="#cb24-1680" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb24-1681"><a href="#cb24-1681" aria-hidden="true" tabindex="-1"></a>                    messages.append({</span>
<span id="cb24-1682"><a href="#cb24-1682" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'author'</span>: author,</span>
<span id="cb24-1683"><a href="#cb24-1683" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'role'</span>: role,</span>
<span id="cb24-1684"><a href="#cb24-1684" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'content'</span>: content,</span>
<span id="cb24-1685"><a href="#cb24-1685" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'timestamp'</span>: <span class="va">self</span>.format_timestamp(msg_data.get(<span class="st">'inserted_at'</span>)),</span>
<span id="cb24-1686"><a href="#cb24-1686" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'model'</span>: msg_data.get(<span class="st">'model'</span>, <span class="st">'DeepSeek'</span>)</span>
<span id="cb24-1687"><a href="#cb24-1687" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb24-1688"><a href="#cb24-1688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-1689"><a href="#cb24-1689" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> messages:</span>
<span id="cb24-1690"><a href="#cb24-1690" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.all_conversations.append({</span>
<span id="cb24-1691"><a href="#cb24-1691" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'title'</span>: clean_title,  <span class="co"># T√≠tulo ORIGINAL com espa√ßos</span></span>
<span id="cb24-1692"><a href="#cb24-1692" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'source'</span>: <span class="st">'DeepSeek'</span>,</span>
<span id="cb24-1693"><a href="#cb24-1693" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'id'</span>: conv.get(<span class="st">'id'</span>, <span class="ss">f'deepseek_</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">'</span>),</span>
<span id="cb24-1694"><a href="#cb24-1694" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'inserted_at'</span>: <span class="va">self</span>.format_timestamp(conv.get(<span class="st">'inserted_at'</span>)),</span>
<span id="cb24-1695"><a href="#cb24-1695" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'updated_at'</span>: <span class="va">self</span>.format_timestamp(conv.get(<span class="st">'updated_at'</span>)),</span>
<span id="cb24-1696"><a href="#cb24-1696" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'messages'</span>: messages,</span>
<span id="cb24-1697"><a href="#cb24-1697" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'summary'</span>: messages[<span class="dv">0</span>][<span class="st">'content'</span>][:<span class="dv">100</span>] <span class="op">+</span> <span class="st">"..."</span> <span class="cf">if</span> messages <span class="cf">else</span> <span class="st">"Sem conte√∫do"</span>,</span>
<span id="cb24-1698"><a href="#cb24-1698" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'category'</span>: <span class="st">'Geral'</span></span>
<span id="cb24-1699"><a href="#cb24-1699" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb24-1700"><a href="#cb24-1700" aria-hidden="true" tabindex="-1"></a>                    processed_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb24-1701"><a href="#cb24-1701" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb24-1702"><a href="#cb24-1702" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="ss">f"‚úÖ DeepSeek: </span><span class="sc">{</span>processed_count<span class="sc">}</span><span class="ss"> conversas processadas."</span>)</span>
<span id="cb24-1703"><a href="#cb24-1703" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-1704"><a href="#cb24-1704" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb24-1705"><a href="#cb24-1705" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.error(<span class="ss">f"‚ùå Erro ao processar DeepSeek: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb24-1706"><a href="#cb24-1706" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb24-1707"><a href="#cb24-1707" aria-hidden="true" tabindex="-1"></a>                traceback.print_exc()</span>
<span id="cb24-1708"><a href="#cb24-1708" aria-hidden="true" tabindex="-1"></a>        <span class="cf">finally</span>:</span>
<span id="cb24-1709"><a href="#cb24-1709" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="st">'temp_dir'</span> <span class="kw">in</span> <span class="bu">locals</span>():</span>
<span id="cb24-1710"><a href="#cb24-1710" aria-hidden="true" tabindex="-1"></a>                shutil.rmtree(temp_dir, ignore_errors<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb24-1711"><a href="#cb24-1711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-1712"><a href="#cb24-1712" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> process_grok(<span class="va">self</span>, path: Path):</span>
<span id="cb24-1713"><a href="#cb24-1713" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Processa exporta√ß√£o do Grok"""</span></span>
<span id="cb24-1714"><a href="#cb24-1714" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb24-1715"><a href="#cb24-1715" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="ss">f"üîÆ [DRY-RUN] Processaria Grok: </span><span class="sc">{</span>path<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb24-1716"><a href="#cb24-1716" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb24-1717"><a href="#cb24-1717" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-1718"><a href="#cb24-1718" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb24-1719"><a href="#cb24-1719" aria-hidden="true" tabindex="-1"></a>            temp_dir <span class="op">=</span> tempfile.mkdtemp(prefix<span class="op">=</span><span class="st">"grok_"</span>)</span>
<span id="cb24-1720"><a href="#cb24-1720" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> zipfile.ZipFile(path, <span class="st">'r'</span>) <span class="im">as</span> z:</span>
<span id="cb24-1721"><a href="#cb24-1721" aria-hidden="true" tabindex="-1"></a>                z.extractall(temp_dir)</span>
<span id="cb24-1722"><a href="#cb24-1722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-1723"><a href="#cb24-1723" aria-hidden="true" tabindex="-1"></a>            target_file <span class="op">=</span> <span class="va">None</span></span>
<span id="cb24-1724"><a href="#cb24-1724" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> root, _, files <span class="kw">in</span> os.walk(temp_dir):</span>
<span id="cb24-1725"><a href="#cb24-1725" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> <span class="bu">file</span> <span class="kw">in</span> files:</span>
<span id="cb24-1726"><a href="#cb24-1726" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="bu">file</span> <span class="op">==</span> <span class="st">"prod-grok-backend.json"</span>:</span>
<span id="cb24-1727"><a href="#cb24-1727" aria-hidden="true" tabindex="-1"></a>                        target_file <span class="op">=</span> Path(root) <span class="op">/</span> <span class="bu">file</span></span>
<span id="cb24-1728"><a href="#cb24-1728" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">break</span></span>
<span id="cb24-1729"><a href="#cb24-1729" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> target_file:</span>
<span id="cb24-1730"><a href="#cb24-1730" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">break</span></span>
<span id="cb24-1731"><a href="#cb24-1731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-1732"><a href="#cb24-1732" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> target_file:</span>
<span id="cb24-1733"><a href="#cb24-1733" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.error(<span class="st">"‚ùå Grok: ficheiro 'prod-grok-backend.json' n√£o encontrado no ZIP."</span>)</span>
<span id="cb24-1734"><a href="#cb24-1734" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span></span>
<span id="cb24-1735"><a href="#cb24-1735" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-1736"><a href="#cb24-1736" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="ss">f"üîç Grok: carregando </span><span class="sc">{</span>target_file<span class="sc">.</span>name<span class="sc">}</span><span class="ss">..."</span>)</span>
<span id="cb24-1737"><a href="#cb24-1737" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(target_file, <span class="st">'r'</span>, encoding<span class="op">=</span><span class="st">'utf-8'</span>) <span class="im">as</span> f:</span>
<span id="cb24-1738"><a href="#cb24-1738" aria-hidden="true" tabindex="-1"></a>                data <span class="op">=</span> json.load(f)</span>
<span id="cb24-1739"><a href="#cb24-1739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-1740"><a href="#cb24-1740" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(data, <span class="bu">dict</span>) <span class="kw">or</span> <span class="st">'conversations'</span> <span class="kw">not</span> <span class="kw">in</span> data:</span>
<span id="cb24-1741"><a href="#cb24-1741" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.error(<span class="st">"‚ùå Grok: estrutura inesperada ‚Äî chave 'conversations' n√£o encontrada."</span>)</span>
<span id="cb24-1742"><a href="#cb24-1742" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span></span>
<span id="cb24-1743"><a href="#cb24-1743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-1744"><a href="#cb24-1744" aria-hidden="true" tabindex="-1"></a>            conversations_list <span class="op">=</span> data[<span class="st">'conversations'</span>]</span>
<span id="cb24-1745"><a href="#cb24-1745" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(conversations_list, <span class="bu">list</span>):</span>
<span id="cb24-1746"><a href="#cb24-1746" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.error(<span class="st">"‚ùå Grok: 'conversations' n√£o √© uma lista."</span>)</span>
<span id="cb24-1747"><a href="#cb24-1747" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span></span>
<span id="cb24-1748"><a href="#cb24-1748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-1749"><a href="#cb24-1749" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="ss">f"üìä Grok: encontradas </span><span class="sc">{</span><span class="bu">len</span>(conversations_list)<span class="sc">}</span><span class="ss"> conversas."</span>)</span>
<span id="cb24-1750"><a href="#cb24-1750" aria-hidden="true" tabindex="-1"></a>            total_convs <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb24-1751"><a href="#cb24-1751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-1752"><a href="#cb24-1752" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> item <span class="kw">in</span> conversations_list:</span>
<span id="cb24-1753"><a href="#cb24-1753" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(item, <span class="bu">dict</span>):</span>
<span id="cb24-1754"><a href="#cb24-1754" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">continue</span></span>
<span id="cb24-1755"><a href="#cb24-1755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-1756"><a href="#cb24-1756" aria-hidden="true" tabindex="-1"></a>                conv_meta <span class="op">=</span> item.get(<span class="st">'conversation'</span>)</span>
<span id="cb24-1757"><a href="#cb24-1757" aria-hidden="true" tabindex="-1"></a>                responses <span class="op">=</span> item.get(<span class="st">'responses'</span>, [])</span>
<span id="cb24-1758"><a href="#cb24-1758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-1759"><a href="#cb24-1759" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(conv_meta, <span class="bu">dict</span>) <span class="kw">or</span> <span class="kw">not</span> <span class="bu">isinstance</span>(responses, <span class="bu">list</span>) <span class="kw">or</span> <span class="kw">not</span> responses:</span>
<span id="cb24-1760"><a href="#cb24-1760" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">continue</span></span>
<span id="cb24-1761"><a href="#cb24-1761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-1762"><a href="#cb24-1762" aria-hidden="true" tabindex="-1"></a>                conv_id <span class="op">=</span> conv_meta.get(<span class="st">'id'</span>)</span>
<span id="cb24-1763"><a href="#cb24-1763" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="kw">not</span> conv_id:</span>
<span id="cb24-1764"><a href="#cb24-1764" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">continue</span></span>
<span id="cb24-1765"><a href="#cb24-1765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-1766"><a href="#cb24-1766" aria-hidden="true" tabindex="-1"></a>                original_title <span class="op">=</span> conv_meta.get(<span class="st">'title'</span>, <span class="ss">f"Conversa Grok </span><span class="sc">{</span>total_convs <span class="op">+</span> <span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb24-1767"><a href="#cb24-1767" aria-hidden="true" tabindex="-1"></a>                <span class="co"># PRESERVA t√≠tulo original com espa√ßos</span></span>
<span id="cb24-1768"><a href="#cb24-1768" aria-hidden="true" tabindex="-1"></a>                clean_title <span class="op">=</span> <span class="va">self</span>.preserve_original_title(original_title)</span>
<span id="cb24-1769"><a href="#cb24-1769" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb24-1770"><a href="#cb24-1770" aria-hidden="true" tabindex="-1"></a>                create_time_str <span class="op">=</span> conv_meta.get(<span class="st">'create_time'</span>)</span>
<span id="cb24-1771"><a href="#cb24-1771" aria-hidden="true" tabindex="-1"></a>                modify_time_str <span class="op">=</span> conv_meta.get(<span class="st">'modify_time'</span>)</span>
<span id="cb24-1772"><a href="#cb24-1772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-1773"><a href="#cb24-1773" aria-hidden="true" tabindex="-1"></a>                <span class="kw">def</span> format_iso_timestamp(ts_str):</span>
<span id="cb24-1774"><a href="#cb24-1774" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="kw">not</span> ts_str:</span>
<span id="cb24-1775"><a href="#cb24-1775" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb24-1776"><a href="#cb24-1776" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">try</span>:</span>
<span id="cb24-1777"><a href="#cb24-1777" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">if</span> <span class="st">'.'</span> <span class="kw">in</span> ts_str:</span>
<span id="cb24-1778"><a href="#cb24-1778" aria-hidden="true" tabindex="-1"></a>                            ts_str <span class="op">=</span> ts_str.split(<span class="st">'.'</span>)[<span class="dv">0</span>] <span class="op">+</span> <span class="st">'Z'</span></span>
<span id="cb24-1779"><a href="#cb24-1779" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">return</span> <span class="va">self</span>.format_timestamp(ts_str)</span>
<span id="cb24-1780"><a href="#cb24-1780" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">except</span>:</span>
<span id="cb24-1781"><a href="#cb24-1781" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">return</span> <span class="bu">str</span>(ts_str)</span>
<span id="cb24-1782"><a href="#cb24-1782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-1783"><a href="#cb24-1783" aria-hidden="true" tabindex="-1"></a>                inserted_at <span class="op">=</span> format_iso_timestamp(create_time_str)</span>
<span id="cb24-1784"><a href="#cb24-1784" aria-hidden="true" tabindex="-1"></a>                updated_at <span class="op">=</span> format_iso_timestamp(modify_time_str)</span>
<span id="cb24-1785"><a href="#cb24-1785" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-1786"><a href="#cb24-1786" aria-hidden="true" tabindex="-1"></a>                messages <span class="op">=</span> []</span>
<span id="cb24-1787"><a href="#cb24-1787" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> resp <span class="kw">in</span> responses:</span>
<span id="cb24-1788"><a href="#cb24-1788" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(resp, <span class="bu">dict</span>):</span>
<span id="cb24-1789"><a href="#cb24-1789" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb24-1790"><a href="#cb24-1790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-1791"><a href="#cb24-1791" aria-hidden="true" tabindex="-1"></a>                    resp_data <span class="op">=</span> resp.get(<span class="st">'response'</span>)</span>
<span id="cb24-1792"><a href="#cb24-1792" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(resp_data, <span class="bu">dict</span>):</span>
<span id="cb24-1793"><a href="#cb24-1793" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb24-1794"><a href="#cb24-1794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-1795"><a href="#cb24-1795" aria-hidden="true" tabindex="-1"></a>                    sender <span class="op">=</span> resp_data.get(<span class="st">'sender'</span>, <span class="st">''</span>).upper()</span>
<span id="cb24-1796"><a href="#cb24-1796" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> sender <span class="op">==</span> <span class="st">'HUMAN'</span>:</span>
<span id="cb24-1797"><a href="#cb24-1797" aria-hidden="true" tabindex="-1"></a>                        author <span class="op">=</span> <span class="st">"üë§ Utilizador"</span></span>
<span id="cb24-1798"><a href="#cb24-1798" aria-hidden="true" tabindex="-1"></a>                        role <span class="op">=</span> <span class="st">"user"</span></span>
<span id="cb24-1799"><a href="#cb24-1799" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">elif</span> sender <span class="op">==</span> <span class="st">'ASSISTANT'</span>:</span>
<span id="cb24-1800"><a href="#cb24-1800" aria-hidden="true" tabindex="-1"></a>                        author <span class="op">=</span> <span class="st">"ü§ñ Grok"</span></span>
<span id="cb24-1801"><a href="#cb24-1801" aria-hidden="true" tabindex="-1"></a>                        role <span class="op">=</span> <span class="st">"assistant"</span></span>
<span id="cb24-1802"><a href="#cb24-1802" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">else</span>:</span>
<span id="cb24-1803"><a href="#cb24-1803" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb24-1804"><a href="#cb24-1804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-1805"><a href="#cb24-1805" aria-hidden="true" tabindex="-1"></a>                    content <span class="op">=</span> <span class="bu">str</span>(resp_data.get(<span class="st">'message'</span>, <span class="st">''</span>)).strip()</span>
<span id="cb24-1806"><a href="#cb24-1806" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb24-1807"><a href="#cb24-1807" aria-hidden="true" tabindex="-1"></a>                    content <span class="op">=</span> <span class="va">self</span>.preserve_special_content(content)</span>
<span id="cb24-1808"><a href="#cb24-1808" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb24-1809"><a href="#cb24-1809" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="kw">not</span> content:</span>
<span id="cb24-1810"><a href="#cb24-1810" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb24-1811"><a href="#cb24-1811" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-1812"><a href="#cb24-1812" aria-hidden="true" tabindex="-1"></a>                    create_time <span class="op">=</span> resp_data.get(<span class="st">'create_time'</span>)</span>
<span id="cb24-1813"><a href="#cb24-1813" aria-hidden="true" tabindex="-1"></a>                    timestamp_ms <span class="op">=</span> <span class="va">None</span></span>
<span id="cb24-1814"><a href="#cb24-1814" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="bu">isinstance</span>(create_time, <span class="bu">dict</span>) <span class="kw">and</span> <span class="st">'$date'</span> <span class="kw">in</span> create_time:</span>
<span id="cb24-1815"><a href="#cb24-1815" aria-hidden="true" tabindex="-1"></a>                        date_obj <span class="op">=</span> create_time[<span class="st">'$date'</span>]</span>
<span id="cb24-1816"><a href="#cb24-1816" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">if</span> <span class="bu">isinstance</span>(date_obj, <span class="bu">dict</span>) <span class="kw">and</span> <span class="st">'$numberLong'</span> <span class="kw">in</span> date_obj:</span>
<span id="cb24-1817"><a href="#cb24-1817" aria-hidden="true" tabindex="-1"></a>                            <span class="cf">try</span>:</span>
<span id="cb24-1818"><a href="#cb24-1818" aria-hidden="true" tabindex="-1"></a>                                timestamp_ms <span class="op">=</span> <span class="bu">int</span>(date_obj[<span class="st">'$numberLong'</span>])</span>
<span id="cb24-1819"><a href="#cb24-1819" aria-hidden="true" tabindex="-1"></a>                            <span class="cf">except</span>:</span>
<span id="cb24-1820"><a href="#cb24-1820" aria-hidden="true" tabindex="-1"></a>                                <span class="cf">pass</span></span>
<span id="cb24-1821"><a href="#cb24-1821" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-1822"><a href="#cb24-1822" aria-hidden="true" tabindex="-1"></a>                    messages.append({</span>
<span id="cb24-1823"><a href="#cb24-1823" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'author'</span>: author,</span>
<span id="cb24-1824"><a href="#cb24-1824" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'role'</span>: role,</span>
<span id="cb24-1825"><a href="#cb24-1825" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'content'</span>: content,</span>
<span id="cb24-1826"><a href="#cb24-1826" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'timestamp'</span>: <span class="va">self</span>.format_timestamp(timestamp_ms <span class="op">/</span> <span class="fl">1000.0</span> <span class="cf">if</span> timestamp_ms <span class="cf">else</span> <span class="va">None</span>),</span>
<span id="cb24-1827"><a href="#cb24-1827" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'model'</span>: <span class="st">'Grok'</span></span>
<span id="cb24-1828"><a href="#cb24-1828" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb24-1829"><a href="#cb24-1829" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-1830"><a href="#cb24-1830" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> messages:</span>
<span id="cb24-1831"><a href="#cb24-1831" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.all_conversations.append({</span>
<span id="cb24-1832"><a href="#cb24-1832" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'title'</span>: clean_title,  <span class="co"># T√≠tulo ORIGINAL com espa√ßos</span></span>
<span id="cb24-1833"><a href="#cb24-1833" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'source'</span>: <span class="st">'Grok'</span>,</span>
<span id="cb24-1834"><a href="#cb24-1834" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'id'</span>: conv_id,</span>
<span id="cb24-1835"><a href="#cb24-1835" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'inserted_at'</span>: inserted_at,</span>
<span id="cb24-1836"><a href="#cb24-1836" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'updated_at'</span>: updated_at,</span>
<span id="cb24-1837"><a href="#cb24-1837" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'messages'</span>: messages,</span>
<span id="cb24-1838"><a href="#cb24-1838" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'summary'</span>: messages[<span class="dv">0</span>][<span class="st">'content'</span>][:<span class="dv">100</span>] <span class="op">+</span> <span class="st">"..."</span> <span class="cf">if</span> messages <span class="cf">else</span> <span class="st">"Sem conte√∫do"</span>,</span>
<span id="cb24-1839"><a href="#cb24-1839" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'category'</span>: <span class="st">'Geral'</span></span>
<span id="cb24-1840"><a href="#cb24-1840" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb24-1841"><a href="#cb24-1841" aria-hidden="true" tabindex="-1"></a>                    total_convs <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb24-1842"><a href="#cb24-1842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-1843"><a href="#cb24-1843" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> total_convs <span class="op">></span> <span class="dv">0</span>:</span>
<span id="cb24-1844"><a href="#cb24-1844" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.info(<span class="ss">f"‚úÖ Grok: processadas </span><span class="sc">{</span>total_convs<span class="sc">}</span><span class="ss"> conversas."</span>)</span>
<span id="cb24-1845"><a href="#cb24-1845" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb24-1846"><a href="#cb24-1846" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.error(<span class="st">"‚ùå Grok: nenhuma conversa v√°lida encontrada."</span>)</span>
<span id="cb24-1847"><a href="#cb24-1847" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-1848"><a href="#cb24-1848" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb24-1849"><a href="#cb24-1849" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.error(<span class="ss">f"‚ùå Erro ao processar Grok: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb24-1850"><a href="#cb24-1850" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb24-1851"><a href="#cb24-1851" aria-hidden="true" tabindex="-1"></a>                traceback.print_exc()</span>
<span id="cb24-1852"><a href="#cb24-1852" aria-hidden="true" tabindex="-1"></a>        <span class="cf">finally</span>:</span>
<span id="cb24-1853"><a href="#cb24-1853" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="st">'temp_dir'</span> <span class="kw">in</span> <span class="bu">locals</span>():</span>
<span id="cb24-1854"><a href="#cb24-1854" aria-hidden="true" tabindex="-1"></a>                shutil.rmtree(temp_dir, ignore_errors<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb24-1855"><a href="#cb24-1855" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-1856"><a href="#cb24-1856" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> save_as_markdown_enhanced(<span class="va">self</span>):</span>
<span id="cb24-1857"><a href="#cb24-1857" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Salva conversas com preserva√ß√£o total de formata√ß√£o"""</span></span>
<span id="cb24-1858"><a href="#cb24-1858" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb24-1859"><a href="#cb24-1859" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="st">"üîÆ [DRY-RUN] Markdowns seriam criados:"</span>)</span>
<span id="cb24-1860"><a href="#cb24-1860" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> conv <span class="kw">in</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb24-1861"><a href="#cb24-1861" aria-hidden="true" tabindex="-1"></a>                safe_title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(conv[<span class="st">'title'</span>])</span>
<span id="cb24-1862"><a href="#cb24-1862" aria-hidden="true" tabindex="-1"></a>                filename <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>conv[<span class="st">'number'</span>]<span class="sc">:03d}</span><span class="ss">_</span><span class="sc">{</span>conv[<span class="st">'source'</span>]<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>safe_title<span class="sc">}</span><span class="ss">.md"</span></span>
<span id="cb24-1863"><a href="#cb24-1863" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.info(<span class="ss">f"   üìÑ </span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb24-1864"><a href="#cb24-1864" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb24-1865"><a href="#cb24-1865" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-1866"><a href="#cb24-1866" aria-hidden="true" tabindex="-1"></a>        folder <span class="op">=</span> Path(<span class="va">self</span>.output_dirs[<span class="st">'markdown'</span>])</span>
<span id="cb24-1867"><a href="#cb24-1867" aria-hidden="true" tabindex="-1"></a>        saved_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb24-1868"><a href="#cb24-1868" aria-hidden="true" tabindex="-1"></a>        failed_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb24-1869"><a href="#cb24-1869" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-1870"><a href="#cb24-1870" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> conv <span class="kw">in</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb24-1871"><a href="#cb24-1871" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb24-1872"><a href="#cb24-1872" aria-hidden="true" tabindex="-1"></a>                safe_title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(conv[<span class="st">'title'</span>])</span>
<span id="cb24-1873"><a href="#cb24-1873" aria-hidden="true" tabindex="-1"></a>                filename <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>conv[<span class="st">'number'</span>]<span class="sc">:03d}</span><span class="ss">_</span><span class="sc">{</span>conv[<span class="st">'source'</span>]<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>safe_title<span class="sc">}</span><span class="ss">.md"</span></span>
<span id="cb24-1874"><a href="#cb24-1874" aria-hidden="true" tabindex="-1"></a>                filepath <span class="op">=</span> folder <span class="op">/</span> filename</span>
<span id="cb24-1875"><a href="#cb24-1875" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb24-1876"><a href="#cb24-1876" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.force_overwrite <span class="kw">and</span> filepath.exists():</span>
<span id="cb24-1877"><a href="#cb24-1877" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">continue</span></span>
<span id="cb24-1878"><a href="#cb24-1878" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb24-1879"><a href="#cb24-1879" aria-hidden="true" tabindex="-1"></a>                markdown_content <span class="op">=</span> <span class="va">self</span>.create_enhanced_markdown_content(conv)</span>
<span id="cb24-1880"><a href="#cb24-1880" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb24-1881"><a href="#cb24-1881" aria-hidden="true" tabindex="-1"></a>                <span class="cf">with</span> <span class="bu">open</span>(filepath, <span class="st">'w'</span>, encoding<span class="op">=</span><span class="st">'utf-8'</span>) <span class="im">as</span> f:</span>
<span id="cb24-1882"><a href="#cb24-1882" aria-hidden="true" tabindex="-1"></a>                    f.write(markdown_content)</span>
<span id="cb24-1883"><a href="#cb24-1883" aria-hidden="true" tabindex="-1"></a>                saved_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb24-1884"><a href="#cb24-1884" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb24-1885"><a href="#cb24-1885" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb24-1886"><a href="#cb24-1886" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.error(<span class="ss">f"‚ùå Erro ao salvar conversa </span><span class="sc">{</span>conv[<span class="st">'number'</span>]<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb24-1887"><a href="#cb24-1887" aria-hidden="true" tabindex="-1"></a>                failed_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb24-1888"><a href="#cb24-1888" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span></span>
<span id="cb24-1889"><a href="#cb24-1889" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb24-1890"><a href="#cb24-1890" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.logger.info(<span class="ss">f"‚úÖ Markdown: </span><span class="sc">{</span>saved_count<span class="sc">}</span><span class="ss"> arquivos criados, </span><span class="sc">{</span>failed_count<span class="sc">}</span><span class="ss"> falhas em '</span><span class="sc">{</span>folder<span class="sc">}</span><span class="ss">'"</span>)</span>
<span id="cb24-1891"><a href="#cb24-1891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-1892"><a href="#cb24-1892" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> save_as_csv(<span class="va">self</span>):</span>
<span id="cb24-1893"><a href="#cb24-1893" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Salva conversas em arquivos CSV individuais"""</span></span>
<span id="cb24-1894"><a href="#cb24-1894" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb24-1895"><a href="#cb24-1895" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="st">"üîÆ [DRY-RUN] CSVs seriam criados:"</span>)</span>
<span id="cb24-1896"><a href="#cb24-1896" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> conv <span class="kw">in</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb24-1897"><a href="#cb24-1897" aria-hidden="true" tabindex="-1"></a>                safe_title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(conv[<span class="st">'title'</span>])</span>
<span id="cb24-1898"><a href="#cb24-1898" aria-hidden="true" tabindex="-1"></a>                filename <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>conv[<span class="st">'number'</span>]<span class="sc">:03d}</span><span class="ss">_</span><span class="sc">{</span>conv[<span class="st">'source'</span>]<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>safe_title<span class="sc">}</span><span class="ss">.csv"</span></span>
<span id="cb24-1899"><a href="#cb24-1899" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.info(<span class="ss">f"   üìä </span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb24-1900"><a href="#cb24-1900" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb24-1901"><a href="#cb24-1901" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-1902"><a href="#cb24-1902" aria-hidden="true" tabindex="-1"></a>        folder <span class="op">=</span> Path(<span class="va">self</span>.output_dirs[<span class="st">'csv'</span>])</span>
<span id="cb24-1903"><a href="#cb24-1903" aria-hidden="true" tabindex="-1"></a>        saved_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb24-1904"><a href="#cb24-1904" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-1905"><a href="#cb24-1905" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> conv <span class="kw">in</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb24-1906"><a href="#cb24-1906" aria-hidden="true" tabindex="-1"></a>            safe_title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(conv[<span class="st">'title'</span>])</span>
<span id="cb24-1907"><a href="#cb24-1907" aria-hidden="true" tabindex="-1"></a>            filename <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>conv[<span class="st">'number'</span>]<span class="sc">:03d}</span><span class="ss">_</span><span class="sc">{</span>conv[<span class="st">'source'</span>]<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>safe_title<span class="sc">}</span><span class="ss">.csv"</span></span>
<span id="cb24-1908"><a href="#cb24-1908" aria-hidden="true" tabindex="-1"></a>            filepath <span class="op">=</span> folder <span class="op">/</span> filename</span>
<span id="cb24-1909"><a href="#cb24-1909" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-1910"><a href="#cb24-1910" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.force_overwrite <span class="kw">and</span> filepath.exists():</span>
<span id="cb24-1911"><a href="#cb24-1911" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span></span>
<span id="cb24-1912"><a href="#cb24-1912" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb24-1913"><a href="#cb24-1913" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(filepath, <span class="st">'w'</span>, encoding<span class="op">=</span><span class="st">'utf-8'</span>, newline<span class="op">=</span><span class="st">''</span>) <span class="im">as</span> f:</span>
<span id="cb24-1914"><a href="#cb24-1914" aria-hidden="true" tabindex="-1"></a>                writer <span class="op">=</span> csv.DictWriter(f, fieldnames<span class="op">=</span>[</span>
<span id="cb24-1915"><a href="#cb24-1915" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'node_id'</span>, <span class="st">'author'</span>, <span class="st">'role'</span>, <span class="st">'timestamp'</span>, <span class="st">'model'</span>, <span class="st">'content'</span></span>
<span id="cb24-1916"><a href="#cb24-1916" aria-hidden="true" tabindex="-1"></a>                ])</span>
<span id="cb24-1917"><a href="#cb24-1917" aria-hidden="true" tabindex="-1"></a>                writer.writeheader()</span>
<span id="cb24-1918"><a href="#cb24-1918" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> i, msg <span class="kw">in</span> <span class="bu">enumerate</span>(conv[<span class="st">'messages'</span>]):</span>
<span id="cb24-1919"><a href="#cb24-1919" aria-hidden="true" tabindex="-1"></a>                    writer.writerow({</span>
<span id="cb24-1920"><a href="#cb24-1920" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'node_id'</span>: <span class="bu">str</span>(i),</span>
<span id="cb24-1921"><a href="#cb24-1921" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'author'</span>: msg[<span class="st">'author'</span>],</span>
<span id="cb24-1922"><a href="#cb24-1922" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'role'</span>: msg[<span class="st">'role'</span>],</span>
<span id="cb24-1923"><a href="#cb24-1923" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'timestamp'</span>: msg[<span class="st">'timestamp'</span>],</span>
<span id="cb24-1924"><a href="#cb24-1924" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'model'</span>: msg[<span class="st">'model'</span>],</span>
<span id="cb24-1925"><a href="#cb24-1925" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'content'</span>: msg[<span class="st">'content'</span>]</span>
<span id="cb24-1926"><a href="#cb24-1926" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb24-1927"><a href="#cb24-1927" aria-hidden="true" tabindex="-1"></a>            saved_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb24-1928"><a href="#cb24-1928" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-1929"><a href="#cb24-1929" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.logger.info(<span class="ss">f"‚úÖ CSV: </span><span class="sc">{</span>saved_count<span class="sc">}</span><span class="ss"> arquivos criados em '</span><span class="sc">{</span>folder<span class="sc">}</span><span class="ss">'"</span>)</span>
<span id="cb24-1930"><a href="#cb24-1930" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-1931"><a href="#cb24-1931" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> save_as_json(<span class="va">self</span>):</span>
<span id="cb24-1932"><a href="#cb24-1932" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Salva conversas em arquivos JSON individuais"""</span></span>
<span id="cb24-1933"><a href="#cb24-1933" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb24-1934"><a href="#cb24-1934" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="st">"üîÆ [DRY-RUN] JSONs seriam criados:"</span>)</span>
<span id="cb24-1935"><a href="#cb24-1935" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> conv <span class="kw">in</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb24-1936"><a href="#cb24-1936" aria-hidden="true" tabindex="-1"></a>                safe_title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(conv[<span class="st">'title'</span>])</span>
<span id="cb24-1937"><a href="#cb24-1937" aria-hidden="true" tabindex="-1"></a>                filename <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>conv[<span class="st">'number'</span>]<span class="sc">:03d}</span><span class="ss">_</span><span class="sc">{</span>conv[<span class="st">'source'</span>]<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>safe_title<span class="sc">}</span><span class="ss">.json"</span></span>
<span id="cb24-1938"><a href="#cb24-1938" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.info(<span class="ss">f"   üìã </span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb24-1939"><a href="#cb24-1939" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb24-1940"><a href="#cb24-1940" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-1941"><a href="#cb24-1941" aria-hidden="true" tabindex="-1"></a>        folder <span class="op">=</span> Path(<span class="va">self</span>.output_dirs[<span class="st">'json'</span>])</span>
<span id="cb24-1942"><a href="#cb24-1942" aria-hidden="true" tabindex="-1"></a>        saved_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb24-1943"><a href="#cb24-1943" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-1944"><a href="#cb24-1944" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> conv <span class="kw">in</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb24-1945"><a href="#cb24-1945" aria-hidden="true" tabindex="-1"></a>            safe_title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(conv[<span class="st">'title'</span>])</span>
<span id="cb24-1946"><a href="#cb24-1946" aria-hidden="true" tabindex="-1"></a>            filename <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>conv[<span class="st">'number'</span>]<span class="sc">:03d}</span><span class="ss">_</span><span class="sc">{</span>conv[<span class="st">'source'</span>]<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>safe_title<span class="sc">}</span><span class="ss">.json"</span></span>
<span id="cb24-1947"><a href="#cb24-1947" aria-hidden="true" tabindex="-1"></a>            filepath <span class="op">=</span> folder <span class="op">/</span> filename</span>
<span id="cb24-1948"><a href="#cb24-1948" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-1949"><a href="#cb24-1949" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.force_overwrite <span class="kw">and</span> filepath.exists():</span>
<span id="cb24-1950"><a href="#cb24-1950" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span></span>
<span id="cb24-1951"><a href="#cb24-1951" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb24-1952"><a href="#cb24-1952" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(filepath, <span class="st">'w'</span>, encoding<span class="op">=</span><span class="st">'utf-8'</span>) <span class="im">as</span> f:</span>
<span id="cb24-1953"><a href="#cb24-1953" aria-hidden="true" tabindex="-1"></a>                json.dump(conv, f, ensure_ascii<span class="op">=</span><span class="va">False</span>, indent<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb24-1954"><a href="#cb24-1954" aria-hidden="true" tabindex="-1"></a>            saved_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb24-1955"><a href="#cb24-1955" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-1956"><a href="#cb24-1956" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.logger.info(<span class="ss">f"‚úÖ JSON: </span><span class="sc">{</span>saved_count<span class="sc">}</span><span class="ss"> arquivos criados em '</span><span class="sc">{</span>folder<span class="sc">}</span><span class="ss">'"</span>)</span>
<span id="cb24-1957"><a href="#cb24-1957" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-1958"><a href="#cb24-1958" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> save_all_to_single_files(<span class="va">self</span>):</span>
<span id="cb24-1959"><a href="#cb24-1959" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Salva todas as conversas em arquivos √∫nicos CSV e JSON"""</span></span>
<span id="cb24-1960"><a href="#cb24-1960" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb24-1961"><a href="#cb24-1961" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="st">"üîÆ [DRY-RUN] Arquivos √∫nicos seriam criados:"</span>)</span>
<span id="cb24-1962"><a href="#cb24-1962" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="ss">f"   üìÅ </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>single_files[<span class="st">'csv'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb24-1963"><a href="#cb24-1963" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="ss">f"   üìÅ </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>single_files[<span class="st">'json'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb24-1964"><a href="#cb24-1964" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb24-1965"><a href="#cb24-1965" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-1966"><a href="#cb24-1966" aria-hidden="true" tabindex="-1"></a>        <span class="co"># CSV √∫nico</span></span>
<span id="cb24-1967"><a href="#cb24-1967" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> <span class="bu">open</span>(<span class="va">self</span>.single_files[<span class="st">'csv'</span>], <span class="st">'w'</span>, encoding<span class="op">=</span><span class="st">'utf-8'</span>, newline<span class="op">=</span><span class="st">''</span>) <span class="im">as</span> f:</span>
<span id="cb24-1968"><a href="#cb24-1968" aria-hidden="true" tabindex="-1"></a>            fieldnames <span class="op">=</span> [</span>
<span id="cb24-1969"><a href="#cb24-1969" aria-hidden="true" tabindex="-1"></a>                <span class="st">'conversation_number'</span>, <span class="st">'source'</span>, <span class="st">'conversation_title'</span>, <span class="st">'category'</span>,</span>
<span id="cb24-1970"><a href="#cb24-1970" aria-hidden="true" tabindex="-1"></a>                <span class="st">'author'</span>, <span class="st">'role'</span>, <span class="st">'timestamp'</span>, <span class="st">'model'</span>, <span class="st">'content'</span></span>
<span id="cb24-1971"><a href="#cb24-1971" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb24-1972"><a href="#cb24-1972" aria-hidden="true" tabindex="-1"></a>            writer <span class="op">=</span> csv.DictWriter(f, fieldnames<span class="op">=</span>fieldnames)</span>
<span id="cb24-1973"><a href="#cb24-1973" aria-hidden="true" tabindex="-1"></a>            writer.writeheader()</span>
<span id="cb24-1974"><a href="#cb24-1974" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> conv <span class="kw">in</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb24-1975"><a href="#cb24-1975" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> msg <span class="kw">in</span> conv[<span class="st">'messages'</span>]:</span>
<span id="cb24-1976"><a href="#cb24-1976" aria-hidden="true" tabindex="-1"></a>                    writer.writerow({</span>
<span id="cb24-1977"><a href="#cb24-1977" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'conversation_number'</span>: conv[<span class="st">'number'</span>],</span>
<span id="cb24-1978"><a href="#cb24-1978" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'source'</span>: conv[<span class="st">'source'</span>],</span>
<span id="cb24-1979"><a href="#cb24-1979" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'conversation_title'</span>: conv[<span class="st">'title'</span>],</span>
<span id="cb24-1980"><a href="#cb24-1980" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'category'</span>: conv[<span class="st">'category'</span>],</span>
<span id="cb24-1981"><a href="#cb24-1981" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'author'</span>: msg[<span class="st">'author'</span>],</span>
<span id="cb24-1982"><a href="#cb24-1982" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'role'</span>: msg[<span class="st">'role'</span>],</span>
<span id="cb24-1983"><a href="#cb24-1983" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'timestamp'</span>: msg[<span class="st">'timestamp'</span>],</span>
<span id="cb24-1984"><a href="#cb24-1984" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'model'</span>: msg[<span class="st">'model'</span>],</span>
<span id="cb24-1985"><a href="#cb24-1985" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'content'</span>: msg[<span class="st">'content'</span>]</span>
<span id="cb24-1986"><a href="#cb24-1986" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb24-1987"><a href="#cb24-1987" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.logger.info(<span class="ss">f"‚úÖ CSV √∫nico: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>single_files[<span class="st">'csv'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb24-1988"><a href="#cb24-1988" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-1989"><a href="#cb24-1989" aria-hidden="true" tabindex="-1"></a>        <span class="co"># JSON √∫nico</span></span>
<span id="cb24-1990"><a href="#cb24-1990" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> <span class="bu">open</span>(<span class="va">self</span>.single_files[<span class="st">'json'</span>], <span class="st">'w'</span>, encoding<span class="op">=</span><span class="st">'utf-8'</span>) <span class="im">as</span> f:</span>
<span id="cb24-1991"><a href="#cb24-1991" aria-hidden="true" tabindex="-1"></a>            json.dump(<span class="va">self</span>.all_conversations, f, ensure_ascii<span class="op">=</span><span class="va">False</span>, indent<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb24-1992"><a href="#cb24-1992" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.logger.info(<span class="ss">f"‚úÖ JSON √∫nico: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>single_files[<span class="st">'json'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb24-1993"><a href="#cb24-1993" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-1994"><a href="#cb24-1994" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_searchable_index(<span class="va">self</span>):</span>
<span id="cb24-1995"><a href="#cb24-1995" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Cria √≠ndice HTML pesquis√°vel com links para HTML"""</span></span>
<span id="cb24-1996"><a href="#cb24-1996" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb24-1997"><a href="#cb24-1997" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="ss">f"üîÆ [DRY-RUN] √çndice HTML seria criado: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>index_file<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb24-1998"><a href="#cb24-1998" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb24-1999"><a href="#cb24-1999" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-2000"><a href="#cb24-2000" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.logger.info(<span class="st">"üéØ Criando √≠ndice HTML combinado..."</span>)</span>
<span id="cb24-2001"><a href="#cb24-2001" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-2002"><a href="#cb24-2002" aria-hidden="true" tabindex="-1"></a>        category_stats <span class="op">=</span> {}</span>
<span id="cb24-2003"><a href="#cb24-2003" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> conv <span class="kw">in</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb24-2004"><a href="#cb24-2004" aria-hidden="true" tabindex="-1"></a>            cat <span class="op">=</span> conv[<span class="st">'category'</span>]</span>
<span id="cb24-2005"><a href="#cb24-2005" aria-hidden="true" tabindex="-1"></a>            category_stats[cat] <span class="op">=</span> category_stats.get(cat, <span class="dv">0</span>) <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb24-2006"><a href="#cb24-2006" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-2007"><a href="#cb24-2007" aria-hidden="true" tabindex="-1"></a>        html_content <span class="op">=</span> <span class="ss">f"""<!DOCTYPE html></span></span>
<span id="cb24-2008"><a href="#cb24-2008" aria-hidden="true" tabindex="-1"></a><span class="ss"><html lang="pt-PT"></span></span>
<span id="cb24-2009"><a href="#cb24-2009" aria-hidden="true" tabindex="-1"></a><span class="ss"><head>

        <style id="fixed-toc-styles">
        /* === ESTILOS PRINCIPAIS - TOC FIXO √Ä DIREITA === */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
            scroll-behavior: smooth;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            position: relative;
        }
        /* === TOC FIXO √Ä DIREITA - POSI√á√ÉO CORRIGIDA === */
        #TOC {
            position: fixed !important;
            top: 50% !important;
            right: 20px !important;
            transform: translateY(-50%) !important;
            width: 320px !important;
            max-height: 80vh !important;
            overflow-y: auto !important;
            z-index: 1000 !important;
            background: rgba(255, 255, 255, 0.98) !important;
            padding: 20px !important;
            border-radius: 12px !important;
            box-shadow: 0 8px 32px rgba(0,0,0,0.15) !important;
            border: 1px solid #e0e0e0 !important;
            backdrop-filter: blur(10px) !important;
            transition: all 0.3s ease-in-out !important;
        }
        #TOC.toc-minimized {
            transform: translateY(-50%) translateX(calc(320px - 50px)) !important;
            opacity: 0.3;
            width: 50px !important;
            overflow: hidden;
        }
        #TOC.toc-minimized > *:not(.toc-toggle-btn) {
            display: none !important;
        }
        #TOC h2 {
            margin-top: 0;
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
            font-size: 1.2em;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .toc-toggle-btn {
            background: none;
            border: none;
            font-size: 1.2em;
            cursor: pointer;
            padding: 5px;
            border-radius: 4px;
            transition: background-color 0.2s;
        }
        .toc-toggle-btn:hover {
            background-color: rgba(0,0,0,0.1);
        }
        #TOC ul {
            list-style-type: none;
            padding-left: 15px;
            margin: 10px 0;
        }
        #TOC ul ul {
            padding-left: 20px;
        }
        #TOC li {
            margin: 8px 0;
            line-height: 1.4;
        }
        #TOC a {
            text-decoration: none;
            color: #495057;
            font-weight: 500;
            transition: all 0.2s ease;
            display: block;
            padding: 6px 10px;
            border-radius: 6px;
            border-left: 3px solid transparent;
        }
        #TOC a:hover {
            color: #007bff;
            background-color: rgba(0, 123, 255, 0.1);
            border-left-color: #007bff;
        }
        #TOC a.active {
            background-color: #007bff !important;
            color: white !important;
            font-weight: bold;
            border-left-color: #0056b3;
        }
        /* Conte√∫do principal com margem para o TOC */
        .main-content {
            margin-right: calc(320px + 40px) !important;
        }
        /* Barra de scroll personalizada APENAS para TOC */
        #TOC::-webkit-scrollbar {
            width: 8px;
        }
        #TOC::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }
        #TOC::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 4px;
        }
        #TOC::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }
        /* === BOT√ÉO VOLTAR AO TOPO (HTMLs individuais) === */
        .back-to-top-content {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            font-size: 18px;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 999;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .back-to-top-content.show {
            opacity: 1;
            transform: translateY(0);
        }
        .back-to-top-content:hover {
            background: #0056b3;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0,0,0,0.2);
        }
        /* === RESPONSIVIDADE === */
        @media (max-width: 1400px) {
            .container {
                max-width: 95%;
                padding: 30px;
            }
            #TOC {
                width: 280px !important;
            }
            .main-content {
                margin-right: 320px !important;
            }
        }
        @media (max-width: 1200px) {
            #TOC {
                width: 260px !important;
                right: 15px !important;
            }
            .main-content {
                margin-right: 300px !important;
            }
        }
        @media (max-width: 992px) {
            #TOC {
                position: relative !important;
                width: 100% !important;
                right: 0 !important;
                top: 0 !important;
                transform: none !important;
                margin: 20px 0;
                max-height: 300px !important;
            }
            .main-content {
                margin-right: 0 !important;
            }
            .back-to-top-content {
                right: 20px;
                bottom: 20px;
            }
        }
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            .container {
                padding: 20px;
                max-width: 100%;
            }
            #TOC {
                max-height: 250px !important;
                padding: 15px !important;
            }
        }
        </style>
        </span></span>
<span id="cb24-2010"><a href="#cb24-2010" aria-hidden="true" tabindex="-1"></a><span class="ss">    <meta charset="UTF-8"></span></span>
<span id="cb24-2011"><a href="#cb24-2011" aria-hidden="true" tabindex="-1"></a><span class="ss">    <meta name="viewport" content="width=device-width, initial-scale=1.0"></span></span>
<span id="cb24-2012"><a href="#cb24-2012" aria-hidden="true" tabindex="-1"></a><span class="ss">    <title>√çndice Combinado - AI Chats</title></span></span>
<span id="cb24-2013"><a href="#cb24-2013" aria-hidden="true" tabindex="-1"></a><span class="ss">    <style></span></span>
<span id="cb24-2014"><a href="#cb24-2014" aria-hidden="true" tabindex="-1"></a><span class="ss">        * </span><span class="ch">{{</span><span class="ss"> margin: 0; padding: 0; box-sizing: border-box; </span><span class="ch">}}</span></span>
<span id="cb24-2015"><a href="#cb24-2015" aria-hidden="true" tabindex="-1"></a><span class="ss">        body </span><span class="ch">{{</span><span class="ss"> font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; padding: 20px; color: #333; </span><span class="ch">}}</span></span>
<span id="cb24-2016"><a href="#cb24-2016" aria-hidden="true" tabindex="-1"></a><span class="ss">        .container </span><span class="ch">{{</span><span class="ss"> max-width: 1400px; margin: 0 auto; background: white; border-radius: 15px; box-shadow: 0 20px 40px rgba(0,0,0,0.1); overflow: hidden; </span><span class="ch">}}</span></span>
<span id="cb24-2017"><a href="#cb24-2017" aria-hidden="true" tabindex="-1"></a><span class="ss">        .header </span><span class="ch">{{</span><span class="ss"> background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 40px; text-align: center; </span><span class="ch">}}</span></span>
<span id="cb24-2018"><a href="#cb24-2018" aria-hidden="true" tabindex="-1"></a><span class="ss">        .header h1 </span><span class="ch">{{</span><span class="ss"> font-size: 2.8em; margin-bottom: 15px; font-weight: 300; </span><span class="ch">}}</span></span>
<span id="cb24-2019"><a href="#cb24-2019" aria-hidden="true" tabindex="-1"></a><span class="ss">        .header p </span><span class="ch">{{</span><span class="ss"> font-size: 1.2em; opacity: 0.9; margin-bottom: 20px; </span><span class="ch">}}</span></span>
<span id="cb24-2020"><a href="#cb24-2020" aria-hidden="true" tabindex="-1"></a><span class="ss">        .stats </span><span class="ch">{{</span><span class="ss"> display: flex; justify-content: center; gap: 30px; margin-top: 25px; flex-wrap: wrap; </span><span class="ch">}}</span></span>
<span id="cb24-2021"><a href="#cb24-2021" aria-hidden="true" tabindex="-1"></a><span class="ss">        .stat-item </span><span class="ch">{{</span><span class="ss"> background: rgba(255,255,255,0.15); padding: 18px 28px; border-radius: 12px; backdrop-filter: blur(10px); font-size: 1.1em; </span><span class="ch">}}</span></span>
<span id="cb24-2022"><a href="#cb24-2022" aria-hidden="true" tabindex="-1"></a><span class="ss">        .search-section </span><span class="ch">{{</span><span class="ss"> padding: 30px; background: #f8f9fa; border-bottom: 1px solid #e9ecef; </span><span class="ch">}}</span></span>
<span id="cb24-2023"><a href="#cb24-2023" aria-hidden="true" tabindex="-1"></a><span class="ss">        .search-box </span><span class="ch">{{</span><span class="ss"> width: 100%; padding: 18px 25px; font-size: 16px; border: 2px solid #e9ecef; border-radius: 25px; outline: none; transition: all 0.3s ease; font-family: inherit; </span><span class="ch">}}</span></span>
<span id="cb24-2024"><a href="#cb24-2024" aria-hidden="true" tabindex="-1"></a><span class="ss">        .search-box:focus </span><span class="ch">{{</span><span class="ss"> border-color: #667eea; box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1); </span><span class="ch">}}</span></span>
<span id="cb24-2025"><a href="#cb24-2025" aria-hidden="true" tabindex="-1"></a><span class="ss">        .filter-section </span><span class="ch">{{</span></span>
<span id="cb24-2026"><a href="#cb24-2026" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 20px 30px;</span></span>
<span id="cb24-2027"><a href="#cb24-2027" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: flex;</span></span>
<span id="cb24-2028"><a href="#cb24-2028" aria-hidden="true" tabindex="-1"></a><span class="ss">            flex-wrap: wrap;</span></span>
<span id="cb24-2029"><a href="#cb24-2029" aria-hidden="true" tabindex="-1"></a><span class="ss">            gap: 12px;</span></span>
<span id="cb24-2030"><a href="#cb24-2030" aria-hidden="true" tabindex="-1"></a><span class="ss">            justify-content: center;</span></span>
<span id="cb24-2031"><a href="#cb24-2031" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #f8f9fa;</span></span>
<span id="cb24-2032"><a href="#cb24-2032" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-bottom: 1px solid #e9ecef;</span></span>
<span id="cb24-2033"><a href="#cb24-2033" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb24-2034"><a href="#cb24-2034" aria-hidden="true" tabindex="-1"></a><span class="ss">        .filter-btn </span><span class="ch">{{</span></span>
<span id="cb24-2035"><a href="#cb24-2035" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 10px 20px;</span></span>
<span id="cb24-2036"><a href="#cb24-2036" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: white;</span></span>
<span id="cb24-2037"><a href="#cb24-2037" aria-hidden="true" tabindex="-1"></a><span class="ss">            border: 2px solid #e9ecef;</span></span>
<span id="cb24-2038"><a href="#cb24-2038" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 25px;</span></span>
<span id="cb24-2039"><a href="#cb24-2039" aria-hidden="true" tabindex="-1"></a><span class="ss">            cursor: pointer;</span></span>
<span id="cb24-2040"><a href="#cb24-2040" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.95em;</span></span>
<span id="cb24-2041"><a href="#cb24-2041" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-weight: 500;</span></span>
<span id="cb24-2042"><a href="#cb24-2042" aria-hidden="true" tabindex="-1"></a><span class="ss">            transition: all 0.3s ease;</span></span>
<span id="cb24-2043"><a href="#cb24-2043" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-family: inherit;</span></span>
<span id="cb24-2044"><a href="#cb24-2044" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb24-2045"><a href="#cb24-2045" aria-hidden="true" tabindex="-1"></a><span class="ss">        .filter-btn.active, .filter-btn:hover </span><span class="ch">{{</span></span>
<span id="cb24-2046"><a href="#cb24-2046" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #667eea;</span></span>
<span id="cb24-2047"><a href="#cb24-2047" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: white;</span></span>
<span id="cb24-2048"><a href="#cb24-2048" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-color: #667eea;</span></span>
<span id="cb24-2049"><a href="#cb24-2049" aria-hidden="true" tabindex="-1"></a><span class="ss">            transform: translateY(-2px);</span></span>
<span id="cb24-2050"><a href="#cb24-2050" aria-hidden="true" tabindex="-1"></a><span class="ss">            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);</span></span>
<span id="cb24-2051"><a href="#cb24-2051" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb24-2052"><a href="#cb24-2052" aria-hidden="true" tabindex="-1"></a><span class="ss">        .conversations-grid </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb24-2053"><a href="#cb24-2053" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: grid; </span></span>
<span id="cb24-2054"><a href="#cb24-2054" aria-hidden="true" tabindex="-1"></a><span class="ss">            grid-template-columns: repeat(auto-fill, minmax(380px, 1fr)); </span></span>
<span id="cb24-2055"><a href="#cb24-2055" aria-hidden="true" tabindex="-1"></a><span class="ss">            gap: 25px; </span></span>
<span id="cb24-2056"><a href="#cb24-2056" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 35px;</span></span>
<span id="cb24-2057"><a href="#cb24-2057" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);</span></span>
<span id="cb24-2058"><a href="#cb24-2058" aria-hidden="true" tabindex="-1"></a><span class="ss">            min-height: 400px;</span></span>
<span id="cb24-2059"><a href="#cb24-2059" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb24-2060"><a href="#cb24-2060" aria-hidden="true" tabindex="-1"></a><span class="ss">        .conversation-card </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb24-2061"><a href="#cb24-2061" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: white; </span></span>
<span id="cb24-2062"><a href="#cb24-2062" aria-hidden="true" tabindex="-1"></a><span class="ss">            border: 1px solid #e9ecef; </span></span>
<span id="cb24-2063"><a href="#cb24-2063" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 15px; </span></span>
<span id="cb24-2064"><a href="#cb24-2064" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 25px; </span></span>
<span id="cb24-2065"><a href="#cb24-2065" aria-hidden="true" tabindex="-1"></a><span class="ss">            transition: all 0.4s ease; </span></span>
<span id="cb24-2066"><a href="#cb24-2066" aria-hidden="true" tabindex="-1"></a><span class="ss">            cursor: pointer; </span></span>
<span id="cb24-2067"><a href="#cb24-2067" aria-hidden="true" tabindex="-1"></a><span class="ss">            position: relative;</span></span>
<span id="cb24-2068"><a href="#cb24-2068" aria-hidden="true" tabindex="-1"></a><span class="ss">            box-shadow: 0 5px 15px rgba(0,0,0,0.08);</span></span>
<span id="cb24-2069"><a href="#cb24-2069" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb24-2070"><a href="#cb24-2070" aria-hidden="true" tabindex="-1"></a><span class="ss">        .conversation-card:hover </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb24-2071"><a href="#cb24-2071" aria-hidden="true" tabindex="-1"></a><span class="ss">            transform: translateY(-8px); </span></span>
<span id="cb24-2072"><a href="#cb24-2072" aria-hidden="true" tabindex="-1"></a><span class="ss">            box-shadow: 0 15px 35px rgba(0,0,0,0.15); </span></span>
<span id="cb24-2073"><a href="#cb24-2073" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-color: #667eea;</span></span>
<span id="cb24-2074"><a href="#cb24-2074" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb24-2075"><a href="#cb24-2075" aria-hidden="true" tabindex="-1"></a><span class="ss">        .card-header </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb24-2076"><a href="#cb24-2076" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: flex; </span></span>
<span id="cb24-2077"><a href="#cb24-2077" aria-hidden="true" tabindex="-1"></a><span class="ss">            justify-content: space-between; </span></span>
<span id="cb24-2078"><a href="#cb24-2078" aria-hidden="true" tabindex="-1"></a><span class="ss">            align-items: flex-start; </span></span>
<span id="cb24-2079"><a href="#cb24-2079" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-bottom: 18px; </span></span>
<span id="cb24-2080"><a href="#cb24-2080" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb24-2081"><a href="#cb24-2081" aria-hidden="true" tabindex="-1"></a><span class="ss">        .card-number </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb24-2082"><a href="#cb24-2082" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: linear-gradient(135deg, #667eea, #764ba2); </span></span>
<span id="cb24-2083"><a href="#cb24-2083" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: white; </span></span>
<span id="cb24-2084"><a href="#cb24-2084" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 8px 16px; </span></span>
<span id="cb24-2085"><a href="#cb24-2085" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 20px; </span></span>
<span id="cb24-2086"><a href="#cb24-2086" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.9em; </span></span>
<span id="cb24-2087"><a href="#cb24-2087" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-weight: bold;</span></span>
<span id="cb24-2088"><a href="#cb24-2088" aria-hidden="true" tabindex="-1"></a><span class="ss">            box-shadow: 0 3px 10px rgba(102, 126, 234, 0.3);</span></span>
<span id="cb24-2089"><a href="#cb24-2089" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb24-2090"><a href="#cb24-2090" aria-hidden="true" tabindex="-1"></a><span class="ss">        .card-source </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb24-2091"><a href="#cb24-2091" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #e3f2fd; </span></span>
<span id="cb24-2092"><a href="#cb24-2092" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #1976d2; </span></span>
<span id="cb24-2093"><a href="#cb24-2093" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 5px 12px; </span></span>
<span id="cb24-2094"><a href="#cb24-2094" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 12px; </span></span>
<span id="cb24-2095"><a href="#cb24-2095" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.85em; </span></span>
<span id="cb24-2096"><a href="#cb24-2096" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-weight: bold; </span></span>
<span id="cb24-2097"><a href="#cb24-2097" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-left: 10px;</span></span>
<span id="cb24-2098"><a href="#cb24-2098" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb24-2099"><a href="#cb24-2099" aria-hidden="true" tabindex="-1"></a><span class="ss">        .card-title </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb24-2100"><a href="#cb24-2100" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 1.3em; </span></span>
<span id="cb24-2101"><a href="#cb24-2101" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-weight: 600; </span></span>
<span id="cb24-2102"><a href="#cb24-2102" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #2c3e50; </span></span>
<span id="cb24-2103"><a href="#cb24-2103" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-bottom: 12px; </span></span>
<span id="cb24-2104"><a href="#cb24-2104" aria-hidden="true" tabindex="-1"></a><span class="ss">            line-height: 1.4;</span></span>
<span id="cb24-2105"><a href="#cb24-2105" aria-hidden="true" tabindex="-1"></a><span class="ss">            min-height: 3.6em;</span></span>
<span id="cb24-2106"><a href="#cb24-2106" aria-hidden="true" tabindex="-1"></a><span class="ss">            cursor: pointer;</span></span>
<span id="cb24-2107"><a href="#cb24-2107" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb24-2108"><a href="#cb24-2108" aria-hidden="true" tabindex="-1"></a><span class="ss">        .card-summary </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb24-2109"><a href="#cb24-2109" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #6c757d; </span></span>
<span id="cb24-2110"><a href="#cb24-2110" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.95em; </span></span>
<span id="cb24-2111"><a href="#cb24-2111" aria-hidden="true" tabindex="-1"></a><span class="ss">            line-height: 1.5; </span></span>
<span id="cb24-2112"><a href="#cb24-2112" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-bottom: 18px;</span></span>
<span id="cb24-2113"><a href="#cb24-2113" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: -webkit-box;</span></span>
<span id="cb24-2114"><a href="#cb24-2114" aria-hidden="true" tabindex="-1"></a><span class="ss">            -webkit-line-clamp: 3;</span></span>
<span id="cb24-2115"><a href="#cb24-2115" aria-hidden="true" tabindex="-1"></a><span class="ss">            -webkit-box-orient: vertical;</span></span>
<span id="cb24-2116"><a href="#cb24-2116" aria-hidden="true" tabindex="-1"></a><span class="ss">            overflow: hidden;</span></span>
<span id="cb24-2117"><a href="#cb24-2117" aria-hidden="true" tabindex="-1"></a><span class="ss">            cursor: pointer;</span></span>
<span id="cb24-2118"><a href="#cb24-2118" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb24-2119"><a href="#cb24-2119" aria-hidden="true" tabindex="-1"></a><span class="ss">        .card-meta </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb24-2120"><a href="#cb24-2120" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: flex; </span></span>
<span id="cb24-2121"><a href="#cb24-2121" aria-hidden="true" tabindex="-1"></a><span class="ss">            justify-content: space-between; </span></span>
<span id="cb24-2122"><a href="#cb24-2122" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.85em; </span></span>
<span id="cb24-2123"><a href="#cb24-2123" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #868e96; </span></span>
<span id="cb24-2124"><a href="#cb24-2124" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-top: 1px solid #e9ecef; </span></span>
<span id="cb24-2125"><a href="#cb24-2125" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding-top: 18px;</span></span>
<span id="cb24-2126"><a href="#cb24-2126" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb24-2127"><a href="#cb24-2127" aria-hidden="true" tabindex="-1"></a><span class="ss">        .card-actions </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb24-2128"><a href="#cb24-2128" aria-hidden="true" tabindex="-1"></a><span class="ss">            position: absolute; </span></span>
<span id="cb24-2129"><a href="#cb24-2129" aria-hidden="true" tabindex="-1"></a><span class="ss">            top: 20px; </span></span>
<span id="cb24-2130"><a href="#cb24-2130" aria-hidden="true" tabindex="-1"></a><span class="ss">            right: 20px; </span></span>
<span id="cb24-2131"><a href="#cb24-2131" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: flex; </span></span>
<span id="cb24-2132"><a href="#cb24-2132" aria-hidden="true" tabindex="-1"></a><span class="ss">            gap: 8px; </span></span>
<span id="cb24-2133"><a href="#cb24-2133" aria-hidden="true" tabindex="-1"></a><span class="ss">            opacity: 0; </span></span>
<span id="cb24-2134"><a href="#cb24-2134" aria-hidden="true" tabindex="-1"></a><span class="ss">            transition: opacity 0.3s ease; </span></span>
<span id="cb24-2135"><a href="#cb24-2135" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb24-2136"><a href="#cb24-2136" aria-hidden="true" tabindex="-1"></a><span class="ss">        .conversation-card:hover .card-actions </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb24-2137"><a href="#cb24-2137" aria-hidden="true" tabindex="-1"></a><span class="ss">            opacity: 1; </span></span>
<span id="cb24-2138"><a href="#cb24-2138" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb24-2139"><a href="#cb24-2139" aria-hidden="true" tabindex="-1"></a><span class="ss">        .action-btn </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb24-2140"><a href="#cb24-2140" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: white; </span></span>
<span id="cb24-2141"><a href="#cb24-2141" aria-hidden="true" tabindex="-1"></a><span class="ss">            border: 2px solid #e9ecef; </span></span>
<span id="cb24-2142"><a href="#cb24-2142" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 8px; </span></span>
<span id="cb24-2143"><a href="#cb24-2143" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 6px 12px; </span></span>
<span id="cb24-2144"><a href="#cb24-2144" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.8em; </span></span>
<span id="cb24-2145"><a href="#cb24-2145" aria-hidden="true" tabindex="-1"></a><span class="ss">            cursor: pointer; </span></span>
<span id="cb24-2146"><a href="#cb24-2146" aria-hidden="true" tabindex="-1"></a><span class="ss">            transition: all 0.3s ease;</span></span>
<span id="cb24-2147"><a href="#cb24-2147" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-weight: 500;</span></span>
<span id="cb24-2148"><a href="#cb24-2148" aria-hidden="true" tabindex="-1"></a><span class="ss">            text-decoration: none;</span></span>
<span id="cb24-2149"><a href="#cb24-2149" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #333;</span></span>
<span id="cb24-2150"><a href="#cb24-2150" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: inline-block;</span></span>
<span id="cb24-2151"><a href="#cb24-2151" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb24-2152"><a href="#cb24-2152" aria-hidden="true" tabindex="-1"></a><span class="ss">        .action-btn:hover </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb24-2153"><a href="#cb24-2153" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #667eea; </span></span>
<span id="cb24-2154"><a href="#cb24-2154" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: white; </span></span>
<span id="cb24-2155"><a href="#cb24-2155" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-color: #667eea;</span></span>
<span id="cb24-2156"><a href="#cb24-2156" aria-hidden="true" tabindex="-1"></a><span class="ss">            transform: scale(1.05);</span></span>
<span id="cb24-2157"><a href="#cb24-2157" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb24-2158"><a href="#cb24-2158" aria-hidden="true" tabindex="-1"></a><span class="ss">        .recent-badge </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb24-2159"><a href="#cb24-2159" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #ff6b6b; </span></span>
<span id="cb24-2160"><a href="#cb24-2160" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: white; </span></span>
<span id="cb24-2161"><a href="#cb24-2161" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 3px 10px; </span></span>
<span id="cb24-2162"><a href="#cb24-2162" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 12px; </span></span>
<span id="cb24-2163"><a href="#cb24-2163" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.75em; </span></span>
<span id="cb24-2164"><a href="#cb24-2164" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-left: 8px;</span></span>
<span id="cb24-2165"><a href="#cb24-2165" aria-hidden="true" tabindex="-1"></a><span class="ss">            animation: pulse 2s infinite;</span></span>
<span id="cb24-2166"><a href="#cb24-2166" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb24-2167"><a href="#cb24-2167" aria-hidden="true" tabindex="-1"></a><span class="ss">        .no-results </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb24-2168"><a href="#cb24-2168" aria-hidden="true" tabindex="-1"></a><span class="ss">            text-align: center; </span></span>
<span id="cb24-2169"><a href="#cb24-2169" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 60px 20px; </span></span>
<span id="cb24-2170"><a href="#cb24-2170" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #6c757d;</span></span>
<span id="cb24-2171"><a href="#cb24-2171" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 1.1em;</span></span>
<span id="cb24-2172"><a href="#cb24-2172" aria-hidden="true" tabindex="-1"></a><span class="ss">            grid-column: 1 / -1;</span></span>
<span id="cb24-2173"><a href="#cb24-2173" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb24-2174"><a href="#cb24-2174" aria-hidden="true" tabindex="-1"></a><span class="ss">        @keyframes pulse </span><span class="ch">{{</span></span>
<span id="cb24-2175"><a href="#cb24-2175" aria-hidden="true" tabindex="-1"></a><span class="ss">            0% </span><span class="ch">{{</span><span class="ss"> transform: scale(1); </span><span class="ch">}}</span></span>
<span id="cb24-2176"><a href="#cb24-2176" aria-hidden="true" tabindex="-1"></a><span class="ss">            50% </span><span class="ch">{{</span><span class="ss"> transform: scale(1.05); </span><span class="ch">}}</span></span>
<span id="cb24-2177"><a href="#cb24-2177" aria-hidden="true" tabindex="-1"></a><span class="ss">            100% </span><span class="ch">{{</span><span class="ss"> transform: scale(1); </span><span class="ch">}}</span></span>
<span id="cb24-2178"><a href="#cb24-2178" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb24-2179"><a href="#cb24-2179" aria-hidden="true" tabindex="-1"></a><span class="ss">        .category-badge </span><span class="ch">{{</span></span>
<span id="cb24-2180"><a href="#cb24-2180" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: inline-block;</span></span>
<span id="cb24-2181"><a href="#cb24-2181" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #e3f2fd;</span></span>
<span id="cb24-2182"><a href="#cb24-2182" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #1976d2;</span></span>
<span id="cb24-2183"><a href="#cb24-2183" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 4px 10px;</span></span>
<span id="cb24-2184"><a href="#cb24-2184" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 12px;</span></span>
<span id="cb24-2185"><a href="#cb24-2185" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.8em;</span></span>
<span id="cb24-2186"><a href="#cb24-2186" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-left: 8px;</span></span>
<span id="cb24-2187"><a href="#cb24-2187" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-weight: 500;</span></span>
<span id="cb24-2188"><a href="#cb24-2188" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb24-2189"><a href="#cb24-2189" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb24-2190"><a href="#cb24-2190" aria-hidden="true" tabindex="-1"></a><span class="ss">        .direct-link </span><span class="ch">{{</span></span>
<span id="cb24-2191"><a href="#cb24-2191" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: inline-block;</span></span>
<span id="cb24-2192"><a href="#cb24-2192" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin: 5px;</span></span>
<span id="cb24-2193"><a href="#cb24-2193" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 8px 15px;</span></span>
<span id="cb24-2194"><a href="#cb24-2194" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #28a745;</span></span>
<span id="cb24-2195"><a href="#cb24-2195" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: white;</span></span>
<span id="cb24-2196"><a href="#cb24-2196" aria-hidden="true" tabindex="-1"></a><span class="ss">            text-decoration: none;</span></span>
<span id="cb24-2197"><a href="#cb24-2197" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 5px;</span></span>
<span id="cb24-2198"><a href="#cb24-2198" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.9em;</span></span>
<span id="cb24-2199"><a href="#cb24-2199" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb24-2200"><a href="#cb24-2200" aria-hidden="true" tabindex="-1"></a><span class="ss">        .direct-link:hover </span><span class="ch">{{</span></span>
<span id="cb24-2201"><a href="#cb24-2201" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #218838;</span></span>
<span id="cb24-2202"><a href="#cb24-2202" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb24-2203"><a href="#cb24-2203" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb24-2204"><a href="#cb24-2204" aria-hidden="true" tabindex="-1"></a><span class="ss">        .html-btn </span><span class="ch">{{</span></span>
<span id="cb24-2205"><a href="#cb24-2205" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #17a2b8;</span></span>
<span id="cb24-2206"><a href="#cb24-2206" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: white;</span></span>
<span id="cb24-2207"><a href="#cb24-2207" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb24-2208"><a href="#cb24-2208" aria-hidden="true" tabindex="-1"></a><span class="ss">        .html-btn:hover </span><span class="ch">{{</span></span>
<span id="cb24-2209"><a href="#cb24-2209" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #138496;</span></span>
<span id="cb24-2210"><a href="#cb24-2210" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb24-2211"><a href="#cb24-2211" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb24-2212"><a href="#cb24-2212" aria-hidden="true" tabindex="-1"></a><span class="ss">        .pdf-btn </span><span class="ch">{{</span></span>
<span id="cb24-2213"><a href="#cb24-2213" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #dc3545;</span></span>
<span id="cb24-2214"><a href="#cb24-2214" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: white;</span></span>
<span id="cb24-2215"><a href="#cb24-2215" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb24-2216"><a href="#cb24-2216" aria-hidden="true" tabindex="-1"></a><span class="ss">        .pdf-btn:hover </span><span class="ch">{{</span></span>
<span id="cb24-2217"><a href="#cb24-2217" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #c82333;</span></span>
<span id="cb24-2218"><a href="#cb24-2218" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb24-2219"><a href="#cb24-2219" aria-hidden="true" tabindex="-1"></a><span class="ss">    </style></span></span>
<span id="cb24-2220"><a href="#cb24-2220" aria-hidden="true" tabindex="-1"></a><span class="ss"></head></span></span>
<span id="cb24-2221"><a href="#cb24-2221" aria-hidden="true" tabindex="-1"></a><span class="ss"><body></span></span>
<span id="cb24-2222"><a href="#cb24-2222" aria-hidden="true" tabindex="-1"></a><span class="ss">    <div class="container"></span></span>
<span id="cb24-2223"><a href="#cb24-2223" aria-hidden="true" tabindex="-1"></a><span class="ss">        <div class="header"></span></span>
<span id="cb24-2224"><a href="#cb24-2224" aria-hidden="true" tabindex="-1"></a><span class="ss">            <h1>üìö √çndice Combinado de Conversas</h1></span></span>
<span id="cb24-2225"><a href="#cb24-2225" aria-hidden="true" tabindex="-1"></a><span class="ss">            <p>Qwen3 ‚Ä¢ ChatGPT ‚Ä¢ DeepSeek ‚Ä¢ Grok ‚Ä¢ COM HTML (Pandoc + MathJax)</p></span></span>
<span id="cb24-2226"><a href="#cb24-2226" aria-hidden="true" tabindex="-1"></a><span class="ss">            <div class="stats"></span></span>
<span id="cb24-2227"><a href="#cb24-2227" aria-hidden="true" tabindex="-1"></a><span class="ss">                <div class="stat-item"></span></span>
<span id="cb24-2228"><a href="#cb24-2228" aria-hidden="true" tabindex="-1"></a><span class="ss">                    <strong>Total:</strong> <span id="total-count"></span><span class="sc">{</span><span class="bu">len</span>(<span class="va">self</span>.all_conversations)<span class="sc">}</span><span class="ss"></span> conversas</span></span>
<span id="cb24-2229"><a href="#cb24-2229" aria-hidden="true" tabindex="-1"></a><span class="ss">                </div></span></span>
<span id="cb24-2230"><a href="#cb24-2230" aria-hidden="true" tabindex="-1"></a><span class="ss">                <div class="stat-item"></span></span>
<span id="cb24-2231"><a href="#cb24-2231" aria-hidden="true" tabindex="-1"></a><span class="ss">                    <strong>Ordena√ß√£o:</strong> Mais Recentes Primeiro</span></span>
<span id="cb24-2232"><a href="#cb24-2232" aria-hidden="true" tabindex="-1"></a><span class="ss">                </div></span></span>
<span id="cb24-2233"><a href="#cb24-2233" aria-hidden="true" tabindex="-1"></a><span class="ss">                <div class="stat-item"></span></span>
<span id="cb24-2234"><a href="#cb24-2234" aria-hidden="true" tabindex="-1"></a><span class="ss">                    <strong>Atualizado:</strong> </span><span class="sc">{</span>datetime<span class="sc">.</span>now()<span class="sc">.</span>strftime(<span class="st">'</span><span class="sc">%d</span><span class="st">/%m/%Y %H:%M'</span>)<span class="sc">}</span></span>
<span id="cb24-2235"><a href="#cb24-2235" aria-hidden="true" tabindex="-1"></a><span class="ss">                </div></span></span>
<span id="cb24-2236"><a href="#cb24-2236" aria-hidden="true" tabindex="-1"></a><span class="ss">            </div></span></span>
<span id="cb24-2237"><a href="#cb24-2237" aria-hidden="true" tabindex="-1"></a><span class="ss">        </div></span></span>
<span id="cb24-2238"><a href="#cb24-2238" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb24-2239"><a href="#cb24-2239" aria-hidden="true" tabindex="-1"></a><span class="ss">        <div class="search-section"></span></span>
<span id="cb24-2240"><a href="#cb24-2240" aria-hidden="true" tabindex="-1"></a><span class="ss">            <input type="text" id="searchInput" class="search-box" placeholder="üîç Pesquisar por t√≠tulo, conte√∫do ou categoria..."></span></span>
<span id="cb24-2241"><a href="#cb24-2241" aria-hidden="true" tabindex="-1"></a><span class="ss">        </div></span></span>
<span id="cb24-2242"><a href="#cb24-2242" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb24-2243"><a href="#cb24-2243" aria-hidden="true" tabindex="-1"></a><span class="ss">        <div class="filter-section"></span></span>
<span id="cb24-2244"><a href="#cb24-2244" aria-hidden="true" tabindex="-1"></a><span class="ss">            <button class="filter-btn active" data-filter="todas">Todas (</span><span class="sc">{</span><span class="bu">len</span>(<span class="va">self</span>.all_conversations)<span class="sc">}</span><span class="ss">)</button></span></span>
<span id="cb24-2245"><a href="#cb24-2245" aria-hidden="true" tabindex="-1"></a><span class="ss">"""</span></span>
<span id="cb24-2246"><a href="#cb24-2246" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-2247"><a href="#cb24-2247" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> category, count <span class="kw">in</span> category_stats.items():</span>
<span id="cb24-2248"><a href="#cb24-2248" aria-hidden="true" tabindex="-1"></a>            html_content <span class="op">+=</span> <span class="ss">f'<button class="filter-btn" data-filter="</span><span class="sc">{</span>category<span class="sc">.</span>lower()<span class="sc">}</span><span class="ss">"></span><span class="sc">{</span>category<span class="sc">}</span><span class="ss"> (</span><span class="sc">{</span>count<span class="sc">}</span><span class="ss">)</button></span><span class="ch">\n</span><span class="ss">'</span></span>
<span id="cb24-2249"><a href="#cb24-2249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-2250"><a href="#cb24-2250" aria-hidden="true" tabindex="-1"></a>        html_content <span class="op">+=</span> <span class="st">"""</span></span>
<span id="cb24-2251"><a href="#cb24-2251" aria-hidden="true" tabindex="-1"></a><span class="st">        </div></span></span>
<span id="cb24-2252"><a href="#cb24-2252" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb24-2253"><a href="#cb24-2253" aria-hidden="true" tabindex="-1"></a><span class="st">        <div style="text-align: center; padding: 15px; background: #e9ecef; border-bottom: 1px solid #ddd;"></span></span>
<span id="cb24-2254"><a href="#cb24-2254" aria-hidden="true" tabindex="-1"></a><span class="st">            <strong>Acesso R√°pido:</strong></span></span>
<span id="cb24-2255"><a href="#cb24-2255" aria-hidden="true" tabindex="-1"></a><span class="st">            <a href="combined_markdown/" class="direct-link" target="_blank">üìÅ Markdown</a></span></span>
<span id="cb24-2256"><a href="#cb24-2256" aria-hidden="true" tabindex="-1"></a><span class="st">            <a href="combined_html/" class="direct-link" target="_blank">üåê HTML</a></span></span>
<span id="cb24-2257"><a href="#cb24-2257" aria-hidden="true" tabindex="-1"></a><span class="st">            <a href="combined_pdfs/" class="direct-link" target="_blank">üìÑ PDF</a></span></span>
<span id="cb24-2258"><a href="#cb24-2258" aria-hidden="true" tabindex="-1"></a><span class="st">            <a href="combined_json/" class="direct-link" target="_blank">üìã JSON</a></span></span>
<span id="cb24-2259"><a href="#cb24-2259" aria-hidden="true" tabindex="-1"></a><span class="st">        </div></span></span>
<span id="cb24-2260"><a href="#cb24-2260" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb24-2261"><a href="#cb24-2261" aria-hidden="true" tabindex="-1"></a><span class="st">        <div class="conversations-grid" id="conversationsGrid"></span></span>
<span id="cb24-2262"><a href="#cb24-2262" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb24-2263"><a href="#cb24-2263" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-2264"><a href="#cb24-2264" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, conv <span class="kw">in</span> <span class="bu">enumerate</span>(<span class="va">self</span>.all_conversations):</span>
<span id="cb24-2265"><a href="#cb24-2265" aria-hidden="true" tabindex="-1"></a>            safe_title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(conv[<span class="st">'title'</span>])</span>
<span id="cb24-2266"><a href="#cb24-2266" aria-hidden="true" tabindex="-1"></a>            filename <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>conv[<span class="st">'number'</span>]<span class="sc">:03d}</span><span class="ss">_</span><span class="sc">{</span>conv[<span class="st">'source'</span>]<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>safe_title<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb24-2267"><a href="#cb24-2267" aria-hidden="true" tabindex="-1"></a>            recent_badge <span class="op">=</span> <span class="st">"<span class='recent-badge'>NOVO</span>"</span> <span class="cf">if</span> i <span class="op"><</span> <span class="dv">5</span> <span class="cf">else</span> <span class="st">""</span></span>
<span id="cb24-2268"><a href="#cb24-2268" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-2269"><a href="#cb24-2269" aria-hidden="true" tabindex="-1"></a>            summary <span class="op">=</span> conv.get(<span class="st">'summary'</span>, <span class="st">'Sem resumo dispon√≠vel'</span>)</span>
<span id="cb24-2270"><a href="#cb24-2270" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">len</span>(summary) <span class="op">></span> <span class="dv">150</span>:</span>
<span id="cb24-2271"><a href="#cb24-2271" aria-hidden="true" tabindex="-1"></a>                summary <span class="op">=</span> summary[:<span class="dv">150</span>] <span class="op">+</span> <span class="st">"..."</span></span>
<span id="cb24-2272"><a href="#cb24-2272" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-2273"><a href="#cb24-2273" aria-hidden="true" tabindex="-1"></a>            html_content <span class="op">+=</span> <span class="ss">f"""</span></span>
<span id="cb24-2274"><a href="#cb24-2274" aria-hidden="true" tabindex="-1"></a><span class="ss">            <div class="conversation-card" data-title="</span><span class="sc">{</span>conv[<span class="st">'title'</span>]<span class="sc">}</span><span class="ss">" data-summary="</span><span class="sc">{</span>summary<span class="sc">}</span><span class="ss">" data-source="</span><span class="sc">{</span>conv[<span class="st">'source'</span>]<span class="sc">.</span>lower()<span class="sc">}</span><span class="ss">" data-category="</span><span class="sc">{</span>conv[<span class="st">'category'</span>]<span class="sc">.</span>lower()<span class="sc">}</span><span class="ss">"></span></span>
<span id="cb24-2275"><a href="#cb24-2275" aria-hidden="true" tabindex="-1"></a><span class="ss">                <div class="card-header"></span></span>
<span id="cb24-2276"><a href="#cb24-2276" aria-hidden="true" tabindex="-1"></a><span class="ss">                    <div class="card-number">#</span><span class="sc">{</span>conv[<span class="st">'number'</span>]<span class="sc">}</span><span class="ss"> </span><span class="sc">{</span>recent_badge<span class="sc">}</span><span class="ss"></div></span></span>
<span id="cb24-2277"><a href="#cb24-2277" aria-hidden="true" tabindex="-1"></a><span class="ss">                    <div class="card-actions"></span></span>
<span id="cb24-2278"><a href="#cb24-2278" aria-hidden="true" tabindex="-1"></a><span class="ss">                        <a href="combined_markdown/</span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">.md" class="action-btn" target="_blank" onclick="event.stopPropagation();">üìÑ MD</a></span></span>
<span id="cb24-2279"><a href="#cb24-2279" aria-hidden="true" tabindex="-1"></a><span class="ss">                        <a href="combined_html/</span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">.html" class="action-btn html-btn" target="_blank" onclick="event.stopPropagation();">üåê HTML</a></span></span>
<span id="cb24-2280"><a href="#cb24-2280" aria-hidden="true" tabindex="-1"></a><span class="ss">                        <a href="combined_pdfs/</span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">.pdf" class="action-btn pdf-btn" target="_blank" onclick="event.stopPropagation();">üìä PDF</a></span></span>
<span id="cb24-2281"><a href="#cb24-2281" aria-hidden="true" tabindex="-1"></a><span class="ss">                    </div></span></span>
<span id="cb24-2282"><a href="#cb24-2282" aria-hidden="true" tabindex="-1"></a><span class="ss">                </div></span></span>
<span id="cb24-2283"><a href="#cb24-2283" aria-hidden="true" tabindex="-1"></a><span class="ss">                <div class="card-title" onclick="openHTML('</span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">.html')"></span><span class="sc">{</span>conv[<span class="st">'title'</span>]<span class="sc">}</span><span class="ss"></div></span></span>
<span id="cb24-2284"><a href="#cb24-2284" aria-hidden="true" tabindex="-1"></a><span class="ss">                <div></span></span>
<span id="cb24-2285"><a href="#cb24-2285" aria-hidden="true" tabindex="-1"></a><span class="ss">                    <span class="card-source"></span><span class="sc">{</span>conv[<span class="st">'source'</span>]<span class="sc">}</span><span class="ss"></span></span></span>
<span id="cb24-2286"><a href="#cb24-2286" aria-hidden="true" tabindex="-1"></a><span class="ss">                    <span class="category-badge"></span><span class="sc">{</span>conv[<span class="st">'category'</span>]<span class="sc">}</span><span class="ss"></span></span></span>
<span id="cb24-2287"><a href="#cb24-2287" aria-hidden="true" tabindex="-1"></a><span class="ss">                </div></span></span>
<span id="cb24-2288"><a href="#cb24-2288" aria-hidden="true" tabindex="-1"></a><span class="ss">                <div class="card-summary" onclick="openHTML('</span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">.html')"></span><span class="sc">{</span>summary<span class="sc">}</span><span class="ss"></div></span></span>
<span id="cb24-2289"><a href="#cb24-2289" aria-hidden="true" tabindex="-1"></a><span class="ss">                <div class="card-meta"></span></span>
<span id="cb24-2290"><a href="#cb24-2290" aria-hidden="true" tabindex="-1"></a><span class="ss">                    <span>üìÖ </span><span class="sc">{</span>conv<span class="sc">.</span>get(<span class="st">'updated_at'</span>) <span class="kw">or</span> conv<span class="sc">.</span>get(<span class="st">'inserted_at'</span>) <span class="kw">or</span> <span class="st">'N/A'</span><span class="sc">}</span><span class="ss"></span></span></span>
<span id="cb24-2291"><a href="#cb24-2291" aria-hidden="true" tabindex="-1"></a><span class="ss">                    <span>üí¨ </span><span class="sc">{</span><span class="bu">len</span>(conv[<span class="st">'messages'</span>])<span class="sc">}</span><span class="ss"> mensagens</span></span></span>
<span id="cb24-2292"><a href="#cb24-2292" aria-hidden="true" tabindex="-1"></a><span class="ss">                </div></span></span>
<span id="cb24-2293"><a href="#cb24-2293" aria-hidden="true" tabindex="-1"></a><span class="ss">            </div></span></span>
<span id="cb24-2294"><a href="#cb24-2294" aria-hidden="true" tabindex="-1"></a><span class="ss">            """</span></span>
<span id="cb24-2295"><a href="#cb24-2295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-2296"><a href="#cb24-2296" aria-hidden="true" tabindex="-1"></a>        html_content <span class="op">+=</span> <span class="st">"""</span></span>
<span id="cb24-2297"><a href="#cb24-2297" aria-hidden="true" tabindex="-1"></a><span class="st">        </div></span></span>
<span id="cb24-2298"><a href="#cb24-2298" aria-hidden="true" tabindex="-1"></a><span class="st">    </div></span></span>
<span id="cb24-2299"><a href="#cb24-2299" aria-hidden="true" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb24-2300"><a href="#cb24-2300" aria-hidden="true" tabindex="-1"></a><span class="st">    <script></span></span>
<span id="cb24-2301"><a href="#cb24-2301" aria-hidden="true" tabindex="-1"></a><span class="st">        let currentFilter = 'todas';</span></span>
<span id="cb24-2302"><a href="#cb24-2302" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb24-2303"><a href="#cb24-2303" aria-hidden="true" tabindex="-1"></a><span class="st">        document.addEventListener('DOMContentLoaded', function() {</span></span>
<span id="cb24-2304"><a href="#cb24-2304" aria-hidden="true" tabindex="-1"></a><span class="st">            updateStats();</span></span>
<span id="cb24-2305"><a href="#cb24-2305" aria-hidden="true" tabindex="-1"></a><span class="st">        });</span></span>
<span id="cb24-2306"><a href="#cb24-2306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-2307"><a href="#cb24-2307" aria-hidden="true" tabindex="-1"></a><span class="st">        document.querySelectorAll('.filter-btn').forEach(btn => {</span></span>
<span id="cb24-2308"><a href="#cb24-2308" aria-hidden="true" tabindex="-1"></a><span class="st">            btn.addEventListener('click', () => {</span></span>
<span id="cb24-2309"><a href="#cb24-2309" aria-hidden="true" tabindex="-1"></a><span class="st">                document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));</span></span>
<span id="cb24-2310"><a href="#cb24-2310" aria-hidden="true" tabindex="-1"></a><span class="st">                btn.classList.add('active');</span></span>
<span id="cb24-2311"><a href="#cb24-2311" aria-hidden="true" tabindex="-1"></a><span class="st">                currentFilter = btn.getAttribute('data-filter');</span></span>
<span id="cb24-2312"><a href="#cb24-2312" aria-hidden="true" tabindex="-1"></a><span class="st">                filterConversations();</span></span>
<span id="cb24-2313"><a href="#cb24-2313" aria-hidden="true" tabindex="-1"></a><span class="st">            });</span></span>
<span id="cb24-2314"><a href="#cb24-2314" aria-hidden="true" tabindex="-1"></a><span class="st">        });</span></span>
<span id="cb24-2315"><a href="#cb24-2315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-2316"><a href="#cb24-2316" aria-hidden="true" tabindex="-1"></a><span class="st">        document.getElementById('searchInput').addEventListener('input', filterConversations);</span></span>
<span id="cb24-2317"><a href="#cb24-2317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-2318"><a href="#cb24-2318" aria-hidden="true" tabindex="-1"></a><span class="st">        function filterConversations() {</span></span>
<span id="cb24-2319"><a href="#cb24-2319" aria-hidden="true" tabindex="-1"></a><span class="st">            const term = document.getElementById('searchInput').value.toLowerCase();</span></span>
<span id="cb24-2320"><a href="#cb24-2320" aria-hidden="true" tabindex="-1"></a><span class="st">            const cards = document.querySelectorAll('.conversation-card');</span></span>
<span id="cb24-2321"><a href="#cb24-2321" aria-hidden="true" tabindex="-1"></a><span class="st">            let visible = 0;</span></span>
<span id="cb24-2322"><a href="#cb24-2322" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb24-2323"><a href="#cb24-2323" aria-hidden="true" tabindex="-1"></a><span class="st">            cards.forEach(card => {</span></span>
<span id="cb24-2324"><a href="#cb24-2324" aria-hidden="true" tabindex="-1"></a><span class="st">                const title = card.getAttribute('data-title').toLowerCase();</span></span>
<span id="cb24-2325"><a href="#cb24-2325" aria-hidden="true" tabindex="-1"></a><span class="st">                const summary = card.getAttribute('data-summary').toLowerCase();</span></span>
<span id="cb24-2326"><a href="#cb24-2326" aria-hidden="true" tabindex="-1"></a><span class="st">                const source = card.getAttribute('data-source').toLowerCase();</span></span>
<span id="cb24-2327"><a href="#cb24-2327" aria-hidden="true" tabindex="-1"></a><span class="st">                const category = card.getAttribute('data-category').toLowerCase();</span></span>
<span id="cb24-2328"><a href="#cb24-2328" aria-hidden="true" tabindex="-1"></a><span class="st">                </span></span>
<span id="cb24-2329"><a href="#cb24-2329" aria-hidden="true" tabindex="-1"></a><span class="st">                const matchesSearch = (title.includes(term) || summary.includes(term) || category.includes(term) || source.includes(term));</span></span>
<span id="cb24-2330"><a href="#cb24-2330" aria-hidden="true" tabindex="-1"></a><span class="st">                const matchesCategory = (currentFilter === 'todas' || category === currentFilter);</span></span>
<span id="cb24-2331"><a href="#cb24-2331" aria-hidden="true" tabindex="-1"></a><span class="st">                </span></span>
<span id="cb24-2332"><a href="#cb24-2332" aria-hidden="true" tabindex="-1"></a><span class="st">                if (matchesSearch && matchesCategory) {</span></span>
<span id="cb24-2333"><a href="#cb24-2333" aria-hidden="true" tabindex="-1"></a><span class="st">                    card.style.display = 'block';</span></span>
<span id="cb24-2334"><a href="#cb24-2334" aria-hidden="true" tabindex="-1"></a><span class="st">                    visible++;</span></span>
<span id="cb24-2335"><a href="#cb24-2335" aria-hidden="true" tabindex="-1"></a><span class="st">                } else {</span></span>
<span id="cb24-2336"><a href="#cb24-2336" aria-hidden="true" tabindex="-1"></a><span class="st">                    card.style.display = 'none';</span></span>
<span id="cb24-2337"><a href="#cb24-2337" aria-hidden="true" tabindex="-1"></a><span class="st">                }</span></span>
<span id="cb24-2338"><a href="#cb24-2338" aria-hidden="true" tabindex="-1"></a><span class="st">            });</span></span>
<span id="cb24-2339"><a href="#cb24-2339" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb24-2340"><a href="#cb24-2340" aria-hidden="true" tabindex="-1"></a><span class="st">            updateStats(visible);</span></span>
<span id="cb24-2341"><a href="#cb24-2341" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb24-2342"><a href="#cb24-2342" aria-hidden="true" tabindex="-1"></a><span class="st">            const grid = document.getElementById('conversationsGrid');</span></span>
<span id="cb24-2343"><a href="#cb24-2343" aria-hidden="true" tabindex="-1"></a><span class="st">            const noResults = document.getElementById('no-results-message');</span></span>
<span id="cb24-2344"><a href="#cb24-2344" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb24-2345"><a href="#cb24-2345" aria-hidden="true" tabindex="-1"></a><span class="st">            if (visible === 0) {</span></span>
<span id="cb24-2346"><a href="#cb24-2346" aria-hidden="true" tabindex="-1"></a><span class="st">                if (!noResults) {</span></span>
<span id="cb24-2347"><a href="#cb24-2347" aria-hidden="true" tabindex="-1"></a><span class="st">                    const noResultsMsg = document.createElement('div');</span></span>
<span id="cb24-2348"><a href="#cb24-2348" aria-hidden="true" tabindex="-1"></a><span class="st">                    noResultsMsg.id = 'no-results-message';</span></span>
<span id="cb24-2349"><a href="#cb24-2349" aria-hidden="true" tabindex="-1"></a><span class="st">                    noResultsMsg.className = 'no-results';</span></span>
<span id="cb24-2350"><a href="#cb24-2350" aria-hidden="true" tabindex="-1"></a><span class="st">                    noResultsMsg.innerHTML = 'üîç Nenhuma conversa encontrada. Tente ajustar os filtros ou a pesquisa.';</span></span>
<span id="cb24-2351"><a href="#cb24-2351" aria-hidden="true" tabindex="-1"></a><span class="st">                    grid.appendChild(noResultsMsg);</span></span>
<span id="cb24-2352"><a href="#cb24-2352" aria-hidden="true" tabindex="-1"></a><span class="st">                }</span></span>
<span id="cb24-2353"><a href="#cb24-2353" aria-hidden="true" tabindex="-1"></a><span class="st">            } else if (noResults) {</span></span>
<span id="cb24-2354"><a href="#cb24-2354" aria-hidden="true" tabindex="-1"></a><span class="st">                noResults.remove();</span></span>
<span id="cb24-2355"><a href="#cb24-2355" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb24-2356"><a href="#cb24-2356" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb24-2357"><a href="#cb24-2357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-2358"><a href="#cb24-2358" aria-hidden="true" tabindex="-1"></a><span class="st">        function updateStats(visibleCount = null) {</span></span>
<span id="cb24-2359"><a href="#cb24-2359" aria-hidden="true" tabindex="-1"></a><span class="st">            const totalElement = document.getElementById('total-count');</span></span>
<span id="cb24-2360"><a href="#cb24-2360" aria-hidden="true" tabindex="-1"></a><span class="st">            if (visibleCount !== null) {</span></span>
<span id="cb24-2361"><a href="#cb24-2361" aria-hidden="true" tabindex="-1"></a><span class="st">                totalElement.textContent = visibleCount;</span></span>
<span id="cb24-2362"><a href="#cb24-2362" aria-hidden="true" tabindex="-1"></a><span class="st">            } else {</span></span>
<span id="cb24-2363"><a href="#cb24-2363" aria-hidden="true" tabindex="-1"></a><span class="st">                totalElement.textContent = """</span> <span class="op">+</span> <span class="bu">str</span>(<span class="bu">len</span>(<span class="va">self</span>.all_conversations)) <span class="op">+</span> <span class="st">""";</span></span>
<span id="cb24-2364"><a href="#cb24-2364" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb24-2365"><a href="#cb24-2365" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb24-2366"><a href="#cb24-2366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-2367"><a href="#cb24-2367" aria-hidden="true" tabindex="-1"></a><span class="st">        function openHTML(filename) {</span></span>
<span id="cb24-2368"><a href="#cb24-2368" aria-hidden="true" tabindex="-1"></a><span class="st">            const htmlUrl = 'combined_html/' + filename;</span></span>
<span id="cb24-2369"><a href="#cb24-2369" aria-hidden="true" tabindex="-1"></a><span class="st">            console.log('Abrindo HTML:', htmlUrl);</span></span>
<span id="cb24-2370"><a href="#cb24-2370" aria-hidden="true" tabindex="-1"></a><span class="st">            window.open(htmlUrl, '_blank');</span></span>
<span id="cb24-2371"><a href="#cb24-2371" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb24-2372"><a href="#cb24-2372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-2373"><a href="#cb24-2373" aria-hidden="true" tabindex="-1"></a><span class="st">        function openMD(filename) {</span></span>
<span id="cb24-2374"><a href="#cb24-2374" aria-hidden="true" tabindex="-1"></a><span class="st">            const mdUrl = 'combined_markdown/' + filename;</span></span>
<span id="cb24-2375"><a href="#cb24-2375" aria-hidden="true" tabindex="-1"></a><span class="st">            window.open(mdUrl, '_blank');</span></span>
<span id="cb24-2376"><a href="#cb24-2376" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb24-2377"><a href="#cb24-2377" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb24-2378"><a href="#cb24-2378" aria-hidden="true" tabindex="-1"></a><span class="st">        function openPDF(filename) {</span></span>
<span id="cb24-2379"><a href="#cb24-2379" aria-hidden="true" tabindex="-1"></a><span class="st">            const pdfFile = filename.replace('.html', '.pdf');</span></span>
<span id="cb24-2380"><a href="#cb24-2380" aria-hidden="true" tabindex="-1"></a><span class="st">            const pdfUrl = 'combined_pdfs/' + pdfFile;</span></span>
<span id="cb24-2381"><a href="#cb24-2381" aria-hidden="true" tabindex="-1"></a><span class="st">            window.open(pdfUrl, '_blank');</span></span>
<span id="cb24-2382"><a href="#cb24-2382" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb24-2383"><a href="#cb24-2383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-2384"><a href="#cb24-2384" aria-hidden="true" tabindex="-1"></a><span class="st">        document.addEventListener('keydown', function(e) {</span></span>
<span id="cb24-2385"><a href="#cb24-2385" aria-hidden="true" tabindex="-1"></a><span class="st">            if (e.key === 'Escape') {</span></span>
<span id="cb24-2386"><a href="#cb24-2386" aria-hidden="true" tabindex="-1"></a><span class="st">                document.getElementById('searchInput').value = '';</span></span>
<span id="cb24-2387"><a href="#cb24-2387" aria-hidden="true" tabindex="-1"></a><span class="st">                filterConversations();</span></span>
<span id="cb24-2388"><a href="#cb24-2388" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb24-2389"><a href="#cb24-2389" aria-hidden="true" tabindex="-1"></a><span class="st">        });</span></span>
<span id="cb24-2390"><a href="#cb24-2390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-2391"><a href="#cb24-2391" aria-hidden="true" tabindex="-1"></a><span class="st">        document.querySelectorAll('.conversation-card').forEach(card => {</span></span>
<span id="cb24-2392"><a href="#cb24-2392" aria-hidden="true" tabindex="-1"></a><span class="st">            card.addEventListener('click', function(e) {</span></span>
<span id="cb24-2393"><a href="#cb24-2393" aria-hidden="true" tabindex="-1"></a><span class="st">                if (e.target.closest('.action-btn')) {</span></span>
<span id="cb24-2394"><a href="#cb24-2394" aria-hidden="true" tabindex="-1"></a><span class="st">                    return;</span></span>
<span id="cb24-2395"><a href="#cb24-2395" aria-hidden="true" tabindex="-1"></a><span class="st">                }</span></span>
<span id="cb24-2396"><a href="#cb24-2396" aria-hidden="true" tabindex="-1"></a><span class="st">                </span></span>
<span id="cb24-2397"><a href="#cb24-2397" aria-hidden="true" tabindex="-1"></a><span class="st">                const htmlBtn = this.querySelector('a.html-btn');</span></span>
<span id="cb24-2398"><a href="#cb24-2398" aria-hidden="true" tabindex="-1"></a><span class="st">                if (htmlBtn) {</span></span>
<span id="cb24-2399"><a href="#cb24-2399" aria-hidden="true" tabindex="-1"></a><span class="st">                    const htmlUrl = htmlBtn.getAttribute('href');</span></span>
<span id="cb24-2400"><a href="#cb24-2400" aria-hidden="true" tabindex="-1"></a><span class="st">                    window.open(htmlUrl, '_blank');</span></span>
<span id="cb24-2401"><a href="#cb24-2401" aria-hidden="true" tabindex="-1"></a><span class="st">                }</span></span>
<span id="cb24-2402"><a href="#cb24-2402" aria-hidden="true" tabindex="-1"></a><span class="st">            });</span></span>
<span id="cb24-2403"><a href="#cb24-2403" aria-hidden="true" tabindex="-1"></a><span class="st">        });</span></span>
<span id="cb24-2404"><a href="#cb24-2404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-2405"><a href="#cb24-2405" aria-hidden="true" tabindex="-1"></a><span class="st">        document.getElementById('searchInput').focus();</span></span>
<span id="cb24-2406"><a href="#cb24-2406" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb24-2407"><a href="#cb24-2407" aria-hidden="true" tabindex="-1"></a><span class="st">        console.log('√çndice carregado com', """</span> <span class="op">+</span> <span class="bu">str</span>(<span class="bu">len</span>(<span class="va">self</span>.all_conversations)) <span class="op">+</span> <span class="st">""", 'conversas');</span></span>
<span id="cb24-2408"><a href="#cb24-2408" aria-hidden="true" tabindex="-1"></a><span class="st">    </script></span></span>
<span id="cb24-2409"><a href="#cb24-2409" aria-hidden="true" tabindex="-1"></a><span class="st">
        <script id="fixed-toc-script">
        document.addEventListener('DOMContentLoaded', function() {
            const toc = document.getElementById('TOC');
            if (toc) {
                const tocTitle = toc.querySelector('h2');
                if (tocTitle) {
                    const toggleBtn = document.createElement('button');
                    toggleBtn.innerHTML = '‚ò∞';
                    toggleBtn.className = 'toc-toggle-btn';
                    toggleBtn.title = 'Minimizar/Expandir TOC';
                    let isMinimized = false;
                    toggleBtn.addEventListener('click', function(e) {
                        e.stopPropagation();
                        isMinimized = !isMinimized;
                        if (isMinimized) {
                            toc.classList.add('toc-minimized');
                        } else {
                            toc.classList.remove('toc-minimized');
                        }
                    });
                    tocTitle.appendChild(toggleBtn);
                }
            }
            
            // SCROLLSPY
            const sections = document.querySelectorAll('h1, h2, h3, h4, h5');
            const tocLinks = document.querySelectorAll('#TOC a');
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const id = entry.target.getAttribute('id');
                        tocLinks.forEach(link => {
                            link.classList.remove('active');
                            if (link.getAttribute('href') === '#' + id) {
                                link.classList.add('active');
                            }
                        });
                    }
                });
            }, { 
                rootMargin: '-20% 0px -60% 0px', 
                threshold: 0 
            });
            
            sections.forEach(section => {
                if (section.id) observer.observe(section);
            });
            
            // Scroll suave
            tocLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const targetId = link.getAttribute('href').substring(1);
                    const targetElement = document.getElementById(targetId);
                    if (targetElement) {
                        const offsetTop = targetElement.offsetTop - 80;
                        window.scrollTo({ top: offsetTop, behavior: 'smooth' });
                    }
                });
            });
            
            // BOT√ÉO VOLTAR AO TOPO
            const backToTopBtn = document.createElement('button');
            backToTopBtn.className = 'back-to-top-content';
            backToTopBtn.innerHTML = '‚Üë';
            backToTopBtn.title = 'Voltar ao Topo';
            document.body.appendChild(backToTopBtn);
            
            window.addEventListener('scroll', () => {
                if (window.pageYOffset > 300) {
                    backToTopBtn.classList.add('show');
                } else {
                    backToTopBtn.classList.remove('show');
                }
            });
            
            backToTopBtn.addEventListener('click', () => {
                window.scrollTo({ top: 0, behavior: 'smooth' });
            });
        });
        </script>
        
</body></span></span>
<span id="cb24-2410"><a href="#cb24-2410" aria-hidden="true" tabindex="-1"></a><span class="st"></html></span></span>
<span id="cb24-2411"><a href="#cb24-2411" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb24-2412"><a href="#cb24-2412" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-2413"><a href="#cb24-2413" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> <span class="bu">open</span>(<span class="va">self</span>.index_file, <span class="st">'w'</span>, encoding<span class="op">=</span><span class="st">'utf-8'</span>) <span class="im">as</span> f:</span>
<span id="cb24-2414"><a href="#cb24-2414" aria-hidden="true" tabindex="-1"></a>            f.write(html_content)</span>
<span id="cb24-2415"><a href="#cb24-2415" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.logger.info(<span class="ss">f"‚úÖ √çndice combinado criado: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>index_file<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb24-2416"><a href="#cb24-2416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-2417"><a href="#cb24-2417" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> main():</span>
<span id="cb24-2418"><a href="#cb24-2418" aria-hidden="true" tabindex="-1"></a>    parser <span class="op">=</span> argparse.ArgumentParser(</span>
<span id="cb24-2419"><a href="#cb24-2419" aria-hidden="true" tabindex="-1"></a>        description<span class="op">=</span><span class="st">"Processa exporta√ß√µes combinadas com exporta√ß√£o HTML via Pandoc."</span></span>
<span id="cb24-2420"><a href="#cb24-2420" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb24-2421"><a href="#cb24-2421" aria-hidden="true" tabindex="-1"></a>    parser.add_argument(<span class="st">"--dry-run"</span>, action<span class="op">=</span><span class="st">"store_true"</span>, <span class="bu">help</span><span class="op">=</span><span class="st">"Executa sem salvar arquivos"</span>)</span>
<span id="cb24-2422"><a href="#cb24-2422" aria-hidden="true" tabindex="-1"></a>    parser.add_argument(<span class="st">"--force-overwrite"</span>, action<span class="op">=</span><span class="st">"store_true"</span>, <span class="bu">help</span><span class="op">=</span><span class="st">"Substitui arquivos existentes"</span>)</span>
<span id="cb24-2423"><a href="#cb24-2423" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-2424"><a href="#cb24-2424" aria-hidden="true" tabindex="-1"></a>    args <span class="op">=</span> parser.parse_args()</span>
<span id="cb24-2425"><a href="#cb24-2425" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-2426"><a href="#cb24-2426" aria-hidden="true" tabindex="-1"></a>    system <span class="op">=</span> CombinedFragmentsSystem(</span>
<span id="cb24-2427"><a href="#cb24-2427" aria-hidden="true" tabindex="-1"></a>        dry_run<span class="op">=</span>args.dry_run,</span>
<span id="cb24-2428"><a href="#cb24-2428" aria-hidden="true" tabindex="-1"></a>        force_overwrite<span class="op">=</span>args.force_overwrite</span>
<span id="cb24-2429"><a href="#cb24-2429" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb24-2430"><a href="#cb24-2430" aria-hidden="true" tabindex="-1"></a>    system.run()</span>
<span id="cb24-2431"><a href="#cb24-2431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-2432"><a href="#cb24-2432" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">"__main__"</span>:</span>
<span id="cb24-2433"><a href="#cb24-2433" aria-hidden="true" tabindex="-1"></a>    main()</span></code></pre></div>
<p><strong>Principais corre√ß√µes aplicadas:</strong></p>
<ol type="1">
<li><p><strong>CSS para syntax highlighting do Pandoc</strong>:
Adicionei regras para todas as classes geradas pelo Pandoc
(<code>.sourceCode</code>, <code>.kw</code>, <code>.dt</code>,
<code>.dv</code>, etc.) garantindo cores contrastantes.</p></li>
<li><p><strong>Corre√ß√£o de cores de texto</strong>: For√ßei cores escuras
para texto normal e cores claras para texto em blocos de c√≥digo escuros
usando <code>!important</code> para sobrescrever estilos
problem√°ticos.</p></li>
<li><p><strong>Fallbacks robustos</strong>: Atualizei todos os m√©todos
de convers√£o HTML (<code>_inject_enhanced_css</code>,
<code>_create_enhanced_html_template</code>,
<code>_create_basic_html</code>) com as mesmas corre√ß√µes.</p></li>
<li><p><strong>Contraste garantido</strong>: Assegurei que todo o texto
tenha contraste adequado contra seus fundos, especialmente em blocos de
c√≥digo.</p></li>
</ol>
<p><strong>Teste o script</strong> e verifique se o problema das cores
foi resolvido. Se ainda houver problemas espec√≠ficos em alguns arquivos,
podemos ajustar ainda mais o CSS.</p>
<hr></hr>
<h3 data-number="1.2.5" id="utilizador-2025-11-08-081530-deepseek-reasoner"><span class="header-section-number">1.2.5</span> üë§ Utilizador <em>(2025-11-08
08:15:30)</em> <em>[deepseek-reasoner]</em></h3>
<p>Altera√ß√£o pretendo que seja ‚Äìtoc-depth=2. E pretendo um
comb_fragments_system5_html_export.py, mas agora com o nome:
comb_fragments_system6_html_export.py completo funcional optimizado</p>
<hr></hr>
<h3 data-number="1.2.6" id="deepseek-2025-11-08-081530-deepseek-reasoner"><span class="header-section-number">1.2.6</span> ü§ñ DeepSeek <em>(2025-11-08
08:15:30)</em> <em>[deepseek-reasoner]</em></h3>
<p>Vamos fazer as altera√ß√µes necess√°rias para ajustar o
<code>--toc-depth</code> para 2 e criar uma nova vers√£o do script com o
nome <code>comb_fragments_system6_html_export.py</code>.</p>
<p>Altera√ß√µes: 1. Mudar o <code>--toc-depth</code> de 3 para 2 em todos
os lugares onde √© usado (m√©todos
<code>_convert_with_pandoc_optimized</code> e
<code>_convert_with_pandoc_basic</code>). 2. Renomear a classe para
<code>CombinedFragmentsSystem6</code> para refletir a nova vers√£o?
(Opcional, mas se quisermos manter a consist√™ncia, podemos manter o
mesmo nome da classe, pois o arquivo √© que muda. No entanto, como √© uma
nova vers√£o, podemos deixar o mesmo nome da classe para evitar
complica√ß√µes, mas vou manter a classe com o mesmo nome, pois o c√≥digo √©
essencialmente o mesmo, apenas com a altera√ß√£o do toc-depth e poss√≠veis
melhorias. Mas como o usu√°rio pediu um novo nome de arquivo, vou apenas
salvar o c√≥digo no novo arquivo com a mesma classe, a menos que
queiramos versionar a classe. Vou manter a classe com o mesmo nome para
simplificar.)</p>
<p>No entanto, como o usu√°rio pediu um novo arquivo, vamos simplesmente
salvar o c√≥digo com o novo nome e fazer a altera√ß√£o do
<code>--toc-depth</code> para 2.</p>
<p>Vou percorrer o c√≥digo e alterar todas as inst√¢ncias de
<code>--toc-depth=3</code> para <code>--toc-depth=2</code>.</p>
<p>Al√©m disso, vou atualizar o nome do arquivo no cabe√ßalho do
script.</p>
<p>Vamos gerar o c√≥digo completo do
<code>comb_fragments_system6_html_export.py</code> com as
altera√ß√µes.</p>
<p>Nota: O usu√°rio tamb√©m pediu para otimizar. Vou manter todas as
otimiza√ß√µes j√° existentes e apenas ajustar o toc-depth.</p>
<p>Vamos ao c√≥digo: Aqui est√° o
<code>comb_fragments_system6_html_export.py</code> completo e otimizado
com <code>--toc-depth=2</code> e todas as corre√ß√µes de visibilidade:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># comb_fragments_system6_html_export.py</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> zipfile</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> csv</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> argparse</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sys</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> webbrowser</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> shutil</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tempfile</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> traceback</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> subprocess</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Any, Optional</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> markdown</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> logging</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> CombinedFragmentsSystem:</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, dry_run<span class="op">=</span><span class="va">False</span>, force_overwrite<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.data_dir <span class="op">=</span> Path(<span class="st">"data"</span>)</span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.dry_run <span class="op">=</span> dry_run</span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.force_overwrite <span class="op">=</span> force_overwrite</span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Configurar logging</span></span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>        logging.basicConfig(level<span class="op">=</span>logging.INFO, <span class="bu">format</span><span class="op">=</span><span class="st">'</span><span class="sc">%(asctime)s</span><span class="st"> - </span><span class="sc">%(levelname)s</span><span class="st"> - </span><span class="sc">%(message)s</span><span class="st">'</span>)</span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.logger <span class="op">=</span> logging.getLogger(<span class="va">__name__</span>)</span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Estrutura de pastas organizada</span></span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.output_dirs <span class="op">=</span> {</span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a>            <span class="st">'markdown'</span>: <span class="st">"combined_markdown"</span>,</span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a>            <span class="st">'csv'</span>: <span class="st">"combined_csv"</span>, </span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a>            <span class="st">'json'</span>: <span class="st">"combined_json"</span>,</span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a>            <span class="st">'pdfs'</span>: <span class="st">"combined_pdfs"</span>,</span>
<span id="cb25-36"><a href="#cb25-36" aria-hidden="true" tabindex="-1"></a>            <span class="st">'html'</span>: <span class="st">"combined_html"</span></span>
<span id="cb25-37"><a href="#cb25-37" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb25-38"><a href="#cb25-38" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-39"><a href="#cb25-39" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.single_files <span class="op">=</span> {</span>
<span id="cb25-40"><a href="#cb25-40" aria-hidden="true" tabindex="-1"></a>            <span class="st">'csv'</span>: <span class="st">"combined_all_conversations.csv"</span>,</span>
<span id="cb25-41"><a href="#cb25-41" aria-hidden="true" tabindex="-1"></a>            <span class="st">'json'</span>: <span class="st">"combined_all_conversations.json"</span></span>
<span id="cb25-42"><a href="#cb25-42" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb25-43"><a href="#cb25-43" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-44"><a href="#cb25-44" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.index_file <span class="op">=</span> <span class="st">"index.html"</span></span>
<span id="cb25-45"><a href="#cb25-45" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.all_conversations <span class="op">=</span> []</span>
<span id="cb25-46"><a href="#cb25-46" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-47"><a href="#cb25-47" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Configura√ß√£o de processamento por fonte</span></span>
<span id="cb25-48"><a href="#cb25-48" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.processors <span class="op">=</span> {</span>
<span id="cb25-49"><a href="#cb25-49" aria-hidden="true" tabindex="-1"></a>            <span class="st">'qwen'</span>: {</span>
<span id="cb25-50"><a href="#cb25-50" aria-hidden="true" tabindex="-1"></a>                <span class="st">'file'</span>: <span class="st">"chat-export.json"</span>,</span>
<span id="cb25-51"><a href="#cb25-51" aria-hidden="true" tabindex="-1"></a>                <span class="st">'method'</span>: <span class="va">self</span>.process_qwen_corrected,</span>
<span id="cb25-52"><a href="#cb25-52" aria-hidden="true" tabindex="-1"></a>                <span class="st">'enabled'</span>: <span class="va">True</span></span>
<span id="cb25-53"><a href="#cb25-53" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb25-54"><a href="#cb25-54" aria-hidden="true" tabindex="-1"></a>            <span class="st">'chatgpt'</span>: {</span>
<span id="cb25-55"><a href="#cb25-55" aria-hidden="true" tabindex="-1"></a>                <span class="st">'file'</span>: <span class="st">"chatgpt.zip"</span>, </span>
<span id="cb25-56"><a href="#cb25-56" aria-hidden="true" tabindex="-1"></a>                <span class="st">'method'</span>: <span class="va">self</span>.process_chatgpt,</span>
<span id="cb25-57"><a href="#cb25-57" aria-hidden="true" tabindex="-1"></a>                <span class="st">'enabled'</span>: <span class="va">True</span></span>
<span id="cb25-58"><a href="#cb25-58" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb25-59"><a href="#cb25-59" aria-hidden="true" tabindex="-1"></a>            <span class="st">'deepseek'</span>: {</span>
<span id="cb25-60"><a href="#cb25-60" aria-hidden="true" tabindex="-1"></a>                <span class="st">'file'</span>: <span class="st">"deepseek_data.zip"</span>,</span>
<span id="cb25-61"><a href="#cb25-61" aria-hidden="true" tabindex="-1"></a>                <span class="st">'method'</span>: <span class="va">self</span>.process_deepseek,</span>
<span id="cb25-62"><a href="#cb25-62" aria-hidden="true" tabindex="-1"></a>                <span class="st">'enabled'</span>: <span class="va">True</span></span>
<span id="cb25-63"><a href="#cb25-63" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb25-64"><a href="#cb25-64" aria-hidden="true" tabindex="-1"></a>            <span class="st">'grok'</span>: {</span>
<span id="cb25-65"><a href="#cb25-65" aria-hidden="true" tabindex="-1"></a>                <span class="st">'file'</span>: <span class="st">"grok.zip"</span>,</span>
<span id="cb25-66"><a href="#cb25-66" aria-hidden="true" tabindex="-1"></a>                <span class="st">'method'</span>: <span class="va">self</span>.process_grok,</span>
<span id="cb25-67"><a href="#cb25-67" aria-hidden="true" tabindex="-1"></a>                <span class="st">'enabled'</span>: <span class="va">True</span></span>
<span id="cb25-68"><a href="#cb25-68" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb25-69"><a href="#cb25-69" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb25-70"><a href="#cb25-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-71"><a href="#cb25-71" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> sanitize_filename(<span class="va">self</span>, text: <span class="bu">str</span>, max_len: <span class="bu">int</span> <span class="op">=</span> <span class="dv">50</span>) <span class="op">-></span> <span class="bu">str</span>:</span>
<span id="cb25-72"><a href="#cb25-72" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Sanitiza nomes de arquivo REMOVENDO ESPA√áOS e preservando emojis"""</span></span>
<span id="cb25-73"><a href="#cb25-73" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> text <span class="kw">or</span> <span class="kw">not</span> <span class="bu">isinstance</span>(text, <span class="bu">str</span>):</span>
<span id="cb25-74"><a href="#cb25-74" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">"conversa_sem_titulo"</span></span>
<span id="cb25-75"><a href="#cb25-75" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-76"><a href="#cb25-76" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Remove caracteres inv√°lidos</span></span>
<span id="cb25-77"><a href="#cb25-77" aria-hidden="true" tabindex="-1"></a>        invalid_chars <span class="op">=</span> <span class="vs">r'</span><span class="pp">[<>:"/</span><span class="ch">\\</span><span class="pp">|?*</span><span class="ch">\x00</span><span class="pp">-</span><span class="ch">\x1F\x7F</span><span class="dv">\s</span><span class="pp">]</span><span class="vs">'</span>  <span class="co"># Inclui \s para remover espa√ßos</span></span>
<span id="cb25-78"><a href="#cb25-78" aria-hidden="true" tabindex="-1"></a>        sanitized <span class="op">=</span> re.sub(invalid_chars, <span class="st">'_'</span>, text)  <span class="co"># Substitui espa√ßos por underscores</span></span>
<span id="cb25-79"><a href="#cb25-79" aria-hidden="true" tabindex="-1"></a>        sanitized <span class="op">=</span> re.sub(<span class="vs">r'_</span><span class="op">+</span><span class="vs">'</span>, <span class="st">'_'</span>, sanitized)  <span class="co"># Remove underscores duplicados</span></span>
<span id="cb25-80"><a href="#cb25-80" aria-hidden="true" tabindex="-1"></a>        sanitized <span class="op">=</span> sanitized.strip(<span class="st">'_'</span>)  <span class="co"># Remove underscores no in√≠cio e fim</span></span>
<span id="cb25-81"><a href="#cb25-81" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-82"><a href="#cb25-82" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> sanitized:</span>
<span id="cb25-83"><a href="#cb25-83" aria-hidden="true" tabindex="-1"></a>            sanitized <span class="op">=</span> <span class="st">"conversa_sem_titulo"</span></span>
<span id="cb25-84"><a href="#cb25-84" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-85"><a href="#cb25-85" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Limita o comprimento</span></span>
<span id="cb25-86"><a href="#cb25-86" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(sanitized) <span class="op">></span> max_len:</span>
<span id="cb25-87"><a href="#cb25-87" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Tenta cortar em um ponto l√≥gico (underscore)</span></span>
<span id="cb25-88"><a href="#cb25-88" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="st">'_'</span> <span class="kw">in</span> sanitized[:max_len]:</span>
<span id="cb25-89"><a href="#cb25-89" aria-hidden="true" tabindex="-1"></a>                last_underscore <span class="op">=</span> sanitized[:max_len].rfind(<span class="st">'_'</span>)</span>
<span id="cb25-90"><a href="#cb25-90" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> last_underscore <span class="op">></span> <span class="dv">10</span>:</span>
<span id="cb25-91"><a href="#cb25-91" aria-hidden="true" tabindex="-1"></a>                    sanitized <span class="op">=</span> sanitized[:last_underscore]</span>
<span id="cb25-92"><a href="#cb25-92" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb25-93"><a href="#cb25-93" aria-hidden="true" tabindex="-1"></a>                sanitized <span class="op">=</span> sanitized[:max_len]</span>
<span id="cb25-94"><a href="#cb25-94" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-95"><a href="#cb25-95" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> sanitized</span>
<span id="cb25-96"><a href="#cb25-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-97"><a href="#cb25-97" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> preserve_original_title(<span class="va">self</span>, text: <span class="bu">str</span>) <span class="op">-></span> <span class="bu">str</span>:</span>
<span id="cb25-98"><a href="#cb25-98" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Preserva o t√≠tulo original com espa√ßos, apenas removendo caracteres realmente inv√°lidos"""</span></span>
<span id="cb25-99"><a href="#cb25-99" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> text <span class="kw">or</span> <span class="kw">not</span> <span class="bu">isinstance</span>(text, <span class="bu">str</span>):</span>
<span id="cb25-100"><a href="#cb25-100" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">"Conversa sem t√≠tulo"</span></span>
<span id="cb25-101"><a href="#cb25-101" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-102"><a href="#cb25-102" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Remove apenas caracteres realmente problem√°ticos, mantendo espa√ßos</span></span>
<span id="cb25-103"><a href="#cb25-103" aria-hidden="true" tabindex="-1"></a>        invalid_chars <span class="op">=</span> <span class="vs">r'</span><span class="pp">[<>:"/</span><span class="ch">\\</span><span class="pp">|?*</span><span class="ch">\x00</span><span class="pp">-</span><span class="ch">\x1F\x7F</span><span class="pp">]</span><span class="vs">'</span></span>
<span id="cb25-104"><a href="#cb25-104" aria-hidden="true" tabindex="-1"></a>        sanitized <span class="op">=</span> re.sub(invalid_chars, <span class="st">''</span>, text)</span>
<span id="cb25-105"><a href="#cb25-105" aria-hidden="true" tabindex="-1"></a>        sanitized <span class="op">=</span> re.sub(<span class="vs">r'</span><span class="dv">\s</span><span class="op">+</span><span class="vs">'</span>, <span class="st">' '</span>, sanitized.strip())</span>
<span id="cb25-106"><a href="#cb25-106" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-107"><a href="#cb25-107" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> sanitized:</span>
<span id="cb25-108"><a href="#cb25-108" aria-hidden="true" tabindex="-1"></a>            sanitized <span class="op">=</span> <span class="st">"Conversa sem t√≠tulo"</span></span>
<span id="cb25-109"><a href="#cb25-109" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-110"><a href="#cb25-110" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> sanitized</span>
<span id="cb25-111"><a href="#cb25-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-112"><a href="#cb25-112" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> preserve_special_content(<span class="va">self</span>, content: <span class="bu">str</span>) <span class="op">-></span> <span class="bu">str</span>:</span>
<span id="cb25-113"><a href="#cb25-113" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Preserva f√≥rmulas matem√°ticas, c√≥digo e formata√ß√£o especial"""</span></span>
<span id="cb25-114"><a href="#cb25-114" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> content:</span>
<span id="cb25-115"><a href="#cb25-115" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">""</span></span>
<span id="cb25-116"><a href="#cb25-116" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-117"><a href="#cb25-117" aria-hidden="true" tabindex="-1"></a>        preserved_content <span class="op">=</span> content</span>
<span id="cb25-118"><a href="#cb25-118" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-119"><a href="#cb25-119" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Corrige problemas com barras invertidas em LaTeX</span></span>
<span id="cb25-120"><a href="#cb25-120" aria-hidden="true" tabindex="-1"></a>        latex_corrections <span class="op">=</span> {</span>
<span id="cb25-121"><a href="#cb25-121" aria-hidden="true" tabindex="-1"></a>            <span class="st">'√¢¬ô¬Ärac'</span>: <span class="st">'</span><span class="ch">\\</span><span class="st">frac'</span>,</span>
<span id="cb25-122"><a href="#cb25-122" aria-hidden="true" tabindex="-1"></a>            <span class="st">'√¢¬ô¬Çarepsilon'</span>: <span class="st">'</span><span class="ch">\\</span><span class="st">varepsilon'</span>,</span>
<span id="cb25-123"><a href="#cb25-123" aria-hidden="true" tabindex="-1"></a>            <span class="st">'√¢¬ô¬Ç'</span>: <span class="st">'</span><span class="ch">\\</span><span class="st">'</span>,</span>
<span id="cb25-124"><a href="#cb25-124" aria-hidden="true" tabindex="-1"></a>            <span class="st">'√¢¬ô¬Ä'</span>: <span class="st">'</span><span class="ch">\\</span><span class="st">'</span></span>
<span id="cb25-125"><a href="#cb25-125" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb25-126"><a href="#cb25-126" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-127"><a href="#cb25-127" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> wrong, correct <span class="kw">in</span> latex_corrections.items():</span>
<span id="cb25-128"><a href="#cb25-128" aria-hidden="true" tabindex="-1"></a>            preserved_content <span class="op">=</span> preserved_content.replace(wrong, correct)</span>
<span id="cb25-129"><a href="#cb25-129" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-130"><a href="#cb25-130" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> preserved_content</span>
<span id="cb25-131"><a href="#cb25-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-132"><a href="#cb25-132" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> ensure_directories(<span class="va">self</span>):</span>
<span id="cb25-133"><a href="#cb25-133" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Cria todas as pastas necess√°rias"""</span></span>
<span id="cb25-134"><a href="#cb25-134" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb25-135"><a href="#cb25-135" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="st">"DRY-RUN: Pastas seriam criadas:"</span>)</span>
<span id="cb25-136"><a href="#cb25-136" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> folder <span class="kw">in</span> <span class="va">self</span>.output_dirs.values():</span>
<span id="cb25-137"><a href="#cb25-137" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.info(<span class="ss">f"   </span><span class="sc">{</span>folder<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb25-138"><a href="#cb25-138" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb25-139"><a href="#cb25-139" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-140"><a href="#cb25-140" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> folder <span class="kw">in</span> <span class="va">self</span>.output_dirs.values():</span>
<span id="cb25-141"><a href="#cb25-141" aria-hidden="true" tabindex="-1"></a>            Path(folder).mkdir(parents<span class="op">=</span><span class="va">True</span>, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb25-142"><a href="#cb25-142" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="ss">f"Pasta criada: </span><span class="sc">{</span>folder<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb25-143"><a href="#cb25-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-144"><a href="#cb25-144" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> run(<span class="va">self</span>):</span>
<span id="cb25-145"><a href="#cb25-145" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Executa o processamento completo"""</span></span>
<span id="cb25-146"><a href="#cb25-146" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.logger.info(<span class="st">"SISTEMA COMBINADO DE EXPORTA√á√ïES COM HTML (Qwen3, ChatGPT, DeepSeek, Grok)"</span>)</span>
<span id="cb25-147"><a href="#cb25-147" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.logger.info(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb25-148"><a href="#cb25-148" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-149"><a href="#cb25-149" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.data_dir.exists():</span>
<span id="cb25-150"><a href="#cb25-150" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.error(<span class="ss">f"Pasta '</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>data_dir<span class="sc">}</span><span class="ss">' n√£o encontrada."</span>)</span>
<span id="cb25-151"><a href="#cb25-151" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="st">"Crie a pasta 'data' e coloque os arquivos de exporta√ß√£o:"</span>)</span>
<span id="cb25-152"><a href="#cb25-152" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> source_name, config <span class="kw">in</span> <span class="va">self</span>.processors.items():</span>
<span id="cb25-153"><a href="#cb25-153" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.info(<span class="ss">f"   - </span><span class="sc">{</span>config[<span class="st">'file'</span>]<span class="sc">}</span><span class="ss"> (para </span><span class="sc">{</span>source_name<span class="sc">.</span>upper()<span class="sc">}</span><span class="ss">)"</span>)</span>
<span id="cb25-154"><a href="#cb25-154" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb25-155"><a href="#cb25-155" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-156"><a href="#cb25-156" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.logger.info(<span class="ss">f"Usando pasta de dados: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>data_dir<span class="sc">.</span>absolute()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb25-157"><a href="#cb25-157" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-158"><a href="#cb25-158" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.ensure_directories()</span>
<span id="cb25-159"><a href="#cb25-159" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-160"><a href="#cb25-160" aria-hidden="true" tabindex="-1"></a>        processed_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb25-161"><a href="#cb25-161" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> source_name, config <span class="kw">in</span> <span class="va">self</span>.processors.items():</span>
<span id="cb25-162"><a href="#cb25-162" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> config[<span class="st">'enabled'</span>]:</span>
<span id="cb25-163"><a href="#cb25-163" aria-hidden="true" tabindex="-1"></a>                file_path <span class="op">=</span> <span class="va">self</span>.data_dir <span class="op">/</span> config[<span class="st">'file'</span>]</span>
<span id="cb25-164"><a href="#cb25-164" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> file_path.exists():</span>
<span id="cb25-165"><a href="#cb25-165" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.logger.info(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Processando </span><span class="sc">{</span>source_name<span class="sc">.</span>upper()<span class="sc">}</span><span class="ss">..."</span>)</span>
<span id="cb25-166"><a href="#cb25-166" aria-hidden="true" tabindex="-1"></a>                    config[<span class="st">'method'</span>](file_path)</span>
<span id="cb25-167"><a href="#cb25-167" aria-hidden="true" tabindex="-1"></a>                    processed_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb25-168"><a href="#cb25-168" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb25-169"><a href="#cb25-169" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.logger.warning(<span class="ss">f"</span><span class="sc">{</span>source_name<span class="sc">.</span>upper()<span class="sc">}</span><span class="ss">: arquivo n√£o encontrado - </span><span class="sc">{</span>file_path<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb25-170"><a href="#cb25-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-171"><a href="#cb25-171" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> processed_count <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb25-172"><a href="#cb25-172" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.error(<span class="st">"Nenhum arquivo de exporta√ß√£o encontrado na pasta 'data'."</span>)</span>
<span id="cb25-173"><a href="#cb25-173" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb25-174"><a href="#cb25-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-175"><a href="#cb25-175" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb25-176"><a href="#cb25-176" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.error(<span class="st">"Nenhuma conversa foi extra√≠da dos arquivos."</span>)</span>
<span id="cb25-177"><a href="#cb25-177" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb25-178"><a href="#cb25-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-179"><a href="#cb25-179" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>._post_process_conversations()</span>
<span id="cb25-180"><a href="#cb25-180" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-181"><a href="#cb25-181" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.dry_run:</span>
<span id="cb25-182"><a href="#cb25-182" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>._export_all_formats()</span>
<span id="cb25-183"><a href="#cb25-183" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">üéâ SISTEMA COMBINADO FINALIZADO!"</span>)</span>
<span id="cb25-184"><a href="#cb25-184" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="ss">f"üìÑ √çndice: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>index_file<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb25-185"><a href="#cb25-185" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> Path(<span class="va">self</span>.index_file).exists():</span>
<span id="cb25-186"><a href="#cb25-186" aria-hidden="true" tabindex="-1"></a>                webbrowser.<span class="bu">open</span>(<span class="ss">f'file://</span><span class="sc">{</span>Path(<span class="va">self</span>.index_file)<span class="sc">.</span>absolute()<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb25-187"><a href="#cb25-187" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb25-188"><a href="#cb25-188" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">üîÆ MODO DRY-RUN: Nenhum arquivo foi criado."</span>)</span>
<span id="cb25-189"><a href="#cb25-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-190"><a href="#cb25-190" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _post_process_conversations(<span class="va">self</span>):</span>
<span id="cb25-191"><a href="#cb25-191" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Processamento p√≥s-extra√ß√£o das conversas"""</span></span>
<span id="cb25-192"><a href="#cb25-192" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.all_conversations.sort(</span>
<span id="cb25-193"><a href="#cb25-193" aria-hidden="true" tabindex="-1"></a>            key<span class="op">=</span><span class="kw">lambda</span> x: <span class="va">self</span>.parse_timestamp_for_sorting(</span>
<span id="cb25-194"><a href="#cb25-194" aria-hidden="true" tabindex="-1"></a>                x.get(<span class="st">'updated_at'</span>) <span class="kw">or</span> x.get(<span class="st">'inserted_at'</span>) <span class="kw">or</span> x.get(<span class="st">'created_at'</span>)</span>
<span id="cb25-195"><a href="#cb25-195" aria-hidden="true" tabindex="-1"></a>            ),</span>
<span id="cb25-196"><a href="#cb25-196" aria-hidden="true" tabindex="-1"></a>            reverse<span class="op">=</span><span class="va">True</span></span>
<span id="cb25-197"><a href="#cb25-197" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb25-198"><a href="#cb25-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-199"><a href="#cb25-199" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, conv <span class="kw">in</span> <span class="bu">enumerate</span>(<span class="va">self</span>.all_conversations):</span>
<span id="cb25-200"><a href="#cb25-200" aria-hidden="true" tabindex="-1"></a>            conv[<span class="st">'number'</span>] <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb25-201"><a href="#cb25-201" aria-hidden="true" tabindex="-1"></a>            conv[<span class="st">'category'</span>] <span class="op">=</span> <span class="va">self</span>.categorize_conversation(conv[<span class="st">'title'</span>], conv.get(<span class="st">'summary'</span>, <span class="st">''</span>))</span>
<span id="cb25-202"><a href="#cb25-202" aria-hidden="true" tabindex="-1"></a>            conv.setdefault(<span class="st">'source'</span>, <span class="st">'Desconhecido'</span>)</span>
<span id="cb25-203"><a href="#cb25-203" aria-hidden="true" tabindex="-1"></a>            conv.setdefault(<span class="st">'messages'</span>, [])</span>
<span id="cb25-204"><a href="#cb25-204" aria-hidden="true" tabindex="-1"></a>            conv.setdefault(<span class="st">'summary'</span>, conv[<span class="st">'messages'</span>][<span class="dv">0</span>][<span class="st">'content'</span>][:<span class="dv">100</span>] <span class="op">+</span> <span class="st">"..."</span> <span class="cf">if</span> conv[<span class="st">'messages'</span>] <span class="cf">else</span> <span class="st">"Sem conte√∫do"</span>)</span>
<span id="cb25-205"><a href="#cb25-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-206"><a href="#cb25-206" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.logger.info(<span class="ss">f"üìä Total combinado de conversas: </span><span class="sc">{</span><span class="bu">len</span>(<span class="va">self</span>.all_conversations)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb25-207"><a href="#cb25-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-208"><a href="#cb25-208" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _export_all_formats(<span class="va">self</span>):</span>
<span id="cb25-209"><a href="#cb25-209" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Exporta para todos os formatos"""</span></span>
<span id="cb25-210"><a href="#cb25-210" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.logger.info(<span class="st">"</span><span class="ch">\n</span><span class="st">üîÑ Exportando para formatos..."</span>)</span>
<span id="cb25-211"><a href="#cb25-211" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.save_as_markdown_enhanced()</span>
<span id="cb25-212"><a href="#cb25-212" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.save_as_html_robust()</span>
<span id="cb25-213"><a href="#cb25-213" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.save_as_csv() </span>
<span id="cb25-214"><a href="#cb25-214" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.save_as_json()</span>
<span id="cb25-215"><a href="#cb25-215" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.save_all_to_single_files()</span>
<span id="cb25-216"><a href="#cb25-216" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.create_searchable_index()</span>
<span id="cb25-217"><a href="#cb25-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-218"><a href="#cb25-218" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _get_pandoc_version(<span class="va">self</span>) <span class="op">-></span> Optional[<span class="bu">tuple</span>]:</span>
<span id="cb25-219"><a href="#cb25-219" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Obt√©m a vers√£o do Pandoc para compatibilidade"""</span></span>
<span id="cb25-220"><a href="#cb25-220" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb25-221"><a href="#cb25-221" aria-hidden="true" tabindex="-1"></a>            result <span class="op">=</span> subprocess.run([<span class="st">'pandoc'</span>, <span class="st">'--version'</span>], capture_output<span class="op">=</span><span class="va">True</span>, text<span class="op">=</span><span class="va">True</span>, encoding<span class="op">=</span><span class="st">'utf-8'</span>)</span>
<span id="cb25-222"><a href="#cb25-222" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> result.returncode <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb25-223"><a href="#cb25-223" aria-hidden="true" tabindex="-1"></a>                first_line <span class="op">=</span> result.stdout.split(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)[<span class="dv">0</span>]</span>
<span id="cb25-224"><a href="#cb25-224" aria-hidden="true" tabindex="-1"></a>                version_str <span class="op">=</span> first_line.split()[<span class="dv">1</span>]</span>
<span id="cb25-225"><a href="#cb25-225" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="bu">tuple</span>(<span class="bu">map</span>(<span class="bu">int</span>, version_str.split(<span class="st">'.'</span>)))</span>
<span id="cb25-226"><a href="#cb25-226" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span>:</span>
<span id="cb25-227"><a href="#cb25-227" aria-hidden="true" tabindex="-1"></a>            <span class="cf">pass</span></span>
<span id="cb25-228"><a href="#cb25-228" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb25-229"><a href="#cb25-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-230"><a href="#cb25-230" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _convert_with_pandoc_optimized(<span class="va">self</span>, md_file_path: <span class="bu">str</span>) <span class="op">-></span> Optional[<span class="bu">str</span>]:</span>
<span id="cb25-231"><a href="#cb25-231" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Convers√£o OTIMIZADA com Pandoc usando todas as op√ß√µes avan√ßadas"""</span></span>
<span id="cb25-232"><a href="#cb25-232" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb25-233"><a href="#cb25-233" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="ss">f"üîß Convertendo com Pandoc otimizado: </span><span class="sc">{</span>Path(md_file_path)<span class="sc">.</span>name<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb25-234"><a href="#cb25-234" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-235"><a href="#cb25-235" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Verifica se o arquivo MathJax local existe</span></span>
<span id="cb25-236"><a href="#cb25-236" aria-hidden="true" tabindex="-1"></a>            mathjax_path <span class="op">=</span> Path(<span class="st">"assets/tex-mml-chtml.js"</span>)</span>
<span id="cb25-237"><a href="#cb25-237" aria-hidden="true" tabindex="-1"></a>            mathjax_arg <span class="op">=</span> <span class="ss">f"assets/tex-mml-chtml.js"</span> <span class="cf">if</span> mathjax_path.exists() <span class="cf">else</span> <span class="st">""</span></span>
<span id="cb25-238"><a href="#cb25-238" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-239"><a href="#cb25-239" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Comandos base</span></span>
<span id="cb25-240"><a href="#cb25-240" aria-hidden="true" tabindex="-1"></a>            command <span class="op">=</span> [</span>
<span id="cb25-241"><a href="#cb25-241" aria-hidden="true" tabindex="-1"></a>                <span class="st">'pandoc'</span>, </span>
<span id="cb25-242"><a href="#cb25-242" aria-hidden="true" tabindex="-1"></a>                <span class="bu">str</span>(md_file_path),</span>
<span id="cb25-243"><a href="#cb25-243" aria-hidden="true" tabindex="-1"></a>                <span class="st">'--from'</span>, <span class="st">'markdown+emoji+autolink_bare_uris+tex_math_single_backslash'</span>,</span>
<span id="cb25-244"><a href="#cb25-244" aria-hidden="true" tabindex="-1"></a>                <span class="st">'--to'</span>, <span class="st">'html5'</span>,</span>
<span id="cb25-245"><a href="#cb25-245" aria-hidden="true" tabindex="-1"></a>                <span class="st">'--standalone'</span>,</span>
<span id="cb25-246"><a href="#cb25-246" aria-hidden="true" tabindex="-1"></a>                <span class="st">'--mathjax'</span> <span class="cf">if</span> <span class="kw">not</span> mathjax_path.exists() <span class="cf">else</span> <span class="ss">f'--mathjax=</span><span class="sc">{</span>mathjax_arg<span class="sc">}</span><span class="ss">'</span>,</span>
<span id="cb25-247"><a href="#cb25-247" aria-hidden="true" tabindex="-1"></a>                <span class="st">'--table-of-contents'</span>,</span>
<span id="cb25-248"><a href="#cb25-248" aria-hidden="true" tabindex="-1"></a>                <span class="st">'--toc-depth=2'</span>,  <span class="co"># ALTERADO: de 3 para 2</span></span>
<span id="cb25-249"><a href="#cb25-249" aria-hidden="true" tabindex="-1"></a>                <span class="st">'--number-sections'</span></span>
<span id="cb25-250"><a href="#cb25-250" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb25-251"><a href="#cb25-251" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-252"><a href="#cb25-252" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Verifica vers√£o do Pandoc para recursos avan√ßados</span></span>
<span id="cb25-253"><a href="#cb25-253" aria-hidden="true" tabindex="-1"></a>            pandoc_version <span class="op">=</span> <span class="va">self</span>._get_pandoc_version()</span>
<span id="cb25-254"><a href="#cb25-254" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-255"><a href="#cb25-255" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Adiciona --embed-resources apenas se suportado (Pandoc 2.19+)</span></span>
<span id="cb25-256"><a href="#cb25-256" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> pandoc_version <span class="kw">and</span> pandoc_version <span class="op">>=</span> (<span class="dv">2</span>, <span class="dv">19</span>):</span>
<span id="cb25-257"><a href="#cb25-257" aria-hidden="true" tabindex="-1"></a>                command.append(<span class="st">'--embed-resources'</span>)</span>
<span id="cb25-258"><a href="#cb25-258" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.info(<span class="st">"‚úÖ Usando --embed-resources (Pandoc 2.19+)"</span>)</span>
<span id="cb25-259"><a href="#cb25-259" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb25-260"><a href="#cb25-260" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.info(<span class="st">"‚ÑπÔ∏è  --embed-resources n√£o suportado, usando recursos externos"</span>)</span>
<span id="cb25-261"><a href="#cb25-261" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-262"><a href="#cb25-262" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Adiciona syntax highlighting</span></span>
<span id="cb25-263"><a href="#cb25-263" aria-hidden="true" tabindex="-1"></a>            command.extend([<span class="st">'--syntax-highlighting=pygments'</span>])</span>
<span id="cb25-264"><a href="#cb25-264" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-265"><a href="#cb25-265" aria-hidden="true" tabindex="-1"></a>            result <span class="op">=</span> subprocess.run(</span>
<span id="cb25-266"><a href="#cb25-266" aria-hidden="true" tabindex="-1"></a>                command, </span>
<span id="cb25-267"><a href="#cb25-267" aria-hidden="true" tabindex="-1"></a>                capture_output<span class="op">=</span><span class="va">True</span>, </span>
<span id="cb25-268"><a href="#cb25-268" aria-hidden="true" tabindex="-1"></a>                text<span class="op">=</span><span class="va">True</span>, </span>
<span id="cb25-269"><a href="#cb25-269" aria-hidden="true" tabindex="-1"></a>                encoding<span class="op">=</span><span class="st">'utf-8'</span>, </span>
<span id="cb25-270"><a href="#cb25-270" aria-hidden="true" tabindex="-1"></a>                timeout<span class="op">=</span><span class="dv">180</span></span>
<span id="cb25-271"><a href="#cb25-271" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb25-272"><a href="#cb25-272" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-273"><a href="#cb25-273" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> result.returncode <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb25-274"><a href="#cb25-274" aria-hidden="true" tabindex="-1"></a>                html_content <span class="op">=</span> result.stdout</span>
<span id="cb25-275"><a href="#cb25-275" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb25-276"><a href="#cb25-276" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Aplica otimiza√ß√µes adicionais</span></span>
<span id="cb25-277"><a href="#cb25-277" aria-hidden="true" tabindex="-1"></a>                html_content <span class="op">=</span> <span class="va">self</span>._optimize_html_content(html_content)</span>
<span id="cb25-278"><a href="#cb25-278" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> html_content</span>
<span id="cb25-279"><a href="#cb25-279" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb25-280"><a href="#cb25-280" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.warning(<span class="ss">f"‚ö†Ô∏è Pandoc otimizado falhou, tentando m√©todo b√°sico: </span><span class="sc">{</span>result<span class="sc">.</span>stderr[:<span class="dv">200</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb25-281"><a href="#cb25-281" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="va">self</span>._convert_with_pandoc_basic(md_file_path)</span>
<span id="cb25-282"><a href="#cb25-282" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb25-283"><a href="#cb25-283" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> subprocess.TimeoutExpired:</span>
<span id="cb25-284"><a href="#cb25-284" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.error(<span class="st">"‚ùå Timeout no Pandoc otimizado"</span>)</span>
<span id="cb25-285"><a href="#cb25-285" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">self</span>._convert_with_pandoc_basic(md_file_path)</span>
<span id="cb25-286"><a href="#cb25-286" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb25-287"><a href="#cb25-287" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.error(<span class="ss">f"‚ùå Erro no Pandoc otimizado: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb25-288"><a href="#cb25-288" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">self</span>._convert_with_pandoc_basic(md_file_path)</span>
<span id="cb25-289"><a href="#cb25-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-290"><a href="#cb25-290" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _convert_with_pandoc_basic(<span class="va">self</span>, md_file_path: <span class="bu">str</span>) <span class="op">-></span> Optional[<span class="bu">str</span>]:</span>
<span id="cb25-291"><a href="#cb25-291" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""M√©todo b√°sico de fallback para Pandoc com TOC e numera√ß√£o"""</span></span>
<span id="cb25-292"><a href="#cb25-292" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb25-293"><a href="#cb25-293" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="ss">f"üîß Tentando convers√£o b√°sica: </span><span class="sc">{</span>Path(md_file_path)<span class="sc">.</span>name<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb25-294"><a href="#cb25-294" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-295"><a href="#cb25-295" aria-hidden="true" tabindex="-1"></a>            mathjax_path <span class="op">=</span> Path(<span class="st">"assets/tex-mml-chtml.js"</span>)</span>
<span id="cb25-296"><a href="#cb25-296" aria-hidden="true" tabindex="-1"></a>            mathjax_arg <span class="op">=</span> <span class="ss">f"assets/tex-mml-chtml.js"</span> <span class="cf">if</span> mathjax_path.exists() <span class="cf">else</span> <span class="st">""</span></span>
<span id="cb25-297"><a href="#cb25-297" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-298"><a href="#cb25-298" aria-hidden="true" tabindex="-1"></a>            command <span class="op">=</span> [</span>
<span id="cb25-299"><a href="#cb25-299" aria-hidden="true" tabindex="-1"></a>                <span class="st">'pandoc'</span>, </span>
<span id="cb25-300"><a href="#cb25-300" aria-hidden="true" tabindex="-1"></a>                <span class="bu">str</span>(md_file_path),</span>
<span id="cb25-301"><a href="#cb25-301" aria-hidden="true" tabindex="-1"></a>                <span class="st">'--from'</span>, <span class="st">'markdown'</span>,</span>
<span id="cb25-302"><a href="#cb25-302" aria-hidden="true" tabindex="-1"></a>                <span class="st">'--to'</span>, <span class="st">'html5'</span>,</span>
<span id="cb25-303"><a href="#cb25-303" aria-hidden="true" tabindex="-1"></a>                <span class="st">'--standalone'</span>,</span>
<span id="cb25-304"><a href="#cb25-304" aria-hidden="true" tabindex="-1"></a>                <span class="st">'--table-of-contents'</span>,</span>
<span id="cb25-305"><a href="#cb25-305" aria-hidden="true" tabindex="-1"></a>                <span class="st">'--toc-depth=2'</span>,  <span class="co"># ALTERADO: de 3 para 2</span></span>
<span id="cb25-306"><a href="#cb25-306" aria-hidden="true" tabindex="-1"></a>                <span class="st">'--number-sections'</span>,</span>
<span id="cb25-307"><a href="#cb25-307" aria-hidden="true" tabindex="-1"></a>                <span class="st">'--mathjax'</span> <span class="cf">if</span> <span class="kw">not</span> mathjax_path.exists() <span class="cf">else</span> <span class="ss">f'--mathjax=</span><span class="sc">{</span>mathjax_arg<span class="sc">}</span><span class="ss">'</span></span>
<span id="cb25-308"><a href="#cb25-308" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb25-309"><a href="#cb25-309" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-310"><a href="#cb25-310" aria-hidden="true" tabindex="-1"></a>            result <span class="op">=</span> subprocess.run(</span>
<span id="cb25-311"><a href="#cb25-311" aria-hidden="true" tabindex="-1"></a>                command, </span>
<span id="cb25-312"><a href="#cb25-312" aria-hidden="true" tabindex="-1"></a>                capture_output<span class="op">=</span><span class="va">True</span>, </span>
<span id="cb25-313"><a href="#cb25-313" aria-hidden="true" tabindex="-1"></a>                text<span class="op">=</span><span class="va">True</span>, </span>
<span id="cb25-314"><a href="#cb25-314" aria-hidden="true" tabindex="-1"></a>                encoding<span class="op">=</span><span class="st">'utf-8'</span>, </span>
<span id="cb25-315"><a href="#cb25-315" aria-hidden="true" tabindex="-1"></a>                timeout<span class="op">=</span><span class="dv">120</span></span>
<span id="cb25-316"><a href="#cb25-316" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb25-317"><a href="#cb25-317" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-318"><a href="#cb25-318" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> result.returncode <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb25-319"><a href="#cb25-319" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="va">self</span>._optimize_html_content(result.stdout)</span>
<span id="cb25-320"><a href="#cb25-320" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb25-321"><a href="#cb25-321" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.warning(<span class="ss">f"‚ö†Ô∏è Pandoc b√°sico falhou, usando fallback Python: </span><span class="sc">{</span>result<span class="sc">.</span>stderr[:<span class="dv">200</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb25-322"><a href="#cb25-322" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="va">self</span>._convert_with_fallback(md_file_path)</span>
<span id="cb25-323"><a href="#cb25-323" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb25-324"><a href="#cb25-324" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb25-325"><a href="#cb25-325" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.error(<span class="ss">f"‚ùå Erro no Pandoc b√°sico: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb25-326"><a href="#cb25-326" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">self</span>._convert_with_fallback(md_file_path)</span>
<span id="cb25-327"><a href="#cb25-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-328"><a href="#cb25-328" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _optimize_html_content(<span class="va">self</span>, html_content: <span class="bu">str</span>) <span class="op">-></span> <span class="bu">str</span>:</span>
<span id="cb25-329"><a href="#cb25-329" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Aplica otimiza√ß√µes finais ao conte√∫do HTML"""</span></span>
<span id="cb25-330"><a href="#cb25-330" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Adiciona viewport para responsividade</span></span>
<span id="cb25-331"><a href="#cb25-331" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">'<head>

        <style id="fixed-toc-styles">
        /* === ESTILOS PRINCIPAIS - TOC FIXO √Ä DIREITA === */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
            scroll-behavior: smooth;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            position: relative;
        }
        /* === TOC FIXO √Ä DIREITA - POSI√á√ÉO CORRIGIDA === */
        #TOC {
            position: fixed !important;
            top: 50% !important;
            right: 20px !important;
            transform: translateY(-50%) !important;
            width: 320px !important;
            max-height: 80vh !important;
            overflow-y: auto !important;
            z-index: 1000 !important;
            background: rgba(255, 255, 255, 0.98) !important;
            padding: 20px !important;
            border-radius: 12px !important;
            box-shadow: 0 8px 32px rgba(0,0,0,0.15) !important;
            border: 1px solid #e0e0e0 !important;
            backdrop-filter: blur(10px) !important;
            transition: all 0.3s ease-in-out !important;
        }
        #TOC.toc-minimized {
            transform: translateY(-50%) translateX(calc(320px - 50px)) !important;
            opacity: 0.3;
            width: 50px !important;
            overflow: hidden;
        }
        #TOC.toc-minimized > *:not(.toc-toggle-btn) {
            display: none !important;
        }
        #TOC h2 {
            margin-top: 0;
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
            font-size: 1.2em;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .toc-toggle-btn {
            background: none;
            border: none;
            font-size: 1.2em;
            cursor: pointer;
            padding: 5px;
            border-radius: 4px;
            transition: background-color 0.2s;
        }
        .toc-toggle-btn:hover {
            background-color: rgba(0,0,0,0.1);
        }
        #TOC ul {
            list-style-type: none;
            padding-left: 15px;
            margin: 10px 0;
        }
        #TOC ul ul {
            padding-left: 20px;
        }
        #TOC li {
            margin: 8px 0;
            line-height: 1.4;
        }
        #TOC a {
            text-decoration: none;
            color: #495057;
            font-weight: 500;
            transition: all 0.2s ease;
            display: block;
            padding: 6px 10px;
            border-radius: 6px;
            border-left: 3px solid transparent;
        }
        #TOC a:hover {
            color: #007bff;
            background-color: rgba(0, 123, 255, 0.1);
            border-left-color: #007bff;
        }
        #TOC a.active {
            background-color: #007bff !important;
            color: white !important;
            font-weight: bold;
            border-left-color: #0056b3;
        }
        /* Conte√∫do principal com margem para o TOC */
        .main-content {
            margin-right: calc(320px + 40px) !important;
        }
        /* Barra de scroll personalizada APENAS para TOC */
        #TOC::-webkit-scrollbar {
            width: 8px;
        }
        #TOC::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }
        #TOC::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 4px;
        }
        #TOC::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }
        /* === BOT√ÉO VOLTAR AO TOPO (HTMLs individuais) === */
        .back-to-top-content {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            font-size: 18px;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 999;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .back-to-top-content.show {
            opacity: 1;
            transform: translateY(0);
        }
        .back-to-top-content:hover {
            background: #0056b3;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0,0,0,0.2);
        }
        /* === RESPONSIVIDADE === */
        @media (max-width: 1400px) {
            .container {
                max-width: 95%;
                padding: 30px;
            }
            #TOC {
                width: 280px !important;
            }
            .main-content {
                margin-right: 320px !important;
            }
        }
        @media (max-width: 1200px) {
            #TOC {
                width: 260px !important;
                right: 15px !important;
            }
            .main-content {
                margin-right: 300px !important;
            }
        }
        @media (max-width: 992px) {
            #TOC {
                position: relative !important;
                width: 100% !important;
                right: 0 !important;
                top: 0 !important;
                transform: none !important;
                margin: 20px 0;
                max-height: 300px !important;
            }
            .main-content {
                margin-right: 0 !important;
            }
            .back-to-top-content {
                right: 20px;
                bottom: 20px;
            }
        }
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            .container {
                padding: 20px;
                max-width: 100%;
            }
            #TOC {
                max-height: 250px !important;
                padding: 15px !important;
            }
        }
        </style>
        '</span> <span class="kw">in</span> html_content <span class="kw">and</span> <span class="st">'viewport'</span> <span class="kw">not</span> <span class="kw">in</span> html_content:</span>
<span id="cb25-332"><a href="#cb25-332" aria-hidden="true" tabindex="-1"></a>            viewport_meta <span class="op">=</span> <span class="st">'<meta name="viewport" content="width=device-width, initial-scale=1.0">'</span></span>
<span id="cb25-333"><a href="#cb25-333" aria-hidden="true" tabindex="-1"></a>            html_content <span class="op">=</span> html_content.replace(<span class="st">'<head>

        <style id="fixed-toc-styles">
        /* === ESTILOS PRINCIPAIS - TOC FIXO √Ä DIREITA === */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
            scroll-behavior: smooth;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            position: relative;
        }
        /* === TOC FIXO √Ä DIREITA - POSI√á√ÉO CORRIGIDA === */
        #TOC {
            position: fixed !important;
            top: 50% !important;
            right: 20px !important;
            transform: translateY(-50%) !important;
            width: 320px !important;
            max-height: 80vh !important;
            overflow-y: auto !important;
            z-index: 1000 !important;
            background: rgba(255, 255, 255, 0.98) !important;
            padding: 20px !important;
            border-radius: 12px !important;
            box-shadow: 0 8px 32px rgba(0,0,0,0.15) !important;
            border: 1px solid #e0e0e0 !important;
            backdrop-filter: blur(10px) !important;
            transition: all 0.3s ease-in-out !important;
        }
        #TOC.toc-minimized {
            transform: translateY(-50%) translateX(calc(320px - 50px)) !important;
            opacity: 0.3;
            width: 50px !important;
            overflow: hidden;
        }
        #TOC.toc-minimized > *:not(.toc-toggle-btn) {
            display: none !important;
        }
        #TOC h2 {
            margin-top: 0;
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
            font-size: 1.2em;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .toc-toggle-btn {
            background: none;
            border: none;
            font-size: 1.2em;
            cursor: pointer;
            padding: 5px;
            border-radius: 4px;
            transition: background-color 0.2s;
        }
        .toc-toggle-btn:hover {
            background-color: rgba(0,0,0,0.1);
        }
        #TOC ul {
            list-style-type: none;
            padding-left: 15px;
            margin: 10px 0;
        }
        #TOC ul ul {
            padding-left: 20px;
        }
        #TOC li {
            margin: 8px 0;
            line-height: 1.4;
        }
        #TOC a {
            text-decoration: none;
            color: #495057;
            font-weight: 500;
            transition: all 0.2s ease;
            display: block;
            padding: 6px 10px;
            border-radius: 6px;
            border-left: 3px solid transparent;
        }
        #TOC a:hover {
            color: #007bff;
            background-color: rgba(0, 123, 255, 0.1);
            border-left-color: #007bff;
        }
        #TOC a.active {
            background-color: #007bff !important;
            color: white !important;
            font-weight: bold;
            border-left-color: #0056b3;
        }
        /* Conte√∫do principal com margem para o TOC */
        .main-content {
            margin-right: calc(320px + 40px) !important;
        }
        /* Barra de scroll personalizada APENAS para TOC */
        #TOC::-webkit-scrollbar {
            width: 8px;
        }
        #TOC::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }
        #TOC::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 4px;
        }
        #TOC::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }
        /* === BOT√ÉO VOLTAR AO TOPO (HTMLs individuais) === */
        .back-to-top-content {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            font-size: 18px;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 999;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .back-to-top-content.show {
            opacity: 1;
            transform: translateY(0);
        }
        .back-to-top-content:hover {
            background: #0056b3;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0,0,0,0.2);
        }
        /* === RESPONSIVIDADE === */
        @media (max-width: 1400px) {
            .container {
                max-width: 95%;
                padding: 30px;
            }
            #TOC {
                width: 280px !important;
            }
            .main-content {
                margin-right: 320px !important;
            }
        }
        @media (max-width: 1200px) {
            #TOC {
                width: 260px !important;
                right: 15px !important;
            }
            .main-content {
                margin-right: 300px !important;
            }
        }
        @media (max-width: 992px) {
            #TOC {
                position: relative !important;
                width: 100% !important;
                right: 0 !important;
                top: 0 !important;
                transform: none !important;
                margin: 20px 0;
                max-height: 300px !important;
            }
            .main-content {
                margin-right: 0 !important;
            }
            .back-to-top-content {
                right: 20px;
                bottom: 20px;
            }
        }
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            .container {
                padding: 20px;
                max-width: 100%;
            }
            #TOC {
                max-height: 250px !important;
                padding: 15px !important;
            }
        }
        </style>
        '</span>, <span class="ss">f'<head>

        <style id="fixed-toc-styles">
        /* === ESTILOS PRINCIPAIS - TOC FIXO √Ä DIREITA === */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
            scroll-behavior: smooth;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            position: relative;
        }
        /* === TOC FIXO √Ä DIREITA - POSI√á√ÉO CORRIGIDA === */
        #TOC {
            position: fixed !important;
            top: 50% !important;
            right: 20px !important;
            transform: translateY(-50%) !important;
            width: 320px !important;
            max-height: 80vh !important;
            overflow-y: auto !important;
            z-index: 1000 !important;
            background: rgba(255, 255, 255, 0.98) !important;
            padding: 20px !important;
            border-radius: 12px !important;
            box-shadow: 0 8px 32px rgba(0,0,0,0.15) !important;
            border: 1px solid #e0e0e0 !important;
            backdrop-filter: blur(10px) !important;
            transition: all 0.3s ease-in-out !important;
        }
        #TOC.toc-minimized {
            transform: translateY(-50%) translateX(calc(320px - 50px)) !important;
            opacity: 0.3;
            width: 50px !important;
            overflow: hidden;
        }
        #TOC.toc-minimized > *:not(.toc-toggle-btn) {
            display: none !important;
        }
        #TOC h2 {
            margin-top: 0;
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
            font-size: 1.2em;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .toc-toggle-btn {
            background: none;
            border: none;
            font-size: 1.2em;
            cursor: pointer;
            padding: 5px;
            border-radius: 4px;
            transition: background-color 0.2s;
        }
        .toc-toggle-btn:hover {
            background-color: rgba(0,0,0,0.1);
        }
        #TOC ul {
            list-style-type: none;
            padding-left: 15px;
            margin: 10px 0;
        }
        #TOC ul ul {
            padding-left: 20px;
        }
        #TOC li {
            margin: 8px 0;
            line-height: 1.4;
        }
        #TOC a {
            text-decoration: none;
            color: #495057;
            font-weight: 500;
            transition: all 0.2s ease;
            display: block;
            padding: 6px 10px;
            border-radius: 6px;
            border-left: 3px solid transparent;
        }
        #TOC a:hover {
            color: #007bff;
            background-color: rgba(0, 123, 255, 0.1);
            border-left-color: #007bff;
        }
        #TOC a.active {
            background-color: #007bff !important;
            color: white !important;
            font-weight: bold;
            border-left-color: #0056b3;
        }
        /* Conte√∫do principal com margem para o TOC */
        .main-content {
            margin-right: calc(320px + 40px) !important;
        }
        /* Barra de scroll personalizada APENAS para TOC */
        #TOC::-webkit-scrollbar {
            width: 8px;
        }
        #TOC::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }
        #TOC::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 4px;
        }
        #TOC::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }
        /* === BOT√ÉO VOLTAR AO TOPO (HTMLs individuais) === */
        .back-to-top-content {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            font-size: 18px;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 999;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .back-to-top-content.show {
            opacity: 1;
            transform: translateY(0);
        }
        .back-to-top-content:hover {
            background: #0056b3;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0,0,0,0.2);
        }
        /* === RESPONSIVIDADE === */
        @media (max-width: 1400px) {
            .container {
                max-width: 95%;
                padding: 30px;
            }
            #TOC {
                width: 280px !important;
            }
            .main-content {
                margin-right: 320px !important;
            }
        }
        @media (max-width: 1200px) {
            #TOC {
                width: 260px !important;
                right: 15px !important;
            }
            .main-content {
                margin-right: 300px !important;
            }
        }
        @media (max-width: 992px) {
            #TOC {
                position: relative !important;
                width: 100% !important;
                right: 0 !important;
                top: 0 !important;
                transform: none !important;
                margin: 20px 0;
                max-height: 300px !important;
            }
            .main-content {
                margin-right: 0 !important;
            }
            .back-to-top-content {
                right: 20px;
                bottom: 20px;
            }
        }
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            .container {
                padding: 20px;
                max-width: 100%;
            }
            #TOC {
                max-height: 250px !important;
                padding: 15px !important;
            }
        }
        </style>
        </span><span class="ch">\n</span><span class="ss">    </span><span class="sc">{</span>viewport_meta<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb25-334"><a href="#cb25-334" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-335"><a href="#cb25-335" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Melhora acessibilidade</span></span>
<span id="cb25-336"><a href="#cb25-336" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">'<html'</span> <span class="kw">in</span> html_content <span class="kw">and</span> <span class="st">'lang'</span> <span class="kw">not</span> <span class="kw">in</span> html_content:</span>
<span id="cb25-337"><a href="#cb25-337" aria-hidden="true" tabindex="-1"></a>            html_content <span class="op">=</span> html_content.replace(<span class="st">'<html>'</span>, <span class="st">'<html lang="pt-BR">'</span>)</span>
<span id="cb25-338"><a href="#cb25-338" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-339"><a href="#cb25-339" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Adiciona CSS personalizado para melhorar TOC e numera√ß√£o</span></span>
<span id="cb25-340"><a href="#cb25-340" aria-hidden="true" tabindex="-1"></a>        html_content <span class="op">=</span> <span class="va">self</span>._inject_enhanced_css(html_content)</span>
<span id="cb25-341"><a href="#cb25-341" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-342"><a href="#cb25-342" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Otimiza TOC gerado pelo Pandoc</span></span>
<span id="cb25-343"><a href="#cb25-343" aria-hidden="true" tabindex="-1"></a>        html_content <span class="op">=</span> <span class="va">self</span>._enhance_toc_styling(html_content)</span>
<span id="cb25-344"><a href="#cb25-344" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-345"><a href="#cb25-345" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> html_content</span>
<span id="cb25-346"><a href="#cb25-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-347"><a href="#cb25-347" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _inject_enhanced_css(<span class="va">self</span>, html_content: <span class="bu">str</span>) <span class="op">-></span> <span class="bu">str</span>:</span>
<span id="cb25-348"><a href="#cb25-348" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Injeta CSS personalizado aprimorado para TOC flutuante e layout de tela completa"""</span></span>
<span id="cb25-349"><a href="#cb25-349" aria-hidden="true" tabindex="-1"></a>        enhanced_css <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb25-350"><a href="#cb25-350" aria-hidden="true" tabindex="-1"></a><span class="st">        <style></span></span>
<span id="cb25-351"><a href="#cb25-351" aria-hidden="true" tabindex="-1"></a><span class="st">            /* LAYOUT DE TELA COMPLETA OTIMIZADO */</span></span>
<span id="cb25-352"><a href="#cb25-352" aria-hidden="true" tabindex="-1"></a><span class="st">            body {</span></span>
<span id="cb25-353"><a href="#cb25-353" aria-hidden="true" tabindex="-1"></a><span class="st">                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;</span></span>
<span id="cb25-354"><a href="#cb25-354" aria-hidden="true" tabindex="-1"></a><span class="st">                line-height: 1.6;</span></span>
<span id="cb25-355"><a href="#cb25-355" aria-hidden="true" tabindex="-1"></a><span class="st">                margin: 0;</span></span>
<span id="cb25-356"><a href="#cb25-356" aria-hidden="true" tabindex="-1"></a><span class="st">                padding: 20px;</span></span>
<span id="cb25-357"><a href="#cb25-357" aria-hidden="true" tabindex="-1"></a><span class="st">                background-color: #f5f5f5;</span></span>
<span id="cb25-358"><a href="#cb25-358" aria-hidden="true" tabindex="-1"></a><span class="st">                color: #333;</span></span>
<span id="cb25-359"><a href="#cb25-359" aria-hidden="true" tabindex="-1"></a><span class="st">                max-width: none; /* Remove limita√ß√£o de largura - TELA COMPLETA */</span></span>
<span id="cb25-360"><a href="#cb25-360" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb25-361"><a href="#cb25-361" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb25-362"><a href="#cb25-362" aria-hidden="true" tabindex="-1"></a><span class="st">            .container {</span></span>
<span id="cb25-363"><a href="#cb25-363" aria-hidden="true" tabindex="-1"></a><span class="st">                max-width: 95%; /* Usa quase toda a largura dispon√≠vel */</span></span>
<span id="cb25-364"><a href="#cb25-364" aria-hidden="true" tabindex="-1"></a><span class="st">                margin: 0 auto;</span></span>
<span id="cb25-365"><a href="#cb25-365" aria-hidden="true" tabindex="-1"></a><span class="st">                background: white;</span></span>
<span id="cb25-366"><a href="#cb25-366" aria-hidden="true" tabindex="-1"></a><span class="st">                padding: 40px;</span></span>
<span id="cb25-367"><a href="#cb25-367" aria-hidden="true" tabindex="-1"></a><span class="st">                border-radius: 10px;</span></span>
<span id="cb25-368"><a href="#cb25-368" aria-hidden="true" tabindex="-1"></a><span class="st">                box-shadow: 0 5px 20px rgba(0,0,0,0.1);</span></span>
<span id="cb25-369"><a href="#cb25-369" aria-hidden="true" tabindex="-1"></a><span class="st">                position: relative; /* Para posicionamento do TOC */</span></span>
<span id="cb25-370"><a href="#cb25-370" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb25-371"><a href="#cb25-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-372"><a href="#cb25-372" aria-hidden="true" tabindex="-1"></a><span class="st">            /* TOC FLUTUANTE OTIMIZADO */</span></span>
<span id="cb25-373"><a href="#cb25-373" aria-hidden="true" tabindex="-1"></a><span class="st">            #TOC {</span></span>
<span id="cb25-374"><a href="#cb25-374" aria-hidden="true" tabindex="-1"></a><span class="st">                background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);</span></span>
<span id="cb25-375"><a href="#cb25-375" aria-hidden="true" tabindex="-1"></a><span class="st">                border: 1px solid #dee2e6;</span></span>
<span id="cb25-376"><a href="#cb25-376" aria-hidden="true" tabindex="-1"></a><span class="st">                border-radius: 8px;</span></span>
<span id="cb25-377"><a href="#cb25-377" aria-hidden="true" tabindex="-1"></a><span class="st">                padding: 20px;</span></span>
<span id="cb25-378"><a href="#cb25-378" aria-hidden="true" tabindex="-1"></a><span class="st">                margin: 20px 0;</span></span>
<span id="cb25-379"><a href="#cb25-379" aria-hidden="true" tabindex="-1"></a><span class="st">                box-shadow: 0 2px 10px rgba(0,0,0,0.1);</span></span>
<span id="cb25-380"><a href="#cb25-380" aria-hidden="true" tabindex="-1"></a><span class="st">                float: right; /* FLUTUA √Ä DIREITA */</span></span>
<span id="cb25-381"><a href="#cb25-381" aria-hidden="true" tabindex="-1"></a><span class="st">                width: 320px; /* Largura fixa para TOC */</span></span>
<span id="cb25-382"><a href="#cb25-382" aria-hidden="true" tabindex="-1"></a><span class="st">                margin-left: 30px;</span></span>
<span id="cb25-383"><a href="#cb25-383" aria-hidden="true" tabindex="-1"></a><span class="st">                margin-bottom: 30px;</span></span>
<span id="cb25-384"><a href="#cb25-384" aria-hidden="true" tabindex="-1"></a><span class="st">                position: relative;</span></span>
<span id="cb25-385"><a href="#cb25-385" aria-hidden="true" tabindex="-1"></a><span class="st">                z-index: 100;</span></span>
<span id="cb25-386"><a href="#cb25-386" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb25-387"><a href="#cb25-387" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb25-388"><a href="#cb25-388" aria-hidden="true" tabindex="-1"></a><span class="st">            #TOC ul {</span></span>
<span id="cb25-389"><a href="#cb25-389" aria-hidden="true" tabindex="-1"></a><span class="st">                list-style-type: none;</span></span>
<span id="cb25-390"><a href="#cb25-390" aria-hidden="true" tabindex="-1"></a><span class="st">                padding-left: 15px;</span></span>
<span id="cb25-391"><a href="#cb25-391" aria-hidden="true" tabindex="-1"></a><span class="st">                margin: 10px 0;</span></span>
<span id="cb25-392"><a href="#cb25-392" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb25-393"><a href="#cb25-393" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb25-394"><a href="#cb25-394" aria-hidden="true" tabindex="-1"></a><span class="st">            #TOC ul ul {</span></span>
<span id="cb25-395"><a href="#cb25-395" aria-hidden="true" tabindex="-1"></a><span class="st">                padding-left: 25px;</span></span>
<span id="cb25-396"><a href="#cb25-396" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb25-397"><a href="#cb25-397" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb25-398"><a href="#cb25-398" aria-hidden="true" tabindex="-1"></a><span class="st">            #TOC ul ul ul {</span></span>
<span id="cb25-399"><a href="#cb25-399" aria-hidden="true" tabindex="-1"></a><span class="st">                padding-left: 35px; /* Mais indenta√ß√£o para n√≠vel 3 */</span></span>
<span id="cb25-400"><a href="#cb25-400" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb25-401"><a href="#cb25-401" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb25-402"><a href="#cb25-402" aria-hidden="true" tabindex="-1"></a><span class="st">            #TOC li {</span></span>
<span id="cb25-403"><a href="#cb25-403" aria-hidden="true" tabindex="-1"></a><span class="st">                margin: 8px 0;</span></span>
<span id="cb25-404"><a href="#cb25-404" aria-hidden="true" tabindex="-1"></a><span class="st">                line-height: 1.4;</span></span>
<span id="cb25-405"><a href="#cb25-405" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb25-406"><a href="#cb25-406" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb25-407"><a href="#cb25-407" aria-hidden="true" tabindex="-1"></a><span class="st">            #TOC a {</span></span>
<span id="cb25-408"><a href="#cb25-408" aria-hidden="true" tabindex="-1"></a><span class="st">                text-decoration: none;</span></span>
<span id="cb25-409"><a href="#cb25-409" aria-hidden="true" tabindex="-1"></a><span class="st">                color: #495057;</span></span>
<span id="cb25-410"><a href="#cb25-410" aria-hidden="true" tabindex="-1"></a><span class="st">                font-weight: 500;</span></span>
<span id="cb25-411"><a href="#cb25-411" aria-hidden="true" tabindex="-1"></a><span class="st">                transition: color 0.2s ease;</span></span>
<span id="cb25-412"><a href="#cb25-412" aria-hidden="true" tabindex="-1"></a><span class="st">                display: block;</span></span>
<span id="cb25-413"><a href="#cb25-413" aria-hidden="true" tabindex="-1"></a><span class="st">                padding: 4px 8px;</span></span>
<span id="cb25-414"><a href="#cb25-414" aria-hidden="true" tabindex="-1"></a><span class="st">                border-radius: 4px;</span></span>
<span id="cb25-415"><a href="#cb25-415" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb25-416"><a href="#cb25-416" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb25-417"><a href="#cb25-417" aria-hidden="true" tabindex="-1"></a><span class="st">            #TOC a:hover {</span></span>
<span id="cb25-418"><a href="#cb25-418" aria-hidden="true" tabindex="-1"></a><span class="st">                color: #007bff;</span></span>
<span id="cb25-419"><a href="#cb25-419" aria-hidden="true" tabindex="-1"></a><span class="st">                background-color: rgba(0, 123, 255, 0.1);</span></span>
<span id="cb25-420"><a href="#cb25-420" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb25-421"><a href="#cb25-421" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb25-422"><a href="#cb25-422" aria-hidden="true" tabindex="-1"></a><span class="st">            #TOC > ul > li > a {</span></span>
<span id="cb25-423"><a href="#cb25-423" aria-hidden="true" tabindex="-1"></a><span class="st">                font-weight: 600;</span></span>
<span id="cb25-424"><a href="#cb25-424" aria-hidden="true" tabindex="-1"></a><span class="st">                color: #2c3e50;</span></span>
<span id="cb25-425"><a href="#cb25-425" aria-hidden="true" tabindex="-1"></a><span class="st">                border-left: 3px solid #3498db;</span></span>
<span id="cb25-426"><a href="#cb25-426" aria-hidden="true" tabindex="-1"></a><span class="st">                padding-left: 12px;</span></span>
<span id="cb25-427"><a href="#cb25-427" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb25-428"><a href="#cb25-428" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb25-429"><a href="#cb25-429" aria-hidden="true" tabindex="-1"></a><span class="st">            /* CLEARFIX PARA LAYOUT COM TOC FLUTUANTE */</span></span>
<span id="cb25-430"><a href="#cb25-430" aria-hidden="true" tabindex="-1"></a><span class="st">            .main-content {</span></span>
<span id="cb25-431"><a href="#cb25-431" aria-hidden="true" tabindex="-1"></a><span class="st">                overflow: hidden; /* PREVINE PROBLEMAS COM ELEMENTOS FLUTUANTES */</span></span>
<span id="cb25-432"><a href="#cb25-432" aria-hidden="true" tabindex="-1"></a><span class="st">                position: relative;</span></span>
<span id="cb25-433"><a href="#cb25-433" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb25-434"><a href="#cb25-434" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb25-435"><a href="#cb25-435" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Estilos para numera√ß√£o de se√ß√µes */</span></span>
<span id="cb25-436"><a href="#cb25-436" aria-hidden="true" tabindex="-1"></a><span class="st">            .header-section-number {</span></span>
<span id="cb25-437"><a href="#cb25-437" aria-hidden="true" tabindex="-1"></a><span class="st">                color: #3498db;</span></span>
<span id="cb25-438"><a href="#cb25-438" aria-hidden="true" tabindex="-1"></a><span class="st">                font-weight: bold;</span></span>
<span id="cb25-439"><a href="#cb25-439" aria-hidden="true" tabindex="-1"></a><span class="st">                margin-right: 8px;</span></span>
<span id="cb25-440"><a href="#cb25-440" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb25-441"><a href="#cb25-441" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb25-442"><a href="#cb25-442" aria-hidden="true" tabindex="-1"></a><span class="st">            h1 .header-section-number {</span></span>
<span id="cb25-443"><a href="#cb25-443" aria-hidden="true" tabindex="-1"></a><span class="st">                font-size: 0.9em;</span></span>
<span id="cb25-444"><a href="#cb25-444" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb25-445"><a href="#cb25-445" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb25-446"><a href="#cb25-446" aria-hidden="true" tabindex="-1"></a><span class="st">            h2 .header-section-number {</span></span>
<span id="cb25-447"><a href="#cb25-447" aria-hidden="true" tabindex="-1"></a><span class="st">                font-size: 0.85em;</span></span>
<span id="cb25-448"><a href="#cb25-448" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb25-449"><a href="#cb25-449" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb25-450"><a href="#cb25-450" aria-hidden="true" tabindex="-1"></a><span class="st">            h3 .header-section-number {</span></span>
<span id="cb25-451"><a href="#cb25-451" aria-hidden="true" tabindex="-1"></a><span class="st">                font-size: 0.8em;</span></span>
<span id="cb25-452"><a href="#cb25-452" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb25-453"><a href="#cb25-453" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb25-454"><a href="#cb25-454" aria-hidden="true" tabindex="-1"></a><span class="st">            /* CORRE√á√ÉO CR√çTICA: Syntax highlighting do Pandoc */</span></span>
<span id="cb25-455"><a href="#cb25-455" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode { </span></span>
<span id="cb25-456"><a href="#cb25-456" aria-hidden="true" tabindex="-1"></a><span class="st">                background: #2d2d2d !important; </span></span>
<span id="cb25-457"><a href="#cb25-457" aria-hidden="true" tabindex="-1"></a><span class="st">                color: #f8f8f2 !important;</span></span>
<span id="cb25-458"><a href="#cb25-458" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb25-459"><a href="#cb25-459" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb25-460"><a href="#cb25-460" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Garantir que TODO o texto dentro de pre/code seja vis√≠vel */</span></span>
<span id="cb25-461"><a href="#cb25-461" aria-hidden="true" tabindex="-1"></a><span class="st">            pre, code, .sourceCode, .sourceCode pre, .sourceCode code {</span></span>
<span id="cb25-462"><a href="#cb25-462" aria-hidden="true" tabindex="-1"></a><span class="st">                color: #f8f8f2 !important;</span></span>
<span id="cb25-463"><a href="#cb25-463" aria-hidden="true" tabindex="-1"></a><span class="st">                background-color: #2d2d2d !important;</span></span>
<span id="cb25-464"><a href="#cb25-464" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb25-465"><a href="#cb25-465" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb25-466"><a href="#cb25-466" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Corre√ß√£o para spans de syntax highlighting */</span></span>
<span id="cb25-467"><a href="#cb25-467" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode .kw { color: #ff79c6 !important; } /* keywords */</span></span>
<span id="cb25-468"><a href="#cb25-468" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode .dt { color: #8be9fd !important; } /* types */</span></span>
<span id="cb25-469"><a href="#cb25-469" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode .dv { color: #bd93f9 !important; } /* values */</span></span>
<span id="cb25-470"><a href="#cb25-470" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode .bn { color: #bd93f9 !important; } /* numbers */</span></span>
<span id="cb25-471"><a href="#cb25-471" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode .fl { color: #bd93f9 !important; } /* floats */</span></span>
<span id="cb25-472"><a href="#cb25-472" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode .ch { color: #f1fa8c !important; } /* chars */</span></span>
<span id="cb25-473"><a href="#cb25-473" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode .st { color: #f1fa8c !important; } /* strings */</span></span>
<span id="cb25-474"><a href="#cb25-474" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode .co { color: #6272a4 !important; } /* comments */</span></span>
<span id="cb25-475"><a href="#cb25-475" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode .ot { color: #50fa7b !important; } /* other */</span></span>
<span id="cb25-476"><a href="#cb25-476" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode .al { color: #ff5555 !important; } /* alerts */</span></span>
<span id="cb25-477"><a href="#cb25-477" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode .fu { color: #50fa7b !important; } /* functions */</span></span>
<span id="cb25-478"><a href="#cb25-478" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode .re { color: #f1fa8c !important; } /* regex */</span></span>
<span id="cb25-479"><a href="#cb25-479" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode .er { color: #ff5555 !important; } /* errors */</span></span>
<span id="cb25-480"><a href="#cb25-480" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb25-481"><a href="#cb25-481" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Garantir que texto normal em blocos de c√≥digo seja vis√≠vel */</span></span>
<span id="cb25-482"><a href="#cb25-482" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode span {</span></span>
<span id="cb25-483"><a href="#cb25-483" aria-hidden="true" tabindex="-1"></a><span class="st">                color: #f8f8f2 !important;</span></span>
<span id="cb25-484"><a href="#cb25-484" aria-hidden="true" tabindex="-1"></a><span class="st">                background: transparent !important;</span></span>
<span id="cb25-485"><a href="#cb25-485" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb25-486"><a href="#cb25-486" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb25-487"><a href="#cb25-487" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Fallback para qualquer elemento de c√≥digo n√£o estilizado */</span></span>
<span id="cb25-488"><a href="#cb25-488" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode * {</span></span>
<span id="cb25-489"><a href="#cb25-489" aria-hidden="true" tabindex="-1"></a><span class="st">                color: inherit !important;</span></span>
<span id="cb25-490"><a href="#cb25-490" aria-hidden="true" tabindex="-1"></a><span class="st">                background: transparent !important;</span></span>
<span id="cb25-491"><a href="#cb25-491" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb25-492"><a href="#cb25-492" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb25-493"><a href="#cb25-493" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Corre√ß√£o adicional para blocos de c√≥digo gerais */</span></span>
<span id="cb25-494"><a href="#cb25-494" aria-hidden="true" tabindex="-1"></a><span class="st">            div.sourceCode {</span></span>
<span id="cb25-495"><a href="#cb25-495" aria-hidden="true" tabindex="-1"></a><span class="st">                border-left: 4px solid #3498db;</span></span>
<span id="cb25-496"><a href="#cb25-496" aria-hidden="true" tabindex="-1"></a><span class="st">                background: #2d2d2d !important;</span></span>
<span id="cb25-497"><a href="#cb25-497" aria-hidden="true" tabindex="-1"></a><span class="st">                color: #f8f8f2 !important;</span></span>
<span id="cb25-498"><a href="#cb25-498" aria-hidden="true" tabindex="-1"></a><span class="st">                margin: 1.5em 0;</span></span>
<span id="cb25-499"><a href="#cb25-499" aria-hidden="true" tabindex="-1"></a><span class="st">                border-radius: 8px;</span></span>
<span id="cb25-500"><a href="#cb25-500" aria-hidden="true" tabindex="-1"></a><span class="st">                overflow: hidden;</span></span>
<span id="cb25-501"><a href="#cb25-501" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb25-502"><a href="#cb25-502" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb25-503"><a href="#cb25-503" aria-hidden="true" tabindex="-1"></a><span class="st">            div.sourceCode pre {</span></span>
<span id="cb25-504"><a href="#cb25-504" aria-hidden="true" tabindex="-1"></a><span class="st">                margin: 0;</span></span>
<span id="cb25-505"><a href="#cb25-505" aria-hidden="true" tabindex="-1"></a><span class="st">                padding: 20px;</span></span>
<span id="cb25-506"><a href="#cb25-506" aria-hidden="true" tabindex="-1"></a><span class="st">                background: transparent !important;</span></span>
<span id="cb25-507"><a href="#cb25-507" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb25-508"><a href="#cb25-508" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb25-509"><a href="#cb25-509" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Melhorar contraste para texto normal em todas as situa√ß√µes */</span></span>
<span id="cb25-510"><a href="#cb25-510" aria-hidden="true" tabindex="-1"></a><span class="st">            body, .container, .main-content {</span></span>
<span id="cb25-511"><a href="#cb25-511" aria-hidden="true" tabindex="-1"></a><span class="st">                color: #2c3e50 !important;</span></span>
<span id="cb25-512"><a href="#cb25-512" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb25-513"><a href="#cb25-513" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb25-514"><a href="#cb25-514" aria-hidden="true" tabindex="-1"></a><span class="st">            p, li, td, th, div, span {</span></span>
<span id="cb25-515"><a href="#cb25-515" aria-hidden="true" tabindex="-1"></a><span class="st">                color: #2c3e50 !important;</span></span>
<span id="cb25-516"><a href="#cb25-516" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb25-517"><a href="#cb25-517" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb25-518"><a href="#cb25-518" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Garantir que links sejam vis√≠veis */</span></span>
<span id="cb25-519"><a href="#cb25-519" aria-hidden="true" tabindex="-1"></a><span class="st">            a {</span></span>
<span id="cb25-520"><a href="#cb25-520" aria-hidden="true" tabindex="-1"></a><span class="st">                color: #3498db !important;</span></span>
<span id="cb25-521"><a href="#cb25-521" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb25-522"><a href="#cb25-522" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb25-523"><a href="#cb25-523" aria-hidden="true" tabindex="-1"></a><span class="st">            a:hover {</span></span>
<span id="cb25-524"><a href="#cb25-524" aria-hidden="true" tabindex="-1"></a><span class="st">                color: #2980b9 !important;</span></span>
<span id="cb25-525"><a href="#cb25-525" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb25-526"><a href="#cb25-526" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb25-527"><a href="#cb25-527" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Corre√ß√£o para elementos MathJax */</span></span>
<span id="cb25-528"><a href="#cb25-528" aria-hidden="true" tabindex="-1"></a><span class="st">            .math, .math display, mjx-container {</span></span>
<span id="cb25-529"><a href="#cb25-529" aria-hidden="true" tabindex="-1"></a><span class="st">                color: #2c3e50 !important;</span></span>
<span id="cb25-530"><a href="#cb25-530" aria-hidden="true" tabindex="-1"></a><span class="st">                background: transparent !important;</span></span>
<span id="cb25-531"><a href="#cb25-531" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb25-532"><a href="#cb25-532" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb25-533"><a href="#cb25-533" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Melhorias para c√≥digo e matem√°tica */</span></span>
<span id="cb25-534"><a href="#cb25-534" aria-hidden="true" tabindex="-1"></a><span class="st">            .math { display: block; text-align: center; margin: 1.5em 0; }</span></span>
<span id="cb25-535"><a href="#cb25-535" aria-hidden="true" tabindex="-1"></a><span class="st">            .math inline { display: inline-block; }</span></span>
<span id="cb25-536"><a href="#cb25-536" aria-hidden="true" tabindex="-1"></a><span class="st">            pre { </span></span>
<span id="cb25-537"><a href="#cb25-537" aria-hidden="true" tabindex="-1"></a><span class="st">                border-left: 4px solid #3498db; </span></span>
<span id="cb25-538"><a href="#cb25-538" aria-hidden="true" tabindex="-1"></a><span class="st">                background: #2d2d2d !important; </span></span>
<span id="cb25-539"><a href="#cb25-539" aria-hidden="true" tabindex="-1"></a><span class="st">                color: #f8f8f2 !important;</span></span>
<span id="cb25-540"><a href="#cb25-540" aria-hidden="true" tabindex="-1"></a><span class="st">                padding: 20px;</span></span>
<span id="cb25-541"><a href="#cb25-541" aria-hidden="true" tabindex="-1"></a><span class="st">                border-radius: 8px;</span></span>
<span id="cb25-542"><a href="#cb25-542" aria-hidden="true" tabindex="-1"></a><span class="st">                overflow-x: auto;</span></span>
<span id="cb25-543"><a href="#cb25-543" aria-hidden="true" tabindex="-1"></a><span class="st">                font-family: 'Consolas', 'Monaco', 'Courier New', monospace;</span></span>
<span id="cb25-544"><a href="#cb25-544" aria-hidden="true" tabindex="-1"></a><span class="st">                line-height: 1.4;</span></span>
<span id="cb25-545"><a href="#cb25-545" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb25-546"><a href="#cb25-546" aria-hidden="true" tabindex="-1"></a><span class="st">            code { </span></span>
<span id="cb25-547"><a href="#cb25-547" aria-hidden="true" tabindex="-1"></a><span class="st">                background: #e9ecef !important; </span></span>
<span id="cb25-548"><a href="#cb25-548" aria-hidden="true" tabindex="-1"></a><span class="st">                padding: 0.2em 0.4em; </span></span>
<span id="cb25-549"><a href="#cb25-549" aria-hidden="true" tabindex="-1"></a><span class="st">                border-radius: 3px;</span></span>
<span id="cb25-550"><a href="#cb25-550" aria-hidden="true" tabindex="-1"></a><span class="st">                font-family: 'Consolas', 'Monaco', 'Courier New', monospace;</span></span>
<span id="cb25-551"><a href="#cb25-551" aria-hidden="true" tabindex="-1"></a><span class="st">                color: #c7254e !important;</span></span>
<span id="cb25-552"><a href="#cb25-552" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb25-553"><a href="#cb25-553" aria-hidden="true" tabindex="-1"></a><span class="st">            pre code { </span></span>
<span id="cb25-554"><a href="#cb25-554" aria-hidden="true" tabindex="-1"></a><span class="st">                background: none !important; </span></span>
<span id="cb25-555"><a href="#cb25-555" aria-hidden="true" tabindex="-1"></a><span class="st">                color: inherit !important; </span></span>
<span id="cb25-556"><a href="#cb25-556" aria-hidden="true" tabindex="-1"></a><span class="st">                padding: 0 !important; </span></span>
<span id="cb25-557"><a href="#cb25-557" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb25-558"><a href="#cb25-558" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb25-559"><a href="#cb25-559" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Melhorias responsivas */</span></span>
<span id="cb25-560"><a href="#cb25-560" aria-hidden="true" tabindex="-1"></a><span class="st">            @media (max-width: 1400px) {</span></span>
<span id="cb25-561"><a href="#cb25-561" aria-hidden="true" tabindex="-1"></a><span class="st">                .container {</span></span>
<span id="cb25-562"><a href="#cb25-562" aria-hidden="true" tabindex="-1"></a><span class="st">                    max-width: 98%;</span></span>
<span id="cb25-563"><a href="#cb25-563" aria-hidden="true" tabindex="-1"></a><span class="st">                    padding: 30px;</span></span>
<span id="cb25-564"><a href="#cb25-564" aria-hidden="true" tabindex="-1"></a><span class="st">                }</span></span>
<span id="cb25-565"><a href="#cb25-565" aria-hidden="true" tabindex="-1"></a><span class="st">                #TOC {</span></span>
<span id="cb25-566"><a href="#cb25-566" aria-hidden="true" tabindex="-1"></a><span class="st">                    width: 280px; /* Reduz um pouco em telas menores */</span></span>
<span id="cb25-567"><a href="#cb25-567" aria-hidden="true" tabindex="-1"></a><span class="st">                }</span></span>
<span id="cb25-568"><a href="#cb25-568" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb25-569"><a href="#cb25-569" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb25-570"><a href="#cb25-570" aria-hidden="true" tabindex="-1"></a><span class="st">            @media (max-width: 1200px) {</span></span>
<span id="cb25-571"><a href="#cb25-571" aria-hidden="true" tabindex="-1"></a><span class="st">                #TOC {</span></span>
<span id="cb25-572"><a href="#cb25-572" aria-hidden="true" tabindex="-1"></a><span class="st">                    float: none;</span></span>
<span id="cb25-573"><a href="#cb25-573" aria-hidden="true" tabindex="-1"></a><span class="st">                    width: auto;</span></span>
<span id="cb25-574"><a href="#cb25-574" aria-hidden="true" tabindex="-1"></a><span class="st">                    margin: 20px 0;</span></span>
<span id="cb25-575"><a href="#cb25-575" aria-hidden="true" tabindex="-1"></a><span class="st">                    position: static;</span></span>
<span id="cb25-576"><a href="#cb25-576" aria-hidden="true" tabindex="-1"></a><span class="st">                }</span></span>
<span id="cb25-577"><a href="#cb25-577" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb25-578"><a href="#cb25-578" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb25-579"><a href="#cb25-579" aria-hidden="true" tabindex="-1"></a><span class="st">            @media (max-width: 768px) {</span></span>
<span id="cb25-580"><a href="#cb25-580" aria-hidden="true" tabindex="-1"></a><span class="st">                body { padding: 10px; font-size: 14px; }</span></span>
<span id="cb25-581"><a href="#cb25-581" aria-hidden="true" tabindex="-1"></a><span class="st">                .container { padding: 20px; max-width: 100%; }</span></span>
<span id="cb25-582"><a href="#cb25-582" aria-hidden="true" tabindex="-1"></a><span class="st">                pre { font-size: 12px; padding: 15px; }</span></span>
<span id="cb25-583"><a href="#cb25-583" aria-hidden="true" tabindex="-1"></a><span class="st">                #TOC { padding: 15px; }</span></span>
<span id="cb25-584"><a href="#cb25-584" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb25-585"><a href="#cb25-585" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb25-586"><a href="#cb25-586" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Melhorias para tabelas */</span></span>
<span id="cb25-587"><a href="#cb25-587" aria-hidden="true" tabindex="-1"></a><span class="st">            table { </span></span>
<span id="cb25-588"><a href="#cb25-588" aria-hidden="true" tabindex="-1"></a><span class="st">                width: 100%; </span></span>
<span id="cb25-589"><a href="#cb25-589" aria-hidden="true" tabindex="-1"></a><span class="st">                border-collapse: collapse; </span></span>
<span id="cb25-590"><a href="#cb25-590" aria-hidden="true" tabindex="-1"></a><span class="st">                margin: 1.5em 0;</span></span>
<span id="cb25-591"><a href="#cb25-591" aria-hidden="true" tabindex="-1"></a><span class="st">                box-shadow: 0 2px 5px rgba(0,0,0,0.1);</span></span>
<span id="cb25-592"><a href="#cb25-592" aria-hidden="true" tabindex="-1"></a><span class="st">                border-radius: 8px;</span></span>
<span id="cb25-593"><a href="#cb25-593" aria-hidden="true" tabindex="-1"></a><span class="st">                overflow: hidden;</span></span>
<span id="cb25-594"><a href="#cb25-594" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb25-595"><a href="#cb25-595" aria-hidden="true" tabindex="-1"></a><span class="st">            th, td { </span></span>
<span id="cb25-596"><a href="#cb25-596" aria-hidden="true" tabindex="-1"></a><span class="st">                border: 1px solid #dee2e6; </span></span>
<span id="cb25-597"><a href="#cb25-597" aria-hidden="true" tabindex="-1"></a><span class="st">                padding: 12px 15px; </span></span>
<span id="cb25-598"><a href="#cb25-598" aria-hidden="true" tabindex="-1"></a><span class="st">                text-align: left; </span></span>
<span id="cb25-599"><a href="#cb25-599" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb25-600"><a href="#cb25-600" aria-hidden="true" tabindex="-1"></a><span class="st">            th { </span></span>
<span id="cb25-601"><a href="#cb25-601" aria-hidden="true" tabindex="-1"></a><span class="st">                background: linear-gradient(135deg, #3498db, #2980b9);</span></span>
<span id="cb25-602"><a href="#cb25-602" aria-hidden="true" tabindex="-1"></a><span class="st">                color: white; </span></span>
<span id="cb25-603"><a href="#cb25-603" aria-hidden="true" tabindex="-1"></a><span class="st">                font-weight: bold;</span></span>
<span id="cb25-604"><a href="#cb25-604" aria-hidden="true" tabindex="-1"></a><span class="st">                text-transform: uppercase;</span></span>
<span id="cb25-605"><a href="#cb25-605" aria-hidden="true" tabindex="-1"></a><span class="st">                font-size: 0.9em;</span></span>
<span id="cb25-606"><a href="#cb25-606" aria-hidden="true" tabindex="-1"></a><span class="st">                letter-spacing: 0.5px;</span></span>
<span id="cb25-607"><a href="#cb25-607" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb25-608"><a href="#cb25-608" aria-hidden="true" tabindex="-1"></a><span class="st">            tr:nth-child(even) { </span></span>
<span id="cb25-609"><a href="#cb25-609" aria-hidden="true" tabindex="-1"></a><span class="st">                background-color: #f8f9fa; </span></span>
<span id="cb25-610"><a href="#cb25-610" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb25-611"><a href="#cb25-611" aria-hidden="true" tabindex="-1"></a><span class="st">            tr:hover { </span></span>
<span id="cb25-612"><a href="#cb25-612" aria-hidden="true" tabindex="-1"></a><span class="st">                background-color: #e3f2fd; </span></span>
<span id="cb25-613"><a href="#cb25-613" aria-hidden="true" tabindex="-1"></a><span class="st">                transition: background-color 0.2s ease;</span></span>
<span id="cb25-614"><a href="#cb25-614" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb25-615"><a href="#cb25-615" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb25-616"><a href="#cb25-616" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Melhorias para blocos de cita√ß√£o */</span></span>
<span id="cb25-617"><a href="#cb25-617" aria-hidden="true" tabindex="-1"></a><span class="st">            blockquote { </span></span>
<span id="cb25-618"><a href="#cb25-618" aria-hidden="true" tabindex="-1"></a><span class="st">                border-left: 4px solid #3498db; </span></span>
<span id="cb25-619"><a href="#cb25-619" aria-hidden="true" tabindex="-1"></a><span class="st">                margin: 25px 0; </span></span>
<span id="cb25-620"><a href="#cb25-620" aria-hidden="true" tabindex="-1"></a><span class="st">                padding-left: 25px; </span></span>
<span id="cb25-621"><a href="#cb25-621" aria-hidden="true" tabindex="-1"></a><span class="st">                color: #7f8c8d;</span></span>
<span id="cb25-622"><a href="#cb25-622" aria-hidden="true" tabindex="-1"></a><span class="st">                font-style: italic;</span></span>
<span id="cb25-623"><a href="#cb25-623" aria-hidden="true" tabindex="-1"></a><span class="st">                background: #f8f9fa;</span></span>
<span id="cb25-624"><a href="#cb25-624" aria-hidden="true" tabindex="-1"></a><span class="st">                padding: 20px;</span></span>
<span id="cb25-625"><a href="#cb25-625" aria-hidden="true" tabindex="-1"></a><span class="st">                border-radius: 0 8px 8px 0;</span></span>
<span id="cb25-626"><a href="#cb25-626" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb25-627"><a href="#cb25-627" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb25-628"><a href="#cb25-628" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Cabe√ßalhos com numera√ß√£o */</span></span>
<span id="cb25-629"><a href="#cb25-629" aria-hidden="true" tabindex="-1"></a><span class="st">            h1, h2, h3, h4, h5 { </span></span>
<span id="cb25-630"><a href="#cb25-630" aria-hidden="true" tabindex="-1"></a><span class="st">                color: #2c3e50 !important; </span></span>
<span id="cb25-631"><a href="#cb25-631" aria-hidden="true" tabindex="-1"></a><span class="st">                margin-top: 1.8em;</span></span>
<span id="cb25-632"><a href="#cb25-632" aria-hidden="true" tabindex="-1"></a><span class="st">                border-bottom: 1px solid #e9ecef;</span></span>
<span id="cb25-633"><a href="#cb25-633" aria-hidden="true" tabindex="-1"></a><span class="st">                padding-bottom: 0.5em;</span></span>
<span id="cb25-634"><a href="#cb25-634" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb25-635"><a href="#cb25-635" aria-hidden="true" tabindex="-1"></a><span class="st">            h1 { </span></span>
<span id="cb25-636"><a href="#cb25-636" aria-hidden="true" tabindex="-1"></a><span class="st">                border-bottom: 3px solid #3498db; </span></span>
<span id="cb25-637"><a href="#cb25-637" aria-hidden="true" tabindex="-1"></a><span class="st">                padding-bottom: 15px; </span></span>
<span id="cb25-638"><a href="#cb25-638" aria-hidden="true" tabindex="-1"></a><span class="st">                color: #2c3e50 !important;</span></span>
<span id="cb25-639"><a href="#cb25-639" aria-hidden="true" tabindex="-1"></a><span class="st">                font-size: 2.2em;</span></span>
<span id="cb25-640"><a href="#cb25-640" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb25-641"><a href="#cb25-641" aria-hidden="true" tabindex="-1"></a><span class="st">            h2 {</span></span>
<span id="cb25-642"><a href="#cb25-642" aria-hidden="true" tabindex="-1"></a><span class="st">                border-left: 4px solid #3498db;</span></span>
<span id="cb25-643"><a href="#cb25-643" aria-hidden="true" tabindex="-1"></a><span class="st">                padding-left: 15px;</span></span>
<span id="cb25-644"><a href="#cb25-644" aria-hidden="true" tabindex="-1"></a><span class="st">                margin-top: 2em;</span></span>
<span id="cb25-645"><a href="#cb25-645" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb25-646"><a href="#cb25-646" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb25-647"><a href="#cb25-647" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Scroll suave para links do TOC */</span></span>
<span id="cb25-648"><a href="#cb25-648" aria-hidden="true" tabindex="-1"></a><span class="st">            html {</span></span>
<span id="cb25-649"><a href="#cb25-649" aria-hidden="true" tabindex="-1"></a><span class="st">                scroll-behavior: smooth;</span></span>
<span id="cb25-650"><a href="#cb25-650" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb25-651"><a href="#cb25-651" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb25-652"><a href="#cb25-652" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Estilo para quando o TOC √© muito grande */</span></span>
<span id="cb25-653"><a href="#cb25-653" aria-hidden="true" tabindex="-1"></a><span class="st">            #TOC:has(ul ul ul ul) {</span></span>
<span id="cb25-654"><a href="#cb25-654" aria-hidden="true" tabindex="-1"></a><span class="st">                max-height: 80vh;</span></span>
<span id="cb25-655"><a href="#cb25-655" aria-hidden="true" tabindex="-1"></a><span class="st">                overflow-y: auto;</span></span>
<span id="cb25-656"><a href="#cb25-656" aria-hidden="true" tabindex="-1"></a><span class="st">                position: sticky;</span></span>
<span id="cb25-657"><a href="#cb25-657" aria-hidden="true" tabindex="-1"></a><span class="st">                top: 20px;</span></span>
<span id="cb25-658"><a href="#cb25-658" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb25-659"><a href="#cb25-659" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb25-660"><a href="#cb25-660" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Indicador visual para se√ß√£o ativa no TOC */</span></span>
<span id="cb25-661"><a href="#cb25-661" aria-hidden="true" tabindex="-1"></a><span class="st">            #TOC a.active {</span></span>
<span id="cb25-662"><a href="#cb25-662" aria-hidden="true" tabindex="-1"></a><span class="st">                background-color: #007bff;</span></span>
<span id="cb25-663"><a href="#cb25-663" aria-hidden="true" tabindex="-1"></a><span class="st">                color: white;</span></span>
<span id="cb25-664"><a href="#cb25-664" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb25-665"><a href="#cb25-665" aria-hidden="true" tabindex="-1"></a><span class="st">        </style></span></span>
<span id="cb25-666"><a href="#cb25-666" aria-hidden="true" tabindex="-1"></a><span class="st">        """</span></span>
<span id="cb25-667"><a href="#cb25-667" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-668"><a href="#cb25-668" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">'</head>'</span> <span class="kw">in</span> html_content:</span>
<span id="cb25-669"><a href="#cb25-669" aria-hidden="true" tabindex="-1"></a>            html_content <span class="op">=</span> html_content.replace(<span class="st">'</head>'</span>, <span class="ss">f'</span><span class="sc">{</span>enhanced_css<span class="sc">}</span><span class="ch">\n</span><span class="ss"></head>'</span>)</span>
<span id="cb25-670"><a href="#cb25-670" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="st">'<head>

        <style id="fixed-toc-styles">
        /* === ESTILOS PRINCIPAIS - TOC FIXO √Ä DIREITA === */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
            scroll-behavior: smooth;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            position: relative;
        }
        /* === TOC FIXO √Ä DIREITA - POSI√á√ÉO CORRIGIDA === */
        #TOC {
            position: fixed !important;
            top: 50% !important;
            right: 20px !important;
            transform: translateY(-50%) !important;
            width: 320px !important;
            max-height: 80vh !important;
            overflow-y: auto !important;
            z-index: 1000 !important;
            background: rgba(255, 255, 255, 0.98) !important;
            padding: 20px !important;
            border-radius: 12px !important;
            box-shadow: 0 8px 32px rgba(0,0,0,0.15) !important;
            border: 1px solid #e0e0e0 !important;
            backdrop-filter: blur(10px) !important;
            transition: all 0.3s ease-in-out !important;
        }
        #TOC.toc-minimized {
            transform: translateY(-50%) translateX(calc(320px - 50px)) !important;
            opacity: 0.3;
            width: 50px !important;
            overflow: hidden;
        }
        #TOC.toc-minimized > *:not(.toc-toggle-btn) {
            display: none !important;
        }
        #TOC h2 {
            margin-top: 0;
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
            font-size: 1.2em;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .toc-toggle-btn {
            background: none;
            border: none;
            font-size: 1.2em;
            cursor: pointer;
            padding: 5px;
            border-radius: 4px;
            transition: background-color 0.2s;
        }
        .toc-toggle-btn:hover {
            background-color: rgba(0,0,0,0.1);
        }
        #TOC ul {
            list-style-type: none;
            padding-left: 15px;
            margin: 10px 0;
        }
        #TOC ul ul {
            padding-left: 20px;
        }
        #TOC li {
            margin: 8px 0;
            line-height: 1.4;
        }
        #TOC a {
            text-decoration: none;
            color: #495057;
            font-weight: 500;
            transition: all 0.2s ease;
            display: block;
            padding: 6px 10px;
            border-radius: 6px;
            border-left: 3px solid transparent;
        }
        #TOC a:hover {
            color: #007bff;
            background-color: rgba(0, 123, 255, 0.1);
            border-left-color: #007bff;
        }
        #TOC a.active {
            background-color: #007bff !important;
            color: white !important;
            font-weight: bold;
            border-left-color: #0056b3;
        }
        /* Conte√∫do principal com margem para o TOC */
        .main-content {
            margin-right: calc(320px + 40px) !important;
        }
        /* Barra de scroll personalizada APENAS para TOC */
        #TOC::-webkit-scrollbar {
            width: 8px;
        }
        #TOC::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }
        #TOC::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 4px;
        }
        #TOC::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }
        /* === BOT√ÉO VOLTAR AO TOPO (HTMLs individuais) === */
        .back-to-top-content {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            font-size: 18px;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 999;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .back-to-top-content.show {
            opacity: 1;
            transform: translateY(0);
        }
        .back-to-top-content:hover {
            background: #0056b3;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0,0,0,0.2);
        }
        /* === RESPONSIVIDADE === */
        @media (max-width: 1400px) {
            .container {
                max-width: 95%;
                padding: 30px;
            }
            #TOC {
                width: 280px !important;
            }
            .main-content {
                margin-right: 320px !important;
            }
        }
        @media (max-width: 1200px) {
            #TOC {
                width: 260px !important;
                right: 15px !important;
            }
            .main-content {
                margin-right: 300px !important;
            }
        }
        @media (max-width: 992px) {
            #TOC {
                position: relative !important;
                width: 100% !important;
                right: 0 !important;
                top: 0 !important;
                transform: none !important;
                margin: 20px 0;
                max-height: 300px !important;
            }
            .main-content {
                margin-right: 0 !important;
            }
            .back-to-top-content {
                right: 20px;
                bottom: 20px;
            }
        }
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            .container {
                padding: 20px;
                max-width: 100%;
            }
            #TOC {
                max-height: 250px !important;
                padding: 15px !important;
            }
        }
        </style>
        '</span> <span class="kw">in</span> html_content:</span>
<span id="cb25-671"><a href="#cb25-671" aria-hidden="true" tabindex="-1"></a>            html_content <span class="op">=</span> html_content.replace(<span class="st">'<head>

        <style id="fixed-toc-styles">
        /* === ESTILOS PRINCIPAIS - TOC FIXO √Ä DIREITA === */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
            scroll-behavior: smooth;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            position: relative;
        }
        /* === TOC FIXO √Ä DIREITA - POSI√á√ÉO CORRIGIDA === */
        #TOC {
            position: fixed !important;
            top: 50% !important;
            right: 20px !important;
            transform: translateY(-50%) !important;
            width: 320px !important;
            max-height: 80vh !important;
            overflow-y: auto !important;
            z-index: 1000 !important;
            background: rgba(255, 255, 255, 0.98) !important;
            padding: 20px !important;
            border-radius: 12px !important;
            box-shadow: 0 8px 32px rgba(0,0,0,0.15) !important;
            border: 1px solid #e0e0e0 !important;
            backdrop-filter: blur(10px) !important;
            transition: all 0.3s ease-in-out !important;
        }
        #TOC.toc-minimized {
            transform: translateY(-50%) translateX(calc(320px - 50px)) !important;
            opacity: 0.3;
            width: 50px !important;
            overflow: hidden;
        }
        #TOC.toc-minimized > *:not(.toc-toggle-btn) {
            display: none !important;
        }
        #TOC h2 {
            margin-top: 0;
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
            font-size: 1.2em;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .toc-toggle-btn {
            background: none;
            border: none;
            font-size: 1.2em;
            cursor: pointer;
            padding: 5px;
            border-radius: 4px;
            transition: background-color 0.2s;
        }
        .toc-toggle-btn:hover {
            background-color: rgba(0,0,0,0.1);
        }
        #TOC ul {
            list-style-type: none;
            padding-left: 15px;
            margin: 10px 0;
        }
        #TOC ul ul {
            padding-left: 20px;
        }
        #TOC li {
            margin: 8px 0;
            line-height: 1.4;
        }
        #TOC a {
            text-decoration: none;
            color: #495057;
            font-weight: 500;
            transition: all 0.2s ease;
            display: block;
            padding: 6px 10px;
            border-radius: 6px;
            border-left: 3px solid transparent;
        }
        #TOC a:hover {
            color: #007bff;
            background-color: rgba(0, 123, 255, 0.1);
            border-left-color: #007bff;
        }
        #TOC a.active {
            background-color: #007bff !important;
            color: white !important;
            font-weight: bold;
            border-left-color: #0056b3;
        }
        /* Conte√∫do principal com margem para o TOC */
        .main-content {
            margin-right: calc(320px + 40px) !important;
        }
        /* Barra de scroll personalizada APENAS para TOC */
        #TOC::-webkit-scrollbar {
            width: 8px;
        }
        #TOC::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }
        #TOC::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 4px;
        }
        #TOC::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }
        /* === BOT√ÉO VOLTAR AO TOPO (HTMLs individuais) === */
        .back-to-top-content {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            font-size: 18px;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 999;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .back-to-top-content.show {
            opacity: 1;
            transform: translateY(0);
        }
        .back-to-top-content:hover {
            background: #0056b3;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0,0,0,0.2);
        }
        /* === RESPONSIVIDADE === */
        @media (max-width: 1400px) {
            .container {
                max-width: 95%;
                padding: 30px;
            }
            #TOC {
                width: 280px !important;
            }
            .main-content {
                margin-right: 320px !important;
            }
        }
        @media (max-width: 1200px) {
            #TOC {
                width: 260px !important;
                right: 15px !important;
            }
            .main-content {
                margin-right: 300px !important;
            }
        }
        @media (max-width: 992px) {
            #TOC {
                position: relative !important;
                width: 100% !important;
                right: 0 !important;
                top: 0 !important;
                transform: none !important;
                margin: 20px 0;
                max-height: 300px !important;
            }
            .main-content {
                margin-right: 0 !important;
            }
            .back-to-top-content {
                right: 20px;
                bottom: 20px;
            }
        }
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            .container {
                padding: 20px;
                max-width: 100%;
            }
            #TOC {
                max-height: 250px !important;
                padding: 15px !important;
            }
        }
        </style>
        '</span>, <span class="ss">f'<head>

        <style id="fixed-toc-styles">
        /* === ESTILOS PRINCIPAIS - TOC FIXO √Ä DIREITA === */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
            scroll-behavior: smooth;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            position: relative;
        }
        /* === TOC FIXO √Ä DIREITA - POSI√á√ÉO CORRIGIDA === */
        #TOC {
            position: fixed !important;
            top: 50% !important;
            right: 20px !important;
            transform: translateY(-50%) !important;
            width: 320px !important;
            max-height: 80vh !important;
            overflow-y: auto !important;
            z-index: 1000 !important;
            background: rgba(255, 255, 255, 0.98) !important;
            padding: 20px !important;
            border-radius: 12px !important;
            box-shadow: 0 8px 32px rgba(0,0,0,0.15) !important;
            border: 1px solid #e0e0e0 !important;
            backdrop-filter: blur(10px) !important;
            transition: all 0.3s ease-in-out !important;
        }
        #TOC.toc-minimized {
            transform: translateY(-50%) translateX(calc(320px - 50px)) !important;
            opacity: 0.3;
            width: 50px !important;
            overflow: hidden;
        }
        #TOC.toc-minimized > *:not(.toc-toggle-btn) {
            display: none !important;
        }
        #TOC h2 {
            margin-top: 0;
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
            font-size: 1.2em;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .toc-toggle-btn {
            background: none;
            border: none;
            font-size: 1.2em;
            cursor: pointer;
            padding: 5px;
            border-radius: 4px;
            transition: background-color 0.2s;
        }
        .toc-toggle-btn:hover {
            background-color: rgba(0,0,0,0.1);
        }
        #TOC ul {
            list-style-type: none;
            padding-left: 15px;
            margin: 10px 0;
        }
        #TOC ul ul {
            padding-left: 20px;
        }
        #TOC li {
            margin: 8px 0;
            line-height: 1.4;
        }
        #TOC a {
            text-decoration: none;
            color: #495057;
            font-weight: 500;
            transition: all 0.2s ease;
            display: block;
            padding: 6px 10px;
            border-radius: 6px;
            border-left: 3px solid transparent;
        }
        #TOC a:hover {
            color: #007bff;
            background-color: rgba(0, 123, 255, 0.1);
            border-left-color: #007bff;
        }
        #TOC a.active {
            background-color: #007bff !important;
            color: white !important;
            font-weight: bold;
            border-left-color: #0056b3;
        }
        /* Conte√∫do principal com margem para o TOC */
        .main-content {
            margin-right: calc(320px + 40px) !important;
        }
        /* Barra de scroll personalizada APENAS para TOC */
        #TOC::-webkit-scrollbar {
            width: 8px;
        }
        #TOC::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }
        #TOC::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 4px;
        }
        #TOC::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }
        /* === BOT√ÉO VOLTAR AO TOPO (HTMLs individuais) === */
        .back-to-top-content {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            font-size: 18px;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 999;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .back-to-top-content.show {
            opacity: 1;
            transform: translateY(0);
        }
        .back-to-top-content:hover {
            background: #0056b3;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0,0,0,0.2);
        }
        /* === RESPONSIVIDADE === */
        @media (max-width: 1400px) {
            .container {
                max-width: 95%;
                padding: 30px;
            }
            #TOC {
                width: 280px !important;
            }
            .main-content {
                margin-right: 320px !important;
            }
        }
        @media (max-width: 1200px) {
            #TOC {
                width: 260px !important;
                right: 15px !important;
            }
            .main-content {
                margin-right: 300px !important;
            }
        }
        @media (max-width: 992px) {
            #TOC {
                position: relative !important;
                width: 100% !important;
                right: 0 !important;
                top: 0 !important;
                transform: none !important;
                margin: 20px 0;
                max-height: 300px !important;
            }
            .main-content {
                margin-right: 0 !important;
            }
            .back-to-top-content {
                right: 20px;
                bottom: 20px;
            }
        }
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            .container {
                padding: 20px;
                max-width: 100%;
            }
            #TOC {
                max-height: 250px !important;
                padding: 15px !important;
            }
        }
        </style>
        </span><span class="ch">\n</span><span class="sc">{</span>enhanced_css<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb25-672"><a href="#cb25-672" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb25-673"><a href="#cb25-673" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="st">'<body>'</span> <span class="kw">in</span> html_content:</span>
<span id="cb25-674"><a href="#cb25-674" aria-hidden="true" tabindex="-1"></a>                html_content <span class="op">=</span> html_content.replace(<span class="st">'<body>'</span>, <span class="ss">f'<head>

        <style id="fixed-toc-styles">
        /* === ESTILOS PRINCIPAIS - TOC FIXO √Ä DIREITA === */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
            scroll-behavior: smooth;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            position: relative;
        }
        /* === TOC FIXO √Ä DIREITA - POSI√á√ÉO CORRIGIDA === */
        #TOC {
            position: fixed !important;
            top: 50% !important;
            right: 20px !important;
            transform: translateY(-50%) !important;
            width: 320px !important;
            max-height: 80vh !important;
            overflow-y: auto !important;
            z-index: 1000 !important;
            background: rgba(255, 255, 255, 0.98) !important;
            padding: 20px !important;
            border-radius: 12px !important;
            box-shadow: 0 8px 32px rgba(0,0,0,0.15) !important;
            border: 1px solid #e0e0e0 !important;
            backdrop-filter: blur(10px) !important;
            transition: all 0.3s ease-in-out !important;
        }
        #TOC.toc-minimized {
            transform: translateY(-50%) translateX(calc(320px - 50px)) !important;
            opacity: 0.3;
            width: 50px !important;
            overflow: hidden;
        }
        #TOC.toc-minimized > *:not(.toc-toggle-btn) {
            display: none !important;
        }
        #TOC h2 {
            margin-top: 0;
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
            font-size: 1.2em;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .toc-toggle-btn {
            background: none;
            border: none;
            font-size: 1.2em;
            cursor: pointer;
            padding: 5px;
            border-radius: 4px;
            transition: background-color 0.2s;
        }
        .toc-toggle-btn:hover {
            background-color: rgba(0,0,0,0.1);
        }
        #TOC ul {
            list-style-type: none;
            padding-left: 15px;
            margin: 10px 0;
        }
        #TOC ul ul {
            padding-left: 20px;
        }
        #TOC li {
            margin: 8px 0;
            line-height: 1.4;
        }
        #TOC a {
            text-decoration: none;
            color: #495057;
            font-weight: 500;
            transition: all 0.2s ease;
            display: block;
            padding: 6px 10px;
            border-radius: 6px;
            border-left: 3px solid transparent;
        }
        #TOC a:hover {
            color: #007bff;
            background-color: rgba(0, 123, 255, 0.1);
            border-left-color: #007bff;
        }
        #TOC a.active {
            background-color: #007bff !important;
            color: white !important;
            font-weight: bold;
            border-left-color: #0056b3;
        }
        /* Conte√∫do principal com margem para o TOC */
        .main-content {
            margin-right: calc(320px + 40px) !important;
        }
        /* Barra de scroll personalizada APENAS para TOC */
        #TOC::-webkit-scrollbar {
            width: 8px;
        }
        #TOC::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }
        #TOC::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 4px;
        }
        #TOC::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }
        /* === BOT√ÉO VOLTAR AO TOPO (HTMLs individuais) === */
        .back-to-top-content {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            font-size: 18px;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 999;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .back-to-top-content.show {
            opacity: 1;
            transform: translateY(0);
        }
        .back-to-top-content:hover {
            background: #0056b3;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0,0,0,0.2);
        }
        /* === RESPONSIVIDADE === */
        @media (max-width: 1400px) {
            .container {
                max-width: 95%;
                padding: 30px;
            }
            #TOC {
                width: 280px !important;
            }
            .main-content {
                margin-right: 320px !important;
            }
        }
        @media (max-width: 1200px) {
            #TOC {
                width: 260px !important;
                right: 15px !important;
            }
            .main-content {
                margin-right: 300px !important;
            }
        }
        @media (max-width: 992px) {
            #TOC {
                position: relative !important;
                width: 100% !important;
                right: 0 !important;
                top: 0 !important;
                transform: none !important;
                margin: 20px 0;
                max-height: 300px !important;
            }
            .main-content {
                margin-right: 0 !important;
            }
            .back-to-top-content {
                right: 20px;
                bottom: 20px;
            }
        }
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            .container {
                padding: 20px;
                max-width: 100%;
            }
            #TOC {
                max-height: 250px !important;
                padding: 15px !important;
            }
        }
        </style>
        </span><span class="ch">\n</span><span class="sc">{</span>enhanced_css<span class="sc">}</span><span class="ch">\n</span><span class="ss"></head></span><span class="ch">\n</span><span class="ss"><body>'</span>)</span>
<span id="cb25-675"><a href="#cb25-675" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb25-676"><a href="#cb25-676" aria-hidden="true" tabindex="-1"></a>                html_content <span class="op">=</span> <span class="ss">f'<head>

        <style id="fixed-toc-styles">
        /* === ESTILOS PRINCIPAIS - TOC FIXO √Ä DIREITA === */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
            scroll-behavior: smooth;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            position: relative;
        }
        /* === TOC FIXO √Ä DIREITA - POSI√á√ÉO CORRIGIDA === */
        #TOC {
            position: fixed !important;
            top: 50% !important;
            right: 20px !important;
            transform: translateY(-50%) !important;
            width: 320px !important;
            max-height: 80vh !important;
            overflow-y: auto !important;
            z-index: 1000 !important;
            background: rgba(255, 255, 255, 0.98) !important;
            padding: 20px !important;
            border-radius: 12px !important;
            box-shadow: 0 8px 32px rgba(0,0,0,0.15) !important;
            border: 1px solid #e0e0e0 !important;
            backdrop-filter: blur(10px) !important;
            transition: all 0.3s ease-in-out !important;
        }
        #TOC.toc-minimized {
            transform: translateY(-50%) translateX(calc(320px - 50px)) !important;
            opacity: 0.3;
            width: 50px !important;
            overflow: hidden;
        }
        #TOC.toc-minimized > *:not(.toc-toggle-btn) {
            display: none !important;
        }
        #TOC h2 {
            margin-top: 0;
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
            font-size: 1.2em;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .toc-toggle-btn {
            background: none;
            border: none;
            font-size: 1.2em;
            cursor: pointer;
            padding: 5px;
            border-radius: 4px;
            transition: background-color 0.2s;
        }
        .toc-toggle-btn:hover {
            background-color: rgba(0,0,0,0.1);
        }
        #TOC ul {
            list-style-type: none;
            padding-left: 15px;
            margin: 10px 0;
        }
        #TOC ul ul {
            padding-left: 20px;
        }
        #TOC li {
            margin: 8px 0;
            line-height: 1.4;
        }
        #TOC a {
            text-decoration: none;
            color: #495057;
            font-weight: 500;
            transition: all 0.2s ease;
            display: block;
            padding: 6px 10px;
            border-radius: 6px;
            border-left: 3px solid transparent;
        }
        #TOC a:hover {
            color: #007bff;
            background-color: rgba(0, 123, 255, 0.1);
            border-left-color: #007bff;
        }
        #TOC a.active {
            background-color: #007bff !important;
            color: white !important;
            font-weight: bold;
            border-left-color: #0056b3;
        }
        /* Conte√∫do principal com margem para o TOC */
        .main-content {
            margin-right: calc(320px + 40px) !important;
        }
        /* Barra de scroll personalizada APENAS para TOC */
        #TOC::-webkit-scrollbar {
            width: 8px;
        }
        #TOC::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }
        #TOC::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 4px;
        }
        #TOC::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }
        /* === BOT√ÉO VOLTAR AO TOPO (HTMLs individuais) === */
        .back-to-top-content {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            font-size: 18px;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 999;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .back-to-top-content.show {
            opacity: 1;
            transform: translateY(0);
        }
        .back-to-top-content:hover {
            background: #0056b3;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0,0,0,0.2);
        }
        /* === RESPONSIVIDADE === */
        @media (max-width: 1400px) {
            .container {
                max-width: 95%;
                padding: 30px;
            }
            #TOC {
                width: 280px !important;
            }
            .main-content {
                margin-right: 320px !important;
            }
        }
        @media (max-width: 1200px) {
            #TOC {
                width: 260px !important;
                right: 15px !important;
            }
            .main-content {
                margin-right: 300px !important;
            }
        }
        @media (max-width: 992px) {
            #TOC {
                position: relative !important;
                width: 100% !important;
                right: 0 !important;
                top: 0 !important;
                transform: none !important;
                margin: 20px 0;
                max-height: 300px !important;
            }
            .main-content {
                margin-right: 0 !important;
            }
            .back-to-top-content {
                right: 20px;
                bottom: 20px;
            }
        }
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            .container {
                padding: 20px;
                max-width: 100%;
            }
            #TOC {
                max-height: 250px !important;
                padding: 15px !important;
            }
        }
        </style>
        </span><span class="ch">\n</span><span class="sc">{</span>enhanced_css<span class="sc">}</span><span class="ch">\n</span><span class="ss"></head></span><span class="ch">\n</span><span class="ss"><body></span><span class="ch">\n</span><span class="sc">{</span>html_content<span class="sc">}</span><span class="ch">\n</span><span class="ss">
        <script id="fixed-toc-script">
        document.addEventListener('DOMContentLoaded', function() {
            const toc = document.getElementById('TOC');
            if (toc) {
                const tocTitle = toc.querySelector('h2');
                if (tocTitle) {
                    const toggleBtn = document.createElement('button');
                    toggleBtn.innerHTML = '‚ò∞';
                    toggleBtn.className = 'toc-toggle-btn';
                    toggleBtn.title = 'Minimizar/Expandir TOC';
                    let isMinimized = false;
                    toggleBtn.addEventListener('click', function(e) {
                        e.stopPropagation();
                        isMinimized = !isMinimized;
                        if (isMinimized) {
                            toc.classList.add('toc-minimized');
                        } else {
                            toc.classList.remove('toc-minimized');
                        }
                    });
                    tocTitle.appendChild(toggleBtn);
                }
            }
            
            // SCROLLSPY
            const sections = document.querySelectorAll('h1, h2, h3, h4, h5');
            const tocLinks = document.querySelectorAll('#TOC a');
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const id = entry.target.getAttribute('id');
                        tocLinks.forEach(link => {
                            link.classList.remove('active');
                            if (link.getAttribute('href') === '#' + id) {
                                link.classList.add('active');
                            }
                        });
                    }
                });
            }, { 
                rootMargin: '-20% 0px -60% 0px', 
                threshold: 0 
            });
            
            sections.forEach(section => {
                if (section.id) observer.observe(section);
            });
            
            // Scroll suave
            tocLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const targetId = link.getAttribute('href').substring(1);
                    const targetElement = document.getElementById(targetId);
                    if (targetElement) {
                        const offsetTop = targetElement.offsetTop - 80;
                        window.scrollTo({ top: offsetTop, behavior: 'smooth' });
                    }
                });
            });
            
            // BOT√ÉO VOLTAR AO TOPO
            const backToTopBtn = document.createElement('button');
            backToTopBtn.className = 'back-to-top-content';
            backToTopBtn.innerHTML = '‚Üë';
            backToTopBtn.title = 'Voltar ao Topo';
            document.body.appendChild(backToTopBtn);
            
            window.addEventListener('scroll', () => {
                if (window.pageYOffset > 300) {
                    backToTopBtn.classList.add('show');
                } else {
                    backToTopBtn.classList.remove('show');
                }
            });
            
            backToTopBtn.addEventListener('click', () => {
                window.scrollTo({ top: 0, behavior: 'smooth' });
            });
        });
        </script>
        
</body>'</span></span>
<span id="cb25-677"><a href="#cb25-677" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb25-678"><a href="#cb25-678" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> html_content</span>
<span id="cb25-679"><a href="#cb25-679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-680"><a href="#cb25-680" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _enhance_toc_styling(<span class="va">self</span>, html_content: <span class="bu">str</span>) <span class="op">-></span> <span class="bu">str</span>:</span>
<span id="cb25-681"><a href="#cb25-681" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Melhora o estilo do Table of Contents gerado pelo Pandoc"""</span></span>
<span id="cb25-682"><a href="#cb25-682" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Adiciona t√≠tulo ao TOC se n√£o existir</span></span>
<span id="cb25-683"><a href="#cb25-683" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">'<div id="TOC">'</span> <span class="kw">in</span> html_content <span class="kw">and</span> <span class="st">'Table of Contents'</span> <span class="kw">not</span> <span class="kw">in</span> html_content:</span>
<span id="cb25-684"><a href="#cb25-684" aria-hidden="true" tabindex="-1"></a>            html_content <span class="op">=</span> html_content.replace(</span>
<span id="cb25-685"><a href="#cb25-685" aria-hidden="true" tabindex="-1"></a>                <span class="st">'<div id="TOC">'</span>, </span>
<span id="cb25-686"><a href="#cb25-686" aria-hidden="true" tabindex="-1"></a>                <span class="st">'<div id="TOC"><h2 style="margin-top: 0; color: #2c3e50; border-bottom: 2px solid #3498db; padding-bottom: 10px;">üìë Table of Contents</h2>'</span></span>
<span id="cb25-687"><a href="#cb25-687" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb25-688"><a href="#cb25-688" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-689"><a href="#cb25-689" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Adiciona wrapper para conte√∫do principal com clearfix</span></span>
<span id="cb25-690"><a href="#cb25-690" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">'<div id="TOC">'</span> <span class="kw">in</span> html_content <span class="kw">and</span> <span class="st">'<body>'</span> <span class="kw">in</span> html_content:</span>
<span id="cb25-691"><a href="#cb25-691" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Encontra o TOC e envolve o conte√∫do restante</span></span>
<span id="cb25-692"><a href="#cb25-692" aria-hidden="true" tabindex="-1"></a>            toc_end <span class="op">=</span> html_content.find(<span class="st">'</div>'</span>, html_content.find(<span class="st">'<div id="TOC">'</span>)) <span class="op">+</span> <span class="dv">6</span></span>
<span id="cb25-693"><a href="#cb25-693" aria-hidden="true" tabindex="-1"></a>            body_content <span class="op">=</span> html_content[toc_end:]</span>
<span id="cb25-694"><a href="#cb25-694" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="st">'<div class="main-content">'</span> <span class="kw">not</span> <span class="kw">in</span> body_content:</span>
<span id="cb25-695"><a href="#cb25-695" aria-hidden="true" tabindex="-1"></a>                html_content <span class="op">=</span> html_content[:toc_end] <span class="op">+</span> <span class="st">'</span><span class="ch">\n</span><span class="st"><div class="main-content">'</span> <span class="op">+</span> body_content <span class="op">+</span> <span class="st">'</span><span class="ch">\n</span><span class="st"></div>'</span></span>
<span id="cb25-696"><a href="#cb25-696" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-697"><a href="#cb25-697" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> html_content</span>
<span id="cb25-698"><a href="#cb25-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-699"><a href="#cb25-699" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _convert_with_fallback(<span class="va">self</span>, md_file_path: <span class="bu">str</span>) <span class="op">-></span> <span class="bu">str</span>:</span>
<span id="cb25-700"><a href="#cb25-700" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Fallback para convers√£o quando Pandoc falha"""</span></span>
<span id="cb25-701"><a href="#cb25-701" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb25-702"><a href="#cb25-702" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(md_file_path, <span class="st">'r'</span>, encoding<span class="op">=</span><span class="st">'utf-8'</span>) <span class="im">as</span> f:</span>
<span id="cb25-703"><a href="#cb25-703" aria-hidden="true" tabindex="-1"></a>                md_content <span class="op">=</span> f.read()</span>
<span id="cb25-704"><a href="#cb25-704" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-705"><a href="#cb25-705" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Extens√µes avan√ßadas para melhor convers√£o</span></span>
<span id="cb25-706"><a href="#cb25-706" aria-hidden="true" tabindex="-1"></a>            extensions <span class="op">=</span> [</span>
<span id="cb25-707"><a href="#cb25-707" aria-hidden="true" tabindex="-1"></a>                <span class="st">'extra'</span>, <span class="st">'tables'</span>, <span class="st">'fenced_code'</span>, <span class="st">'codehilite'</span>, </span>
<span id="cb25-708"><a href="#cb25-708" aria-hidden="true" tabindex="-1"></a>                <span class="st">'toc'</span>, <span class="st">'md_in_html'</span>, <span class="st">'attr_list'</span></span>
<span id="cb25-709"><a href="#cb25-709" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb25-710"><a href="#cb25-710" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-711"><a href="#cb25-711" aria-hidden="true" tabindex="-1"></a>            html_content <span class="op">=</span> markdown.markdown(</span>
<span id="cb25-712"><a href="#cb25-712" aria-hidden="true" tabindex="-1"></a>                md_content,</span>
<span id="cb25-713"><a href="#cb25-713" aria-hidden="true" tabindex="-1"></a>                extensions<span class="op">=</span>extensions,</span>
<span id="cb25-714"><a href="#cb25-714" aria-hidden="true" tabindex="-1"></a>                output_format<span class="op">=</span><span class="st">'html5'</span></span>
<span id="cb25-715"><a href="#cb25-715" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb25-716"><a href="#cb25-716" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-717"><a href="#cb25-717" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">self</span>._create_enhanced_html_template(html_content, Path(md_file_path).name)</span>
<span id="cb25-718"><a href="#cb25-718" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-719"><a href="#cb25-719" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb25-720"><a href="#cb25-720" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.error(<span class="ss">f"‚ùå Fallback tamb√©m falhou: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb25-721"><a href="#cb25-721" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">self</span>._create_basic_html(md_content, Path(md_file_path).name)</span>
<span id="cb25-722"><a href="#cb25-722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-723"><a href="#cb25-723" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _create_enhanced_html_template(<span class="va">self</span>, content: <span class="bu">str</span>, title: <span class="bu">str</span>) <span class="op">-></span> <span class="bu">str</span>:</span>
<span id="cb25-724"><a href="#cb25-724" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Template HTML aprimorado com suporte a MathJax local/online e TOC flutuante"""</span></span>
<span id="cb25-725"><a href="#cb25-725" aria-hidden="true" tabindex="-1"></a>        mathjax_src <span class="op">=</span> <span class="st">"assets/tex-mml-chtml.js"</span> <span class="cf">if</span> Path(<span class="st">"assets/tex-mml-chtml.js"</span>).exists() <span class="cf">else</span> <span class="st">"https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"</span></span>
<span id="cb25-726"><a href="#cb25-726" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-727"><a href="#cb25-727" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="ss">f"""<!DOCTYPE html></span></span>
<span id="cb25-728"><a href="#cb25-728" aria-hidden="true" tabindex="-1"></a><span class="ss"><html lang="pt-BR"></span></span>
<span id="cb25-729"><a href="#cb25-729" aria-hidden="true" tabindex="-1"></a><span class="ss"><head>

        <style id="fixed-toc-styles">
        /* === ESTILOS PRINCIPAIS - TOC FIXO √Ä DIREITA === */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
            scroll-behavior: smooth;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            position: relative;
        }
        /* === TOC FIXO √Ä DIREITA - POSI√á√ÉO CORRIGIDA === */
        #TOC {
            position: fixed !important;
            top: 50% !important;
            right: 20px !important;
            transform: translateY(-50%) !important;
            width: 320px !important;
            max-height: 80vh !important;
            overflow-y: auto !important;
            z-index: 1000 !important;
            background: rgba(255, 255, 255, 0.98) !important;
            padding: 20px !important;
            border-radius: 12px !important;
            box-shadow: 0 8px 32px rgba(0,0,0,0.15) !important;
            border: 1px solid #e0e0e0 !important;
            backdrop-filter: blur(10px) !important;
            transition: all 0.3s ease-in-out !important;
        }
        #TOC.toc-minimized {
            transform: translateY(-50%) translateX(calc(320px - 50px)) !important;
            opacity: 0.3;
            width: 50px !important;
            overflow: hidden;
        }
        #TOC.toc-minimized > *:not(.toc-toggle-btn) {
            display: none !important;
        }
        #TOC h2 {
            margin-top: 0;
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
            font-size: 1.2em;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .toc-toggle-btn {
            background: none;
            border: none;
            font-size: 1.2em;
            cursor: pointer;
            padding: 5px;
            border-radius: 4px;
            transition: background-color 0.2s;
        }
        .toc-toggle-btn:hover {
            background-color: rgba(0,0,0,0.1);
        }
        #TOC ul {
            list-style-type: none;
            padding-left: 15px;
            margin: 10px 0;
        }
        #TOC ul ul {
            padding-left: 20px;
        }
        #TOC li {
            margin: 8px 0;
            line-height: 1.4;
        }
        #TOC a {
            text-decoration: none;
            color: #495057;
            font-weight: 500;
            transition: all 0.2s ease;
            display: block;
            padding: 6px 10px;
            border-radius: 6px;
            border-left: 3px solid transparent;
        }
        #TOC a:hover {
            color: #007bff;
            background-color: rgba(0, 123, 255, 0.1);
            border-left-color: #007bff;
        }
        #TOC a.active {
            background-color: #007bff !important;
            color: white !important;
            font-weight: bold;
            border-left-color: #0056b3;
        }
        /* Conte√∫do principal com margem para o TOC */
        .main-content {
            margin-right: calc(320px + 40px) !important;
        }
        /* Barra de scroll personalizada APENAS para TOC */
        #TOC::-webkit-scrollbar {
            width: 8px;
        }
        #TOC::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }
        #TOC::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 4px;
        }
        #TOC::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }
        /* === BOT√ÉO VOLTAR AO TOPO (HTMLs individuais) === */
        .back-to-top-content {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            font-size: 18px;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 999;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .back-to-top-content.show {
            opacity: 1;
            transform: translateY(0);
        }
        .back-to-top-content:hover {
            background: #0056b3;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0,0,0,0.2);
        }
        /* === RESPONSIVIDADE === */
        @media (max-width: 1400px) {
            .container {
                max-width: 95%;
                padding: 30px;
            }
            #TOC {
                width: 280px !important;
            }
            .main-content {
                margin-right: 320px !important;
            }
        }
        @media (max-width: 1200px) {
            #TOC {
                width: 260px !important;
                right: 15px !important;
            }
            .main-content {
                margin-right: 300px !important;
            }
        }
        @media (max-width: 992px) {
            #TOC {
                position: relative !important;
                width: 100% !important;
                right: 0 !important;
                top: 0 !important;
                transform: none !important;
                margin: 20px 0;
                max-height: 300px !important;
            }
            .main-content {
                margin-right: 0 !important;
            }
            .back-to-top-content {
                right: 20px;
                bottom: 20px;
            }
        }
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            .container {
                padding: 20px;
                max-width: 100%;
            }
            #TOC {
                max-height: 250px !important;
                padding: 15px !important;
            }
        }
        </style>
        </span></span>
<span id="cb25-730"><a href="#cb25-730" aria-hidden="true" tabindex="-1"></a><span class="ss">    <meta charset="UTF-8"></span></span>
<span id="cb25-731"><a href="#cb25-731" aria-hidden="true" tabindex="-1"></a><span class="ss">    <meta name="viewport" content="width=device-width, initial-scale=1.0"></span></span>
<span id="cb25-732"><a href="#cb25-732" aria-hidden="true" tabindex="-1"></a><span class="ss">    <title></span><span class="sc">{</span>title<span class="sc">}</span><span class="ss"></title></span></span>
<span id="cb25-733"><a href="#cb25-733" aria-hidden="true" tabindex="-1"></a><span class="ss">    <style></span></span>
<span id="cb25-734"><a href="#cb25-734" aria-hidden="true" tabindex="-1"></a><span class="ss">        /* LAYOUT DE TELA COMPLETA OTIMIZADO */</span></span>
<span id="cb25-735"><a href="#cb25-735" aria-hidden="true" tabindex="-1"></a><span class="ss">        body </span><span class="ch">{{</span></span>
<span id="cb25-736"><a href="#cb25-736" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;</span></span>
<span id="cb25-737"><a href="#cb25-737" aria-hidden="true" tabindex="-1"></a><span class="ss">            line-height: 1.6;</span></span>
<span id="cb25-738"><a href="#cb25-738" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin: 0;</span></span>
<span id="cb25-739"><a href="#cb25-739" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 20px;</span></span>
<span id="cb25-740"><a href="#cb25-740" aria-hidden="true" tabindex="-1"></a><span class="ss">            background-color: #f5f5f5;</span></span>
<span id="cb25-741"><a href="#cb25-741" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #333;</span></span>
<span id="cb25-742"><a href="#cb25-742" aria-hidden="true" tabindex="-1"></a><span class="ss">            max-width: none; /* Remove limita√ß√£o de largura - TELA COMPLETA */</span></span>
<span id="cb25-743"><a href="#cb25-743" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-744"><a href="#cb25-744" aria-hidden="true" tabindex="-1"></a><span class="ss">        .container </span><span class="ch">{{</span></span>
<span id="cb25-745"><a href="#cb25-745" aria-hidden="true" tabindex="-1"></a><span class="ss">            max-width: 95%; /* Usa quase toda a largura dispon√≠vel */</span></span>
<span id="cb25-746"><a href="#cb25-746" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin: 0 auto;</span></span>
<span id="cb25-747"><a href="#cb25-747" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: white;</span></span>
<span id="cb25-748"><a href="#cb25-748" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 40px;</span></span>
<span id="cb25-749"><a href="#cb25-749" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 10px;</span></span>
<span id="cb25-750"><a href="#cb25-750" aria-hidden="true" tabindex="-1"></a><span class="ss">            box-shadow: 0 5px 20px rgba(0,0,0,0.1);</span></span>
<span id="cb25-751"><a href="#cb25-751" aria-hidden="true" tabindex="-1"></a><span class="ss">            position: relative; /* Para posicionamento do TOC */</span></span>
<span id="cb25-752"><a href="#cb25-752" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-753"><a href="#cb25-753" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb25-754"><a href="#cb25-754" aria-hidden="true" tabindex="-1"></a><span class="ss">        /* TOC FLUTUANTE MANUAL */</span></span>
<span id="cb25-755"><a href="#cb25-755" aria-hidden="true" tabindex="-1"></a><span class="ss">        .toc </span><span class="ch">{{</span></span>
<span id="cb25-756"><a href="#cb25-756" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);</span></span>
<span id="cb25-757"><a href="#cb25-757" aria-hidden="true" tabindex="-1"></a><span class="ss">            border: 1px solid #dee2e6;</span></span>
<span id="cb25-758"><a href="#cb25-758" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 8px;</span></span>
<span id="cb25-759"><a href="#cb25-759" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 20px;</span></span>
<span id="cb25-760"><a href="#cb25-760" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin: 20px 0;</span></span>
<span id="cb25-761"><a href="#cb25-761" aria-hidden="true" tabindex="-1"></a><span class="ss">            box-shadow: 0 2px 10px rgba(0,0,0,0.1);</span></span>
<span id="cb25-762"><a href="#cb25-762" aria-hidden="true" tabindex="-1"></a><span class="ss">            float: right; /* FLUTUA √Ä DIREITA */</span></span>
<span id="cb25-763"><a href="#cb25-763" aria-hidden="true" tabindex="-1"></a><span class="ss">            width: 320px; /* Largura fixa para TOC */</span></span>
<span id="cb25-764"><a href="#cb25-764" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-left: 30px;</span></span>
<span id="cb25-765"><a href="#cb25-765" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-bottom: 30px;</span></span>
<span id="cb25-766"><a href="#cb25-766" aria-hidden="true" tabindex="-1"></a><span class="ss">            position: relative;</span></span>
<span id="cb25-767"><a href="#cb25-767" aria-hidden="true" tabindex="-1"></a><span class="ss">            z-index: 100;</span></span>
<span id="cb25-768"><a href="#cb25-768" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-769"><a href="#cb25-769" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb25-770"><a href="#cb25-770" aria-hidden="true" tabindex="-1"></a><span class="ss">        .toc h2 </span><span class="ch">{{</span></span>
<span id="cb25-771"><a href="#cb25-771" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-top: 0;</span></span>
<span id="cb25-772"><a href="#cb25-772" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #2c3e50;</span></span>
<span id="cb25-773"><a href="#cb25-773" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-bottom: 2px solid #3498db;</span></span>
<span id="cb25-774"><a href="#cb25-774" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding-bottom: 10px;</span></span>
<span id="cb25-775"><a href="#cb25-775" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-776"><a href="#cb25-776" aria-hidden="true" tabindex="-1"></a><span class="ss">        .toc ul </span><span class="ch">{{</span></span>
<span id="cb25-777"><a href="#cb25-777" aria-hidden="true" tabindex="-1"></a><span class="ss">            list-style-type: none;</span></span>
<span id="cb25-778"><a href="#cb25-778" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding-left: 15px;</span></span>
<span id="cb25-779"><a href="#cb25-779" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-780"><a href="#cb25-780" aria-hidden="true" tabindex="-1"></a><span class="ss">        .toc ul ul </span><span class="ch">{{</span></span>
<span id="cb25-781"><a href="#cb25-781" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding-left: 25px;</span></span>
<span id="cb25-782"><a href="#cb25-782" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-783"><a href="#cb25-783" aria-hidden="true" tabindex="-1"></a><span class="ss">        .toc ul ul ul </span><span class="ch">{{</span></span>
<span id="cb25-784"><a href="#cb25-784" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding-left: 35px; /* Mais indenta√ß√£o para n√≠vel 3 */</span></span>
<span id="cb25-785"><a href="#cb25-785" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-786"><a href="#cb25-786" aria-hidden="true" tabindex="-1"></a><span class="ss">        .toc li </span><span class="ch">{{</span></span>
<span id="cb25-787"><a href="#cb25-787" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin: 8px 0;</span></span>
<span id="cb25-788"><a href="#cb25-788" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-789"><a href="#cb25-789" aria-hidden="true" tabindex="-1"></a><span class="ss">        .toc a </span><span class="ch">{{</span></span>
<span id="cb25-790"><a href="#cb25-790" aria-hidden="true" tabindex="-1"></a><span class="ss">            text-decoration: none;</span></span>
<span id="cb25-791"><a href="#cb25-791" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #495057;</span></span>
<span id="cb25-792"><a href="#cb25-792" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-weight: 500;</span></span>
<span id="cb25-793"><a href="#cb25-793" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: block;</span></span>
<span id="cb25-794"><a href="#cb25-794" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 4px 8px;</span></span>
<span id="cb25-795"><a href="#cb25-795" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 4px;</span></span>
<span id="cb25-796"><a href="#cb25-796" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-797"><a href="#cb25-797" aria-hidden="true" tabindex="-1"></a><span class="ss">        .toc a:hover </span><span class="ch">{{</span></span>
<span id="cb25-798"><a href="#cb25-798" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #007bff;</span></span>
<span id="cb25-799"><a href="#cb25-799" aria-hidden="true" tabindex="-1"></a><span class="ss">            background-color: rgba(0, 123, 255, 0.1);</span></span>
<span id="cb25-800"><a href="#cb25-800" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-801"><a href="#cb25-801" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb25-802"><a href="#cb25-802" aria-hidden="true" tabindex="-1"></a><span class="ss">        /* CLEARFIX PARA LAYOUT COM TOC FLUTUANTE */</span></span>
<span id="cb25-803"><a href="#cb25-803" aria-hidden="true" tabindex="-1"></a><span class="ss">        .main-content </span><span class="ch">{{</span></span>
<span id="cb25-804"><a href="#cb25-804" aria-hidden="true" tabindex="-1"></a><span class="ss">            overflow: hidden; /* PREVINE PROBLEMAS COM ELEMENTOS FLUTUANTES */</span></span>
<span id="cb25-805"><a href="#cb25-805" aria-hidden="true" tabindex="-1"></a><span class="ss">            position: relative;</span></span>
<span id="cb25-806"><a href="#cb25-806" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-807"><a href="#cb25-807" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb25-808"><a href="#cb25-808" aria-hidden="true" tabindex="-1"></a><span class="ss">        /* CORRE√á√ÉO CR√çTICA: Garantir visibilidade do texto */</span></span>
<span id="cb25-809"><a href="#cb25-809" aria-hidden="true" tabindex="-1"></a><span class="ss">        .sourceCode, pre, code </span><span class="ch">{{</span></span>
<span id="cb25-810"><a href="#cb25-810" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #f8f8f2 !important;</span></span>
<span id="cb25-811"><a href="#cb25-811" aria-hidden="true" tabindex="-1"></a><span class="ss">            background-color: #2d2d2d !important;</span></span>
<span id="cb25-812"><a href="#cb25-812" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-813"><a href="#cb25-813" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-814"><a href="#cb25-814" aria-hidden="true" tabindex="-1"></a><span class="ss">        .sourceCode span </span><span class="ch">{{</span></span>
<span id="cb25-815"><a href="#cb25-815" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #f8f8f2 !important;</span></span>
<span id="cb25-816"><a href="#cb25-816" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: transparent !important;</span></span>
<span id="cb25-817"><a href="#cb25-817" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-818"><a href="#cb25-818" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-819"><a href="#cb25-819" aria-hidden="true" tabindex="-1"></a><span class="ss">        /* Corre√ß√£o para syntax highlighting */</span></span>
<span id="cb25-820"><a href="#cb25-820" aria-hidden="true" tabindex="-1"></a><span class="ss">        .sourceCode .kw </span><span class="ch">{{</span><span class="ss"> color: #ff79c6 !important; </span><span class="ch">}}</span></span>
<span id="cb25-821"><a href="#cb25-821" aria-hidden="true" tabindex="-1"></a><span class="ss">        .sourceCode .dt </span><span class="ch">{{</span><span class="ss"> color: #8be9fd !important; </span><span class="ch">}}</span></span>
<span id="cb25-822"><a href="#cb25-822" aria-hidden="true" tabindex="-1"></a><span class="ss">        .sourceCode .dv </span><span class="ch">{{</span><span class="ss"> color: #bd93f9 !important; </span><span class="ch">}}</span></span>
<span id="cb25-823"><a href="#cb25-823" aria-hidden="true" tabindex="-1"></a><span class="ss">        .sourceCode .bn </span><span class="ch">{{</span><span class="ss"> color: #bd93f9 !important; </span><span class="ch">}}</span></span>
<span id="cb25-824"><a href="#cb25-824" aria-hidden="true" tabindex="-1"></a><span class="ss">        .sourceCode .fl </span><span class="ch">{{</span><span class="ss"> color: #bd93f9 !important; </span><span class="ch">}}</span></span>
<span id="cb25-825"><a href="#cb25-825" aria-hidden="true" tabindex="-1"></a><span class="ss">        .sourceCode .ch </span><span class="ch">{{</span><span class="ss"> color: #f1fa8c !important; </span><span class="ch">}}</span></span>
<span id="cb25-826"><a href="#cb25-826" aria-hidden="true" tabindex="-1"></a><span class="ss">        .sourceCode .st </span><span class="ch">{{</span><span class="ss"> color: #f1fa8c !important; </span><span class="ch">}}</span></span>
<span id="cb25-827"><a href="#cb25-827" aria-hidden="true" tabindex="-1"></a><span class="ss">        .sourceCode .co </span><span class="ch">{{</span><span class="ss"> color: #6272a4 !important; </span><span class="ch">}}</span></span>
<span id="cb25-828"><a href="#cb25-828" aria-hidden="true" tabindex="-1"></a><span class="ss">        .sourceCode .ot </span><span class="ch">{{</span><span class="ss"> color: #50fa7b !important; </span><span class="ch">}}</span></span>
<span id="cb25-829"><a href="#cb25-829" aria-hidden="true" tabindex="-1"></a><span class="ss">        .sourceCode .al </span><span class="ch">{{</span><span class="ss"> color: #ff5555 !important; </span><span class="ch">}}</span></span>
<span id="cb25-830"><a href="#cb25-830" aria-hidden="true" tabindex="-1"></a><span class="ss">        .sourceCode .fu </span><span class="ch">{{</span><span class="ss"> color: #50fa7b !important; </span><span class="ch">}}</span></span>
<span id="cb25-831"><a href="#cb25-831" aria-hidden="true" tabindex="-1"></a><span class="ss">        .sourceCode .re </span><span class="ch">{{</span><span class="ss"> color: #f1fa8c !important; </span><span class="ch">}}</span></span>
<span id="cb25-832"><a href="#cb25-832" aria-hidden="true" tabindex="-1"></a><span class="ss">        .sourceCode .er </span><span class="ch">{{</span><span class="ss"> color: #ff5555 !important; </span><span class="ch">}}</span></span>
<span id="cb25-833"><a href="#cb25-833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-834"><a href="#cb25-834" aria-hidden="true" tabindex="-1"></a><span class="ss">        /* Garantir contraste para texto normal */</span></span>
<span id="cb25-835"><a href="#cb25-835" aria-hidden="true" tabindex="-1"></a><span class="ss">        body, .container </span><span class="ch">{{</span></span>
<span id="cb25-836"><a href="#cb25-836" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #2c3e50 !important;</span></span>
<span id="cb25-837"><a href="#cb25-837" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-838"><a href="#cb25-838" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-839"><a href="#cb25-839" aria-hidden="true" tabindex="-1"></a><span class="ss">        p, li, td, th </span><span class="ch">{{</span></span>
<span id="cb25-840"><a href="#cb25-840" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #2c3e50 !important;</span></span>
<span id="cb25-841"><a href="#cb25-841" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-842"><a href="#cb25-842" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb25-843"><a href="#cb25-843" aria-hidden="true" tabindex="-1"></a><span class="ss">        h1, h2, h3, h4, h5 </span><span class="ch">{{</span></span>
<span id="cb25-844"><a href="#cb25-844" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #2c3e50 !important;</span></span>
<span id="cb25-845"><a href="#cb25-845" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-top: 1.8em;</span></span>
<span id="cb25-846"><a href="#cb25-846" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-847"><a href="#cb25-847" aria-hidden="true" tabindex="-1"></a><span class="ss">        h1 </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb25-848"><a href="#cb25-848" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-bottom: 3px solid #3498db; </span></span>
<span id="cb25-849"><a href="#cb25-849" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding-bottom: 15px; </span></span>
<span id="cb25-850"><a href="#cb25-850" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #2c3e50 !important;</span></span>
<span id="cb25-851"><a href="#cb25-851" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 2.2em;</span></span>
<span id="cb25-852"><a href="#cb25-852" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-853"><a href="#cb25-853" aria-hidden="true" tabindex="-1"></a><span class="ss">        h2 </span><span class="ch">{{</span></span>
<span id="cb25-854"><a href="#cb25-854" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-left: 4px solid #3498db;</span></span>
<span id="cb25-855"><a href="#cb25-855" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding-left: 15px;</span></span>
<span id="cb25-856"><a href="#cb25-856" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-top: 2em;</span></span>
<span id="cb25-857"><a href="#cb25-857" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-858"><a href="#cb25-858" aria-hidden="true" tabindex="-1"></a><span class="ss">        code </span><span class="ch">{{</span></span>
<span id="cb25-859"><a href="#cb25-859" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #f4f4f4 !important;</span></span>
<span id="cb25-860"><a href="#cb25-860" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 3px 8px;</span></span>
<span id="cb25-861"><a href="#cb25-861" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 4px;</span></span>
<span id="cb25-862"><a href="#cb25-862" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;</span></span>
<span id="cb25-863"><a href="#cb25-863" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #c7254e !important;</span></span>
<span id="cb25-864"><a href="#cb25-864" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.9em;</span></span>
<span id="cb25-865"><a href="#cb25-865" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-866"><a href="#cb25-866" aria-hidden="true" tabindex="-1"></a><span class="ss">        pre </span><span class="ch">{{</span></span>
<span id="cb25-867"><a href="#cb25-867" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #2d2d2d !important;</span></span>
<span id="cb25-868"><a href="#cb25-868" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #f8f8f2 !important;</span></span>
<span id="cb25-869"><a href="#cb25-869" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 20px;</span></span>
<span id="cb25-870"><a href="#cb25-870" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 8px;</span></span>
<span id="cb25-871"><a href="#cb25-871" aria-hidden="true" tabindex="-1"></a><span class="ss">            overflow-x: auto;</span></span>
<span id="cb25-872"><a href="#cb25-872" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-left: 5px solid #3498db;</span></span>
<span id="cb25-873"><a href="#cb25-873" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;</span></span>
<span id="cb25-874"><a href="#cb25-874" aria-hidden="true" tabindex="-1"></a><span class="ss">            line-height: 1.4;</span></span>
<span id="cb25-875"><a href="#cb25-875" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-876"><a href="#cb25-876" aria-hidden="true" tabindex="-1"></a><span class="ss">        pre code </span><span class="ch">{{</span></span>
<span id="cb25-877"><a href="#cb25-877" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: none !important;</span></span>
<span id="cb25-878"><a href="#cb25-878" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: inherit !important;</span></span>
<span id="cb25-879"><a href="#cb25-879" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 0 !important;</span></span>
<span id="cb25-880"><a href="#cb25-880" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-881"><a href="#cb25-881" aria-hidden="true" tabindex="-1"></a><span class="ss">        blockquote </span><span class="ch">{{</span></span>
<span id="cb25-882"><a href="#cb25-882" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-left: 4px solid #3498db;</span></span>
<span id="cb25-883"><a href="#cb25-883" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin: 25px 0;</span></span>
<span id="cb25-884"><a href="#cb25-884" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding-left: 25px;</span></span>
<span id="cb25-885"><a href="#cb25-885" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #7f8c8d;</span></span>
<span id="cb25-886"><a href="#cb25-886" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-style: italic;</span></span>
<span id="cb25-887"><a href="#cb25-887" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #f8f9fa;</span></span>
<span id="cb25-888"><a href="#cb25-888" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 20px;</span></span>
<span id="cb25-889"><a href="#cb25-889" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 0 8px 8px 0;</span></span>
<span id="cb25-890"><a href="#cb25-890" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-891"><a href="#cb25-891" aria-hidden="true" tabindex="-1"></a><span class="ss">        table </span><span class="ch">{{</span></span>
<span id="cb25-892"><a href="#cb25-892" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-collapse: collapse;</span></span>
<span id="cb25-893"><a href="#cb25-893" aria-hidden="true" tabindex="-1"></a><span class="ss">            width: 100%;</span></span>
<span id="cb25-894"><a href="#cb25-894" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin: 1.5em 0;</span></span>
<span id="cb25-895"><a href="#cb25-895" aria-hidden="true" tabindex="-1"></a><span class="ss">            box-shadow: 0 2px 5px rgba(0,0,0,0.1);</span></span>
<span id="cb25-896"><a href="#cb25-896" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 8px;</span></span>
<span id="cb25-897"><a href="#cb25-897" aria-hidden="true" tabindex="-1"></a><span class="ss">            overflow: hidden;</span></span>
<span id="cb25-898"><a href="#cb25-898" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-899"><a href="#cb25-899" aria-hidden="true" tabindex="-1"></a><span class="ss">        th, td </span><span class="ch">{{</span></span>
<span id="cb25-900"><a href="#cb25-900" aria-hidden="true" tabindex="-1"></a><span class="ss">            border: 1px solid #ddd;</span></span>
<span id="cb25-901"><a href="#cb25-901" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 15px;</span></span>
<span id="cb25-902"><a href="#cb25-902" aria-hidden="true" tabindex="-1"></a><span class="ss">            text-align: left;</span></span>
<span id="cb25-903"><a href="#cb25-903" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-904"><a href="#cb25-904" aria-hidden="true" tabindex="-1"></a><span class="ss">        th </span><span class="ch">{{</span></span>
<span id="cb25-905"><a href="#cb25-905" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: linear-gradient(135deg, #3498db, #2980b9);</span></span>
<span id="cb25-906"><a href="#cb25-906" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: white;</span></span>
<span id="cb25-907"><a href="#cb25-907" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-weight: bold;</span></span>
<span id="cb25-908"><a href="#cb25-908" aria-hidden="true" tabindex="-1"></a><span class="ss">            text-transform: uppercase;</span></span>
<span id="cb25-909"><a href="#cb25-909" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.9em;</span></span>
<span id="cb25-910"><a href="#cb25-910" aria-hidden="true" tabindex="-1"></a><span class="ss">            letter-spacing: 0.5px;</span></span>
<span id="cb25-911"><a href="#cb25-911" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-912"><a href="#cb25-912" aria-hidden="true" tabindex="-1"></a><span class="ss">        tr:nth-child(even) </span><span class="ch">{{</span></span>
<span id="cb25-913"><a href="#cb25-913" aria-hidden="true" tabindex="-1"></a><span class="ss">            background-color: #f8f9fa;</span></span>
<span id="cb25-914"><a href="#cb25-914" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-915"><a href="#cb25-915" aria-hidden="true" tabindex="-1"></a><span class="ss">        tr:hover </span><span class="ch">{{</span></span>
<span id="cb25-916"><a href="#cb25-916" aria-hidden="true" tabindex="-1"></a><span class="ss">            background-color: #e3f2fd;</span></span>
<span id="cb25-917"><a href="#cb25-917" aria-hidden="true" tabindex="-1"></a><span class="ss">            transition: background-color 0.2s ease;</span></span>
<span id="cb25-918"><a href="#cb25-918" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-919"><a href="#cb25-919" aria-hidden="true" tabindex="-1"></a><span class="ss">        .math </span><span class="ch">{{</span></span>
<span id="cb25-920"><a href="#cb25-920" aria-hidden="true" tabindex="-1"></a><span class="ss">            text-align: center;</span></span>
<span id="cb25-921"><a href="#cb25-921" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin: 1.5em 0;</span></span>
<span id="cb25-922"><a href="#cb25-922" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 15px;</span></span>
<span id="cb25-923"><a href="#cb25-923" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #f8f9fa;</span></span>
<span id="cb25-924"><a href="#cb25-924" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 8px;</span></span>
<span id="cb25-925"><a href="#cb25-925" aria-hidden="true" tabindex="-1"></a><span class="ss">            overflow-x: auto;</span></span>
<span id="cb25-926"><a href="#cb25-926" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-927"><a href="#cb25-927" aria-hidden="true" tabindex="-1"></a><span class="ss">        .message-header </span><span class="ch">{{</span></span>
<span id="cb25-928"><a href="#cb25-928" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: flex;</span></span>
<span id="cb25-929"><a href="#cb25-929" aria-hidden="true" tabindex="-1"></a><span class="ss">            justify-content: space-between;</span></span>
<span id="cb25-930"><a href="#cb25-930" aria-hidden="true" tabindex="-1"></a><span class="ss">            align-items: center;</span></span>
<span id="cb25-931"><a href="#cb25-931" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-bottom: 15px;</span></span>
<span id="cb25-932"><a href="#cb25-932" aria-hidden="true" tabindex="-1"></a><span class="ss">            flex-wrap: wrap;</span></span>
<span id="cb25-933"><a href="#cb25-933" aria-hidden="true" tabindex="-1"></a><span class="ss">            gap: 10px;</span></span>
<span id="cb25-934"><a href="#cb25-934" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-935"><a href="#cb25-935" aria-hidden="true" tabindex="-1"></a><span class="ss">        .author </span><span class="ch">{{</span></span>
<span id="cb25-936"><a href="#cb25-936" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-weight: bold;</span></span>
<span id="cb25-937"><a href="#cb25-937" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #2c3e50 !important;</span></span>
<span id="cb25-938"><a href="#cb25-938" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 1.1em;</span></span>
<span id="cb25-939"><a href="#cb25-939" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-940"><a href="#cb25-940" aria-hidden="true" tabindex="-1"></a><span class="ss">        .timestamp </span><span class="ch">{{</span></span>
<span id="cb25-941"><a href="#cb25-941" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #7f8c8d;</span></span>
<span id="cb25-942"><a href="#cb25-942" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.9em;</span></span>
<span id="cb25-943"><a href="#cb25-943" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #e9ecef;</span></span>
<span id="cb25-944"><a href="#cb25-944" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 4px 8px;</span></span>
<span id="cb25-945"><a href="#cb25-945" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 4px;</span></span>
<span id="cb25-946"><a href="#cb25-946" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-947"><a href="#cb25-947" aria-hidden="true" tabindex="-1"></a><span class="ss">        .message-content </span><span class="ch">{{</span></span>
<span id="cb25-948"><a href="#cb25-948" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #f8f9fa;</span></span>
<span id="cb25-949"><a href="#cb25-949" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 20px;</span></span>
<span id="cb25-950"><a href="#cb25-950" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 8px;</span></span>
<span id="cb25-951"><a href="#cb25-951" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-left: 4px solid #3498db;</span></span>
<span id="cb25-952"><a href="#cb25-952" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-bottom: 20px;</span></span>
<span id="cb25-953"><a href="#cb25-953" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-954"><a href="#cb25-954" aria-hidden="true" tabindex="-1"></a><span class="ss">        .metadata </span><span class="ch">{{</span></span>
<span id="cb25-955"><a href="#cb25-955" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #e8f4fd;</span></span>
<span id="cb25-956"><a href="#cb25-956" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 15px;</span></span>
<span id="cb25-957"><a href="#cb25-957" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 8px;</span></span>
<span id="cb25-958"><a href="#cb25-958" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-bottom: 25px;</span></span>
<span id="cb25-959"><a href="#cb25-959" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-left: 4px solid #3498db;</span></span>
<span id="cb25-960"><a href="#cb25-960" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-961"><a href="#cb25-961" aria-hidden="true" tabindex="-1"></a><span class="ss">        .metadata h3 </span><span class="ch">{{</span></span>
<span id="cb25-962"><a href="#cb25-962" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-top: 0;</span></span>
<span id="cb25-963"><a href="#cb25-963" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #2c3e50 !important;</span></span>
<span id="cb25-964"><a href="#cb25-964" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-965"><a href="#cb25-965" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb25-966"><a href="#cb25-966" aria-hidden="true" tabindex="-1"></a><span class="ss">        /* Melhorias responsivas */</span></span>
<span id="cb25-967"><a href="#cb25-967" aria-hidden="true" tabindex="-1"></a><span class="ss">        @media (max-width: 1400px) </span><span class="ch">{{</span></span>
<span id="cb25-968"><a href="#cb25-968" aria-hidden="true" tabindex="-1"></a><span class="ss">            .container </span><span class="ch">{{</span></span>
<span id="cb25-969"><a href="#cb25-969" aria-hidden="true" tabindex="-1"></a><span class="ss">                max-width: 98%;</span></span>
<span id="cb25-970"><a href="#cb25-970" aria-hidden="true" tabindex="-1"></a><span class="ss">                padding: 30px;</span></span>
<span id="cb25-971"><a href="#cb25-971" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span><span class="ch">}}</span></span>
<span id="cb25-972"><a href="#cb25-972" aria-hidden="true" tabindex="-1"></a><span class="ss">            .toc </span><span class="ch">{{</span></span>
<span id="cb25-973"><a href="#cb25-973" aria-hidden="true" tabindex="-1"></a><span class="ss">                width: 280px; /* Reduz um pouco em telas menores */</span></span>
<span id="cb25-974"><a href="#cb25-974" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span><span class="ch">}}</span></span>
<span id="cb25-975"><a href="#cb25-975" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-976"><a href="#cb25-976" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb25-977"><a href="#cb25-977" aria-hidden="true" tabindex="-1"></a><span class="ss">        @media (max-width: 1200px) </span><span class="ch">{{</span></span>
<span id="cb25-978"><a href="#cb25-978" aria-hidden="true" tabindex="-1"></a><span class="ss">            .toc </span><span class="ch">{{</span></span>
<span id="cb25-979"><a href="#cb25-979" aria-hidden="true" tabindex="-1"></a><span class="ss">                float: none;</span></span>
<span id="cb25-980"><a href="#cb25-980" aria-hidden="true" tabindex="-1"></a><span class="ss">                width: auto;</span></span>
<span id="cb25-981"><a href="#cb25-981" aria-hidden="true" tabindex="-1"></a><span class="ss">                margin: 20px 0;</span></span>
<span id="cb25-982"><a href="#cb25-982" aria-hidden="true" tabindex="-1"></a><span class="ss">                position: static;</span></span>
<span id="cb25-983"><a href="#cb25-983" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span><span class="ch">}}</span></span>
<span id="cb25-984"><a href="#cb25-984" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-985"><a href="#cb25-985" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb25-986"><a href="#cb25-986" aria-hidden="true" tabindex="-1"></a><span class="ss">        @media (max-width: 768px) </span><span class="ch">{{</span></span>
<span id="cb25-987"><a href="#cb25-987" aria-hidden="true" tabindex="-1"></a><span class="ss">            .container </span><span class="ch">{{</span></span>
<span id="cb25-988"><a href="#cb25-988" aria-hidden="true" tabindex="-1"></a><span class="ss">                padding: 20px;</span></span>
<span id="cb25-989"><a href="#cb25-989" aria-hidden="true" tabindex="-1"></a><span class="ss">                max-width: 100%;</span></span>
<span id="cb25-990"><a href="#cb25-990" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span><span class="ch">}}</span></span>
<span id="cb25-991"><a href="#cb25-991" aria-hidden="true" tabindex="-1"></a><span class="ss">            body </span><span class="ch">{{</span></span>
<span id="cb25-992"><a href="#cb25-992" aria-hidden="true" tabindex="-1"></a><span class="ss">                padding: 10px;</span></span>
<span id="cb25-993"><a href="#cb25-993" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span><span class="ch">}}</span></span>
<span id="cb25-994"><a href="#cb25-994" aria-hidden="true" tabindex="-1"></a><span class="ss">            h1 </span><span class="ch">{{</span></span>
<span id="cb25-995"><a href="#cb25-995" aria-hidden="true" tabindex="-1"></a><span class="ss">                font-size: 1.8em;</span></span>
<span id="cb25-996"><a href="#cb25-996" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span><span class="ch">}}</span></span>
<span id="cb25-997"><a href="#cb25-997" aria-hidden="true" tabindex="-1"></a><span class="ss">            .message-header </span><span class="ch">{{</span></span>
<span id="cb25-998"><a href="#cb25-998" aria-hidden="true" tabindex="-1"></a><span class="ss">                flex-direction: column;</span></span>
<span id="cb25-999"><a href="#cb25-999" aria-hidden="true" tabindex="-1"></a><span class="ss">                align-items: flex-start;</span></span>
<span id="cb25-1000"><a href="#cb25-1000" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span><span class="ch">}}</span></span>
<span id="cb25-1001"><a href="#cb25-1001" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-1002"><a href="#cb25-1002" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb25-1003"><a href="#cb25-1003" aria-hidden="true" tabindex="-1"></a><span class="ss">        /* Scroll suave */</span></span>
<span id="cb25-1004"><a href="#cb25-1004" aria-hidden="true" tabindex="-1"></a><span class="ss">        html </span><span class="ch">{{</span></span>
<span id="cb25-1005"><a href="#cb25-1005" aria-hidden="true" tabindex="-1"></a><span class="ss">            scroll-behavior: smooth;</span></span>
<span id="cb25-1006"><a href="#cb25-1006" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-1007"><a href="#cb25-1007" aria-hidden="true" tabindex="-1"></a><span class="ss">    </style></span></span>
<span id="cb25-1008"><a href="#cb25-1008" aria-hidden="true" tabindex="-1"></a><span class="ss"></head></span></span>
<span id="cb25-1009"><a href="#cb25-1009" aria-hidden="true" tabindex="-1"></a><span class="ss"><body></span></span>
<span id="cb25-1010"><a href="#cb25-1010" aria-hidden="true" tabindex="-1"></a><span class="ss">    <div class="container"></span></span>
<span id="cb25-1011"><a href="#cb25-1011" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="sc">{</span>content<span class="sc">}</span></span>
<span id="cb25-1012"><a href="#cb25-1012" aria-hidden="true" tabindex="-1"></a><span class="ss">    </div></span></span>
<span id="cb25-1013"><a href="#cb25-1013" aria-hidden="true" tabindex="-1"></a><span class="ss">    <script></span></span>
<span id="cb25-1014"><a href="#cb25-1014" aria-hidden="true" tabindex="-1"></a><span class="ss">        // Configura√ß√£o MathJax para melhor renderiza√ß√£o</span></span>
<span id="cb25-1015"><a href="#cb25-1015" aria-hidden="true" tabindex="-1"></a><span class="ss">        window.MathJax = </span><span class="ch">{{</span></span>
<span id="cb25-1016"><a href="#cb25-1016" aria-hidden="true" tabindex="-1"></a><span class="ss">            tex: </span><span class="ch">{{</span></span>
<span id="cb25-1017"><a href="#cb25-1017" aria-hidden="true" tabindex="-1"></a><span class="ss">                inlineMath: [['$', '$'], ['</span><span class="ch">\\</span><span class="ss">(', '</span><span class="ch">\\</span><span class="ss">)']],</span></span>
<span id="cb25-1018"><a href="#cb25-1018" aria-hidden="true" tabindex="-1"></a><span class="ss">                displayMath: [['$$', '$$'], ['</span><span class="ch">\\</span><span class="ss">[', '</span><span class="ch">\\</span><span class="ss">]']],</span></span>
<span id="cb25-1019"><a href="#cb25-1019" aria-hidden="true" tabindex="-1"></a><span class="ss">                processEscapes: true,</span></span>
<span id="cb25-1020"><a href="#cb25-1020" aria-hidden="true" tabindex="-1"></a><span class="ss">                tags: 'ams'</span></span>
<span id="cb25-1021"><a href="#cb25-1021" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span><span class="ch">}}</span><span class="ss">,</span></span>
<span id="cb25-1022"><a href="#cb25-1022" aria-hidden="true" tabindex="-1"></a><span class="ss">            options: </span><span class="ch">{{</span></span>
<span id="cb25-1023"><a href="#cb25-1023" aria-hidden="true" tabindex="-1"></a><span class="ss">                skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre'],</span></span>
<span id="cb25-1024"><a href="#cb25-1024" aria-hidden="true" tabindex="-1"></a><span class="ss">                renderActions: </span><span class="ch">{{</span></span>
<span id="cb25-1025"><a href="#cb25-1025" aria-hidden="true" tabindex="-1"></a><span class="ss">                    addMenu: [0, '', '']</span></span>
<span id="cb25-1026"><a href="#cb25-1026" aria-hidden="true" tabindex="-1"></a><span class="ss">                </span><span class="ch">}}</span></span>
<span id="cb25-1027"><a href="#cb25-1027" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span><span class="ch">}}</span><span class="ss">,</span></span>
<span id="cb25-1028"><a href="#cb25-1028" aria-hidden="true" tabindex="-1"></a><span class="ss">            startup: </span><span class="ch">{{</span></span>
<span id="cb25-1029"><a href="#cb25-1029" aria-hidden="true" tabindex="-1"></a><span class="ss">                pageReady() </span><span class="ch">{{</span></span>
<span id="cb25-1030"><a href="#cb25-1030" aria-hidden="true" tabindex="-1"></a><span class="ss">                    return MathJax.startup.defaultPageReady().then(() => </span><span class="ch">{{</span></span>
<span id="cb25-1031"><a href="#cb25-1031" aria-hidden="true" tabindex="-1"></a><span class="ss">                        console.log('MathJax carregado com sucesso');</span></span>
<span id="cb25-1032"><a href="#cb25-1032" aria-hidden="true" tabindex="-1"></a><span class="ss">                    </span><span class="ch">}}</span><span class="ss">);</span></span>
<span id="cb25-1033"><a href="#cb25-1033" aria-hidden="true" tabindex="-1"></a><span class="ss">                </span><span class="ch">}}</span></span>
<span id="cb25-1034"><a href="#cb25-1034" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span><span class="ch">}}</span></span>
<span id="cb25-1035"><a href="#cb25-1035" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span><span class="ss">;</span></span>
<span id="cb25-1036"><a href="#cb25-1036" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb25-1037"><a href="#cb25-1037" aria-hidden="true" tabindex="-1"></a><span class="ss">        // Script para destacar se√ß√£o ativa no TOC (se existir)</span></span>
<span id="cb25-1038"><a href="#cb25-1038" aria-hidden="true" tabindex="-1"></a><span class="ss">        document.addEventListener('DOMContentLoaded', function() </span><span class="ch">{{</span></span>
<span id="cb25-1039"><a href="#cb25-1039" aria-hidden="true" tabindex="-1"></a><span class="ss">            const tocLinks = document.querySelectorAll('#TOC a, .toc a');</span></span>
<span id="cb25-1040"><a href="#cb25-1040" aria-hidden="true" tabindex="-1"></a><span class="ss">            const sections = document.querySelectorAll('h1, h2, h3, h4, h5');</span></span>
<span id="cb25-1041"><a href="#cb25-1041" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span></span>
<span id="cb25-1042"><a href="#cb25-1042" aria-hidden="true" tabindex="-1"></a><span class="ss">            function highlightActiveSection() </span><span class="ch">{{</span></span>
<span id="cb25-1043"><a href="#cb25-1043" aria-hidden="true" tabindex="-1"></a><span class="ss">                let currentSection = '';</span></span>
<span id="cb25-1044"><a href="#cb25-1044" aria-hidden="true" tabindex="-1"></a><span class="ss">                const scrollY = window.pageYOffset;</span></span>
<span id="cb25-1045"><a href="#cb25-1045" aria-hidden="true" tabindex="-1"></a><span class="ss">                </span></span>
<span id="cb25-1046"><a href="#cb25-1046" aria-hidden="true" tabindex="-1"></a><span class="ss">                sections.forEach(section => </span><span class="ch">{{</span></span>
<span id="cb25-1047"><a href="#cb25-1047" aria-hidden="true" tabindex="-1"></a><span class="ss">                    const sectionTop = section.offsetTop - 100;</span></span>
<span id="cb25-1048"><a href="#cb25-1048" aria-hidden="true" tabindex="-1"></a><span class="ss">                    if (scrollY >= sectionTop) </span><span class="ch">{{</span></span>
<span id="cb25-1049"><a href="#cb25-1049" aria-hidden="true" tabindex="-1"></a><span class="ss">                        currentSection = section.getAttribute('id');</span></span>
<span id="cb25-1050"><a href="#cb25-1050" aria-hidden="true" tabindex="-1"></a><span class="ss">                    </span><span class="ch">}}</span></span>
<span id="cb25-1051"><a href="#cb25-1051" aria-hidden="true" tabindex="-1"></a><span class="ss">                </span><span class="ch">}}</span><span class="ss">);</span></span>
<span id="cb25-1052"><a href="#cb25-1052" aria-hidden="true" tabindex="-1"></a><span class="ss">                </span></span>
<span id="cb25-1053"><a href="#cb25-1053" aria-hidden="true" tabindex="-1"></a><span class="ss">                tocLinks.forEach(link => </span><span class="ch">{{</span></span>
<span id="cb25-1054"><a href="#cb25-1054" aria-hidden="true" tabindex="-1"></a><span class="ss">                    link.classList.remove('active');</span></span>
<span id="cb25-1055"><a href="#cb25-1055" aria-hidden="true" tabindex="-1"></a><span class="ss">                    if (link.getAttribute('href') === '#' + currentSection) </span><span class="ch">{{</span></span>
<span id="cb25-1056"><a href="#cb25-1056" aria-hidden="true" tabindex="-1"></a><span class="ss">                        link.classList.add('active');</span></span>
<span id="cb25-1057"><a href="#cb25-1057" aria-hidden="true" tabindex="-1"></a><span class="ss">                    </span><span class="ch">}}</span></span>
<span id="cb25-1058"><a href="#cb25-1058" aria-hidden="true" tabindex="-1"></a><span class="ss">                </span><span class="ch">}}</span><span class="ss">);</span></span>
<span id="cb25-1059"><a href="#cb25-1059" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span><span class="ch">}}</span></span>
<span id="cb25-1060"><a href="#cb25-1060" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span></span>
<span id="cb25-1061"><a href="#cb25-1061" aria-hidden="true" tabindex="-1"></a><span class="ss">            if (tocLinks.length > 0) </span><span class="ch">{{</span></span>
<span id="cb25-1062"><a href="#cb25-1062" aria-hidden="true" tabindex="-1"></a><span class="ss">                window.addEventListener('scroll', highlightActiveSection);</span></span>
<span id="cb25-1063"><a href="#cb25-1063" aria-hidden="true" tabindex="-1"></a><span class="ss">                highlightActiveSection(); // Chamar inicialmente</span></span>
<span id="cb25-1064"><a href="#cb25-1064" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span><span class="ch">}}</span></span>
<span id="cb25-1065"><a href="#cb25-1065" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span><span class="ss">);</span></span>
<span id="cb25-1066"><a href="#cb25-1066" aria-hidden="true" tabindex="-1"></a><span class="ss">    </script></span></span>
<span id="cb25-1067"><a href="#cb25-1067" aria-hidden="true" tabindex="-1"></a><span class="ss">    <script src="</span><span class="sc">{</span>mathjax_src<span class="sc">}</span><span class="ss">" async></script></span></span>
<span id="cb25-1068"><a href="#cb25-1068" aria-hidden="true" tabindex="-1"></a><span class="ss">
        <script id="fixed-toc-script">
        document.addEventListener('DOMContentLoaded', function() {
            const toc = document.getElementById('TOC');
            if (toc) {
                const tocTitle = toc.querySelector('h2');
                if (tocTitle) {
                    const toggleBtn = document.createElement('button');
                    toggleBtn.innerHTML = '‚ò∞';
                    toggleBtn.className = 'toc-toggle-btn';
                    toggleBtn.title = 'Minimizar/Expandir TOC';
                    let isMinimized = false;
                    toggleBtn.addEventListener('click', function(e) {
                        e.stopPropagation();
                        isMinimized = !isMinimized;
                        if (isMinimized) {
                            toc.classList.add('toc-minimized');
                        } else {
                            toc.classList.remove('toc-minimized');
                        }
                    });
                    tocTitle.appendChild(toggleBtn);
                }
            }
            
            // SCROLLSPY
            const sections = document.querySelectorAll('h1, h2, h3, h4, h5');
            const tocLinks = document.querySelectorAll('#TOC a');
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const id = entry.target.getAttribute('id');
                        tocLinks.forEach(link => {
                            link.classList.remove('active');
                            if (link.getAttribute('href') === '#' + id) {
                                link.classList.add('active');
                            }
                        });
                    }
                });
            }, { 
                rootMargin: '-20% 0px -60% 0px', 
                threshold: 0 
            });
            
            sections.forEach(section => {
                if (section.id) observer.observe(section);
            });
            
            // Scroll suave
            tocLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const targetId = link.getAttribute('href').substring(1);
                    const targetElement = document.getElementById(targetId);
                    if (targetElement) {
                        const offsetTop = targetElement.offsetTop - 80;
                        window.scrollTo({ top: offsetTop, behavior: 'smooth' });
                    }
                });
            });
            
            // BOT√ÉO VOLTAR AO TOPO
            const backToTopBtn = document.createElement('button');
            backToTopBtn.className = 'back-to-top-content';
            backToTopBtn.innerHTML = '‚Üë';
            backToTopBtn.title = 'Voltar ao Topo';
            document.body.appendChild(backToTopBtn);
            
            window.addEventListener('scroll', () => {
                if (window.pageYOffset > 300) {
                    backToTopBtn.classList.add('show');
                } else {
                    backToTopBtn.classList.remove('show');
                }
            });
            
            backToTopBtn.addEventListener('click', () => {
                window.scrollTo({ top: 0, behavior: 'smooth' });
            });
        });
        </script>
        
</body></span></span>
<span id="cb25-1069"><a href="#cb25-1069" aria-hidden="true" tabindex="-1"></a><span class="ss"></html>"""</span></span>
<span id="cb25-1070"><a href="#cb25-1070" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1071"><a href="#cb25-1071" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _create_basic_html(<span class="va">self</span>, content: <span class="bu">str</span>, title: <span class="bu">str</span>) <span class="op">-></span> <span class="bu">str</span>:</span>
<span id="cb25-1072"><a href="#cb25-1072" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""HTML b√°sico de √∫ltimo recurso com MathJax"""</span></span>
<span id="cb25-1073"><a href="#cb25-1073" aria-hidden="true" tabindex="-1"></a>        mathjax_src <span class="op">=</span> <span class="st">"assets/tex-mml-chtml.js"</span> <span class="cf">if</span> Path(<span class="st">"assets/tex-mml-chtml.js"</span>).exists() <span class="cf">else</span> <span class="st">"https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"</span></span>
<span id="cb25-1074"><a href="#cb25-1074" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-1075"><a href="#cb25-1075" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="ss">f"""<!DOCTYPE html></span></span>
<span id="cb25-1076"><a href="#cb25-1076" aria-hidden="true" tabindex="-1"></a><span class="ss"><html></span></span>
<span id="cb25-1077"><a href="#cb25-1077" aria-hidden="true" tabindex="-1"></a><span class="ss"><head>

        <style id="fixed-toc-styles">
        /* === ESTILOS PRINCIPAIS - TOC FIXO √Ä DIREITA === */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
            scroll-behavior: smooth;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            position: relative;
        }
        /* === TOC FIXO √Ä DIREITA - POSI√á√ÉO CORRIGIDA === */
        #TOC {
            position: fixed !important;
            top: 50% !important;
            right: 20px !important;
            transform: translateY(-50%) !important;
            width: 320px !important;
            max-height: 80vh !important;
            overflow-y: auto !important;
            z-index: 1000 !important;
            background: rgba(255, 255, 255, 0.98) !important;
            padding: 20px !important;
            border-radius: 12px !important;
            box-shadow: 0 8px 32px rgba(0,0,0,0.15) !important;
            border: 1px solid #e0e0e0 !important;
            backdrop-filter: blur(10px) !important;
            transition: all 0.3s ease-in-out !important;
        }
        #TOC.toc-minimized {
            transform: translateY(-50%) translateX(calc(320px - 50px)) !important;
            opacity: 0.3;
            width: 50px !important;
            overflow: hidden;
        }
        #TOC.toc-minimized > *:not(.toc-toggle-btn) {
            display: none !important;
        }
        #TOC h2 {
            margin-top: 0;
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
            font-size: 1.2em;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .toc-toggle-btn {
            background: none;
            border: none;
            font-size: 1.2em;
            cursor: pointer;
            padding: 5px;
            border-radius: 4px;
            transition: background-color 0.2s;
        }
        .toc-toggle-btn:hover {
            background-color: rgba(0,0,0,0.1);
        }
        #TOC ul {
            list-style-type: none;
            padding-left: 15px;
            margin: 10px 0;
        }
        #TOC ul ul {
            padding-left: 20px;
        }
        #TOC li {
            margin: 8px 0;
            line-height: 1.4;
        }
        #TOC a {
            text-decoration: none;
            color: #495057;
            font-weight: 500;
            transition: all 0.2s ease;
            display: block;
            padding: 6px 10px;
            border-radius: 6px;
            border-left: 3px solid transparent;
        }
        #TOC a:hover {
            color: #007bff;
            background-color: rgba(0, 123, 255, 0.1);
            border-left-color: #007bff;
        }
        #TOC a.active {
            background-color: #007bff !important;
            color: white !important;
            font-weight: bold;
            border-left-color: #0056b3;
        }
        /* Conte√∫do principal com margem para o TOC */
        .main-content {
            margin-right: calc(320px + 40px) !important;
        }
        /* Barra de scroll personalizada APENAS para TOC */
        #TOC::-webkit-scrollbar {
            width: 8px;
        }
        #TOC::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }
        #TOC::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 4px;
        }
        #TOC::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }
        /* === BOT√ÉO VOLTAR AO TOPO (HTMLs individuais) === */
        .back-to-top-content {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            font-size: 18px;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 999;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .back-to-top-content.show {
            opacity: 1;
            transform: translateY(0);
        }
        .back-to-top-content:hover {
            background: #0056b3;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0,0,0,0.2);
        }
        /* === RESPONSIVIDADE === */
        @media (max-width: 1400px) {
            .container {
                max-width: 95%;
                padding: 30px;
            }
            #TOC {
                width: 280px !important;
            }
            .main-content {
                margin-right: 320px !important;
            }
        }
        @media (max-width: 1200px) {
            #TOC {
                width: 260px !important;
                right: 15px !important;
            }
            .main-content {
                margin-right: 300px !important;
            }
        }
        @media (max-width: 992px) {
            #TOC {
                position: relative !important;
                width: 100% !important;
                right: 0 !important;
                top: 0 !important;
                transform: none !important;
                margin: 20px 0;
                max-height: 300px !important;
            }
            .main-content {
                margin-right: 0 !important;
            }
            .back-to-top-content {
                right: 20px;
                bottom: 20px;
            }
        }
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            .container {
                padding: 20px;
                max-width: 100%;
            }
            #TOC {
                max-height: 250px !important;
                padding: 15px !important;
            }
        }
        </style>
        </span></span>
<span id="cb25-1078"><a href="#cb25-1078" aria-hidden="true" tabindex="-1"></a><span class="ss">    <meta charset="UTF-8"></span></span>
<span id="cb25-1079"><a href="#cb25-1079" aria-hidden="true" tabindex="-1"></a><span class="ss">    <title></span><span class="sc">{</span>title<span class="sc">}</span><span class="ss"></title></span></span>
<span id="cb25-1080"><a href="#cb25-1080" aria-hidden="true" tabindex="-1"></a><span class="ss">    <style></span></span>
<span id="cb25-1081"><a href="#cb25-1081" aria-hidden="true" tabindex="-1"></a><span class="ss">        body </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb25-1082"><a href="#cb25-1082" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; </span></span>
<span id="cb25-1083"><a href="#cb25-1083" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 20px; </span></span>
<span id="cb25-1084"><a href="#cb25-1084" aria-hidden="true" tabindex="-1"></a><span class="ss">            line-height: 1.6;</span></span>
<span id="cb25-1085"><a href="#cb25-1085" aria-hidden="true" tabindex="-1"></a><span class="ss">            background-color: #f5f5f5;</span></span>
<span id="cb25-1086"><a href="#cb25-1086" aria-hidden="true" tabindex="-1"></a><span class="ss">            max-width: none; /* Remove limita√ß√£o de largura - TELA COMPLETA */</span></span>
<span id="cb25-1087"><a href="#cb25-1087" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #333 !important;</span></span>
<span id="cb25-1088"><a href="#cb25-1088" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-1089"><a href="#cb25-1089" aria-hidden="true" tabindex="-1"></a><span class="ss">        pre </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb25-1090"><a href="#cb25-1090" aria-hidden="true" tabindex="-1"></a><span class="ss">            white-space: pre-wrap; </span></span>
<span id="cb25-1091"><a href="#cb25-1091" aria-hidden="true" tabindex="-1"></a><span class="ss">            word-wrap: break-word; </span></span>
<span id="cb25-1092"><a href="#cb25-1092" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: white;</span></span>
<span id="cb25-1093"><a href="#cb25-1093" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 15px;</span></span>
<span id="cb25-1094"><a href="#cb25-1094" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 5px;</span></span>
<span id="cb25-1095"><a href="#cb25-1095" aria-hidden="true" tabindex="-1"></a><span class="ss">            border: 1px solid #ddd;</span></span>
<span id="cb25-1096"><a href="#cb25-1096" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #333 !important;</span></span>
<span id="cb25-1097"><a href="#cb25-1097" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-1098"><a href="#cb25-1098" aria-hidden="true" tabindex="-1"></a><span class="ss">        code </span><span class="ch">{{</span></span>
<span id="cb25-1099"><a href="#cb25-1099" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #333 !important;</span></span>
<span id="cb25-1100"><a href="#cb25-1100" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: white !important;</span></span>
<span id="cb25-1101"><a href="#cb25-1101" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-1102"><a href="#cb25-1102" aria-hidden="true" tabindex="-1"></a><span class="ss">        .container </span><span class="ch">{{</span></span>
<span id="cb25-1103"><a href="#cb25-1103" aria-hidden="true" tabindex="-1"></a><span class="ss">            max-width: 95%; /* Usa quase toda a largura dispon√≠vel */</span></span>
<span id="cb25-1104"><a href="#cb25-1104" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin: 0 auto;</span></span>
<span id="cb25-1105"><a href="#cb25-1105" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: white;</span></span>
<span id="cb25-1106"><a href="#cb25-1106" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 30px;</span></span>
<span id="cb25-1107"><a href="#cb25-1107" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 8px;</span></span>
<span id="cb25-1108"><a href="#cb25-1108" aria-hidden="true" tabindex="-1"></a><span class="ss">            box-shadow: 0 2px 10px rgba(0,0,0,0.1);</span></span>
<span id="cb25-1109"><a href="#cb25-1109" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-1110"><a href="#cb25-1110" aria-hidden="true" tabindex="-1"></a><span class="ss">    </style></span></span>
<span id="cb25-1111"><a href="#cb25-1111" aria-hidden="true" tabindex="-1"></a><span class="ss">    <script></span></span>
<span id="cb25-1112"><a href="#cb25-1112" aria-hidden="true" tabindex="-1"></a><span class="ss">        window.MathJax = </span><span class="ch">{{</span></span>
<span id="cb25-1113"><a href="#cb25-1113" aria-hidden="true" tabindex="-1"></a><span class="ss">            tex: </span><span class="ch">{{</span></span>
<span id="cb25-1114"><a href="#cb25-1114" aria-hidden="true" tabindex="-1"></a><span class="ss">                inlineMath: [['$', '$'], ['</span><span class="ch">\\</span><span class="ss">(', '</span><span class="ch">\\</span><span class="ss">)']],</span></span>
<span id="cb25-1115"><a href="#cb25-1115" aria-hidden="true" tabindex="-1"></a><span class="ss">                displayMath: [['$$', '$$'], ['</span><span class="ch">\\</span><span class="ss">[', '</span><span class="ch">\\</span><span class="ss">]']],</span></span>
<span id="cb25-1116"><a href="#cb25-1116" aria-hidden="true" tabindex="-1"></a><span class="ss">                processEscapes: true</span></span>
<span id="cb25-1117"><a href="#cb25-1117" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span><span class="ch">}}</span></span>
<span id="cb25-1118"><a href="#cb25-1118" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span><span class="ss">;</span></span>
<span id="cb25-1119"><a href="#cb25-1119" aria-hidden="true" tabindex="-1"></a><span class="ss">    </script></span></span>
<span id="cb25-1120"><a href="#cb25-1120" aria-hidden="true" tabindex="-1"></a><span class="ss">    <script src="</span><span class="sc">{</span>mathjax_src<span class="sc">}</span><span class="ss">" async></script></span></span>
<span id="cb25-1121"><a href="#cb25-1121" aria-hidden="true" tabindex="-1"></a><span class="ss"></head></span></span>
<span id="cb25-1122"><a href="#cb25-1122" aria-hidden="true" tabindex="-1"></a><span class="ss"><body></span></span>
<span id="cb25-1123"><a href="#cb25-1123" aria-hidden="true" tabindex="-1"></a><span class="ss">    <div class="container"></span></span>
<span id="cb25-1124"><a href="#cb25-1124" aria-hidden="true" tabindex="-1"></a><span class="ss">        <pre></span><span class="sc">{</span>content<span class="sc">}</span><span class="ss"></pre></span></span>
<span id="cb25-1125"><a href="#cb25-1125" aria-hidden="true" tabindex="-1"></a><span class="ss">    </div></span></span>
<span id="cb25-1126"><a href="#cb25-1126" aria-hidden="true" tabindex="-1"></a><span class="ss">
        <script id="fixed-toc-script">
        document.addEventListener('DOMContentLoaded', function() {
            const toc = document.getElementById('TOC');
            if (toc) {
                const tocTitle = toc.querySelector('h2');
                if (tocTitle) {
                    const toggleBtn = document.createElement('button');
                    toggleBtn.innerHTML = '‚ò∞';
                    toggleBtn.className = 'toc-toggle-btn';
                    toggleBtn.title = 'Minimizar/Expandir TOC';
                    let isMinimized = false;
                    toggleBtn.addEventListener('click', function(e) {
                        e.stopPropagation();
                        isMinimized = !isMinimized;
                        if (isMinimized) {
                            toc.classList.add('toc-minimized');
                        } else {
                            toc.classList.remove('toc-minimized');
                        }
                    });
                    tocTitle.appendChild(toggleBtn);
                }
            }
            
            // SCROLLSPY
            const sections = document.querySelectorAll('h1, h2, h3, h4, h5');
            const tocLinks = document.querySelectorAll('#TOC a');
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const id = entry.target.getAttribute('id');
                        tocLinks.forEach(link => {
                            link.classList.remove('active');
                            if (link.getAttribute('href') === '#' + id) {
                                link.classList.add('active');
                            }
                        });
                    }
                });
            }, { 
                rootMargin: '-20% 0px -60% 0px', 
                threshold: 0 
            });
            
            sections.forEach(section => {
                if (section.id) observer.observe(section);
            });
            
            // Scroll suave
            tocLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const targetId = link.getAttribute('href').substring(1);
                    const targetElement = document.getElementById(targetId);
                    if (targetElement) {
                        const offsetTop = targetElement.offsetTop - 80;
                        window.scrollTo({ top: offsetTop, behavior: 'smooth' });
                    }
                });
            });
            
            // BOT√ÉO VOLTAR AO TOPO
            const backToTopBtn = document.createElement('button');
            backToTopBtn.className = 'back-to-top-content';
            backToTopBtn.innerHTML = '‚Üë';
            backToTopBtn.title = 'Voltar ao Topo';
            document.body.appendChild(backToTopBtn);
            
            window.addEventListener('scroll', () => {
                if (window.pageYOffset > 300) {
                    backToTopBtn.classList.add('show');
                } else {
                    backToTopBtn.classList.remove('show');
                }
            });
            
            backToTopBtn.addEventListener('click', () => {
                window.scrollTo({ top: 0, behavior: 'smooth' });
            });
        });
        </script>
        
</body></span></span>
<span id="cb25-1127"><a href="#cb25-1127" aria-hidden="true" tabindex="-1"></a><span class="ss"></html>"""</span></span>
<span id="cb25-1128"><a href="#cb25-1128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1129"><a href="#cb25-1129" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> save_as_html_robust(<span class="va">self</span>):</span>
<span id="cb25-1130"><a href="#cb25-1130" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""M√©todo ROBUSTO para convers√£o HTML - VERS√ÉO OTIMIZADA"""</span></span>
<span id="cb25-1131"><a href="#cb25-1131" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb25-1132"><a href="#cb25-1132" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="st">"üîÆ [DRY-RUN] HTMLs seriam criados:"</span>)</span>
<span id="cb25-1133"><a href="#cb25-1133" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> conv <span class="kw">in</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb25-1134"><a href="#cb25-1134" aria-hidden="true" tabindex="-1"></a>                safe_title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(conv[<span class="st">'title'</span>])</span>
<span id="cb25-1135"><a href="#cb25-1135" aria-hidden="true" tabindex="-1"></a>                filename <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>conv[<span class="st">'number'</span>]<span class="sc">:03d}</span><span class="ss">_</span><span class="sc">{</span>conv[<span class="st">'source'</span>]<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>safe_title<span class="sc">}</span><span class="ss">.html"</span></span>
<span id="cb25-1136"><a href="#cb25-1136" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.info(<span class="ss">f"   üåê </span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb25-1137"><a href="#cb25-1137" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb25-1138"><a href="#cb25-1138" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-1139"><a href="#cb25-1139" aria-hidden="true" tabindex="-1"></a>        markdown_folder <span class="op">=</span> Path(<span class="va">self</span>.output_dirs[<span class="st">'markdown'</span>])</span>
<span id="cb25-1140"><a href="#cb25-1140" aria-hidden="true" tabindex="-1"></a>        html_folder <span class="op">=</span> Path(<span class="va">self</span>.output_dirs[<span class="st">'html'</span>])</span>
<span id="cb25-1141"><a href="#cb25-1141" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-1142"><a href="#cb25-1142" aria-hidden="true" tabindex="-1"></a>        md_files <span class="op">=</span> <span class="bu">list</span>(markdown_folder.glob(<span class="st">"*.md"</span>))</span>
<span id="cb25-1143"><a href="#cb25-1143" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-1144"><a href="#cb25-1144" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> md_files:</span>
<span id="cb25-1145"><a href="#cb25-1145" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.error(<span class="st">"‚ùå Nenhum arquivo Markdown encontrado para convers√£o."</span>)</span>
<span id="cb25-1146"><a href="#cb25-1146" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb25-1147"><a href="#cb25-1147" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-1148"><a href="#cb25-1148" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.logger.info(<span class="ss">f"üîÑ Convertendo </span><span class="sc">{</span><span class="bu">len</span>(md_files)<span class="sc">}</span><span class="ss"> arquivos Markdown para HTML (OTIMIZADO)..."</span>)</span>
<span id="cb25-1149"><a href="#cb25-1149" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-1150"><a href="#cb25-1150" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Verifica se Pandoc est√° dispon√≠vel</span></span>
<span id="cb25-1151"><a href="#cb25-1151" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb25-1152"><a href="#cb25-1152" aria-hidden="true" tabindex="-1"></a>            subprocess.run([<span class="st">'pandoc'</span>, <span class="st">'--version'</span>], capture_output<span class="op">=</span><span class="va">True</span>, check<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb25-1153"><a href="#cb25-1153" aria-hidden="true" tabindex="-1"></a>            pandoc_available <span class="op">=</span> <span class="va">True</span></span>
<span id="cb25-1154"><a href="#cb25-1154" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="st">"‚úÖ Pandoc dispon√≠vel - usando convers√£o otimizada"</span>)</span>
<span id="cb25-1155"><a href="#cb25-1155" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span>:</span>
<span id="cb25-1156"><a href="#cb25-1156" aria-hidden="true" tabindex="-1"></a>            pandoc_available <span class="op">=</span> <span class="va">False</span></span>
<span id="cb25-1157"><a href="#cb25-1157" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.warning(<span class="st">"‚ö†Ô∏è Pandoc n√£o dispon√≠vel - usando fallback Python"</span>)</span>
<span id="cb25-1158"><a href="#cb25-1158" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-1159"><a href="#cb25-1159" aria-hidden="true" tabindex="-1"></a>        converted_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb25-1160"><a href="#cb25-1160" aria-hidden="true" tabindex="-1"></a>        failed_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb25-1161"><a href="#cb25-1161" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-1162"><a href="#cb25-1162" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> md_file <span class="kw">in</span> md_files:</span>
<span id="cb25-1163"><a href="#cb25-1163" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb25-1164"><a href="#cb25-1164" aria-hidden="true" tabindex="-1"></a>                html_file <span class="op">=</span> html_folder <span class="op">/</span> md_file.with_suffix(<span class="st">'.html'</span>).name</span>
<span id="cb25-1165"><a href="#cb25-1165" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb25-1166"><a href="#cb25-1166" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.force_overwrite <span class="kw">and</span> html_file.exists():</span>
<span id="cb25-1167"><a href="#cb25-1167" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.logger.info(<span class="ss">f"‚è≠Ô∏è  J√° existe: </span><span class="sc">{</span>html_file<span class="sc">.</span>name<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb25-1168"><a href="#cb25-1168" aria-hidden="true" tabindex="-1"></a>                    converted_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb25-1169"><a href="#cb25-1169" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">continue</span></span>
<span id="cb25-1170"><a href="#cb25-1170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1171"><a href="#cb25-1171" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.info(<span class="ss">f"üìÑ Processando: </span><span class="sc">{</span>md_file<span class="sc">.</span>name<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb25-1172"><a href="#cb25-1172" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb25-1173"><a href="#cb25-1173" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> pandoc_available:</span>
<span id="cb25-1174"><a href="#cb25-1174" aria-hidden="true" tabindex="-1"></a>                    html_content <span class="op">=</span> <span class="va">self</span>._convert_with_pandoc_optimized(<span class="bu">str</span>(md_file))</span>
<span id="cb25-1175"><a href="#cb25-1175" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb25-1176"><a href="#cb25-1176" aria-hidden="true" tabindex="-1"></a>                    html_content <span class="op">=</span> <span class="va">self</span>._convert_with_fallback(<span class="bu">str</span>(md_file))</span>
<span id="cb25-1177"><a href="#cb25-1177" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb25-1178"><a href="#cb25-1178" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> html_content:</span>
<span id="cb25-1179"><a href="#cb25-1179" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">with</span> <span class="bu">open</span>(html_file, <span class="st">'w'</span>, encoding<span class="op">=</span><span class="st">'utf-8'</span>) <span class="im">as</span> f:</span>
<span id="cb25-1180"><a href="#cb25-1180" aria-hidden="true" tabindex="-1"></a>                        f.write(html_content)</span>
<span id="cb25-1181"><a href="#cb25-1181" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb25-1182"><a href="#cb25-1182" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.logger.info(<span class="ss">f"‚úÖ Criado: </span><span class="sc">{</span>html_file<span class="sc">.</span>name<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb25-1183"><a href="#cb25-1183" aria-hidden="true" tabindex="-1"></a>                    converted_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb25-1184"><a href="#cb25-1184" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb25-1185"><a href="#cb25-1185" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.logger.error(<span class="ss">f"‚ùå Falha na convers√£o: </span><span class="sc">{</span>md_file<span class="sc">.</span>name<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb25-1186"><a href="#cb25-1186" aria-hidden="true" tabindex="-1"></a>                    failed_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb25-1187"><a href="#cb25-1187" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb25-1188"><a href="#cb25-1188" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb25-1189"><a href="#cb25-1189" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.error(<span class="ss">f"‚ùå Erro em </span><span class="sc">{</span>md_file<span class="sc">.</span>name<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span><span class="bu">str</span>(e)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb25-1190"><a href="#cb25-1190" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.error(traceback.format_exc())</span>
<span id="cb25-1191"><a href="#cb25-1191" aria-hidden="true" tabindex="-1"></a>                failed_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb25-1192"><a href="#cb25-1192" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb25-1193"><a href="#cb25-1193" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.logger.info(<span class="ss">f"üìä HTML: </span><span class="sc">{</span>converted_count<span class="sc">}</span><span class="ss"> arquivos criados, </span><span class="sc">{</span>failed_count<span class="sc">}</span><span class="ss"> falhas em '</span><span class="sc">{</span>html_folder<span class="sc">}</span><span class="ss">'"</span>)</span>
<span id="cb25-1194"><a href="#cb25-1194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1195"><a href="#cb25-1195" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> categorize_conversation(<span class="va">self</span>, title: <span class="bu">str</span>, summary: <span class="bu">str</span>) <span class="op">-></span> <span class="bu">str</span>:</span>
<span id="cb25-1196"><a href="#cb25-1196" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Categoriza√ß√£o otimizada com express√µes regulares"""</span></span>
<span id="cb25-1197"><a href="#cb25-1197" aria-hidden="true" tabindex="-1"></a>        text <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>title<span class="sc">}</span><span class="ss"> </span><span class="sc">{</span>summary<span class="sc">}</span><span class="ss">"</span>.lower()</span>
<span id="cb25-1198"><a href="#cb25-1198" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-1199"><a href="#cb25-1199" aria-hidden="true" tabindex="-1"></a>        patterns <span class="op">=</span> {</span>
<span id="cb25-1200"><a href="#cb25-1200" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Tecnologia'</span>: <span class="vs">r'</span><span class="dv">\b</span><span class="kw">(</span><span class="vs">tecnologia</span><span class="cf">|</span><span class="vs">hardware</span><span class="cf">|</span><span class="vs">software</span><span class="cf">|</span><span class="vs">rede</span><span class="cf">|</span><span class="vs">internet</span><span class="cf">|</span><span class="vs">wifi</span><span class="cf">|</span><span class="vs">bluetooth</span><span class="cf">|</span><span class="pp">[45]</span><span class="vs">g</span><span class="cf">|</span><span class="vs">cloud</span><span class="cf">|</span><span class="vs">aws</span><span class="cf">|</span><span class="vs">azure</span><span class="cf">|</span><span class="vs">gcp</span><span class="cf">|</span><span class="vs">servidor</span><span class="cf">|</span><span class="vs">hosting</span><span class="cf">|</span><span class="vs">dom√≠nio</span><span class="cf">|</span><span class="vs">ssl</span><span class="cf">|</span><span class="vs">router</span><span class="cf">|</span><span class="vs">switch</span><span class="cf">|</span><span class="vs">firewall</span><span class="cf">|</span><span class="vs">iot</span><span class="cf">|</span><span class="vs">smartphone</span><span class="cf">|</span><span class="vs">tablet</span><span class="cf">|</span><span class="vs">navegador</span><span class="cf">|</span><span class="vs">browser</span><span class="cf">|</span><span class="vs">chrome</span><span class="cf">|</span><span class="vs">firefox</span><span class="cf">|</span><span class="vs">edge</span><span class="cf">|</span><span class="vs">safari</span><span class="cf">|</span><span class="vs">email</span><span class="cf">|</span><span class="vs">gmail</span><span class="cf">|</span><span class="vs">outlook</span><span class="cf">|</span><span class="vs">criptografia</span><span class="cf">|</span><span class="vs">seguran√ßa</span><span class="cf">|</span><span class="vs">ciberseguran√ßa</span><span class="cf">|</span><span class="vs">ransomware</span><span class="cf">|</span><span class="vs">phishing</span><span class="cf">|</span><span class="vs">autentica√ß√£o</span><span class="cf">|</span><span class="vs">2fa</span><span class="cf">|</span><span class="vs">biometria</span><span class="kw">)</span><span class="dv">\b</span><span class="vs">'</span>,</span>
<span id="cb25-1201"><a href="#cb25-1201" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Sa√∫de'</span>: <span class="vs">r'</span><span class="dv">\b</span><span class="kw">(</span><span class="vs">sa√∫de</span><span class="cf">|</span><span class="vs">medicina</span><span class="cf">|</span><span class="vs">m√©dico</span><span class="cf">|</span><span class="vs">enfermagem</span><span class="cf">|</span><span class="vs">doen√ßa</span><span class="cf">|</span><span class="vs">v√≠rus</span><span class="cf">|</span><span class="vs">bact√©ria</span><span class="cf">|</span><span class="vs">vacina</span><span class="cf">|</span><span class="vs">covid</span><span class="cf">|</span><span class="vs">coronav√≠rus</span><span class="cf">|</span><span class="vs">gripe</span><span class="cf">|</span><span class="vs">febre</span><span class="cf">|</span><span class="vs">dor</span><span class="cf">|</span><span class="vs">an√°lise</span><span class="cf">|</span><span class="vs">exame</span><span class="cf">|</span><span class="vs">raio x</span><span class="cf">|</span><span class="vs">resson√¢ncia</span><span class="cf">|</span><span class="vs">hospital</span><span class="cf">|</span><span class="vs">cl√≠nica</span><span class="cf">|</span><span class="vs">farm√°cia</span><span class="cf">|</span><span class="vs">medicamento</span><span class="cf">|</span><span class="vs">rem√©dio</span><span class="cf">|</span><span class="vs">psicologia</span><span class="cf">|</span><span class="vs">terapia</span><span class="cf">|</span><span class="vs">bem-estar</span><span class="cf">|</span><span class="vs">nutri√ß√£o</span><span class="cf">|</span><span class="vs">dieta</span><span class="cf">|</span><span class="vs">exerc√≠cio</span><span class="cf">|</span><span class="vs">fitness</span><span class="cf">|</span><span class="vs">sono</span><span class="cf">|</span><span class="vs">sa√∫de mental</span><span class="kw">)</span><span class="dv">\b</span><span class="vs">'</span>,</span>
<span id="cb25-1202"><a href="#cb25-1202" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Programa√ß√£o'</span>: <span class="vs">r'</span><span class="dv">\b</span><span class="kw">(</span><span class="vs">python</span><span class="cf">|</span><span class="vs">javascript</span><span class="cf">|</span><span class="vs">java</span><span class="cf">|</span><span class="vs">c</span><span class="ch">\+\+</span><span class="cf">|</span><span class="vs">c#</span><span class="cf">|</span><span class="vs">go</span><span class="cf">|</span><span class="vs">rust</span><span class="cf">|</span><span class="vs">lua</span><span class="cf">|</span><span class="vs">bash</span><span class="cf">|</span><span class="vs">script</span><span class="cf">|</span><span class="vs">debug</span><span class="cf">|</span><span class="vs">erro</span><span class="cf">|</span><span class="vs">conda</span><span class="cf">|</span><span class="vs">mamba</span><span class="cf">|</span><span class="vs">pandoc</span><span class="cf">|</span><span class="vs">msys2</span><span class="cf">|</span><span class="vs">spyder</span><span class="cf">|</span><span class="vs">jupyter</span><span class="cf">|</span><span class="vs">pip</span><span class="cf">|</span><span class="vs">venv</span><span class="cf">|</span><span class="vs">docker</span><span class="cf">|</span><span class="vs">git</span><span class="cf">|</span><span class="vs">github</span><span class="cf">|</span><span class="vs">vscode</span><span class="cf">|</span><span class="vs">ide</span><span class="cf">|</span><span class="vs">programa</span><span class="cf">|</span><span class="vs">c√≥digo</span><span class="cf">|</span><span class="vs">fun√ß√£o</span><span class="cf">|</span><span class="vs">classe</span><span class="cf">|</span><span class="vs">api</span><span class="cf">|</span><span class="vs">selenium</span><span class="cf">|</span><span class="vs">playwright</span><span class="kw">)</span><span class="dv">\b</span><span class="vs">'</span>,</span>
<span id="cb25-1203"><a href="#cb25-1203" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Sistemas'</span>: <span class="vs">r'</span><span class="dv">\b</span><span class="kw">(</span><span class="vs">windows</span><span class="cf">|</span><span class="vs">linux</span><span class="cf">|</span><span class="vs">macos</span><span class="cf">|</span><span class="vs">so</span><span class="cf">|</span><span class="vs">sistema operacional</span><span class="cf">|</span><span class="vs">driver</span><span class="cf">|</span><span class="vs">registry</span><span class="cf">|</span><span class="vs">process</span><span class="cf">|</span><span class="vs">firewall</span><span class="cf">|</span><span class="vs">bios</span><span class="cf">|</span><span class="vs">boot</span><span class="cf">|</span><span class="vs">path</span><span class="cf">|</span><span class="vs">dll</span><span class="cf">|</span><span class="vs">exe</span><span class="cf">|</span><span class="vs">powershell</span><span class="cf">|</span><span class="vs">cmd</span><span class="cf">|</span><span class="vs">terminal</span><span class="cf">|</span><span class="vs">shell</span><span class="kw">)</span><span class="dv">\b</span><span class="vs">'</span>,</span>
<span id="cb25-1204"><a href="#cb25-1204" aria-hidden="true" tabindex="-1"></a>            <span class="st">'IA'</span>: <span class="vs">r'</span><span class="dv">\b</span><span class="kw">(</span><span class="vs">ia</span><span class="cf">|</span><span class="vs">gpt</span><span class="cf">|</span><span class="vs">chatgpt</span><span class="cf">|</span><span class="vs">grok</span><span class="cf">|</span><span class="vs">qwen</span><span class="cf">|</span><span class="vs">deepseek</span><span class="cf">|</span><span class="vs">llm</span><span class="cf">|</span><span class="vs">modelo</span><span class="cf">|</span><span class="vs">prompt</span><span class="cf">|</span><span class="vs">token</span><span class="cf">|</span><span class="vs">embedding</span><span class="cf">|</span><span class="vs">fine-tune</span><span class="cf">|</span><span class="vs">neural</span><span class="cf">|</span><span class="vs">chatbot</span><span class="cf">|</span><span class="vs">intelig√™ncia artificial</span><span class="kw">)</span><span class="dv">\b</span><span class="vs">'</span>,</span>
<span id="cb25-1205"><a href="#cb25-1205" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Dados'</span>: <span class="vs">r'</span><span class="dv">\b</span><span class="kw">(</span><span class="vs">dados</span><span class="cf">|</span><span class="vs">data</span><span class="cf">|</span><span class="vs">csv</span><span class="cf">|</span><span class="vs">json</span><span class="cf">|</span><span class="vs">pandas</span><span class="cf">|</span><span class="vs">numpy</span><span class="cf">|</span><span class="vs">excel</span><span class="cf">|</span><span class="vs">sql</span><span class="cf">|</span><span class="vs">banco</span><span class="cf">|</span><span class="vs">sqlite</span><span class="cf">|</span><span class="vs">postgres</span><span class="cf">|</span><span class="vs">visualiza√ß√£o</span><span class="cf">|</span><span class="vs">gr√°fico</span><span class="cf">|</span><span class="vs">tabela</span><span class="cf">|</span><span class="vs">an√°lise</span><span class="cf">|</span><span class="vs">etl</span><span class="cf">|</span><span class="vs">dashboard</span><span class="kw">)</span><span class="dv">\b</span><span class="vs">'</span>,</span>
<span id="cb25-1206"><a href="#cb25-1206" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Geral'</span>: <span class="vs">r'</span><span class="dv">\b</span><span class="kw">(</span><span class="vs">geral</span><span class="cf">|</span><span class="vs">pergunta</span><span class="cf">|</span><span class="vs">ajuda</span><span class="cf">|</span><span class="vs">como fazer</span><span class="cf">|</span><span class="vs">explicar</span><span class="cf">|</span><span class="vs">resumo</span><span class="cf">|</span><span class="vs">tutorial b√°sico</span><span class="kw">)</span><span class="dv">\b</span><span class="vs">'</span></span>
<span id="cb25-1207"><a href="#cb25-1207" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb25-1208"><a href="#cb25-1208" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-1209"><a href="#cb25-1209" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> category, pattern <span class="kw">in</span> patterns.items():</span>
<span id="cb25-1210"><a href="#cb25-1210" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> re.search(pattern, text, re.IGNORECASE):</span>
<span id="cb25-1211"><a href="#cb25-1211" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> category</span>
<span id="cb25-1212"><a href="#cb25-1212" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb25-1213"><a href="#cb25-1213" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">'Outros'</span></span>
<span id="cb25-1214"><a href="#cb25-1214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1215"><a href="#cb25-1215" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> parse_timestamp_for_sorting(<span class="va">self</span>, timestamp) <span class="op">-></span> datetime:</span>
<span id="cb25-1216"><a href="#cb25-1216" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> timestamp:</span>
<span id="cb25-1217"><a href="#cb25-1217" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> datetime.<span class="bu">min</span></span>
<span id="cb25-1218"><a href="#cb25-1218" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-1219"><a href="#cb25-1219" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb25-1220"><a href="#cb25-1220" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">isinstance</span>(timestamp, <span class="bu">str</span>):</span>
<span id="cb25-1221"><a href="#cb25-1221" aria-hidden="true" tabindex="-1"></a>                clean_ts <span class="op">=</span> timestamp.replace(<span class="st">'T'</span>, <span class="st">' '</span>).split(<span class="st">'.'</span>)[<span class="dv">0</span>].split(<span class="st">'+'</span>)[<span class="dv">0</span>]</span>
<span id="cb25-1222"><a href="#cb25-1222" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> clean_ts.endswith(<span class="st">'Z'</span>):</span>
<span id="cb25-1223"><a href="#cb25-1223" aria-hidden="true" tabindex="-1"></a>                    clean_ts <span class="op">=</span> clean_ts[:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb25-1224"><a href="#cb25-1224" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> datetime.fromisoformat(clean_ts)</span>
<span id="cb25-1225"><a href="#cb25-1225" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> <span class="bu">isinstance</span>(timestamp, (<span class="bu">int</span>, <span class="bu">float</span>)):</span>
<span id="cb25-1226"><a href="#cb25-1226" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> datetime.fromtimestamp(timestamp)</span>
<span id="cb25-1227"><a href="#cb25-1227" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span>:</span>
<span id="cb25-1228"><a href="#cb25-1228" aria-hidden="true" tabindex="-1"></a>            <span class="cf">pass</span></span>
<span id="cb25-1229"><a href="#cb25-1229" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-1230"><a href="#cb25-1230" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> datetime.<span class="bu">min</span></span>
<span id="cb25-1231"><a href="#cb25-1231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1232"><a href="#cb25-1232" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> format_timestamp(<span class="va">self</span>, timestamp) <span class="op">-></span> Optional[<span class="bu">str</span>]:</span>
<span id="cb25-1233"><a href="#cb25-1233" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> timestamp:</span>
<span id="cb25-1234"><a href="#cb25-1234" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb25-1235"><a href="#cb25-1235" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-1236"><a href="#cb25-1236" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb25-1237"><a href="#cb25-1237" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">isinstance</span>(timestamp, (<span class="bu">int</span>, <span class="bu">float</span>)):</span>
<span id="cb25-1238"><a href="#cb25-1238" aria-hidden="true" tabindex="-1"></a>                dt <span class="op">=</span> datetime.fromtimestamp(timestamp)</span>
<span id="cb25-1239"><a href="#cb25-1239" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> dt.strftime(<span class="st">'%Y-%m-</span><span class="sc">%d</span><span class="st"> %H:%M:%S'</span>)</span>
<span id="cb25-1240"><a href="#cb25-1240" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> <span class="bu">isinstance</span>(timestamp, <span class="bu">str</span>):</span>
<span id="cb25-1241"><a href="#cb25-1241" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="st">'T'</span> <span class="kw">in</span> timestamp:</span>
<span id="cb25-1242"><a href="#cb25-1242" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">return</span> timestamp.replace(<span class="st">'T'</span>, <span class="st">' '</span>).split(<span class="st">'.'</span>)[<span class="dv">0</span>]</span>
<span id="cb25-1243"><a href="#cb25-1243" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> timestamp</span>
<span id="cb25-1244"><a href="#cb25-1244" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span>:</span>
<span id="cb25-1245"><a href="#cb25-1245" aria-hidden="true" tabindex="-1"></a>            <span class="cf">pass</span></span>
<span id="cb25-1246"><a href="#cb25-1246" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-1247"><a href="#cb25-1247" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">str</span>(timestamp)</span>
<span id="cb25-1248"><a href="#cb25-1248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1249"><a href="#cb25-1249" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_enhanced_markdown_content(<span class="va">self</span>, conversation: Dict[<span class="bu">str</span>, Any]) <span class="op">-></span> <span class="bu">str</span>:</span>
<span id="cb25-1250"><a href="#cb25-1250" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Gera conte√∫do Markdown com preserva√ß√£o total de formata√ß√£o"""</span></span>
<span id="cb25-1251"><a href="#cb25-1251" aria-hidden="true" tabindex="-1"></a>        lines <span class="op">=</span> [</span>
<span id="cb25-1252"><a href="#cb25-1252" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f"# </span><span class="sc">{</span>conversation[<span class="st">'title'</span>]<span class="sc">}</span><span class="ss">"</span>,</span>
<span id="cb25-1253"><a href="#cb25-1253" aria-hidden="true" tabindex="-1"></a>            <span class="st">""</span>,</span>
<span id="cb25-1254"><a href="#cb25-1254" aria-hidden="true" tabindex="-1"></a>            <span class="st">"## üìä Informa√ß√µes"</span>,</span>
<span id="cb25-1255"><a href="#cb25-1255" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f"- **N√∫mero:** #</span><span class="sc">{</span>conversation[<span class="st">'number'</span>]<span class="sc">}</span><span class="ss">"</span>,</span>
<span id="cb25-1256"><a href="#cb25-1256" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f"- **Origem:** </span><span class="sc">{</span>conversation[<span class="st">'source'</span>]<span class="sc">}</span><span class="ss">"</span>,</span>
<span id="cb25-1257"><a href="#cb25-1257" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f"- **Categoria:** </span><span class="sc">{</span>conversation[<span class="st">'category'</span>]<span class="sc">}</span><span class="ss">"</span>,</span>
<span id="cb25-1258"><a href="#cb25-1258" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f"- **ID:** </span><span class="sc">{</span>conversation<span class="sc">.</span>get(<span class="st">'id'</span>, <span class="st">'N/A'</span>)<span class="sc">}</span><span class="ss">"</span>,</span>
<span id="cb25-1259"><a href="#cb25-1259" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f"- **Criada em:** </span><span class="sc">{</span>conversation<span class="sc">.</span>get(<span class="st">'inserted_at'</span>) <span class="kw">or</span> conversation<span class="sc">.</span>get(<span class="st">'created_at'</span>) <span class="kw">or</span> <span class="st">'N/A'</span><span class="sc">}</span><span class="ss">"</span>,</span>
<span id="cb25-1260"><a href="#cb25-1260" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb25-1261"><a href="#cb25-1261" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-1262"><a href="#cb25-1262" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> conversation.get(<span class="st">'updated_at'</span>):</span>
<span id="cb25-1263"><a href="#cb25-1263" aria-hidden="true" tabindex="-1"></a>            lines.append(<span class="ss">f"- **Atualizada em:** </span><span class="sc">{</span>conversation[<span class="st">'updated_at'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb25-1264"><a href="#cb25-1264" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-1265"><a href="#cb25-1265" aria-hidden="true" tabindex="-1"></a>        lines.extend([</span>
<span id="cb25-1266"><a href="#cb25-1266" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f"- **Total de mensagens:** </span><span class="sc">{</span><span class="bu">len</span>(conversation[<span class="st">'messages'</span>])<span class="sc">}</span><span class="ss">"</span>,</span>
<span id="cb25-1267"><a href="#cb25-1267" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f"- **Resumo:** </span><span class="sc">{</span>conversation<span class="sc">.</span>get(<span class="st">'summary'</span>, <span class="st">'Sem resumo'</span>)<span class="sc">}</span><span class="ss">"</span>,</span>
<span id="cb25-1268"><a href="#cb25-1268" aria-hidden="true" tabindex="-1"></a>            <span class="st">""</span>,</span>
<span id="cb25-1269"><a href="#cb25-1269" aria-hidden="true" tabindex="-1"></a>            <span class="st">"---"</span>,</span>
<span id="cb25-1270"><a href="#cb25-1270" aria-hidden="true" tabindex="-1"></a>            <span class="st">""</span>,</span>
<span id="cb25-1271"><a href="#cb25-1271" aria-hidden="true" tabindex="-1"></a>            <span class="st">"## üí¨ Conversa"</span>,</span>
<span id="cb25-1272"><a href="#cb25-1272" aria-hidden="true" tabindex="-1"></a>            <span class="st">""</span></span>
<span id="cb25-1273"><a href="#cb25-1273" aria-hidden="true" tabindex="-1"></a>        ])</span>
<span id="cb25-1274"><a href="#cb25-1274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1275"><a href="#cb25-1275" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, msg <span class="kw">in</span> <span class="bu">enumerate</span>(conversation[<span class="st">'messages'</span>], <span class="dv">1</span>):</span>
<span id="cb25-1276"><a href="#cb25-1276" aria-hidden="true" tabindex="-1"></a>            timestamp <span class="op">=</span> <span class="ss">f" *(</span><span class="sc">{</span>msg[<span class="st">'timestamp'</span>]<span class="sc">}</span><span class="ss">)*"</span> <span class="cf">if</span> msg[<span class="st">'timestamp'</span>] <span class="cf">else</span> <span class="st">""</span></span>
<span id="cb25-1277"><a href="#cb25-1277" aria-hidden="true" tabindex="-1"></a>            model_info <span class="op">=</span> <span class="ss">f" *[</span><span class="sc">{</span>msg<span class="sc">.</span>get(<span class="st">'model'</span>, <span class="st">''</span>)<span class="sc">}</span><span class="ss">]*"</span> <span class="cf">if</span> msg.get(<span class="st">'model'</span>) <span class="cf">else</span> <span class="st">""</span></span>
<span id="cb25-1278"><a href="#cb25-1278" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-1279"><a href="#cb25-1279" aria-hidden="true" tabindex="-1"></a>            preserved_content <span class="op">=</span> <span class="va">self</span>.preserve_special_content(msg[<span class="st">'content'</span>])</span>
<span id="cb25-1280"><a href="#cb25-1280" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-1281"><a href="#cb25-1281" aria-hidden="true" tabindex="-1"></a>            lines.extend([</span>
<span id="cb25-1282"><a href="#cb25-1282" aria-hidden="true" tabindex="-1"></a>                <span class="ss">f"### </span><span class="sc">{</span>msg[<span class="st">'author'</span>]<span class="sc">}{</span>timestamp<span class="sc">}{</span>model_info<span class="sc">}</span><span class="ss">"</span>,</span>
<span id="cb25-1283"><a href="#cb25-1283" aria-hidden="true" tabindex="-1"></a>                <span class="st">""</span>,</span>
<span id="cb25-1284"><a href="#cb25-1284" aria-hidden="true" tabindex="-1"></a>                <span class="ss">f"</span><span class="sc">{</span>preserved_content<span class="sc">}</span><span class="ss">"</span>,</span>
<span id="cb25-1285"><a href="#cb25-1285" aria-hidden="true" tabindex="-1"></a>                <span class="st">""</span></span>
<span id="cb25-1286"><a href="#cb25-1286" aria-hidden="true" tabindex="-1"></a>            ])</span>
<span id="cb25-1287"><a href="#cb25-1287" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-1288"><a href="#cb25-1288" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> j <span class="op"><</span> <span class="bu">len</span>(conversation[<span class="st">'messages'</span>]):</span>
<span id="cb25-1289"><a href="#cb25-1289" aria-hidden="true" tabindex="-1"></a>                lines.extend([<span class="st">"---"</span>, <span class="st">""</span>])</span>
<span id="cb25-1290"><a href="#cb25-1290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1291"><a href="#cb25-1291" aria-hidden="true" tabindex="-1"></a>        lines.extend([</span>
<span id="cb25-1292"><a href="#cb25-1292" aria-hidden="true" tabindex="-1"></a>            <span class="st">"---"</span>,</span>
<span id="cb25-1293"><a href="#cb25-1293" aria-hidden="true" tabindex="-1"></a>            <span class="st">""</span>,</span>
<span id="cb25-1294"><a href="#cb25-1294" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f"*Conversa exportada do </span><span class="sc">{</span>conversation[<span class="st">'source'</span>]<span class="sc">}</span><span class="ss">*"</span>,</span>
<span id="cb25-1295"><a href="#cb25-1295" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f"*Processado em: </span><span class="sc">{</span>datetime<span class="sc">.</span>now()<span class="sc">.</span>strftime(<span class="st">'</span><span class="sc">%d</span><span class="st">/%m/%Y %H:%M'</span>)<span class="sc">}</span><span class="ss">*"</span></span>
<span id="cb25-1296"><a href="#cb25-1296" aria-hidden="true" tabindex="-1"></a>        ])</span>
<span id="cb25-1297"><a href="#cb25-1297" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-1298"><a href="#cb25-1298" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">'</span><span class="ch">\n</span><span class="st">'</span>.join(lines)</span>
<span id="cb25-1299"><a href="#cb25-1299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1300"><a href="#cb25-1300" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> process_qwen_corrected(<span class="va">self</span>, path: Path):</span>
<span id="cb25-1301"><a href="#cb25-1301" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Processa Qwen3 com corre√ß√£o para content_list - VERS√ÉO CORRIGIDA"""</span></span>
<span id="cb25-1302"><a href="#cb25-1302" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb25-1303"><a href="#cb25-1303" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="ss">f"üîÆ [DRY-RUN] Processaria Qwen3: </span><span class="sc">{</span>path<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb25-1304"><a href="#cb25-1304" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb25-1305"><a href="#cb25-1305" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-1306"><a href="#cb25-1306" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb25-1307"><a href="#cb25-1307" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(path, <span class="st">'r'</span>, encoding<span class="op">=</span><span class="st">'utf-8'</span>) <span class="im">as</span> f:</span>
<span id="cb25-1308"><a href="#cb25-1308" aria-hidden="true" tabindex="-1"></a>                raw_data <span class="op">=</span> json.load(f)</span>
<span id="cb25-1309"><a href="#cb25-1309" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb25-1310"><a href="#cb25-1310" aria-hidden="true" tabindex="-1"></a>            <span class="co"># DEBUG: Salvar estrutura completa para an√°lise</span></span>
<span id="cb25-1311"><a href="#cb25-1311" aria-hidden="true" tabindex="-1"></a>            debug_file <span class="op">=</span> Path(<span class="st">"qwen_debug_structure.json"</span>)</span>
<span id="cb25-1312"><a href="#cb25-1312" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(debug_file, <span class="st">'w'</span>, encoding<span class="op">=</span><span class="st">'utf-8'</span>) <span class="im">as</span> f:</span>
<span id="cb25-1313"><a href="#cb25-1313" aria-hidden="true" tabindex="-1"></a>                json.dump(raw_data, f, indent<span class="op">=</span><span class="dv">2</span>, ensure_ascii<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb25-1314"><a href="#cb25-1314" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="ss">f"üîç Estrutura Qwen salva em: </span><span class="sc">{</span>debug_file<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb25-1315"><a href="#cb25-1315" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-1316"><a href="#cb25-1316" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Extrair conversas</span></span>
<span id="cb25-1317"><a href="#cb25-1317" aria-hidden="true" tabindex="-1"></a>            conversations <span class="op">=</span> []</span>
<span id="cb25-1318"><a href="#cb25-1318" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-1319"><a href="#cb25-1319" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="st">'data'</span> <span class="kw">in</span> raw_data <span class="kw">and</span> <span class="bu">isinstance</span>(raw_data[<span class="st">'data'</span>], <span class="bu">list</span>):</span>
<span id="cb25-1320"><a href="#cb25-1320" aria-hidden="true" tabindex="-1"></a>                conversations <span class="op">=</span> raw_data[<span class="st">'data'</span>]</span>
<span id="cb25-1321"><a href="#cb25-1321" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.info(<span class="ss">f"üìÅ Estrutura 1: </span><span class="sc">{</span><span class="bu">len</span>(conversations)<span class="sc">}</span><span class="ss"> conversas em 'data'"</span>)</span>
<span id="cb25-1322"><a href="#cb25-1322" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> <span class="bu">isinstance</span>(raw_data, <span class="bu">list</span>):</span>
<span id="cb25-1323"><a href="#cb25-1323" aria-hidden="true" tabindex="-1"></a>                conversations <span class="op">=</span> raw_data</span>
<span id="cb25-1324"><a href="#cb25-1324" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.info(<span class="ss">f"üìÅ Estrutura 2: </span><span class="sc">{</span><span class="bu">len</span>(conversations)<span class="sc">}</span><span class="ss"> conversas na raiz"</span>)</span>
<span id="cb25-1325"><a href="#cb25-1325" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb25-1326"><a href="#cb25-1326" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> key, value <span class="kw">in</span> raw_data.items():</span>
<span id="cb25-1327"><a href="#cb25-1327" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="bu">isinstance</span>(value, <span class="bu">list</span>) <span class="kw">and</span> <span class="bu">len</span>(value) <span class="op">></span> <span class="dv">0</span>:</span>
<span id="cb25-1328"><a href="#cb25-1328" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">if</span> <span class="bu">isinstance</span>(value[<span class="dv">0</span>], <span class="bu">dict</span>) <span class="kw">and</span> <span class="bu">any</span>(k <span class="kw">in</span> value[<span class="dv">0</span>] <span class="cf">for</span> k <span class="kw">in</span> [<span class="st">'title'</span>, <span class="st">'chat'</span>, <span class="st">'messages'</span>]):</span>
<span id="cb25-1329"><a href="#cb25-1329" aria-hidden="true" tabindex="-1"></a>                            conversations <span class="op">=</span> value</span>
<span id="cb25-1330"><a href="#cb25-1330" aria-hidden="true" tabindex="-1"></a>                            <span class="va">self</span>.logger.info(<span class="ss">f"üìÅ Estrutura alternativa: </span><span class="sc">{</span><span class="bu">len</span>(conversations)<span class="sc">}</span><span class="ss"> conversas em '</span><span class="sc">{</span>key<span class="sc">}</span><span class="ss">'"</span>)</span>
<span id="cb25-1331"><a href="#cb25-1331" aria-hidden="true" tabindex="-1"></a>                            <span class="cf">break</span></span>
<span id="cb25-1332"><a href="#cb25-1332" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-1333"><a href="#cb25-1333" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> conversations:</span>
<span id="cb25-1334"><a href="#cb25-1334" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.error(<span class="st">"‚ùå Nenhuma conversa encontrada no arquivo Qwen"</span>)</span>
<span id="cb25-1335"><a href="#cb25-1335" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span></span>
<span id="cb25-1336"><a href="#cb25-1336" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb25-1337"><a href="#cb25-1337" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="ss">f"üîç Qwen: encontradas </span><span class="sc">{</span><span class="bu">len</span>(conversations)<span class="sc">}</span><span class="ss"> conversas."</span>)</span>
<span id="cb25-1338"><a href="#cb25-1338" aria-hidden="true" tabindex="-1"></a>            processed_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb25-1339"><a href="#cb25-1339" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-1340"><a href="#cb25-1340" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> i, conv <span class="kw">in</span> <span class="bu">enumerate</span>(conversations):</span>
<span id="cb25-1341"><a href="#cb25-1341" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(conv, <span class="bu">dict</span>):</span>
<span id="cb25-1342"><a href="#cb25-1342" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">continue</span></span>
<span id="cb25-1343"><a href="#cb25-1343" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb25-1344"><a href="#cb25-1344" aria-hidden="true" tabindex="-1"></a>                original_title <span class="op">=</span> conv.get(<span class="st">'title'</span>, <span class="ss">f'Conversa Qwen </span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb25-1345"><a href="#cb25-1345" aria-hidden="true" tabindex="-1"></a>                clean_title <span class="op">=</span> <span class="va">self</span>.preserve_original_title(original_title)</span>
<span id="cb25-1346"><a href="#cb25-1346" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb25-1347"><a href="#cb25-1347" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.info(<span class="ss">f"   üîç Processando: '</span><span class="sc">{</span>clean_title<span class="sc">}</span><span class="ss">'"</span>)</span>
<span id="cb25-1348"><a href="#cb25-1348" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb25-1349"><a href="#cb25-1349" aria-hidden="true" tabindex="-1"></a>                <span class="co"># EXTRA√á√ÉO CORRIGIDA - foco em content_list</span></span>
<span id="cb25-1350"><a href="#cb25-1350" aria-hidden="true" tabindex="-1"></a>                messages <span class="op">=</span> <span class="va">self</span>._extract_qwen_messages_corrected(conv, clean_title, i)</span>
<span id="cb25-1351"><a href="#cb25-1351" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb25-1352"><a href="#cb25-1352" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> messages:</span>
<span id="cb25-1353"><a href="#cb25-1353" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># Ordenar mensagens por timestamp</span></span>
<span id="cb25-1354"><a href="#cb25-1354" aria-hidden="true" tabindex="-1"></a>                    messages.sort(key<span class="op">=</span><span class="kw">lambda</span> x: <span class="va">self</span>.parse_timestamp_for_sorting(x[<span class="st">'timestamp'</span>]))</span>
<span id="cb25-1355"><a href="#cb25-1355" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb25-1356"><a href="#cb25-1356" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.all_conversations.append({</span>
<span id="cb25-1357"><a href="#cb25-1357" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'title'</span>: clean_title,</span>
<span id="cb25-1358"><a href="#cb25-1358" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'source'</span>: <span class="st">'Qwen3'</span>,</span>
<span id="cb25-1359"><a href="#cb25-1359" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'id'</span>: conv.get(<span class="st">'id'</span>, <span class="ss">f'qwen_</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">'</span>),</span>
<span id="cb25-1360"><a href="#cb25-1360" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'inserted_at'</span>: <span class="va">self</span>.format_timestamp(conv.get(<span class="st">'created_at'</span>)),</span>
<span id="cb25-1361"><a href="#cb25-1361" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'updated_at'</span>: <span class="va">self</span>.format_timestamp(conv.get(<span class="st">'updated_at'</span>)),</span>
<span id="cb25-1362"><a href="#cb25-1362" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'messages'</span>: messages,</span>
<span id="cb25-1363"><a href="#cb25-1363" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'summary'</span>: messages[<span class="dv">0</span>][<span class="st">'content'</span>][:<span class="dv">100</span>] <span class="op">+</span> <span class="st">"..."</span> <span class="cf">if</span> messages <span class="cf">else</span> <span class="st">"Sem conte√∫do"</span>,</span>
<span id="cb25-1364"><a href="#cb25-1364" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'category'</span>: <span class="va">self</span>.categorize_conversation(clean_title, messages[<span class="dv">0</span>][<span class="st">'content'</span>][:<span class="dv">100</span>] <span class="cf">if</span> messages <span class="cf">else</span> <span class="st">""</span>)</span>
<span id="cb25-1365"><a href="#cb25-1365" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb25-1366"><a href="#cb25-1366" aria-hidden="true" tabindex="-1"></a>                    processed_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb25-1367"><a href="#cb25-1367" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.logger.info(<span class="ss">f"   ‚úÖ Adicionada: </span><span class="sc">{</span><span class="bu">len</span>(messages)<span class="sc">}</span><span class="ss"> mensagens"</span>)</span>
<span id="cb25-1368"><a href="#cb25-1368" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb25-1369"><a href="#cb25-1369" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.logger.warning(<span class="ss">f"   ‚ùå Conversa </span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">: nenhuma mensagem extra√≠da"</span>)</span>
<span id="cb25-1370"><a href="#cb25-1370" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb25-1371"><a href="#cb25-1371" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="ss">f"‚úÖ Qwen3: </span><span class="sc">{</span>processed_count<span class="sc">}</span><span class="ss"> conversas processadas."</span>)</span>
<span id="cb25-1372"><a href="#cb25-1372" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-1373"><a href="#cb25-1373" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb25-1374"><a href="#cb25-1374" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.error(<span class="ss">f"‚ùå Erro ao processar Qwen3: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb25-1375"><a href="#cb25-1375" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.error(traceback.format_exc())</span>
<span id="cb25-1376"><a href="#cb25-1376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1377"><a href="#cb25-1377" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _extract_qwen_messages_corrected(<span class="va">self</span>, conv: Dict[<span class="bu">str</span>, Any], clean_title: <span class="bu">str</span>, conv_index: <span class="bu">int</span>) <span class="op">-></span> List[Dict[<span class="bu">str</span>, Any]]:</span>
<span id="cb25-1378"><a href="#cb25-1378" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Extrai mensagens do Qwen com corre√ß√£o para content_list"""</span></span>
<span id="cb25-1379"><a href="#cb25-1379" aria-hidden="true" tabindex="-1"></a>        all_messages <span class="op">=</span> []</span>
<span id="cb25-1380"><a href="#cb25-1380" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-1381"><a href="#cb25-1381" aria-hidden="true" tabindex="-1"></a>        <span class="co"># ESTRAT√âGIA PRINCIPAL: Buscar em toda a estrutura por mensagens</span></span>
<span id="cb25-1382"><a href="#cb25-1382" aria-hidden="true" tabindex="-1"></a>        <span class="kw">def</span> extract_from_object(obj, path<span class="op">=</span><span class="st">""</span>):</span>
<span id="cb25-1383"><a href="#cb25-1383" aria-hidden="true" tabindex="-1"></a>            messages_found <span class="op">=</span> []</span>
<span id="cb25-1384"><a href="#cb25-1384" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-1385"><a href="#cb25-1385" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">isinstance</span>(obj, <span class="bu">dict</span>):</span>
<span id="cb25-1386"><a href="#cb25-1386" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Verificar se √© uma mensagem com content_list (CASO CORRIGIDO)</span></span>
<span id="cb25-1387"><a href="#cb25-1387" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="va">self</span>._is_qwen_message_with_content(obj):</span>
<span id="cb25-1388"><a href="#cb25-1388" aria-hidden="true" tabindex="-1"></a>                    message <span class="op">=</span> <span class="va">self</span>._create_message_from_qwen_object(obj)</span>
<span id="cb25-1389"><a href="#cb25-1389" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> message:</span>
<span id="cb25-1390"><a href="#cb25-1390" aria-hidden="true" tabindex="-1"></a>                        messages_found.append(message)</span>
<span id="cb25-1391"><a href="#cb25-1391" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb25-1392"><a href="#cb25-1392" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Buscar recursivamente</span></span>
<span id="cb25-1393"><a href="#cb25-1393" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> key, value <span class="kw">in</span> obj.items():</span>
<span id="cb25-1394"><a href="#cb25-1394" aria-hidden="true" tabindex="-1"></a>                    messages_found.extend(extract_from_object(value, <span class="ss">f"</span><span class="sc">{</span>path<span class="sc">}</span><span class="ss">.</span><span class="sc">{</span>key<span class="sc">}</span><span class="ss">"</span>))</span>
<span id="cb25-1395"><a href="#cb25-1395" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb25-1396"><a href="#cb25-1396" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> <span class="bu">isinstance</span>(obj, <span class="bu">list</span>):</span>
<span id="cb25-1397"><a href="#cb25-1397" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> item <span class="kw">in</span> obj:</span>
<span id="cb25-1398"><a href="#cb25-1398" aria-hidden="true" tabindex="-1"></a>                    messages_found.extend(extract_from_object(item, path))</span>
<span id="cb25-1399"><a href="#cb25-1399" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb25-1400"><a href="#cb25-1400" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> messages_found</span>
<span id="cb25-1401"><a href="#cb25-1401" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-1402"><a href="#cb25-1402" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Aplicar extra√ß√£o recursiva</span></span>
<span id="cb25-1403"><a href="#cb25-1403" aria-hidden="true" tabindex="-1"></a>        all_messages <span class="op">=</span> extract_from_object(conv, <span class="st">"root"</span>)</span>
<span id="cb25-1404"><a href="#cb25-1404" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-1405"><a href="#cb25-1405" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Remover duplicatas</span></span>
<span id="cb25-1406"><a href="#cb25-1406" aria-hidden="true" tabindex="-1"></a>        unique_messages <span class="op">=</span> <span class="va">self</span>._remove_duplicate_messages(all_messages)</span>
<span id="cb25-1407"><a href="#cb25-1407" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-1408"><a href="#cb25-1408" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(unique_messages) <span class="op">!=</span> <span class="bu">len</span>(all_messages):</span>
<span id="cb25-1409"><a href="#cb25-1409" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="ss">f"         üîÑ Removidas </span><span class="sc">{</span><span class="bu">len</span>(all_messages) <span class="op">-</span> <span class="bu">len</span>(unique_messages)<span class="sc">}</span><span class="ss"> mensagens duplicadas"</span>)</span>
<span id="cb25-1410"><a href="#cb25-1410" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-1411"><a href="#cb25-1411" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> unique_messages</span>
<span id="cb25-1412"><a href="#cb25-1412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1413"><a href="#cb25-1413" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _is_qwen_message_with_content(<span class="va">self</span>, obj: Dict) <span class="op">-></span> <span class="bu">bool</span>:</span>
<span id="cb25-1414"><a href="#cb25-1414" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Verifica se √© uma mensagem Qwen v√°lida (incluindo content_list)"""</span></span>
<span id="cb25-1415"><a href="#cb25-1415" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Verificar campos b√°sicos de mensagem</span></span>
<span id="cb25-1416"><a href="#cb25-1416" aria-hidden="true" tabindex="-1"></a>        has_basic_structure <span class="op">=</span> (<span class="st">'role'</span> <span class="kw">in</span> obj <span class="kw">and</span> <span class="st">'content'</span> <span class="kw">in</span> obj)</span>
<span id="cb25-1417"><a href="#cb25-1417" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-1418"><a href="#cb25-1418" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Verificar se tem content_list (CORRE√á√ÉO DO PROBLEMA)</span></span>
<span id="cb25-1419"><a href="#cb25-1419" aria-hidden="true" tabindex="-1"></a>        has_content_list <span class="op">=</span> <span class="st">'content_list'</span> <span class="kw">in</span> obj <span class="kw">and</span> <span class="bu">isinstance</span>(obj[<span class="st">'content_list'</span>], <span class="bu">list</span>)</span>
<span id="cb25-1420"><a href="#cb25-1420" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-1421"><a href="#cb25-1421" aria-hidden="true" tabindex="-1"></a>        <span class="co"># √â uma mensagem v√°lida se tiver estrutura b√°sica E (conte√∫do n√£o vazio OU content_list)</span></span>
<span id="cb25-1422"><a href="#cb25-1422" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> (has_basic_structure <span class="kw">and</span> </span>
<span id="cb25-1423"><a href="#cb25-1423" aria-hidden="true" tabindex="-1"></a>                (obj.get(<span class="st">'content'</span>) <span class="kw">or</span> has_content_list) <span class="kw">and</span></span>
<span id="cb25-1424"><a href="#cb25-1424" aria-hidden="true" tabindex="-1"></a>                obj.get(<span class="st">'role'</span>) <span class="kw">in</span> [<span class="st">'user'</span>, <span class="st">'assistant'</span>])</span>
<span id="cb25-1425"><a href="#cb25-1425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1426"><a href="#cb25-1426" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _create_message_from_qwen_object(<span class="va">self</span>, obj: Dict) <span class="op">-></span> Optional[Dict[<span class="bu">str</span>, Any]]:</span>
<span id="cb25-1427"><a href="#cb25-1427" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Cria uma mensagem a partir de um objeto Qwen, priorizando content_list"""</span></span>
<span id="cb25-1428"><a href="#cb25-1428" aria-hidden="true" tabindex="-1"></a>        role <span class="op">=</span> obj.get(<span class="st">'role'</span>, <span class="st">''</span>)</span>
<span id="cb25-1429"><a href="#cb25-1429" aria-hidden="true" tabindex="-1"></a>        content <span class="op">=</span> obj.get(<span class="st">'content'</span>, <span class="st">''</span>)</span>
<span id="cb25-1430"><a href="#cb25-1430" aria-hidden="true" tabindex="-1"></a>        content_list <span class="op">=</span> obj.get(<span class="st">'content_list'</span>, [])</span>
<span id="cb25-1431"><a href="#cb25-1431" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-1432"><a href="#cb25-1432" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> role:</span>
<span id="cb25-1433"><a href="#cb25-1433" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb25-1434"><a href="#cb25-1434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1435"><a href="#cb25-1435" aria-hidden="true" tabindex="-1"></a>        <span class="co"># CORRE√á√ÉO PRINCIPAL: Priorizar content_list quando content estiver vazio</span></span>
<span id="cb25-1436"><a href="#cb25-1436" aria-hidden="true" tabindex="-1"></a>        final_content <span class="op">=</span> <span class="st">""</span></span>
<span id="cb25-1437"><a href="#cb25-1437" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-1438"><a href="#cb25-1438" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> content_list <span class="kw">and</span> <span class="bu">isinstance</span>(content_list, <span class="bu">list</span>):</span>
<span id="cb25-1439"><a href="#cb25-1439" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Extrair conte√∫do de content_list</span></span>
<span id="cb25-1440"><a href="#cb25-1440" aria-hidden="true" tabindex="-1"></a>            content_parts <span class="op">=</span> []</span>
<span id="cb25-1441"><a href="#cb25-1441" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> content_item <span class="kw">in</span> content_list:</span>
<span id="cb25-1442"><a href="#cb25-1442" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="bu">isinstance</span>(content_item, <span class="bu">dict</span>):</span>
<span id="cb25-1443"><a href="#cb25-1443" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># Verificar diferentes estruturas de content_list</span></span>
<span id="cb25-1444"><a href="#cb25-1444" aria-hidden="true" tabindex="-1"></a>                    item_content <span class="op">=</span> content_item.get(<span class="st">'content'</span>, <span class="st">''</span>)</span>
<span id="cb25-1445"><a href="#cb25-1445" aria-hidden="true" tabindex="-1"></a>                    item_text <span class="op">=</span> content_item.get(<span class="st">'text'</span>, <span class="st">''</span>)</span>
<span id="cb25-1446"><a href="#cb25-1446" aria-hidden="true" tabindex="-1"></a>                    item_type <span class="op">=</span> content_item.get(<span class="st">'type'</span>, <span class="st">''</span>)</span>
<span id="cb25-1447"><a href="#cb25-1447" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb25-1448"><a href="#cb25-1448" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> item_content:</span>
<span id="cb25-1449"><a href="#cb25-1449" aria-hidden="true" tabindex="-1"></a>                        content_parts.append(<span class="bu">str</span>(item_content))</span>
<span id="cb25-1450"><a href="#cb25-1450" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">elif</span> item_text:</span>
<span id="cb25-1451"><a href="#cb25-1451" aria-hidden="true" tabindex="-1"></a>                        content_parts.append(<span class="bu">str</span>(item_text))</span>
<span id="cb25-1452"><a href="#cb25-1452" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">elif</span> item_type <span class="op">==</span> <span class="st">'text'</span> <span class="kw">and</span> <span class="st">'text'</span> <span class="kw">in</span> content_item:</span>
<span id="cb25-1453"><a href="#cb25-1453" aria-hidden="true" tabindex="-1"></a>                        content_parts.append(<span class="bu">str</span>(content_item[<span class="st">'text'</span>]))</span>
<span id="cb25-1454"><a href="#cb25-1454" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-1455"><a href="#cb25-1455" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> content_parts:</span>
<span id="cb25-1456"><a href="#cb25-1456" aria-hidden="true" tabindex="-1"></a>                final_content <span class="op">=</span> <span class="st">'</span><span class="ch">\n</span><span class="st">'</span>.join(content_parts).strip()</span>
<span id="cb25-1457"><a href="#cb25-1457" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-1458"><a href="#cb25-1458" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Se content_list n√£o forneceu conte√∫do, usar o campo content tradicional</span></span>
<span id="cb25-1459"><a href="#cb25-1459" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> final_content <span class="kw">and</span> content:</span>
<span id="cb25-1460"><a href="#cb25-1460" aria-hidden="true" tabindex="-1"></a>            final_content <span class="op">=</span> <span class="bu">str</span>(content).strip()</span>
<span id="cb25-1461"><a href="#cb25-1461" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-1462"><a href="#cb25-1462" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Se ainda n√£o tem conte√∫do, pular</span></span>
<span id="cb25-1463"><a href="#cb25-1463" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> final_content <span class="kw">or</span> final_content <span class="op">==</span> <span class="st">'null'</span>:</span>
<span id="cb25-1464"><a href="#cb25-1464" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb25-1465"><a href="#cb25-1465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1466"><a href="#cb25-1466" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Determinar autor</span></span>
<span id="cb25-1467"><a href="#cb25-1467" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> role <span class="op">==</span> <span class="st">'user'</span>:</span>
<span id="cb25-1468"><a href="#cb25-1468" aria-hidden="true" tabindex="-1"></a>            author <span class="op">=</span> <span class="st">"üë§ Utilizador"</span></span>
<span id="cb25-1469"><a href="#cb25-1469" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> role <span class="op">==</span> <span class="st">'assistant'</span>:</span>
<span id="cb25-1470"><a href="#cb25-1470" aria-hidden="true" tabindex="-1"></a>            author <span class="op">=</span> <span class="st">"ü§ñ Qwen3"</span></span>
<span id="cb25-1471"><a href="#cb25-1471" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb25-1472"><a href="#cb25-1472" aria-hidden="true" tabindex="-1"></a>            author <span class="op">=</span> <span class="ss">f"üîπ </span><span class="sc">{</span>role<span class="sc">.</span>title()<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb25-1473"><a href="#cb25-1473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1474"><a href="#cb25-1474" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Processar conte√∫do especial</span></span>
<span id="cb25-1475"><a href="#cb25-1475" aria-hidden="true" tabindex="-1"></a>        final_content <span class="op">=</span> <span class="va">self</span>.preserve_special_content(final_content)</span>
<span id="cb25-1476"><a href="#cb25-1476" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-1477"><a href="#cb25-1477" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb25-1478"><a href="#cb25-1478" aria-hidden="true" tabindex="-1"></a>            <span class="st">'author'</span>: author,</span>
<span id="cb25-1479"><a href="#cb25-1479" aria-hidden="true" tabindex="-1"></a>            <span class="st">'role'</span>: role,</span>
<span id="cb25-1480"><a href="#cb25-1480" aria-hidden="true" tabindex="-1"></a>            <span class="st">'content'</span>: final_content,</span>
<span id="cb25-1481"><a href="#cb25-1481" aria-hidden="true" tabindex="-1"></a>            <span class="st">'timestamp'</span>: <span class="va">self</span>.format_timestamp(obj.get(<span class="st">'created_at'</span>)),</span>
<span id="cb25-1482"><a href="#cb25-1482" aria-hidden="true" tabindex="-1"></a>            <span class="st">'model'</span>: obj.get(<span class="st">'model'</span>, <span class="st">'Qwen3'</span>)</span>
<span id="cb25-1483"><a href="#cb25-1483" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb25-1484"><a href="#cb25-1484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1485"><a href="#cb25-1485" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _remove_duplicate_messages(<span class="va">self</span>, messages: List[Dict[<span class="bu">str</span>, Any]]) <span class="op">-></span> List[Dict[<span class="bu">str</span>, Any]]:</span>
<span id="cb25-1486"><a href="#cb25-1486" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Remove mensagens duplicadas baseadas no conte√∫do"""</span></span>
<span id="cb25-1487"><a href="#cb25-1487" aria-hidden="true" tabindex="-1"></a>        seen <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb25-1488"><a href="#cb25-1488" aria-hidden="true" tabindex="-1"></a>        unique_messages <span class="op">=</span> []</span>
<span id="cb25-1489"><a href="#cb25-1489" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-1490"><a href="#cb25-1490" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> msg <span class="kw">in</span> messages:</span>
<span id="cb25-1491"><a href="#cb25-1491" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Criar uma chave √∫nica baseada no conte√∫do e timestamp</span></span>
<span id="cb25-1492"><a href="#cb25-1492" aria-hidden="true" tabindex="-1"></a>            content_key <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>msg[<span class="st">'content'</span>][:<span class="dv">100</span>]<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>msg[<span class="st">'timestamp'</span>]<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb25-1493"><a href="#cb25-1493" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-1494"><a href="#cb25-1494" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> content_key <span class="kw">not</span> <span class="kw">in</span> seen:</span>
<span id="cb25-1495"><a href="#cb25-1495" aria-hidden="true" tabindex="-1"></a>                seen.add(content_key)</span>
<span id="cb25-1496"><a href="#cb25-1496" aria-hidden="true" tabindex="-1"></a>                unique_messages.append(msg)</span>
<span id="cb25-1497"><a href="#cb25-1497" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-1498"><a href="#cb25-1498" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> unique_messages</span>
<span id="cb25-1499"><a href="#cb25-1499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1500"><a href="#cb25-1500" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> process_chatgpt(<span class="va">self</span>, path: Path):</span>
<span id="cb25-1501"><a href="#cb25-1501" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Processa exporta√ß√£o do ChatGPT"""</span></span>
<span id="cb25-1502"><a href="#cb25-1502" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb25-1503"><a href="#cb25-1503" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="ss">f"üîÆ [DRY-RUN] Processaria ChatGPT: </span><span class="sc">{</span>path<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb25-1504"><a href="#cb25-1504" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb25-1505"><a href="#cb25-1505" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-1506"><a href="#cb25-1506" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb25-1507"><a href="#cb25-1507" aria-hidden="true" tabindex="-1"></a>            temp_dir <span class="op">=</span> tempfile.mkdtemp(prefix<span class="op">=</span><span class="st">"chatgpt_"</span>)</span>
<span id="cb25-1508"><a href="#cb25-1508" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> zipfile.ZipFile(path, <span class="st">'r'</span>) <span class="im">as</span> z:</span>
<span id="cb25-1509"><a href="#cb25-1509" aria-hidden="true" tabindex="-1"></a>                z.extractall(temp_dir)</span>
<span id="cb25-1510"><a href="#cb25-1510" aria-hidden="true" tabindex="-1"></a>            convs_path <span class="op">=</span> Path(temp_dir) <span class="op">/</span> <span class="st">"conversations.json"</span></span>
<span id="cb25-1511"><a href="#cb25-1511" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> convs_path.exists():</span>
<span id="cb25-1512"><a href="#cb25-1512" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.error(<span class="st">"‚ùå ChatGPT: conversations.json n√£o encontrado."</span>)</span>
<span id="cb25-1513"><a href="#cb25-1513" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span></span>
<span id="cb25-1514"><a href="#cb25-1514" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb25-1515"><a href="#cb25-1515" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(convs_path, <span class="st">'r'</span>, encoding<span class="op">=</span><span class="st">'utf-8'</span>) <span class="im">as</span> f:</span>
<span id="cb25-1516"><a href="#cb25-1516" aria-hidden="true" tabindex="-1"></a>                data <span class="op">=</span> json.load(f)</span>
<span id="cb25-1517"><a href="#cb25-1517" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb25-1518"><a href="#cb25-1518" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(data, <span class="bu">list</span>):</span>
<span id="cb25-1519"><a href="#cb25-1519" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.warning(<span class="st">"‚ö†Ô∏è  ChatGPT: estrutura inesperada."</span>)</span>
<span id="cb25-1520"><a href="#cb25-1520" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span></span>
<span id="cb25-1521"><a href="#cb25-1521" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb25-1522"><a href="#cb25-1522" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="ss">f"üîç ChatGPT: encontradas </span><span class="sc">{</span><span class="bu">len</span>(data)<span class="sc">}</span><span class="ss"> conversas."</span>)</span>
<span id="cb25-1523"><a href="#cb25-1523" aria-hidden="true" tabindex="-1"></a>            processed_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb25-1524"><a href="#cb25-1524" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-1525"><a href="#cb25-1525" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> i, conv <span class="kw">in</span> <span class="bu">enumerate</span>(data):</span>
<span id="cb25-1526"><a href="#cb25-1526" aria-hidden="true" tabindex="-1"></a>                original_title <span class="op">=</span> conv.get(<span class="st">'title'</span>, <span class="ss">f'Conversa ChatGPT </span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb25-1527"><a href="#cb25-1527" aria-hidden="true" tabindex="-1"></a>                <span class="co"># PRESERVA t√≠tulo original com espa√ßos</span></span>
<span id="cb25-1528"><a href="#cb25-1528" aria-hidden="true" tabindex="-1"></a>                clean_title <span class="op">=</span> <span class="va">self</span>.preserve_original_title(original_title)</span>
<span id="cb25-1529"><a href="#cb25-1529" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb25-1530"><a href="#cb25-1530" aria-hidden="true" tabindex="-1"></a>                messages <span class="op">=</span> []</span>
<span id="cb25-1531"><a href="#cb25-1531" aria-hidden="true" tabindex="-1"></a>                mapping <span class="op">=</span> conv.get(<span class="st">'mapping'</span>, {})</span>
<span id="cb25-1532"><a href="#cb25-1532" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb25-1533"><a href="#cb25-1533" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> msg_id, node <span class="kw">in</span> mapping.items():</span>
<span id="cb25-1534"><a href="#cb25-1534" aria-hidden="true" tabindex="-1"></a>                    msg_data <span class="op">=</span> node.get(<span class="st">'message'</span>)</span>
<span id="cb25-1535"><a href="#cb25-1535" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="kw">not</span> msg_data <span class="kw">or</span> <span class="kw">not</span> <span class="bu">isinstance</span>(msg_data, <span class="bu">dict</span>):</span>
<span id="cb25-1536"><a href="#cb25-1536" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb25-1537"><a href="#cb25-1537" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb25-1538"><a href="#cb25-1538" aria-hidden="true" tabindex="-1"></a>                    author_role <span class="op">=</span> msg_data.get(<span class="st">'author'</span>, {}).get(<span class="st">'role'</span>, <span class="st">''</span>)</span>
<span id="cb25-1539"><a href="#cb25-1539" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> author_role <span class="op">==</span> <span class="st">'user'</span>:</span>
<span id="cb25-1540"><a href="#cb25-1540" aria-hidden="true" tabindex="-1"></a>                        author <span class="op">=</span> <span class="st">"üë§ Utilizador"</span></span>
<span id="cb25-1541"><a href="#cb25-1541" aria-hidden="true" tabindex="-1"></a>                        role <span class="op">=</span> <span class="st">'user'</span></span>
<span id="cb25-1542"><a href="#cb25-1542" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">elif</span> author_role <span class="op">==</span> <span class="st">'assistant'</span>:</span>
<span id="cb25-1543"><a href="#cb25-1543" aria-hidden="true" tabindex="-1"></a>                        author <span class="op">=</span> <span class="st">"ü§ñ ChatGPT"</span></span>
<span id="cb25-1544"><a href="#cb25-1544" aria-hidden="true" tabindex="-1"></a>                        role <span class="op">=</span> <span class="st">'assistant'</span></span>
<span id="cb25-1545"><a href="#cb25-1545" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">else</span>:</span>
<span id="cb25-1546"><a href="#cb25-1546" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb25-1547"><a href="#cb25-1547" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb25-1548"><a href="#cb25-1548" aria-hidden="true" tabindex="-1"></a>                    content_parts <span class="op">=</span> []</span>
<span id="cb25-1549"><a href="#cb25-1549" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">for</span> part <span class="kw">in</span> msg_data.get(<span class="st">'content'</span>, {}).get(<span class="st">'parts'</span>, []):</span>
<span id="cb25-1550"><a href="#cb25-1550" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">if</span> <span class="bu">isinstance</span>(part, <span class="bu">str</span>):</span>
<span id="cb25-1551"><a href="#cb25-1551" aria-hidden="true" tabindex="-1"></a>                            content_parts.append(part)</span>
<span id="cb25-1552"><a href="#cb25-1552" aria-hidden="true" tabindex="-1"></a>                    content <span class="op">=</span> <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>.join(content_parts).strip()</span>
<span id="cb25-1553"><a href="#cb25-1553" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb25-1554"><a href="#cb25-1554" aria-hidden="true" tabindex="-1"></a>                    content <span class="op">=</span> <span class="va">self</span>.preserve_special_content(content)</span>
<span id="cb25-1555"><a href="#cb25-1555" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb25-1556"><a href="#cb25-1556" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="kw">not</span> content:</span>
<span id="cb25-1557"><a href="#cb25-1557" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb25-1558"><a href="#cb25-1558" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb25-1559"><a href="#cb25-1559" aria-hidden="true" tabindex="-1"></a>                    messages.append({</span>
<span id="cb25-1560"><a href="#cb25-1560" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'author'</span>: author,</span>
<span id="cb25-1561"><a href="#cb25-1561" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'role'</span>: role,</span>
<span id="cb25-1562"><a href="#cb25-1562" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'content'</span>: content,</span>
<span id="cb25-1563"><a href="#cb25-1563" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'timestamp'</span>: <span class="va">self</span>.format_timestamp(msg_data.get(<span class="st">'create_time'</span>)),</span>
<span id="cb25-1564"><a href="#cb25-1564" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'model'</span>: msg_data.get(<span class="st">'model'</span>, <span class="st">'ChatGPT'</span>)</span>
<span id="cb25-1565"><a href="#cb25-1565" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb25-1566"><a href="#cb25-1566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1567"><a href="#cb25-1567" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> messages:</span>
<span id="cb25-1568"><a href="#cb25-1568" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.all_conversations.append({</span>
<span id="cb25-1569"><a href="#cb25-1569" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'title'</span>: clean_title,  <span class="co"># T√≠tulo ORIGINAL com espa√ßos</span></span>
<span id="cb25-1570"><a href="#cb25-1570" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'source'</span>: <span class="st">'ChatGPT'</span>,</span>
<span id="cb25-1571"><a href="#cb25-1571" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'id'</span>: conv.get(<span class="st">'id'</span>, <span class="ss">f'chatgpt_</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">'</span>),</span>
<span id="cb25-1572"><a href="#cb25-1572" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'inserted_at'</span>: <span class="va">self</span>.format_timestamp(conv.get(<span class="st">'create_time'</span>)),</span>
<span id="cb25-1573"><a href="#cb25-1573" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'updated_at'</span>: <span class="va">self</span>.format_timestamp(conv.get(<span class="st">'update_time'</span>)),</span>
<span id="cb25-1574"><a href="#cb25-1574" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'messages'</span>: messages,</span>
<span id="cb25-1575"><a href="#cb25-1575" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'summary'</span>: messages[<span class="dv">0</span>][<span class="st">'content'</span>][:<span class="dv">100</span>] <span class="op">+</span> <span class="st">"..."</span> <span class="cf">if</span> messages <span class="cf">else</span> <span class="st">"Sem conte√∫do"</span>,</span>
<span id="cb25-1576"><a href="#cb25-1576" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'category'</span>: <span class="st">'Geral'</span></span>
<span id="cb25-1577"><a href="#cb25-1577" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb25-1578"><a href="#cb25-1578" aria-hidden="true" tabindex="-1"></a>                    processed_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb25-1579"><a href="#cb25-1579" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb25-1580"><a href="#cb25-1580" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="ss">f"‚úÖ ChatGPT: </span><span class="sc">{</span>processed_count<span class="sc">}</span><span class="ss"> conversas processadas."</span>)</span>
<span id="cb25-1581"><a href="#cb25-1581" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-1582"><a href="#cb25-1582" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb25-1583"><a href="#cb25-1583" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.error(<span class="ss">f"‚ùå Erro ao processar ChatGPT: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb25-1584"><a href="#cb25-1584" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb25-1585"><a href="#cb25-1585" aria-hidden="true" tabindex="-1"></a>                traceback.print_exc()</span>
<span id="cb25-1586"><a href="#cb25-1586" aria-hidden="true" tabindex="-1"></a>        <span class="cf">finally</span>:</span>
<span id="cb25-1587"><a href="#cb25-1587" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="st">'temp_dir'</span> <span class="kw">in</span> <span class="bu">locals</span>():</span>
<span id="cb25-1588"><a href="#cb25-1588" aria-hidden="true" tabindex="-1"></a>                shutil.rmtree(temp_dir, ignore_errors<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb25-1589"><a href="#cb25-1589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1590"><a href="#cb25-1590" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> process_deepseek(<span class="va">self</span>, path: Path):</span>
<span id="cb25-1591"><a href="#cb25-1591" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Processa exporta√ß√£o do DeepSeek"""</span></span>
<span id="cb25-1592"><a href="#cb25-1592" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb25-1593"><a href="#cb25-1593" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="ss">f"üîÆ [DRY-RUN] Processaria DeepSeek: </span><span class="sc">{</span>path<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb25-1594"><a href="#cb25-1594" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb25-1595"><a href="#cb25-1595" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-1596"><a href="#cb25-1596" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb25-1597"><a href="#cb25-1597" aria-hidden="true" tabindex="-1"></a>            temp_dir <span class="op">=</span> tempfile.mkdtemp(prefix<span class="op">=</span><span class="st">"deepseek_"</span>)</span>
<span id="cb25-1598"><a href="#cb25-1598" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> zipfile.ZipFile(path, <span class="st">'r'</span>) <span class="im">as</span> z:</span>
<span id="cb25-1599"><a href="#cb25-1599" aria-hidden="true" tabindex="-1"></a>                z.extractall(temp_dir)</span>
<span id="cb25-1600"><a href="#cb25-1600" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb25-1601"><a href="#cb25-1601" aria-hidden="true" tabindex="-1"></a>            convs_path <span class="op">=</span> Path(temp_dir) <span class="op">/</span> <span class="st">"conversations.json"</span></span>
<span id="cb25-1602"><a href="#cb25-1602" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> convs_path.exists():</span>
<span id="cb25-1603"><a href="#cb25-1603" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.error(<span class="st">"‚ùå DeepSeek: conversations.json n√£o encontrado."</span>)</span>
<span id="cb25-1604"><a href="#cb25-1604" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span></span>
<span id="cb25-1605"><a href="#cb25-1605" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb25-1606"><a href="#cb25-1606" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(convs_path, <span class="st">'r'</span>, encoding<span class="op">=</span><span class="st">'utf-8'</span>) <span class="im">as</span> f:</span>
<span id="cb25-1607"><a href="#cb25-1607" aria-hidden="true" tabindex="-1"></a>                raw_data <span class="op">=</span> json.load(f)</span>
<span id="cb25-1608"><a href="#cb25-1608" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb25-1609"><a href="#cb25-1609" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">isinstance</span>(raw_data, <span class="bu">list</span>):</span>
<span id="cb25-1610"><a href="#cb25-1610" aria-hidden="true" tabindex="-1"></a>                data <span class="op">=</span> raw_data</span>
<span id="cb25-1611"><a href="#cb25-1611" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> <span class="bu">isinstance</span>(raw_data, <span class="bu">dict</span>) <span class="kw">and</span> <span class="st">'data'</span> <span class="kw">in</span> raw_data:</span>
<span id="cb25-1612"><a href="#cb25-1612" aria-hidden="true" tabindex="-1"></a>                data <span class="op">=</span> raw_data[<span class="st">'data'</span>]</span>
<span id="cb25-1613"><a href="#cb25-1613" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb25-1614"><a href="#cb25-1614" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.warning(<span class="st">"‚ö†Ô∏è  DeepSeek: estrutura inesperada."</span>)</span>
<span id="cb25-1615"><a href="#cb25-1615" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span></span>
<span id="cb25-1616"><a href="#cb25-1616" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb25-1617"><a href="#cb25-1617" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(data, <span class="bu">list</span>):</span>
<span id="cb25-1618"><a href="#cb25-1618" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.warning(<span class="st">"‚ö†Ô∏è  DeepSeek: 'data' n√£o √© uma lista."</span>)</span>
<span id="cb25-1619"><a href="#cb25-1619" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span></span>
<span id="cb25-1620"><a href="#cb25-1620" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb25-1621"><a href="#cb25-1621" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="ss">f"üîç DeepSeek: encontradas </span><span class="sc">{</span><span class="bu">len</span>(data)<span class="sc">}</span><span class="ss"> conversas."</span>)</span>
<span id="cb25-1622"><a href="#cb25-1622" aria-hidden="true" tabindex="-1"></a>            processed_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb25-1623"><a href="#cb25-1623" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-1624"><a href="#cb25-1624" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> i, conv <span class="kw">in</span> <span class="bu">enumerate</span>(data):</span>
<span id="cb25-1625"><a href="#cb25-1625" aria-hidden="true" tabindex="-1"></a>                original_title <span class="op">=</span> conv.get(<span class="st">'title'</span>, <span class="ss">f'Conversa DeepSeek </span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb25-1626"><a href="#cb25-1626" aria-hidden="true" tabindex="-1"></a>                <span class="co"># PRESERVA t√≠tulo original com espa√ßos</span></span>
<span id="cb25-1627"><a href="#cb25-1627" aria-hidden="true" tabindex="-1"></a>                clean_title <span class="op">=</span> <span class="va">self</span>.preserve_original_title(original_title)</span>
<span id="cb25-1628"><a href="#cb25-1628" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb25-1629"><a href="#cb25-1629" aria-hidden="true" tabindex="-1"></a>                messages <span class="op">=</span> []</span>
<span id="cb25-1630"><a href="#cb25-1630" aria-hidden="true" tabindex="-1"></a>                mapping <span class="op">=</span> conv.get(<span class="st">'mapping'</span>, {})</span>
<span id="cb25-1631"><a href="#cb25-1631" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb25-1632"><a href="#cb25-1632" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> node_id, node <span class="kw">in</span> mapping.items():</span>
<span id="cb25-1633"><a href="#cb25-1633" aria-hidden="true" tabindex="-1"></a>                    msg_data <span class="op">=</span> node.get(<span class="st">'message'</span>)</span>
<span id="cb25-1634"><a href="#cb25-1634" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="kw">not</span> msg_data <span class="kw">or</span> <span class="kw">not</span> <span class="bu">isinstance</span>(msg_data, <span class="bu">dict</span>):</span>
<span id="cb25-1635"><a href="#cb25-1635" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb25-1636"><a href="#cb25-1636" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb25-1637"><a href="#cb25-1637" aria-hidden="true" tabindex="-1"></a>                    fragments <span class="op">=</span> msg_data.get(<span class="st">'fragments'</span>, [])</span>
<span id="cb25-1638"><a href="#cb25-1638" aria-hidden="true" tabindex="-1"></a>                    content_parts <span class="op">=</span> []</span>
<span id="cb25-1639"><a href="#cb25-1639" aria-hidden="true" tabindex="-1"></a>                    msg_type <span class="op">=</span> <span class="va">None</span></span>
<span id="cb25-1640"><a href="#cb25-1640" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb25-1641"><a href="#cb25-1641" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">for</span> frag <span class="kw">in</span> fragments:</span>
<span id="cb25-1642"><a href="#cb25-1642" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">if</span> <span class="bu">isinstance</span>(frag, <span class="bu">dict</span>):</span>
<span id="cb25-1643"><a href="#cb25-1643" aria-hidden="true" tabindex="-1"></a>                            frag_type <span class="op">=</span> frag.get(<span class="st">'type'</span>, <span class="st">''</span>).upper()</span>
<span id="cb25-1644"><a href="#cb25-1644" aria-hidden="true" tabindex="-1"></a>                            <span class="cf">if</span> frag_type <span class="kw">in</span> (<span class="st">'REQUEST'</span>, <span class="st">'RESPONSE'</span>):</span>
<span id="cb25-1645"><a href="#cb25-1645" aria-hidden="true" tabindex="-1"></a>                                msg_type <span class="op">=</span> frag_type</span>
<span id="cb25-1646"><a href="#cb25-1646" aria-hidden="true" tabindex="-1"></a>                            text <span class="op">=</span> frag.get(<span class="st">'text'</span>, <span class="st">''</span>)</span>
<span id="cb25-1647"><a href="#cb25-1647" aria-hidden="true" tabindex="-1"></a>                            <span class="cf">if</span> text:</span>
<span id="cb25-1648"><a href="#cb25-1648" aria-hidden="true" tabindex="-1"></a>                                content_parts.append(text)</span>
<span id="cb25-1649"><a href="#cb25-1649" aria-hidden="true" tabindex="-1"></a>                            content <span class="op">=</span> frag.get(<span class="st">'content'</span>, <span class="st">''</span>)</span>
<span id="cb25-1650"><a href="#cb25-1650" aria-hidden="true" tabindex="-1"></a>                            <span class="cf">if</span> content:</span>
<span id="cb25-1651"><a href="#cb25-1651" aria-hidden="true" tabindex="-1"></a>                                <span class="cf">if</span> <span class="bu">isinstance</span>(content, <span class="bu">list</span>):</span>
<span id="cb25-1652"><a href="#cb25-1652" aria-hidden="true" tabindex="-1"></a>                                    <span class="cf">for</span> item <span class="kw">in</span> content:</span>
<span id="cb25-1653"><a href="#cb25-1653" aria-hidden="true" tabindex="-1"></a>                                        <span class="cf">if</span> <span class="bu">isinstance</span>(item, <span class="bu">str</span>):</span>
<span id="cb25-1654"><a href="#cb25-1654" aria-hidden="true" tabindex="-1"></a>                                            content_parts.append(item)</span>
<span id="cb25-1655"><a href="#cb25-1655" aria-hidden="true" tabindex="-1"></a>                                        <span class="cf">elif</span> <span class="bu">isinstance</span>(item, <span class="bu">dict</span>):</span>
<span id="cb25-1656"><a href="#cb25-1656" aria-hidden="true" tabindex="-1"></a>                                            item_text <span class="op">=</span> item.get(<span class="st">'text'</span>, <span class="st">''</span>)</span>
<span id="cb25-1657"><a href="#cb25-1657" aria-hidden="true" tabindex="-1"></a>                                            <span class="cf">if</span> item_text:</span>
<span id="cb25-1658"><a href="#cb25-1658" aria-hidden="true" tabindex="-1"></a>                                                content_parts.append(<span class="bu">str</span>(item_text))</span>
<span id="cb25-1659"><a href="#cb25-1659" aria-hidden="true" tabindex="-1"></a>                                <span class="cf">else</span>:</span>
<span id="cb25-1660"><a href="#cb25-1660" aria-hidden="true" tabindex="-1"></a>                                    content_parts.append(<span class="bu">str</span>(content))</span>
<span id="cb25-1661"><a href="#cb25-1661" aria-hidden="true" tabindex="-1"></a>                                    </span>
<span id="cb25-1662"><a href="#cb25-1662" aria-hidden="true" tabindex="-1"></a>                    content <span class="op">=</span> <span class="st">' '</span>.join(content_parts).strip()</span>
<span id="cb25-1663"><a href="#cb25-1663" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb25-1664"><a href="#cb25-1664" aria-hidden="true" tabindex="-1"></a>                    content <span class="op">=</span> <span class="va">self</span>.preserve_special_content(content)</span>
<span id="cb25-1665"><a href="#cb25-1665" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb25-1666"><a href="#cb25-1666" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="kw">not</span> content:</span>
<span id="cb25-1667"><a href="#cb25-1667" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb25-1668"><a href="#cb25-1668" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb25-1669"><a href="#cb25-1669" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> msg_type <span class="op">==</span> <span class="st">'REQUEST'</span>:</span>
<span id="cb25-1670"><a href="#cb25-1670" aria-hidden="true" tabindex="-1"></a>                        author <span class="op">=</span> <span class="st">"üë§ Utilizador"</span></span>
<span id="cb25-1671"><a href="#cb25-1671" aria-hidden="true" tabindex="-1"></a>                        role <span class="op">=</span> <span class="st">'user'</span></span>
<span id="cb25-1672"><a href="#cb25-1672" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">else</span>:</span>
<span id="cb25-1673"><a href="#cb25-1673" aria-hidden="true" tabindex="-1"></a>                        author <span class="op">=</span> <span class="st">"ü§ñ DeepSeek"</span></span>
<span id="cb25-1674"><a href="#cb25-1674" aria-hidden="true" tabindex="-1"></a>                        role <span class="op">=</span> <span class="st">'assistant'</span></span>
<span id="cb25-1675"><a href="#cb25-1675" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb25-1676"><a href="#cb25-1676" aria-hidden="true" tabindex="-1"></a>                    messages.append({</span>
<span id="cb25-1677"><a href="#cb25-1677" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'author'</span>: author,</span>
<span id="cb25-1678"><a href="#cb25-1678" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'role'</span>: role,</span>
<span id="cb25-1679"><a href="#cb25-1679" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'content'</span>: content,</span>
<span id="cb25-1680"><a href="#cb25-1680" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'timestamp'</span>: <span class="va">self</span>.format_timestamp(msg_data.get(<span class="st">'inserted_at'</span>)),</span>
<span id="cb25-1681"><a href="#cb25-1681" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'model'</span>: msg_data.get(<span class="st">'model'</span>, <span class="st">'DeepSeek'</span>)</span>
<span id="cb25-1682"><a href="#cb25-1682" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb25-1683"><a href="#cb25-1683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1684"><a href="#cb25-1684" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> messages:</span>
<span id="cb25-1685"><a href="#cb25-1685" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.all_conversations.append({</span>
<span id="cb25-1686"><a href="#cb25-1686" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'title'</span>: clean_title,  <span class="co"># T√≠tulo ORIGINAL com espa√ßos</span></span>
<span id="cb25-1687"><a href="#cb25-1687" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'source'</span>: <span class="st">'DeepSeek'</span>,</span>
<span id="cb25-1688"><a href="#cb25-1688" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'id'</span>: conv.get(<span class="st">'id'</span>, <span class="ss">f'deepseek_</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">'</span>),</span>
<span id="cb25-1689"><a href="#cb25-1689" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'inserted_at'</span>: <span class="va">self</span>.format_timestamp(conv.get(<span class="st">'inserted_at'</span>)),</span>
<span id="cb25-1690"><a href="#cb25-1690" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'updated_at'</span>: <span class="va">self</span>.format_timestamp(conv.get(<span class="st">'updated_at'</span>)),</span>
<span id="cb25-1691"><a href="#cb25-1691" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'messages'</span>: messages,</span>
<span id="cb25-1692"><a href="#cb25-1692" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'summary'</span>: messages[<span class="dv">0</span>][<span class="st">'content'</span>][:<span class="dv">100</span>] <span class="op">+</span> <span class="st">"..."</span> <span class="cf">if</span> messages <span class="cf">else</span> <span class="st">"Sem conte√∫do"</span>,</span>
<span id="cb25-1693"><a href="#cb25-1693" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'category'</span>: <span class="st">'Geral'</span></span>
<span id="cb25-1694"><a href="#cb25-1694" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb25-1695"><a href="#cb25-1695" aria-hidden="true" tabindex="-1"></a>                    processed_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb25-1696"><a href="#cb25-1696" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb25-1697"><a href="#cb25-1697" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="ss">f"‚úÖ DeepSeek: </span><span class="sc">{</span>processed_count<span class="sc">}</span><span class="ss"> conversas processadas."</span>)</span>
<span id="cb25-1698"><a href="#cb25-1698" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-1699"><a href="#cb25-1699" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb25-1700"><a href="#cb25-1700" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.error(<span class="ss">f"‚ùå Erro ao processar DeepSeek: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb25-1701"><a href="#cb25-1701" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb25-1702"><a href="#cb25-1702" aria-hidden="true" tabindex="-1"></a>                traceback.print_exc()</span>
<span id="cb25-1703"><a href="#cb25-1703" aria-hidden="true" tabindex="-1"></a>        <span class="cf">finally</span>:</span>
<span id="cb25-1704"><a href="#cb25-1704" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="st">'temp_dir'</span> <span class="kw">in</span> <span class="bu">locals</span>():</span>
<span id="cb25-1705"><a href="#cb25-1705" aria-hidden="true" tabindex="-1"></a>                shutil.rmtree(temp_dir, ignore_errors<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb25-1706"><a href="#cb25-1706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1707"><a href="#cb25-1707" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> process_grok(<span class="va">self</span>, path: Path):</span>
<span id="cb25-1708"><a href="#cb25-1708" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Processa exporta√ß√£o do Grok"""</span></span>
<span id="cb25-1709"><a href="#cb25-1709" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb25-1710"><a href="#cb25-1710" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="ss">f"üîÆ [DRY-RUN] Processaria Grok: </span><span class="sc">{</span>path<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb25-1711"><a href="#cb25-1711" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb25-1712"><a href="#cb25-1712" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-1713"><a href="#cb25-1713" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb25-1714"><a href="#cb25-1714" aria-hidden="true" tabindex="-1"></a>            temp_dir <span class="op">=</span> tempfile.mkdtemp(prefix<span class="op">=</span><span class="st">"grok_"</span>)</span>
<span id="cb25-1715"><a href="#cb25-1715" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> zipfile.ZipFile(path, <span class="st">'r'</span>) <span class="im">as</span> z:</span>
<span id="cb25-1716"><a href="#cb25-1716" aria-hidden="true" tabindex="-1"></a>                z.extractall(temp_dir)</span>
<span id="cb25-1717"><a href="#cb25-1717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1718"><a href="#cb25-1718" aria-hidden="true" tabindex="-1"></a>            target_file <span class="op">=</span> <span class="va">None</span></span>
<span id="cb25-1719"><a href="#cb25-1719" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> root, _, files <span class="kw">in</span> os.walk(temp_dir):</span>
<span id="cb25-1720"><a href="#cb25-1720" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> <span class="bu">file</span> <span class="kw">in</span> files:</span>
<span id="cb25-1721"><a href="#cb25-1721" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="bu">file</span> <span class="op">==</span> <span class="st">"prod-grok-backend.json"</span>:</span>
<span id="cb25-1722"><a href="#cb25-1722" aria-hidden="true" tabindex="-1"></a>                        target_file <span class="op">=</span> Path(root) <span class="op">/</span> <span class="bu">file</span></span>
<span id="cb25-1723"><a href="#cb25-1723" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">break</span></span>
<span id="cb25-1724"><a href="#cb25-1724" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> target_file:</span>
<span id="cb25-1725"><a href="#cb25-1725" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">break</span></span>
<span id="cb25-1726"><a href="#cb25-1726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1727"><a href="#cb25-1727" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> target_file:</span>
<span id="cb25-1728"><a href="#cb25-1728" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.error(<span class="st">"‚ùå Grok: ficheiro 'prod-grok-backend.json' n√£o encontrado no ZIP."</span>)</span>
<span id="cb25-1729"><a href="#cb25-1729" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span></span>
<span id="cb25-1730"><a href="#cb25-1730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1731"><a href="#cb25-1731" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="ss">f"üîç Grok: carregando </span><span class="sc">{</span>target_file<span class="sc">.</span>name<span class="sc">}</span><span class="ss">..."</span>)</span>
<span id="cb25-1732"><a href="#cb25-1732" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(target_file, <span class="st">'r'</span>, encoding<span class="op">=</span><span class="st">'utf-8'</span>) <span class="im">as</span> f:</span>
<span id="cb25-1733"><a href="#cb25-1733" aria-hidden="true" tabindex="-1"></a>                data <span class="op">=</span> json.load(f)</span>
<span id="cb25-1734"><a href="#cb25-1734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1735"><a href="#cb25-1735" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(data, <span class="bu">dict</span>) <span class="kw">or</span> <span class="st">'conversations'</span> <span class="kw">not</span> <span class="kw">in</span> data:</span>
<span id="cb25-1736"><a href="#cb25-1736" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.error(<span class="st">"‚ùå Grok: estrutura inesperada ‚Äî chave 'conversations' n√£o encontrada."</span>)</span>
<span id="cb25-1737"><a href="#cb25-1737" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span></span>
<span id="cb25-1738"><a href="#cb25-1738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1739"><a href="#cb25-1739" aria-hidden="true" tabindex="-1"></a>            conversations_list <span class="op">=</span> data[<span class="st">'conversations'</span>]</span>
<span id="cb25-1740"><a href="#cb25-1740" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(conversations_list, <span class="bu">list</span>):</span>
<span id="cb25-1741"><a href="#cb25-1741" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.error(<span class="st">"‚ùå Grok: 'conversations' n√£o √© uma lista."</span>)</span>
<span id="cb25-1742"><a href="#cb25-1742" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span></span>
<span id="cb25-1743"><a href="#cb25-1743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1744"><a href="#cb25-1744" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="ss">f"üìä Grok: encontradas </span><span class="sc">{</span><span class="bu">len</span>(conversations_list)<span class="sc">}</span><span class="ss"> conversas."</span>)</span>
<span id="cb25-1745"><a href="#cb25-1745" aria-hidden="true" tabindex="-1"></a>            total_convs <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb25-1746"><a href="#cb25-1746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1747"><a href="#cb25-1747" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> item <span class="kw">in</span> conversations_list:</span>
<span id="cb25-1748"><a href="#cb25-1748" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(item, <span class="bu">dict</span>):</span>
<span id="cb25-1749"><a href="#cb25-1749" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">continue</span></span>
<span id="cb25-1750"><a href="#cb25-1750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1751"><a href="#cb25-1751" aria-hidden="true" tabindex="-1"></a>                conv_meta <span class="op">=</span> item.get(<span class="st">'conversation'</span>)</span>
<span id="cb25-1752"><a href="#cb25-1752" aria-hidden="true" tabindex="-1"></a>                responses <span class="op">=</span> item.get(<span class="st">'responses'</span>, [])</span>
<span id="cb25-1753"><a href="#cb25-1753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1754"><a href="#cb25-1754" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(conv_meta, <span class="bu">dict</span>) <span class="kw">or</span> <span class="kw">not</span> <span class="bu">isinstance</span>(responses, <span class="bu">list</span>) <span class="kw">or</span> <span class="kw">not</span> responses:</span>
<span id="cb25-1755"><a href="#cb25-1755" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">continue</span></span>
<span id="cb25-1756"><a href="#cb25-1756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1757"><a href="#cb25-1757" aria-hidden="true" tabindex="-1"></a>                conv_id <span class="op">=</span> conv_meta.get(<span class="st">'id'</span>)</span>
<span id="cb25-1758"><a href="#cb25-1758" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="kw">not</span> conv_id:</span>
<span id="cb25-1759"><a href="#cb25-1759" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">continue</span></span>
<span id="cb25-1760"><a href="#cb25-1760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1761"><a href="#cb25-1761" aria-hidden="true" tabindex="-1"></a>                original_title <span class="op">=</span> conv_meta.get(<span class="st">'title'</span>, <span class="ss">f"Conversa Grok </span><span class="sc">{</span>total_convs <span class="op">+</span> <span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb25-1762"><a href="#cb25-1762" aria-hidden="true" tabindex="-1"></a>                <span class="co"># PRESERVA t√≠tulo original com espa√ßos</span></span>
<span id="cb25-1763"><a href="#cb25-1763" aria-hidden="true" tabindex="-1"></a>                clean_title <span class="op">=</span> <span class="va">self</span>.preserve_original_title(original_title)</span>
<span id="cb25-1764"><a href="#cb25-1764" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb25-1765"><a href="#cb25-1765" aria-hidden="true" tabindex="-1"></a>                create_time_str <span class="op">=</span> conv_meta.get(<span class="st">'create_time'</span>)</span>
<span id="cb25-1766"><a href="#cb25-1766" aria-hidden="true" tabindex="-1"></a>                modify_time_str <span class="op">=</span> conv_meta.get(<span class="st">'modify_time'</span>)</span>
<span id="cb25-1767"><a href="#cb25-1767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1768"><a href="#cb25-1768" aria-hidden="true" tabindex="-1"></a>                <span class="kw">def</span> format_iso_timestamp(ts_str):</span>
<span id="cb25-1769"><a href="#cb25-1769" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="kw">not</span> ts_str:</span>
<span id="cb25-1770"><a href="#cb25-1770" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb25-1771"><a href="#cb25-1771" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">try</span>:</span>
<span id="cb25-1772"><a href="#cb25-1772" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">if</span> <span class="st">'.'</span> <span class="kw">in</span> ts_str:</span>
<span id="cb25-1773"><a href="#cb25-1773" aria-hidden="true" tabindex="-1"></a>                            ts_str <span class="op">=</span> ts_str.split(<span class="st">'.'</span>)[<span class="dv">0</span>] <span class="op">+</span> <span class="st">'Z'</span></span>
<span id="cb25-1774"><a href="#cb25-1774" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">return</span> <span class="va">self</span>.format_timestamp(ts_str)</span>
<span id="cb25-1775"><a href="#cb25-1775" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">except</span>:</span>
<span id="cb25-1776"><a href="#cb25-1776" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">return</span> <span class="bu">str</span>(ts_str)</span>
<span id="cb25-1777"><a href="#cb25-1777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1778"><a href="#cb25-1778" aria-hidden="true" tabindex="-1"></a>                inserted_at <span class="op">=</span> format_iso_timestamp(create_time_str)</span>
<span id="cb25-1779"><a href="#cb25-1779" aria-hidden="true" tabindex="-1"></a>                updated_at <span class="op">=</span> format_iso_timestamp(modify_time_str)</span>
<span id="cb25-1780"><a href="#cb25-1780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1781"><a href="#cb25-1781" aria-hidden="true" tabindex="-1"></a>                messages <span class="op">=</span> []</span>
<span id="cb25-1782"><a href="#cb25-1782" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> resp <span class="kw">in</span> responses:</span>
<span id="cb25-1783"><a href="#cb25-1783" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(resp, <span class="bu">dict</span>):</span>
<span id="cb25-1784"><a href="#cb25-1784" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb25-1785"><a href="#cb25-1785" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1786"><a href="#cb25-1786" aria-hidden="true" tabindex="-1"></a>                    resp_data <span class="op">=</span> resp.get(<span class="st">'response'</span>)</span>
<span id="cb25-1787"><a href="#cb25-1787" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(resp_data, <span class="bu">dict</span>):</span>
<span id="cb25-1788"><a href="#cb25-1788" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb25-1789"><a href="#cb25-1789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1790"><a href="#cb25-1790" aria-hidden="true" tabindex="-1"></a>                    sender <span class="op">=</span> resp_data.get(<span class="st">'sender'</span>, <span class="st">''</span>).upper()</span>
<span id="cb25-1791"><a href="#cb25-1791" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> sender <span class="op">==</span> <span class="st">'HUMAN'</span>:</span>
<span id="cb25-1792"><a href="#cb25-1792" aria-hidden="true" tabindex="-1"></a>                        author <span class="op">=</span> <span class="st">"üë§ Utilizador"</span></span>
<span id="cb25-1793"><a href="#cb25-1793" aria-hidden="true" tabindex="-1"></a>                        role <span class="op">=</span> <span class="st">"user"</span></span>
<span id="cb25-1794"><a href="#cb25-1794" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">elif</span> sender <span class="op">==</span> <span class="st">'ASSISTANT'</span>:</span>
<span id="cb25-1795"><a href="#cb25-1795" aria-hidden="true" tabindex="-1"></a>                        author <span class="op">=</span> <span class="st">"ü§ñ Grok"</span></span>
<span id="cb25-1796"><a href="#cb25-1796" aria-hidden="true" tabindex="-1"></a>                        role <span class="op">=</span> <span class="st">"assistant"</span></span>
<span id="cb25-1797"><a href="#cb25-1797" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">else</span>:</span>
<span id="cb25-1798"><a href="#cb25-1798" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb25-1799"><a href="#cb25-1799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1800"><a href="#cb25-1800" aria-hidden="true" tabindex="-1"></a>                    content <span class="op">=</span> <span class="bu">str</span>(resp_data.get(<span class="st">'message'</span>, <span class="st">''</span>)).strip()</span>
<span id="cb25-1801"><a href="#cb25-1801" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb25-1802"><a href="#cb25-1802" aria-hidden="true" tabindex="-1"></a>                    content <span class="op">=</span> <span class="va">self</span>.preserve_special_content(content)</span>
<span id="cb25-1803"><a href="#cb25-1803" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb25-1804"><a href="#cb25-1804" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="kw">not</span> content:</span>
<span id="cb25-1805"><a href="#cb25-1805" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb25-1806"><a href="#cb25-1806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1807"><a href="#cb25-1807" aria-hidden="true" tabindex="-1"></a>                    create_time <span class="op">=</span> resp_data.get(<span class="st">'create_time'</span>)</span>
<span id="cb25-1808"><a href="#cb25-1808" aria-hidden="true" tabindex="-1"></a>                    timestamp_ms <span class="op">=</span> <span class="va">None</span></span>
<span id="cb25-1809"><a href="#cb25-1809" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="bu">isinstance</span>(create_time, <span class="bu">dict</span>) <span class="kw">and</span> <span class="st">'$date'</span> <span class="kw">in</span> create_time:</span>
<span id="cb25-1810"><a href="#cb25-1810" aria-hidden="true" tabindex="-1"></a>                        date_obj <span class="op">=</span> create_time[<span class="st">'$date'</span>]</span>
<span id="cb25-1811"><a href="#cb25-1811" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">if</span> <span class="bu">isinstance</span>(date_obj, <span class="bu">dict</span>) <span class="kw">and</span> <span class="st">'$numberLong'</span> <span class="kw">in</span> date_obj:</span>
<span id="cb25-1812"><a href="#cb25-1812" aria-hidden="true" tabindex="-1"></a>                            <span class="cf">try</span>:</span>
<span id="cb25-1813"><a href="#cb25-1813" aria-hidden="true" tabindex="-1"></a>                                timestamp_ms <span class="op">=</span> <span class="bu">int</span>(date_obj[<span class="st">'$numberLong'</span>])</span>
<span id="cb25-1814"><a href="#cb25-1814" aria-hidden="true" tabindex="-1"></a>                            <span class="cf">except</span>:</span>
<span id="cb25-1815"><a href="#cb25-1815" aria-hidden="true" tabindex="-1"></a>                                <span class="cf">pass</span></span>
<span id="cb25-1816"><a href="#cb25-1816" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1817"><a href="#cb25-1817" aria-hidden="true" tabindex="-1"></a>                    messages.append({</span>
<span id="cb25-1818"><a href="#cb25-1818" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'author'</span>: author,</span>
<span id="cb25-1819"><a href="#cb25-1819" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'role'</span>: role,</span>
<span id="cb25-1820"><a href="#cb25-1820" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'content'</span>: content,</span>
<span id="cb25-1821"><a href="#cb25-1821" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'timestamp'</span>: <span class="va">self</span>.format_timestamp(timestamp_ms <span class="op">/</span> <span class="fl">1000.0</span> <span class="cf">if</span> timestamp_ms <span class="cf">else</span> <span class="va">None</span>),</span>
<span id="cb25-1822"><a href="#cb25-1822" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'model'</span>: <span class="st">'Grok'</span></span>
<span id="cb25-1823"><a href="#cb25-1823" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb25-1824"><a href="#cb25-1824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1825"><a href="#cb25-1825" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> messages:</span>
<span id="cb25-1826"><a href="#cb25-1826" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.all_conversations.append({</span>
<span id="cb25-1827"><a href="#cb25-1827" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'title'</span>: clean_title,  <span class="co"># T√≠tulo ORIGINAL com espa√ßos</span></span>
<span id="cb25-1828"><a href="#cb25-1828" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'source'</span>: <span class="st">'Grok'</span>,</span>
<span id="cb25-1829"><a href="#cb25-1829" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'id'</span>: conv_id,</span>
<span id="cb25-1830"><a href="#cb25-1830" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'inserted_at'</span>: inserted_at,</span>
<span id="cb25-1831"><a href="#cb25-1831" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'updated_at'</span>: updated_at,</span>
<span id="cb25-1832"><a href="#cb25-1832" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'messages'</span>: messages,</span>
<span id="cb25-1833"><a href="#cb25-1833" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'summary'</span>: messages[<span class="dv">0</span>][<span class="st">'content'</span>][:<span class="dv">100</span>] <span class="op">+</span> <span class="st">"..."</span> <span class="cf">if</span> messages <span class="cf">else</span> <span class="st">"Sem conte√∫do"</span>,</span>
<span id="cb25-1834"><a href="#cb25-1834" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'category'</span>: <span class="st">'Geral'</span></span>
<span id="cb25-1835"><a href="#cb25-1835" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb25-1836"><a href="#cb25-1836" aria-hidden="true" tabindex="-1"></a>                    total_convs <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb25-1837"><a href="#cb25-1837" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1838"><a href="#cb25-1838" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> total_convs <span class="op">></span> <span class="dv">0</span>:</span>
<span id="cb25-1839"><a href="#cb25-1839" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.info(<span class="ss">f"‚úÖ Grok: processadas </span><span class="sc">{</span>total_convs<span class="sc">}</span><span class="ss"> conversas."</span>)</span>
<span id="cb25-1840"><a href="#cb25-1840" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb25-1841"><a href="#cb25-1841" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.error(<span class="st">"‚ùå Grok: nenhuma conversa v√°lida encontrada."</span>)</span>
<span id="cb25-1842"><a href="#cb25-1842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1843"><a href="#cb25-1843" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb25-1844"><a href="#cb25-1844" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.error(<span class="ss">f"‚ùå Erro ao processar Grok: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb25-1845"><a href="#cb25-1845" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb25-1846"><a href="#cb25-1846" aria-hidden="true" tabindex="-1"></a>                traceback.print_exc()</span>
<span id="cb25-1847"><a href="#cb25-1847" aria-hidden="true" tabindex="-1"></a>        <span class="cf">finally</span>:</span>
<span id="cb25-1848"><a href="#cb25-1848" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="st">'temp_dir'</span> <span class="kw">in</span> <span class="bu">locals</span>():</span>
<span id="cb25-1849"><a href="#cb25-1849" aria-hidden="true" tabindex="-1"></a>                shutil.rmtree(temp_dir, ignore_errors<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb25-1850"><a href="#cb25-1850" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1851"><a href="#cb25-1851" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> save_as_markdown_enhanced(<span class="va">self</span>):</span>
<span id="cb25-1852"><a href="#cb25-1852" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Salva conversas com preserva√ß√£o total de formata√ß√£o"""</span></span>
<span id="cb25-1853"><a href="#cb25-1853" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb25-1854"><a href="#cb25-1854" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="st">"üîÆ [DRY-RUN] Markdowns seriam criados:"</span>)</span>
<span id="cb25-1855"><a href="#cb25-1855" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> conv <span class="kw">in</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb25-1856"><a href="#cb25-1856" aria-hidden="true" tabindex="-1"></a>                safe_title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(conv[<span class="st">'title'</span>])</span>
<span id="cb25-1857"><a href="#cb25-1857" aria-hidden="true" tabindex="-1"></a>                filename <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>conv[<span class="st">'number'</span>]<span class="sc">:03d}</span><span class="ss">_</span><span class="sc">{</span>conv[<span class="st">'source'</span>]<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>safe_title<span class="sc">}</span><span class="ss">.md"</span></span>
<span id="cb25-1858"><a href="#cb25-1858" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.info(<span class="ss">f"   üìÑ </span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb25-1859"><a href="#cb25-1859" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb25-1860"><a href="#cb25-1860" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-1861"><a href="#cb25-1861" aria-hidden="true" tabindex="-1"></a>        folder <span class="op">=</span> Path(<span class="va">self</span>.output_dirs[<span class="st">'markdown'</span>])</span>
<span id="cb25-1862"><a href="#cb25-1862" aria-hidden="true" tabindex="-1"></a>        saved_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb25-1863"><a href="#cb25-1863" aria-hidden="true" tabindex="-1"></a>        failed_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb25-1864"><a href="#cb25-1864" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-1865"><a href="#cb25-1865" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> conv <span class="kw">in</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb25-1866"><a href="#cb25-1866" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb25-1867"><a href="#cb25-1867" aria-hidden="true" tabindex="-1"></a>                safe_title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(conv[<span class="st">'title'</span>])</span>
<span id="cb25-1868"><a href="#cb25-1868" aria-hidden="true" tabindex="-1"></a>                filename <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>conv[<span class="st">'number'</span>]<span class="sc">:03d}</span><span class="ss">_</span><span class="sc">{</span>conv[<span class="st">'source'</span>]<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>safe_title<span class="sc">}</span><span class="ss">.md"</span></span>
<span id="cb25-1869"><a href="#cb25-1869" aria-hidden="true" tabindex="-1"></a>                filepath <span class="op">=</span> folder <span class="op">/</span> filename</span>
<span id="cb25-1870"><a href="#cb25-1870" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb25-1871"><a href="#cb25-1871" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.force_overwrite <span class="kw">and</span> filepath.exists():</span>
<span id="cb25-1872"><a href="#cb25-1872" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">continue</span></span>
<span id="cb25-1873"><a href="#cb25-1873" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb25-1874"><a href="#cb25-1874" aria-hidden="true" tabindex="-1"></a>                markdown_content <span class="op">=</span> <span class="va">self</span>.create_enhanced_markdown_content(conv)</span>
<span id="cb25-1875"><a href="#cb25-1875" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb25-1876"><a href="#cb25-1876" aria-hidden="true" tabindex="-1"></a>                <span class="cf">with</span> <span class="bu">open</span>(filepath, <span class="st">'w'</span>, encoding<span class="op">=</span><span class="st">'utf-8'</span>) <span class="im">as</span> f:</span>
<span id="cb25-1877"><a href="#cb25-1877" aria-hidden="true" tabindex="-1"></a>                    f.write(markdown_content)</span>
<span id="cb25-1878"><a href="#cb25-1878" aria-hidden="true" tabindex="-1"></a>                saved_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb25-1879"><a href="#cb25-1879" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb25-1880"><a href="#cb25-1880" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb25-1881"><a href="#cb25-1881" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.error(<span class="ss">f"‚ùå Erro ao salvar conversa </span><span class="sc">{</span>conv[<span class="st">'number'</span>]<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb25-1882"><a href="#cb25-1882" aria-hidden="true" tabindex="-1"></a>                failed_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb25-1883"><a href="#cb25-1883" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span></span>
<span id="cb25-1884"><a href="#cb25-1884" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb25-1885"><a href="#cb25-1885" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.logger.info(<span class="ss">f"‚úÖ Markdown: </span><span class="sc">{</span>saved_count<span class="sc">}</span><span class="ss"> arquivos criados, </span><span class="sc">{</span>failed_count<span class="sc">}</span><span class="ss"> falhas em '</span><span class="sc">{</span>folder<span class="sc">}</span><span class="ss">'"</span>)</span>
<span id="cb25-1886"><a href="#cb25-1886" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1887"><a href="#cb25-1887" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> save_as_csv(<span class="va">self</span>):</span>
<span id="cb25-1888"><a href="#cb25-1888" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Salva conversas em arquivos CSV individuais"""</span></span>
<span id="cb25-1889"><a href="#cb25-1889" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb25-1890"><a href="#cb25-1890" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="st">"üîÆ [DRY-RUN] CSVs seriam criados:"</span>)</span>
<span id="cb25-1891"><a href="#cb25-1891" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> conv <span class="kw">in</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb25-1892"><a href="#cb25-1892" aria-hidden="true" tabindex="-1"></a>                safe_title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(conv[<span class="st">'title'</span>])</span>
<span id="cb25-1893"><a href="#cb25-1893" aria-hidden="true" tabindex="-1"></a>                filename <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>conv[<span class="st">'number'</span>]<span class="sc">:03d}</span><span class="ss">_</span><span class="sc">{</span>conv[<span class="st">'source'</span>]<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>safe_title<span class="sc">}</span><span class="ss">.csv"</span></span>
<span id="cb25-1894"><a href="#cb25-1894" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.info(<span class="ss">f"   üìä </span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb25-1895"><a href="#cb25-1895" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb25-1896"><a href="#cb25-1896" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-1897"><a href="#cb25-1897" aria-hidden="true" tabindex="-1"></a>        folder <span class="op">=</span> Path(<span class="va">self</span>.output_dirs[<span class="st">'csv'</span>])</span>
<span id="cb25-1898"><a href="#cb25-1898" aria-hidden="true" tabindex="-1"></a>        saved_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb25-1899"><a href="#cb25-1899" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-1900"><a href="#cb25-1900" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> conv <span class="kw">in</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb25-1901"><a href="#cb25-1901" aria-hidden="true" tabindex="-1"></a>            safe_title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(conv[<span class="st">'title'</span>])</span>
<span id="cb25-1902"><a href="#cb25-1902" aria-hidden="true" tabindex="-1"></a>            filename <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>conv[<span class="st">'number'</span>]<span class="sc">:03d}</span><span class="ss">_</span><span class="sc">{</span>conv[<span class="st">'source'</span>]<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>safe_title<span class="sc">}</span><span class="ss">.csv"</span></span>
<span id="cb25-1903"><a href="#cb25-1903" aria-hidden="true" tabindex="-1"></a>            filepath <span class="op">=</span> folder <span class="op">/</span> filename</span>
<span id="cb25-1904"><a href="#cb25-1904" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-1905"><a href="#cb25-1905" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.force_overwrite <span class="kw">and</span> filepath.exists():</span>
<span id="cb25-1906"><a href="#cb25-1906" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span></span>
<span id="cb25-1907"><a href="#cb25-1907" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb25-1908"><a href="#cb25-1908" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(filepath, <span class="st">'w'</span>, encoding<span class="op">=</span><span class="st">'utf-8'</span>, newline<span class="op">=</span><span class="st">''</span>) <span class="im">as</span> f:</span>
<span id="cb25-1909"><a href="#cb25-1909" aria-hidden="true" tabindex="-1"></a>                writer <span class="op">=</span> csv.DictWriter(f, fieldnames<span class="op">=</span>[</span>
<span id="cb25-1910"><a href="#cb25-1910" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'node_id'</span>, <span class="st">'author'</span>, <span class="st">'role'</span>, <span class="st">'timestamp'</span>, <span class="st">'model'</span>, <span class="st">'content'</span></span>
<span id="cb25-1911"><a href="#cb25-1911" aria-hidden="true" tabindex="-1"></a>                ])</span>
<span id="cb25-1912"><a href="#cb25-1912" aria-hidden="true" tabindex="-1"></a>                writer.writeheader()</span>
<span id="cb25-1913"><a href="#cb25-1913" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> i, msg <span class="kw">in</span> <span class="bu">enumerate</span>(conv[<span class="st">'messages'</span>]):</span>
<span id="cb25-1914"><a href="#cb25-1914" aria-hidden="true" tabindex="-1"></a>                    writer.writerow({</span>
<span id="cb25-1915"><a href="#cb25-1915" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'node_id'</span>: <span class="bu">str</span>(i),</span>
<span id="cb25-1916"><a href="#cb25-1916" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'author'</span>: msg[<span class="st">'author'</span>],</span>
<span id="cb25-1917"><a href="#cb25-1917" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'role'</span>: msg[<span class="st">'role'</span>],</span>
<span id="cb25-1918"><a href="#cb25-1918" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'timestamp'</span>: msg[<span class="st">'timestamp'</span>],</span>
<span id="cb25-1919"><a href="#cb25-1919" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'model'</span>: msg[<span class="st">'model'</span>],</span>
<span id="cb25-1920"><a href="#cb25-1920" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'content'</span>: msg[<span class="st">'content'</span>]</span>
<span id="cb25-1921"><a href="#cb25-1921" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb25-1922"><a href="#cb25-1922" aria-hidden="true" tabindex="-1"></a>            saved_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb25-1923"><a href="#cb25-1923" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-1924"><a href="#cb25-1924" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.logger.info(<span class="ss">f"‚úÖ CSV: </span><span class="sc">{</span>saved_count<span class="sc">}</span><span class="ss"> arquivos criados em '</span><span class="sc">{</span>folder<span class="sc">}</span><span class="ss">'"</span>)</span>
<span id="cb25-1925"><a href="#cb25-1925" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1926"><a href="#cb25-1926" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> save_as_json(<span class="va">self</span>):</span>
<span id="cb25-1927"><a href="#cb25-1927" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Salva conversas em arquivos JSON individuais"""</span></span>
<span id="cb25-1928"><a href="#cb25-1928" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb25-1929"><a href="#cb25-1929" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="st">"üîÆ [DRY-RUN] JSONs seriam criados:"</span>)</span>
<span id="cb25-1930"><a href="#cb25-1930" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> conv <span class="kw">in</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb25-1931"><a href="#cb25-1931" aria-hidden="true" tabindex="-1"></a>                safe_title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(conv[<span class="st">'title'</span>])</span>
<span id="cb25-1932"><a href="#cb25-1932" aria-hidden="true" tabindex="-1"></a>                filename <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>conv[<span class="st">'number'</span>]<span class="sc">:03d}</span><span class="ss">_</span><span class="sc">{</span>conv[<span class="st">'source'</span>]<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>safe_title<span class="sc">}</span><span class="ss">.json"</span></span>
<span id="cb25-1933"><a href="#cb25-1933" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.info(<span class="ss">f"   üìã </span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb25-1934"><a href="#cb25-1934" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb25-1935"><a href="#cb25-1935" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-1936"><a href="#cb25-1936" aria-hidden="true" tabindex="-1"></a>        folder <span class="op">=</span> Path(<span class="va">self</span>.output_dirs[<span class="st">'json'</span>])</span>
<span id="cb25-1937"><a href="#cb25-1937" aria-hidden="true" tabindex="-1"></a>        saved_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb25-1938"><a href="#cb25-1938" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-1939"><a href="#cb25-1939" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> conv <span class="kw">in</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb25-1940"><a href="#cb25-1940" aria-hidden="true" tabindex="-1"></a>            safe_title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(conv[<span class="st">'title'</span>])</span>
<span id="cb25-1941"><a href="#cb25-1941" aria-hidden="true" tabindex="-1"></a>            filename <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>conv[<span class="st">'number'</span>]<span class="sc">:03d}</span><span class="ss">_</span><span class="sc">{</span>conv[<span class="st">'source'</span>]<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>safe_title<span class="sc">}</span><span class="ss">.json"</span></span>
<span id="cb25-1942"><a href="#cb25-1942" aria-hidden="true" tabindex="-1"></a>            filepath <span class="op">=</span> folder <span class="op">/</span> filename</span>
<span id="cb25-1943"><a href="#cb25-1943" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-1944"><a href="#cb25-1944" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.force_overwrite <span class="kw">and</span> filepath.exists():</span>
<span id="cb25-1945"><a href="#cb25-1945" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span></span>
<span id="cb25-1946"><a href="#cb25-1946" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb25-1947"><a href="#cb25-1947" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(filepath, <span class="st">'w'</span>, encoding<span class="op">=</span><span class="st">'utf-8'</span>) <span class="im">as</span> f:</span>
<span id="cb25-1948"><a href="#cb25-1948" aria-hidden="true" tabindex="-1"></a>                json.dump(conv, f, ensure_ascii<span class="op">=</span><span class="va">False</span>, indent<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb25-1949"><a href="#cb25-1949" aria-hidden="true" tabindex="-1"></a>            saved_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb25-1950"><a href="#cb25-1950" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-1951"><a href="#cb25-1951" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.logger.info(<span class="ss">f"‚úÖ JSON: </span><span class="sc">{</span>saved_count<span class="sc">}</span><span class="ss"> arquivos criados em '</span><span class="sc">{</span>folder<span class="sc">}</span><span class="ss">'"</span>)</span>
<span id="cb25-1952"><a href="#cb25-1952" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1953"><a href="#cb25-1953" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> save_all_to_single_files(<span class="va">self</span>):</span>
<span id="cb25-1954"><a href="#cb25-1954" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Salva todas as conversas em arquivos √∫nicos CSV e JSON"""</span></span>
<span id="cb25-1955"><a href="#cb25-1955" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb25-1956"><a href="#cb25-1956" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="st">"üîÆ [DRY-RUN] Arquivos √∫nicos seriam criados:"</span>)</span>
<span id="cb25-1957"><a href="#cb25-1957" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="ss">f"   üìÅ </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>single_files[<span class="st">'csv'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb25-1958"><a href="#cb25-1958" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="ss">f"   üìÅ </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>single_files[<span class="st">'json'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb25-1959"><a href="#cb25-1959" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb25-1960"><a href="#cb25-1960" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-1961"><a href="#cb25-1961" aria-hidden="true" tabindex="-1"></a>        <span class="co"># CSV √∫nico</span></span>
<span id="cb25-1962"><a href="#cb25-1962" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> <span class="bu">open</span>(<span class="va">self</span>.single_files[<span class="st">'csv'</span>], <span class="st">'w'</span>, encoding<span class="op">=</span><span class="st">'utf-8'</span>, newline<span class="op">=</span><span class="st">''</span>) <span class="im">as</span> f:</span>
<span id="cb25-1963"><a href="#cb25-1963" aria-hidden="true" tabindex="-1"></a>            fieldnames <span class="op">=</span> [</span>
<span id="cb25-1964"><a href="#cb25-1964" aria-hidden="true" tabindex="-1"></a>                <span class="st">'conversation_number'</span>, <span class="st">'source'</span>, <span class="st">'conversation_title'</span>, <span class="st">'category'</span>,</span>
<span id="cb25-1965"><a href="#cb25-1965" aria-hidden="true" tabindex="-1"></a>                <span class="st">'author'</span>, <span class="st">'role'</span>, <span class="st">'timestamp'</span>, <span class="st">'model'</span>, <span class="st">'content'</span></span>
<span id="cb25-1966"><a href="#cb25-1966" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb25-1967"><a href="#cb25-1967" aria-hidden="true" tabindex="-1"></a>            writer <span class="op">=</span> csv.DictWriter(f, fieldnames<span class="op">=</span>fieldnames)</span>
<span id="cb25-1968"><a href="#cb25-1968" aria-hidden="true" tabindex="-1"></a>            writer.writeheader()</span>
<span id="cb25-1969"><a href="#cb25-1969" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> conv <span class="kw">in</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb25-1970"><a href="#cb25-1970" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> msg <span class="kw">in</span> conv[<span class="st">'messages'</span>]:</span>
<span id="cb25-1971"><a href="#cb25-1971" aria-hidden="true" tabindex="-1"></a>                    writer.writerow({</span>
<span id="cb25-1972"><a href="#cb25-1972" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'conversation_number'</span>: conv[<span class="st">'number'</span>],</span>
<span id="cb25-1973"><a href="#cb25-1973" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'source'</span>: conv[<span class="st">'source'</span>],</span>
<span id="cb25-1974"><a href="#cb25-1974" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'conversation_title'</span>: conv[<span class="st">'title'</span>],</span>
<span id="cb25-1975"><a href="#cb25-1975" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'category'</span>: conv[<span class="st">'category'</span>],</span>
<span id="cb25-1976"><a href="#cb25-1976" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'author'</span>: msg[<span class="st">'author'</span>],</span>
<span id="cb25-1977"><a href="#cb25-1977" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'role'</span>: msg[<span class="st">'role'</span>],</span>
<span id="cb25-1978"><a href="#cb25-1978" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'timestamp'</span>: msg[<span class="st">'timestamp'</span>],</span>
<span id="cb25-1979"><a href="#cb25-1979" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'model'</span>: msg[<span class="st">'model'</span>],</span>
<span id="cb25-1980"><a href="#cb25-1980" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'content'</span>: msg[<span class="st">'content'</span>]</span>
<span id="cb25-1981"><a href="#cb25-1981" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb25-1982"><a href="#cb25-1982" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.logger.info(<span class="ss">f"‚úÖ CSV √∫nico: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>single_files[<span class="st">'csv'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb25-1983"><a href="#cb25-1983" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1984"><a href="#cb25-1984" aria-hidden="true" tabindex="-1"></a>        <span class="co"># JSON √∫nico</span></span>
<span id="cb25-1985"><a href="#cb25-1985" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> <span class="bu">open</span>(<span class="va">self</span>.single_files[<span class="st">'json'</span>], <span class="st">'w'</span>, encoding<span class="op">=</span><span class="st">'utf-8'</span>) <span class="im">as</span> f:</span>
<span id="cb25-1986"><a href="#cb25-1986" aria-hidden="true" tabindex="-1"></a>            json.dump(<span class="va">self</span>.all_conversations, f, ensure_ascii<span class="op">=</span><span class="va">False</span>, indent<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb25-1987"><a href="#cb25-1987" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.logger.info(<span class="ss">f"‚úÖ JSON √∫nico: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>single_files[<span class="st">'json'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb25-1988"><a href="#cb25-1988" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1989"><a href="#cb25-1989" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_searchable_index(<span class="va">self</span>):</span>
<span id="cb25-1990"><a href="#cb25-1990" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Cria √≠ndice HTML pesquis√°vel com links para HTML"""</span></span>
<span id="cb25-1991"><a href="#cb25-1991" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb25-1992"><a href="#cb25-1992" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="ss">f"üîÆ [DRY-RUN] √çndice HTML seria criado: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>index_file<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb25-1993"><a href="#cb25-1993" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb25-1994"><a href="#cb25-1994" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-1995"><a href="#cb25-1995" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.logger.info(<span class="st">"üéØ Criando √≠ndice HTML combinado..."</span>)</span>
<span id="cb25-1996"><a href="#cb25-1996" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-1997"><a href="#cb25-1997" aria-hidden="true" tabindex="-1"></a>        category_stats <span class="op">=</span> {}</span>
<span id="cb25-1998"><a href="#cb25-1998" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> conv <span class="kw">in</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb25-1999"><a href="#cb25-1999" aria-hidden="true" tabindex="-1"></a>            cat <span class="op">=</span> conv[<span class="st">'category'</span>]</span>
<span id="cb25-2000"><a href="#cb25-2000" aria-hidden="true" tabindex="-1"></a>            category_stats[cat] <span class="op">=</span> category_stats.get(cat, <span class="dv">0</span>) <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb25-2001"><a href="#cb25-2001" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-2002"><a href="#cb25-2002" aria-hidden="true" tabindex="-1"></a>        html_content <span class="op">=</span> <span class="ss">f"""<!DOCTYPE html></span></span>
<span id="cb25-2003"><a href="#cb25-2003" aria-hidden="true" tabindex="-1"></a><span class="ss"><html lang="pt-PT"></span></span>
<span id="cb25-2004"><a href="#cb25-2004" aria-hidden="true" tabindex="-1"></a><span class="ss"><head>

        <style id="fixed-toc-styles">
        /* === ESTILOS PRINCIPAIS - TOC FIXO √Ä DIREITA === */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
            scroll-behavior: smooth;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            position: relative;
        }
        /* === TOC FIXO √Ä DIREITA - POSI√á√ÉO CORRIGIDA === */
        #TOC {
            position: fixed !important;
            top: 50% !important;
            right: 20px !important;
            transform: translateY(-50%) !important;
            width: 320px !important;
            max-height: 80vh !important;
            overflow-y: auto !important;
            z-index: 1000 !important;
            background: rgba(255, 255, 255, 0.98) !important;
            padding: 20px !important;
            border-radius: 12px !important;
            box-shadow: 0 8px 32px rgba(0,0,0,0.15) !important;
            border: 1px solid #e0e0e0 !important;
            backdrop-filter: blur(10px) !important;
            transition: all 0.3s ease-in-out !important;
        }
        #TOC.toc-minimized {
            transform: translateY(-50%) translateX(calc(320px - 50px)) !important;
            opacity: 0.3;
            width: 50px !important;
            overflow: hidden;
        }
        #TOC.toc-minimized > *:not(.toc-toggle-btn) {
            display: none !important;
        }
        #TOC h2 {
            margin-top: 0;
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
            font-size: 1.2em;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .toc-toggle-btn {
            background: none;
            border: none;
            font-size: 1.2em;
            cursor: pointer;
            padding: 5px;
            border-radius: 4px;
            transition: background-color 0.2s;
        }
        .toc-toggle-btn:hover {
            background-color: rgba(0,0,0,0.1);
        }
        #TOC ul {
            list-style-type: none;
            padding-left: 15px;
            margin: 10px 0;
        }
        #TOC ul ul {
            padding-left: 20px;
        }
        #TOC li {
            margin: 8px 0;
            line-height: 1.4;
        }
        #TOC a {
            text-decoration: none;
            color: #495057;
            font-weight: 500;
            transition: all 0.2s ease;
            display: block;
            padding: 6px 10px;
            border-radius: 6px;
            border-left: 3px solid transparent;
        }
        #TOC a:hover {
            color: #007bff;
            background-color: rgba(0, 123, 255, 0.1);
            border-left-color: #007bff;
        }
        #TOC a.active {
            background-color: #007bff !important;
            color: white !important;
            font-weight: bold;
            border-left-color: #0056b3;
        }
        /* Conte√∫do principal com margem para o TOC */
        .main-content {
            margin-right: calc(320px + 40px) !important;
        }
        /* Barra de scroll personalizada APENAS para TOC */
        #TOC::-webkit-scrollbar {
            width: 8px;
        }
        #TOC::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }
        #TOC::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 4px;
        }
        #TOC::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }
        /* === BOT√ÉO VOLTAR AO TOPO (HTMLs individuais) === */
        .back-to-top-content {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            font-size: 18px;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 999;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .back-to-top-content.show {
            opacity: 1;
            transform: translateY(0);
        }
        .back-to-top-content:hover {
            background: #0056b3;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0,0,0,0.2);
        }
        /* === RESPONSIVIDADE === */
        @media (max-width: 1400px) {
            .container {
                max-width: 95%;
                padding: 30px;
            }
            #TOC {
                width: 280px !important;
            }
            .main-content {
                margin-right: 320px !important;
            }
        }
        @media (max-width: 1200px) {
            #TOC {
                width: 260px !important;
                right: 15px !important;
            }
            .main-content {
                margin-right: 300px !important;
            }
        }
        @media (max-width: 992px) {
            #TOC {
                position: relative !important;
                width: 100% !important;
                right: 0 !important;
                top: 0 !important;
                transform: none !important;
                margin: 20px 0;
                max-height: 300px !important;
            }
            .main-content {
                margin-right: 0 !important;
            }
            .back-to-top-content {
                right: 20px;
                bottom: 20px;
            }
        }
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            .container {
                padding: 20px;
                max-width: 100%;
            }
            #TOC {
                max-height: 250px !important;
                padding: 15px !important;
            }
        }
        </style>
        </span></span>
<span id="cb25-2005"><a href="#cb25-2005" aria-hidden="true" tabindex="-1"></a><span class="ss">    <meta charset="UTF-8"></span></span>
<span id="cb25-2006"><a href="#cb25-2006" aria-hidden="true" tabindex="-1"></a><span class="ss">    <meta name="viewport" content="width=device-width, initial-scale=1.0"></span></span>
<span id="cb25-2007"><a href="#cb25-2007" aria-hidden="true" tabindex="-1"></a><span class="ss">    <title>√çndice Combinado - AI Chats</title></span></span>
<span id="cb25-2008"><a href="#cb25-2008" aria-hidden="true" tabindex="-1"></a><span class="ss">    <style></span></span>
<span id="cb25-2009"><a href="#cb25-2009" aria-hidden="true" tabindex="-1"></a><span class="ss">        * </span><span class="ch">{{</span><span class="ss"> margin: 0; padding: 0; box-sizing: border-box; </span><span class="ch">}}</span></span>
<span id="cb25-2010"><a href="#cb25-2010" aria-hidden="true" tabindex="-1"></a><span class="ss">        body </span><span class="ch">{{</span><span class="ss"> font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; padding: 20px; color: #333; </span><span class="ch">}}</span></span>
<span id="cb25-2011"><a href="#cb25-2011" aria-hidden="true" tabindex="-1"></a><span class="ss">        .container </span><span class="ch">{{</span><span class="ss"> max-width: 1400px; margin: 0 auto; background: white; border-radius: 15px; box-shadow: 0 20px 40px rgba(0,0,0,0.1); overflow: hidden; </span><span class="ch">}}</span></span>
<span id="cb25-2012"><a href="#cb25-2012" aria-hidden="true" tabindex="-1"></a><span class="ss">        .header </span><span class="ch">{{</span><span class="ss"> background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 40px; text-align: center; </span><span class="ch">}}</span></span>
<span id="cb25-2013"><a href="#cb25-2013" aria-hidden="true" tabindex="-1"></a><span class="ss">        .header h1 </span><span class="ch">{{</span><span class="ss"> font-size: 2.8em; margin-bottom: 15px; font-weight: 300; </span><span class="ch">}}</span></span>
<span id="cb25-2014"><a href="#cb25-2014" aria-hidden="true" tabindex="-1"></a><span class="ss">        .header p </span><span class="ch">{{</span><span class="ss"> font-size: 1.2em; opacity: 0.9; margin-bottom: 20px; </span><span class="ch">}}</span></span>
<span id="cb25-2015"><a href="#cb25-2015" aria-hidden="true" tabindex="-1"></a><span class="ss">        .stats </span><span class="ch">{{</span><span class="ss"> display: flex; justify-content: center; gap: 30px; margin-top: 25px; flex-wrap: wrap; </span><span class="ch">}}</span></span>
<span id="cb25-2016"><a href="#cb25-2016" aria-hidden="true" tabindex="-1"></a><span class="ss">        .stat-item </span><span class="ch">{{</span><span class="ss"> background: rgba(255,255,255,0.15); padding: 18px 28px; border-radius: 12px; backdrop-filter: blur(10px); font-size: 1.1em; </span><span class="ch">}}</span></span>
<span id="cb25-2017"><a href="#cb25-2017" aria-hidden="true" tabindex="-1"></a><span class="ss">        .search-section </span><span class="ch">{{</span><span class="ss"> padding: 30px; background: #f8f9fa; border-bottom: 1px solid #e9ecef; </span><span class="ch">}}</span></span>
<span id="cb25-2018"><a href="#cb25-2018" aria-hidden="true" tabindex="-1"></a><span class="ss">        .search-box </span><span class="ch">{{</span><span class="ss"> width: 100%; padding: 18px 25px; font-size: 16px; border: 2px solid #e9ecef; border-radius: 25px; outline: none; transition: all 0.3s ease; font-family: inherit; </span><span class="ch">}}</span></span>
<span id="cb25-2019"><a href="#cb25-2019" aria-hidden="true" tabindex="-1"></a><span class="ss">        .search-box:focus </span><span class="ch">{{</span><span class="ss"> border-color: #667eea; box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1); </span><span class="ch">}}</span></span>
<span id="cb25-2020"><a href="#cb25-2020" aria-hidden="true" tabindex="-1"></a><span class="ss">        .filter-section </span><span class="ch">{{</span></span>
<span id="cb25-2021"><a href="#cb25-2021" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 20px 30px;</span></span>
<span id="cb25-2022"><a href="#cb25-2022" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: flex;</span></span>
<span id="cb25-2023"><a href="#cb25-2023" aria-hidden="true" tabindex="-1"></a><span class="ss">            flex-wrap: wrap;</span></span>
<span id="cb25-2024"><a href="#cb25-2024" aria-hidden="true" tabindex="-1"></a><span class="ss">            gap: 12px;</span></span>
<span id="cb25-2025"><a href="#cb25-2025" aria-hidden="true" tabindex="-1"></a><span class="ss">            justify-content: center;</span></span>
<span id="cb25-2026"><a href="#cb25-2026" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #f8f9fa;</span></span>
<span id="cb25-2027"><a href="#cb25-2027" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-bottom: 1px solid #e9ecef;</span></span>
<span id="cb25-2028"><a href="#cb25-2028" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-2029"><a href="#cb25-2029" aria-hidden="true" tabindex="-1"></a><span class="ss">        .filter-btn </span><span class="ch">{{</span></span>
<span id="cb25-2030"><a href="#cb25-2030" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 10px 20px;</span></span>
<span id="cb25-2031"><a href="#cb25-2031" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: white;</span></span>
<span id="cb25-2032"><a href="#cb25-2032" aria-hidden="true" tabindex="-1"></a><span class="ss">            border: 2px solid #e9ecef;</span></span>
<span id="cb25-2033"><a href="#cb25-2033" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 25px;</span></span>
<span id="cb25-2034"><a href="#cb25-2034" aria-hidden="true" tabindex="-1"></a><span class="ss">            cursor: pointer;</span></span>
<span id="cb25-2035"><a href="#cb25-2035" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.95em;</span></span>
<span id="cb25-2036"><a href="#cb25-2036" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-weight: 500;</span></span>
<span id="cb25-2037"><a href="#cb25-2037" aria-hidden="true" tabindex="-1"></a><span class="ss">            transition: all 0.3s ease;</span></span>
<span id="cb25-2038"><a href="#cb25-2038" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-family: inherit;</span></span>
<span id="cb25-2039"><a href="#cb25-2039" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-2040"><a href="#cb25-2040" aria-hidden="true" tabindex="-1"></a><span class="ss">        .filter-btn.active, .filter-btn:hover </span><span class="ch">{{</span></span>
<span id="cb25-2041"><a href="#cb25-2041" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #667eea;</span></span>
<span id="cb25-2042"><a href="#cb25-2042" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: white;</span></span>
<span id="cb25-2043"><a href="#cb25-2043" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-color: #667eea;</span></span>
<span id="cb25-2044"><a href="#cb25-2044" aria-hidden="true" tabindex="-1"></a><span class="ss">            transform: translateY(-2px);</span></span>
<span id="cb25-2045"><a href="#cb25-2045" aria-hidden="true" tabindex="-1"></a><span class="ss">            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);</span></span>
<span id="cb25-2046"><a href="#cb25-2046" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-2047"><a href="#cb25-2047" aria-hidden="true" tabindex="-1"></a><span class="ss">        .conversations-grid </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb25-2048"><a href="#cb25-2048" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: grid; </span></span>
<span id="cb25-2049"><a href="#cb25-2049" aria-hidden="true" tabindex="-1"></a><span class="ss">            grid-template-columns: repeat(auto-fill, minmax(380px, 1fr)); </span></span>
<span id="cb25-2050"><a href="#cb25-2050" aria-hidden="true" tabindex="-1"></a><span class="ss">            gap: 25px; </span></span>
<span id="cb25-2051"><a href="#cb25-2051" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 35px;</span></span>
<span id="cb25-2052"><a href="#cb25-2052" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);</span></span>
<span id="cb25-2053"><a href="#cb25-2053" aria-hidden="true" tabindex="-1"></a><span class="ss">            min-height: 400px;</span></span>
<span id="cb25-2054"><a href="#cb25-2054" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-2055"><a href="#cb25-2055" aria-hidden="true" tabindex="-1"></a><span class="ss">        .conversation-card </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb25-2056"><a href="#cb25-2056" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: white; </span></span>
<span id="cb25-2057"><a href="#cb25-2057" aria-hidden="true" tabindex="-1"></a><span class="ss">            border: 1px solid #e9ecef; </span></span>
<span id="cb25-2058"><a href="#cb25-2058" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 15px; </span></span>
<span id="cb25-2059"><a href="#cb25-2059" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 25px; </span></span>
<span id="cb25-2060"><a href="#cb25-2060" aria-hidden="true" tabindex="-1"></a><span class="ss">            transition: all 0.4s ease; </span></span>
<span id="cb25-2061"><a href="#cb25-2061" aria-hidden="true" tabindex="-1"></a><span class="ss">            cursor: pointer; </span></span>
<span id="cb25-2062"><a href="#cb25-2062" aria-hidden="true" tabindex="-1"></a><span class="ss">            position: relative;</span></span>
<span id="cb25-2063"><a href="#cb25-2063" aria-hidden="true" tabindex="-1"></a><span class="ss">            box-shadow: 0 5px 15px rgba(0,0,0,0.08);</span></span>
<span id="cb25-2064"><a href="#cb25-2064" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-2065"><a href="#cb25-2065" aria-hidden="true" tabindex="-1"></a><span class="ss">        .conversation-card:hover </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb25-2066"><a href="#cb25-2066" aria-hidden="true" tabindex="-1"></a><span class="ss">            transform: translateY(-8px); </span></span>
<span id="cb25-2067"><a href="#cb25-2067" aria-hidden="true" tabindex="-1"></a><span class="ss">            box-shadow: 0 15px 35px rgba(0,0,0,0.15); </span></span>
<span id="cb25-2068"><a href="#cb25-2068" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-color: #667eea;</span></span>
<span id="cb25-2069"><a href="#cb25-2069" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-2070"><a href="#cb25-2070" aria-hidden="true" tabindex="-1"></a><span class="ss">        .card-header </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb25-2071"><a href="#cb25-2071" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: flex; </span></span>
<span id="cb25-2072"><a href="#cb25-2072" aria-hidden="true" tabindex="-1"></a><span class="ss">            justify-content: space-between; </span></span>
<span id="cb25-2073"><a href="#cb25-2073" aria-hidden="true" tabindex="-1"></a><span class="ss">            align-items: flex-start; </span></span>
<span id="cb25-2074"><a href="#cb25-2074" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-bottom: 18px; </span></span>
<span id="cb25-2075"><a href="#cb25-2075" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-2076"><a href="#cb25-2076" aria-hidden="true" tabindex="-1"></a><span class="ss">        .card-number </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb25-2077"><a href="#cb25-2077" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: linear-gradient(135deg, #667eea, #764ba2); </span></span>
<span id="cb25-2078"><a href="#cb25-2078" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: white; </span></span>
<span id="cb25-2079"><a href="#cb25-2079" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 8px 16px; </span></span>
<span id="cb25-2080"><a href="#cb25-2080" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 20px; </span></span>
<span id="cb25-2081"><a href="#cb25-2081" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.9em; </span></span>
<span id="cb25-2082"><a href="#cb25-2082" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-weight: bold;</span></span>
<span id="cb25-2083"><a href="#cb25-2083" aria-hidden="true" tabindex="-1"></a><span class="ss">            box-shadow: 0 3px 10px rgba(102, 126, 234, 0.3);</span></span>
<span id="cb25-2084"><a href="#cb25-2084" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-2085"><a href="#cb25-2085" aria-hidden="true" tabindex="-1"></a><span class="ss">        .card-source </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb25-2086"><a href="#cb25-2086" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #e3f2fd; </span></span>
<span id="cb25-2087"><a href="#cb25-2087" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #1976d2; </span></span>
<span id="cb25-2088"><a href="#cb25-2088" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 5px 12px; </span></span>
<span id="cb25-2089"><a href="#cb25-2089" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 12px; </span></span>
<span id="cb25-2090"><a href="#cb25-2090" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.85em; </span></span>
<span id="cb25-2091"><a href="#cb25-2091" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-weight: bold; </span></span>
<span id="cb25-2092"><a href="#cb25-2092" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-left: 10px;</span></span>
<span id="cb25-2093"><a href="#cb25-2093" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-2094"><a href="#cb25-2094" aria-hidden="true" tabindex="-1"></a><span class="ss">        .card-title </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb25-2095"><a href="#cb25-2095" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 1.3em; </span></span>
<span id="cb25-2096"><a href="#cb25-2096" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-weight: 600; </span></span>
<span id="cb25-2097"><a href="#cb25-2097" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #2c3e50; </span></span>
<span id="cb25-2098"><a href="#cb25-2098" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-bottom: 12px; </span></span>
<span id="cb25-2099"><a href="#cb25-2099" aria-hidden="true" tabindex="-1"></a><span class="ss">            line-height: 1.4;</span></span>
<span id="cb25-2100"><a href="#cb25-2100" aria-hidden="true" tabindex="-1"></a><span class="ss">            min-height: 3.6em;</span></span>
<span id="cb25-2101"><a href="#cb25-2101" aria-hidden="true" tabindex="-1"></a><span class="ss">            cursor: pointer;</span></span>
<span id="cb25-2102"><a href="#cb25-2102" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-2103"><a href="#cb25-2103" aria-hidden="true" tabindex="-1"></a><span class="ss">        .card-summary </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb25-2104"><a href="#cb25-2104" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #6c757d; </span></span>
<span id="cb25-2105"><a href="#cb25-2105" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.95em; </span></span>
<span id="cb25-2106"><a href="#cb25-2106" aria-hidden="true" tabindex="-1"></a><span class="ss">            line-height: 1.5; </span></span>
<span id="cb25-2107"><a href="#cb25-2107" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-bottom: 18px;</span></span>
<span id="cb25-2108"><a href="#cb25-2108" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: -webkit-box;</span></span>
<span id="cb25-2109"><a href="#cb25-2109" aria-hidden="true" tabindex="-1"></a><span class="ss">            -webkit-line-clamp: 3;</span></span>
<span id="cb25-2110"><a href="#cb25-2110" aria-hidden="true" tabindex="-1"></a><span class="ss">            -webkit-box-orient: vertical;</span></span>
<span id="cb25-2111"><a href="#cb25-2111" aria-hidden="true" tabindex="-1"></a><span class="ss">            overflow: hidden;</span></span>
<span id="cb25-2112"><a href="#cb25-2112" aria-hidden="true" tabindex="-1"></a><span class="ss">            cursor: pointer;</span></span>
<span id="cb25-2113"><a href="#cb25-2113" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-2114"><a href="#cb25-2114" aria-hidden="true" tabindex="-1"></a><span class="ss">        .card-meta </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb25-2115"><a href="#cb25-2115" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: flex; </span></span>
<span id="cb25-2116"><a href="#cb25-2116" aria-hidden="true" tabindex="-1"></a><span class="ss">            justify-content: space-between; </span></span>
<span id="cb25-2117"><a href="#cb25-2117" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.85em; </span></span>
<span id="cb25-2118"><a href="#cb25-2118" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #868e96; </span></span>
<span id="cb25-2119"><a href="#cb25-2119" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-top: 1px solid #e9ecef; </span></span>
<span id="cb25-2120"><a href="#cb25-2120" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding-top: 18px;</span></span>
<span id="cb25-2121"><a href="#cb25-2121" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-2122"><a href="#cb25-2122" aria-hidden="true" tabindex="-1"></a><span class="ss">        .card-actions </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb25-2123"><a href="#cb25-2123" aria-hidden="true" tabindex="-1"></a><span class="ss">            position: absolute; </span></span>
<span id="cb25-2124"><a href="#cb25-2124" aria-hidden="true" tabindex="-1"></a><span class="ss">            top: 20px; </span></span>
<span id="cb25-2125"><a href="#cb25-2125" aria-hidden="true" tabindex="-1"></a><span class="ss">            right: 20px; </span></span>
<span id="cb25-2126"><a href="#cb25-2126" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: flex; </span></span>
<span id="cb25-2127"><a href="#cb25-2127" aria-hidden="true" tabindex="-1"></a><span class="ss">            gap: 8px; </span></span>
<span id="cb25-2128"><a href="#cb25-2128" aria-hidden="true" tabindex="-1"></a><span class="ss">            opacity: 0; </span></span>
<span id="cb25-2129"><a href="#cb25-2129" aria-hidden="true" tabindex="-1"></a><span class="ss">            transition: opacity 0.3s ease; </span></span>
<span id="cb25-2130"><a href="#cb25-2130" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-2131"><a href="#cb25-2131" aria-hidden="true" tabindex="-1"></a><span class="ss">        .conversation-card:hover .card-actions </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb25-2132"><a href="#cb25-2132" aria-hidden="true" tabindex="-1"></a><span class="ss">            opacity: 1; </span></span>
<span id="cb25-2133"><a href="#cb25-2133" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-2134"><a href="#cb25-2134" aria-hidden="true" tabindex="-1"></a><span class="ss">        .action-btn </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb25-2135"><a href="#cb25-2135" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: white; </span></span>
<span id="cb25-2136"><a href="#cb25-2136" aria-hidden="true" tabindex="-1"></a><span class="ss">            border: 2px solid #e9ecef; </span></span>
<span id="cb25-2137"><a href="#cb25-2137" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 8px; </span></span>
<span id="cb25-2138"><a href="#cb25-2138" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 6px 12px; </span></span>
<span id="cb25-2139"><a href="#cb25-2139" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.8em; </span></span>
<span id="cb25-2140"><a href="#cb25-2140" aria-hidden="true" tabindex="-1"></a><span class="ss">            cursor: pointer; </span></span>
<span id="cb25-2141"><a href="#cb25-2141" aria-hidden="true" tabindex="-1"></a><span class="ss">            transition: all 0.3s ease;</span></span>
<span id="cb25-2142"><a href="#cb25-2142" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-weight: 500;</span></span>
<span id="cb25-2143"><a href="#cb25-2143" aria-hidden="true" tabindex="-1"></a><span class="ss">            text-decoration: none;</span></span>
<span id="cb25-2144"><a href="#cb25-2144" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #333;</span></span>
<span id="cb25-2145"><a href="#cb25-2145" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: inline-block;</span></span>
<span id="cb25-2146"><a href="#cb25-2146" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-2147"><a href="#cb25-2147" aria-hidden="true" tabindex="-1"></a><span class="ss">        .action-btn:hover </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb25-2148"><a href="#cb25-2148" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #667eea; </span></span>
<span id="cb25-2149"><a href="#cb25-2149" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: white; </span></span>
<span id="cb25-2150"><a href="#cb25-2150" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-color: #667eea;</span></span>
<span id="cb25-2151"><a href="#cb25-2151" aria-hidden="true" tabindex="-1"></a><span class="ss">            transform: scale(1.05);</span></span>
<span id="cb25-2152"><a href="#cb25-2152" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-2153"><a href="#cb25-2153" aria-hidden="true" tabindex="-1"></a><span class="ss">        .recent-badge </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb25-2154"><a href="#cb25-2154" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #ff6b6b; </span></span>
<span id="cb25-2155"><a href="#cb25-2155" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: white; </span></span>
<span id="cb25-2156"><a href="#cb25-2156" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 3px 10px; </span></span>
<span id="cb25-2157"><a href="#cb25-2157" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 12px; </span></span>
<span id="cb25-2158"><a href="#cb25-2158" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.75em; </span></span>
<span id="cb25-2159"><a href="#cb25-2159" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-left: 8px;</span></span>
<span id="cb25-2160"><a href="#cb25-2160" aria-hidden="true" tabindex="-1"></a><span class="ss">            animation: pulse 2s infinite;</span></span>
<span id="cb25-2161"><a href="#cb25-2161" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-2162"><a href="#cb25-2162" aria-hidden="true" tabindex="-1"></a><span class="ss">        .no-results </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb25-2163"><a href="#cb25-2163" aria-hidden="true" tabindex="-1"></a><span class="ss">            text-align: center; </span></span>
<span id="cb25-2164"><a href="#cb25-2164" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 60px 20px; </span></span>
<span id="cb25-2165"><a href="#cb25-2165" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #6c757d;</span></span>
<span id="cb25-2166"><a href="#cb25-2166" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 1.1em;</span></span>
<span id="cb25-2167"><a href="#cb25-2167" aria-hidden="true" tabindex="-1"></a><span class="ss">            grid-column: 1 / -1;</span></span>
<span id="cb25-2168"><a href="#cb25-2168" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-2169"><a href="#cb25-2169" aria-hidden="true" tabindex="-1"></a><span class="ss">        @keyframes pulse </span><span class="ch">{{</span></span>
<span id="cb25-2170"><a href="#cb25-2170" aria-hidden="true" tabindex="-1"></a><span class="ss">            0% </span><span class="ch">{{</span><span class="ss"> transform: scale(1); </span><span class="ch">}}</span></span>
<span id="cb25-2171"><a href="#cb25-2171" aria-hidden="true" tabindex="-1"></a><span class="ss">            50% </span><span class="ch">{{</span><span class="ss"> transform: scale(1.05); </span><span class="ch">}}</span></span>
<span id="cb25-2172"><a href="#cb25-2172" aria-hidden="true" tabindex="-1"></a><span class="ss">            100% </span><span class="ch">{{</span><span class="ss"> transform: scale(1); </span><span class="ch">}}</span></span>
<span id="cb25-2173"><a href="#cb25-2173" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-2174"><a href="#cb25-2174" aria-hidden="true" tabindex="-1"></a><span class="ss">        .category-badge </span><span class="ch">{{</span></span>
<span id="cb25-2175"><a href="#cb25-2175" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: inline-block;</span></span>
<span id="cb25-2176"><a href="#cb25-2176" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #e3f2fd;</span></span>
<span id="cb25-2177"><a href="#cb25-2177" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #1976d2;</span></span>
<span id="cb25-2178"><a href="#cb25-2178" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 4px 10px;</span></span>
<span id="cb25-2179"><a href="#cb25-2179" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 12px;</span></span>
<span id="cb25-2180"><a href="#cb25-2180" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.8em;</span></span>
<span id="cb25-2181"><a href="#cb25-2181" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-left: 8px;</span></span>
<span id="cb25-2182"><a href="#cb25-2182" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-weight: 500;</span></span>
<span id="cb25-2183"><a href="#cb25-2183" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-2184"><a href="#cb25-2184" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb25-2185"><a href="#cb25-2185" aria-hidden="true" tabindex="-1"></a><span class="ss">        .direct-link </span><span class="ch">{{</span></span>
<span id="cb25-2186"><a href="#cb25-2186" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: inline-block;</span></span>
<span id="cb25-2187"><a href="#cb25-2187" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin: 5px;</span></span>
<span id="cb25-2188"><a href="#cb25-2188" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 8px 15px;</span></span>
<span id="cb25-2189"><a href="#cb25-2189" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #28a745;</span></span>
<span id="cb25-2190"><a href="#cb25-2190" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: white;</span></span>
<span id="cb25-2191"><a href="#cb25-2191" aria-hidden="true" tabindex="-1"></a><span class="ss">            text-decoration: none;</span></span>
<span id="cb25-2192"><a href="#cb25-2192" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 5px;</span></span>
<span id="cb25-2193"><a href="#cb25-2193" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.9em;</span></span>
<span id="cb25-2194"><a href="#cb25-2194" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-2195"><a href="#cb25-2195" aria-hidden="true" tabindex="-1"></a><span class="ss">        .direct-link:hover </span><span class="ch">{{</span></span>
<span id="cb25-2196"><a href="#cb25-2196" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #218838;</span></span>
<span id="cb25-2197"><a href="#cb25-2197" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-2198"><a href="#cb25-2198" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb25-2199"><a href="#cb25-2199" aria-hidden="true" tabindex="-1"></a><span class="ss">        .html-btn </span><span class="ch">{{</span></span>
<span id="cb25-2200"><a href="#cb25-2200" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #17a2b8;</span></span>
<span id="cb25-2201"><a href="#cb25-2201" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: white;</span></span>
<span id="cb25-2202"><a href="#cb25-2202" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-2203"><a href="#cb25-2203" aria-hidden="true" tabindex="-1"></a><span class="ss">        .html-btn:hover </span><span class="ch">{{</span></span>
<span id="cb25-2204"><a href="#cb25-2204" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #138496;</span></span>
<span id="cb25-2205"><a href="#cb25-2205" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-2206"><a href="#cb25-2206" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb25-2207"><a href="#cb25-2207" aria-hidden="true" tabindex="-1"></a><span class="ss">        .pdf-btn </span><span class="ch">{{</span></span>
<span id="cb25-2208"><a href="#cb25-2208" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #dc3545;</span></span>
<span id="cb25-2209"><a href="#cb25-2209" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: white;</span></span>
<span id="cb25-2210"><a href="#cb25-2210" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-2211"><a href="#cb25-2211" aria-hidden="true" tabindex="-1"></a><span class="ss">        .pdf-btn:hover </span><span class="ch">{{</span></span>
<span id="cb25-2212"><a href="#cb25-2212" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #c82333;</span></span>
<span id="cb25-2213"><a href="#cb25-2213" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb25-2214"><a href="#cb25-2214" aria-hidden="true" tabindex="-1"></a><span class="ss">    </style></span></span>
<span id="cb25-2215"><a href="#cb25-2215" aria-hidden="true" tabindex="-1"></a><span class="ss"></head></span></span>
<span id="cb25-2216"><a href="#cb25-2216" aria-hidden="true" tabindex="-1"></a><span class="ss"><body></span></span>
<span id="cb25-2217"><a href="#cb25-2217" aria-hidden="true" tabindex="-1"></a><span class="ss">    <div class="container"></span></span>
<span id="cb25-2218"><a href="#cb25-2218" aria-hidden="true" tabindex="-1"></a><span class="ss">        <div class="header"></span></span>
<span id="cb25-2219"><a href="#cb25-2219" aria-hidden="true" tabindex="-1"></a><span class="ss">            <h1>üìö √çndice Combinado de Conversas</h1></span></span>
<span id="cb25-2220"><a href="#cb25-2220" aria-hidden="true" tabindex="-1"></a><span class="ss">            <p>Qwen3 ‚Ä¢ ChatGPT ‚Ä¢ DeepSeek ‚Ä¢ Grok ‚Ä¢ COM HTML (Pandoc + MathJax)</p></span></span>
<span id="cb25-2221"><a href="#cb25-2221" aria-hidden="true" tabindex="-1"></a><span class="ss">            <div class="stats"></span></span>
<span id="cb25-2222"><a href="#cb25-2222" aria-hidden="true" tabindex="-1"></a><span class="ss">                <div class="stat-item"></span></span>
<span id="cb25-2223"><a href="#cb25-2223" aria-hidden="true" tabindex="-1"></a><span class="ss">                    <strong>Total:</strong> <span id="total-count"></span><span class="sc">{</span><span class="bu">len</span>(<span class="va">self</span>.all_conversations)<span class="sc">}</span><span class="ss"></span> conversas</span></span>
<span id="cb25-2224"><a href="#cb25-2224" aria-hidden="true" tabindex="-1"></a><span class="ss">                </div></span></span>
<span id="cb25-2225"><a href="#cb25-2225" aria-hidden="true" tabindex="-1"></a><span class="ss">                <div class="stat-item"></span></span>
<span id="cb25-2226"><a href="#cb25-2226" aria-hidden="true" tabindex="-1"></a><span class="ss">                    <strong>Ordena√ß√£o:</strong> Mais Recentes Primeiro</span></span>
<span id="cb25-2227"><a href="#cb25-2227" aria-hidden="true" tabindex="-1"></a><span class="ss">                </div></span></span>
<span id="cb25-2228"><a href="#cb25-2228" aria-hidden="true" tabindex="-1"></a><span class="ss">                <div class="stat-item"></span></span>
<span id="cb25-2229"><a href="#cb25-2229" aria-hidden="true" tabindex="-1"></a><span class="ss">                    <strong>Atualizado:</strong> </span><span class="sc">{</span>datetime<span class="sc">.</span>now()<span class="sc">.</span>strftime(<span class="st">'</span><span class="sc">%d</span><span class="st">/%m/%Y %H:%M'</span>)<span class="sc">}</span></span>
<span id="cb25-2230"><a href="#cb25-2230" aria-hidden="true" tabindex="-1"></a><span class="ss">                </div></span></span>
<span id="cb25-2231"><a href="#cb25-2231" aria-hidden="true" tabindex="-1"></a><span class="ss">            </div></span></span>
<span id="cb25-2232"><a href="#cb25-2232" aria-hidden="true" tabindex="-1"></a><span class="ss">        </div></span></span>
<span id="cb25-2233"><a href="#cb25-2233" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb25-2234"><a href="#cb25-2234" aria-hidden="true" tabindex="-1"></a><span class="ss">        <div class="search-section"></span></span>
<span id="cb25-2235"><a href="#cb25-2235" aria-hidden="true" tabindex="-1"></a><span class="ss">            <input type="text" id="searchInput" class="search-box" placeholder="üîç Pesquisar por t√≠tulo, conte√∫do ou categoria..."></span></span>
<span id="cb25-2236"><a href="#cb25-2236" aria-hidden="true" tabindex="-1"></a><span class="ss">        </div></span></span>
<span id="cb25-2237"><a href="#cb25-2237" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb25-2238"><a href="#cb25-2238" aria-hidden="true" tabindex="-1"></a><span class="ss">        <div class="filter-section"></span></span>
<span id="cb25-2239"><a href="#cb25-2239" aria-hidden="true" tabindex="-1"></a><span class="ss">            <button class="filter-btn active" data-filter="todas">Todas (</span><span class="sc">{</span><span class="bu">len</span>(<span class="va">self</span>.all_conversations)<span class="sc">}</span><span class="ss">)</button></span></span>
<span id="cb25-2240"><a href="#cb25-2240" aria-hidden="true" tabindex="-1"></a><span class="ss">"""</span></span>
<span id="cb25-2241"><a href="#cb25-2241" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-2242"><a href="#cb25-2242" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> category, count <span class="kw">in</span> category_stats.items():</span>
<span id="cb25-2243"><a href="#cb25-2243" aria-hidden="true" tabindex="-1"></a>            html_content <span class="op">+=</span> <span class="ss">f'<button class="filter-btn" data-filter="</span><span class="sc">{</span>category<span class="sc">.</span>lower()<span class="sc">}</span><span class="ss">"></span><span class="sc">{</span>category<span class="sc">}</span><span class="ss"> (</span><span class="sc">{</span>count<span class="sc">}</span><span class="ss">)</button></span><span class="ch">\n</span><span class="ss">'</span></span>
<span id="cb25-2244"><a href="#cb25-2244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-2245"><a href="#cb25-2245" aria-hidden="true" tabindex="-1"></a>        html_content <span class="op">+=</span> <span class="st">"""</span></span>
<span id="cb25-2246"><a href="#cb25-2246" aria-hidden="true" tabindex="-1"></a><span class="st">        </div></span></span>
<span id="cb25-2247"><a href="#cb25-2247" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb25-2248"><a href="#cb25-2248" aria-hidden="true" tabindex="-1"></a><span class="st">        <div style="text-align: center; padding: 15px; background: #e9ecef; border-bottom: 1px solid #ddd;"></span></span>
<span id="cb25-2249"><a href="#cb25-2249" aria-hidden="true" tabindex="-1"></a><span class="st">            <strong>Acesso R√°pido:</strong></span></span>
<span id="cb25-2250"><a href="#cb25-2250" aria-hidden="true" tabindex="-1"></a><span class="st">            <a href="combined_markdown/" class="direct-link" target="_blank">üìÅ Markdown</a></span></span>
<span id="cb25-2251"><a href="#cb25-2251" aria-hidden="true" tabindex="-1"></a><span class="st">            <a href="combined_html/" class="direct-link" target="_blank">üåê HTML</a></span></span>
<span id="cb25-2252"><a href="#cb25-2252" aria-hidden="true" tabindex="-1"></a><span class="st">            <a href="combined_pdfs/" class="direct-link" target="_blank">üìÑ PDF</a></span></span>
<span id="cb25-2253"><a href="#cb25-2253" aria-hidden="true" tabindex="-1"></a><span class="st">            <a href="combined_json/" class="direct-link" target="_blank">üìã JSON</a></span></span>
<span id="cb25-2254"><a href="#cb25-2254" aria-hidden="true" tabindex="-1"></a><span class="st">        </div></span></span>
<span id="cb25-2255"><a href="#cb25-2255" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb25-2256"><a href="#cb25-2256" aria-hidden="true" tabindex="-1"></a><span class="st">        <div class="conversations-grid" id="conversationsGrid"></span></span>
<span id="cb25-2257"><a href="#cb25-2257" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb25-2258"><a href="#cb25-2258" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-2259"><a href="#cb25-2259" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, conv <span class="kw">in</span> <span class="bu">enumerate</span>(<span class="va">self</span>.all_conversations):</span>
<span id="cb25-2260"><a href="#cb25-2260" aria-hidden="true" tabindex="-1"></a>            safe_title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(conv[<span class="st">'title'</span>])</span>
<span id="cb25-2261"><a href="#cb25-2261" aria-hidden="true" tabindex="-1"></a>            filename <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>conv[<span class="st">'number'</span>]<span class="sc">:03d}</span><span class="ss">_</span><span class="sc">{</span>conv[<span class="st">'source'</span>]<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>safe_title<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb25-2262"><a href="#cb25-2262" aria-hidden="true" tabindex="-1"></a>            recent_badge <span class="op">=</span> <span class="st">"<span class='recent-badge'>NOVO</span>"</span> <span class="cf">if</span> i <span class="op"><</span> <span class="dv">5</span> <span class="cf">else</span> <span class="st">""</span></span>
<span id="cb25-2263"><a href="#cb25-2263" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-2264"><a href="#cb25-2264" aria-hidden="true" tabindex="-1"></a>            summary <span class="op">=</span> conv.get(<span class="st">'summary'</span>, <span class="st">'Sem resumo dispon√≠vel'</span>)</span>
<span id="cb25-2265"><a href="#cb25-2265" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">len</span>(summary) <span class="op">></span> <span class="dv">150</span>:</span>
<span id="cb25-2266"><a href="#cb25-2266" aria-hidden="true" tabindex="-1"></a>                summary <span class="op">=</span> summary[:<span class="dv">150</span>] <span class="op">+</span> <span class="st">"..."</span></span>
<span id="cb25-2267"><a href="#cb25-2267" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-2268"><a href="#cb25-2268" aria-hidden="true" tabindex="-1"></a>            html_content <span class="op">+=</span> <span class="ss">f"""</span></span>
<span id="cb25-2269"><a href="#cb25-2269" aria-hidden="true" tabindex="-1"></a><span class="ss">            <div class="conversation-card" data-title="</span><span class="sc">{</span>conv[<span class="st">'title'</span>]<span class="sc">}</span><span class="ss">" data-summary="</span><span class="sc">{</span>summary<span class="sc">}</span><span class="ss">" data-source="</span><span class="sc">{</span>conv[<span class="st">'source'</span>]<span class="sc">.</span>lower()<span class="sc">}</span><span class="ss">" data-category="</span><span class="sc">{</span>conv[<span class="st">'category'</span>]<span class="sc">.</span>lower()<span class="sc">}</span><span class="ss">"></span></span>
<span id="cb25-2270"><a href="#cb25-2270" aria-hidden="true" tabindex="-1"></a><span class="ss">                <div class="card-header"></span></span>
<span id="cb25-2271"><a href="#cb25-2271" aria-hidden="true" tabindex="-1"></a><span class="ss">                    <div class="card-number">#</span><span class="sc">{</span>conv[<span class="st">'number'</span>]<span class="sc">}</span><span class="ss"> </span><span class="sc">{</span>recent_badge<span class="sc">}</span><span class="ss"></div></span></span>
<span id="cb25-2272"><a href="#cb25-2272" aria-hidden="true" tabindex="-1"></a><span class="ss">                    <div class="card-actions"></span></span>
<span id="cb25-2273"><a href="#cb25-2273" aria-hidden="true" tabindex="-1"></a><span class="ss">                        <a href="combined_markdown/</span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">.md" class="action-btn" target="_blank" onclick="event.stopPropagation();">üìÑ MD</a></span></span>
<span id="cb25-2274"><a href="#cb25-2274" aria-hidden="true" tabindex="-1"></a><span class="ss">                        <a href="combined_html/</span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">.html" class="action-btn html-btn" target="_blank" onclick="event.stopPropagation();">üåê HTML</a></span></span>
<span id="cb25-2275"><a href="#cb25-2275" aria-hidden="true" tabindex="-1"></a><span class="ss">                        <a href="combined_pdfs/</span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">.pdf" class="action-btn pdf-btn" target="_blank" onclick="event.stopPropagation();">üìä PDF</a></span></span>
<span id="cb25-2276"><a href="#cb25-2276" aria-hidden="true" tabindex="-1"></a><span class="ss">                    </div></span></span>
<span id="cb25-2277"><a href="#cb25-2277" aria-hidden="true" tabindex="-1"></a><span class="ss">                </div></span></span>
<span id="cb25-2278"><a href="#cb25-2278" aria-hidden="true" tabindex="-1"></a><span class="ss">                <div class="card-title" onclick="openHTML('</span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">.html')"></span><span class="sc">{</span>conv[<span class="st">'title'</span>]<span class="sc">}</span><span class="ss"></div></span></span>
<span id="cb25-2279"><a href="#cb25-2279" aria-hidden="true" tabindex="-1"></a><span class="ss">                <div></span></span>
<span id="cb25-2280"><a href="#cb25-2280" aria-hidden="true" tabindex="-1"></a><span class="ss">                    <span class="card-source"></span><span class="sc">{</span>conv[<span class="st">'source'</span>]<span class="sc">}</span><span class="ss"></span></span></span>
<span id="cb25-2281"><a href="#cb25-2281" aria-hidden="true" tabindex="-1"></a><span class="ss">                    <span class="category-badge"></span><span class="sc">{</span>conv[<span class="st">'category'</span>]<span class="sc">}</span><span class="ss"></span></span></span>
<span id="cb25-2282"><a href="#cb25-2282" aria-hidden="true" tabindex="-1"></a><span class="ss">                </div></span></span>
<span id="cb25-2283"><a href="#cb25-2283" aria-hidden="true" tabindex="-1"></a><span class="ss">                <div class="card-summary" onclick="openHTML('</span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">.html')"></span><span class="sc">{</span>summary<span class="sc">}</span><span class="ss"></div></span></span>
<span id="cb25-2284"><a href="#cb25-2284" aria-hidden="true" tabindex="-1"></a><span class="ss">                <div class="card-meta"></span></span>
<span id="cb25-2285"><a href="#cb25-2285" aria-hidden="true" tabindex="-1"></a><span class="ss">                    <span>üìÖ </span><span class="sc">{</span>conv<span class="sc">.</span>get(<span class="st">'updated_at'</span>) <span class="kw">or</span> conv<span class="sc">.</span>get(<span class="st">'inserted_at'</span>) <span class="kw">or</span> <span class="st">'N/A'</span><span class="sc">}</span><span class="ss"></span></span></span>
<span id="cb25-2286"><a href="#cb25-2286" aria-hidden="true" tabindex="-1"></a><span class="ss">                    <span>üí¨ </span><span class="sc">{</span><span class="bu">len</span>(conv[<span class="st">'messages'</span>])<span class="sc">}</span><span class="ss"> mensagens</span></span></span>
<span id="cb25-2287"><a href="#cb25-2287" aria-hidden="true" tabindex="-1"></a><span class="ss">                </div></span></span>
<span id="cb25-2288"><a href="#cb25-2288" aria-hidden="true" tabindex="-1"></a><span class="ss">            </div></span></span>
<span id="cb25-2289"><a href="#cb25-2289" aria-hidden="true" tabindex="-1"></a><span class="ss">            """</span></span>
<span id="cb25-2290"><a href="#cb25-2290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-2291"><a href="#cb25-2291" aria-hidden="true" tabindex="-1"></a>        html_content <span class="op">+=</span> <span class="st">"""</span></span>
<span id="cb25-2292"><a href="#cb25-2292" aria-hidden="true" tabindex="-1"></a><span class="st">        </div></span></span>
<span id="cb25-2293"><a href="#cb25-2293" aria-hidden="true" tabindex="-1"></a><span class="st">    </div></span></span>
<span id="cb25-2294"><a href="#cb25-2294" aria-hidden="true" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb25-2295"><a href="#cb25-2295" aria-hidden="true" tabindex="-1"></a><span class="st">    <script></span></span>
<span id="cb25-2296"><a href="#cb25-2296" aria-hidden="true" tabindex="-1"></a><span class="st">        let currentFilter = 'todas';</span></span>
<span id="cb25-2297"><a href="#cb25-2297" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb25-2298"><a href="#cb25-2298" aria-hidden="true" tabindex="-1"></a><span class="st">        document.addEventListener('DOMContentLoaded', function() {</span></span>
<span id="cb25-2299"><a href="#cb25-2299" aria-hidden="true" tabindex="-1"></a><span class="st">            updateStats();</span></span>
<span id="cb25-2300"><a href="#cb25-2300" aria-hidden="true" tabindex="-1"></a><span class="st">        });</span></span>
<span id="cb25-2301"><a href="#cb25-2301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-2302"><a href="#cb25-2302" aria-hidden="true" tabindex="-1"></a><span class="st">        document.querySelectorAll('.filter-btn').forEach(btn => {</span></span>
<span id="cb25-2303"><a href="#cb25-2303" aria-hidden="true" tabindex="-1"></a><span class="st">            btn.addEventListener('click', () => {</span></span>
<span id="cb25-2304"><a href="#cb25-2304" aria-hidden="true" tabindex="-1"></a><span class="st">                document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));</span></span>
<span id="cb25-2305"><a href="#cb25-2305" aria-hidden="true" tabindex="-1"></a><span class="st">                btn.classList.add('active');</span></span>
<span id="cb25-2306"><a href="#cb25-2306" aria-hidden="true" tabindex="-1"></a><span class="st">                currentFilter = btn.getAttribute('data-filter');</span></span>
<span id="cb25-2307"><a href="#cb25-2307" aria-hidden="true" tabindex="-1"></a><span class="st">                filterConversations();</span></span>
<span id="cb25-2308"><a href="#cb25-2308" aria-hidden="true" tabindex="-1"></a><span class="st">            });</span></span>
<span id="cb25-2309"><a href="#cb25-2309" aria-hidden="true" tabindex="-1"></a><span class="st">        });</span></span>
<span id="cb25-2310"><a href="#cb25-2310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-2311"><a href="#cb25-2311" aria-hidden="true" tabindex="-1"></a><span class="st">        document.getElementById('searchInput').addEventListener('input', filterConversations);</span></span>
<span id="cb25-2312"><a href="#cb25-2312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-2313"><a href="#cb25-2313" aria-hidden="true" tabindex="-1"></a><span class="st">        function filterConversations() {</span></span>
<span id="cb25-2314"><a href="#cb25-2314" aria-hidden="true" tabindex="-1"></a><span class="st">            const term = document.getElementById('searchInput').value.toLowerCase();</span></span>
<span id="cb25-2315"><a href="#cb25-2315" aria-hidden="true" tabindex="-1"></a><span class="st">            const cards = document.querySelectorAll('.conversation-card');</span></span>
<span id="cb25-2316"><a href="#cb25-2316" aria-hidden="true" tabindex="-1"></a><span class="st">            let visible = 0;</span></span>
<span id="cb25-2317"><a href="#cb25-2317" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb25-2318"><a href="#cb25-2318" aria-hidden="true" tabindex="-1"></a><span class="st">            cards.forEach(card => {</span></span>
<span id="cb25-2319"><a href="#cb25-2319" aria-hidden="true" tabindex="-1"></a><span class="st">                const title = card.getAttribute('data-title').toLowerCase();</span></span>
<span id="cb25-2320"><a href="#cb25-2320" aria-hidden="true" tabindex="-1"></a><span class="st">                const summary = card.getAttribute('data-summary').toLowerCase();</span></span>
<span id="cb25-2321"><a href="#cb25-2321" aria-hidden="true" tabindex="-1"></a><span class="st">                const source = card.getAttribute('data-source').toLowerCase();</span></span>
<span id="cb25-2322"><a href="#cb25-2322" aria-hidden="true" tabindex="-1"></a><span class="st">                const category = card.getAttribute('data-category').toLowerCase();</span></span>
<span id="cb25-2323"><a href="#cb25-2323" aria-hidden="true" tabindex="-1"></a><span class="st">                </span></span>
<span id="cb25-2324"><a href="#cb25-2324" aria-hidden="true" tabindex="-1"></a><span class="st">                const matchesSearch = (title.includes(term) || summary.includes(term) || category.includes(term) || source.includes(term));</span></span>
<span id="cb25-2325"><a href="#cb25-2325" aria-hidden="true" tabindex="-1"></a><span class="st">                const matchesCategory = (currentFilter === 'todas' || category === currentFilter);</span></span>
<span id="cb25-2326"><a href="#cb25-2326" aria-hidden="true" tabindex="-1"></a><span class="st">                </span></span>
<span id="cb25-2327"><a href="#cb25-2327" aria-hidden="true" tabindex="-1"></a><span class="st">                if (matchesSearch && matchesCategory) {</span></span>
<span id="cb25-2328"><a href="#cb25-2328" aria-hidden="true" tabindex="-1"></a><span class="st">                    card.style.display = 'block';</span></span>
<span id="cb25-2329"><a href="#cb25-2329" aria-hidden="true" tabindex="-1"></a><span class="st">                    visible++;</span></span>
<span id="cb25-2330"><a href="#cb25-2330" aria-hidden="true" tabindex="-1"></a><span class="st">                } else {</span></span>
<span id="cb25-2331"><a href="#cb25-2331" aria-hidden="true" tabindex="-1"></a><span class="st">                    card.style.display = 'none';</span></span>
<span id="cb25-2332"><a href="#cb25-2332" aria-hidden="true" tabindex="-1"></a><span class="st">                }</span></span>
<span id="cb25-2333"><a href="#cb25-2333" aria-hidden="true" tabindex="-1"></a><span class="st">            });</span></span>
<span id="cb25-2334"><a href="#cb25-2334" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb25-2335"><a href="#cb25-2335" aria-hidden="true" tabindex="-1"></a><span class="st">            updateStats(visible);</span></span>
<span id="cb25-2336"><a href="#cb25-2336" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb25-2337"><a href="#cb25-2337" aria-hidden="true" tabindex="-1"></a><span class="st">            const grid = document.getElementById('conversationsGrid');</span></span>
<span id="cb25-2338"><a href="#cb25-2338" aria-hidden="true" tabindex="-1"></a><span class="st">            const noResults = document.getElementById('no-results-message');</span></span>
<span id="cb25-2339"><a href="#cb25-2339" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb25-2340"><a href="#cb25-2340" aria-hidden="true" tabindex="-1"></a><span class="st">            if (visible === 0) {</span></span>
<span id="cb25-2341"><a href="#cb25-2341" aria-hidden="true" tabindex="-1"></a><span class="st">                if (!noResults) {</span></span>
<span id="cb25-2342"><a href="#cb25-2342" aria-hidden="true" tabindex="-1"></a><span class="st">                    const noResultsMsg = document.createElement('div');</span></span>
<span id="cb25-2343"><a href="#cb25-2343" aria-hidden="true" tabindex="-1"></a><span class="st">                    noResultsMsg.id = 'no-results-message';</span></span>
<span id="cb25-2344"><a href="#cb25-2344" aria-hidden="true" tabindex="-1"></a><span class="st">                    noResultsMsg.className = 'no-results';</span></span>
<span id="cb25-2345"><a href="#cb25-2345" aria-hidden="true" tabindex="-1"></a><span class="st">                    noResultsMsg.innerHTML = 'üîç Nenhuma conversa encontrada. Tente ajustar os filtros ou a pesquisa.';</span></span>
<span id="cb25-2346"><a href="#cb25-2346" aria-hidden="true" tabindex="-1"></a><span class="st">                    grid.appendChild(noResultsMsg);</span></span>
<span id="cb25-2347"><a href="#cb25-2347" aria-hidden="true" tabindex="-1"></a><span class="st">                }</span></span>
<span id="cb25-2348"><a href="#cb25-2348" aria-hidden="true" tabindex="-1"></a><span class="st">            } else if (noResults) {</span></span>
<span id="cb25-2349"><a href="#cb25-2349" aria-hidden="true" tabindex="-1"></a><span class="st">                noResults.remove();</span></span>
<span id="cb25-2350"><a href="#cb25-2350" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb25-2351"><a href="#cb25-2351" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb25-2352"><a href="#cb25-2352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-2353"><a href="#cb25-2353" aria-hidden="true" tabindex="-1"></a><span class="st">        function updateStats(visibleCount = null) {</span></span>
<span id="cb25-2354"><a href="#cb25-2354" aria-hidden="true" tabindex="-1"></a><span class="st">            const totalElement = document.getElementById('total-count');</span></span>
<span id="cb25-2355"><a href="#cb25-2355" aria-hidden="true" tabindex="-1"></a><span class="st">            if (visibleCount !== null) {</span></span>
<span id="cb25-2356"><a href="#cb25-2356" aria-hidden="true" tabindex="-1"></a><span class="st">                totalElement.textContent = visibleCount;</span></span>
<span id="cb25-2357"><a href="#cb25-2357" aria-hidden="true" tabindex="-1"></a><span class="st">            } else {</span></span>
<span id="cb25-2358"><a href="#cb25-2358" aria-hidden="true" tabindex="-1"></a><span class="st">                totalElement.textContent = """</span> <span class="op">+</span> <span class="bu">str</span>(<span class="bu">len</span>(<span class="va">self</span>.all_conversations)) <span class="op">+</span> <span class="st">""";</span></span>
<span id="cb25-2359"><a href="#cb25-2359" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb25-2360"><a href="#cb25-2360" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb25-2361"><a href="#cb25-2361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-2362"><a href="#cb25-2362" aria-hidden="true" tabindex="-1"></a><span class="st">        function openHTML(filename) {</span></span>
<span id="cb25-2363"><a href="#cb25-2363" aria-hidden="true" tabindex="-1"></a><span class="st">            const htmlUrl = 'combined_html/' + filename;</span></span>
<span id="cb25-2364"><a href="#cb25-2364" aria-hidden="true" tabindex="-1"></a><span class="st">            console.log('Abrindo HTML:', htmlUrl);</span></span>
<span id="cb25-2365"><a href="#cb25-2365" aria-hidden="true" tabindex="-1"></a><span class="st">            window.open(htmlUrl, '_blank');</span></span>
<span id="cb25-2366"><a href="#cb25-2366" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb25-2367"><a href="#cb25-2367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-2368"><a href="#cb25-2368" aria-hidden="true" tabindex="-1"></a><span class="st">        function openMD(filename) {</span></span>
<span id="cb25-2369"><a href="#cb25-2369" aria-hidden="true" tabindex="-1"></a><span class="st">            const mdUrl = 'combined_markdown/' + filename;</span></span>
<span id="cb25-2370"><a href="#cb25-2370" aria-hidden="true" tabindex="-1"></a><span class="st">            window.open(mdUrl, '_blank');</span></span>
<span id="cb25-2371"><a href="#cb25-2371" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb25-2372"><a href="#cb25-2372" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb25-2373"><a href="#cb25-2373" aria-hidden="true" tabindex="-1"></a><span class="st">        function openPDF(filename) {</span></span>
<span id="cb25-2374"><a href="#cb25-2374" aria-hidden="true" tabindex="-1"></a><span class="st">            const pdfFile = filename.replace('.html', '.pdf');</span></span>
<span id="cb25-2375"><a href="#cb25-2375" aria-hidden="true" tabindex="-1"></a><span class="st">            const pdfUrl = 'combined_pdfs/' + pdfFile;</span></span>
<span id="cb25-2376"><a href="#cb25-2376" aria-hidden="true" tabindex="-1"></a><span class="st">            window.open(pdfUrl, '_blank');</span></span>
<span id="cb25-2377"><a href="#cb25-2377" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb25-2378"><a href="#cb25-2378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-2379"><a href="#cb25-2379" aria-hidden="true" tabindex="-1"></a><span class="st">        document.addEventListener('keydown', function(e) {</span></span>
<span id="cb25-2380"><a href="#cb25-2380" aria-hidden="true" tabindex="-1"></a><span class="st">            if (e.key === 'Escape') {</span></span>
<span id="cb25-2381"><a href="#cb25-2381" aria-hidden="true" tabindex="-1"></a><span class="st">                document.getElementById('searchInput').value = '';</span></span>
<span id="cb25-2382"><a href="#cb25-2382" aria-hidden="true" tabindex="-1"></a><span class="st">                filterConversations();</span></span>
<span id="cb25-2383"><a href="#cb25-2383" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb25-2384"><a href="#cb25-2384" aria-hidden="true" tabindex="-1"></a><span class="st">        });</span></span>
<span id="cb25-2385"><a href="#cb25-2385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-2386"><a href="#cb25-2386" aria-hidden="true" tabindex="-1"></a><span class="st">        document.querySelectorAll('.conversation-card').forEach(card => {</span></span>
<span id="cb25-2387"><a href="#cb25-2387" aria-hidden="true" tabindex="-1"></a><span class="st">            card.addEventListener('click', function(e) {</span></span>
<span id="cb25-2388"><a href="#cb25-2388" aria-hidden="true" tabindex="-1"></a><span class="st">                if (e.target.closest('.action-btn')) {</span></span>
<span id="cb25-2389"><a href="#cb25-2389" aria-hidden="true" tabindex="-1"></a><span class="st">                    return;</span></span>
<span id="cb25-2390"><a href="#cb25-2390" aria-hidden="true" tabindex="-1"></a><span class="st">                }</span></span>
<span id="cb25-2391"><a href="#cb25-2391" aria-hidden="true" tabindex="-1"></a><span class="st">                </span></span>
<span id="cb25-2392"><a href="#cb25-2392" aria-hidden="true" tabindex="-1"></a><span class="st">                const htmlBtn = this.querySelector('a.html-btn');</span></span>
<span id="cb25-2393"><a href="#cb25-2393" aria-hidden="true" tabindex="-1"></a><span class="st">                if (htmlBtn) {</span></span>
<span id="cb25-2394"><a href="#cb25-2394" aria-hidden="true" tabindex="-1"></a><span class="st">                    const htmlUrl = htmlBtn.getAttribute('href');</span></span>
<span id="cb25-2395"><a href="#cb25-2395" aria-hidden="true" tabindex="-1"></a><span class="st">                    window.open(htmlUrl, '_blank');</span></span>
<span id="cb25-2396"><a href="#cb25-2396" aria-hidden="true" tabindex="-1"></a><span class="st">                }</span></span>
<span id="cb25-2397"><a href="#cb25-2397" aria-hidden="true" tabindex="-1"></a><span class="st">            });</span></span>
<span id="cb25-2398"><a href="#cb25-2398" aria-hidden="true" tabindex="-1"></a><span class="st">        });</span></span>
<span id="cb25-2399"><a href="#cb25-2399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-2400"><a href="#cb25-2400" aria-hidden="true" tabindex="-1"></a><span class="st">        document.getElementById('searchInput').focus();</span></span>
<span id="cb25-2401"><a href="#cb25-2401" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb25-2402"><a href="#cb25-2402" aria-hidden="true" tabindex="-1"></a><span class="st">        console.log('√çndice carregado com', """</span> <span class="op">+</span> <span class="bu">str</span>(<span class="bu">len</span>(<span class="va">self</span>.all_conversations)) <span class="op">+</span> <span class="st">""", 'conversas');</span></span>
<span id="cb25-2403"><a href="#cb25-2403" aria-hidden="true" tabindex="-1"></a><span class="st">    </script></span></span>
<span id="cb25-2404"><a href="#cb25-2404" aria-hidden="true" tabindex="-1"></a><span class="st">
        <script id="fixed-toc-script">
        document.addEventListener('DOMContentLoaded', function() {
            const toc = document.getElementById('TOC');
            if (toc) {
                const tocTitle = toc.querySelector('h2');
                if (tocTitle) {
                    const toggleBtn = document.createElement('button');
                    toggleBtn.innerHTML = '‚ò∞';
                    toggleBtn.className = 'toc-toggle-btn';
                    toggleBtn.title = 'Minimizar/Expandir TOC';
                    let isMinimized = false;
                    toggleBtn.addEventListener('click', function(e) {
                        e.stopPropagation();
                        isMinimized = !isMinimized;
                        if (isMinimized) {
                            toc.classList.add('toc-minimized');
                        } else {
                            toc.classList.remove('toc-minimized');
                        }
                    });
                    tocTitle.appendChild(toggleBtn);
                }
            }
            
            // SCROLLSPY
            const sections = document.querySelectorAll('h1, h2, h3, h4, h5');
            const tocLinks = document.querySelectorAll('#TOC a');
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const id = entry.target.getAttribute('id');
                        tocLinks.forEach(link => {
                            link.classList.remove('active');
                            if (link.getAttribute('href') === '#' + id) {
                                link.classList.add('active');
                            }
                        });
                    }
                });
            }, { 
                rootMargin: '-20% 0px -60% 0px', 
                threshold: 0 
            });
            
            sections.forEach(section => {
                if (section.id) observer.observe(section);
            });
            
            // Scroll suave
            tocLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const targetId = link.getAttribute('href').substring(1);
                    const targetElement = document.getElementById(targetId);
                    if (targetElement) {
                        const offsetTop = targetElement.offsetTop - 80;
                        window.scrollTo({ top: offsetTop, behavior: 'smooth' });
                    }
                });
            });
            
            // BOT√ÉO VOLTAR AO TOPO
            const backToTopBtn = document.createElement('button');
            backToTopBtn.className = 'back-to-top-content';
            backToTopBtn.innerHTML = '‚Üë';
            backToTopBtn.title = 'Voltar ao Topo';
            document.body.appendChild(backToTopBtn);
            
            window.addEventListener('scroll', () => {
                if (window.pageYOffset > 300) {
                    backToTopBtn.classList.add('show');
                } else {
                    backToTopBtn.classList.remove('show');
                }
            });
            
            backToTopBtn.addEventListener('click', () => {
                window.scrollTo({ top: 0, behavior: 'smooth' });
            });
        });
        </script>
        
</body></span></span>
<span id="cb25-2405"><a href="#cb25-2405" aria-hidden="true" tabindex="-1"></a><span class="st"></html></span></span>
<span id="cb25-2406"><a href="#cb25-2406" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb25-2407"><a href="#cb25-2407" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-2408"><a href="#cb25-2408" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> <span class="bu">open</span>(<span class="va">self</span>.index_file, <span class="st">'w'</span>, encoding<span class="op">=</span><span class="st">'utf-8'</span>) <span class="im">as</span> f:</span>
<span id="cb25-2409"><a href="#cb25-2409" aria-hidden="true" tabindex="-1"></a>            f.write(html_content)</span>
<span id="cb25-2410"><a href="#cb25-2410" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.logger.info(<span class="ss">f"‚úÖ √çndice combinado criado: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>index_file<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb25-2411"><a href="#cb25-2411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-2412"><a href="#cb25-2412" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> main():</span>
<span id="cb25-2413"><a href="#cb25-2413" aria-hidden="true" tabindex="-1"></a>    parser <span class="op">=</span> argparse.ArgumentParser(</span>
<span id="cb25-2414"><a href="#cb25-2414" aria-hidden="true" tabindex="-1"></a>        description<span class="op">=</span><span class="st">"Processa exporta√ß√µes combinadas com exporta√ß√£o HTML via Pandoc."</span></span>
<span id="cb25-2415"><a href="#cb25-2415" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb25-2416"><a href="#cb25-2416" aria-hidden="true" tabindex="-1"></a>    parser.add_argument(<span class="st">"--dry-run"</span>, action<span class="op">=</span><span class="st">"store_true"</span>, <span class="bu">help</span><span class="op">=</span><span class="st">"Executa sem salvar arquivos"</span>)</span>
<span id="cb25-2417"><a href="#cb25-2417" aria-hidden="true" tabindex="-1"></a>    parser.add_argument(<span class="st">"--force-overwrite"</span>, action<span class="op">=</span><span class="st">"store_true"</span>, <span class="bu">help</span><span class="op">=</span><span class="st">"Substitui arquivos existentes"</span>)</span>
<span id="cb25-2418"><a href="#cb25-2418" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-2419"><a href="#cb25-2419" aria-hidden="true" tabindex="-1"></a>    args <span class="op">=</span> parser.parse_args()</span>
<span id="cb25-2420"><a href="#cb25-2420" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-2421"><a href="#cb25-2421" aria-hidden="true" tabindex="-1"></a>    system <span class="op">=</span> CombinedFragmentsSystem(</span>
<span id="cb25-2422"><a href="#cb25-2422" aria-hidden="true" tabindex="-1"></a>        dry_run<span class="op">=</span>args.dry_run,</span>
<span id="cb25-2423"><a href="#cb25-2423" aria-hidden="true" tabindex="-1"></a>        force_overwrite<span class="op">=</span>args.force_overwrite</span>
<span id="cb25-2424"><a href="#cb25-2424" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb25-2425"><a href="#cb25-2425" aria-hidden="true" tabindex="-1"></a>    system.run()</span>
<span id="cb25-2426"><a href="#cb25-2426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-2427"><a href="#cb25-2427" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">"__main__"</span>:</span>
<span id="cb25-2428"><a href="#cb25-2428" aria-hidden="true" tabindex="-1"></a>    main()</span></code></pre></div>
<p><strong>Principais melhorias na vers√£o 6:</strong></p>
<ol type="1">
<li><strong><code>--toc-depth=2</code></strong> em todos os comandos
Pandoc</li>
<li><strong>Corre√ß√µes completas de visibilidade</strong> com CSS
<code>!important</code> para garantir que todo texto seja vis√≠vel</li>
<li><strong>Syntax highlighting otimizado</strong> para classes do
Pandoc</li>
<li><strong>Melhor contraste</strong> em todos os elementos</li>
<li><strong>Preserva√ß√£o de cores</strong> adequadas para c√≥digo e texto
normal</li>
<li><strong>Fallbacks robustos</strong> para quando Pandoc n√£o est√°
dispon√≠vel</li>
</ol>
<p>O script agora gera HTMLs com TOC de profundidade 2 e garante que
<strong>todo o texto seja vis√≠vel</strong> com cores de alto contraste
adequadas.</p>
<hr></hr>
<h3 data-number="1.2.7" id="utilizador-2025-11-08-193151-deepseek-reasoner"><span class="header-section-number">1.2.7</span> üë§ Utilizador <em>(2025-11-08
19:31:51)</em> <em>[deepseek-reasoner]</em></h3>
<p>Agora uma nova altera√ß√£o. Pretendo ‚Äìtoc-depth=1. E pretendo uma nova
vers√£o de comb_fragments_system6_html_export.py, mas agora com o nome:
comb_fragments_system7_html_export.py completo funcional optimizado</p>
<hr></hr>
<h3 data-number="1.2.8" id="deepseek-2025-11-08-193151-deepseek-reasoner"><span class="header-section-number">1.2.8</span> ü§ñ DeepSeek <em>(2025-11-08
19:31:51)</em> <em>[deepseek-reasoner]</em></h3>
<p>Vamos criar a vers√£o 7 com <code>--toc-depth=1</code> e manter todas
as otimiza√ß√µes anteriores. Alteraremos apenas a profundidade do TOC para
1 em todos os comandos Pandoc. Tamb√©m atualizaremos o nome da classe
para <code>CombinedFragmentsSystem7</code> (embora n√£o seja estritamente
necess√°rio, mas para consist√™ncia). No entanto, note que a classe tem o
mesmo nome do arquivo, mas o sistema √© independente.</p>
<p>Vamos fazer as altera√ß√µes:</p>
<ol type="1">
<li>No m√©todo <code>_convert_with_pandoc_optimized</code>, alterar
<code>--toc-depth=2</code> para <code>--toc-depth=1</code></li>
<li>No m√©todo <code>_convert_with_pandoc_basic</code>, alterar
<code>--toc-depth=2</code> para <code>--toc-depth=1</code></li>
<li>Atualizar o nome do arquivo para
<code>comb_fragments_system7_html_export.py</code></li>
<li>Manter todas as corre√ß√µes de visibilidade e otimiza√ß√µes.</li>
</ol>
<p>Como o c√≥digo √© longo, vou mostrar apenas as partes alteradas. No
entanto, fornecerei o c√≥digo completo.</p>
<p>Nota: Como o c√≥digo √© muito extenso, vou focar nas altera√ß√µes
necess√°rias.</p>
<p>Altera√ß√µes:</p>
<p>Parte 1: No m√©todo <code>_convert_with_pandoc_optimized</code>:
Comando: ‚Äò‚Äìtoc-depth=1‚Äô</p>
<p>Parte 2: No m√©todo <code>_convert_with_pandoc_basic</code>: Comando:
‚Äò‚Äìtoc-depth=1‚Äô</p>
<p>Vou fornecer o c√≥digo completo com essas altera√ß√µes. Aqui est√° o
<code>comb_fragments_system7_html_export.py</code> completo e otimizado
com <code>--toc-depth=1</code>:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># comb_fragments_system7_html_export.py</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> zipfile</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> csv</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> argparse</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sys</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> webbrowser</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> shutil</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tempfile</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> traceback</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> subprocess</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Any, Optional</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> markdown</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> logging</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> CombinedFragmentsSystem:</span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, dry_run<span class="op">=</span><span class="va">False</span>, force_overwrite<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.data_dir <span class="op">=</span> Path(<span class="st">"data"</span>)</span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.dry_run <span class="op">=</span> dry_run</span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.force_overwrite <span class="op">=</span> force_overwrite</span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Configurar logging</span></span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a>        logging.basicConfig(level<span class="op">=</span>logging.INFO, <span class="bu">format</span><span class="op">=</span><span class="st">'</span><span class="sc">%(asctime)s</span><span class="st"> - </span><span class="sc">%(levelname)s</span><span class="st"> - </span><span class="sc">%(message)s</span><span class="st">'</span>)</span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.logger <span class="op">=</span> logging.getLogger(<span class="va">__name__</span>)</span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Estrutura de pastas organizada</span></span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.output_dirs <span class="op">=</span> {</span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a>            <span class="st">'markdown'</span>: <span class="st">"combined_markdown"</span>,</span>
<span id="cb26-33"><a href="#cb26-33" aria-hidden="true" tabindex="-1"></a>            <span class="st">'csv'</span>: <span class="st">"combined_csv"</span>, </span>
<span id="cb26-34"><a href="#cb26-34" aria-hidden="true" tabindex="-1"></a>            <span class="st">'json'</span>: <span class="st">"combined_json"</span>,</span>
<span id="cb26-35"><a href="#cb26-35" aria-hidden="true" tabindex="-1"></a>            <span class="st">'pdfs'</span>: <span class="st">"combined_pdfs"</span>,</span>
<span id="cb26-36"><a href="#cb26-36" aria-hidden="true" tabindex="-1"></a>            <span class="st">'html'</span>: <span class="st">"combined_html"</span></span>
<span id="cb26-37"><a href="#cb26-37" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb26-38"><a href="#cb26-38" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb26-39"><a href="#cb26-39" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.single_files <span class="op">=</span> {</span>
<span id="cb26-40"><a href="#cb26-40" aria-hidden="true" tabindex="-1"></a>            <span class="st">'csv'</span>: <span class="st">"combined_all_conversations.csv"</span>,</span>
<span id="cb26-41"><a href="#cb26-41" aria-hidden="true" tabindex="-1"></a>            <span class="st">'json'</span>: <span class="st">"combined_all_conversations.json"</span></span>
<span id="cb26-42"><a href="#cb26-42" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb26-43"><a href="#cb26-43" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb26-44"><a href="#cb26-44" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.index_file <span class="op">=</span> <span class="st">"index.html"</span></span>
<span id="cb26-45"><a href="#cb26-45" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.all_conversations <span class="op">=</span> []</span>
<span id="cb26-46"><a href="#cb26-46" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb26-47"><a href="#cb26-47" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Configura√ß√£o de processamento por fonte</span></span>
<span id="cb26-48"><a href="#cb26-48" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.processors <span class="op">=</span> {</span>
<span id="cb26-49"><a href="#cb26-49" aria-hidden="true" tabindex="-1"></a>            <span class="st">'qwen'</span>: {</span>
<span id="cb26-50"><a href="#cb26-50" aria-hidden="true" tabindex="-1"></a>                <span class="st">'file'</span>: <span class="st">"chat-export.json"</span>,</span>
<span id="cb26-51"><a href="#cb26-51" aria-hidden="true" tabindex="-1"></a>                <span class="st">'method'</span>: <span class="va">self</span>.process_qwen_corrected,</span>
<span id="cb26-52"><a href="#cb26-52" aria-hidden="true" tabindex="-1"></a>                <span class="st">'enabled'</span>: <span class="va">True</span></span>
<span id="cb26-53"><a href="#cb26-53" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb26-54"><a href="#cb26-54" aria-hidden="true" tabindex="-1"></a>            <span class="st">'chatgpt'</span>: {</span>
<span id="cb26-55"><a href="#cb26-55" aria-hidden="true" tabindex="-1"></a>                <span class="st">'file'</span>: <span class="st">"chatgpt.zip"</span>, </span>
<span id="cb26-56"><a href="#cb26-56" aria-hidden="true" tabindex="-1"></a>                <span class="st">'method'</span>: <span class="va">self</span>.process_chatgpt,</span>
<span id="cb26-57"><a href="#cb26-57" aria-hidden="true" tabindex="-1"></a>                <span class="st">'enabled'</span>: <span class="va">True</span></span>
<span id="cb26-58"><a href="#cb26-58" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb26-59"><a href="#cb26-59" aria-hidden="true" tabindex="-1"></a>            <span class="st">'deepseek'</span>: {</span>
<span id="cb26-60"><a href="#cb26-60" aria-hidden="true" tabindex="-1"></a>                <span class="st">'file'</span>: <span class="st">"deepseek_data.zip"</span>,</span>
<span id="cb26-61"><a href="#cb26-61" aria-hidden="true" tabindex="-1"></a>                <span class="st">'method'</span>: <span class="va">self</span>.process_deepseek,</span>
<span id="cb26-62"><a href="#cb26-62" aria-hidden="true" tabindex="-1"></a>                <span class="st">'enabled'</span>: <span class="va">True</span></span>
<span id="cb26-63"><a href="#cb26-63" aria-hidden="true" tabindex="-1"></a>            },</span>
<span id="cb26-64"><a href="#cb26-64" aria-hidden="true" tabindex="-1"></a>            <span class="st">'grok'</span>: {</span>
<span id="cb26-65"><a href="#cb26-65" aria-hidden="true" tabindex="-1"></a>                <span class="st">'file'</span>: <span class="st">"grok.zip"</span>,</span>
<span id="cb26-66"><a href="#cb26-66" aria-hidden="true" tabindex="-1"></a>                <span class="st">'method'</span>: <span class="va">self</span>.process_grok,</span>
<span id="cb26-67"><a href="#cb26-67" aria-hidden="true" tabindex="-1"></a>                <span class="st">'enabled'</span>: <span class="va">True</span></span>
<span id="cb26-68"><a href="#cb26-68" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb26-69"><a href="#cb26-69" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb26-70"><a href="#cb26-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-71"><a href="#cb26-71" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> sanitize_filename(<span class="va">self</span>, text: <span class="bu">str</span>, max_len: <span class="bu">int</span> <span class="op">=</span> <span class="dv">50</span>) <span class="op">-></span> <span class="bu">str</span>:</span>
<span id="cb26-72"><a href="#cb26-72" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Sanitiza nomes de arquivo REMOVENDO ESPA√áOS e preservando emojis"""</span></span>
<span id="cb26-73"><a href="#cb26-73" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> text <span class="kw">or</span> <span class="kw">not</span> <span class="bu">isinstance</span>(text, <span class="bu">str</span>):</span>
<span id="cb26-74"><a href="#cb26-74" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">"conversa_sem_titulo"</span></span>
<span id="cb26-75"><a href="#cb26-75" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb26-76"><a href="#cb26-76" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Remove caracteres inv√°lidos</span></span>
<span id="cb26-77"><a href="#cb26-77" aria-hidden="true" tabindex="-1"></a>        invalid_chars <span class="op">=</span> <span class="vs">r'</span><span class="pp">[<>:"/</span><span class="ch">\\</span><span class="pp">|?*</span><span class="ch">\x00</span><span class="pp">-</span><span class="ch">\x1F\x7F</span><span class="dv">\s</span><span class="pp">]</span><span class="vs">'</span>  <span class="co"># Inclui \s para remover espa√ßos</span></span>
<span id="cb26-78"><a href="#cb26-78" aria-hidden="true" tabindex="-1"></a>        sanitized <span class="op">=</span> re.sub(invalid_chars, <span class="st">'_'</span>, text)  <span class="co"># Substitui espa√ßos por underscores</span></span>
<span id="cb26-79"><a href="#cb26-79" aria-hidden="true" tabindex="-1"></a>        sanitized <span class="op">=</span> re.sub(<span class="vs">r'_</span><span class="op">+</span><span class="vs">'</span>, <span class="st">'_'</span>, sanitized)  <span class="co"># Remove underscores duplicados</span></span>
<span id="cb26-80"><a href="#cb26-80" aria-hidden="true" tabindex="-1"></a>        sanitized <span class="op">=</span> sanitized.strip(<span class="st">'_'</span>)  <span class="co"># Remove underscores no in√≠cio e fim</span></span>
<span id="cb26-81"><a href="#cb26-81" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb26-82"><a href="#cb26-82" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> sanitized:</span>
<span id="cb26-83"><a href="#cb26-83" aria-hidden="true" tabindex="-1"></a>            sanitized <span class="op">=</span> <span class="st">"conversa_sem_titulo"</span></span>
<span id="cb26-84"><a href="#cb26-84" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb26-85"><a href="#cb26-85" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Limita o comprimento</span></span>
<span id="cb26-86"><a href="#cb26-86" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(sanitized) <span class="op">></span> max_len:</span>
<span id="cb26-87"><a href="#cb26-87" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Tenta cortar em um ponto l√≥gico (underscore)</span></span>
<span id="cb26-88"><a href="#cb26-88" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="st">'_'</span> <span class="kw">in</span> sanitized[:max_len]:</span>
<span id="cb26-89"><a href="#cb26-89" aria-hidden="true" tabindex="-1"></a>                last_underscore <span class="op">=</span> sanitized[:max_len].rfind(<span class="st">'_'</span>)</span>
<span id="cb26-90"><a href="#cb26-90" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> last_underscore <span class="op">></span> <span class="dv">10</span>:</span>
<span id="cb26-91"><a href="#cb26-91" aria-hidden="true" tabindex="-1"></a>                    sanitized <span class="op">=</span> sanitized[:last_underscore]</span>
<span id="cb26-92"><a href="#cb26-92" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb26-93"><a href="#cb26-93" aria-hidden="true" tabindex="-1"></a>                sanitized <span class="op">=</span> sanitized[:max_len]</span>
<span id="cb26-94"><a href="#cb26-94" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb26-95"><a href="#cb26-95" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> sanitized</span>
<span id="cb26-96"><a href="#cb26-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-97"><a href="#cb26-97" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> preserve_original_title(<span class="va">self</span>, text: <span class="bu">str</span>) <span class="op">-></span> <span class="bu">str</span>:</span>
<span id="cb26-98"><a href="#cb26-98" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Preserva o t√≠tulo original com espa√ßos, apenas removendo caracteres realmente inv√°lidos"""</span></span>
<span id="cb26-99"><a href="#cb26-99" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> text <span class="kw">or</span> <span class="kw">not</span> <span class="bu">isinstance</span>(text, <span class="bu">str</span>):</span>
<span id="cb26-100"><a href="#cb26-100" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">"Conversa sem t√≠tulo"</span></span>
<span id="cb26-101"><a href="#cb26-101" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb26-102"><a href="#cb26-102" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Remove apenas caracteres realmente problem√°ticos, mantendo espa√ßos</span></span>
<span id="cb26-103"><a href="#cb26-103" aria-hidden="true" tabindex="-1"></a>        invalid_chars <span class="op">=</span> <span class="vs">r'</span><span class="pp">[<>:"/</span><span class="ch">\\</span><span class="pp">|?*</span><span class="ch">\x00</span><span class="pp">-</span><span class="ch">\x1F\x7F</span><span class="pp">]</span><span class="vs">'</span></span>
<span id="cb26-104"><a href="#cb26-104" aria-hidden="true" tabindex="-1"></a>        sanitized <span class="op">=</span> re.sub(invalid_chars, <span class="st">''</span>, text)</span>
<span id="cb26-105"><a href="#cb26-105" aria-hidden="true" tabindex="-1"></a>        sanitized <span class="op">=</span> re.sub(<span class="vs">r'</span><span class="dv">\s</span><span class="op">+</span><span class="vs">'</span>, <span class="st">' '</span>, sanitized.strip())</span>
<span id="cb26-106"><a href="#cb26-106" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb26-107"><a href="#cb26-107" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> sanitized:</span>
<span id="cb26-108"><a href="#cb26-108" aria-hidden="true" tabindex="-1"></a>            sanitized <span class="op">=</span> <span class="st">"Conversa sem t√≠tulo"</span></span>
<span id="cb26-109"><a href="#cb26-109" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb26-110"><a href="#cb26-110" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> sanitized</span>
<span id="cb26-111"><a href="#cb26-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-112"><a href="#cb26-112" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> preserve_special_content(<span class="va">self</span>, content: <span class="bu">str</span>) <span class="op">-></span> <span class="bu">str</span>:</span>
<span id="cb26-113"><a href="#cb26-113" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Preserva f√≥rmulas matem√°ticas, c√≥digo e formata√ß√£o especial"""</span></span>
<span id="cb26-114"><a href="#cb26-114" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> content:</span>
<span id="cb26-115"><a href="#cb26-115" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">""</span></span>
<span id="cb26-116"><a href="#cb26-116" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb26-117"><a href="#cb26-117" aria-hidden="true" tabindex="-1"></a>        preserved_content <span class="op">=</span> content</span>
<span id="cb26-118"><a href="#cb26-118" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb26-119"><a href="#cb26-119" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Corrige problemas com barras invertidas em LaTeX</span></span>
<span id="cb26-120"><a href="#cb26-120" aria-hidden="true" tabindex="-1"></a>        latex_corrections <span class="op">=</span> {</span>
<span id="cb26-121"><a href="#cb26-121" aria-hidden="true" tabindex="-1"></a>            <span class="st">'√¢¬ô¬Ärac'</span>: <span class="st">'</span><span class="ch">\\</span><span class="st">frac'</span>,</span>
<span id="cb26-122"><a href="#cb26-122" aria-hidden="true" tabindex="-1"></a>            <span class="st">'√¢¬ô¬Çarepsilon'</span>: <span class="st">'</span><span class="ch">\\</span><span class="st">varepsilon'</span>,</span>
<span id="cb26-123"><a href="#cb26-123" aria-hidden="true" tabindex="-1"></a>            <span class="st">'√¢¬ô¬Ç'</span>: <span class="st">'</span><span class="ch">\\</span><span class="st">'</span>,</span>
<span id="cb26-124"><a href="#cb26-124" aria-hidden="true" tabindex="-1"></a>            <span class="st">'√¢¬ô¬Ä'</span>: <span class="st">'</span><span class="ch">\\</span><span class="st">'</span></span>
<span id="cb26-125"><a href="#cb26-125" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb26-126"><a href="#cb26-126" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb26-127"><a href="#cb26-127" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> wrong, correct <span class="kw">in</span> latex_corrections.items():</span>
<span id="cb26-128"><a href="#cb26-128" aria-hidden="true" tabindex="-1"></a>            preserved_content <span class="op">=</span> preserved_content.replace(wrong, correct)</span>
<span id="cb26-129"><a href="#cb26-129" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb26-130"><a href="#cb26-130" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> preserved_content</span>
<span id="cb26-131"><a href="#cb26-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-132"><a href="#cb26-132" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> ensure_directories(<span class="va">self</span>):</span>
<span id="cb26-133"><a href="#cb26-133" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Cria todas as pastas necess√°rias"""</span></span>
<span id="cb26-134"><a href="#cb26-134" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb26-135"><a href="#cb26-135" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="st">"DRY-RUN: Pastas seriam criadas:"</span>)</span>
<span id="cb26-136"><a href="#cb26-136" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> folder <span class="kw">in</span> <span class="va">self</span>.output_dirs.values():</span>
<span id="cb26-137"><a href="#cb26-137" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.info(<span class="ss">f"   </span><span class="sc">{</span>folder<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb26-138"><a href="#cb26-138" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb26-139"><a href="#cb26-139" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb26-140"><a href="#cb26-140" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> folder <span class="kw">in</span> <span class="va">self</span>.output_dirs.values():</span>
<span id="cb26-141"><a href="#cb26-141" aria-hidden="true" tabindex="-1"></a>            Path(folder).mkdir(parents<span class="op">=</span><span class="va">True</span>, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb26-142"><a href="#cb26-142" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="ss">f"Pasta criada: </span><span class="sc">{</span>folder<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb26-143"><a href="#cb26-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-144"><a href="#cb26-144" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> run(<span class="va">self</span>):</span>
<span id="cb26-145"><a href="#cb26-145" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Executa o processamento completo"""</span></span>
<span id="cb26-146"><a href="#cb26-146" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.logger.info(<span class="st">"SISTEMA COMBINADO DE EXPORTA√á√ïES COM HTML (Qwen3, ChatGPT, DeepSeek, Grok)"</span>)</span>
<span id="cb26-147"><a href="#cb26-147" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.logger.info(<span class="st">"="</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb26-148"><a href="#cb26-148" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb26-149"><a href="#cb26-149" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.data_dir.exists():</span>
<span id="cb26-150"><a href="#cb26-150" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.error(<span class="ss">f"Pasta '</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>data_dir<span class="sc">}</span><span class="ss">' n√£o encontrada."</span>)</span>
<span id="cb26-151"><a href="#cb26-151" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="st">"Crie a pasta 'data' e coloque os arquivos de exporta√ß√£o:"</span>)</span>
<span id="cb26-152"><a href="#cb26-152" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> source_name, config <span class="kw">in</span> <span class="va">self</span>.processors.items():</span>
<span id="cb26-153"><a href="#cb26-153" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.info(<span class="ss">f"   - </span><span class="sc">{</span>config[<span class="st">'file'</span>]<span class="sc">}</span><span class="ss"> (para </span><span class="sc">{</span>source_name<span class="sc">.</span>upper()<span class="sc">}</span><span class="ss">)"</span>)</span>
<span id="cb26-154"><a href="#cb26-154" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb26-155"><a href="#cb26-155" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb26-156"><a href="#cb26-156" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.logger.info(<span class="ss">f"Usando pasta de dados: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>data_dir<span class="sc">.</span>absolute()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb26-157"><a href="#cb26-157" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb26-158"><a href="#cb26-158" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.ensure_directories()</span>
<span id="cb26-159"><a href="#cb26-159" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb26-160"><a href="#cb26-160" aria-hidden="true" tabindex="-1"></a>        processed_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb26-161"><a href="#cb26-161" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> source_name, config <span class="kw">in</span> <span class="va">self</span>.processors.items():</span>
<span id="cb26-162"><a href="#cb26-162" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> config[<span class="st">'enabled'</span>]:</span>
<span id="cb26-163"><a href="#cb26-163" aria-hidden="true" tabindex="-1"></a>                file_path <span class="op">=</span> <span class="va">self</span>.data_dir <span class="op">/</span> config[<span class="st">'file'</span>]</span>
<span id="cb26-164"><a href="#cb26-164" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> file_path.exists():</span>
<span id="cb26-165"><a href="#cb26-165" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.logger.info(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Processando </span><span class="sc">{</span>source_name<span class="sc">.</span>upper()<span class="sc">}</span><span class="ss">..."</span>)</span>
<span id="cb26-166"><a href="#cb26-166" aria-hidden="true" tabindex="-1"></a>                    config[<span class="st">'method'</span>](file_path)</span>
<span id="cb26-167"><a href="#cb26-167" aria-hidden="true" tabindex="-1"></a>                    processed_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb26-168"><a href="#cb26-168" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb26-169"><a href="#cb26-169" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.logger.warning(<span class="ss">f"</span><span class="sc">{</span>source_name<span class="sc">.</span>upper()<span class="sc">}</span><span class="ss">: arquivo n√£o encontrado - </span><span class="sc">{</span>file_path<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb26-170"><a href="#cb26-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-171"><a href="#cb26-171" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> processed_count <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb26-172"><a href="#cb26-172" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.error(<span class="st">"Nenhum arquivo de exporta√ß√£o encontrado na pasta 'data'."</span>)</span>
<span id="cb26-173"><a href="#cb26-173" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb26-174"><a href="#cb26-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-175"><a href="#cb26-175" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb26-176"><a href="#cb26-176" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.error(<span class="st">"Nenhuma conversa foi extra√≠da dos arquivos."</span>)</span>
<span id="cb26-177"><a href="#cb26-177" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb26-178"><a href="#cb26-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-179"><a href="#cb26-179" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>._post_process_conversations()</span>
<span id="cb26-180"><a href="#cb26-180" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb26-181"><a href="#cb26-181" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.dry_run:</span>
<span id="cb26-182"><a href="#cb26-182" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>._export_all_formats()</span>
<span id="cb26-183"><a href="#cb26-183" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">üéâ SISTEMA COMBINADO FINALIZADO!"</span>)</span>
<span id="cb26-184"><a href="#cb26-184" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="ss">f"üìÑ √çndice: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>index_file<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb26-185"><a href="#cb26-185" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> Path(<span class="va">self</span>.index_file).exists():</span>
<span id="cb26-186"><a href="#cb26-186" aria-hidden="true" tabindex="-1"></a>                webbrowser.<span class="bu">open</span>(<span class="ss">f'file://</span><span class="sc">{</span>Path(<span class="va">self</span>.index_file)<span class="sc">.</span>absolute()<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb26-187"><a href="#cb26-187" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb26-188"><a href="#cb26-188" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">üîÆ MODO DRY-RUN: Nenhum arquivo foi criado."</span>)</span>
<span id="cb26-189"><a href="#cb26-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-190"><a href="#cb26-190" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _post_process_conversations(<span class="va">self</span>):</span>
<span id="cb26-191"><a href="#cb26-191" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Processamento p√≥s-extra√ß√£o das conversas"""</span></span>
<span id="cb26-192"><a href="#cb26-192" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.all_conversations.sort(</span>
<span id="cb26-193"><a href="#cb26-193" aria-hidden="true" tabindex="-1"></a>            key<span class="op">=</span><span class="kw">lambda</span> x: <span class="va">self</span>.parse_timestamp_for_sorting(</span>
<span id="cb26-194"><a href="#cb26-194" aria-hidden="true" tabindex="-1"></a>                x.get(<span class="st">'updated_at'</span>) <span class="kw">or</span> x.get(<span class="st">'inserted_at'</span>) <span class="kw">or</span> x.get(<span class="st">'created_at'</span>)</span>
<span id="cb26-195"><a href="#cb26-195" aria-hidden="true" tabindex="-1"></a>            ),</span>
<span id="cb26-196"><a href="#cb26-196" aria-hidden="true" tabindex="-1"></a>            reverse<span class="op">=</span><span class="va">True</span></span>
<span id="cb26-197"><a href="#cb26-197" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb26-198"><a href="#cb26-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-199"><a href="#cb26-199" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, conv <span class="kw">in</span> <span class="bu">enumerate</span>(<span class="va">self</span>.all_conversations):</span>
<span id="cb26-200"><a href="#cb26-200" aria-hidden="true" tabindex="-1"></a>            conv[<span class="st">'number'</span>] <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb26-201"><a href="#cb26-201" aria-hidden="true" tabindex="-1"></a>            conv[<span class="st">'category'</span>] <span class="op">=</span> <span class="va">self</span>.categorize_conversation(conv[<span class="st">'title'</span>], conv.get(<span class="st">'summary'</span>, <span class="st">''</span>))</span>
<span id="cb26-202"><a href="#cb26-202" aria-hidden="true" tabindex="-1"></a>            conv.setdefault(<span class="st">'source'</span>, <span class="st">'Desconhecido'</span>)</span>
<span id="cb26-203"><a href="#cb26-203" aria-hidden="true" tabindex="-1"></a>            conv.setdefault(<span class="st">'messages'</span>, [])</span>
<span id="cb26-204"><a href="#cb26-204" aria-hidden="true" tabindex="-1"></a>            conv.setdefault(<span class="st">'summary'</span>, conv[<span class="st">'messages'</span>][<span class="dv">0</span>][<span class="st">'content'</span>][:<span class="dv">100</span>] <span class="op">+</span> <span class="st">"..."</span> <span class="cf">if</span> conv[<span class="st">'messages'</span>] <span class="cf">else</span> <span class="st">"Sem conte√∫do"</span>)</span>
<span id="cb26-205"><a href="#cb26-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-206"><a href="#cb26-206" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.logger.info(<span class="ss">f"üìä Total combinado de conversas: </span><span class="sc">{</span><span class="bu">len</span>(<span class="va">self</span>.all_conversations)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb26-207"><a href="#cb26-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-208"><a href="#cb26-208" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _export_all_formats(<span class="va">self</span>):</span>
<span id="cb26-209"><a href="#cb26-209" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Exporta para todos os formatos"""</span></span>
<span id="cb26-210"><a href="#cb26-210" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.logger.info(<span class="st">"</span><span class="ch">\n</span><span class="st">üîÑ Exportando para formatos..."</span>)</span>
<span id="cb26-211"><a href="#cb26-211" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.save_as_markdown_enhanced()</span>
<span id="cb26-212"><a href="#cb26-212" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.save_as_html_robust()</span>
<span id="cb26-213"><a href="#cb26-213" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.save_as_csv() </span>
<span id="cb26-214"><a href="#cb26-214" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.save_as_json()</span>
<span id="cb26-215"><a href="#cb26-215" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.save_all_to_single_files()</span>
<span id="cb26-216"><a href="#cb26-216" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.create_searchable_index()</span>
<span id="cb26-217"><a href="#cb26-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-218"><a href="#cb26-218" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _get_pandoc_version(<span class="va">self</span>) <span class="op">-></span> Optional[<span class="bu">tuple</span>]:</span>
<span id="cb26-219"><a href="#cb26-219" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Obt√©m a vers√£o do Pandoc para compatibilidade"""</span></span>
<span id="cb26-220"><a href="#cb26-220" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb26-221"><a href="#cb26-221" aria-hidden="true" tabindex="-1"></a>            result <span class="op">=</span> subprocess.run([<span class="st">'pandoc'</span>, <span class="st">'--version'</span>], capture_output<span class="op">=</span><span class="va">True</span>, text<span class="op">=</span><span class="va">True</span>, encoding<span class="op">=</span><span class="st">'utf-8'</span>)</span>
<span id="cb26-222"><a href="#cb26-222" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> result.returncode <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb26-223"><a href="#cb26-223" aria-hidden="true" tabindex="-1"></a>                first_line <span class="op">=</span> result.stdout.split(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)[<span class="dv">0</span>]</span>
<span id="cb26-224"><a href="#cb26-224" aria-hidden="true" tabindex="-1"></a>                version_str <span class="op">=</span> first_line.split()[<span class="dv">1</span>]</span>
<span id="cb26-225"><a href="#cb26-225" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="bu">tuple</span>(<span class="bu">map</span>(<span class="bu">int</span>, version_str.split(<span class="st">'.'</span>)))</span>
<span id="cb26-226"><a href="#cb26-226" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span>:</span>
<span id="cb26-227"><a href="#cb26-227" aria-hidden="true" tabindex="-1"></a>            <span class="cf">pass</span></span>
<span id="cb26-228"><a href="#cb26-228" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb26-229"><a href="#cb26-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-230"><a href="#cb26-230" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _convert_with_pandoc_optimized(<span class="va">self</span>, md_file_path: <span class="bu">str</span>) <span class="op">-></span> Optional[<span class="bu">str</span>]:</span>
<span id="cb26-231"><a href="#cb26-231" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Convers√£o OTIMIZADA com Pandoc usando todas as op√ß√µes avan√ßadas"""</span></span>
<span id="cb26-232"><a href="#cb26-232" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb26-233"><a href="#cb26-233" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="ss">f"üîß Convertendo com Pandoc otimizado: </span><span class="sc">{</span>Path(md_file_path)<span class="sc">.</span>name<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb26-234"><a href="#cb26-234" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb26-235"><a href="#cb26-235" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Verifica se o arquivo MathJax local existe</span></span>
<span id="cb26-236"><a href="#cb26-236" aria-hidden="true" tabindex="-1"></a>            mathjax_path <span class="op">=</span> Path(<span class="st">"assets/tex-mml-chtml.js"</span>)</span>
<span id="cb26-237"><a href="#cb26-237" aria-hidden="true" tabindex="-1"></a>            mathjax_arg <span class="op">=</span> <span class="ss">f"assets/tex-mml-chtml.js"</span> <span class="cf">if</span> mathjax_path.exists() <span class="cf">else</span> <span class="st">""</span></span>
<span id="cb26-238"><a href="#cb26-238" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb26-239"><a href="#cb26-239" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Comandos base</span></span>
<span id="cb26-240"><a href="#cb26-240" aria-hidden="true" tabindex="-1"></a>            command <span class="op">=</span> [</span>
<span id="cb26-241"><a href="#cb26-241" aria-hidden="true" tabindex="-1"></a>                <span class="st">'pandoc'</span>, </span>
<span id="cb26-242"><a href="#cb26-242" aria-hidden="true" tabindex="-1"></a>                <span class="bu">str</span>(md_file_path),</span>
<span id="cb26-243"><a href="#cb26-243" aria-hidden="true" tabindex="-1"></a>                <span class="st">'--from'</span>, <span class="st">'markdown+emoji+autolink_bare_uris+tex_math_single_backslash'</span>,</span>
<span id="cb26-244"><a href="#cb26-244" aria-hidden="true" tabindex="-1"></a>                <span class="st">'--to'</span>, <span class="st">'html5'</span>,</span>
<span id="cb26-245"><a href="#cb26-245" aria-hidden="true" tabindex="-1"></a>                <span class="st">'--standalone'</span>,</span>
<span id="cb26-246"><a href="#cb26-246" aria-hidden="true" tabindex="-1"></a>                <span class="st">'--mathjax'</span> <span class="cf">if</span> <span class="kw">not</span> mathjax_path.exists() <span class="cf">else</span> <span class="ss">f'--mathjax=</span><span class="sc">{</span>mathjax_arg<span class="sc">}</span><span class="ss">'</span>,</span>
<span id="cb26-247"><a href="#cb26-247" aria-hidden="true" tabindex="-1"></a>                <span class="st">'--table-of-contents'</span>,</span>
<span id="cb26-248"><a href="#cb26-248" aria-hidden="true" tabindex="-1"></a>                <span class="st">'--toc-depth=1'</span>,  <span class="co"># ALTERADO: de 2 para 1</span></span>
<span id="cb26-249"><a href="#cb26-249" aria-hidden="true" tabindex="-1"></a>                <span class="st">'--number-sections'</span></span>
<span id="cb26-250"><a href="#cb26-250" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb26-251"><a href="#cb26-251" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb26-252"><a href="#cb26-252" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Verifica vers√£o do Pandoc para recursos avan√ßados</span></span>
<span id="cb26-253"><a href="#cb26-253" aria-hidden="true" tabindex="-1"></a>            pandoc_version <span class="op">=</span> <span class="va">self</span>._get_pandoc_version()</span>
<span id="cb26-254"><a href="#cb26-254" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb26-255"><a href="#cb26-255" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Adiciona --embed-resources apenas se suportado (Pandoc 2.19+)</span></span>
<span id="cb26-256"><a href="#cb26-256" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> pandoc_version <span class="kw">and</span> pandoc_version <span class="op">>=</span> (<span class="dv">2</span>, <span class="dv">19</span>):</span>
<span id="cb26-257"><a href="#cb26-257" aria-hidden="true" tabindex="-1"></a>                command.append(<span class="st">'--embed-resources'</span>)</span>
<span id="cb26-258"><a href="#cb26-258" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.info(<span class="st">"‚úÖ Usando --embed-resources (Pandoc 2.19+)"</span>)</span>
<span id="cb26-259"><a href="#cb26-259" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb26-260"><a href="#cb26-260" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.info(<span class="st">"‚ÑπÔ∏è  --embed-resources n√£o suportado, usando recursos externos"</span>)</span>
<span id="cb26-261"><a href="#cb26-261" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb26-262"><a href="#cb26-262" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Adiciona syntax highlighting</span></span>
<span id="cb26-263"><a href="#cb26-263" aria-hidden="true" tabindex="-1"></a>            command.extend([<span class="st">'--syntax-highlighting=pygments'</span>])</span>
<span id="cb26-264"><a href="#cb26-264" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb26-265"><a href="#cb26-265" aria-hidden="true" tabindex="-1"></a>            result <span class="op">=</span> subprocess.run(</span>
<span id="cb26-266"><a href="#cb26-266" aria-hidden="true" tabindex="-1"></a>                command, </span>
<span id="cb26-267"><a href="#cb26-267" aria-hidden="true" tabindex="-1"></a>                capture_output<span class="op">=</span><span class="va">True</span>, </span>
<span id="cb26-268"><a href="#cb26-268" aria-hidden="true" tabindex="-1"></a>                text<span class="op">=</span><span class="va">True</span>, </span>
<span id="cb26-269"><a href="#cb26-269" aria-hidden="true" tabindex="-1"></a>                encoding<span class="op">=</span><span class="st">'utf-8'</span>, </span>
<span id="cb26-270"><a href="#cb26-270" aria-hidden="true" tabindex="-1"></a>                timeout<span class="op">=</span><span class="dv">180</span></span>
<span id="cb26-271"><a href="#cb26-271" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb26-272"><a href="#cb26-272" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb26-273"><a href="#cb26-273" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> result.returncode <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb26-274"><a href="#cb26-274" aria-hidden="true" tabindex="-1"></a>                html_content <span class="op">=</span> result.stdout</span>
<span id="cb26-275"><a href="#cb26-275" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb26-276"><a href="#cb26-276" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Aplica otimiza√ß√µes adicionais</span></span>
<span id="cb26-277"><a href="#cb26-277" aria-hidden="true" tabindex="-1"></a>                html_content <span class="op">=</span> <span class="va">self</span>._optimize_html_content(html_content)</span>
<span id="cb26-278"><a href="#cb26-278" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> html_content</span>
<span id="cb26-279"><a href="#cb26-279" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb26-280"><a href="#cb26-280" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.warning(<span class="ss">f"‚ö†Ô∏è Pandoc otimizado falhou, tentando m√©todo b√°sico: </span><span class="sc">{</span>result<span class="sc">.</span>stderr[:<span class="dv">200</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb26-281"><a href="#cb26-281" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="va">self</span>._convert_with_pandoc_basic(md_file_path)</span>
<span id="cb26-282"><a href="#cb26-282" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb26-283"><a href="#cb26-283" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> subprocess.TimeoutExpired:</span>
<span id="cb26-284"><a href="#cb26-284" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.error(<span class="st">"‚ùå Timeout no Pandoc otimizado"</span>)</span>
<span id="cb26-285"><a href="#cb26-285" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">self</span>._convert_with_pandoc_basic(md_file_path)</span>
<span id="cb26-286"><a href="#cb26-286" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb26-287"><a href="#cb26-287" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.error(<span class="ss">f"‚ùå Erro no Pandoc otimizado: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb26-288"><a href="#cb26-288" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">self</span>._convert_with_pandoc_basic(md_file_path)</span>
<span id="cb26-289"><a href="#cb26-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-290"><a href="#cb26-290" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _convert_with_pandoc_basic(<span class="va">self</span>, md_file_path: <span class="bu">str</span>) <span class="op">-></span> Optional[<span class="bu">str</span>]:</span>
<span id="cb26-291"><a href="#cb26-291" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""M√©todo b√°sico de fallback para Pandoc com TOC e numera√ß√£o"""</span></span>
<span id="cb26-292"><a href="#cb26-292" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb26-293"><a href="#cb26-293" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="ss">f"üîß Tentando convers√£o b√°sica: </span><span class="sc">{</span>Path(md_file_path)<span class="sc">.</span>name<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb26-294"><a href="#cb26-294" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb26-295"><a href="#cb26-295" aria-hidden="true" tabindex="-1"></a>            mathjax_path <span class="op">=</span> Path(<span class="st">"assets/tex-mml-chtml.js"</span>)</span>
<span id="cb26-296"><a href="#cb26-296" aria-hidden="true" tabindex="-1"></a>            mathjax_arg <span class="op">=</span> <span class="ss">f"assets/tex-mml-chtml.js"</span> <span class="cf">if</span> mathjax_path.exists() <span class="cf">else</span> <span class="st">""</span></span>
<span id="cb26-297"><a href="#cb26-297" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb26-298"><a href="#cb26-298" aria-hidden="true" tabindex="-1"></a>            command <span class="op">=</span> [</span>
<span id="cb26-299"><a href="#cb26-299" aria-hidden="true" tabindex="-1"></a>                <span class="st">'pandoc'</span>, </span>
<span id="cb26-300"><a href="#cb26-300" aria-hidden="true" tabindex="-1"></a>                <span class="bu">str</span>(md_file_path),</span>
<span id="cb26-301"><a href="#cb26-301" aria-hidden="true" tabindex="-1"></a>                <span class="st">'--from'</span>, <span class="st">'markdown'</span>,</span>
<span id="cb26-302"><a href="#cb26-302" aria-hidden="true" tabindex="-1"></a>                <span class="st">'--to'</span>, <span class="st">'html5'</span>,</span>
<span id="cb26-303"><a href="#cb26-303" aria-hidden="true" tabindex="-1"></a>                <span class="st">'--standalone'</span>,</span>
<span id="cb26-304"><a href="#cb26-304" aria-hidden="true" tabindex="-1"></a>                <span class="st">'--table-of-contents'</span>,</span>
<span id="cb26-305"><a href="#cb26-305" aria-hidden="true" tabindex="-1"></a>                <span class="st">'--toc-depth=1'</span>,  <span class="co"># ALTERADO: de 2 para 1</span></span>
<span id="cb26-306"><a href="#cb26-306" aria-hidden="true" tabindex="-1"></a>                <span class="st">'--number-sections'</span>,</span>
<span id="cb26-307"><a href="#cb26-307" aria-hidden="true" tabindex="-1"></a>                <span class="st">'--mathjax'</span> <span class="cf">if</span> <span class="kw">not</span> mathjax_path.exists() <span class="cf">else</span> <span class="ss">f'--mathjax=</span><span class="sc">{</span>mathjax_arg<span class="sc">}</span><span class="ss">'</span></span>
<span id="cb26-308"><a href="#cb26-308" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb26-309"><a href="#cb26-309" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb26-310"><a href="#cb26-310" aria-hidden="true" tabindex="-1"></a>            result <span class="op">=</span> subprocess.run(</span>
<span id="cb26-311"><a href="#cb26-311" aria-hidden="true" tabindex="-1"></a>                command, </span>
<span id="cb26-312"><a href="#cb26-312" aria-hidden="true" tabindex="-1"></a>                capture_output<span class="op">=</span><span class="va">True</span>, </span>
<span id="cb26-313"><a href="#cb26-313" aria-hidden="true" tabindex="-1"></a>                text<span class="op">=</span><span class="va">True</span>, </span>
<span id="cb26-314"><a href="#cb26-314" aria-hidden="true" tabindex="-1"></a>                encoding<span class="op">=</span><span class="st">'utf-8'</span>, </span>
<span id="cb26-315"><a href="#cb26-315" aria-hidden="true" tabindex="-1"></a>                timeout<span class="op">=</span><span class="dv">120</span></span>
<span id="cb26-316"><a href="#cb26-316" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb26-317"><a href="#cb26-317" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb26-318"><a href="#cb26-318" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> result.returncode <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb26-319"><a href="#cb26-319" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="va">self</span>._optimize_html_content(result.stdout)</span>
<span id="cb26-320"><a href="#cb26-320" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb26-321"><a href="#cb26-321" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.warning(<span class="ss">f"‚ö†Ô∏è Pandoc b√°sico falhou, usando fallback Python: </span><span class="sc">{</span>result<span class="sc">.</span>stderr[:<span class="dv">200</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb26-322"><a href="#cb26-322" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="va">self</span>._convert_with_fallback(md_file_path)</span>
<span id="cb26-323"><a href="#cb26-323" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb26-324"><a href="#cb26-324" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb26-325"><a href="#cb26-325" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.error(<span class="ss">f"‚ùå Erro no Pandoc b√°sico: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb26-326"><a href="#cb26-326" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">self</span>._convert_with_fallback(md_file_path)</span>
<span id="cb26-327"><a href="#cb26-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-328"><a href="#cb26-328" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _optimize_html_content(<span class="va">self</span>, html_content: <span class="bu">str</span>) <span class="op">-></span> <span class="bu">str</span>:</span>
<span id="cb26-329"><a href="#cb26-329" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Aplica otimiza√ß√µes finais ao conte√∫do HTML"""</span></span>
<span id="cb26-330"><a href="#cb26-330" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Adiciona viewport para responsividade</span></span>
<span id="cb26-331"><a href="#cb26-331" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">'<head>

        <style id="fixed-toc-styles">
        /* === ESTILOS PRINCIPAIS - TOC FIXO √Ä DIREITA === */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
            scroll-behavior: smooth;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            position: relative;
        }
        /* === TOC FIXO √Ä DIREITA - POSI√á√ÉO CORRIGIDA === */
        #TOC {
            position: fixed !important;
            top: 50% !important;
            right: 20px !important;
            transform: translateY(-50%) !important;
            width: 320px !important;
            max-height: 80vh !important;
            overflow-y: auto !important;
            z-index: 1000 !important;
            background: rgba(255, 255, 255, 0.98) !important;
            padding: 20px !important;
            border-radius: 12px !important;
            box-shadow: 0 8px 32px rgba(0,0,0,0.15) !important;
            border: 1px solid #e0e0e0 !important;
            backdrop-filter: blur(10px) !important;
            transition: all 0.3s ease-in-out !important;
        }
        #TOC.toc-minimized {
            transform: translateY(-50%) translateX(calc(320px - 50px)) !important;
            opacity: 0.3;
            width: 50px !important;
            overflow: hidden;
        }
        #TOC.toc-minimized > *:not(.toc-toggle-btn) {
            display: none !important;
        }
        #TOC h2 {
            margin-top: 0;
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
            font-size: 1.2em;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .toc-toggle-btn {
            background: none;
            border: none;
            font-size: 1.2em;
            cursor: pointer;
            padding: 5px;
            border-radius: 4px;
            transition: background-color 0.2s;
        }
        .toc-toggle-btn:hover {
            background-color: rgba(0,0,0,0.1);
        }
        #TOC ul {
            list-style-type: none;
            padding-left: 15px;
            margin: 10px 0;
        }
        #TOC ul ul {
            padding-left: 20px;
        }
        #TOC li {
            margin: 8px 0;
            line-height: 1.4;
        }
        #TOC a {
            text-decoration: none;
            color: #495057;
            font-weight: 500;
            transition: all 0.2s ease;
            display: block;
            padding: 6px 10px;
            border-radius: 6px;
            border-left: 3px solid transparent;
        }
        #TOC a:hover {
            color: #007bff;
            background-color: rgba(0, 123, 255, 0.1);
            border-left-color: #007bff;
        }
        #TOC a.active {
            background-color: #007bff !important;
            color: white !important;
            font-weight: bold;
            border-left-color: #0056b3;
        }
        /* Conte√∫do principal com margem para o TOC */
        .main-content {
            margin-right: calc(320px + 40px) !important;
        }
        /* Barra de scroll personalizada APENAS para TOC */
        #TOC::-webkit-scrollbar {
            width: 8px;
        }
        #TOC::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }
        #TOC::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 4px;
        }
        #TOC::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }
        /* === BOT√ÉO VOLTAR AO TOPO (HTMLs individuais) === */
        .back-to-top-content {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            font-size: 18px;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 999;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .back-to-top-content.show {
            opacity: 1;
            transform: translateY(0);
        }
        .back-to-top-content:hover {
            background: #0056b3;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0,0,0,0.2);
        }
        /* === RESPONSIVIDADE === */
        @media (max-width: 1400px) {
            .container {
                max-width: 95%;
                padding: 30px;
            }
            #TOC {
                width: 280px !important;
            }
            .main-content {
                margin-right: 320px !important;
            }
        }
        @media (max-width: 1200px) {
            #TOC {
                width: 260px !important;
                right: 15px !important;
            }
            .main-content {
                margin-right: 300px !important;
            }
        }
        @media (max-width: 992px) {
            #TOC {
                position: relative !important;
                width: 100% !important;
                right: 0 !important;
                top: 0 !important;
                transform: none !important;
                margin: 20px 0;
                max-height: 300px !important;
            }
            .main-content {
                margin-right: 0 !important;
            }
            .back-to-top-content {
                right: 20px;
                bottom: 20px;
            }
        }
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            .container {
                padding: 20px;
                max-width: 100%;
            }
            #TOC {
                max-height: 250px !important;
                padding: 15px !important;
            }
        }
        </style>
        '</span> <span class="kw">in</span> html_content <span class="kw">and</span> <span class="st">'viewport'</span> <span class="kw">not</span> <span class="kw">in</span> html_content:</span>
<span id="cb26-332"><a href="#cb26-332" aria-hidden="true" tabindex="-1"></a>            viewport_meta <span class="op">=</span> <span class="st">'<meta name="viewport" content="width=device-width, initial-scale=1.0">'</span></span>
<span id="cb26-333"><a href="#cb26-333" aria-hidden="true" tabindex="-1"></a>            html_content <span class="op">=</span> html_content.replace(<span class="st">'<head>

        <style id="fixed-toc-styles">
        /* === ESTILOS PRINCIPAIS - TOC FIXO √Ä DIREITA === */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
            scroll-behavior: smooth;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            position: relative;
        }
        /* === TOC FIXO √Ä DIREITA - POSI√á√ÉO CORRIGIDA === */
        #TOC {
            position: fixed !important;
            top: 50% !important;
            right: 20px !important;
            transform: translateY(-50%) !important;
            width: 320px !important;
            max-height: 80vh !important;
            overflow-y: auto !important;
            z-index: 1000 !important;
            background: rgba(255, 255, 255, 0.98) !important;
            padding: 20px !important;
            border-radius: 12px !important;
            box-shadow: 0 8px 32px rgba(0,0,0,0.15) !important;
            border: 1px solid #e0e0e0 !important;
            backdrop-filter: blur(10px) !important;
            transition: all 0.3s ease-in-out !important;
        }
        #TOC.toc-minimized {
            transform: translateY(-50%) translateX(calc(320px - 50px)) !important;
            opacity: 0.3;
            width: 50px !important;
            overflow: hidden;
        }
        #TOC.toc-minimized > *:not(.toc-toggle-btn) {
            display: none !important;
        }
        #TOC h2 {
            margin-top: 0;
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
            font-size: 1.2em;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .toc-toggle-btn {
            background: none;
            border: none;
            font-size: 1.2em;
            cursor: pointer;
            padding: 5px;
            border-radius: 4px;
            transition: background-color 0.2s;
        }
        .toc-toggle-btn:hover {
            background-color: rgba(0,0,0,0.1);
        }
        #TOC ul {
            list-style-type: none;
            padding-left: 15px;
            margin: 10px 0;
        }
        #TOC ul ul {
            padding-left: 20px;
        }
        #TOC li {
            margin: 8px 0;
            line-height: 1.4;
        }
        #TOC a {
            text-decoration: none;
            color: #495057;
            font-weight: 500;
            transition: all 0.2s ease;
            display: block;
            padding: 6px 10px;
            border-radius: 6px;
            border-left: 3px solid transparent;
        }
        #TOC a:hover {
            color: #007bff;
            background-color: rgba(0, 123, 255, 0.1);
            border-left-color: #007bff;
        }
        #TOC a.active {
            background-color: #007bff !important;
            color: white !important;
            font-weight: bold;
            border-left-color: #0056b3;
        }
        /* Conte√∫do principal com margem para o TOC */
        .main-content {
            margin-right: calc(320px + 40px) !important;
        }
        /* Barra de scroll personalizada APENAS para TOC */
        #TOC::-webkit-scrollbar {
            width: 8px;
        }
        #TOC::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }
        #TOC::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 4px;
        }
        #TOC::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }
        /* === BOT√ÉO VOLTAR AO TOPO (HTMLs individuais) === */
        .back-to-top-content {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            font-size: 18px;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 999;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .back-to-top-content.show {
            opacity: 1;
            transform: translateY(0);
        }
        .back-to-top-content:hover {
            background: #0056b3;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0,0,0,0.2);
        }
        /* === RESPONSIVIDADE === */
        @media (max-width: 1400px) {
            .container {
                max-width: 95%;
                padding: 30px;
            }
            #TOC {
                width: 280px !important;
            }
            .main-content {
                margin-right: 320px !important;
            }
        }
        @media (max-width: 1200px) {
            #TOC {
                width: 260px !important;
                right: 15px !important;
            }
            .main-content {
                margin-right: 300px !important;
            }
        }
        @media (max-width: 992px) {
            #TOC {
                position: relative !important;
                width: 100% !important;
                right: 0 !important;
                top: 0 !important;
                transform: none !important;
                margin: 20px 0;
                max-height: 300px !important;
            }
            .main-content {
                margin-right: 0 !important;
            }
            .back-to-top-content {
                right: 20px;
                bottom: 20px;
            }
        }
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            .container {
                padding: 20px;
                max-width: 100%;
            }
            #TOC {
                max-height: 250px !important;
                padding: 15px !important;
            }
        }
        </style>
        '</span>, <span class="ss">f'<head>

        <style id="fixed-toc-styles">
        /* === ESTILOS PRINCIPAIS - TOC FIXO √Ä DIREITA === */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
            scroll-behavior: smooth;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            position: relative;
        }
        /* === TOC FIXO √Ä DIREITA - POSI√á√ÉO CORRIGIDA === */
        #TOC {
            position: fixed !important;
            top: 50% !important;
            right: 20px !important;
            transform: translateY(-50%) !important;
            width: 320px !important;
            max-height: 80vh !important;
            overflow-y: auto !important;
            z-index: 1000 !important;
            background: rgba(255, 255, 255, 0.98) !important;
            padding: 20px !important;
            border-radius: 12px !important;
            box-shadow: 0 8px 32px rgba(0,0,0,0.15) !important;
            border: 1px solid #e0e0e0 !important;
            backdrop-filter: blur(10px) !important;
            transition: all 0.3s ease-in-out !important;
        }
        #TOC.toc-minimized {
            transform: translateY(-50%) translateX(calc(320px - 50px)) !important;
            opacity: 0.3;
            width: 50px !important;
            overflow: hidden;
        }
        #TOC.toc-minimized > *:not(.toc-toggle-btn) {
            display: none !important;
        }
        #TOC h2 {
            margin-top: 0;
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
            font-size: 1.2em;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .toc-toggle-btn {
            background: none;
            border: none;
            font-size: 1.2em;
            cursor: pointer;
            padding: 5px;
            border-radius: 4px;
            transition: background-color 0.2s;
        }
        .toc-toggle-btn:hover {
            background-color: rgba(0,0,0,0.1);
        }
        #TOC ul {
            list-style-type: none;
            padding-left: 15px;
            margin: 10px 0;
        }
        #TOC ul ul {
            padding-left: 20px;
        }
        #TOC li {
            margin: 8px 0;
            line-height: 1.4;
        }
        #TOC a {
            text-decoration: none;
            color: #495057;
            font-weight: 500;
            transition: all 0.2s ease;
            display: block;
            padding: 6px 10px;
            border-radius: 6px;
            border-left: 3px solid transparent;
        }
        #TOC a:hover {
            color: #007bff;
            background-color: rgba(0, 123, 255, 0.1);
            border-left-color: #007bff;
        }
        #TOC a.active {
            background-color: #007bff !important;
            color: white !important;
            font-weight: bold;
            border-left-color: #0056b3;
        }
        /* Conte√∫do principal com margem para o TOC */
        .main-content {
            margin-right: calc(320px + 40px) !important;
        }
        /* Barra de scroll personalizada APENAS para TOC */
        #TOC::-webkit-scrollbar {
            width: 8px;
        }
        #TOC::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }
        #TOC::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 4px;
        }
        #TOC::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }
        /* === BOT√ÉO VOLTAR AO TOPO (HTMLs individuais) === */
        .back-to-top-content {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            font-size: 18px;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 999;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .back-to-top-content.show {
            opacity: 1;
            transform: translateY(0);
        }
        .back-to-top-content:hover {
            background: #0056b3;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0,0,0,0.2);
        }
        /* === RESPONSIVIDADE === */
        @media (max-width: 1400px) {
            .container {
                max-width: 95%;
                padding: 30px;
            }
            #TOC {
                width: 280px !important;
            }
            .main-content {
                margin-right: 320px !important;
            }
        }
        @media (max-width: 1200px) {
            #TOC {
                width: 260px !important;
                right: 15px !important;
            }
            .main-content {
                margin-right: 300px !important;
            }
        }
        @media (max-width: 992px) {
            #TOC {
                position: relative !important;
                width: 100% !important;
                right: 0 !important;
                top: 0 !important;
                transform: none !important;
                margin: 20px 0;
                max-height: 300px !important;
            }
            .main-content {
                margin-right: 0 !important;
            }
            .back-to-top-content {
                right: 20px;
                bottom: 20px;
            }
        }
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            .container {
                padding: 20px;
                max-width: 100%;
            }
            #TOC {
                max-height: 250px !important;
                padding: 15px !important;
            }
        }
        </style>
        </span><span class="ch">\n</span><span class="ss">    </span><span class="sc">{</span>viewport_meta<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb26-334"><a href="#cb26-334" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb26-335"><a href="#cb26-335" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Melhora acessibilidade</span></span>
<span id="cb26-336"><a href="#cb26-336" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">'<html'</span> <span class="kw">in</span> html_content <span class="kw">and</span> <span class="st">'lang'</span> <span class="kw">not</span> <span class="kw">in</span> html_content:</span>
<span id="cb26-337"><a href="#cb26-337" aria-hidden="true" tabindex="-1"></a>            html_content <span class="op">=</span> html_content.replace(<span class="st">'<html>'</span>, <span class="st">'<html lang="pt-BR">'</span>)</span>
<span id="cb26-338"><a href="#cb26-338" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb26-339"><a href="#cb26-339" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Adiciona CSS personalizado para melhorar TOC e numera√ß√£o</span></span>
<span id="cb26-340"><a href="#cb26-340" aria-hidden="true" tabindex="-1"></a>        html_content <span class="op">=</span> <span class="va">self</span>._inject_enhanced_css(html_content)</span>
<span id="cb26-341"><a href="#cb26-341" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb26-342"><a href="#cb26-342" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Otimiza TOC gerado pelo Pandoc</span></span>
<span id="cb26-343"><a href="#cb26-343" aria-hidden="true" tabindex="-1"></a>        html_content <span class="op">=</span> <span class="va">self</span>._enhance_toc_styling(html_content)</span>
<span id="cb26-344"><a href="#cb26-344" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb26-345"><a href="#cb26-345" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> html_content</span>
<span id="cb26-346"><a href="#cb26-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-347"><a href="#cb26-347" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _inject_enhanced_css(<span class="va">self</span>, html_content: <span class="bu">str</span>) <span class="op">-></span> <span class="bu">str</span>:</span>
<span id="cb26-348"><a href="#cb26-348" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Injeta CSS personalizado aprimorado para TOC flutuante e layout de tela completa"""</span></span>
<span id="cb26-349"><a href="#cb26-349" aria-hidden="true" tabindex="-1"></a>        enhanced_css <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb26-350"><a href="#cb26-350" aria-hidden="true" tabindex="-1"></a><span class="st">        <style></span></span>
<span id="cb26-351"><a href="#cb26-351" aria-hidden="true" tabindex="-1"></a><span class="st">            /* LAYOUT DE TELA COMPLETA OTIMIZADO */</span></span>
<span id="cb26-352"><a href="#cb26-352" aria-hidden="true" tabindex="-1"></a><span class="st">            body {</span></span>
<span id="cb26-353"><a href="#cb26-353" aria-hidden="true" tabindex="-1"></a><span class="st">                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;</span></span>
<span id="cb26-354"><a href="#cb26-354" aria-hidden="true" tabindex="-1"></a><span class="st">                line-height: 1.6;</span></span>
<span id="cb26-355"><a href="#cb26-355" aria-hidden="true" tabindex="-1"></a><span class="st">                margin: 0;</span></span>
<span id="cb26-356"><a href="#cb26-356" aria-hidden="true" tabindex="-1"></a><span class="st">                padding: 20px;</span></span>
<span id="cb26-357"><a href="#cb26-357" aria-hidden="true" tabindex="-1"></a><span class="st">                background-color: #f5f5f5;</span></span>
<span id="cb26-358"><a href="#cb26-358" aria-hidden="true" tabindex="-1"></a><span class="st">                color: #333;</span></span>
<span id="cb26-359"><a href="#cb26-359" aria-hidden="true" tabindex="-1"></a><span class="st">                max-width: none; /* Remove limita√ß√£o de largura - TELA COMPLETA */</span></span>
<span id="cb26-360"><a href="#cb26-360" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb26-361"><a href="#cb26-361" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb26-362"><a href="#cb26-362" aria-hidden="true" tabindex="-1"></a><span class="st">            .container {</span></span>
<span id="cb26-363"><a href="#cb26-363" aria-hidden="true" tabindex="-1"></a><span class="st">                max-width: 95%; /* Usa quase toda a largura dispon√≠vel */</span></span>
<span id="cb26-364"><a href="#cb26-364" aria-hidden="true" tabindex="-1"></a><span class="st">                margin: 0 auto;</span></span>
<span id="cb26-365"><a href="#cb26-365" aria-hidden="true" tabindex="-1"></a><span class="st">                background: white;</span></span>
<span id="cb26-366"><a href="#cb26-366" aria-hidden="true" tabindex="-1"></a><span class="st">                padding: 40px;</span></span>
<span id="cb26-367"><a href="#cb26-367" aria-hidden="true" tabindex="-1"></a><span class="st">                border-radius: 10px;</span></span>
<span id="cb26-368"><a href="#cb26-368" aria-hidden="true" tabindex="-1"></a><span class="st">                box-shadow: 0 5px 20px rgba(0,0,0,0.1);</span></span>
<span id="cb26-369"><a href="#cb26-369" aria-hidden="true" tabindex="-1"></a><span class="st">                position: relative; /* Para posicionamento do TOC */</span></span>
<span id="cb26-370"><a href="#cb26-370" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb26-371"><a href="#cb26-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-372"><a href="#cb26-372" aria-hidden="true" tabindex="-1"></a><span class="st">            /* TOC FLUTUANTE OTIMIZADO */</span></span>
<span id="cb26-373"><a href="#cb26-373" aria-hidden="true" tabindex="-1"></a><span class="st">            #TOC {</span></span>
<span id="cb26-374"><a href="#cb26-374" aria-hidden="true" tabindex="-1"></a><span class="st">                background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);</span></span>
<span id="cb26-375"><a href="#cb26-375" aria-hidden="true" tabindex="-1"></a><span class="st">                border: 1px solid #dee2e6;</span></span>
<span id="cb26-376"><a href="#cb26-376" aria-hidden="true" tabindex="-1"></a><span class="st">                border-radius: 8px;</span></span>
<span id="cb26-377"><a href="#cb26-377" aria-hidden="true" tabindex="-1"></a><span class="st">                padding: 20px;</span></span>
<span id="cb26-378"><a href="#cb26-378" aria-hidden="true" tabindex="-1"></a><span class="st">                margin: 20px 0;</span></span>
<span id="cb26-379"><a href="#cb26-379" aria-hidden="true" tabindex="-1"></a><span class="st">                box-shadow: 0 2px 10px rgba(0,0,0,0.1);</span></span>
<span id="cb26-380"><a href="#cb26-380" aria-hidden="true" tabindex="-1"></a><span class="st">                float: right; /* FLUTUA √Ä DIREITA */</span></span>
<span id="cb26-381"><a href="#cb26-381" aria-hidden="true" tabindex="-1"></a><span class="st">                width: 320px; /* Largura fixa para TOC */</span></span>
<span id="cb26-382"><a href="#cb26-382" aria-hidden="true" tabindex="-1"></a><span class="st">                margin-left: 30px;</span></span>
<span id="cb26-383"><a href="#cb26-383" aria-hidden="true" tabindex="-1"></a><span class="st">                margin-bottom: 30px;</span></span>
<span id="cb26-384"><a href="#cb26-384" aria-hidden="true" tabindex="-1"></a><span class="st">                position: relative;</span></span>
<span id="cb26-385"><a href="#cb26-385" aria-hidden="true" tabindex="-1"></a><span class="st">                z-index: 100;</span></span>
<span id="cb26-386"><a href="#cb26-386" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb26-387"><a href="#cb26-387" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb26-388"><a href="#cb26-388" aria-hidden="true" tabindex="-1"></a><span class="st">            #TOC ul {</span></span>
<span id="cb26-389"><a href="#cb26-389" aria-hidden="true" tabindex="-1"></a><span class="st">                list-style-type: none;</span></span>
<span id="cb26-390"><a href="#cb26-390" aria-hidden="true" tabindex="-1"></a><span class="st">                padding-left: 15px;</span></span>
<span id="cb26-391"><a href="#cb26-391" aria-hidden="true" tabindex="-1"></a><span class="st">                margin: 10px 0;</span></span>
<span id="cb26-392"><a href="#cb26-392" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb26-393"><a href="#cb26-393" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb26-394"><a href="#cb26-394" aria-hidden="true" tabindex="-1"></a><span class="st">            #TOC ul ul {</span></span>
<span id="cb26-395"><a href="#cb26-395" aria-hidden="true" tabindex="-1"></a><span class="st">                padding-left: 25px;</span></span>
<span id="cb26-396"><a href="#cb26-396" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb26-397"><a href="#cb26-397" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb26-398"><a href="#cb26-398" aria-hidden="true" tabindex="-1"></a><span class="st">            #TOC li {</span></span>
<span id="cb26-399"><a href="#cb26-399" aria-hidden="true" tabindex="-1"></a><span class="st">                margin: 8px 0;</span></span>
<span id="cb26-400"><a href="#cb26-400" aria-hidden="true" tabindex="-1"></a><span class="st">                line-height: 1.4;</span></span>
<span id="cb26-401"><a href="#cb26-401" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb26-402"><a href="#cb26-402" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb26-403"><a href="#cb26-403" aria-hidden="true" tabindex="-1"></a><span class="st">            #TOC a {</span></span>
<span id="cb26-404"><a href="#cb26-404" aria-hidden="true" tabindex="-1"></a><span class="st">                text-decoration: none;</span></span>
<span id="cb26-405"><a href="#cb26-405" aria-hidden="true" tabindex="-1"></a><span class="st">                color: #495057;</span></span>
<span id="cb26-406"><a href="#cb26-406" aria-hidden="true" tabindex="-1"></a><span class="st">                font-weight: 500;</span></span>
<span id="cb26-407"><a href="#cb26-407" aria-hidden="true" tabindex="-1"></a><span class="st">                transition: color 0.2s ease;</span></span>
<span id="cb26-408"><a href="#cb26-408" aria-hidden="true" tabindex="-1"></a><span class="st">                display: block;</span></span>
<span id="cb26-409"><a href="#cb26-409" aria-hidden="true" tabindex="-1"></a><span class="st">                padding: 4px 8px;</span></span>
<span id="cb26-410"><a href="#cb26-410" aria-hidden="true" tabindex="-1"></a><span class="st">                border-radius: 4px;</span></span>
<span id="cb26-411"><a href="#cb26-411" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb26-412"><a href="#cb26-412" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb26-413"><a href="#cb26-413" aria-hidden="true" tabindex="-1"></a><span class="st">            #TOC a:hover {</span></span>
<span id="cb26-414"><a href="#cb26-414" aria-hidden="true" tabindex="-1"></a><span class="st">                color: #007bff;</span></span>
<span id="cb26-415"><a href="#cb26-415" aria-hidden="true" tabindex="-1"></a><span class="st">                background-color: rgba(0, 123, 255, 0.1);</span></span>
<span id="cb26-416"><a href="#cb26-416" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb26-417"><a href="#cb26-417" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb26-418"><a href="#cb26-418" aria-hidden="true" tabindex="-1"></a><span class="st">            #TOC > ul > li > a {</span></span>
<span id="cb26-419"><a href="#cb26-419" aria-hidden="true" tabindex="-1"></a><span class="st">                font-weight: 600;</span></span>
<span id="cb26-420"><a href="#cb26-420" aria-hidden="true" tabindex="-1"></a><span class="st">                color: #2c3e50;</span></span>
<span id="cb26-421"><a href="#cb26-421" aria-hidden="true" tabindex="-1"></a><span class="st">                border-left: 3px solid #3498db;</span></span>
<span id="cb26-422"><a href="#cb26-422" aria-hidden="true" tabindex="-1"></a><span class="st">                padding-left: 12px;</span></span>
<span id="cb26-423"><a href="#cb26-423" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb26-424"><a href="#cb26-424" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb26-425"><a href="#cb26-425" aria-hidden="true" tabindex="-1"></a><span class="st">            /* CLEARFIX PARA LAYOUT COM TOC FLUTUANTE */</span></span>
<span id="cb26-426"><a href="#cb26-426" aria-hidden="true" tabindex="-1"></a><span class="st">            .main-content {</span></span>
<span id="cb26-427"><a href="#cb26-427" aria-hidden="true" tabindex="-1"></a><span class="st">                overflow: hidden; /* PREVINE PROBLEMAS COM ELEMENTOS FLUTUANTES */</span></span>
<span id="cb26-428"><a href="#cb26-428" aria-hidden="true" tabindex="-1"></a><span class="st">                position: relative;</span></span>
<span id="cb26-429"><a href="#cb26-429" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb26-430"><a href="#cb26-430" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb26-431"><a href="#cb26-431" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Estilos para numera√ß√£o de se√ß√µes */</span></span>
<span id="cb26-432"><a href="#cb26-432" aria-hidden="true" tabindex="-1"></a><span class="st">            .header-section-number {</span></span>
<span id="cb26-433"><a href="#cb26-433" aria-hidden="true" tabindex="-1"></a><span class="st">                color: #3498db;</span></span>
<span id="cb26-434"><a href="#cb26-434" aria-hidden="true" tabindex="-1"></a><span class="st">                font-weight: bold;</span></span>
<span id="cb26-435"><a href="#cb26-435" aria-hidden="true" tabindex="-1"></a><span class="st">                margin-right: 8px;</span></span>
<span id="cb26-436"><a href="#cb26-436" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb26-437"><a href="#cb26-437" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb26-438"><a href="#cb26-438" aria-hidden="true" tabindex="-1"></a><span class="st">            h1 .header-section-number {</span></span>
<span id="cb26-439"><a href="#cb26-439" aria-hidden="true" tabindex="-1"></a><span class="st">                font-size: 0.9em;</span></span>
<span id="cb26-440"><a href="#cb26-440" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb26-441"><a href="#cb26-441" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb26-442"><a href="#cb26-442" aria-hidden="true" tabindex="-1"></a><span class="st">            h2 .header-section-number {</span></span>
<span id="cb26-443"><a href="#cb26-443" aria-hidden="true" tabindex="-1"></a><span class="st">                font-size: 0.85em;</span></span>
<span id="cb26-444"><a href="#cb26-444" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb26-445"><a href="#cb26-445" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb26-446"><a href="#cb26-446" aria-hidden="true" tabindex="-1"></a><span class="st">            h3 .header-section-number {</span></span>
<span id="cb26-447"><a href="#cb26-447" aria-hidden="true" tabindex="-1"></a><span class="st">                font-size: 0.8em;</span></span>
<span id="cb26-448"><a href="#cb26-448" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb26-449"><a href="#cb26-449" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb26-450"><a href="#cb26-450" aria-hidden="true" tabindex="-1"></a><span class="st">            /* CORRE√á√ÉO CR√çTICA: Syntax highlighting do Pandoc */</span></span>
<span id="cb26-451"><a href="#cb26-451" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode { </span></span>
<span id="cb26-452"><a href="#cb26-452" aria-hidden="true" tabindex="-1"></a><span class="st">                background: #2d2d2d !important; </span></span>
<span id="cb26-453"><a href="#cb26-453" aria-hidden="true" tabindex="-1"></a><span class="st">                color: #f8f8f2 !important;</span></span>
<span id="cb26-454"><a href="#cb26-454" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb26-455"><a href="#cb26-455" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb26-456"><a href="#cb26-456" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Garantir que TODO o texto dentro de pre/code seja vis√≠vel */</span></span>
<span id="cb26-457"><a href="#cb26-457" aria-hidden="true" tabindex="-1"></a><span class="st">            pre, code, .sourceCode, .sourceCode pre, .sourceCode code {</span></span>
<span id="cb26-458"><a href="#cb26-458" aria-hidden="true" tabindex="-1"></a><span class="st">                color: #f8f8f2 !important;</span></span>
<span id="cb26-459"><a href="#cb26-459" aria-hidden="true" tabindex="-1"></a><span class="st">                background-color: #2d2d2d !important;</span></span>
<span id="cb26-460"><a href="#cb26-460" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb26-461"><a href="#cb26-461" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb26-462"><a href="#cb26-462" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Corre√ß√£o para spans de syntax highlighting */</span></span>
<span id="cb26-463"><a href="#cb26-463" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode .kw { color: #ff79c6 !important; } /* keywords */</span></span>
<span id="cb26-464"><a href="#cb26-464" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode .dt { color: #8be9fd !important; } /* types */</span></span>
<span id="cb26-465"><a href="#cb26-465" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode .dv { color: #bd93f9 !important; } /* values */</span></span>
<span id="cb26-466"><a href="#cb26-466" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode .bn { color: #bd93f9 !important; } /* numbers */</span></span>
<span id="cb26-467"><a href="#cb26-467" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode .fl { color: #bd93f9 !important; } /* floats */</span></span>
<span id="cb26-468"><a href="#cb26-468" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode .ch { color: #f1fa8c !important; } /* chars */</span></span>
<span id="cb26-469"><a href="#cb26-469" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode .st { color: #f1fa8c !important; } /* strings */</span></span>
<span id="cb26-470"><a href="#cb26-470" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode .co { color: #6272a4 !important; } /* comments */</span></span>
<span id="cb26-471"><a href="#cb26-471" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode .ot { color: #50fa7b !important; } /* other */</span></span>
<span id="cb26-472"><a href="#cb26-472" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode .al { color: #ff5555 !important; } /* alerts */</span></span>
<span id="cb26-473"><a href="#cb26-473" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode .fu { color: #50fa7b !important; } /* functions */</span></span>
<span id="cb26-474"><a href="#cb26-474" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode .re { color: #f1fa8c !important; } /* regex */</span></span>
<span id="cb26-475"><a href="#cb26-475" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode .er { color: #ff5555 !important; } /* errors */</span></span>
<span id="cb26-476"><a href="#cb26-476" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb26-477"><a href="#cb26-477" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Garantir que texto normal em blocos de c√≥digo seja vis√≠vel */</span></span>
<span id="cb26-478"><a href="#cb26-478" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode span {</span></span>
<span id="cb26-479"><a href="#cb26-479" aria-hidden="true" tabindex="-1"></a><span class="st">                color: #f8f8f2 !important;</span></span>
<span id="cb26-480"><a href="#cb26-480" aria-hidden="true" tabindex="-1"></a><span class="st">                background: transparent !important;</span></span>
<span id="cb26-481"><a href="#cb26-481" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb26-482"><a href="#cb26-482" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb26-483"><a href="#cb26-483" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Fallback para qualquer elemento de c√≥digo n√£o estilizado */</span></span>
<span id="cb26-484"><a href="#cb26-484" aria-hidden="true" tabindex="-1"></a><span class="st">            .sourceCode * {</span></span>
<span id="cb26-485"><a href="#cb26-485" aria-hidden="true" tabindex="-1"></a><span class="st">                color: inherit !important;</span></span>
<span id="cb26-486"><a href="#cb26-486" aria-hidden="true" tabindex="-1"></a><span class="st">                background: transparent !important;</span></span>
<span id="cb26-487"><a href="#cb26-487" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb26-488"><a href="#cb26-488" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb26-489"><a href="#cb26-489" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Corre√ß√£o adicional para blocos de c√≥digo gerais */</span></span>
<span id="cb26-490"><a href="#cb26-490" aria-hidden="true" tabindex="-1"></a><span class="st">            div.sourceCode {</span></span>
<span id="cb26-491"><a href="#cb26-491" aria-hidden="true" tabindex="-1"></a><span class="st">                border-left: 4px solid #3498db;</span></span>
<span id="cb26-492"><a href="#cb26-492" aria-hidden="true" tabindex="-1"></a><span class="st">                background: #2d2d2d !important;</span></span>
<span id="cb26-493"><a href="#cb26-493" aria-hidden="true" tabindex="-1"></a><span class="st">                color: #f8f8f2 !important;</span></span>
<span id="cb26-494"><a href="#cb26-494" aria-hidden="true" tabindex="-1"></a><span class="st">                margin: 1.5em 0;</span></span>
<span id="cb26-495"><a href="#cb26-495" aria-hidden="true" tabindex="-1"></a><span class="st">                border-radius: 8px;</span></span>
<span id="cb26-496"><a href="#cb26-496" aria-hidden="true" tabindex="-1"></a><span class="st">                overflow: hidden;</span></span>
<span id="cb26-497"><a href="#cb26-497" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb26-498"><a href="#cb26-498" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb26-499"><a href="#cb26-499" aria-hidden="true" tabindex="-1"></a><span class="st">            div.sourceCode pre {</span></span>
<span id="cb26-500"><a href="#cb26-500" aria-hidden="true" tabindex="-1"></a><span class="st">                margin: 0;</span></span>
<span id="cb26-501"><a href="#cb26-501" aria-hidden="true" tabindex="-1"></a><span class="st">                padding: 20px;</span></span>
<span id="cb26-502"><a href="#cb26-502" aria-hidden="true" tabindex="-1"></a><span class="st">                background: transparent !important;</span></span>
<span id="cb26-503"><a href="#cb26-503" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb26-504"><a href="#cb26-504" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb26-505"><a href="#cb26-505" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Melhorar contraste para texto normal em todas as situa√ß√µes */</span></span>
<span id="cb26-506"><a href="#cb26-506" aria-hidden="true" tabindex="-1"></a><span class="st">            body, .container, .main-content {</span></span>
<span id="cb26-507"><a href="#cb26-507" aria-hidden="true" tabindex="-1"></a><span class="st">                color: #2c3e50 !important;</span></span>
<span id="cb26-508"><a href="#cb26-508" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb26-509"><a href="#cb26-509" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb26-510"><a href="#cb26-510" aria-hidden="true" tabindex="-1"></a><span class="st">            p, li, td, th, div, span {</span></span>
<span id="cb26-511"><a href="#cb26-511" aria-hidden="true" tabindex="-1"></a><span class="st">                color: #2c3e50 !important;</span></span>
<span id="cb26-512"><a href="#cb26-512" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb26-513"><a href="#cb26-513" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb26-514"><a href="#cb26-514" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Garantir que links sejam vis√≠veis */</span></span>
<span id="cb26-515"><a href="#cb26-515" aria-hidden="true" tabindex="-1"></a><span class="st">            a {</span></span>
<span id="cb26-516"><a href="#cb26-516" aria-hidden="true" tabindex="-1"></a><span class="st">                color: #3498db !important;</span></span>
<span id="cb26-517"><a href="#cb26-517" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb26-518"><a href="#cb26-518" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb26-519"><a href="#cb26-519" aria-hidden="true" tabindex="-1"></a><span class="st">            a:hover {</span></span>
<span id="cb26-520"><a href="#cb26-520" aria-hidden="true" tabindex="-1"></a><span class="st">                color: #2980b9 !important;</span></span>
<span id="cb26-521"><a href="#cb26-521" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb26-522"><a href="#cb26-522" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb26-523"><a href="#cb26-523" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Corre√ß√£o para elementos MathJax */</span></span>
<span id="cb26-524"><a href="#cb26-524" aria-hidden="true" tabindex="-1"></a><span class="st">            .math, .math display, mjx-container {</span></span>
<span id="cb26-525"><a href="#cb26-525" aria-hidden="true" tabindex="-1"></a><span class="st">                color: #2c3e50 !important;</span></span>
<span id="cb26-526"><a href="#cb26-526" aria-hidden="true" tabindex="-1"></a><span class="st">                background: transparent !important;</span></span>
<span id="cb26-527"><a href="#cb26-527" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb26-528"><a href="#cb26-528" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb26-529"><a href="#cb26-529" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Melhorias para c√≥digo e matem√°tica */</span></span>
<span id="cb26-530"><a href="#cb26-530" aria-hidden="true" tabindex="-1"></a><span class="st">            .math { display: block; text-align: center; margin: 1.5em 0; }</span></span>
<span id="cb26-531"><a href="#cb26-531" aria-hidden="true" tabindex="-1"></a><span class="st">            .math inline { display: inline-block; }</span></span>
<span id="cb26-532"><a href="#cb26-532" aria-hidden="true" tabindex="-1"></a><span class="st">            pre { </span></span>
<span id="cb26-533"><a href="#cb26-533" aria-hidden="true" tabindex="-1"></a><span class="st">                border-left: 4px solid #3498db; </span></span>
<span id="cb26-534"><a href="#cb26-534" aria-hidden="true" tabindex="-1"></a><span class="st">                background: #2d2d2d !important; </span></span>
<span id="cb26-535"><a href="#cb26-535" aria-hidden="true" tabindex="-1"></a><span class="st">                color: #f8f8f2 !important;</span></span>
<span id="cb26-536"><a href="#cb26-536" aria-hidden="true" tabindex="-1"></a><span class="st">                padding: 20px;</span></span>
<span id="cb26-537"><a href="#cb26-537" aria-hidden="true" tabindex="-1"></a><span class="st">                border-radius: 8px;</span></span>
<span id="cb26-538"><a href="#cb26-538" aria-hidden="true" tabindex="-1"></a><span class="st">                overflow-x: auto;</span></span>
<span id="cb26-539"><a href="#cb26-539" aria-hidden="true" tabindex="-1"></a><span class="st">                font-family: 'Consolas', 'Monaco', 'Courier New', monospace;</span></span>
<span id="cb26-540"><a href="#cb26-540" aria-hidden="true" tabindex="-1"></a><span class="st">                line-height: 1.4;</span></span>
<span id="cb26-541"><a href="#cb26-541" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb26-542"><a href="#cb26-542" aria-hidden="true" tabindex="-1"></a><span class="st">            code { </span></span>
<span id="cb26-543"><a href="#cb26-543" aria-hidden="true" tabindex="-1"></a><span class="st">                background: #e9ecef !important; </span></span>
<span id="cb26-544"><a href="#cb26-544" aria-hidden="true" tabindex="-1"></a><span class="st">                padding: 0.2em 0.4em; </span></span>
<span id="cb26-545"><a href="#cb26-545" aria-hidden="true" tabindex="-1"></a><span class="st">                border-radius: 3px;</span></span>
<span id="cb26-546"><a href="#cb26-546" aria-hidden="true" tabindex="-1"></a><span class="st">                font-family: 'Consolas', 'Monaco', 'Courier New', monospace;</span></span>
<span id="cb26-547"><a href="#cb26-547" aria-hidden="true" tabindex="-1"></a><span class="st">                color: #c7254e !important;</span></span>
<span id="cb26-548"><a href="#cb26-548" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb26-549"><a href="#cb26-549" aria-hidden="true" tabindex="-1"></a><span class="st">            pre code { </span></span>
<span id="cb26-550"><a href="#cb26-550" aria-hidden="true" tabindex="-1"></a><span class="st">                background: none !important; </span></span>
<span id="cb26-551"><a href="#cb26-551" aria-hidden="true" tabindex="-1"></a><span class="st">                color: inherit !important; </span></span>
<span id="cb26-552"><a href="#cb26-552" aria-hidden="true" tabindex="-1"></a><span class="st">                padding: 0 !important; </span></span>
<span id="cb26-553"><a href="#cb26-553" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb26-554"><a href="#cb26-554" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb26-555"><a href="#cb26-555" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Melhorias responsivas */</span></span>
<span id="cb26-556"><a href="#cb26-556" aria-hidden="true" tabindex="-1"></a><span class="st">            @media (max-width: 1400px) {</span></span>
<span id="cb26-557"><a href="#cb26-557" aria-hidden="true" tabindex="-1"></a><span class="st">                .container {</span></span>
<span id="cb26-558"><a href="#cb26-558" aria-hidden="true" tabindex="-1"></a><span class="st">                    max-width: 98%;</span></span>
<span id="cb26-559"><a href="#cb26-559" aria-hidden="true" tabindex="-1"></a><span class="st">                    padding: 30px;</span></span>
<span id="cb26-560"><a href="#cb26-560" aria-hidden="true" tabindex="-1"></a><span class="st">                }</span></span>
<span id="cb26-561"><a href="#cb26-561" aria-hidden="true" tabindex="-1"></a><span class="st">                #TOC {</span></span>
<span id="cb26-562"><a href="#cb26-562" aria-hidden="true" tabindex="-1"></a><span class="st">                    width: 280px; /* Reduz um pouco em telas menores */</span></span>
<span id="cb26-563"><a href="#cb26-563" aria-hidden="true" tabindex="-1"></a><span class="st">                }</span></span>
<span id="cb26-564"><a href="#cb26-564" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb26-565"><a href="#cb26-565" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb26-566"><a href="#cb26-566" aria-hidden="true" tabindex="-1"></a><span class="st">            @media (max-width: 1200px) {</span></span>
<span id="cb26-567"><a href="#cb26-567" aria-hidden="true" tabindex="-1"></a><span class="st">                #TOC {</span></span>
<span id="cb26-568"><a href="#cb26-568" aria-hidden="true" tabindex="-1"></a><span class="st">                    float: none;</span></span>
<span id="cb26-569"><a href="#cb26-569" aria-hidden="true" tabindex="-1"></a><span class="st">                    width: auto;</span></span>
<span id="cb26-570"><a href="#cb26-570" aria-hidden="true" tabindex="-1"></a><span class="st">                    margin: 20px 0;</span></span>
<span id="cb26-571"><a href="#cb26-571" aria-hidden="true" tabindex="-1"></a><span class="st">                    position: static;</span></span>
<span id="cb26-572"><a href="#cb26-572" aria-hidden="true" tabindex="-1"></a><span class="st">                }</span></span>
<span id="cb26-573"><a href="#cb26-573" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb26-574"><a href="#cb26-574" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb26-575"><a href="#cb26-575" aria-hidden="true" tabindex="-1"></a><span class="st">            @media (max-width: 768px) {</span></span>
<span id="cb26-576"><a href="#cb26-576" aria-hidden="true" tabindex="-1"></a><span class="st">                body { padding: 10px; font-size: 14px; }</span></span>
<span id="cb26-577"><a href="#cb26-577" aria-hidden="true" tabindex="-1"></a><span class="st">                .container { padding: 20px; max-width: 100%; }</span></span>
<span id="cb26-578"><a href="#cb26-578" aria-hidden="true" tabindex="-1"></a><span class="st">                pre { font-size: 12px; padding: 15px; }</span></span>
<span id="cb26-579"><a href="#cb26-579" aria-hidden="true" tabindex="-1"></a><span class="st">                #TOC { padding: 15px; }</span></span>
<span id="cb26-580"><a href="#cb26-580" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb26-581"><a href="#cb26-581" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb26-582"><a href="#cb26-582" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Melhorias para tabelas */</span></span>
<span id="cb26-583"><a href="#cb26-583" aria-hidden="true" tabindex="-1"></a><span class="st">            table { </span></span>
<span id="cb26-584"><a href="#cb26-584" aria-hidden="true" tabindex="-1"></a><span class="st">                width: 100%; </span></span>
<span id="cb26-585"><a href="#cb26-585" aria-hidden="true" tabindex="-1"></a><span class="st">                border-collapse: collapse; </span></span>
<span id="cb26-586"><a href="#cb26-586" aria-hidden="true" tabindex="-1"></a><span class="st">                margin: 1.5em 0;</span></span>
<span id="cb26-587"><a href="#cb26-587" aria-hidden="true" tabindex="-1"></a><span class="st">                box-shadow: 0 2px 5px rgba(0,0,0,0.1);</span></span>
<span id="cb26-588"><a href="#cb26-588" aria-hidden="true" tabindex="-1"></a><span class="st">                border-radius: 8px;</span></span>
<span id="cb26-589"><a href="#cb26-589" aria-hidden="true" tabindex="-1"></a><span class="st">                overflow: hidden;</span></span>
<span id="cb26-590"><a href="#cb26-590" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb26-591"><a href="#cb26-591" aria-hidden="true" tabindex="-1"></a><span class="st">            th, td { </span></span>
<span id="cb26-592"><a href="#cb26-592" aria-hidden="true" tabindex="-1"></a><span class="st">                border: 1px solid #dee2e6; </span></span>
<span id="cb26-593"><a href="#cb26-593" aria-hidden="true" tabindex="-1"></a><span class="st">                padding: 12px 15px; </span></span>
<span id="cb26-594"><a href="#cb26-594" aria-hidden="true" tabindex="-1"></a><span class="st">                text-align: left; </span></span>
<span id="cb26-595"><a href="#cb26-595" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb26-596"><a href="#cb26-596" aria-hidden="true" tabindex="-1"></a><span class="st">            th { </span></span>
<span id="cb26-597"><a href="#cb26-597" aria-hidden="true" tabindex="-1"></a><span class="st">                background: linear-gradient(135deg, #3498db, #2980b9);</span></span>
<span id="cb26-598"><a href="#cb26-598" aria-hidden="true" tabindex="-1"></a><span class="st">                color: white; </span></span>
<span id="cb26-599"><a href="#cb26-599" aria-hidden="true" tabindex="-1"></a><span class="st">                font-weight: bold;</span></span>
<span id="cb26-600"><a href="#cb26-600" aria-hidden="true" tabindex="-1"></a><span class="st">                text-transform: uppercase;</span></span>
<span id="cb26-601"><a href="#cb26-601" aria-hidden="true" tabindex="-1"></a><span class="st">                font-size: 0.9em;</span></span>
<span id="cb26-602"><a href="#cb26-602" aria-hidden="true" tabindex="-1"></a><span class="st">                letter-spacing: 0.5px;</span></span>
<span id="cb26-603"><a href="#cb26-603" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb26-604"><a href="#cb26-604" aria-hidden="true" tabindex="-1"></a><span class="st">            tr:nth-child(even) { </span></span>
<span id="cb26-605"><a href="#cb26-605" aria-hidden="true" tabindex="-1"></a><span class="st">                background-color: #f8f9fa; </span></span>
<span id="cb26-606"><a href="#cb26-606" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb26-607"><a href="#cb26-607" aria-hidden="true" tabindex="-1"></a><span class="st">            tr:hover { </span></span>
<span id="cb26-608"><a href="#cb26-608" aria-hidden="true" tabindex="-1"></a><span class="st">                background-color: #e3f2fd; </span></span>
<span id="cb26-609"><a href="#cb26-609" aria-hidden="true" tabindex="-1"></a><span class="st">                transition: background-color 0.2s ease;</span></span>
<span id="cb26-610"><a href="#cb26-610" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb26-611"><a href="#cb26-611" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb26-612"><a href="#cb26-612" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Melhorias para blocos de cita√ß√£o */</span></span>
<span id="cb26-613"><a href="#cb26-613" aria-hidden="true" tabindex="-1"></a><span class="st">            blockquote { </span></span>
<span id="cb26-614"><a href="#cb26-614" aria-hidden="true" tabindex="-1"></a><span class="st">                border-left: 4px solid #3498db; </span></span>
<span id="cb26-615"><a href="#cb26-615" aria-hidden="true" tabindex="-1"></a><span class="st">                margin: 25px 0; </span></span>
<span id="cb26-616"><a href="#cb26-616" aria-hidden="true" tabindex="-1"></a><span class="st">                padding-left: 25px; </span></span>
<span id="cb26-617"><a href="#cb26-617" aria-hidden="true" tabindex="-1"></a><span class="st">                color: #7f8c8d;</span></span>
<span id="cb26-618"><a href="#cb26-618" aria-hidden="true" tabindex="-1"></a><span class="st">                font-style: italic;</span></span>
<span id="cb26-619"><a href="#cb26-619" aria-hidden="true" tabindex="-1"></a><span class="st">                background: #f8f9fa;</span></span>
<span id="cb26-620"><a href="#cb26-620" aria-hidden="true" tabindex="-1"></a><span class="st">                padding: 20px;</span></span>
<span id="cb26-621"><a href="#cb26-621" aria-hidden="true" tabindex="-1"></a><span class="st">                border-radius: 0 8px 8px 0;</span></span>
<span id="cb26-622"><a href="#cb26-622" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb26-623"><a href="#cb26-623" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb26-624"><a href="#cb26-624" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Cabe√ßalhos com numera√ß√£o */</span></span>
<span id="cb26-625"><a href="#cb26-625" aria-hidden="true" tabindex="-1"></a><span class="st">            h1, h2, h3, h4, h5 { </span></span>
<span id="cb26-626"><a href="#cb26-626" aria-hidden="true" tabindex="-1"></a><span class="st">                color: #2c3e50 !important; </span></span>
<span id="cb26-627"><a href="#cb26-627" aria-hidden="true" tabindex="-1"></a><span class="st">                margin-top: 1.8em;</span></span>
<span id="cb26-628"><a href="#cb26-628" aria-hidden="true" tabindex="-1"></a><span class="st">                border-bottom: 1px solid #e9ecef;</span></span>
<span id="cb26-629"><a href="#cb26-629" aria-hidden="true" tabindex="-1"></a><span class="st">                padding-bottom: 0.5em;</span></span>
<span id="cb26-630"><a href="#cb26-630" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb26-631"><a href="#cb26-631" aria-hidden="true" tabindex="-1"></a><span class="st">            h1 { </span></span>
<span id="cb26-632"><a href="#cb26-632" aria-hidden="true" tabindex="-1"></a><span class="st">                border-bottom: 3px solid #3498db; </span></span>
<span id="cb26-633"><a href="#cb26-633" aria-hidden="true" tabindex="-1"></a><span class="st">                padding-bottom: 15px; </span></span>
<span id="cb26-634"><a href="#cb26-634" aria-hidden="true" tabindex="-1"></a><span class="st">                color: #2c3e50 !important;</span></span>
<span id="cb26-635"><a href="#cb26-635" aria-hidden="true" tabindex="-1"></a><span class="st">                font-size: 2.2em;</span></span>
<span id="cb26-636"><a href="#cb26-636" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb26-637"><a href="#cb26-637" aria-hidden="true" tabindex="-1"></a><span class="st">            h2 {</span></span>
<span id="cb26-638"><a href="#cb26-638" aria-hidden="true" tabindex="-1"></a><span class="st">                border-left: 4px solid #3498db;</span></span>
<span id="cb26-639"><a href="#cb26-639" aria-hidden="true" tabindex="-1"></a><span class="st">                padding-left: 15px;</span></span>
<span id="cb26-640"><a href="#cb26-640" aria-hidden="true" tabindex="-1"></a><span class="st">                margin-top: 2em;</span></span>
<span id="cb26-641"><a href="#cb26-641" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb26-642"><a href="#cb26-642" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb26-643"><a href="#cb26-643" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Scroll suave para links do TOC */</span></span>
<span id="cb26-644"><a href="#cb26-644" aria-hidden="true" tabindex="-1"></a><span class="st">            html {</span></span>
<span id="cb26-645"><a href="#cb26-645" aria-hidden="true" tabindex="-1"></a><span class="st">                scroll-behavior: smooth;</span></span>
<span id="cb26-646"><a href="#cb26-646" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb26-647"><a href="#cb26-647" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb26-648"><a href="#cb26-648" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Estilo para quando o TOC √© muito grande */</span></span>
<span id="cb26-649"><a href="#cb26-649" aria-hidden="true" tabindex="-1"></a><span class="st">            #TOC:has(ul ul ul ul) {</span></span>
<span id="cb26-650"><a href="#cb26-650" aria-hidden="true" tabindex="-1"></a><span class="st">                max-height: 80vh;</span></span>
<span id="cb26-651"><a href="#cb26-651" aria-hidden="true" tabindex="-1"></a><span class="st">                overflow-y: auto;</span></span>
<span id="cb26-652"><a href="#cb26-652" aria-hidden="true" tabindex="-1"></a><span class="st">                position: sticky;</span></span>
<span id="cb26-653"><a href="#cb26-653" aria-hidden="true" tabindex="-1"></a><span class="st">                top: 20px;</span></span>
<span id="cb26-654"><a href="#cb26-654" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb26-655"><a href="#cb26-655" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb26-656"><a href="#cb26-656" aria-hidden="true" tabindex="-1"></a><span class="st">            /* Indicador visual para se√ß√£o ativa no TOC */</span></span>
<span id="cb26-657"><a href="#cb26-657" aria-hidden="true" tabindex="-1"></a><span class="st">            #TOC a.active {</span></span>
<span id="cb26-658"><a href="#cb26-658" aria-hidden="true" tabindex="-1"></a><span class="st">                background-color: #007bff;</span></span>
<span id="cb26-659"><a href="#cb26-659" aria-hidden="true" tabindex="-1"></a><span class="st">                color: white;</span></span>
<span id="cb26-660"><a href="#cb26-660" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb26-661"><a href="#cb26-661" aria-hidden="true" tabindex="-1"></a><span class="st">        </style></span></span>
<span id="cb26-662"><a href="#cb26-662" aria-hidden="true" tabindex="-1"></a><span class="st">        """</span></span>
<span id="cb26-663"><a href="#cb26-663" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb26-664"><a href="#cb26-664" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">'</head>'</span> <span class="kw">in</span> html_content:</span>
<span id="cb26-665"><a href="#cb26-665" aria-hidden="true" tabindex="-1"></a>            html_content <span class="op">=</span> html_content.replace(<span class="st">'</head>'</span>, <span class="ss">f'</span><span class="sc">{</span>enhanced_css<span class="sc">}</span><span class="ch">\n</span><span class="ss"></head>'</span>)</span>
<span id="cb26-666"><a href="#cb26-666" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="st">'<head>

        <style id="fixed-toc-styles">
        /* === ESTILOS PRINCIPAIS - TOC FIXO √Ä DIREITA === */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
            scroll-behavior: smooth;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            position: relative;
        }
        /* === TOC FIXO √Ä DIREITA - POSI√á√ÉO CORRIGIDA === */
        #TOC {
            position: fixed !important;
            top: 50% !important;
            right: 20px !important;
            transform: translateY(-50%) !important;
            width: 320px !important;
            max-height: 80vh !important;
            overflow-y: auto !important;
            z-index: 1000 !important;
            background: rgba(255, 255, 255, 0.98) !important;
            padding: 20px !important;
            border-radius: 12px !important;
            box-shadow: 0 8px 32px rgba(0,0,0,0.15) !important;
            border: 1px solid #e0e0e0 !important;
            backdrop-filter: blur(10px) !important;
            transition: all 0.3s ease-in-out !important;
        }
        #TOC.toc-minimized {
            transform: translateY(-50%) translateX(calc(320px - 50px)) !important;
            opacity: 0.3;
            width: 50px !important;
            overflow: hidden;
        }
        #TOC.toc-minimized > *:not(.toc-toggle-btn) {
            display: none !important;
        }
        #TOC h2 {
            margin-top: 0;
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
            font-size: 1.2em;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .toc-toggle-btn {
            background: none;
            border: none;
            font-size: 1.2em;
            cursor: pointer;
            padding: 5px;
            border-radius: 4px;
            transition: background-color 0.2s;
        }
        .toc-toggle-btn:hover {
            background-color: rgba(0,0,0,0.1);
        }
        #TOC ul {
            list-style-type: none;
            padding-left: 15px;
            margin: 10px 0;
        }
        #TOC ul ul {
            padding-left: 20px;
        }
        #TOC li {
            margin: 8px 0;
            line-height: 1.4;
        }
        #TOC a {
            text-decoration: none;
            color: #495057;
            font-weight: 500;
            transition: all 0.2s ease;
            display: block;
            padding: 6px 10px;
            border-radius: 6px;
            border-left: 3px solid transparent;
        }
        #TOC a:hover {
            color: #007bff;
            background-color: rgba(0, 123, 255, 0.1);
            border-left-color: #007bff;
        }
        #TOC a.active {
            background-color: #007bff !important;
            color: white !important;
            font-weight: bold;
            border-left-color: #0056b3;
        }
        /* Conte√∫do principal com margem para o TOC */
        .main-content {
            margin-right: calc(320px + 40px) !important;
        }
        /* Barra de scroll personalizada APENAS para TOC */
        #TOC::-webkit-scrollbar {
            width: 8px;
        }
        #TOC::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }
        #TOC::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 4px;
        }
        #TOC::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }
        /* === BOT√ÉO VOLTAR AO TOPO (HTMLs individuais) === */
        .back-to-top-content {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            font-size: 18px;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 999;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .back-to-top-content.show {
            opacity: 1;
            transform: translateY(0);
        }
        .back-to-top-content:hover {
            background: #0056b3;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0,0,0,0.2);
        }
        /* === RESPONSIVIDADE === */
        @media (max-width: 1400px) {
            .container {
                max-width: 95%;
                padding: 30px;
            }
            #TOC {
                width: 280px !important;
            }
            .main-content {
                margin-right: 320px !important;
            }
        }
        @media (max-width: 1200px) {
            #TOC {
                width: 260px !important;
                right: 15px !important;
            }
            .main-content {
                margin-right: 300px !important;
            }
        }
        @media (max-width: 992px) {
            #TOC {
                position: relative !important;
                width: 100% !important;
                right: 0 !important;
                top: 0 !important;
                transform: none !important;
                margin: 20px 0;
                max-height: 300px !important;
            }
            .main-content {
                margin-right: 0 !important;
            }
            .back-to-top-content {
                right: 20px;
                bottom: 20px;
            }
        }
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            .container {
                padding: 20px;
                max-width: 100%;
            }
            #TOC {
                max-height: 250px !important;
                padding: 15px !important;
            }
        }
        </style>
        '</span> <span class="kw">in</span> html_content:</span>
<span id="cb26-667"><a href="#cb26-667" aria-hidden="true" tabindex="-1"></a>            html_content <span class="op">=</span> html_content.replace(<span class="st">'<head>

        <style id="fixed-toc-styles">
        /* === ESTILOS PRINCIPAIS - TOC FIXO √Ä DIREITA === */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
            scroll-behavior: smooth;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            position: relative;
        }
        /* === TOC FIXO √Ä DIREITA - POSI√á√ÉO CORRIGIDA === */
        #TOC {
            position: fixed !important;
            top: 50% !important;
            right: 20px !important;
            transform: translateY(-50%) !important;
            width: 320px !important;
            max-height: 80vh !important;
            overflow-y: auto !important;
            z-index: 1000 !important;
            background: rgba(255, 255, 255, 0.98) !important;
            padding: 20px !important;
            border-radius: 12px !important;
            box-shadow: 0 8px 32px rgba(0,0,0,0.15) !important;
            border: 1px solid #e0e0e0 !important;
            backdrop-filter: blur(10px) !important;
            transition: all 0.3s ease-in-out !important;
        }
        #TOC.toc-minimized {
            transform: translateY(-50%) translateX(calc(320px - 50px)) !important;
            opacity: 0.3;
            width: 50px !important;
            overflow: hidden;
        }
        #TOC.toc-minimized > *:not(.toc-toggle-btn) {
            display: none !important;
        }
        #TOC h2 {
            margin-top: 0;
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
            font-size: 1.2em;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .toc-toggle-btn {
            background: none;
            border: none;
            font-size: 1.2em;
            cursor: pointer;
            padding: 5px;
            border-radius: 4px;
            transition: background-color 0.2s;
        }
        .toc-toggle-btn:hover {
            background-color: rgba(0,0,0,0.1);
        }
        #TOC ul {
            list-style-type: none;
            padding-left: 15px;
            margin: 10px 0;
        }
        #TOC ul ul {
            padding-left: 20px;
        }
        #TOC li {
            margin: 8px 0;
            line-height: 1.4;
        }
        #TOC a {
            text-decoration: none;
            color: #495057;
            font-weight: 500;
            transition: all 0.2s ease;
            display: block;
            padding: 6px 10px;
            border-radius: 6px;
            border-left: 3px solid transparent;
        }
        #TOC a:hover {
            color: #007bff;
            background-color: rgba(0, 123, 255, 0.1);
            border-left-color: #007bff;
        }
        #TOC a.active {
            background-color: #007bff !important;
            color: white !important;
            font-weight: bold;
            border-left-color: #0056b3;
        }
        /* Conte√∫do principal com margem para o TOC */
        .main-content {
            margin-right: calc(320px + 40px) !important;
        }
        /* Barra de scroll personalizada APENAS para TOC */
        #TOC::-webkit-scrollbar {
            width: 8px;
        }
        #TOC::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }
        #TOC::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 4px;
        }
        #TOC::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }
        /* === BOT√ÉO VOLTAR AO TOPO (HTMLs individuais) === */
        .back-to-top-content {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            font-size: 18px;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 999;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .back-to-top-content.show {
            opacity: 1;
            transform: translateY(0);
        }
        .back-to-top-content:hover {
            background: #0056b3;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0,0,0,0.2);
        }
        /* === RESPONSIVIDADE === */
        @media (max-width: 1400px) {
            .container {
                max-width: 95%;
                padding: 30px;
            }
            #TOC {
                width: 280px !important;
            }
            .main-content {
                margin-right: 320px !important;
            }
        }
        @media (max-width: 1200px) {
            #TOC {
                width: 260px !important;
                right: 15px !important;
            }
            .main-content {
                margin-right: 300px !important;
            }
        }
        @media (max-width: 992px) {
            #TOC {
                position: relative !important;
                width: 100% !important;
                right: 0 !important;
                top: 0 !important;
                transform: none !important;
                margin: 20px 0;
                max-height: 300px !important;
            }
            .main-content {
                margin-right: 0 !important;
            }
            .back-to-top-content {
                right: 20px;
                bottom: 20px;
            }
        }
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            .container {
                padding: 20px;
                max-width: 100%;
            }
            #TOC {
                max-height: 250px !important;
                padding: 15px !important;
            }
        }
        </style>
        '</span>, <span class="ss">f'<head>

        <style id="fixed-toc-styles">
        /* === ESTILOS PRINCIPAIS - TOC FIXO √Ä DIREITA === */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
            scroll-behavior: smooth;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            position: relative;
        }
        /* === TOC FIXO √Ä DIREITA - POSI√á√ÉO CORRIGIDA === */
        #TOC {
            position: fixed !important;
            top: 50% !important;
            right: 20px !important;
            transform: translateY(-50%) !important;
            width: 320px !important;
            max-height: 80vh !important;
            overflow-y: auto !important;
            z-index: 1000 !important;
            background: rgba(255, 255, 255, 0.98) !important;
            padding: 20px !important;
            border-radius: 12px !important;
            box-shadow: 0 8px 32px rgba(0,0,0,0.15) !important;
            border: 1px solid #e0e0e0 !important;
            backdrop-filter: blur(10px) !important;
            transition: all 0.3s ease-in-out !important;
        }
        #TOC.toc-minimized {
            transform: translateY(-50%) translateX(calc(320px - 50px)) !important;
            opacity: 0.3;
            width: 50px !important;
            overflow: hidden;
        }
        #TOC.toc-minimized > *:not(.toc-toggle-btn) {
            display: none !important;
        }
        #TOC h2 {
            margin-top: 0;
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
            font-size: 1.2em;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .toc-toggle-btn {
            background: none;
            border: none;
            font-size: 1.2em;
            cursor: pointer;
            padding: 5px;
            border-radius: 4px;
            transition: background-color 0.2s;
        }
        .toc-toggle-btn:hover {
            background-color: rgba(0,0,0,0.1);
        }
        #TOC ul {
            list-style-type: none;
            padding-left: 15px;
            margin: 10px 0;
        }
        #TOC ul ul {
            padding-left: 20px;
        }
        #TOC li {
            margin: 8px 0;
            line-height: 1.4;
        }
        #TOC a {
            text-decoration: none;
            color: #495057;
            font-weight: 500;
            transition: all 0.2s ease;
            display: block;
            padding: 6px 10px;
            border-radius: 6px;
            border-left: 3px solid transparent;
        }
        #TOC a:hover {
            color: #007bff;
            background-color: rgba(0, 123, 255, 0.1);
            border-left-color: #007bff;
        }
        #TOC a.active {
            background-color: #007bff !important;
            color: white !important;
            font-weight: bold;
            border-left-color: #0056b3;
        }
        /* Conte√∫do principal com margem para o TOC */
        .main-content {
            margin-right: calc(320px + 40px) !important;
        }
        /* Barra de scroll personalizada APENAS para TOC */
        #TOC::-webkit-scrollbar {
            width: 8px;
        }
        #TOC::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }
        #TOC::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 4px;
        }
        #TOC::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }
        /* === BOT√ÉO VOLTAR AO TOPO (HTMLs individuais) === */
        .back-to-top-content {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            font-size: 18px;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 999;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .back-to-top-content.show {
            opacity: 1;
            transform: translateY(0);
        }
        .back-to-top-content:hover {
            background: #0056b3;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0,0,0,0.2);
        }
        /* === RESPONSIVIDADE === */
        @media (max-width: 1400px) {
            .container {
                max-width: 95%;
                padding: 30px;
            }
            #TOC {
                width: 280px !important;
            }
            .main-content {
                margin-right: 320px !important;
            }
        }
        @media (max-width: 1200px) {
            #TOC {
                width: 260px !important;
                right: 15px !important;
            }
            .main-content {
                margin-right: 300px !important;
            }
        }
        @media (max-width: 992px) {
            #TOC {
                position: relative !important;
                width: 100% !important;
                right: 0 !important;
                top: 0 !important;
                transform: none !important;
                margin: 20px 0;
                max-height: 300px !important;
            }
            .main-content {
                margin-right: 0 !important;
            }
            .back-to-top-content {
                right: 20px;
                bottom: 20px;
            }
        }
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            .container {
                padding: 20px;
                max-width: 100%;
            }
            #TOC {
                max-height: 250px !important;
                padding: 15px !important;
            }
        }
        </style>
        </span><span class="ch">\n</span><span class="sc">{</span>enhanced_css<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb26-668"><a href="#cb26-668" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb26-669"><a href="#cb26-669" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="st">'<body>'</span> <span class="kw">in</span> html_content:</span>
<span id="cb26-670"><a href="#cb26-670" aria-hidden="true" tabindex="-1"></a>                html_content <span class="op">=</span> html_content.replace(<span class="st">'<body>'</span>, <span class="ss">f'<head>

        <style id="fixed-toc-styles">
        /* === ESTILOS PRINCIPAIS - TOC FIXO √Ä DIREITA === */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
            scroll-behavior: smooth;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            position: relative;
        }
        /* === TOC FIXO √Ä DIREITA - POSI√á√ÉO CORRIGIDA === */
        #TOC {
            position: fixed !important;
            top: 50% !important;
            right: 20px !important;
            transform: translateY(-50%) !important;
            width: 320px !important;
            max-height: 80vh !important;
            overflow-y: auto !important;
            z-index: 1000 !important;
            background: rgba(255, 255, 255, 0.98) !important;
            padding: 20px !important;
            border-radius: 12px !important;
            box-shadow: 0 8px 32px rgba(0,0,0,0.15) !important;
            border: 1px solid #e0e0e0 !important;
            backdrop-filter: blur(10px) !important;
            transition: all 0.3s ease-in-out !important;
        }
        #TOC.toc-minimized {
            transform: translateY(-50%) translateX(calc(320px - 50px)) !important;
            opacity: 0.3;
            width: 50px !important;
            overflow: hidden;
        }
        #TOC.toc-minimized > *:not(.toc-toggle-btn) {
            display: none !important;
        }
        #TOC h2 {
            margin-top: 0;
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
            font-size: 1.2em;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .toc-toggle-btn {
            background: none;
            border: none;
            font-size: 1.2em;
            cursor: pointer;
            padding: 5px;
            border-radius: 4px;
            transition: background-color 0.2s;
        }
        .toc-toggle-btn:hover {
            background-color: rgba(0,0,0,0.1);
        }
        #TOC ul {
            list-style-type: none;
            padding-left: 15px;
            margin: 10px 0;
        }
        #TOC ul ul {
            padding-left: 20px;
        }
        #TOC li {
            margin: 8px 0;
            line-height: 1.4;
        }
        #TOC a {
            text-decoration: none;
            color: #495057;
            font-weight: 500;
            transition: all 0.2s ease;
            display: block;
            padding: 6px 10px;
            border-radius: 6px;
            border-left: 3px solid transparent;
        }
        #TOC a:hover {
            color: #007bff;
            background-color: rgba(0, 123, 255, 0.1);
            border-left-color: #007bff;
        }
        #TOC a.active {
            background-color: #007bff !important;
            color: white !important;
            font-weight: bold;
            border-left-color: #0056b3;
        }
        /* Conte√∫do principal com margem para o TOC */
        .main-content {
            margin-right: calc(320px + 40px) !important;
        }
        /* Barra de scroll personalizada APENAS para TOC */
        #TOC::-webkit-scrollbar {
            width: 8px;
        }
        #TOC::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }
        #TOC::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 4px;
        }
        #TOC::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }
        /* === BOT√ÉO VOLTAR AO TOPO (HTMLs individuais) === */
        .back-to-top-content {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            font-size: 18px;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 999;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .back-to-top-content.show {
            opacity: 1;
            transform: translateY(0);
        }
        .back-to-top-content:hover {
            background: #0056b3;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0,0,0,0.2);
        }
        /* === RESPONSIVIDADE === */
        @media (max-width: 1400px) {
            .container {
                max-width: 95%;
                padding: 30px;
            }
            #TOC {
                width: 280px !important;
            }
            .main-content {
                margin-right: 320px !important;
            }
        }
        @media (max-width: 1200px) {
            #TOC {
                width: 260px !important;
                right: 15px !important;
            }
            .main-content {
                margin-right: 300px !important;
            }
        }
        @media (max-width: 992px) {
            #TOC {
                position: relative !important;
                width: 100% !important;
                right: 0 !important;
                top: 0 !important;
                transform: none !important;
                margin: 20px 0;
                max-height: 300px !important;
            }
            .main-content {
                margin-right: 0 !important;
            }
            .back-to-top-content {
                right: 20px;
                bottom: 20px;
            }
        }
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            .container {
                padding: 20px;
                max-width: 100%;
            }
            #TOC {
                max-height: 250px !important;
                padding: 15px !important;
            }
        }
        </style>
        </span><span class="ch">\n</span><span class="sc">{</span>enhanced_css<span class="sc">}</span><span class="ch">\n</span><span class="ss"></head></span><span class="ch">\n</span><span class="ss"><body>'</span>)</span>
<span id="cb26-671"><a href="#cb26-671" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb26-672"><a href="#cb26-672" aria-hidden="true" tabindex="-1"></a>                html_content <span class="op">=</span> <span class="ss">f'<head>

        <style id="fixed-toc-styles">
        /* === ESTILOS PRINCIPAIS - TOC FIXO √Ä DIREITA === */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
            scroll-behavior: smooth;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            position: relative;
        }
        /* === TOC FIXO √Ä DIREITA - POSI√á√ÉO CORRIGIDA === */
        #TOC {
            position: fixed !important;
            top: 50% !important;
            right: 20px !important;
            transform: translateY(-50%) !important;
            width: 320px !important;
            max-height: 80vh !important;
            overflow-y: auto !important;
            z-index: 1000 !important;
            background: rgba(255, 255, 255, 0.98) !important;
            padding: 20px !important;
            border-radius: 12px !important;
            box-shadow: 0 8px 32px rgba(0,0,0,0.15) !important;
            border: 1px solid #e0e0e0 !important;
            backdrop-filter: blur(10px) !important;
            transition: all 0.3s ease-in-out !important;
        }
        #TOC.toc-minimized {
            transform: translateY(-50%) translateX(calc(320px - 50px)) !important;
            opacity: 0.3;
            width: 50px !important;
            overflow: hidden;
        }
        #TOC.toc-minimized > *:not(.toc-toggle-btn) {
            display: none !important;
        }
        #TOC h2 {
            margin-top: 0;
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
            font-size: 1.2em;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .toc-toggle-btn {
            background: none;
            border: none;
            font-size: 1.2em;
            cursor: pointer;
            padding: 5px;
            border-radius: 4px;
            transition: background-color 0.2s;
        }
        .toc-toggle-btn:hover {
            background-color: rgba(0,0,0,0.1);
        }
        #TOC ul {
            list-style-type: none;
            padding-left: 15px;
            margin: 10px 0;
        }
        #TOC ul ul {
            padding-left: 20px;
        }
        #TOC li {
            margin: 8px 0;
            line-height: 1.4;
        }
        #TOC a {
            text-decoration: none;
            color: #495057;
            font-weight: 500;
            transition: all 0.2s ease;
            display: block;
            padding: 6px 10px;
            border-radius: 6px;
            border-left: 3px solid transparent;
        }
        #TOC a:hover {
            color: #007bff;
            background-color: rgba(0, 123, 255, 0.1);
            border-left-color: #007bff;
        }
        #TOC a.active {
            background-color: #007bff !important;
            color: white !important;
            font-weight: bold;
            border-left-color: #0056b3;
        }
        /* Conte√∫do principal com margem para o TOC */
        .main-content {
            margin-right: calc(320px + 40px) !important;
        }
        /* Barra de scroll personalizada APENAS para TOC */
        #TOC::-webkit-scrollbar {
            width: 8px;
        }
        #TOC::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }
        #TOC::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 4px;
        }
        #TOC::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }
        /* === BOT√ÉO VOLTAR AO TOPO (HTMLs individuais) === */
        .back-to-top-content {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            font-size: 18px;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 999;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .back-to-top-content.show {
            opacity: 1;
            transform: translateY(0);
        }
        .back-to-top-content:hover {
            background: #0056b3;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0,0,0,0.2);
        }
        /* === RESPONSIVIDADE === */
        @media (max-width: 1400px) {
            .container {
                max-width: 95%;
                padding: 30px;
            }
            #TOC {
                width: 280px !important;
            }
            .main-content {
                margin-right: 320px !important;
            }
        }
        @media (max-width: 1200px) {
            #TOC {
                width: 260px !important;
                right: 15px !important;
            }
            .main-content {
                margin-right: 300px !important;
            }
        }
        @media (max-width: 992px) {
            #TOC {
                position: relative !important;
                width: 100% !important;
                right: 0 !important;
                top: 0 !important;
                transform: none !important;
                margin: 20px 0;
                max-height: 300px !important;
            }
            .main-content {
                margin-right: 0 !important;
            }
            .back-to-top-content {
                right: 20px;
                bottom: 20px;
            }
        }
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            .container {
                padding: 20px;
                max-width: 100%;
            }
            #TOC {
                max-height: 250px !important;
                padding: 15px !important;
            }
        }
        </style>
        </span><span class="ch">\n</span><span class="sc">{</span>enhanced_css<span class="sc">}</span><span class="ch">\n</span><span class="ss"></head></span><span class="ch">\n</span><span class="ss"><body></span><span class="ch">\n</span><span class="sc">{</span>html_content<span class="sc">}</span><span class="ch">\n</span><span class="ss">
        <script id="fixed-toc-script">
        document.addEventListener('DOMContentLoaded', function() {
            const toc = document.getElementById('TOC');
            if (toc) {
                const tocTitle = toc.querySelector('h2');
                if (tocTitle) {
                    const toggleBtn = document.createElement('button');
                    toggleBtn.innerHTML = '‚ò∞';
                    toggleBtn.className = 'toc-toggle-btn';
                    toggleBtn.title = 'Minimizar/Expandir TOC';
                    let isMinimized = false;
                    toggleBtn.addEventListener('click', function(e) {
                        e.stopPropagation();
                        isMinimized = !isMinimized;
                        if (isMinimized) {
                            toc.classList.add('toc-minimized');
                        } else {
                            toc.classList.remove('toc-minimized');
                        }
                    });
                    tocTitle.appendChild(toggleBtn);
                }
            }
            
            // SCROLLSPY
            const sections = document.querySelectorAll('h1, h2, h3, h4, h5');
            const tocLinks = document.querySelectorAll('#TOC a');
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const id = entry.target.getAttribute('id');
                        tocLinks.forEach(link => {
                            link.classList.remove('active');
                            if (link.getAttribute('href') === '#' + id) {
                                link.classList.add('active');
                            }
                        });
                    }
                });
            }, { 
                rootMargin: '-20% 0px -60% 0px', 
                threshold: 0 
            });
            
            sections.forEach(section => {
                if (section.id) observer.observe(section);
            });
            
            // Scroll suave
            tocLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const targetId = link.getAttribute('href').substring(1);
                    const targetElement = document.getElementById(targetId);
                    if (targetElement) {
                        const offsetTop = targetElement.offsetTop - 80;
                        window.scrollTo({ top: offsetTop, behavior: 'smooth' });
                    }
                });
            });
            
            // BOT√ÉO VOLTAR AO TOPO
            const backToTopBtn = document.createElement('button');
            backToTopBtn.className = 'back-to-top-content';
            backToTopBtn.innerHTML = '‚Üë';
            backToTopBtn.title = 'Voltar ao Topo';
            document.body.appendChild(backToTopBtn);
            
            window.addEventListener('scroll', () => {
                if (window.pageYOffset > 300) {
                    backToTopBtn.classList.add('show');
                } else {
                    backToTopBtn.classList.remove('show');
                }
            });
            
            backToTopBtn.addEventListener('click', () => {
                window.scrollTo({ top: 0, behavior: 'smooth' });
            });
        });
        </script>
        
</body>'</span></span>
<span id="cb26-673"><a href="#cb26-673" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb26-674"><a href="#cb26-674" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> html_content</span>
<span id="cb26-675"><a href="#cb26-675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-676"><a href="#cb26-676" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _enhance_toc_styling(<span class="va">self</span>, html_content: <span class="bu">str</span>) <span class="op">-></span> <span class="bu">str</span>:</span>
<span id="cb26-677"><a href="#cb26-677" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Melhora o estilo do Table of Contents gerado pelo Pandoc"""</span></span>
<span id="cb26-678"><a href="#cb26-678" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Adiciona t√≠tulo ao TOC se n√£o existir</span></span>
<span id="cb26-679"><a href="#cb26-679" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">'<div id="TOC">'</span> <span class="kw">in</span> html_content <span class="kw">and</span> <span class="st">'Table of Contents'</span> <span class="kw">not</span> <span class="kw">in</span> html_content:</span>
<span id="cb26-680"><a href="#cb26-680" aria-hidden="true" tabindex="-1"></a>            html_content <span class="op">=</span> html_content.replace(</span>
<span id="cb26-681"><a href="#cb26-681" aria-hidden="true" tabindex="-1"></a>                <span class="st">'<div id="TOC">'</span>, </span>
<span id="cb26-682"><a href="#cb26-682" aria-hidden="true" tabindex="-1"></a>                <span class="st">'<div id="TOC"><h2 style="margin-top: 0; color: #2c3e50; border-bottom: 2px solid #3498db; padding-bottom: 10px;">üìë Table of Contents</h2>'</span></span>
<span id="cb26-683"><a href="#cb26-683" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb26-684"><a href="#cb26-684" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb26-685"><a href="#cb26-685" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Adiciona wrapper para conte√∫do principal com clearfix</span></span>
<span id="cb26-686"><a href="#cb26-686" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">'<div id="TOC">'</span> <span class="kw">in</span> html_content <span class="kw">and</span> <span class="st">'<body>'</span> <span class="kw">in</span> html_content:</span>
<span id="cb26-687"><a href="#cb26-687" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Encontra o TOC e envolve o conte√∫do restante</span></span>
<span id="cb26-688"><a href="#cb26-688" aria-hidden="true" tabindex="-1"></a>            toc_end <span class="op">=</span> html_content.find(<span class="st">'</div>'</span>, html_content.find(<span class="st">'<div id="TOC">'</span>)) <span class="op">+</span> <span class="dv">6</span></span>
<span id="cb26-689"><a href="#cb26-689" aria-hidden="true" tabindex="-1"></a>            body_content <span class="op">=</span> html_content[toc_end:]</span>
<span id="cb26-690"><a href="#cb26-690" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="st">'<div class="main-content">'</span> <span class="kw">not</span> <span class="kw">in</span> body_content:</span>
<span id="cb26-691"><a href="#cb26-691" aria-hidden="true" tabindex="-1"></a>                html_content <span class="op">=</span> html_content[:toc_end] <span class="op">+</span> <span class="st">'</span><span class="ch">\n</span><span class="st"><div class="main-content">'</span> <span class="op">+</span> body_content <span class="op">+</span> <span class="st">'</span><span class="ch">\n</span><span class="st"></div>'</span></span>
<span id="cb26-692"><a href="#cb26-692" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb26-693"><a href="#cb26-693" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> html_content</span>
<span id="cb26-694"><a href="#cb26-694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-695"><a href="#cb26-695" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _convert_with_fallback(<span class="va">self</span>, md_file_path: <span class="bu">str</span>) <span class="op">-></span> <span class="bu">str</span>:</span>
<span id="cb26-696"><a href="#cb26-696" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Fallback para convers√£o quando Pandoc falha"""</span></span>
<span id="cb26-697"><a href="#cb26-697" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb26-698"><a href="#cb26-698" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(md_file_path, <span class="st">'r'</span>, encoding<span class="op">=</span><span class="st">'utf-8'</span>) <span class="im">as</span> f:</span>
<span id="cb26-699"><a href="#cb26-699" aria-hidden="true" tabindex="-1"></a>                md_content <span class="op">=</span> f.read()</span>
<span id="cb26-700"><a href="#cb26-700" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb26-701"><a href="#cb26-701" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Extens√µes avan√ßadas para melhor convers√£o</span></span>
<span id="cb26-702"><a href="#cb26-702" aria-hidden="true" tabindex="-1"></a>            extensions <span class="op">=</span> [</span>
<span id="cb26-703"><a href="#cb26-703" aria-hidden="true" tabindex="-1"></a>                <span class="st">'extra'</span>, <span class="st">'tables'</span>, <span class="st">'fenced_code'</span>, <span class="st">'codehilite'</span>, </span>
<span id="cb26-704"><a href="#cb26-704" aria-hidden="true" tabindex="-1"></a>                <span class="st">'toc'</span>, <span class="st">'md_in_html'</span>, <span class="st">'attr_list'</span></span>
<span id="cb26-705"><a href="#cb26-705" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb26-706"><a href="#cb26-706" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb26-707"><a href="#cb26-707" aria-hidden="true" tabindex="-1"></a>            html_content <span class="op">=</span> markdown.markdown(</span>
<span id="cb26-708"><a href="#cb26-708" aria-hidden="true" tabindex="-1"></a>                md_content,</span>
<span id="cb26-709"><a href="#cb26-709" aria-hidden="true" tabindex="-1"></a>                extensions<span class="op">=</span>extensions,</span>
<span id="cb26-710"><a href="#cb26-710" aria-hidden="true" tabindex="-1"></a>                output_format<span class="op">=</span><span class="st">'html5'</span></span>
<span id="cb26-711"><a href="#cb26-711" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb26-712"><a href="#cb26-712" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb26-713"><a href="#cb26-713" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">self</span>._create_enhanced_html_template(html_content, Path(md_file_path).name)</span>
<span id="cb26-714"><a href="#cb26-714" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb26-715"><a href="#cb26-715" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb26-716"><a href="#cb26-716" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.error(<span class="ss">f"‚ùå Fallback tamb√©m falhou: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb26-717"><a href="#cb26-717" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">self</span>._create_basic_html(md_content, Path(md_file_path).name)</span>
<span id="cb26-718"><a href="#cb26-718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-719"><a href="#cb26-719" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _create_enhanced_html_template(<span class="va">self</span>, content: <span class="bu">str</span>, title: <span class="bu">str</span>) <span class="op">-></span> <span class="bu">str</span>:</span>
<span id="cb26-720"><a href="#cb26-720" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Template HTML aprimorado com suporte a MathJax local/online e TOC flutuante"""</span></span>
<span id="cb26-721"><a href="#cb26-721" aria-hidden="true" tabindex="-1"></a>        mathjax_src <span class="op">=</span> <span class="st">"assets/tex-mml-chtml.js"</span> <span class="cf">if</span> Path(<span class="st">"assets/tex-mml-chtml.js"</span>).exists() <span class="cf">else</span> <span class="st">"https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"</span></span>
<span id="cb26-722"><a href="#cb26-722" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb26-723"><a href="#cb26-723" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="ss">f"""<!DOCTYPE html></span></span>
<span id="cb26-724"><a href="#cb26-724" aria-hidden="true" tabindex="-1"></a><span class="ss"><html lang="pt-BR"></span></span>
<span id="cb26-725"><a href="#cb26-725" aria-hidden="true" tabindex="-1"></a><span class="ss"><head>

        <style id="fixed-toc-styles">
        /* === ESTILOS PRINCIPAIS - TOC FIXO √Ä DIREITA === */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
            scroll-behavior: smooth;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            position: relative;
        }
        /* === TOC FIXO √Ä DIREITA - POSI√á√ÉO CORRIGIDA === */
        #TOC {
            position: fixed !important;
            top: 50% !important;
            right: 20px !important;
            transform: translateY(-50%) !important;
            width: 320px !important;
            max-height: 80vh !important;
            overflow-y: auto !important;
            z-index: 1000 !important;
            background: rgba(255, 255, 255, 0.98) !important;
            padding: 20px !important;
            border-radius: 12px !important;
            box-shadow: 0 8px 32px rgba(0,0,0,0.15) !important;
            border: 1px solid #e0e0e0 !important;
            backdrop-filter: blur(10px) !important;
            transition: all 0.3s ease-in-out !important;
        }
        #TOC.toc-minimized {
            transform: translateY(-50%) translateX(calc(320px - 50px)) !important;
            opacity: 0.3;
            width: 50px !important;
            overflow: hidden;
        }
        #TOC.toc-minimized > *:not(.toc-toggle-btn) {
            display: none !important;
        }
        #TOC h2 {
            margin-top: 0;
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
            font-size: 1.2em;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .toc-toggle-btn {
            background: none;
            border: none;
            font-size: 1.2em;
            cursor: pointer;
            padding: 5px;
            border-radius: 4px;
            transition: background-color 0.2s;
        }
        .toc-toggle-btn:hover {
            background-color: rgba(0,0,0,0.1);
        }
        #TOC ul {
            list-style-type: none;
            padding-left: 15px;
            margin: 10px 0;
        }
        #TOC ul ul {
            padding-left: 20px;
        }
        #TOC li {
            margin: 8px 0;
            line-height: 1.4;
        }
        #TOC a {
            text-decoration: none;
            color: #495057;
            font-weight: 500;
            transition: all 0.2s ease;
            display: block;
            padding: 6px 10px;
            border-radius: 6px;
            border-left: 3px solid transparent;
        }
        #TOC a:hover {
            color: #007bff;
            background-color: rgba(0, 123, 255, 0.1);
            border-left-color: #007bff;
        }
        #TOC a.active {
            background-color: #007bff !important;
            color: white !important;
            font-weight: bold;
            border-left-color: #0056b3;
        }
        /* Conte√∫do principal com margem para o TOC */
        .main-content {
            margin-right: calc(320px + 40px) !important;
        }
        /* Barra de scroll personalizada APENAS para TOC */
        #TOC::-webkit-scrollbar {
            width: 8px;
        }
        #TOC::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }
        #TOC::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 4px;
        }
        #TOC::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }
        /* === BOT√ÉO VOLTAR AO TOPO (HTMLs individuais) === */
        .back-to-top-content {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            font-size: 18px;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 999;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .back-to-top-content.show {
            opacity: 1;
            transform: translateY(0);
        }
        .back-to-top-content:hover {
            background: #0056b3;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0,0,0,0.2);
        }
        /* === RESPONSIVIDADE === */
        @media (max-width: 1400px) {
            .container {
                max-width: 95%;
                padding: 30px;
            }
            #TOC {
                width: 280px !important;
            }
            .main-content {
                margin-right: 320px !important;
            }
        }
        @media (max-width: 1200px) {
            #TOC {
                width: 260px !important;
                right: 15px !important;
            }
            .main-content {
                margin-right: 300px !important;
            }
        }
        @media (max-width: 992px) {
            #TOC {
                position: relative !important;
                width: 100% !important;
                right: 0 !important;
                top: 0 !important;
                transform: none !important;
                margin: 20px 0;
                max-height: 300px !important;
            }
            .main-content {
                margin-right: 0 !important;
            }
            .back-to-top-content {
                right: 20px;
                bottom: 20px;
            }
        }
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            .container {
                padding: 20px;
                max-width: 100%;
            }
            #TOC {
                max-height: 250px !important;
                padding: 15px !important;
            }
        }
        </style>
        </span></span>
<span id="cb26-726"><a href="#cb26-726" aria-hidden="true" tabindex="-1"></a><span class="ss">    <meta charset="UTF-8"></span></span>
<span id="cb26-727"><a href="#cb26-727" aria-hidden="true" tabindex="-1"></a><span class="ss">    <meta name="viewport" content="width=device-width, initial-scale=1.0"></span></span>
<span id="cb26-728"><a href="#cb26-728" aria-hidden="true" tabindex="-1"></a><span class="ss">    <title></span><span class="sc">{</span>title<span class="sc">}</span><span class="ss"></title></span></span>
<span id="cb26-729"><a href="#cb26-729" aria-hidden="true" tabindex="-1"></a><span class="ss">    <style></span></span>
<span id="cb26-730"><a href="#cb26-730" aria-hidden="true" tabindex="-1"></a><span class="ss">        /* LAYOUT DE TELA COMPLETA OTIMIZADO */</span></span>
<span id="cb26-731"><a href="#cb26-731" aria-hidden="true" tabindex="-1"></a><span class="ss">        body </span><span class="ch">{{</span></span>
<span id="cb26-732"><a href="#cb26-732" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;</span></span>
<span id="cb26-733"><a href="#cb26-733" aria-hidden="true" tabindex="-1"></a><span class="ss">            line-height: 1.6;</span></span>
<span id="cb26-734"><a href="#cb26-734" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin: 0;</span></span>
<span id="cb26-735"><a href="#cb26-735" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 20px;</span></span>
<span id="cb26-736"><a href="#cb26-736" aria-hidden="true" tabindex="-1"></a><span class="ss">            background-color: #f5f5f5;</span></span>
<span id="cb26-737"><a href="#cb26-737" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #333;</span></span>
<span id="cb26-738"><a href="#cb26-738" aria-hidden="true" tabindex="-1"></a><span class="ss">            max-width: none; /* Remove limita√ß√£o de largura - TELA COMPLETA */</span></span>
<span id="cb26-739"><a href="#cb26-739" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb26-740"><a href="#cb26-740" aria-hidden="true" tabindex="-1"></a><span class="ss">        .container </span><span class="ch">{{</span></span>
<span id="cb26-741"><a href="#cb26-741" aria-hidden="true" tabindex="-1"></a><span class="ss">            max-width: 95%; /* Usa quase toda a largura dispon√≠vel */</span></span>
<span id="cb26-742"><a href="#cb26-742" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin: 0 auto;</span></span>
<span id="cb26-743"><a href="#cb26-743" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: white;</span></span>
<span id="cb26-744"><a href="#cb26-744" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 40px;</span></span>
<span id="cb26-745"><a href="#cb26-745" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 10px;</span></span>
<span id="cb26-746"><a href="#cb26-746" aria-hidden="true" tabindex="-1"></a><span class="ss">            box-shadow: 0 5px 20px rgba(0,0,0,0.1);</span></span>
<span id="cb26-747"><a href="#cb26-747" aria-hidden="true" tabindex="-1"></a><span class="ss">            position: relative; /* Para posicionamento do TOC */</span></span>
<span id="cb26-748"><a href="#cb26-748" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb26-749"><a href="#cb26-749" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb26-750"><a href="#cb26-750" aria-hidden="true" tabindex="-1"></a><span class="ss">        /* TOC FLUTUANTE MANUAL */</span></span>
<span id="cb26-751"><a href="#cb26-751" aria-hidden="true" tabindex="-1"></a><span class="ss">        .toc </span><span class="ch">{{</span></span>
<span id="cb26-752"><a href="#cb26-752" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);</span></span>
<span id="cb26-753"><a href="#cb26-753" aria-hidden="true" tabindex="-1"></a><span class="ss">            border: 1px solid #dee2e6;</span></span>
<span id="cb26-754"><a href="#cb26-754" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 8px;</span></span>
<span id="cb26-755"><a href="#cb26-755" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 20px;</span></span>
<span id="cb26-756"><a href="#cb26-756" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin: 20px 0;</span></span>
<span id="cb26-757"><a href="#cb26-757" aria-hidden="true" tabindex="-1"></a><span class="ss">            box-shadow: 0 2px 10px rgba(0,0,0,0.1);</span></span>
<span id="cb26-758"><a href="#cb26-758" aria-hidden="true" tabindex="-1"></a><span class="ss">            float: right; /* FLUTUA √Ä DIREITA */</span></span>
<span id="cb26-759"><a href="#cb26-759" aria-hidden="true" tabindex="-1"></a><span class="ss">            width: 320px; /* Largura fixa para TOC */</span></span>
<span id="cb26-760"><a href="#cb26-760" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-left: 30px;</span></span>
<span id="cb26-761"><a href="#cb26-761" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-bottom: 30px;</span></span>
<span id="cb26-762"><a href="#cb26-762" aria-hidden="true" tabindex="-1"></a><span class="ss">            position: relative;</span></span>
<span id="cb26-763"><a href="#cb26-763" aria-hidden="true" tabindex="-1"></a><span class="ss">            z-index: 100;</span></span>
<span id="cb26-764"><a href="#cb26-764" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb26-765"><a href="#cb26-765" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb26-766"><a href="#cb26-766" aria-hidden="true" tabindex="-1"></a><span class="ss">        .toc h2 </span><span class="ch">{{</span></span>
<span id="cb26-767"><a href="#cb26-767" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-top: 0;</span></span>
<span id="cb26-768"><a href="#cb26-768" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #2c3e50;</span></span>
<span id="cb26-769"><a href="#cb26-769" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-bottom: 2px solid #3498db;</span></span>
<span id="cb26-770"><a href="#cb26-770" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding-bottom: 10px;</span></span>
<span id="cb26-771"><a href="#cb26-771" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb26-772"><a href="#cb26-772" aria-hidden="true" tabindex="-1"></a><span class="ss">        .toc ul </span><span class="ch">{{</span></span>
<span id="cb26-773"><a href="#cb26-773" aria-hidden="true" tabindex="-1"></a><span class="ss">            list-style-type: none;</span></span>
<span id="cb26-774"><a href="#cb26-774" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding-left: 15px;</span></span>
<span id="cb26-775"><a href="#cb26-775" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb26-776"><a href="#cb26-776" aria-hidden="true" tabindex="-1"></a><span class="ss">        .toc ul ul </span><span class="ch">{{</span></span>
<span id="cb26-777"><a href="#cb26-777" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding-left: 25px;</span></span>
<span id="cb26-778"><a href="#cb26-778" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb26-779"><a href="#cb26-779" aria-hidden="true" tabindex="-1"></a><span class="ss">        .toc li </span><span class="ch">{{</span></span>
<span id="cb26-780"><a href="#cb26-780" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin: 8px 0;</span></span>
<span id="cb26-781"><a href="#cb26-781" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb26-782"><a href="#cb26-782" aria-hidden="true" tabindex="-1"></a><span class="ss">        .toc a </span><span class="ch">{{</span></span>
<span id="cb26-783"><a href="#cb26-783" aria-hidden="true" tabindex="-1"></a><span class="ss">            text-decoration: none;</span></span>
<span id="cb26-784"><a href="#cb26-784" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #495057;</span></span>
<span id="cb26-785"><a href="#cb26-785" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-weight: 500;</span></span>
<span id="cb26-786"><a href="#cb26-786" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: block;</span></span>
<span id="cb26-787"><a href="#cb26-787" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 4px 8px;</span></span>
<span id="cb26-788"><a href="#cb26-788" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 4px;</span></span>
<span id="cb26-789"><a href="#cb26-789" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb26-790"><a href="#cb26-790" aria-hidden="true" tabindex="-1"></a><span class="ss">        .toc a:hover </span><span class="ch">{{</span></span>
<span id="cb26-791"><a href="#cb26-791" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #007bff;</span></span>
<span id="cb26-792"><a href="#cb26-792" aria-hidden="true" tabindex="-1"></a><span class="ss">            background-color: rgba(0, 123, 255, 0.1);</span></span>
<span id="cb26-793"><a href="#cb26-793" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb26-794"><a href="#cb26-794" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb26-795"><a href="#cb26-795" aria-hidden="true" tabindex="-1"></a><span class="ss">        /* CLEARFIX PARA LAYOUT COM TOC FLUTUANTE */</span></span>
<span id="cb26-796"><a href="#cb26-796" aria-hidden="true" tabindex="-1"></a><span class="ss">        .main-content </span><span class="ch">{{</span></span>
<span id="cb26-797"><a href="#cb26-797" aria-hidden="true" tabindex="-1"></a><span class="ss">            overflow: hidden; /* PREVINE PROBLEMAS COM ELEMENTOS FLUTUANTES */</span></span>
<span id="cb26-798"><a href="#cb26-798" aria-hidden="true" tabindex="-1"></a><span class="ss">            position: relative;</span></span>
<span id="cb26-799"><a href="#cb26-799" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb26-800"><a href="#cb26-800" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb26-801"><a href="#cb26-801" aria-hidden="true" tabindex="-1"></a><span class="ss">        /* CORRE√á√ÉO CR√çTICA: Garantir visibilidade do texto */</span></span>
<span id="cb26-802"><a href="#cb26-802" aria-hidden="true" tabindex="-1"></a><span class="ss">        .sourceCode, pre, code </span><span class="ch">{{</span></span>
<span id="cb26-803"><a href="#cb26-803" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #f8f8f2 !important;</span></span>
<span id="cb26-804"><a href="#cb26-804" aria-hidden="true" tabindex="-1"></a><span class="ss">            background-color: #2d2d2d !important;</span></span>
<span id="cb26-805"><a href="#cb26-805" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb26-806"><a href="#cb26-806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-807"><a href="#cb26-807" aria-hidden="true" tabindex="-1"></a><span class="ss">        .sourceCode span </span><span class="ch">{{</span></span>
<span id="cb26-808"><a href="#cb26-808" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #f8f8f2 !important;</span></span>
<span id="cb26-809"><a href="#cb26-809" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: transparent !important;</span></span>
<span id="cb26-810"><a href="#cb26-810" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb26-811"><a href="#cb26-811" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-812"><a href="#cb26-812" aria-hidden="true" tabindex="-1"></a><span class="ss">        /* Corre√ß√£o para syntax highlighting */</span></span>
<span id="cb26-813"><a href="#cb26-813" aria-hidden="true" tabindex="-1"></a><span class="ss">        .sourceCode .kw </span><span class="ch">{{</span><span class="ss"> color: #ff79c6 !important; </span><span class="ch">}}</span></span>
<span id="cb26-814"><a href="#cb26-814" aria-hidden="true" tabindex="-1"></a><span class="ss">        .sourceCode .dt </span><span class="ch">{{</span><span class="ss"> color: #8be9fd !important; </span><span class="ch">}}</span></span>
<span id="cb26-815"><a href="#cb26-815" aria-hidden="true" tabindex="-1"></a><span class="ss">        .sourceCode .dv </span><span class="ch">{{</span><span class="ss"> color: #bd93f9 !important; </span><span class="ch">}}</span></span>
<span id="cb26-816"><a href="#cb26-816" aria-hidden="true" tabindex="-1"></a><span class="ss">        .sourceCode .bn </span><span class="ch">{{</span><span class="ss"> color: #bd93f9 !important; </span><span class="ch">}}</span></span>
<span id="cb26-817"><a href="#cb26-817" aria-hidden="true" tabindex="-1"></a><span class="ss">        .sourceCode .fl </span><span class="ch">{{</span><span class="ss"> color: #bd93f9 !important; </span><span class="ch">}}</span></span>
<span id="cb26-818"><a href="#cb26-818" aria-hidden="true" tabindex="-1"></a><span class="ss">        .sourceCode .ch </span><span class="ch">{{</span><span class="ss"> color: #f1fa8c !important; </span><span class="ch">}}</span></span>
<span id="cb26-819"><a href="#cb26-819" aria-hidden="true" tabindex="-1"></a><span class="ss">        .sourceCode .st </span><span class="ch">{{</span><span class="ss"> color: #f1fa8c !important; </span><span class="ch">}}</span></span>
<span id="cb26-820"><a href="#cb26-820" aria-hidden="true" tabindex="-1"></a><span class="ss">        .sourceCode .co </span><span class="ch">{{</span><span class="ss"> color: #6272a4 !important; </span><span class="ch">}}</span></span>
<span id="cb26-821"><a href="#cb26-821" aria-hidden="true" tabindex="-1"></a><span class="ss">        .sourceCode .ot </span><span class="ch">{{</span><span class="ss"> color: #50fa7b !important; </span><span class="ch">}}</span></span>
<span id="cb26-822"><a href="#cb26-822" aria-hidden="true" tabindex="-1"></a><span class="ss">        .sourceCode .al </span><span class="ch">{{</span><span class="ss"> color: #ff5555 !important; </span><span class="ch">}}</span></span>
<span id="cb26-823"><a href="#cb26-823" aria-hidden="true" tabindex="-1"></a><span class="ss">        .sourceCode .fu </span><span class="ch">{{</span><span class="ss"> color: #50fa7b !important; </span><span class="ch">}}</span></span>
<span id="cb26-824"><a href="#cb26-824" aria-hidden="true" tabindex="-1"></a><span class="ss">        .sourceCode .re </span><span class="ch">{{</span><span class="ss"> color: #f1fa8c !important; </span><span class="ch">}}</span></span>
<span id="cb26-825"><a href="#cb26-825" aria-hidden="true" tabindex="-1"></a><span class="ss">        .sourceCode .er </span><span class="ch">{{</span><span class="ss"> color: #ff5555 !important; </span><span class="ch">}}</span></span>
<span id="cb26-826"><a href="#cb26-826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-827"><a href="#cb26-827" aria-hidden="true" tabindex="-1"></a><span class="ss">        /* Garantir contraste para texto normal */</span></span>
<span id="cb26-828"><a href="#cb26-828" aria-hidden="true" tabindex="-1"></a><span class="ss">        body, .container </span><span class="ch">{{</span></span>
<span id="cb26-829"><a href="#cb26-829" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #2c3e50 !important;</span></span>
<span id="cb26-830"><a href="#cb26-830" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb26-831"><a href="#cb26-831" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-832"><a href="#cb26-832" aria-hidden="true" tabindex="-1"></a><span class="ss">        p, li, td, th </span><span class="ch">{{</span></span>
<span id="cb26-833"><a href="#cb26-833" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #2c3e50 !important;</span></span>
<span id="cb26-834"><a href="#cb26-834" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb26-835"><a href="#cb26-835" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb26-836"><a href="#cb26-836" aria-hidden="true" tabindex="-1"></a><span class="ss">        h1, h2, h3, h4, h5 </span><span class="ch">{{</span></span>
<span id="cb26-837"><a href="#cb26-837" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #2c3e50 !important;</span></span>
<span id="cb26-838"><a href="#cb26-838" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-top: 1.8em;</span></span>
<span id="cb26-839"><a href="#cb26-839" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb26-840"><a href="#cb26-840" aria-hidden="true" tabindex="-1"></a><span class="ss">        h1 </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb26-841"><a href="#cb26-841" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-bottom: 3px solid #3498db; </span></span>
<span id="cb26-842"><a href="#cb26-842" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding-bottom: 15px; </span></span>
<span id="cb26-843"><a href="#cb26-843" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #2c3e50 !important;</span></span>
<span id="cb26-844"><a href="#cb26-844" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 2.2em;</span></span>
<span id="cb26-845"><a href="#cb26-845" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb26-846"><a href="#cb26-846" aria-hidden="true" tabindex="-1"></a><span class="ss">        h2 </span><span class="ch">{{</span></span>
<span id="cb26-847"><a href="#cb26-847" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-left: 4px solid #3498db;</span></span>
<span id="cb26-848"><a href="#cb26-848" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding-left: 15px;</span></span>
<span id="cb26-849"><a href="#cb26-849" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-top: 2em;</span></span>
<span id="cb26-850"><a href="#cb26-850" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb26-851"><a href="#cb26-851" aria-hidden="true" tabindex="-1"></a><span class="ss">        code </span><span class="ch">{{</span></span>
<span id="cb26-852"><a href="#cb26-852" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #f4f4f4 !important;</span></span>
<span id="cb26-853"><a href="#cb26-853" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 3px 8px;</span></span>
<span id="cb26-854"><a href="#cb26-854" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 4px;</span></span>
<span id="cb26-855"><a href="#cb26-855" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;</span></span>
<span id="cb26-856"><a href="#cb26-856" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #c7254e !important;</span></span>
<span id="cb26-857"><a href="#cb26-857" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.9em;</span></span>
<span id="cb26-858"><a href="#cb26-858" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb26-859"><a href="#cb26-859" aria-hidden="true" tabindex="-1"></a><span class="ss">        pre </span><span class="ch">{{</span></span>
<span id="cb26-860"><a href="#cb26-860" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #2d2d2d !important;</span></span>
<span id="cb26-861"><a href="#cb26-861" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #f8f8f2 !important;</span></span>
<span id="cb26-862"><a href="#cb26-862" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 20px;</span></span>
<span id="cb26-863"><a href="#cb26-863" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 8px;</span></span>
<span id="cb26-864"><a href="#cb26-864" aria-hidden="true" tabindex="-1"></a><span class="ss">            overflow-x: auto;</span></span>
<span id="cb26-865"><a href="#cb26-865" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-left: 5px solid #3498db;</span></span>
<span id="cb26-866"><a href="#cb26-866" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;</span></span>
<span id="cb26-867"><a href="#cb26-867" aria-hidden="true" tabindex="-1"></a><span class="ss">            line-height: 1.4;</span></span>
<span id="cb26-868"><a href="#cb26-868" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb26-869"><a href="#cb26-869" aria-hidden="true" tabindex="-1"></a><span class="ss">        pre code </span><span class="ch">{{</span></span>
<span id="cb26-870"><a href="#cb26-870" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: none !important;</span></span>
<span id="cb26-871"><a href="#cb26-871" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: inherit !important;</span></span>
<span id="cb26-872"><a href="#cb26-872" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 0 !important;</span></span>
<span id="cb26-873"><a href="#cb26-873" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb26-874"><a href="#cb26-874" aria-hidden="true" tabindex="-1"></a><span class="ss">        blockquote </span><span class="ch">{{</span></span>
<span id="cb26-875"><a href="#cb26-875" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-left: 4px solid #3498db;</span></span>
<span id="cb26-876"><a href="#cb26-876" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin: 25px 0;</span></span>
<span id="cb26-877"><a href="#cb26-877" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding-left: 25px;</span></span>
<span id="cb26-878"><a href="#cb26-878" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #7f8c8d;</span></span>
<span id="cb26-879"><a href="#cb26-879" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-style: italic;</span></span>
<span id="cb26-880"><a href="#cb26-880" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #f8f9fa;</span></span>
<span id="cb26-881"><a href="#cb26-881" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 20px;</span></span>
<span id="cb26-882"><a href="#cb26-882" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 0 8px 8px 0;</span></span>
<span id="cb26-883"><a href="#cb26-883" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb26-884"><a href="#cb26-884" aria-hidden="true" tabindex="-1"></a><span class="ss">        table </span><span class="ch">{{</span></span>
<span id="cb26-885"><a href="#cb26-885" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-collapse: collapse;</span></span>
<span id="cb26-886"><a href="#cb26-886" aria-hidden="true" tabindex="-1"></a><span class="ss">            width: 100%;</span></span>
<span id="cb26-887"><a href="#cb26-887" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin: 1.5em 0;</span></span>
<span id="cb26-888"><a href="#cb26-888" aria-hidden="true" tabindex="-1"></a><span class="ss">            box-shadow: 0 2px 5px rgba(0,0,0,0.1);</span></span>
<span id="cb26-889"><a href="#cb26-889" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 8px;</span></span>
<span id="cb26-890"><a href="#cb26-890" aria-hidden="true" tabindex="-1"></a><span class="ss">            overflow: hidden;</span></span>
<span id="cb26-891"><a href="#cb26-891" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb26-892"><a href="#cb26-892" aria-hidden="true" tabindex="-1"></a><span class="ss">        th, td </span><span class="ch">{{</span></span>
<span id="cb26-893"><a href="#cb26-893" aria-hidden="true" tabindex="-1"></a><span class="ss">            border: 1px solid #ddd;</span></span>
<span id="cb26-894"><a href="#cb26-894" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 15px;</span></span>
<span id="cb26-895"><a href="#cb26-895" aria-hidden="true" tabindex="-1"></a><span class="ss">            text-align: left;</span></span>
<span id="cb26-896"><a href="#cb26-896" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb26-897"><a href="#cb26-897" aria-hidden="true" tabindex="-1"></a><span class="ss">        th </span><span class="ch">{{</span></span>
<span id="cb26-898"><a href="#cb26-898" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: linear-gradient(135deg, #3498db, #2980b9);</span></span>
<span id="cb26-899"><a href="#cb26-899" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: white;</span></span>
<span id="cb26-900"><a href="#cb26-900" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-weight: bold;</span></span>
<span id="cb26-901"><a href="#cb26-901" aria-hidden="true" tabindex="-1"></a><span class="ss">            text-transform: uppercase;</span></span>
<span id="cb26-902"><a href="#cb26-902" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.9em;</span></span>
<span id="cb26-903"><a href="#cb26-903" aria-hidden="true" tabindex="-1"></a><span class="ss">            letter-spacing: 0.5px;</span></span>
<span id="cb26-904"><a href="#cb26-904" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb26-905"><a href="#cb26-905" aria-hidden="true" tabindex="-1"></a><span class="ss">        tr:nth-child(even) </span><span class="ch">{{</span></span>
<span id="cb26-906"><a href="#cb26-906" aria-hidden="true" tabindex="-1"></a><span class="ss">            background-color: #f8f9fa;</span></span>
<span id="cb26-907"><a href="#cb26-907" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb26-908"><a href="#cb26-908" aria-hidden="true" tabindex="-1"></a><span class="ss">        tr:hover </span><span class="ch">{{</span></span>
<span id="cb26-909"><a href="#cb26-909" aria-hidden="true" tabindex="-1"></a><span class="ss">            background-color: #e3f2fd;</span></span>
<span id="cb26-910"><a href="#cb26-910" aria-hidden="true" tabindex="-1"></a><span class="ss">            transition: background-color 0.2s ease;</span></span>
<span id="cb26-911"><a href="#cb26-911" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb26-912"><a href="#cb26-912" aria-hidden="true" tabindex="-1"></a><span class="ss">        .math </span><span class="ch">{{</span></span>
<span id="cb26-913"><a href="#cb26-913" aria-hidden="true" tabindex="-1"></a><span class="ss">            text-align: center;</span></span>
<span id="cb26-914"><a href="#cb26-914" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin: 1.5em 0;</span></span>
<span id="cb26-915"><a href="#cb26-915" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 15px;</span></span>
<span id="cb26-916"><a href="#cb26-916" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #f8f9fa;</span></span>
<span id="cb26-917"><a href="#cb26-917" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 8px;</span></span>
<span id="cb26-918"><a href="#cb26-918" aria-hidden="true" tabindex="-1"></a><span class="ss">            overflow-x: auto;</span></span>
<span id="cb26-919"><a href="#cb26-919" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb26-920"><a href="#cb26-920" aria-hidden="true" tabindex="-1"></a><span class="ss">        .message-header </span><span class="ch">{{</span></span>
<span id="cb26-921"><a href="#cb26-921" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: flex;</span></span>
<span id="cb26-922"><a href="#cb26-922" aria-hidden="true" tabindex="-1"></a><span class="ss">            justify-content: space-between;</span></span>
<span id="cb26-923"><a href="#cb26-923" aria-hidden="true" tabindex="-1"></a><span class="ss">            align-items: center;</span></span>
<span id="cb26-924"><a href="#cb26-924" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-bottom: 15px;</span></span>
<span id="cb26-925"><a href="#cb26-925" aria-hidden="true" tabindex="-1"></a><span class="ss">            flex-wrap: wrap;</span></span>
<span id="cb26-926"><a href="#cb26-926" aria-hidden="true" tabindex="-1"></a><span class="ss">            gap: 10px;</span></span>
<span id="cb26-927"><a href="#cb26-927" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb26-928"><a href="#cb26-928" aria-hidden="true" tabindex="-1"></a><span class="ss">        .author </span><span class="ch">{{</span></span>
<span id="cb26-929"><a href="#cb26-929" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-weight: bold;</span></span>
<span id="cb26-930"><a href="#cb26-930" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #2c3e50 !important;</span></span>
<span id="cb26-931"><a href="#cb26-931" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 1.1em;</span></span>
<span id="cb26-932"><a href="#cb26-932" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb26-933"><a href="#cb26-933" aria-hidden="true" tabindex="-1"></a><span class="ss">        .timestamp </span><span class="ch">{{</span></span>
<span id="cb26-934"><a href="#cb26-934" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #7f8c8d;</span></span>
<span id="cb26-935"><a href="#cb26-935" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.9em;</span></span>
<span id="cb26-936"><a href="#cb26-936" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #e9ecef;</span></span>
<span id="cb26-937"><a href="#cb26-937" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 4px 8px;</span></span>
<span id="cb26-938"><a href="#cb26-938" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 4px;</span></span>
<span id="cb26-939"><a href="#cb26-939" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb26-940"><a href="#cb26-940" aria-hidden="true" tabindex="-1"></a><span class="ss">        .message-content </span><span class="ch">{{</span></span>
<span id="cb26-941"><a href="#cb26-941" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #f8f9fa;</span></span>
<span id="cb26-942"><a href="#cb26-942" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 20px;</span></span>
<span id="cb26-943"><a href="#cb26-943" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 8px;</span></span>
<span id="cb26-944"><a href="#cb26-944" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-left: 4px solid #3498db;</span></span>
<span id="cb26-945"><a href="#cb26-945" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-bottom: 20px;</span></span>
<span id="cb26-946"><a href="#cb26-946" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb26-947"><a href="#cb26-947" aria-hidden="true" tabindex="-1"></a><span class="ss">        .metadata </span><span class="ch">{{</span></span>
<span id="cb26-948"><a href="#cb26-948" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #e8f4fd;</span></span>
<span id="cb26-949"><a href="#cb26-949" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 15px;</span></span>
<span id="cb26-950"><a href="#cb26-950" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 8px;</span></span>
<span id="cb26-951"><a href="#cb26-951" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-bottom: 25px;</span></span>
<span id="cb26-952"><a href="#cb26-952" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-left: 4px solid #3498db;</span></span>
<span id="cb26-953"><a href="#cb26-953" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb26-954"><a href="#cb26-954" aria-hidden="true" tabindex="-1"></a><span class="ss">        .metadata h3 </span><span class="ch">{{</span></span>
<span id="cb26-955"><a href="#cb26-955" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-top: 0;</span></span>
<span id="cb26-956"><a href="#cb26-956" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #2c3e50 !important;</span></span>
<span id="cb26-957"><a href="#cb26-957" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb26-958"><a href="#cb26-958" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb26-959"><a href="#cb26-959" aria-hidden="true" tabindex="-1"></a><span class="ss">        /* Melhorias responsivas */</span></span>
<span id="cb26-960"><a href="#cb26-960" aria-hidden="true" tabindex="-1"></a><span class="ss">        @media (max-width: 1400px) </span><span class="ch">{{</span></span>
<span id="cb26-961"><a href="#cb26-961" aria-hidden="true" tabindex="-1"></a><span class="ss">            .container </span><span class="ch">{{</span></span>
<span id="cb26-962"><a href="#cb26-962" aria-hidden="true" tabindex="-1"></a><span class="ss">                max-width: 98%;</span></span>
<span id="cb26-963"><a href="#cb26-963" aria-hidden="true" tabindex="-1"></a><span class="ss">                padding: 30px;</span></span>
<span id="cb26-964"><a href="#cb26-964" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span><span class="ch">}}</span></span>
<span id="cb26-965"><a href="#cb26-965" aria-hidden="true" tabindex="-1"></a><span class="ss">            .toc </span><span class="ch">{{</span></span>
<span id="cb26-966"><a href="#cb26-966" aria-hidden="true" tabindex="-1"></a><span class="ss">                width: 280px; /* Reduz um pouco em telas menores */</span></span>
<span id="cb26-967"><a href="#cb26-967" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span><span class="ch">}}</span></span>
<span id="cb26-968"><a href="#cb26-968" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb26-969"><a href="#cb26-969" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb26-970"><a href="#cb26-970" aria-hidden="true" tabindex="-1"></a><span class="ss">        @media (max-width: 1200px) </span><span class="ch">{{</span></span>
<span id="cb26-971"><a href="#cb26-971" aria-hidden="true" tabindex="-1"></a><span class="ss">            .toc </span><span class="ch">{{</span></span>
<span id="cb26-972"><a href="#cb26-972" aria-hidden="true" tabindex="-1"></a><span class="ss">                float: none;</span></span>
<span id="cb26-973"><a href="#cb26-973" aria-hidden="true" tabindex="-1"></a><span class="ss">                width: auto;</span></span>
<span id="cb26-974"><a href="#cb26-974" aria-hidden="true" tabindex="-1"></a><span class="ss">                margin: 20px 0;</span></span>
<span id="cb26-975"><a href="#cb26-975" aria-hidden="true" tabindex="-1"></a><span class="ss">                position: static;</span></span>
<span id="cb26-976"><a href="#cb26-976" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span><span class="ch">}}</span></span>
<span id="cb26-977"><a href="#cb26-977" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb26-978"><a href="#cb26-978" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb26-979"><a href="#cb26-979" aria-hidden="true" tabindex="-1"></a><span class="ss">        @media (max-width: 768px) </span><span class="ch">{{</span></span>
<span id="cb26-980"><a href="#cb26-980" aria-hidden="true" tabindex="-1"></a><span class="ss">            .container </span><span class="ch">{{</span></span>
<span id="cb26-981"><a href="#cb26-981" aria-hidden="true" tabindex="-1"></a><span class="ss">                padding: 20px;</span></span>
<span id="cb26-982"><a href="#cb26-982" aria-hidden="true" tabindex="-1"></a><span class="ss">                max-width: 100%;</span></span>
<span id="cb26-983"><a href="#cb26-983" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span><span class="ch">}}</span></span>
<span id="cb26-984"><a href="#cb26-984" aria-hidden="true" tabindex="-1"></a><span class="ss">            body </span><span class="ch">{{</span></span>
<span id="cb26-985"><a href="#cb26-985" aria-hidden="true" tabindex="-1"></a><span class="ss">                padding: 10px;</span></span>
<span id="cb26-986"><a href="#cb26-986" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span><span class="ch">}}</span></span>
<span id="cb26-987"><a href="#cb26-987" aria-hidden="true" tabindex="-1"></a><span class="ss">            h1 </span><span class="ch">{{</span></span>
<span id="cb26-988"><a href="#cb26-988" aria-hidden="true" tabindex="-1"></a><span class="ss">                font-size: 1.8em;</span></span>
<span id="cb26-989"><a href="#cb26-989" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span><span class="ch">}}</span></span>
<span id="cb26-990"><a href="#cb26-990" aria-hidden="true" tabindex="-1"></a><span class="ss">            .message-header </span><span class="ch">{{</span></span>
<span id="cb26-991"><a href="#cb26-991" aria-hidden="true" tabindex="-1"></a><span class="ss">                flex-direction: column;</span></span>
<span id="cb26-992"><a href="#cb26-992" aria-hidden="true" tabindex="-1"></a><span class="ss">                align-items: flex-start;</span></span>
<span id="cb26-993"><a href="#cb26-993" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span><span class="ch">}}</span></span>
<span id="cb26-994"><a href="#cb26-994" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb26-995"><a href="#cb26-995" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb26-996"><a href="#cb26-996" aria-hidden="true" tabindex="-1"></a><span class="ss">        /* Scroll suave */</span></span>
<span id="cb26-997"><a href="#cb26-997" aria-hidden="true" tabindex="-1"></a><span class="ss">        html </span><span class="ch">{{</span></span>
<span id="cb26-998"><a href="#cb26-998" aria-hidden="true" tabindex="-1"></a><span class="ss">            scroll-behavior: smooth;</span></span>
<span id="cb26-999"><a href="#cb26-999" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb26-1000"><a href="#cb26-1000" aria-hidden="true" tabindex="-1"></a><span class="ss">    </style></span></span>
<span id="cb26-1001"><a href="#cb26-1001" aria-hidden="true" tabindex="-1"></a><span class="ss"></head></span></span>
<span id="cb26-1002"><a href="#cb26-1002" aria-hidden="true" tabindex="-1"></a><span class="ss"><body></span></span>
<span id="cb26-1003"><a href="#cb26-1003" aria-hidden="true" tabindex="-1"></a><span class="ss">    <div class="container"></span></span>
<span id="cb26-1004"><a href="#cb26-1004" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="sc">{</span>content<span class="sc">}</span></span>
<span id="cb26-1005"><a href="#cb26-1005" aria-hidden="true" tabindex="-1"></a><span class="ss">    </div></span></span>
<span id="cb26-1006"><a href="#cb26-1006" aria-hidden="true" tabindex="-1"></a><span class="ss">    <script></span></span>
<span id="cb26-1007"><a href="#cb26-1007" aria-hidden="true" tabindex="-1"></a><span class="ss">        // Configura√ß√£o MathJax para melhor renderiza√ß√£o</span></span>
<span id="cb26-1008"><a href="#cb26-1008" aria-hidden="true" tabindex="-1"></a><span class="ss">        window.MathJax = </span><span class="ch">{{</span></span>
<span id="cb26-1009"><a href="#cb26-1009" aria-hidden="true" tabindex="-1"></a><span class="ss">            tex: </span><span class="ch">{{</span></span>
<span id="cb26-1010"><a href="#cb26-1010" aria-hidden="true" tabindex="-1"></a><span class="ss">                inlineMath: [['$', '$'], ['</span><span class="ch">\\</span><span class="ss">(', '</span><span class="ch">\\</span><span class="ss">)']],</span></span>
<span id="cb26-1011"><a href="#cb26-1011" aria-hidden="true" tabindex="-1"></a><span class="ss">                displayMath: [['$$', '$$'], ['</span><span class="ch">\\</span><span class="ss">[', '</span><span class="ch">\\</span><span class="ss">]']],</span></span>
<span id="cb26-1012"><a href="#cb26-1012" aria-hidden="true" tabindex="-1"></a><span class="ss">                processEscapes: true,</span></span>
<span id="cb26-1013"><a href="#cb26-1013" aria-hidden="true" tabindex="-1"></a><span class="ss">                tags: 'ams'</span></span>
<span id="cb26-1014"><a href="#cb26-1014" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span><span class="ch">}}</span><span class="ss">,</span></span>
<span id="cb26-1015"><a href="#cb26-1015" aria-hidden="true" tabindex="-1"></a><span class="ss">            options: </span><span class="ch">{{</span></span>
<span id="cb26-1016"><a href="#cb26-1016" aria-hidden="true" tabindex="-1"></a><span class="ss">                skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre'],</span></span>
<span id="cb26-1017"><a href="#cb26-1017" aria-hidden="true" tabindex="-1"></a><span class="ss">                renderActions: </span><span class="ch">{{</span></span>
<span id="cb26-1018"><a href="#cb26-1018" aria-hidden="true" tabindex="-1"></a><span class="ss">                    addMenu: [0, '', '']</span></span>
<span id="cb26-1019"><a href="#cb26-1019" aria-hidden="true" tabindex="-1"></a><span class="ss">                </span><span class="ch">}}</span></span>
<span id="cb26-1020"><a href="#cb26-1020" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span><span class="ch">}}</span><span class="ss">,</span></span>
<span id="cb26-1021"><a href="#cb26-1021" aria-hidden="true" tabindex="-1"></a><span class="ss">            startup: </span><span class="ch">{{</span></span>
<span id="cb26-1022"><a href="#cb26-1022" aria-hidden="true" tabindex="-1"></a><span class="ss">                pageReady() </span><span class="ch">{{</span></span>
<span id="cb26-1023"><a href="#cb26-1023" aria-hidden="true" tabindex="-1"></a><span class="ss">                    return MathJax.startup.defaultPageReady().then(() => </span><span class="ch">{{</span></span>
<span id="cb26-1024"><a href="#cb26-1024" aria-hidden="true" tabindex="-1"></a><span class="ss">                        console.log('MathJax carregado com sucesso');</span></span>
<span id="cb26-1025"><a href="#cb26-1025" aria-hidden="true" tabindex="-1"></a><span class="ss">                    </span><span class="ch">}}</span><span class="ss">);</span></span>
<span id="cb26-1026"><a href="#cb26-1026" aria-hidden="true" tabindex="-1"></a><span class="ss">                </span><span class="ch">}}</span></span>
<span id="cb26-1027"><a href="#cb26-1027" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span><span class="ch">}}</span></span>
<span id="cb26-1028"><a href="#cb26-1028" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span><span class="ss">;</span></span>
<span id="cb26-1029"><a href="#cb26-1029" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb26-1030"><a href="#cb26-1030" aria-hidden="true" tabindex="-1"></a><span class="ss">        // Script para destacar se√ß√£o ativa no TOC (se existir)</span></span>
<span id="cb26-1031"><a href="#cb26-1031" aria-hidden="true" tabindex="-1"></a><span class="ss">        document.addEventListener('DOMContentLoaded', function() </span><span class="ch">{{</span></span>
<span id="cb26-1032"><a href="#cb26-1032" aria-hidden="true" tabindex="-1"></a><span class="ss">            const tocLinks = document.querySelectorAll('#TOC a, .toc a');</span></span>
<span id="cb26-1033"><a href="#cb26-1033" aria-hidden="true" tabindex="-1"></a><span class="ss">            const sections = document.querySelectorAll('h1, h2, h3, h4, h5');</span></span>
<span id="cb26-1034"><a href="#cb26-1034" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span></span>
<span id="cb26-1035"><a href="#cb26-1035" aria-hidden="true" tabindex="-1"></a><span class="ss">            function highlightActiveSection() </span><span class="ch">{{</span></span>
<span id="cb26-1036"><a href="#cb26-1036" aria-hidden="true" tabindex="-1"></a><span class="ss">                let currentSection = '';</span></span>
<span id="cb26-1037"><a href="#cb26-1037" aria-hidden="true" tabindex="-1"></a><span class="ss">                const scrollY = window.pageYOffset;</span></span>
<span id="cb26-1038"><a href="#cb26-1038" aria-hidden="true" tabindex="-1"></a><span class="ss">                </span></span>
<span id="cb26-1039"><a href="#cb26-1039" aria-hidden="true" tabindex="-1"></a><span class="ss">                sections.forEach(section => </span><span class="ch">{{</span></span>
<span id="cb26-1040"><a href="#cb26-1040" aria-hidden="true" tabindex="-1"></a><span class="ss">                    const sectionTop = section.offsetTop - 100;</span></span>
<span id="cb26-1041"><a href="#cb26-1041" aria-hidden="true" tabindex="-1"></a><span class="ss">                    if (scrollY >= sectionTop) </span><span class="ch">{{</span></span>
<span id="cb26-1042"><a href="#cb26-1042" aria-hidden="true" tabindex="-1"></a><span class="ss">                        currentSection = section.getAttribute('id');</span></span>
<span id="cb26-1043"><a href="#cb26-1043" aria-hidden="true" tabindex="-1"></a><span class="ss">                    </span><span class="ch">}}</span></span>
<span id="cb26-1044"><a href="#cb26-1044" aria-hidden="true" tabindex="-1"></a><span class="ss">                </span><span class="ch">}}</span><span class="ss">);</span></span>
<span id="cb26-1045"><a href="#cb26-1045" aria-hidden="true" tabindex="-1"></a><span class="ss">                </span></span>
<span id="cb26-1046"><a href="#cb26-1046" aria-hidden="true" tabindex="-1"></a><span class="ss">                tocLinks.forEach(link => </span><span class="ch">{{</span></span>
<span id="cb26-1047"><a href="#cb26-1047" aria-hidden="true" tabindex="-1"></a><span class="ss">                    link.classList.remove('active');</span></span>
<span id="cb26-1048"><a href="#cb26-1048" aria-hidden="true" tabindex="-1"></a><span class="ss">                    if (link.getAttribute('href') === '#' + currentSection) </span><span class="ch">{{</span></span>
<span id="cb26-1049"><a href="#cb26-1049" aria-hidden="true" tabindex="-1"></a><span class="ss">                        link.classList.add('active');</span></span>
<span id="cb26-1050"><a href="#cb26-1050" aria-hidden="true" tabindex="-1"></a><span class="ss">                    </span><span class="ch">}}</span></span>
<span id="cb26-1051"><a href="#cb26-1051" aria-hidden="true" tabindex="-1"></a><span class="ss">                </span><span class="ch">}}</span><span class="ss">);</span></span>
<span id="cb26-1052"><a href="#cb26-1052" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span><span class="ch">}}</span></span>
<span id="cb26-1053"><a href="#cb26-1053" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span></span>
<span id="cb26-1054"><a href="#cb26-1054" aria-hidden="true" tabindex="-1"></a><span class="ss">            if (tocLinks.length > 0) </span><span class="ch">{{</span></span>
<span id="cb26-1055"><a href="#cb26-1055" aria-hidden="true" tabindex="-1"></a><span class="ss">                window.addEventListener('scroll', highlightActiveSection);</span></span>
<span id="cb26-1056"><a href="#cb26-1056" aria-hidden="true" tabindex="-1"></a><span class="ss">                highlightActiveSection(); // Chamar inicialmente</span></span>
<span id="cb26-1057"><a href="#cb26-1057" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span><span class="ch">}}</span></span>
<span id="cb26-1058"><a href="#cb26-1058" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span><span class="ss">);</span></span>
<span id="cb26-1059"><a href="#cb26-1059" aria-hidden="true" tabindex="-1"></a><span class="ss">    </script></span></span>
<span id="cb26-1060"><a href="#cb26-1060" aria-hidden="true" tabindex="-1"></a><span class="ss">    <script src="</span><span class="sc">{</span>mathjax_src<span class="sc">}</span><span class="ss">" async></script></span></span>
<span id="cb26-1061"><a href="#cb26-1061" aria-hidden="true" tabindex="-1"></a><span class="ss">
        <script id="fixed-toc-script">
        document.addEventListener('DOMContentLoaded', function() {
            const toc = document.getElementById('TOC');
            if (toc) {
                const tocTitle = toc.querySelector('h2');
                if (tocTitle) {
                    const toggleBtn = document.createElement('button');
                    toggleBtn.innerHTML = '‚ò∞';
                    toggleBtn.className = 'toc-toggle-btn';
                    toggleBtn.title = 'Minimizar/Expandir TOC';
                    let isMinimized = false;
                    toggleBtn.addEventListener('click', function(e) {
                        e.stopPropagation();
                        isMinimized = !isMinimized;
                        if (isMinimized) {
                            toc.classList.add('toc-minimized');
                        } else {
                            toc.classList.remove('toc-minimized');
                        }
                    });
                    tocTitle.appendChild(toggleBtn);
                }
            }
            
            // SCROLLSPY
            const sections = document.querySelectorAll('h1, h2, h3, h4, h5');
            const tocLinks = document.querySelectorAll('#TOC a');
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const id = entry.target.getAttribute('id');
                        tocLinks.forEach(link => {
                            link.classList.remove('active');
                            if (link.getAttribute('href') === '#' + id) {
                                link.classList.add('active');
                            }
                        });
                    }
                });
            }, { 
                rootMargin: '-20% 0px -60% 0px', 
                threshold: 0 
            });
            
            sections.forEach(section => {
                if (section.id) observer.observe(section);
            });
            
            // Scroll suave
            tocLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const targetId = link.getAttribute('href').substring(1);
                    const targetElement = document.getElementById(targetId);
                    if (targetElement) {
                        const offsetTop = targetElement.offsetTop - 80;
                        window.scrollTo({ top: offsetTop, behavior: 'smooth' });
                    }
                });
            });
            
            // BOT√ÉO VOLTAR AO TOPO
            const backToTopBtn = document.createElement('button');
            backToTopBtn.className = 'back-to-top-content';
            backToTopBtn.innerHTML = '‚Üë';
            backToTopBtn.title = 'Voltar ao Topo';
            document.body.appendChild(backToTopBtn);
            
            window.addEventListener('scroll', () => {
                if (window.pageYOffset > 300) {
                    backToTopBtn.classList.add('show');
                } else {
                    backToTopBtn.classList.remove('show');
                }
            });
            
            backToTopBtn.addEventListener('click', () => {
                window.scrollTo({ top: 0, behavior: 'smooth' });
            });
        });
        </script>
        
</body></span></span>
<span id="cb26-1062"><a href="#cb26-1062" aria-hidden="true" tabindex="-1"></a><span class="ss"></html>"""</span></span>
<span id="cb26-1063"><a href="#cb26-1063" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1064"><a href="#cb26-1064" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _create_basic_html(<span class="va">self</span>, content: <span class="bu">str</span>, title: <span class="bu">str</span>) <span class="op">-></span> <span class="bu">str</span>:</span>
<span id="cb26-1065"><a href="#cb26-1065" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""HTML b√°sico de √∫ltimo recurso com MathJax"""</span></span>
<span id="cb26-1066"><a href="#cb26-1066" aria-hidden="true" tabindex="-1"></a>        mathjax_src <span class="op">=</span> <span class="st">"assets/tex-mml-chtml.js"</span> <span class="cf">if</span> Path(<span class="st">"assets/tex-mml-chtml.js"</span>).exists() <span class="cf">else</span> <span class="st">"https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"</span></span>
<span id="cb26-1067"><a href="#cb26-1067" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb26-1068"><a href="#cb26-1068" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="ss">f"""<!DOCTYPE html></span></span>
<span id="cb26-1069"><a href="#cb26-1069" aria-hidden="true" tabindex="-1"></a><span class="ss"><html></span></span>
<span id="cb26-1070"><a href="#cb26-1070" aria-hidden="true" tabindex="-1"></a><span class="ss"><head>

        <style id="fixed-toc-styles">
        /* === ESTILOS PRINCIPAIS - TOC FIXO √Ä DIREITA === */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
            scroll-behavior: smooth;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            position: relative;
        }
        /* === TOC FIXO √Ä DIREITA - POSI√á√ÉO CORRIGIDA === */
        #TOC {
            position: fixed !important;
            top: 50% !important;
            right: 20px !important;
            transform: translateY(-50%) !important;
            width: 320px !important;
            max-height: 80vh !important;
            overflow-y: auto !important;
            z-index: 1000 !important;
            background: rgba(255, 255, 255, 0.98) !important;
            padding: 20px !important;
            border-radius: 12px !important;
            box-shadow: 0 8px 32px rgba(0,0,0,0.15) !important;
            border: 1px solid #e0e0e0 !important;
            backdrop-filter: blur(10px) !important;
            transition: all 0.3s ease-in-out !important;
        }
        #TOC.toc-minimized {
            transform: translateY(-50%) translateX(calc(320px - 50px)) !important;
            opacity: 0.3;
            width: 50px !important;
            overflow: hidden;
        }
        #TOC.toc-minimized > *:not(.toc-toggle-btn) {
            display: none !important;
        }
        #TOC h2 {
            margin-top: 0;
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
            font-size: 1.2em;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .toc-toggle-btn {
            background: none;
            border: none;
            font-size: 1.2em;
            cursor: pointer;
            padding: 5px;
            border-radius: 4px;
            transition: background-color 0.2s;
        }
        .toc-toggle-btn:hover {
            background-color: rgba(0,0,0,0.1);
        }
        #TOC ul {
            list-style-type: none;
            padding-left: 15px;
            margin: 10px 0;
        }
        #TOC ul ul {
            padding-left: 20px;
        }
        #TOC li {
            margin: 8px 0;
            line-height: 1.4;
        }
        #TOC a {
            text-decoration: none;
            color: #495057;
            font-weight: 500;
            transition: all 0.2s ease;
            display: block;
            padding: 6px 10px;
            border-radius: 6px;
            border-left: 3px solid transparent;
        }
        #TOC a:hover {
            color: #007bff;
            background-color: rgba(0, 123, 255, 0.1);
            border-left-color: #007bff;
        }
        #TOC a.active {
            background-color: #007bff !important;
            color: white !important;
            font-weight: bold;
            border-left-color: #0056b3;
        }
        /* Conte√∫do principal com margem para o TOC */
        .main-content {
            margin-right: calc(320px + 40px) !important;
        }
        /* Barra de scroll personalizada APENAS para TOC */
        #TOC::-webkit-scrollbar {
            width: 8px;
        }
        #TOC::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }
        #TOC::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 4px;
        }
        #TOC::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }
        /* === BOT√ÉO VOLTAR AO TOPO (HTMLs individuais) === */
        .back-to-top-content {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            font-size: 18px;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 999;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .back-to-top-content.show {
            opacity: 1;
            transform: translateY(0);
        }
        .back-to-top-content:hover {
            background: #0056b3;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0,0,0,0.2);
        }
        /* === RESPONSIVIDADE === */
        @media (max-width: 1400px) {
            .container {
                max-width: 95%;
                padding: 30px;
            }
            #TOC {
                width: 280px !important;
            }
            .main-content {
                margin-right: 320px !important;
            }
        }
        @media (max-width: 1200px) {
            #TOC {
                width: 260px !important;
                right: 15px !important;
            }
            .main-content {
                margin-right: 300px !important;
            }
        }
        @media (max-width: 992px) {
            #TOC {
                position: relative !important;
                width: 100% !important;
                right: 0 !important;
                top: 0 !important;
                transform: none !important;
                margin: 20px 0;
                max-height: 300px !important;
            }
            .main-content {
                margin-right: 0 !important;
            }
            .back-to-top-content {
                right: 20px;
                bottom: 20px;
            }
        }
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            .container {
                padding: 20px;
                max-width: 100%;
            }
            #TOC {
                max-height: 250px !important;
                padding: 15px !important;
            }
        }
        </style>
        </span></span>
<span id="cb26-1071"><a href="#cb26-1071" aria-hidden="true" tabindex="-1"></a><span class="ss">    <meta charset="UTF-8"></span></span>
<span id="cb26-1072"><a href="#cb26-1072" aria-hidden="true" tabindex="-1"></a><span class="ss">    <title></span><span class="sc">{</span>title<span class="sc">}</span><span class="ss"></title></span></span>
<span id="cb26-1073"><a href="#cb26-1073" aria-hidden="true" tabindex="-1"></a><span class="ss">    <style></span></span>
<span id="cb26-1074"><a href="#cb26-1074" aria-hidden="true" tabindex="-1"></a><span class="ss">        body </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb26-1075"><a href="#cb26-1075" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; </span></span>
<span id="cb26-1076"><a href="#cb26-1076" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 20px; </span></span>
<span id="cb26-1077"><a href="#cb26-1077" aria-hidden="true" tabindex="-1"></a><span class="ss">            line-height: 1.6;</span></span>
<span id="cb26-1078"><a href="#cb26-1078" aria-hidden="true" tabindex="-1"></a><span class="ss">            background-color: #f5f5f5;</span></span>
<span id="cb26-1079"><a href="#cb26-1079" aria-hidden="true" tabindex="-1"></a><span class="ss">            max-width: none; /* Remove limita√ß√£o de largura - TELA COMPLETA */</span></span>
<span id="cb26-1080"><a href="#cb26-1080" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #333 !important;</span></span>
<span id="cb26-1081"><a href="#cb26-1081" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb26-1082"><a href="#cb26-1082" aria-hidden="true" tabindex="-1"></a><span class="ss">        pre </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb26-1083"><a href="#cb26-1083" aria-hidden="true" tabindex="-1"></a><span class="ss">            white-space: pre-wrap; </span></span>
<span id="cb26-1084"><a href="#cb26-1084" aria-hidden="true" tabindex="-1"></a><span class="ss">            word-wrap: break-word; </span></span>
<span id="cb26-1085"><a href="#cb26-1085" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: white;</span></span>
<span id="cb26-1086"><a href="#cb26-1086" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 15px;</span></span>
<span id="cb26-1087"><a href="#cb26-1087" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 5px;</span></span>
<span id="cb26-1088"><a href="#cb26-1088" aria-hidden="true" tabindex="-1"></a><span class="ss">            border: 1px solid #ddd;</span></span>
<span id="cb26-1089"><a href="#cb26-1089" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #333 !important;</span></span>
<span id="cb26-1090"><a href="#cb26-1090" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb26-1091"><a href="#cb26-1091" aria-hidden="true" tabindex="-1"></a><span class="ss">        code </span><span class="ch">{{</span></span>
<span id="cb26-1092"><a href="#cb26-1092" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #333 !important;</span></span>
<span id="cb26-1093"><a href="#cb26-1093" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: white !important;</span></span>
<span id="cb26-1094"><a href="#cb26-1094" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb26-1095"><a href="#cb26-1095" aria-hidden="true" tabindex="-1"></a><span class="ss">        .container </span><span class="ch">{{</span></span>
<span id="cb26-1096"><a href="#cb26-1096" aria-hidden="true" tabindex="-1"></a><span class="ss">            max-width: 95%; /* Usa quase toda a largura dispon√≠vel */</span></span>
<span id="cb26-1097"><a href="#cb26-1097" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin: 0 auto;</span></span>
<span id="cb26-1098"><a href="#cb26-1098" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: white;</span></span>
<span id="cb26-1099"><a href="#cb26-1099" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 30px;</span></span>
<span id="cb26-1100"><a href="#cb26-1100" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 8px;</span></span>
<span id="cb26-1101"><a href="#cb26-1101" aria-hidden="true" tabindex="-1"></a><span class="ss">            box-shadow: 0 2px 10px rgba(0,0,0,0.1);</span></span>
<span id="cb26-1102"><a href="#cb26-1102" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb26-1103"><a href="#cb26-1103" aria-hidden="true" tabindex="-1"></a><span class="ss">    </style></span></span>
<span id="cb26-1104"><a href="#cb26-1104" aria-hidden="true" tabindex="-1"></a><span class="ss">    <script></span></span>
<span id="cb26-1105"><a href="#cb26-1105" aria-hidden="true" tabindex="-1"></a><span class="ss">        window.MathJax = </span><span class="ch">{{</span></span>
<span id="cb26-1106"><a href="#cb26-1106" aria-hidden="true" tabindex="-1"></a><span class="ss">            tex: </span><span class="ch">{{</span></span>
<span id="cb26-1107"><a href="#cb26-1107" aria-hidden="true" tabindex="-1"></a><span class="ss">                inlineMath: [['$', '$'], ['</span><span class="ch">\\</span><span class="ss">(', '</span><span class="ch">\\</span><span class="ss">)']],</span></span>
<span id="cb26-1108"><a href="#cb26-1108" aria-hidden="true" tabindex="-1"></a><span class="ss">                displayMath: [['$$', '$$'], ['</span><span class="ch">\\</span><span class="ss">[', '</span><span class="ch">\\</span><span class="ss">]']],</span></span>
<span id="cb26-1109"><a href="#cb26-1109" aria-hidden="true" tabindex="-1"></a><span class="ss">                processEscapes: true</span></span>
<span id="cb26-1110"><a href="#cb26-1110" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span><span class="ch">}}</span></span>
<span id="cb26-1111"><a href="#cb26-1111" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span><span class="ss">;</span></span>
<span id="cb26-1112"><a href="#cb26-1112" aria-hidden="true" tabindex="-1"></a><span class="ss">    </script></span></span>
<span id="cb26-1113"><a href="#cb26-1113" aria-hidden="true" tabindex="-1"></a><span class="ss">    <script src="</span><span class="sc">{</span>mathjax_src<span class="sc">}</span><span class="ss">" async></script></span></span>
<span id="cb26-1114"><a href="#cb26-1114" aria-hidden="true" tabindex="-1"></a><span class="ss"></head></span></span>
<span id="cb26-1115"><a href="#cb26-1115" aria-hidden="true" tabindex="-1"></a><span class="ss"><body></span></span>
<span id="cb26-1116"><a href="#cb26-1116" aria-hidden="true" tabindex="-1"></a><span class="ss">    <div class="container"></span></span>
<span id="cb26-1117"><a href="#cb26-1117" aria-hidden="true" tabindex="-1"></a><span class="ss">        <pre></span><span class="sc">{</span>content<span class="sc">}</span><span class="ss"></pre></span></span>
<span id="cb26-1118"><a href="#cb26-1118" aria-hidden="true" tabindex="-1"></a><span class="ss">    </div></span></span>
<span id="cb26-1119"><a href="#cb26-1119" aria-hidden="true" tabindex="-1"></a><span class="ss">
        <script id="fixed-toc-script">
        document.addEventListener('DOMContentLoaded', function() {
            const toc = document.getElementById('TOC');
            if (toc) {
                const tocTitle = toc.querySelector('h2');
                if (tocTitle) {
                    const toggleBtn = document.createElement('button');
                    toggleBtn.innerHTML = '‚ò∞';
                    toggleBtn.className = 'toc-toggle-btn';
                    toggleBtn.title = 'Minimizar/Expandir TOC';
                    let isMinimized = false;
                    toggleBtn.addEventListener('click', function(e) {
                        e.stopPropagation();
                        isMinimized = !isMinimized;
                        if (isMinimized) {
                            toc.classList.add('toc-minimized');
                        } else {
                            toc.classList.remove('toc-minimized');
                        }
                    });
                    tocTitle.appendChild(toggleBtn);
                }
            }
            
            // SCROLLSPY
            const sections = document.querySelectorAll('h1, h2, h3, h4, h5');
            const tocLinks = document.querySelectorAll('#TOC a');
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const id = entry.target.getAttribute('id');
                        tocLinks.forEach(link => {
                            link.classList.remove('active');
                            if (link.getAttribute('href') === '#' + id) {
                                link.classList.add('active');
                            }
                        });
                    }
                });
            }, { 
                rootMargin: '-20% 0px -60% 0px', 
                threshold: 0 
            });
            
            sections.forEach(section => {
                if (section.id) observer.observe(section);
            });
            
            // Scroll suave
            tocLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const targetId = link.getAttribute('href').substring(1);
                    const targetElement = document.getElementById(targetId);
                    if (targetElement) {
                        const offsetTop = targetElement.offsetTop - 80;
                        window.scrollTo({ top: offsetTop, behavior: 'smooth' });
                    }
                });
            });
            
            // BOT√ÉO VOLTAR AO TOPO
            const backToTopBtn = document.createElement('button');
            backToTopBtn.className = 'back-to-top-content';
            backToTopBtn.innerHTML = '‚Üë';
            backToTopBtn.title = 'Voltar ao Topo';
            document.body.appendChild(backToTopBtn);
            
            window.addEventListener('scroll', () => {
                if (window.pageYOffset > 300) {
                    backToTopBtn.classList.add('show');
                } else {
                    backToTopBtn.classList.remove('show');
                }
            });
            
            backToTopBtn.addEventListener('click', () => {
                window.scrollTo({ top: 0, behavior: 'smooth' });
            });
        });
        </script>
        
</body></span></span>
<span id="cb26-1120"><a href="#cb26-1120" aria-hidden="true" tabindex="-1"></a><span class="ss"></html>"""</span></span>
<span id="cb26-1121"><a href="#cb26-1121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1122"><a href="#cb26-1122" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> save_as_html_robust(<span class="va">self</span>):</span>
<span id="cb26-1123"><a href="#cb26-1123" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""M√©todo ROBUSTO para convers√£o HTML - VERS√ÉO OTIMIZADA"""</span></span>
<span id="cb26-1124"><a href="#cb26-1124" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb26-1125"><a href="#cb26-1125" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="st">"üîÆ [DRY-RUN] HTMLs seriam criados:"</span>)</span>
<span id="cb26-1126"><a href="#cb26-1126" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> conv <span class="kw">in</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb26-1127"><a href="#cb26-1127" aria-hidden="true" tabindex="-1"></a>                safe_title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(conv[<span class="st">'title'</span>])</span>
<span id="cb26-1128"><a href="#cb26-1128" aria-hidden="true" tabindex="-1"></a>                filename <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>conv[<span class="st">'number'</span>]<span class="sc">:03d}</span><span class="ss">_</span><span class="sc">{</span>conv[<span class="st">'source'</span>]<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>safe_title<span class="sc">}</span><span class="ss">.html"</span></span>
<span id="cb26-1129"><a href="#cb26-1129" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.info(<span class="ss">f"   üåê </span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb26-1130"><a href="#cb26-1130" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb26-1131"><a href="#cb26-1131" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb26-1132"><a href="#cb26-1132" aria-hidden="true" tabindex="-1"></a>        markdown_folder <span class="op">=</span> Path(<span class="va">self</span>.output_dirs[<span class="st">'markdown'</span>])</span>
<span id="cb26-1133"><a href="#cb26-1133" aria-hidden="true" tabindex="-1"></a>        html_folder <span class="op">=</span> Path(<span class="va">self</span>.output_dirs[<span class="st">'html'</span>])</span>
<span id="cb26-1134"><a href="#cb26-1134" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb26-1135"><a href="#cb26-1135" aria-hidden="true" tabindex="-1"></a>        md_files <span class="op">=</span> <span class="bu">list</span>(markdown_folder.glob(<span class="st">"*.md"</span>))</span>
<span id="cb26-1136"><a href="#cb26-1136" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb26-1137"><a href="#cb26-1137" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> md_files:</span>
<span id="cb26-1138"><a href="#cb26-1138" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.error(<span class="st">"‚ùå Nenhum arquivo Markdown encontrado para convers√£o."</span>)</span>
<span id="cb26-1139"><a href="#cb26-1139" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb26-1140"><a href="#cb26-1140" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb26-1141"><a href="#cb26-1141" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.logger.info(<span class="ss">f"üîÑ Convertendo </span><span class="sc">{</span><span class="bu">len</span>(md_files)<span class="sc">}</span><span class="ss"> arquivos Markdown para HTML (OTIMIZADO)..."</span>)</span>
<span id="cb26-1142"><a href="#cb26-1142" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb26-1143"><a href="#cb26-1143" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Verifica se Pandoc est√° dispon√≠vel</span></span>
<span id="cb26-1144"><a href="#cb26-1144" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb26-1145"><a href="#cb26-1145" aria-hidden="true" tabindex="-1"></a>            subprocess.run([<span class="st">'pandoc'</span>, <span class="st">'--version'</span>], capture_output<span class="op">=</span><span class="va">True</span>, check<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb26-1146"><a href="#cb26-1146" aria-hidden="true" tabindex="-1"></a>            pandoc_available <span class="op">=</span> <span class="va">True</span></span>
<span id="cb26-1147"><a href="#cb26-1147" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="st">"‚úÖ Pandoc dispon√≠vel - usando convers√£o otimizada"</span>)</span>
<span id="cb26-1148"><a href="#cb26-1148" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span>:</span>
<span id="cb26-1149"><a href="#cb26-1149" aria-hidden="true" tabindex="-1"></a>            pandoc_available <span class="op">=</span> <span class="va">False</span></span>
<span id="cb26-1150"><a href="#cb26-1150" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.warning(<span class="st">"‚ö†Ô∏è Pandoc n√£o dispon√≠vel - usando fallback Python"</span>)</span>
<span id="cb26-1151"><a href="#cb26-1151" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb26-1152"><a href="#cb26-1152" aria-hidden="true" tabindex="-1"></a>        converted_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb26-1153"><a href="#cb26-1153" aria-hidden="true" tabindex="-1"></a>        failed_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb26-1154"><a href="#cb26-1154" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb26-1155"><a href="#cb26-1155" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> md_file <span class="kw">in</span> md_files:</span>
<span id="cb26-1156"><a href="#cb26-1156" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb26-1157"><a href="#cb26-1157" aria-hidden="true" tabindex="-1"></a>                html_file <span class="op">=</span> html_folder <span class="op">/</span> md_file.with_suffix(<span class="st">'.html'</span>).name</span>
<span id="cb26-1158"><a href="#cb26-1158" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb26-1159"><a href="#cb26-1159" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.force_overwrite <span class="kw">and</span> html_file.exists():</span>
<span id="cb26-1160"><a href="#cb26-1160" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.logger.info(<span class="ss">f"‚è≠Ô∏è  J√° existe: </span><span class="sc">{</span>html_file<span class="sc">.</span>name<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb26-1161"><a href="#cb26-1161" aria-hidden="true" tabindex="-1"></a>                    converted_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb26-1162"><a href="#cb26-1162" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">continue</span></span>
<span id="cb26-1163"><a href="#cb26-1163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1164"><a href="#cb26-1164" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.info(<span class="ss">f"üìÑ Processando: </span><span class="sc">{</span>md_file<span class="sc">.</span>name<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb26-1165"><a href="#cb26-1165" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb26-1166"><a href="#cb26-1166" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> pandoc_available:</span>
<span id="cb26-1167"><a href="#cb26-1167" aria-hidden="true" tabindex="-1"></a>                    html_content <span class="op">=</span> <span class="va">self</span>._convert_with_pandoc_optimized(<span class="bu">str</span>(md_file))</span>
<span id="cb26-1168"><a href="#cb26-1168" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb26-1169"><a href="#cb26-1169" aria-hidden="true" tabindex="-1"></a>                    html_content <span class="op">=</span> <span class="va">self</span>._convert_with_fallback(<span class="bu">str</span>(md_file))</span>
<span id="cb26-1170"><a href="#cb26-1170" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb26-1171"><a href="#cb26-1171" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> html_content:</span>
<span id="cb26-1172"><a href="#cb26-1172" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">with</span> <span class="bu">open</span>(html_file, <span class="st">'w'</span>, encoding<span class="op">=</span><span class="st">'utf-8'</span>) <span class="im">as</span> f:</span>
<span id="cb26-1173"><a href="#cb26-1173" aria-hidden="true" tabindex="-1"></a>                        f.write(html_content)</span>
<span id="cb26-1174"><a href="#cb26-1174" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb26-1175"><a href="#cb26-1175" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.logger.info(<span class="ss">f"‚úÖ Criado: </span><span class="sc">{</span>html_file<span class="sc">.</span>name<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb26-1176"><a href="#cb26-1176" aria-hidden="true" tabindex="-1"></a>                    converted_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb26-1177"><a href="#cb26-1177" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb26-1178"><a href="#cb26-1178" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.logger.error(<span class="ss">f"‚ùå Falha na convers√£o: </span><span class="sc">{</span>md_file<span class="sc">.</span>name<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb26-1179"><a href="#cb26-1179" aria-hidden="true" tabindex="-1"></a>                    failed_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb26-1180"><a href="#cb26-1180" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb26-1181"><a href="#cb26-1181" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb26-1182"><a href="#cb26-1182" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.error(<span class="ss">f"‚ùå Erro em </span><span class="sc">{</span>md_file<span class="sc">.</span>name<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span><span class="bu">str</span>(e)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb26-1183"><a href="#cb26-1183" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.error(traceback.format_exc())</span>
<span id="cb26-1184"><a href="#cb26-1184" aria-hidden="true" tabindex="-1"></a>                failed_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb26-1185"><a href="#cb26-1185" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb26-1186"><a href="#cb26-1186" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.logger.info(<span class="ss">f"üìä HTML: </span><span class="sc">{</span>converted_count<span class="sc">}</span><span class="ss"> arquivos criados, </span><span class="sc">{</span>failed_count<span class="sc">}</span><span class="ss"> falhas em '</span><span class="sc">{</span>html_folder<span class="sc">}</span><span class="ss">'"</span>)</span>
<span id="cb26-1187"><a href="#cb26-1187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1188"><a href="#cb26-1188" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> categorize_conversation(<span class="va">self</span>, title: <span class="bu">str</span>, summary: <span class="bu">str</span>) <span class="op">-></span> <span class="bu">str</span>:</span>
<span id="cb26-1189"><a href="#cb26-1189" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Categoriza√ß√£o otimizada com express√µes regulares"""</span></span>
<span id="cb26-1190"><a href="#cb26-1190" aria-hidden="true" tabindex="-1"></a>        text <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>title<span class="sc">}</span><span class="ss"> </span><span class="sc">{</span>summary<span class="sc">}</span><span class="ss">"</span>.lower()</span>
<span id="cb26-1191"><a href="#cb26-1191" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb26-1192"><a href="#cb26-1192" aria-hidden="true" tabindex="-1"></a>        patterns <span class="op">=</span> {</span>
<span id="cb26-1193"><a href="#cb26-1193" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Tecnologia'</span>: <span class="vs">r'</span><span class="dv">\b</span><span class="kw">(</span><span class="vs">tecnologia</span><span class="cf">|</span><span class="vs">hardware</span><span class="cf">|</span><span class="vs">software</span><span class="cf">|</span><span class="vs">rede</span><span class="cf">|</span><span class="vs">internet</span><span class="cf">|</span><span class="vs">wifi</span><span class="cf">|</span><span class="vs">bluetooth</span><span class="cf">|</span><span class="pp">[45]</span><span class="vs">g</span><span class="cf">|</span><span class="vs">cloud</span><span class="cf">|</span><span class="vs">aws</span><span class="cf">|</span><span class="vs">azure</span><span class="cf">|</span><span class="vs">gcp</span><span class="cf">|</span><span class="vs">servidor</span><span class="cf">|</span><span class="vs">hosting</span><span class="cf">|</span><span class="vs">dom√≠nio</span><span class="cf">|</span><span class="vs">ssl</span><span class="cf">|</span><span class="vs">router</span><span class="cf">|</span><span class="vs">switch</span><span class="cf">|</span><span class="vs">firewall</span><span class="cf">|</span><span class="vs">iot</span><span class="cf">|</span><span class="vs">smartphone</span><span class="cf">|</span><span class="vs">tablet</span><span class="cf">|</span><span class="vs">navegador</span><span class="cf">|</span><span class="vs">browser</span><span class="cf">|</span><span class="vs">chrome</span><span class="cf">|</span><span class="vs">firefox</span><span class="cf">|</span><span class="vs">edge</span><span class="cf">|</span><span class="vs">safari</span><span class="cf">|</span><span class="vs">email</span><span class="cf">|</span><span class="vs">gmail</span><span class="cf">|</span><span class="vs">outlook</span><span class="cf">|</span><span class="vs">criptografia</span><span class="cf">|</span><span class="vs">seguran√ßa</span><span class="cf">|</span><span class="vs">ciberseguran√ßa</span><span class="cf">|</span><span class="vs">ransomware</span><span class="cf">|</span><span class="vs">phishing</span><span class="cf">|</span><span class="vs">autentica√ß√£o</span><span class="cf">|</span><span class="vs">2fa</span><span class="cf">|</span><span class="vs">biometria</span><span class="kw">)</span><span class="dv">\b</span><span class="vs">'</span>,</span>
<span id="cb26-1194"><a href="#cb26-1194" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Sa√∫de'</span>: <span class="vs">r'</span><span class="dv">\b</span><span class="kw">(</span><span class="vs">sa√∫de</span><span class="cf">|</span><span class="vs">medicina</span><span class="cf">|</span><span class="vs">m√©dico</span><span class="cf">|</span><span class="vs">enfermagem</span><span class="cf">|</span><span class="vs">doen√ßa</span><span class="cf">|</span><span class="vs">v√≠rus</span><span class="cf">|</span><span class="vs">bact√©ria</span><span class="cf">|</span><span class="vs">vacina</span><span class="cf">|</span><span class="vs">covid</span><span class="cf">|</span><span class="vs">coronav√≠rus</span><span class="cf">|</span><span class="vs">gripe</span><span class="cf">|</span><span class="vs">febre</span><span class="cf">|</span><span class="vs">dor</span><span class="cf">|</span><span class="vs">an√°lise</span><span class="cf">|</span><span class="vs">exame</span><span class="cf">|</span><span class="vs">raio x</span><span class="cf">|</span><span class="vs">resson√¢ncia</span><span class="cf">|</span><span class="vs">hospital</span><span class="cf">|</span><span class="vs">cl√≠nica</span><span class="cf">|</span><span class="vs">farm√°cia</span><span class="cf">|</span><span class="vs">medicamento</span><span class="cf">|</span><span class="vs">rem√©dio</span><span class="cf">|</span><span class="vs">psicologia</span><span class="cf">|</span><span class="vs">terapia</span><span class="cf">|</span><span class="vs">bem-estar</span><span class="cf">|</span><span class="vs">nutri√ß√£o</span><span class="cf">|</span><span class="vs">dieta</span><span class="cf">|</span><span class="vs">exerc√≠cio</span><span class="cf">|</span><span class="vs">fitness</span><span class="cf">|</span><span class="vs">sono</span><span class="cf">|</span><span class="vs">sa√∫de mental</span><span class="kw">)</span><span class="dv">\b</span><span class="vs">'</span>,</span>
<span id="cb26-1195"><a href="#cb26-1195" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Programa√ß√£o'</span>: <span class="vs">r'</span><span class="dv">\b</span><span class="kw">(</span><span class="vs">python</span><span class="cf">|</span><span class="vs">javascript</span><span class="cf">|</span><span class="vs">java</span><span class="cf">|</span><span class="vs">c</span><span class="ch">\+\+</span><span class="cf">|</span><span class="vs">c#</span><span class="cf">|</span><span class="vs">go</span><span class="cf">|</span><span class="vs">rust</span><span class="cf">|</span><span class="vs">lua</span><span class="cf">|</span><span class="vs">bash</span><span class="cf">|</span><span class="vs">script</span><span class="cf">|</span><span class="vs">debug</span><span class="cf">|</span><span class="vs">erro</span><span class="cf">|</span><span class="vs">conda</span><span class="cf">|</span><span class="vs">mamba</span><span class="cf">|</span><span class="vs">pandoc</span><span class="cf">|</span><span class="vs">msys2</span><span class="cf">|</span><span class="vs">spyder</span><span class="cf">|</span><span class="vs">jupyter</span><span class="cf">|</span><span class="vs">pip</span><span class="cf">|</span><span class="vs">venv</span><span class="cf">|</span><span class="vs">docker</span><span class="cf">|</span><span class="vs">git</span><span class="cf">|</span><span class="vs">github</span><span class="cf">|</span><span class="vs">vscode</span><span class="cf">|</span><span class="vs">ide</span><span class="cf">|</span><span class="vs">programa</span><span class="cf">|</span><span class="vs">c√≥digo</span><span class="cf">|</span><span class="vs">fun√ß√£o</span><span class="cf">|</span><span class="vs">classe</span><span class="cf">|</span><span class="vs">api</span><span class="cf">|</span><span class="vs">selenium</span><span class="cf">|</span><span class="vs">playwright</span><span class="kw">)</span><span class="dv">\b</span><span class="vs">'</span>,</span>
<span id="cb26-1196"><a href="#cb26-1196" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Sistemas'</span>: <span class="vs">r'</span><span class="dv">\b</span><span class="kw">(</span><span class="vs">windows</span><span class="cf">|</span><span class="vs">linux</span><span class="cf">|</span><span class="vs">macos</span><span class="cf">|</span><span class="vs">so</span><span class="cf">|</span><span class="vs">sistema operacional</span><span class="cf">|</span><span class="vs">driver</span><span class="cf">|</span><span class="vs">registry</span><span class="cf">|</span><span class="vs">process</span><span class="cf">|</span><span class="vs">firewall</span><span class="cf">|</span><span class="vs">bios</span><span class="cf">|</span><span class="vs">boot</span><span class="cf">|</span><span class="vs">path</span><span class="cf">|</span><span class="vs">dll</span><span class="cf">|</span><span class="vs">exe</span><span class="cf">|</span><span class="vs">powershell</span><span class="cf">|</span><span class="vs">cmd</span><span class="cf">|</span><span class="vs">terminal</span><span class="cf">|</span><span class="vs">shell</span><span class="kw">)</span><span class="dv">\b</span><span class="vs">'</span>,</span>
<span id="cb26-1197"><a href="#cb26-1197" aria-hidden="true" tabindex="-1"></a>            <span class="st">'IA'</span>: <span class="vs">r'</span><span class="dv">\b</span><span class="kw">(</span><span class="vs">ia</span><span class="cf">|</span><span class="vs">gpt</span><span class="cf">|</span><span class="vs">chatgpt</span><span class="cf">|</span><span class="vs">grok</span><span class="cf">|</span><span class="vs">qwen</span><span class="cf">|</span><span class="vs">deepseek</span><span class="cf">|</span><span class="vs">llm</span><span class="cf">|</span><span class="vs">modelo</span><span class="cf">|</span><span class="vs">prompt</span><span class="cf">|</span><span class="vs">token</span><span class="cf">|</span><span class="vs">embedding</span><span class="cf">|</span><span class="vs">fine-tune</span><span class="cf">|</span><span class="vs">neural</span><span class="cf">|</span><span class="vs">chatbot</span><span class="cf">|</span><span class="vs">intelig√™ncia artificial</span><span class="kw">)</span><span class="dv">\b</span><span class="vs">'</span>,</span>
<span id="cb26-1198"><a href="#cb26-1198" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Dados'</span>: <span class="vs">r'</span><span class="dv">\b</span><span class="kw">(</span><span class="vs">dados</span><span class="cf">|</span><span class="vs">data</span><span class="cf">|</span><span class="vs">csv</span><span class="cf">|</span><span class="vs">json</span><span class="cf">|</span><span class="vs">pandas</span><span class="cf">|</span><span class="vs">numpy</span><span class="cf">|</span><span class="vs">excel</span><span class="cf">|</span><span class="vs">sql</span><span class="cf">|</span><span class="vs">banco</span><span class="cf">|</span><span class="vs">sqlite</span><span class="cf">|</span><span class="vs">postgres</span><span class="cf">|</span><span class="vs">visualiza√ß√£o</span><span class="cf">|</span><span class="vs">gr√°fico</span><span class="cf">|</span><span class="vs">tabela</span><span class="cf">|</span><span class="vs">an√°lise</span><span class="cf">|</span><span class="vs">etl</span><span class="cf">|</span><span class="vs">dashboard</span><span class="kw">)</span><span class="dv">\b</span><span class="vs">'</span>,</span>
<span id="cb26-1199"><a href="#cb26-1199" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Geral'</span>: <span class="vs">r'</span><span class="dv">\b</span><span class="kw">(</span><span class="vs">geral</span><span class="cf">|</span><span class="vs">pergunta</span><span class="cf">|</span><span class="vs">ajuda</span><span class="cf">|</span><span class="vs">como fazer</span><span class="cf">|</span><span class="vs">explicar</span><span class="cf">|</span><span class="vs">resumo</span><span class="cf">|</span><span class="vs">tutorial b√°sico</span><span class="kw">)</span><span class="dv">\b</span><span class="vs">'</span></span>
<span id="cb26-1200"><a href="#cb26-1200" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb26-1201"><a href="#cb26-1201" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb26-1202"><a href="#cb26-1202" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> category, pattern <span class="kw">in</span> patterns.items():</span>
<span id="cb26-1203"><a href="#cb26-1203" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> re.search(pattern, text, re.IGNORECASE):</span>
<span id="cb26-1204"><a href="#cb26-1204" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> category</span>
<span id="cb26-1205"><a href="#cb26-1205" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb26-1206"><a href="#cb26-1206" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">'Outros'</span></span>
<span id="cb26-1207"><a href="#cb26-1207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1208"><a href="#cb26-1208" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> parse_timestamp_for_sorting(<span class="va">self</span>, timestamp) <span class="op">-></span> datetime:</span>
<span id="cb26-1209"><a href="#cb26-1209" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> timestamp:</span>
<span id="cb26-1210"><a href="#cb26-1210" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> datetime.<span class="bu">min</span></span>
<span id="cb26-1211"><a href="#cb26-1211" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb26-1212"><a href="#cb26-1212" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb26-1213"><a href="#cb26-1213" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">isinstance</span>(timestamp, <span class="bu">str</span>):</span>
<span id="cb26-1214"><a href="#cb26-1214" aria-hidden="true" tabindex="-1"></a>                clean_ts <span class="op">=</span> timestamp.replace(<span class="st">'T'</span>, <span class="st">' '</span>).split(<span class="st">'.'</span>)[<span class="dv">0</span>].split(<span class="st">'+'</span>)[<span class="dv">0</span>]</span>
<span id="cb26-1215"><a href="#cb26-1215" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> clean_ts.endswith(<span class="st">'Z'</span>):</span>
<span id="cb26-1216"><a href="#cb26-1216" aria-hidden="true" tabindex="-1"></a>                    clean_ts <span class="op">=</span> clean_ts[:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb26-1217"><a href="#cb26-1217" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> datetime.fromisoformat(clean_ts)</span>
<span id="cb26-1218"><a href="#cb26-1218" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> <span class="bu">isinstance</span>(timestamp, (<span class="bu">int</span>, <span class="bu">float</span>)):</span>
<span id="cb26-1219"><a href="#cb26-1219" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> datetime.fromtimestamp(timestamp)</span>
<span id="cb26-1220"><a href="#cb26-1220" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span>:</span>
<span id="cb26-1221"><a href="#cb26-1221" aria-hidden="true" tabindex="-1"></a>            <span class="cf">pass</span></span>
<span id="cb26-1222"><a href="#cb26-1222" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb26-1223"><a href="#cb26-1223" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> datetime.<span class="bu">min</span></span>
<span id="cb26-1224"><a href="#cb26-1224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1225"><a href="#cb26-1225" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> format_timestamp(<span class="va">self</span>, timestamp) <span class="op">-></span> Optional[<span class="bu">str</span>]:</span>
<span id="cb26-1226"><a href="#cb26-1226" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> timestamp:</span>
<span id="cb26-1227"><a href="#cb26-1227" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb26-1228"><a href="#cb26-1228" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb26-1229"><a href="#cb26-1229" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb26-1230"><a href="#cb26-1230" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">isinstance</span>(timestamp, (<span class="bu">int</span>, <span class="bu">float</span>)):</span>
<span id="cb26-1231"><a href="#cb26-1231" aria-hidden="true" tabindex="-1"></a>                dt <span class="op">=</span> datetime.fromtimestamp(timestamp)</span>
<span id="cb26-1232"><a href="#cb26-1232" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> dt.strftime(<span class="st">'%Y-%m-</span><span class="sc">%d</span><span class="st"> %H:%M:%S'</span>)</span>
<span id="cb26-1233"><a href="#cb26-1233" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> <span class="bu">isinstance</span>(timestamp, <span class="bu">str</span>):</span>
<span id="cb26-1234"><a href="#cb26-1234" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="st">'T'</span> <span class="kw">in</span> timestamp:</span>
<span id="cb26-1235"><a href="#cb26-1235" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">return</span> timestamp.replace(<span class="st">'T'</span>, <span class="st">' '</span>).split(<span class="st">'.'</span>)[<span class="dv">0</span>]</span>
<span id="cb26-1236"><a href="#cb26-1236" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> timestamp</span>
<span id="cb26-1237"><a href="#cb26-1237" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span>:</span>
<span id="cb26-1238"><a href="#cb26-1238" aria-hidden="true" tabindex="-1"></a>            <span class="cf">pass</span></span>
<span id="cb26-1239"><a href="#cb26-1239" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb26-1240"><a href="#cb26-1240" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">str</span>(timestamp)</span>
<span id="cb26-1241"><a href="#cb26-1241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1242"><a href="#cb26-1242" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_enhanced_markdown_content(<span class="va">self</span>, conversation: Dict[<span class="bu">str</span>, Any]) <span class="op">-></span> <span class="bu">str</span>:</span>
<span id="cb26-1243"><a href="#cb26-1243" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Gera conte√∫do Markdown com preserva√ß√£o total de formata√ß√£o"""</span></span>
<span id="cb26-1244"><a href="#cb26-1244" aria-hidden="true" tabindex="-1"></a>        lines <span class="op">=</span> [</span>
<span id="cb26-1245"><a href="#cb26-1245" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f"# </span><span class="sc">{</span>conversation[<span class="st">'title'</span>]<span class="sc">}</span><span class="ss">"</span>,</span>
<span id="cb26-1246"><a href="#cb26-1246" aria-hidden="true" tabindex="-1"></a>            <span class="st">""</span>,</span>
<span id="cb26-1247"><a href="#cb26-1247" aria-hidden="true" tabindex="-1"></a>            <span class="st">"## üìä Informa√ß√µes"</span>,</span>
<span id="cb26-1248"><a href="#cb26-1248" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f"- **N√∫mero:** #</span><span class="sc">{</span>conversation[<span class="st">'number'</span>]<span class="sc">}</span><span class="ss">"</span>,</span>
<span id="cb26-1249"><a href="#cb26-1249" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f"- **Origem:** </span><span class="sc">{</span>conversation[<span class="st">'source'</span>]<span class="sc">}</span><span class="ss">"</span>,</span>
<span id="cb26-1250"><a href="#cb26-1250" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f"- **Categoria:** </span><span class="sc">{</span>conversation[<span class="st">'category'</span>]<span class="sc">}</span><span class="ss">"</span>,</span>
<span id="cb26-1251"><a href="#cb26-1251" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f"- **ID:** </span><span class="sc">{</span>conversation<span class="sc">.</span>get(<span class="st">'id'</span>, <span class="st">'N/A'</span>)<span class="sc">}</span><span class="ss">"</span>,</span>
<span id="cb26-1252"><a href="#cb26-1252" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f"- **Criada em:** </span><span class="sc">{</span>conversation<span class="sc">.</span>get(<span class="st">'inserted_at'</span>) <span class="kw">or</span> conversation<span class="sc">.</span>get(<span class="st">'created_at'</span>) <span class="kw">or</span> <span class="st">'N/A'</span><span class="sc">}</span><span class="ss">"</span>,</span>
<span id="cb26-1253"><a href="#cb26-1253" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb26-1254"><a href="#cb26-1254" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb26-1255"><a href="#cb26-1255" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> conversation.get(<span class="st">'updated_at'</span>):</span>
<span id="cb26-1256"><a href="#cb26-1256" aria-hidden="true" tabindex="-1"></a>            lines.append(<span class="ss">f"- **Atualizada em:** </span><span class="sc">{</span>conversation[<span class="st">'updated_at'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb26-1257"><a href="#cb26-1257" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb26-1258"><a href="#cb26-1258" aria-hidden="true" tabindex="-1"></a>        lines.extend([</span>
<span id="cb26-1259"><a href="#cb26-1259" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f"- **Total de mensagens:** </span><span class="sc">{</span><span class="bu">len</span>(conversation[<span class="st">'messages'</span>])<span class="sc">}</span><span class="ss">"</span>,</span>
<span id="cb26-1260"><a href="#cb26-1260" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f"- **Resumo:** </span><span class="sc">{</span>conversation<span class="sc">.</span>get(<span class="st">'summary'</span>, <span class="st">'Sem resumo'</span>)<span class="sc">}</span><span class="ss">"</span>,</span>
<span id="cb26-1261"><a href="#cb26-1261" aria-hidden="true" tabindex="-1"></a>            <span class="st">""</span>,</span>
<span id="cb26-1262"><a href="#cb26-1262" aria-hidden="true" tabindex="-1"></a>            <span class="st">"---"</span>,</span>
<span id="cb26-1263"><a href="#cb26-1263" aria-hidden="true" tabindex="-1"></a>            <span class="st">""</span>,</span>
<span id="cb26-1264"><a href="#cb26-1264" aria-hidden="true" tabindex="-1"></a>            <span class="st">"## üí¨ Conversa"</span>,</span>
<span id="cb26-1265"><a href="#cb26-1265" aria-hidden="true" tabindex="-1"></a>            <span class="st">""</span></span>
<span id="cb26-1266"><a href="#cb26-1266" aria-hidden="true" tabindex="-1"></a>        ])</span>
<span id="cb26-1267"><a href="#cb26-1267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1268"><a href="#cb26-1268" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, msg <span class="kw">in</span> <span class="bu">enumerate</span>(conversation[<span class="st">'messages'</span>], <span class="dv">1</span>):</span>
<span id="cb26-1269"><a href="#cb26-1269" aria-hidden="true" tabindex="-1"></a>            timestamp <span class="op">=</span> <span class="ss">f" *(</span><span class="sc">{</span>msg[<span class="st">'timestamp'</span>]<span class="sc">}</span><span class="ss">)*"</span> <span class="cf">if</span> msg[<span class="st">'timestamp'</span>] <span class="cf">else</span> <span class="st">""</span></span>
<span id="cb26-1270"><a href="#cb26-1270" aria-hidden="true" tabindex="-1"></a>            model_info <span class="op">=</span> <span class="ss">f" *[</span><span class="sc">{</span>msg<span class="sc">.</span>get(<span class="st">'model'</span>, <span class="st">''</span>)<span class="sc">}</span><span class="ss">]*"</span> <span class="cf">if</span> msg.get(<span class="st">'model'</span>) <span class="cf">else</span> <span class="st">""</span></span>
<span id="cb26-1271"><a href="#cb26-1271" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb26-1272"><a href="#cb26-1272" aria-hidden="true" tabindex="-1"></a>            preserved_content <span class="op">=</span> <span class="va">self</span>.preserve_special_content(msg[<span class="st">'content'</span>])</span>
<span id="cb26-1273"><a href="#cb26-1273" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb26-1274"><a href="#cb26-1274" aria-hidden="true" tabindex="-1"></a>            lines.extend([</span>
<span id="cb26-1275"><a href="#cb26-1275" aria-hidden="true" tabindex="-1"></a>                <span class="ss">f"### </span><span class="sc">{</span>msg[<span class="st">'author'</span>]<span class="sc">}{</span>timestamp<span class="sc">}{</span>model_info<span class="sc">}</span><span class="ss">"</span>,</span>
<span id="cb26-1276"><a href="#cb26-1276" aria-hidden="true" tabindex="-1"></a>                <span class="st">""</span>,</span>
<span id="cb26-1277"><a href="#cb26-1277" aria-hidden="true" tabindex="-1"></a>                <span class="ss">f"</span><span class="sc">{</span>preserved_content<span class="sc">}</span><span class="ss">"</span>,</span>
<span id="cb26-1278"><a href="#cb26-1278" aria-hidden="true" tabindex="-1"></a>                <span class="st">""</span></span>
<span id="cb26-1279"><a href="#cb26-1279" aria-hidden="true" tabindex="-1"></a>            ])</span>
<span id="cb26-1280"><a href="#cb26-1280" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb26-1281"><a href="#cb26-1281" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> j <span class="op"><</span> <span class="bu">len</span>(conversation[<span class="st">'messages'</span>]):</span>
<span id="cb26-1282"><a href="#cb26-1282" aria-hidden="true" tabindex="-1"></a>                lines.extend([<span class="st">"---"</span>, <span class="st">""</span>])</span>
<span id="cb26-1283"><a href="#cb26-1283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1284"><a href="#cb26-1284" aria-hidden="true" tabindex="-1"></a>        lines.extend([</span>
<span id="cb26-1285"><a href="#cb26-1285" aria-hidden="true" tabindex="-1"></a>            <span class="st">"---"</span>,</span>
<span id="cb26-1286"><a href="#cb26-1286" aria-hidden="true" tabindex="-1"></a>            <span class="st">""</span>,</span>
<span id="cb26-1287"><a href="#cb26-1287" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f"*Conversa exportada do </span><span class="sc">{</span>conversation[<span class="st">'source'</span>]<span class="sc">}</span><span class="ss">*"</span>,</span>
<span id="cb26-1288"><a href="#cb26-1288" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f"*Processado em: </span><span class="sc">{</span>datetime<span class="sc">.</span>now()<span class="sc">.</span>strftime(<span class="st">'</span><span class="sc">%d</span><span class="st">/%m/%Y %H:%M'</span>)<span class="sc">}</span><span class="ss">*"</span></span>
<span id="cb26-1289"><a href="#cb26-1289" aria-hidden="true" tabindex="-1"></a>        ])</span>
<span id="cb26-1290"><a href="#cb26-1290" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb26-1291"><a href="#cb26-1291" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">'</span><span class="ch">\n</span><span class="st">'</span>.join(lines)</span>
<span id="cb26-1292"><a href="#cb26-1292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1293"><a href="#cb26-1293" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> process_qwen_corrected(<span class="va">self</span>, path: Path):</span>
<span id="cb26-1294"><a href="#cb26-1294" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Processa Qwen3 com corre√ß√£o para content_list - VERS√ÉO CORRIGIDA"""</span></span>
<span id="cb26-1295"><a href="#cb26-1295" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb26-1296"><a href="#cb26-1296" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="ss">f"üîÆ [DRY-RUN] Processaria Qwen3: </span><span class="sc">{</span>path<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb26-1297"><a href="#cb26-1297" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb26-1298"><a href="#cb26-1298" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb26-1299"><a href="#cb26-1299" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb26-1300"><a href="#cb26-1300" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(path, <span class="st">'r'</span>, encoding<span class="op">=</span><span class="st">'utf-8'</span>) <span class="im">as</span> f:</span>
<span id="cb26-1301"><a href="#cb26-1301" aria-hidden="true" tabindex="-1"></a>                raw_data <span class="op">=</span> json.load(f)</span>
<span id="cb26-1302"><a href="#cb26-1302" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb26-1303"><a href="#cb26-1303" aria-hidden="true" tabindex="-1"></a>            <span class="co"># DEBUG: Salvar estrutura completa para an√°lise</span></span>
<span id="cb26-1304"><a href="#cb26-1304" aria-hidden="true" tabindex="-1"></a>            debug_file <span class="op">=</span> Path(<span class="st">"qwen_debug_structure.json"</span>)</span>
<span id="cb26-1305"><a href="#cb26-1305" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(debug_file, <span class="st">'w'</span>, encoding<span class="op">=</span><span class="st">'utf-8'</span>) <span class="im">as</span> f:</span>
<span id="cb26-1306"><a href="#cb26-1306" aria-hidden="true" tabindex="-1"></a>                json.dump(raw_data, f, indent<span class="op">=</span><span class="dv">2</span>, ensure_ascii<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb26-1307"><a href="#cb26-1307" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="ss">f"üîç Estrutura Qwen salva em: </span><span class="sc">{</span>debug_file<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb26-1308"><a href="#cb26-1308" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb26-1309"><a href="#cb26-1309" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Extrair conversas</span></span>
<span id="cb26-1310"><a href="#cb26-1310" aria-hidden="true" tabindex="-1"></a>            conversations <span class="op">=</span> []</span>
<span id="cb26-1311"><a href="#cb26-1311" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb26-1312"><a href="#cb26-1312" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="st">'data'</span> <span class="kw">in</span> raw_data <span class="kw">and</span> <span class="bu">isinstance</span>(raw_data[<span class="st">'data'</span>], <span class="bu">list</span>):</span>
<span id="cb26-1313"><a href="#cb26-1313" aria-hidden="true" tabindex="-1"></a>                conversations <span class="op">=</span> raw_data[<span class="st">'data'</span>]</span>
<span id="cb26-1314"><a href="#cb26-1314" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.info(<span class="ss">f"üìÅ Estrutura 1: </span><span class="sc">{</span><span class="bu">len</span>(conversations)<span class="sc">}</span><span class="ss"> conversas em 'data'"</span>)</span>
<span id="cb26-1315"><a href="#cb26-1315" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> <span class="bu">isinstance</span>(raw_data, <span class="bu">list</span>):</span>
<span id="cb26-1316"><a href="#cb26-1316" aria-hidden="true" tabindex="-1"></a>                conversations <span class="op">=</span> raw_data</span>
<span id="cb26-1317"><a href="#cb26-1317" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.info(<span class="ss">f"üìÅ Estrutura 2: </span><span class="sc">{</span><span class="bu">len</span>(conversations)<span class="sc">}</span><span class="ss"> conversas na raiz"</span>)</span>
<span id="cb26-1318"><a href="#cb26-1318" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb26-1319"><a href="#cb26-1319" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> key, value <span class="kw">in</span> raw_data.items():</span>
<span id="cb26-1320"><a href="#cb26-1320" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="bu">isinstance</span>(value, <span class="bu">list</span>) <span class="kw">and</span> <span class="bu">len</span>(value) <span class="op">></span> <span class="dv">0</span>:</span>
<span id="cb26-1321"><a href="#cb26-1321" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">if</span> <span class="bu">isinstance</span>(value[<span class="dv">0</span>], <span class="bu">dict</span>) <span class="kw">and</span> <span class="bu">any</span>(k <span class="kw">in</span> value[<span class="dv">0</span>] <span class="cf">for</span> k <span class="kw">in</span> [<span class="st">'title'</span>, <span class="st">'chat'</span>, <span class="st">'messages'</span>]):</span>
<span id="cb26-1322"><a href="#cb26-1322" aria-hidden="true" tabindex="-1"></a>                            conversations <span class="op">=</span> value</span>
<span id="cb26-1323"><a href="#cb26-1323" aria-hidden="true" tabindex="-1"></a>                            <span class="va">self</span>.logger.info(<span class="ss">f"üìÅ Estrutura alternativa: </span><span class="sc">{</span><span class="bu">len</span>(conversations)<span class="sc">}</span><span class="ss"> conversas em '</span><span class="sc">{</span>key<span class="sc">}</span><span class="ss">'"</span>)</span>
<span id="cb26-1324"><a href="#cb26-1324" aria-hidden="true" tabindex="-1"></a>                            <span class="cf">break</span></span>
<span id="cb26-1325"><a href="#cb26-1325" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb26-1326"><a href="#cb26-1326" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> conversations:</span>
<span id="cb26-1327"><a href="#cb26-1327" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.error(<span class="st">"‚ùå Nenhuma conversa encontrada no arquivo Qwen"</span>)</span>
<span id="cb26-1328"><a href="#cb26-1328" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span></span>
<span id="cb26-1329"><a href="#cb26-1329" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb26-1330"><a href="#cb26-1330" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="ss">f"üîç Qwen: encontradas </span><span class="sc">{</span><span class="bu">len</span>(conversations)<span class="sc">}</span><span class="ss"> conversas."</span>)</span>
<span id="cb26-1331"><a href="#cb26-1331" aria-hidden="true" tabindex="-1"></a>            processed_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb26-1332"><a href="#cb26-1332" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb26-1333"><a href="#cb26-1333" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> i, conv <span class="kw">in</span> <span class="bu">enumerate</span>(conversations):</span>
<span id="cb26-1334"><a href="#cb26-1334" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(conv, <span class="bu">dict</span>):</span>
<span id="cb26-1335"><a href="#cb26-1335" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">continue</span></span>
<span id="cb26-1336"><a href="#cb26-1336" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb26-1337"><a href="#cb26-1337" aria-hidden="true" tabindex="-1"></a>                original_title <span class="op">=</span> conv.get(<span class="st">'title'</span>, <span class="ss">f'Conversa Qwen </span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb26-1338"><a href="#cb26-1338" aria-hidden="true" tabindex="-1"></a>                clean_title <span class="op">=</span> <span class="va">self</span>.preserve_original_title(original_title)</span>
<span id="cb26-1339"><a href="#cb26-1339" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb26-1340"><a href="#cb26-1340" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.info(<span class="ss">f"   üîç Processando: '</span><span class="sc">{</span>clean_title<span class="sc">}</span><span class="ss">'"</span>)</span>
<span id="cb26-1341"><a href="#cb26-1341" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb26-1342"><a href="#cb26-1342" aria-hidden="true" tabindex="-1"></a>                <span class="co"># EXTRA√á√ÉO CORRIGIDA - foco em content_list</span></span>
<span id="cb26-1343"><a href="#cb26-1343" aria-hidden="true" tabindex="-1"></a>                messages <span class="op">=</span> <span class="va">self</span>._extract_qwen_messages_corrected(conv, clean_title, i)</span>
<span id="cb26-1344"><a href="#cb26-1344" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb26-1345"><a href="#cb26-1345" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> messages:</span>
<span id="cb26-1346"><a href="#cb26-1346" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># Ordenar mensagens por timestamp</span></span>
<span id="cb26-1347"><a href="#cb26-1347" aria-hidden="true" tabindex="-1"></a>                    messages.sort(key<span class="op">=</span><span class="kw">lambda</span> x: <span class="va">self</span>.parse_timestamp_for_sorting(x[<span class="st">'timestamp'</span>]))</span>
<span id="cb26-1348"><a href="#cb26-1348" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb26-1349"><a href="#cb26-1349" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.all_conversations.append({</span>
<span id="cb26-1350"><a href="#cb26-1350" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'title'</span>: clean_title,</span>
<span id="cb26-1351"><a href="#cb26-1351" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'source'</span>: <span class="st">'Qwen3'</span>,</span>
<span id="cb26-1352"><a href="#cb26-1352" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'id'</span>: conv.get(<span class="st">'id'</span>, <span class="ss">f'qwen_</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">'</span>),</span>
<span id="cb26-1353"><a href="#cb26-1353" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'inserted_at'</span>: <span class="va">self</span>.format_timestamp(conv.get(<span class="st">'created_at'</span>)),</span>
<span id="cb26-1354"><a href="#cb26-1354" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'updated_at'</span>: <span class="va">self</span>.format_timestamp(conv.get(<span class="st">'updated_at'</span>)),</span>
<span id="cb26-1355"><a href="#cb26-1355" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'messages'</span>: messages,</span>
<span id="cb26-1356"><a href="#cb26-1356" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'summary'</span>: messages[<span class="dv">0</span>][<span class="st">'content'</span>][:<span class="dv">100</span>] <span class="op">+</span> <span class="st">"..."</span> <span class="cf">if</span> messages <span class="cf">else</span> <span class="st">"Sem conte√∫do"</span>,</span>
<span id="cb26-1357"><a href="#cb26-1357" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'category'</span>: <span class="va">self</span>.categorize_conversation(clean_title, messages[<span class="dv">0</span>][<span class="st">'content'</span>][:<span class="dv">100</span>] <span class="cf">if</span> messages <span class="cf">else</span> <span class="st">""</span>)</span>
<span id="cb26-1358"><a href="#cb26-1358" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb26-1359"><a href="#cb26-1359" aria-hidden="true" tabindex="-1"></a>                    processed_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb26-1360"><a href="#cb26-1360" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.logger.info(<span class="ss">f"   ‚úÖ Adicionada: </span><span class="sc">{</span><span class="bu">len</span>(messages)<span class="sc">}</span><span class="ss"> mensagens"</span>)</span>
<span id="cb26-1361"><a href="#cb26-1361" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb26-1362"><a href="#cb26-1362" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.logger.warning(<span class="ss">f"   ‚ùå Conversa </span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">: nenhuma mensagem extra√≠da"</span>)</span>
<span id="cb26-1363"><a href="#cb26-1363" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb26-1364"><a href="#cb26-1364" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="ss">f"‚úÖ Qwen3: </span><span class="sc">{</span>processed_count<span class="sc">}</span><span class="ss"> conversas processadas."</span>)</span>
<span id="cb26-1365"><a href="#cb26-1365" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb26-1366"><a href="#cb26-1366" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb26-1367"><a href="#cb26-1367" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.error(<span class="ss">f"‚ùå Erro ao processar Qwen3: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb26-1368"><a href="#cb26-1368" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.error(traceback.format_exc())</span>
<span id="cb26-1369"><a href="#cb26-1369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1370"><a href="#cb26-1370" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _extract_qwen_messages_corrected(<span class="va">self</span>, conv: Dict[<span class="bu">str</span>, Any], clean_title: <span class="bu">str</span>, conv_index: <span class="bu">int</span>) <span class="op">-></span> List[Dict[<span class="bu">str</span>, Any]]:</span>
<span id="cb26-1371"><a href="#cb26-1371" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Extrai mensagens do Qwen com corre√ß√£o para content_list"""</span></span>
<span id="cb26-1372"><a href="#cb26-1372" aria-hidden="true" tabindex="-1"></a>        all_messages <span class="op">=</span> []</span>
<span id="cb26-1373"><a href="#cb26-1373" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb26-1374"><a href="#cb26-1374" aria-hidden="true" tabindex="-1"></a>        <span class="co"># ESTRAT√âGIA PRINCIPAL: Buscar em toda a estrutura por mensagens</span></span>
<span id="cb26-1375"><a href="#cb26-1375" aria-hidden="true" tabindex="-1"></a>        <span class="kw">def</span> extract_from_object(obj, path<span class="op">=</span><span class="st">""</span>):</span>
<span id="cb26-1376"><a href="#cb26-1376" aria-hidden="true" tabindex="-1"></a>            messages_found <span class="op">=</span> []</span>
<span id="cb26-1377"><a href="#cb26-1377" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb26-1378"><a href="#cb26-1378" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">isinstance</span>(obj, <span class="bu">dict</span>):</span>
<span id="cb26-1379"><a href="#cb26-1379" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Verificar se √© uma mensagem com content_list (CASO CORRIGIDO)</span></span>
<span id="cb26-1380"><a href="#cb26-1380" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="va">self</span>._is_qwen_message_with_content(obj):</span>
<span id="cb26-1381"><a href="#cb26-1381" aria-hidden="true" tabindex="-1"></a>                    message <span class="op">=</span> <span class="va">self</span>._create_message_from_qwen_object(obj)</span>
<span id="cb26-1382"><a href="#cb26-1382" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> message:</span>
<span id="cb26-1383"><a href="#cb26-1383" aria-hidden="true" tabindex="-1"></a>                        messages_found.append(message)</span>
<span id="cb26-1384"><a href="#cb26-1384" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb26-1385"><a href="#cb26-1385" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Buscar recursivamente</span></span>
<span id="cb26-1386"><a href="#cb26-1386" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> key, value <span class="kw">in</span> obj.items():</span>
<span id="cb26-1387"><a href="#cb26-1387" aria-hidden="true" tabindex="-1"></a>                    messages_found.extend(extract_from_object(value, <span class="ss">f"</span><span class="sc">{</span>path<span class="sc">}</span><span class="ss">.</span><span class="sc">{</span>key<span class="sc">}</span><span class="ss">"</span>))</span>
<span id="cb26-1388"><a href="#cb26-1388" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb26-1389"><a href="#cb26-1389" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> <span class="bu">isinstance</span>(obj, <span class="bu">list</span>):</span>
<span id="cb26-1390"><a href="#cb26-1390" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> item <span class="kw">in</span> obj:</span>
<span id="cb26-1391"><a href="#cb26-1391" aria-hidden="true" tabindex="-1"></a>                    messages_found.extend(extract_from_object(item, path))</span>
<span id="cb26-1392"><a href="#cb26-1392" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb26-1393"><a href="#cb26-1393" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> messages_found</span>
<span id="cb26-1394"><a href="#cb26-1394" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb26-1395"><a href="#cb26-1395" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Aplicar extra√ß√£o recursiva</span></span>
<span id="cb26-1396"><a href="#cb26-1396" aria-hidden="true" tabindex="-1"></a>        all_messages <span class="op">=</span> extract_from_object(conv, <span class="st">"root"</span>)</span>
<span id="cb26-1397"><a href="#cb26-1397" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb26-1398"><a href="#cb26-1398" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Remover duplicatas</span></span>
<span id="cb26-1399"><a href="#cb26-1399" aria-hidden="true" tabindex="-1"></a>        unique_messages <span class="op">=</span> <span class="va">self</span>._remove_duplicate_messages(all_messages)</span>
<span id="cb26-1400"><a href="#cb26-1400" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb26-1401"><a href="#cb26-1401" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(unique_messages) <span class="op">!=</span> <span class="bu">len</span>(all_messages):</span>
<span id="cb26-1402"><a href="#cb26-1402" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="ss">f"         üîÑ Removidas </span><span class="sc">{</span><span class="bu">len</span>(all_messages) <span class="op">-</span> <span class="bu">len</span>(unique_messages)<span class="sc">}</span><span class="ss"> mensagens duplicadas"</span>)</span>
<span id="cb26-1403"><a href="#cb26-1403" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb26-1404"><a href="#cb26-1404" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> unique_messages</span>
<span id="cb26-1405"><a href="#cb26-1405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1406"><a href="#cb26-1406" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _is_qwen_message_with_content(<span class="va">self</span>, obj: Dict) <span class="op">-></span> <span class="bu">bool</span>:</span>
<span id="cb26-1407"><a href="#cb26-1407" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Verifica se √© uma mensagem Qwen v√°lida (incluindo content_list)"""</span></span>
<span id="cb26-1408"><a href="#cb26-1408" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Verificar campos b√°sicos de mensagem</span></span>
<span id="cb26-1409"><a href="#cb26-1409" aria-hidden="true" tabindex="-1"></a>        has_basic_structure <span class="op">=</span> (<span class="st">'role'</span> <span class="kw">in</span> obj <span class="kw">and</span> <span class="st">'content'</span> <span class="kw">in</span> obj)</span>
<span id="cb26-1410"><a href="#cb26-1410" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb26-1411"><a href="#cb26-1411" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Verificar se tem content_list (CORRE√á√ÉO DO PROBLEMA)</span></span>
<span id="cb26-1412"><a href="#cb26-1412" aria-hidden="true" tabindex="-1"></a>        has_content_list <span class="op">=</span> <span class="st">'content_list'</span> <span class="kw">in</span> obj <span class="kw">and</span> <span class="bu">isinstance</span>(obj[<span class="st">'content_list'</span>], <span class="bu">list</span>)</span>
<span id="cb26-1413"><a href="#cb26-1413" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb26-1414"><a href="#cb26-1414" aria-hidden="true" tabindex="-1"></a>        <span class="co"># √â uma mensagem v√°lida se tiver estrutura b√°sica E (conte√∫do n√£o vazio OU content_list)</span></span>
<span id="cb26-1415"><a href="#cb26-1415" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> (has_basic_structure <span class="kw">and</span> </span>
<span id="cb26-1416"><a href="#cb26-1416" aria-hidden="true" tabindex="-1"></a>                (obj.get(<span class="st">'content'</span>) <span class="kw">or</span> has_content_list) <span class="kw">and</span></span>
<span id="cb26-1417"><a href="#cb26-1417" aria-hidden="true" tabindex="-1"></a>                obj.get(<span class="st">'role'</span>) <span class="kw">in</span> [<span class="st">'user'</span>, <span class="st">'assistant'</span>])</span>
<span id="cb26-1418"><a href="#cb26-1418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1419"><a href="#cb26-1419" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _create_message_from_qwen_object(<span class="va">self</span>, obj: Dict) <span class="op">-></span> Optional[Dict[<span class="bu">str</span>, Any]]:</span>
<span id="cb26-1420"><a href="#cb26-1420" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Cria uma mensagem a partir de um objeto Qwen, priorizando content_list"""</span></span>
<span id="cb26-1421"><a href="#cb26-1421" aria-hidden="true" tabindex="-1"></a>        role <span class="op">=</span> obj.get(<span class="st">'role'</span>, <span class="st">''</span>)</span>
<span id="cb26-1422"><a href="#cb26-1422" aria-hidden="true" tabindex="-1"></a>        content <span class="op">=</span> obj.get(<span class="st">'content'</span>, <span class="st">''</span>)</span>
<span id="cb26-1423"><a href="#cb26-1423" aria-hidden="true" tabindex="-1"></a>        content_list <span class="op">=</span> obj.get(<span class="st">'content_list'</span>, [])</span>
<span id="cb26-1424"><a href="#cb26-1424" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb26-1425"><a href="#cb26-1425" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> role:</span>
<span id="cb26-1426"><a href="#cb26-1426" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb26-1427"><a href="#cb26-1427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1428"><a href="#cb26-1428" aria-hidden="true" tabindex="-1"></a>        <span class="co"># CORRE√á√ÉO PRINCIPAL: Priorizar content_list quando content estiver vazio</span></span>
<span id="cb26-1429"><a href="#cb26-1429" aria-hidden="true" tabindex="-1"></a>        final_content <span class="op">=</span> <span class="st">""</span></span>
<span id="cb26-1430"><a href="#cb26-1430" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb26-1431"><a href="#cb26-1431" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> content_list <span class="kw">and</span> <span class="bu">isinstance</span>(content_list, <span class="bu">list</span>):</span>
<span id="cb26-1432"><a href="#cb26-1432" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Extrair conte√∫do de content_list</span></span>
<span id="cb26-1433"><a href="#cb26-1433" aria-hidden="true" tabindex="-1"></a>            content_parts <span class="op">=</span> []</span>
<span id="cb26-1434"><a href="#cb26-1434" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> content_item <span class="kw">in</span> content_list:</span>
<span id="cb26-1435"><a href="#cb26-1435" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="bu">isinstance</span>(content_item, <span class="bu">dict</span>):</span>
<span id="cb26-1436"><a href="#cb26-1436" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># Verificar diferentes estruturas de content_list</span></span>
<span id="cb26-1437"><a href="#cb26-1437" aria-hidden="true" tabindex="-1"></a>                    item_content <span class="op">=</span> content_item.get(<span class="st">'content'</span>, <span class="st">''</span>)</span>
<span id="cb26-1438"><a href="#cb26-1438" aria-hidden="true" tabindex="-1"></a>                    item_text <span class="op">=</span> content_item.get(<span class="st">'text'</span>, <span class="st">''</span>)</span>
<span id="cb26-1439"><a href="#cb26-1439" aria-hidden="true" tabindex="-1"></a>                    item_type <span class="op">=</span> content_item.get(<span class="st">'type'</span>, <span class="st">''</span>)</span>
<span id="cb26-1440"><a href="#cb26-1440" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb26-1441"><a href="#cb26-1441" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> item_content:</span>
<span id="cb26-1442"><a href="#cb26-1442" aria-hidden="true" tabindex="-1"></a>                        content_parts.append(<span class="bu">str</span>(item_content))</span>
<span id="cb26-1443"><a href="#cb26-1443" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">elif</span> item_text:</span>
<span id="cb26-1444"><a href="#cb26-1444" aria-hidden="true" tabindex="-1"></a>                        content_parts.append(<span class="bu">str</span>(item_text))</span>
<span id="cb26-1445"><a href="#cb26-1445" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">elif</span> item_type <span class="op">==</span> <span class="st">'text'</span> <span class="kw">and</span> <span class="st">'text'</span> <span class="kw">in</span> content_item:</span>
<span id="cb26-1446"><a href="#cb26-1446" aria-hidden="true" tabindex="-1"></a>                        content_parts.append(<span class="bu">str</span>(content_item[<span class="st">'text'</span>]))</span>
<span id="cb26-1447"><a href="#cb26-1447" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb26-1448"><a href="#cb26-1448" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> content_parts:</span>
<span id="cb26-1449"><a href="#cb26-1449" aria-hidden="true" tabindex="-1"></a>                final_content <span class="op">=</span> <span class="st">'</span><span class="ch">\n</span><span class="st">'</span>.join(content_parts).strip()</span>
<span id="cb26-1450"><a href="#cb26-1450" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb26-1451"><a href="#cb26-1451" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Se content_list n√£o forneceu conte√∫do, usar o campo content tradicional</span></span>
<span id="cb26-1452"><a href="#cb26-1452" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> final_content <span class="kw">and</span> content:</span>
<span id="cb26-1453"><a href="#cb26-1453" aria-hidden="true" tabindex="-1"></a>            final_content <span class="op">=</span> <span class="bu">str</span>(content).strip()</span>
<span id="cb26-1454"><a href="#cb26-1454" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb26-1455"><a href="#cb26-1455" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Se ainda n√£o tem conte√∫do, pular</span></span>
<span id="cb26-1456"><a href="#cb26-1456" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> final_content <span class="kw">or</span> final_content <span class="op">==</span> <span class="st">'null'</span>:</span>
<span id="cb26-1457"><a href="#cb26-1457" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb26-1458"><a href="#cb26-1458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1459"><a href="#cb26-1459" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Determinar autor</span></span>
<span id="cb26-1460"><a href="#cb26-1460" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> role <span class="op">==</span> <span class="st">'user'</span>:</span>
<span id="cb26-1461"><a href="#cb26-1461" aria-hidden="true" tabindex="-1"></a>            author <span class="op">=</span> <span class="st">"üë§ Utilizador"</span></span>
<span id="cb26-1462"><a href="#cb26-1462" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> role <span class="op">==</span> <span class="st">'assistant'</span>:</span>
<span id="cb26-1463"><a href="#cb26-1463" aria-hidden="true" tabindex="-1"></a>            author <span class="op">=</span> <span class="st">"ü§ñ Qwen3"</span></span>
<span id="cb26-1464"><a href="#cb26-1464" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb26-1465"><a href="#cb26-1465" aria-hidden="true" tabindex="-1"></a>            author <span class="op">=</span> <span class="ss">f"üîπ </span><span class="sc">{</span>role<span class="sc">.</span>title()<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb26-1466"><a href="#cb26-1466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1467"><a href="#cb26-1467" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Processar conte√∫do especial</span></span>
<span id="cb26-1468"><a href="#cb26-1468" aria-hidden="true" tabindex="-1"></a>        final_content <span class="op">=</span> <span class="va">self</span>.preserve_special_content(final_content)</span>
<span id="cb26-1469"><a href="#cb26-1469" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb26-1470"><a href="#cb26-1470" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb26-1471"><a href="#cb26-1471" aria-hidden="true" tabindex="-1"></a>            <span class="st">'author'</span>: author,</span>
<span id="cb26-1472"><a href="#cb26-1472" aria-hidden="true" tabindex="-1"></a>            <span class="st">'role'</span>: role,</span>
<span id="cb26-1473"><a href="#cb26-1473" aria-hidden="true" tabindex="-1"></a>            <span class="st">'content'</span>: final_content,</span>
<span id="cb26-1474"><a href="#cb26-1474" aria-hidden="true" tabindex="-1"></a>            <span class="st">'timestamp'</span>: <span class="va">self</span>.format_timestamp(obj.get(<span class="st">'created_at'</span>)),</span>
<span id="cb26-1475"><a href="#cb26-1475" aria-hidden="true" tabindex="-1"></a>            <span class="st">'model'</span>: obj.get(<span class="st">'model'</span>, <span class="st">'Qwen3'</span>)</span>
<span id="cb26-1476"><a href="#cb26-1476" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb26-1477"><a href="#cb26-1477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1478"><a href="#cb26-1478" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _remove_duplicate_messages(<span class="va">self</span>, messages: List[Dict[<span class="bu">str</span>, Any]]) <span class="op">-></span> List[Dict[<span class="bu">str</span>, Any]]:</span>
<span id="cb26-1479"><a href="#cb26-1479" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Remove mensagens duplicadas baseadas no conte√∫do"""</span></span>
<span id="cb26-1480"><a href="#cb26-1480" aria-hidden="true" tabindex="-1"></a>        seen <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb26-1481"><a href="#cb26-1481" aria-hidden="true" tabindex="-1"></a>        unique_messages <span class="op">=</span> []</span>
<span id="cb26-1482"><a href="#cb26-1482" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb26-1483"><a href="#cb26-1483" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> msg <span class="kw">in</span> messages:</span>
<span id="cb26-1484"><a href="#cb26-1484" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Criar uma chave √∫nica baseada no conte√∫do e timestamp</span></span>
<span id="cb26-1485"><a href="#cb26-1485" aria-hidden="true" tabindex="-1"></a>            content_key <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>msg[<span class="st">'content'</span>][:<span class="dv">100</span>]<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>msg[<span class="st">'timestamp'</span>]<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb26-1486"><a href="#cb26-1486" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb26-1487"><a href="#cb26-1487" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> content_key <span class="kw">not</span> <span class="kw">in</span> seen:</span>
<span id="cb26-1488"><a href="#cb26-1488" aria-hidden="true" tabindex="-1"></a>                seen.add(content_key)</span>
<span id="cb26-1489"><a href="#cb26-1489" aria-hidden="true" tabindex="-1"></a>                unique_messages.append(msg)</span>
<span id="cb26-1490"><a href="#cb26-1490" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb26-1491"><a href="#cb26-1491" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> unique_messages</span>
<span id="cb26-1492"><a href="#cb26-1492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1493"><a href="#cb26-1493" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> process_chatgpt(<span class="va">self</span>, path: Path):</span>
<span id="cb26-1494"><a href="#cb26-1494" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Processa exporta√ß√£o do ChatGPT"""</span></span>
<span id="cb26-1495"><a href="#cb26-1495" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb26-1496"><a href="#cb26-1496" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="ss">f"üîÆ [DRY-RUN] Processaria ChatGPT: </span><span class="sc">{</span>path<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb26-1497"><a href="#cb26-1497" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb26-1498"><a href="#cb26-1498" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb26-1499"><a href="#cb26-1499" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb26-1500"><a href="#cb26-1500" aria-hidden="true" tabindex="-1"></a>            temp_dir <span class="op">=</span> tempfile.mkdtemp(prefix<span class="op">=</span><span class="st">"chatgpt_"</span>)</span>
<span id="cb26-1501"><a href="#cb26-1501" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> zipfile.ZipFile(path, <span class="st">'r'</span>) <span class="im">as</span> z:</span>
<span id="cb26-1502"><a href="#cb26-1502" aria-hidden="true" tabindex="-1"></a>                z.extractall(temp_dir)</span>
<span id="cb26-1503"><a href="#cb26-1503" aria-hidden="true" tabindex="-1"></a>            convs_path <span class="op">=</span> Path(temp_dir) <span class="op">/</span> <span class="st">"conversations.json"</span></span>
<span id="cb26-1504"><a href="#cb26-1504" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> convs_path.exists():</span>
<span id="cb26-1505"><a href="#cb26-1505" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.error(<span class="st">"‚ùå ChatGPT: conversations.json n√£o encontrado."</span>)</span>
<span id="cb26-1506"><a href="#cb26-1506" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span></span>
<span id="cb26-1507"><a href="#cb26-1507" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb26-1508"><a href="#cb26-1508" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(convs_path, <span class="st">'r'</span>, encoding<span class="op">=</span><span class="st">'utf-8'</span>) <span class="im">as</span> f:</span>
<span id="cb26-1509"><a href="#cb26-1509" aria-hidden="true" tabindex="-1"></a>                data <span class="op">=</span> json.load(f)</span>
<span id="cb26-1510"><a href="#cb26-1510" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb26-1511"><a href="#cb26-1511" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(data, <span class="bu">list</span>):</span>
<span id="cb26-1512"><a href="#cb26-1512" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.warning(<span class="st">"‚ö†Ô∏è  ChatGPT: estrutura inesperada."</span>)</span>
<span id="cb26-1513"><a href="#cb26-1513" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span></span>
<span id="cb26-1514"><a href="#cb26-1514" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb26-1515"><a href="#cb26-1515" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="ss">f"üîç ChatGPT: encontradas </span><span class="sc">{</span><span class="bu">len</span>(data)<span class="sc">}</span><span class="ss"> conversas."</span>)</span>
<span id="cb26-1516"><a href="#cb26-1516" aria-hidden="true" tabindex="-1"></a>            processed_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb26-1517"><a href="#cb26-1517" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb26-1518"><a href="#cb26-1518" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> i, conv <span class="kw">in</span> <span class="bu">enumerate</span>(data):</span>
<span id="cb26-1519"><a href="#cb26-1519" aria-hidden="true" tabindex="-1"></a>                original_title <span class="op">=</span> conv.get(<span class="st">'title'</span>, <span class="ss">f'Conversa ChatGPT </span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb26-1520"><a href="#cb26-1520" aria-hidden="true" tabindex="-1"></a>                <span class="co"># PRESERVA t√≠tulo original com espa√ßos</span></span>
<span id="cb26-1521"><a href="#cb26-1521" aria-hidden="true" tabindex="-1"></a>                clean_title <span class="op">=</span> <span class="va">self</span>.preserve_original_title(original_title)</span>
<span id="cb26-1522"><a href="#cb26-1522" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb26-1523"><a href="#cb26-1523" aria-hidden="true" tabindex="-1"></a>                messages <span class="op">=</span> []</span>
<span id="cb26-1524"><a href="#cb26-1524" aria-hidden="true" tabindex="-1"></a>                mapping <span class="op">=</span> conv.get(<span class="st">'mapping'</span>, {})</span>
<span id="cb26-1525"><a href="#cb26-1525" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb26-1526"><a href="#cb26-1526" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> msg_id, node <span class="kw">in</span> mapping.items():</span>
<span id="cb26-1527"><a href="#cb26-1527" aria-hidden="true" tabindex="-1"></a>                    msg_data <span class="op">=</span> node.get(<span class="st">'message'</span>)</span>
<span id="cb26-1528"><a href="#cb26-1528" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="kw">not</span> msg_data <span class="kw">or</span> <span class="kw">not</span> <span class="bu">isinstance</span>(msg_data, <span class="bu">dict</span>):</span>
<span id="cb26-1529"><a href="#cb26-1529" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb26-1530"><a href="#cb26-1530" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb26-1531"><a href="#cb26-1531" aria-hidden="true" tabindex="-1"></a>                    author_role <span class="op">=</span> msg_data.get(<span class="st">'author'</span>, {}).get(<span class="st">'role'</span>, <span class="st">''</span>)</span>
<span id="cb26-1532"><a href="#cb26-1532" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> author_role <span class="op">==</span> <span class="st">'user'</span>:</span>
<span id="cb26-1533"><a href="#cb26-1533" aria-hidden="true" tabindex="-1"></a>                        author <span class="op">=</span> <span class="st">"üë§ Utilizador"</span></span>
<span id="cb26-1534"><a href="#cb26-1534" aria-hidden="true" tabindex="-1"></a>                        role <span class="op">=</span> <span class="st">'user'</span></span>
<span id="cb26-1535"><a href="#cb26-1535" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">elif</span> author_role <span class="op">==</span> <span class="st">'assistant'</span>:</span>
<span id="cb26-1536"><a href="#cb26-1536" aria-hidden="true" tabindex="-1"></a>                        author <span class="op">=</span> <span class="st">"ü§ñ ChatGPT"</span></span>
<span id="cb26-1537"><a href="#cb26-1537" aria-hidden="true" tabindex="-1"></a>                        role <span class="op">=</span> <span class="st">'assistant'</span></span>
<span id="cb26-1538"><a href="#cb26-1538" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">else</span>:</span>
<span id="cb26-1539"><a href="#cb26-1539" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb26-1540"><a href="#cb26-1540" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb26-1541"><a href="#cb26-1541" aria-hidden="true" tabindex="-1"></a>                    content_parts <span class="op">=</span> []</span>
<span id="cb26-1542"><a href="#cb26-1542" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">for</span> part <span class="kw">in</span> msg_data.get(<span class="st">'content'</span>, {}).get(<span class="st">'parts'</span>, []):</span>
<span id="cb26-1543"><a href="#cb26-1543" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">if</span> <span class="bu">isinstance</span>(part, <span class="bu">str</span>):</span>
<span id="cb26-1544"><a href="#cb26-1544" aria-hidden="true" tabindex="-1"></a>                            content_parts.append(part)</span>
<span id="cb26-1545"><a href="#cb26-1545" aria-hidden="true" tabindex="-1"></a>                    content <span class="op">=</span> <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>.join(content_parts).strip()</span>
<span id="cb26-1546"><a href="#cb26-1546" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb26-1547"><a href="#cb26-1547" aria-hidden="true" tabindex="-1"></a>                    content <span class="op">=</span> <span class="va">self</span>.preserve_special_content(content)</span>
<span id="cb26-1548"><a href="#cb26-1548" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb26-1549"><a href="#cb26-1549" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="kw">not</span> content:</span>
<span id="cb26-1550"><a href="#cb26-1550" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb26-1551"><a href="#cb26-1551" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb26-1552"><a href="#cb26-1552" aria-hidden="true" tabindex="-1"></a>                    messages.append({</span>
<span id="cb26-1553"><a href="#cb26-1553" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'author'</span>: author,</span>
<span id="cb26-1554"><a href="#cb26-1554" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'role'</span>: role,</span>
<span id="cb26-1555"><a href="#cb26-1555" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'content'</span>: content,</span>
<span id="cb26-1556"><a href="#cb26-1556" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'timestamp'</span>: <span class="va">self</span>.format_timestamp(msg_data.get(<span class="st">'create_time'</span>)),</span>
<span id="cb26-1557"><a href="#cb26-1557" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'model'</span>: msg_data.get(<span class="st">'model'</span>, <span class="st">'ChatGPT'</span>)</span>
<span id="cb26-1558"><a href="#cb26-1558" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb26-1559"><a href="#cb26-1559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1560"><a href="#cb26-1560" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> messages:</span>
<span id="cb26-1561"><a href="#cb26-1561" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.all_conversations.append({</span>
<span id="cb26-1562"><a href="#cb26-1562" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'title'</span>: clean_title,  <span class="co"># T√≠tulo ORIGINAL com espa√ßos</span></span>
<span id="cb26-1563"><a href="#cb26-1563" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'source'</span>: <span class="st">'ChatGPT'</span>,</span>
<span id="cb26-1564"><a href="#cb26-1564" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'id'</span>: conv.get(<span class="st">'id'</span>, <span class="ss">f'chatgpt_</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">'</span>),</span>
<span id="cb26-1565"><a href="#cb26-1565" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'inserted_at'</span>: <span class="va">self</span>.format_timestamp(conv.get(<span class="st">'create_time'</span>)),</span>
<span id="cb26-1566"><a href="#cb26-1566" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'updated_at'</span>: <span class="va">self</span>.format_timestamp(conv.get(<span class="st">'update_time'</span>)),</span>
<span id="cb26-1567"><a href="#cb26-1567" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'messages'</span>: messages,</span>
<span id="cb26-1568"><a href="#cb26-1568" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'summary'</span>: messages[<span class="dv">0</span>][<span class="st">'content'</span>][:<span class="dv">100</span>] <span class="op">+</span> <span class="st">"..."</span> <span class="cf">if</span> messages <span class="cf">else</span> <span class="st">"Sem conte√∫do"</span>,</span>
<span id="cb26-1569"><a href="#cb26-1569" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'category'</span>: <span class="st">'Geral'</span></span>
<span id="cb26-1570"><a href="#cb26-1570" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb26-1571"><a href="#cb26-1571" aria-hidden="true" tabindex="-1"></a>                    processed_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb26-1572"><a href="#cb26-1572" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb26-1573"><a href="#cb26-1573" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="ss">f"‚úÖ ChatGPT: </span><span class="sc">{</span>processed_count<span class="sc">}</span><span class="ss"> conversas processadas."</span>)</span>
<span id="cb26-1574"><a href="#cb26-1574" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb26-1575"><a href="#cb26-1575" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb26-1576"><a href="#cb26-1576" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.error(<span class="ss">f"‚ùå Erro ao processar ChatGPT: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb26-1577"><a href="#cb26-1577" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb26-1578"><a href="#cb26-1578" aria-hidden="true" tabindex="-1"></a>                traceback.print_exc()</span>
<span id="cb26-1579"><a href="#cb26-1579" aria-hidden="true" tabindex="-1"></a>        <span class="cf">finally</span>:</span>
<span id="cb26-1580"><a href="#cb26-1580" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="st">'temp_dir'</span> <span class="kw">in</span> <span class="bu">locals</span>():</span>
<span id="cb26-1581"><a href="#cb26-1581" aria-hidden="true" tabindex="-1"></a>                shutil.rmtree(temp_dir, ignore_errors<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb26-1582"><a href="#cb26-1582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1583"><a href="#cb26-1583" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> process_deepseek(<span class="va">self</span>, path: Path):</span>
<span id="cb26-1584"><a href="#cb26-1584" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Processa exporta√ß√£o do DeepSeek"""</span></span>
<span id="cb26-1585"><a href="#cb26-1585" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb26-1586"><a href="#cb26-1586" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="ss">f"üîÆ [DRY-RUN] Processaria DeepSeek: </span><span class="sc">{</span>path<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb26-1587"><a href="#cb26-1587" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb26-1588"><a href="#cb26-1588" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb26-1589"><a href="#cb26-1589" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb26-1590"><a href="#cb26-1590" aria-hidden="true" tabindex="-1"></a>            temp_dir <span class="op">=</span> tempfile.mkdtemp(prefix<span class="op">=</span><span class="st">"deepseek_"</span>)</span>
<span id="cb26-1591"><a href="#cb26-1591" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> zipfile.ZipFile(path, <span class="st">'r'</span>) <span class="im">as</span> z:</span>
<span id="cb26-1592"><a href="#cb26-1592" aria-hidden="true" tabindex="-1"></a>                z.extractall(temp_dir)</span>
<span id="cb26-1593"><a href="#cb26-1593" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb26-1594"><a href="#cb26-1594" aria-hidden="true" tabindex="-1"></a>            convs_path <span class="op">=</span> Path(temp_dir) <span class="op">/</span> <span class="st">"conversations.json"</span></span>
<span id="cb26-1595"><a href="#cb26-1595" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> convs_path.exists():</span>
<span id="cb26-1596"><a href="#cb26-1596" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.error(<span class="st">"‚ùå DeepSeek: conversations.json n√£o encontrado."</span>)</span>
<span id="cb26-1597"><a href="#cb26-1597" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span></span>
<span id="cb26-1598"><a href="#cb26-1598" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb26-1599"><a href="#cb26-1599" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(convs_path, <span class="st">'r'</span>, encoding<span class="op">=</span><span class="st">'utf-8'</span>) <span class="im">as</span> f:</span>
<span id="cb26-1600"><a href="#cb26-1600" aria-hidden="true" tabindex="-1"></a>                raw_data <span class="op">=</span> json.load(f)</span>
<span id="cb26-1601"><a href="#cb26-1601" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb26-1602"><a href="#cb26-1602" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">isinstance</span>(raw_data, <span class="bu">list</span>):</span>
<span id="cb26-1603"><a href="#cb26-1603" aria-hidden="true" tabindex="-1"></a>                data <span class="op">=</span> raw_data</span>
<span id="cb26-1604"><a href="#cb26-1604" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> <span class="bu">isinstance</span>(raw_data, <span class="bu">dict</span>) <span class="kw">and</span> <span class="st">'data'</span> <span class="kw">in</span> raw_data:</span>
<span id="cb26-1605"><a href="#cb26-1605" aria-hidden="true" tabindex="-1"></a>                data <span class="op">=</span> raw_data[<span class="st">'data'</span>]</span>
<span id="cb26-1606"><a href="#cb26-1606" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb26-1607"><a href="#cb26-1607" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.warning(<span class="st">"‚ö†Ô∏è  DeepSeek: estrutura inesperada."</span>)</span>
<span id="cb26-1608"><a href="#cb26-1608" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span></span>
<span id="cb26-1609"><a href="#cb26-1609" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb26-1610"><a href="#cb26-1610" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(data, <span class="bu">list</span>):</span>
<span id="cb26-1611"><a href="#cb26-1611" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.warning(<span class="st">"‚ö†Ô∏è  DeepSeek: 'data' n√£o √© uma lista."</span>)</span>
<span id="cb26-1612"><a href="#cb26-1612" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span></span>
<span id="cb26-1613"><a href="#cb26-1613" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb26-1614"><a href="#cb26-1614" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="ss">f"üîç DeepSeek: encontradas </span><span class="sc">{</span><span class="bu">len</span>(data)<span class="sc">}</span><span class="ss"> conversas."</span>)</span>
<span id="cb26-1615"><a href="#cb26-1615" aria-hidden="true" tabindex="-1"></a>            processed_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb26-1616"><a href="#cb26-1616" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb26-1617"><a href="#cb26-1617" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> i, conv <span class="kw">in</span> <span class="bu">enumerate</span>(data):</span>
<span id="cb26-1618"><a href="#cb26-1618" aria-hidden="true" tabindex="-1"></a>                original_title <span class="op">=</span> conv.get(<span class="st">'title'</span>, <span class="ss">f'Conversa DeepSeek </span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb26-1619"><a href="#cb26-1619" aria-hidden="true" tabindex="-1"></a>                <span class="co"># PRESERVA t√≠tulo original com espa√ßos</span></span>
<span id="cb26-1620"><a href="#cb26-1620" aria-hidden="true" tabindex="-1"></a>                clean_title <span class="op">=</span> <span class="va">self</span>.preserve_original_title(original_title)</span>
<span id="cb26-1621"><a href="#cb26-1621" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb26-1622"><a href="#cb26-1622" aria-hidden="true" tabindex="-1"></a>                messages <span class="op">=</span> []</span>
<span id="cb26-1623"><a href="#cb26-1623" aria-hidden="true" tabindex="-1"></a>                mapping <span class="op">=</span> conv.get(<span class="st">'mapping'</span>, {})</span>
<span id="cb26-1624"><a href="#cb26-1624" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb26-1625"><a href="#cb26-1625" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> node_id, node <span class="kw">in</span> mapping.items():</span>
<span id="cb26-1626"><a href="#cb26-1626" aria-hidden="true" tabindex="-1"></a>                    msg_data <span class="op">=</span> node.get(<span class="st">'message'</span>)</span>
<span id="cb26-1627"><a href="#cb26-1627" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="kw">not</span> msg_data <span class="kw">or</span> <span class="kw">not</span> <span class="bu">isinstance</span>(msg_data, <span class="bu">dict</span>):</span>
<span id="cb26-1628"><a href="#cb26-1628" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb26-1629"><a href="#cb26-1629" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb26-1630"><a href="#cb26-1630" aria-hidden="true" tabindex="-1"></a>                    fragments <span class="op">=</span> msg_data.get(<span class="st">'fragments'</span>, [])</span>
<span id="cb26-1631"><a href="#cb26-1631" aria-hidden="true" tabindex="-1"></a>                    content_parts <span class="op">=</span> []</span>
<span id="cb26-1632"><a href="#cb26-1632" aria-hidden="true" tabindex="-1"></a>                    msg_type <span class="op">=</span> <span class="va">None</span></span>
<span id="cb26-1633"><a href="#cb26-1633" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb26-1634"><a href="#cb26-1634" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">for</span> frag <span class="kw">in</span> fragments:</span>
<span id="cb26-1635"><a href="#cb26-1635" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">if</span> <span class="bu">isinstance</span>(frag, <span class="bu">dict</span>):</span>
<span id="cb26-1636"><a href="#cb26-1636" aria-hidden="true" tabindex="-1"></a>                            frag_type <span class="op">=</span> frag.get(<span class="st">'type'</span>, <span class="st">''</span>).upper()</span>
<span id="cb26-1637"><a href="#cb26-1637" aria-hidden="true" tabindex="-1"></a>                            <span class="cf">if</span> frag_type <span class="kw">in</span> (<span class="st">'REQUEST'</span>, <span class="st">'RESPONSE'</span>):</span>
<span id="cb26-1638"><a href="#cb26-1638" aria-hidden="true" tabindex="-1"></a>                                msg_type <span class="op">=</span> frag_type</span>
<span id="cb26-1639"><a href="#cb26-1639" aria-hidden="true" tabindex="-1"></a>                            text <span class="op">=</span> frag.get(<span class="st">'text'</span>, <span class="st">''</span>)</span>
<span id="cb26-1640"><a href="#cb26-1640" aria-hidden="true" tabindex="-1"></a>                            <span class="cf">if</span> text:</span>
<span id="cb26-1641"><a href="#cb26-1641" aria-hidden="true" tabindex="-1"></a>                                content_parts.append(text)</span>
<span id="cb26-1642"><a href="#cb26-1642" aria-hidden="true" tabindex="-1"></a>                            content <span class="op">=</span> frag.get(<span class="st">'content'</span>, <span class="st">''</span>)</span>
<span id="cb26-1643"><a href="#cb26-1643" aria-hidden="true" tabindex="-1"></a>                            <span class="cf">if</span> content:</span>
<span id="cb26-1644"><a href="#cb26-1644" aria-hidden="true" tabindex="-1"></a>                                <span class="cf">if</span> <span class="bu">isinstance</span>(content, <span class="bu">list</span>):</span>
<span id="cb26-1645"><a href="#cb26-1645" aria-hidden="true" tabindex="-1"></a>                                    <span class="cf">for</span> item <span class="kw">in</span> content:</span>
<span id="cb26-1646"><a href="#cb26-1646" aria-hidden="true" tabindex="-1"></a>                                        <span class="cf">if</span> <span class="bu">isinstance</span>(item, <span class="bu">str</span>):</span>
<span id="cb26-1647"><a href="#cb26-1647" aria-hidden="true" tabindex="-1"></a>                                            content_parts.append(item)</span>
<span id="cb26-1648"><a href="#cb26-1648" aria-hidden="true" tabindex="-1"></a>                                        <span class="cf">elif</span> <span class="bu">isinstance</span>(item, <span class="bu">dict</span>):</span>
<span id="cb26-1649"><a href="#cb26-1649" aria-hidden="true" tabindex="-1"></a>                                            item_text <span class="op">=</span> item.get(<span class="st">'text'</span>, <span class="st">''</span>)</span>
<span id="cb26-1650"><a href="#cb26-1650" aria-hidden="true" tabindex="-1"></a>                                            <span class="cf">if</span> item_text:</span>
<span id="cb26-1651"><a href="#cb26-1651" aria-hidden="true" tabindex="-1"></a>                                                content_parts.append(<span class="bu">str</span>(item_text))</span>
<span id="cb26-1652"><a href="#cb26-1652" aria-hidden="true" tabindex="-1"></a>                                <span class="cf">else</span>:</span>
<span id="cb26-1653"><a href="#cb26-1653" aria-hidden="true" tabindex="-1"></a>                                    content_parts.append(<span class="bu">str</span>(content))</span>
<span id="cb26-1654"><a href="#cb26-1654" aria-hidden="true" tabindex="-1"></a>                                    </span>
<span id="cb26-1655"><a href="#cb26-1655" aria-hidden="true" tabindex="-1"></a>                    content <span class="op">=</span> <span class="st">' '</span>.join(content_parts).strip()</span>
<span id="cb26-1656"><a href="#cb26-1656" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb26-1657"><a href="#cb26-1657" aria-hidden="true" tabindex="-1"></a>                    content <span class="op">=</span> <span class="va">self</span>.preserve_special_content(content)</span>
<span id="cb26-1658"><a href="#cb26-1658" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb26-1659"><a href="#cb26-1659" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="kw">not</span> content:</span>
<span id="cb26-1660"><a href="#cb26-1660" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb26-1661"><a href="#cb26-1661" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb26-1662"><a href="#cb26-1662" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> msg_type <span class="op">==</span> <span class="st">'REQUEST'</span>:</span>
<span id="cb26-1663"><a href="#cb26-1663" aria-hidden="true" tabindex="-1"></a>                        author <span class="op">=</span> <span class="st">"üë§ Utilizador"</span></span>
<span id="cb26-1664"><a href="#cb26-1664" aria-hidden="true" tabindex="-1"></a>                        role <span class="op">=</span> <span class="st">'user'</span></span>
<span id="cb26-1665"><a href="#cb26-1665" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">else</span>:</span>
<span id="cb26-1666"><a href="#cb26-1666" aria-hidden="true" tabindex="-1"></a>                        author <span class="op">=</span> <span class="st">"ü§ñ DeepSeek"</span></span>
<span id="cb26-1667"><a href="#cb26-1667" aria-hidden="true" tabindex="-1"></a>                        role <span class="op">=</span> <span class="st">'assistant'</span></span>
<span id="cb26-1668"><a href="#cb26-1668" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb26-1669"><a href="#cb26-1669" aria-hidden="true" tabindex="-1"></a>                    messages.append({</span>
<span id="cb26-1670"><a href="#cb26-1670" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'author'</span>: author,</span>
<span id="cb26-1671"><a href="#cb26-1671" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'role'</span>: role,</span>
<span id="cb26-1672"><a href="#cb26-1672" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'content'</span>: content,</span>
<span id="cb26-1673"><a href="#cb26-1673" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'timestamp'</span>: <span class="va">self</span>.format_timestamp(msg_data.get(<span class="st">'inserted_at'</span>)),</span>
<span id="cb26-1674"><a href="#cb26-1674" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'model'</span>: msg_data.get(<span class="st">'model'</span>, <span class="st">'DeepSeek'</span>)</span>
<span id="cb26-1675"><a href="#cb26-1675" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb26-1676"><a href="#cb26-1676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1677"><a href="#cb26-1677" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> messages:</span>
<span id="cb26-1678"><a href="#cb26-1678" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.all_conversations.append({</span>
<span id="cb26-1679"><a href="#cb26-1679" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'title'</span>: clean_title,  <span class="co"># T√≠tulo ORIGINAL com espa√ßos</span></span>
<span id="cb26-1680"><a href="#cb26-1680" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'source'</span>: <span class="st">'DeepSeek'</span>,</span>
<span id="cb26-1681"><a href="#cb26-1681" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'id'</span>: conv.get(<span class="st">'id'</span>, <span class="ss">f'deepseek_</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">'</span>),</span>
<span id="cb26-1682"><a href="#cb26-1682" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'inserted_at'</span>: <span class="va">self</span>.format_timestamp(conv.get(<span class="st">'inserted_at'</span>)),</span>
<span id="cb26-1683"><a href="#cb26-1683" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'updated_at'</span>: <span class="va">self</span>.format_timestamp(conv.get(<span class="st">'updated_at'</span>)),</span>
<span id="cb26-1684"><a href="#cb26-1684" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'messages'</span>: messages,</span>
<span id="cb26-1685"><a href="#cb26-1685" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'summary'</span>: messages[<span class="dv">0</span>][<span class="st">'content'</span>][:<span class="dv">100</span>] <span class="op">+</span> <span class="st">"..."</span> <span class="cf">if</span> messages <span class="cf">else</span> <span class="st">"Sem conte√∫do"</span>,</span>
<span id="cb26-1686"><a href="#cb26-1686" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'category'</span>: <span class="st">'Geral'</span></span>
<span id="cb26-1687"><a href="#cb26-1687" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb26-1688"><a href="#cb26-1688" aria-hidden="true" tabindex="-1"></a>                    processed_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb26-1689"><a href="#cb26-1689" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb26-1690"><a href="#cb26-1690" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="ss">f"‚úÖ DeepSeek: </span><span class="sc">{</span>processed_count<span class="sc">}</span><span class="ss"> conversas processadas."</span>)</span>
<span id="cb26-1691"><a href="#cb26-1691" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb26-1692"><a href="#cb26-1692" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb26-1693"><a href="#cb26-1693" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.error(<span class="ss">f"‚ùå Erro ao processar DeepSeek: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb26-1694"><a href="#cb26-1694" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb26-1695"><a href="#cb26-1695" aria-hidden="true" tabindex="-1"></a>                traceback.print_exc()</span>
<span id="cb26-1696"><a href="#cb26-1696" aria-hidden="true" tabindex="-1"></a>        <span class="cf">finally</span>:</span>
<span id="cb26-1697"><a href="#cb26-1697" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="st">'temp_dir'</span> <span class="kw">in</span> <span class="bu">locals</span>():</span>
<span id="cb26-1698"><a href="#cb26-1698" aria-hidden="true" tabindex="-1"></a>                shutil.rmtree(temp_dir, ignore_errors<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb26-1699"><a href="#cb26-1699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1700"><a href="#cb26-1700" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> process_grok(<span class="va">self</span>, path: Path):</span>
<span id="cb26-1701"><a href="#cb26-1701" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Processa exporta√ß√£o do Grok"""</span></span>
<span id="cb26-1702"><a href="#cb26-1702" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb26-1703"><a href="#cb26-1703" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="ss">f"üîÆ [DRY-RUN] Processaria Grok: </span><span class="sc">{</span>path<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb26-1704"><a href="#cb26-1704" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb26-1705"><a href="#cb26-1705" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb26-1706"><a href="#cb26-1706" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb26-1707"><a href="#cb26-1707" aria-hidden="true" tabindex="-1"></a>            temp_dir <span class="op">=</span> tempfile.mkdtemp(prefix<span class="op">=</span><span class="st">"grok_"</span>)</span>
<span id="cb26-1708"><a href="#cb26-1708" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> zipfile.ZipFile(path, <span class="st">'r'</span>) <span class="im">as</span> z:</span>
<span id="cb26-1709"><a href="#cb26-1709" aria-hidden="true" tabindex="-1"></a>                z.extractall(temp_dir)</span>
<span id="cb26-1710"><a href="#cb26-1710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1711"><a href="#cb26-1711" aria-hidden="true" tabindex="-1"></a>            target_file <span class="op">=</span> <span class="va">None</span></span>
<span id="cb26-1712"><a href="#cb26-1712" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> root, _, files <span class="kw">in</span> os.walk(temp_dir):</span>
<span id="cb26-1713"><a href="#cb26-1713" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> <span class="bu">file</span> <span class="kw">in</span> files:</span>
<span id="cb26-1714"><a href="#cb26-1714" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="bu">file</span> <span class="op">==</span> <span class="st">"prod-grok-backend.json"</span>:</span>
<span id="cb26-1715"><a href="#cb26-1715" aria-hidden="true" tabindex="-1"></a>                        target_file <span class="op">=</span> Path(root) <span class="op">/</span> <span class="bu">file</span></span>
<span id="cb26-1716"><a href="#cb26-1716" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">break</span></span>
<span id="cb26-1717"><a href="#cb26-1717" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> target_file:</span>
<span id="cb26-1718"><a href="#cb26-1718" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">break</span></span>
<span id="cb26-1719"><a href="#cb26-1719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1720"><a href="#cb26-1720" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> target_file:</span>
<span id="cb26-1721"><a href="#cb26-1721" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.error(<span class="st">"‚ùå Grok: ficheiro 'prod-grok-backend.json' n√£o encontrado no ZIP."</span>)</span>
<span id="cb26-1722"><a href="#cb26-1722" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span></span>
<span id="cb26-1723"><a href="#cb26-1723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1724"><a href="#cb26-1724" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="ss">f"üîç Grok: carregando </span><span class="sc">{</span>target_file<span class="sc">.</span>name<span class="sc">}</span><span class="ss">..."</span>)</span>
<span id="cb26-1725"><a href="#cb26-1725" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(target_file, <span class="st">'r'</span>, encoding<span class="op">=</span><span class="st">'utf-8'</span>) <span class="im">as</span> f:</span>
<span id="cb26-1726"><a href="#cb26-1726" aria-hidden="true" tabindex="-1"></a>                data <span class="op">=</span> json.load(f)</span>
<span id="cb26-1727"><a href="#cb26-1727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1728"><a href="#cb26-1728" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(data, <span class="bu">dict</span>) <span class="kw">or</span> <span class="st">'conversations'</span> <span class="kw">not</span> <span class="kw">in</span> data:</span>
<span id="cb26-1729"><a href="#cb26-1729" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.error(<span class="st">"‚ùå Grok: estrutura inesperada ‚Äî chave 'conversations' n√£o encontrada."</span>)</span>
<span id="cb26-1730"><a href="#cb26-1730" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span></span>
<span id="cb26-1731"><a href="#cb26-1731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1732"><a href="#cb26-1732" aria-hidden="true" tabindex="-1"></a>            conversations_list <span class="op">=</span> data[<span class="st">'conversations'</span>]</span>
<span id="cb26-1733"><a href="#cb26-1733" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(conversations_list, <span class="bu">list</span>):</span>
<span id="cb26-1734"><a href="#cb26-1734" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.error(<span class="st">"‚ùå Grok: 'conversations' n√£o √© uma lista."</span>)</span>
<span id="cb26-1735"><a href="#cb26-1735" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span></span>
<span id="cb26-1736"><a href="#cb26-1736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1737"><a href="#cb26-1737" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="ss">f"üìä Grok: encontradas </span><span class="sc">{</span><span class="bu">len</span>(conversations_list)<span class="sc">}</span><span class="ss"> conversas."</span>)</span>
<span id="cb26-1738"><a href="#cb26-1738" aria-hidden="true" tabindex="-1"></a>            total_convs <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb26-1739"><a href="#cb26-1739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1740"><a href="#cb26-1740" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> item <span class="kw">in</span> conversations_list:</span>
<span id="cb26-1741"><a href="#cb26-1741" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(item, <span class="bu">dict</span>):</span>
<span id="cb26-1742"><a href="#cb26-1742" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">continue</span></span>
<span id="cb26-1743"><a href="#cb26-1743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1744"><a href="#cb26-1744" aria-hidden="true" tabindex="-1"></a>                conv_meta <span class="op">=</span> item.get(<span class="st">'conversation'</span>)</span>
<span id="cb26-1745"><a href="#cb26-1745" aria-hidden="true" tabindex="-1"></a>                responses <span class="op">=</span> item.get(<span class="st">'responses'</span>, [])</span>
<span id="cb26-1746"><a href="#cb26-1746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1747"><a href="#cb26-1747" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(conv_meta, <span class="bu">dict</span>) <span class="kw">or</span> <span class="kw">not</span> <span class="bu">isinstance</span>(responses, <span class="bu">list</span>) <span class="kw">or</span> <span class="kw">not</span> responses:</span>
<span id="cb26-1748"><a href="#cb26-1748" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">continue</span></span>
<span id="cb26-1749"><a href="#cb26-1749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1750"><a href="#cb26-1750" aria-hidden="true" tabindex="-1"></a>                conv_id <span class="op">=</span> conv_meta.get(<span class="st">'id'</span>)</span>
<span id="cb26-1751"><a href="#cb26-1751" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="kw">not</span> conv_id:</span>
<span id="cb26-1752"><a href="#cb26-1752" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">continue</span></span>
<span id="cb26-1753"><a href="#cb26-1753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1754"><a href="#cb26-1754" aria-hidden="true" tabindex="-1"></a>                original_title <span class="op">=</span> conv_meta.get(<span class="st">'title'</span>, <span class="ss">f"Conversa Grok </span><span class="sc">{</span>total_convs <span class="op">+</span> <span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb26-1755"><a href="#cb26-1755" aria-hidden="true" tabindex="-1"></a>                <span class="co"># PRESERVA t√≠tulo original com espa√ßos</span></span>
<span id="cb26-1756"><a href="#cb26-1756" aria-hidden="true" tabindex="-1"></a>                clean_title <span class="op">=</span> <span class="va">self</span>.preserve_original_title(original_title)</span>
<span id="cb26-1757"><a href="#cb26-1757" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb26-1758"><a href="#cb26-1758" aria-hidden="true" tabindex="-1"></a>                create_time_str <span class="op">=</span> conv_meta.get(<span class="st">'create_time'</span>)</span>
<span id="cb26-1759"><a href="#cb26-1759" aria-hidden="true" tabindex="-1"></a>                modify_time_str <span class="op">=</span> conv_meta.get(<span class="st">'modify_time'</span>)</span>
<span id="cb26-1760"><a href="#cb26-1760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1761"><a href="#cb26-1761" aria-hidden="true" tabindex="-1"></a>                <span class="kw">def</span> format_iso_timestamp(ts_str):</span>
<span id="cb26-1762"><a href="#cb26-1762" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="kw">not</span> ts_str:</span>
<span id="cb26-1763"><a href="#cb26-1763" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb26-1764"><a href="#cb26-1764" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">try</span>:</span>
<span id="cb26-1765"><a href="#cb26-1765" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">if</span> <span class="st">'.'</span> <span class="kw">in</span> ts_str:</span>
<span id="cb26-1766"><a href="#cb26-1766" aria-hidden="true" tabindex="-1"></a>                            ts_str <span class="op">=</span> ts_str.split(<span class="st">'.'</span>)[<span class="dv">0</span>] <span class="op">+</span> <span class="st">'Z'</span></span>
<span id="cb26-1767"><a href="#cb26-1767" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">return</span> <span class="va">self</span>.format_timestamp(ts_str)</span>
<span id="cb26-1768"><a href="#cb26-1768" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">except</span>:</span>
<span id="cb26-1769"><a href="#cb26-1769" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">return</span> <span class="bu">str</span>(ts_str)</span>
<span id="cb26-1770"><a href="#cb26-1770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1771"><a href="#cb26-1771" aria-hidden="true" tabindex="-1"></a>                inserted_at <span class="op">=</span> format_iso_timestamp(create_time_str)</span>
<span id="cb26-1772"><a href="#cb26-1772" aria-hidden="true" tabindex="-1"></a>                updated_at <span class="op">=</span> format_iso_timestamp(modify_time_str)</span>
<span id="cb26-1773"><a href="#cb26-1773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1774"><a href="#cb26-1774" aria-hidden="true" tabindex="-1"></a>                messages <span class="op">=</span> []</span>
<span id="cb26-1775"><a href="#cb26-1775" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> resp <span class="kw">in</span> responses:</span>
<span id="cb26-1776"><a href="#cb26-1776" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(resp, <span class="bu">dict</span>):</span>
<span id="cb26-1777"><a href="#cb26-1777" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb26-1778"><a href="#cb26-1778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1779"><a href="#cb26-1779" aria-hidden="true" tabindex="-1"></a>                    resp_data <span class="op">=</span> resp.get(<span class="st">'response'</span>)</span>
<span id="cb26-1780"><a href="#cb26-1780" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(resp_data, <span class="bu">dict</span>):</span>
<span id="cb26-1781"><a href="#cb26-1781" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb26-1782"><a href="#cb26-1782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1783"><a href="#cb26-1783" aria-hidden="true" tabindex="-1"></a>                    sender <span class="op">=</span> resp_data.get(<span class="st">'sender'</span>, <span class="st">''</span>).upper()</span>
<span id="cb26-1784"><a href="#cb26-1784" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> sender <span class="op">==</span> <span class="st">'HUMAN'</span>:</span>
<span id="cb26-1785"><a href="#cb26-1785" aria-hidden="true" tabindex="-1"></a>                        author <span class="op">=</span> <span class="st">"üë§ Utilizador"</span></span>
<span id="cb26-1786"><a href="#cb26-1786" aria-hidden="true" tabindex="-1"></a>                        role <span class="op">=</span> <span class="st">"user"</span></span>
<span id="cb26-1787"><a href="#cb26-1787" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">elif</span> sender <span class="op">==</span> <span class="st">'ASSISTANT'</span>:</span>
<span id="cb26-1788"><a href="#cb26-1788" aria-hidden="true" tabindex="-1"></a>                        author <span class="op">=</span> <span class="st">"ü§ñ Grok"</span></span>
<span id="cb26-1789"><a href="#cb26-1789" aria-hidden="true" tabindex="-1"></a>                        role <span class="op">=</span> <span class="st">"assistant"</span></span>
<span id="cb26-1790"><a href="#cb26-1790" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">else</span>:</span>
<span id="cb26-1791"><a href="#cb26-1791" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb26-1792"><a href="#cb26-1792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1793"><a href="#cb26-1793" aria-hidden="true" tabindex="-1"></a>                    content <span class="op">=</span> <span class="bu">str</span>(resp_data.get(<span class="st">'message'</span>, <span class="st">''</span>)).strip()</span>
<span id="cb26-1794"><a href="#cb26-1794" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb26-1795"><a href="#cb26-1795" aria-hidden="true" tabindex="-1"></a>                    content <span class="op">=</span> <span class="va">self</span>.preserve_special_content(content)</span>
<span id="cb26-1796"><a href="#cb26-1796" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb26-1797"><a href="#cb26-1797" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="kw">not</span> content:</span>
<span id="cb26-1798"><a href="#cb26-1798" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">continue</span></span>
<span id="cb26-1799"><a href="#cb26-1799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1800"><a href="#cb26-1800" aria-hidden="true" tabindex="-1"></a>                    create_time <span class="op">=</span> resp_data.get(<span class="st">'create_time'</span>)</span>
<span id="cb26-1801"><a href="#cb26-1801" aria-hidden="true" tabindex="-1"></a>                    timestamp_ms <span class="op">=</span> <span class="va">None</span></span>
<span id="cb26-1802"><a href="#cb26-1802" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="bu">isinstance</span>(create_time, <span class="bu">dict</span>) <span class="kw">and</span> <span class="st">'$date'</span> <span class="kw">in</span> create_time:</span>
<span id="cb26-1803"><a href="#cb26-1803" aria-hidden="true" tabindex="-1"></a>                        date_obj <span class="op">=</span> create_time[<span class="st">'$date'</span>]</span>
<span id="cb26-1804"><a href="#cb26-1804" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">if</span> <span class="bu">isinstance</span>(date_obj, <span class="bu">dict</span>) <span class="kw">and</span> <span class="st">'$numberLong'</span> <span class="kw">in</span> date_obj:</span>
<span id="cb26-1805"><a href="#cb26-1805" aria-hidden="true" tabindex="-1"></a>                            <span class="cf">try</span>:</span>
<span id="cb26-1806"><a href="#cb26-1806" aria-hidden="true" tabindex="-1"></a>                                timestamp_ms <span class="op">=</span> <span class="bu">int</span>(date_obj[<span class="st">'$numberLong'</span>])</span>
<span id="cb26-1807"><a href="#cb26-1807" aria-hidden="true" tabindex="-1"></a>                            <span class="cf">except</span>:</span>
<span id="cb26-1808"><a href="#cb26-1808" aria-hidden="true" tabindex="-1"></a>                                <span class="cf">pass</span></span>
<span id="cb26-1809"><a href="#cb26-1809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1810"><a href="#cb26-1810" aria-hidden="true" tabindex="-1"></a>                    messages.append({</span>
<span id="cb26-1811"><a href="#cb26-1811" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'author'</span>: author,</span>
<span id="cb26-1812"><a href="#cb26-1812" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'role'</span>: role,</span>
<span id="cb26-1813"><a href="#cb26-1813" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'content'</span>: content,</span>
<span id="cb26-1814"><a href="#cb26-1814" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'timestamp'</span>: <span class="va">self</span>.format_timestamp(timestamp_ms <span class="op">/</span> <span class="fl">1000.0</span> <span class="cf">if</span> timestamp_ms <span class="cf">else</span> <span class="va">None</span>),</span>
<span id="cb26-1815"><a href="#cb26-1815" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'model'</span>: <span class="st">'Grok'</span></span>
<span id="cb26-1816"><a href="#cb26-1816" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb26-1817"><a href="#cb26-1817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1818"><a href="#cb26-1818" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> messages:</span>
<span id="cb26-1819"><a href="#cb26-1819" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.all_conversations.append({</span>
<span id="cb26-1820"><a href="#cb26-1820" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'title'</span>: clean_title,  <span class="co"># T√≠tulo ORIGINAL com espa√ßos</span></span>
<span id="cb26-1821"><a href="#cb26-1821" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'source'</span>: <span class="st">'Grok'</span>,</span>
<span id="cb26-1822"><a href="#cb26-1822" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'id'</span>: conv_id,</span>
<span id="cb26-1823"><a href="#cb26-1823" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'inserted_at'</span>: inserted_at,</span>
<span id="cb26-1824"><a href="#cb26-1824" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'updated_at'</span>: updated_at,</span>
<span id="cb26-1825"><a href="#cb26-1825" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'messages'</span>: messages,</span>
<span id="cb26-1826"><a href="#cb26-1826" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'summary'</span>: messages[<span class="dv">0</span>][<span class="st">'content'</span>][:<span class="dv">100</span>] <span class="op">+</span> <span class="st">"..."</span> <span class="cf">if</span> messages <span class="cf">else</span> <span class="st">"Sem conte√∫do"</span>,</span>
<span id="cb26-1827"><a href="#cb26-1827" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'category'</span>: <span class="st">'Geral'</span></span>
<span id="cb26-1828"><a href="#cb26-1828" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb26-1829"><a href="#cb26-1829" aria-hidden="true" tabindex="-1"></a>                    total_convs <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb26-1830"><a href="#cb26-1830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1831"><a href="#cb26-1831" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> total_convs <span class="op">></span> <span class="dv">0</span>:</span>
<span id="cb26-1832"><a href="#cb26-1832" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.info(<span class="ss">f"‚úÖ Grok: processadas </span><span class="sc">{</span>total_convs<span class="sc">}</span><span class="ss"> conversas."</span>)</span>
<span id="cb26-1833"><a href="#cb26-1833" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb26-1834"><a href="#cb26-1834" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.error(<span class="st">"‚ùå Grok: nenhuma conversa v√°lida encontrada."</span>)</span>
<span id="cb26-1835"><a href="#cb26-1835" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1836"><a href="#cb26-1836" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb26-1837"><a href="#cb26-1837" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.error(<span class="ss">f"‚ùå Erro ao processar Grok: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb26-1838"><a href="#cb26-1838" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb26-1839"><a href="#cb26-1839" aria-hidden="true" tabindex="-1"></a>                traceback.print_exc()</span>
<span id="cb26-1840"><a href="#cb26-1840" aria-hidden="true" tabindex="-1"></a>        <span class="cf">finally</span>:</span>
<span id="cb26-1841"><a href="#cb26-1841" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="st">'temp_dir'</span> <span class="kw">in</span> <span class="bu">locals</span>():</span>
<span id="cb26-1842"><a href="#cb26-1842" aria-hidden="true" tabindex="-1"></a>                shutil.rmtree(temp_dir, ignore_errors<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb26-1843"><a href="#cb26-1843" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1844"><a href="#cb26-1844" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> save_as_markdown_enhanced(<span class="va">self</span>):</span>
<span id="cb26-1845"><a href="#cb26-1845" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Salva conversas com preserva√ß√£o total de formata√ß√£o"""</span></span>
<span id="cb26-1846"><a href="#cb26-1846" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb26-1847"><a href="#cb26-1847" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="st">"üîÆ [DRY-RUN] Markdowns seriam criados:"</span>)</span>
<span id="cb26-1848"><a href="#cb26-1848" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> conv <span class="kw">in</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb26-1849"><a href="#cb26-1849" aria-hidden="true" tabindex="-1"></a>                safe_title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(conv[<span class="st">'title'</span>])</span>
<span id="cb26-1850"><a href="#cb26-1850" aria-hidden="true" tabindex="-1"></a>                filename <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>conv[<span class="st">'number'</span>]<span class="sc">:03d}</span><span class="ss">_</span><span class="sc">{</span>conv[<span class="st">'source'</span>]<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>safe_title<span class="sc">}</span><span class="ss">.md"</span></span>
<span id="cb26-1851"><a href="#cb26-1851" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.info(<span class="ss">f"   üìÑ </span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb26-1852"><a href="#cb26-1852" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb26-1853"><a href="#cb26-1853" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb26-1854"><a href="#cb26-1854" aria-hidden="true" tabindex="-1"></a>        folder <span class="op">=</span> Path(<span class="va">self</span>.output_dirs[<span class="st">'markdown'</span>])</span>
<span id="cb26-1855"><a href="#cb26-1855" aria-hidden="true" tabindex="-1"></a>        saved_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb26-1856"><a href="#cb26-1856" aria-hidden="true" tabindex="-1"></a>        failed_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb26-1857"><a href="#cb26-1857" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb26-1858"><a href="#cb26-1858" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> conv <span class="kw">in</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb26-1859"><a href="#cb26-1859" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb26-1860"><a href="#cb26-1860" aria-hidden="true" tabindex="-1"></a>                safe_title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(conv[<span class="st">'title'</span>])</span>
<span id="cb26-1861"><a href="#cb26-1861" aria-hidden="true" tabindex="-1"></a>                filename <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>conv[<span class="st">'number'</span>]<span class="sc">:03d}</span><span class="ss">_</span><span class="sc">{</span>conv[<span class="st">'source'</span>]<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>safe_title<span class="sc">}</span><span class="ss">.md"</span></span>
<span id="cb26-1862"><a href="#cb26-1862" aria-hidden="true" tabindex="-1"></a>                filepath <span class="op">=</span> folder <span class="op">/</span> filename</span>
<span id="cb26-1863"><a href="#cb26-1863" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb26-1864"><a href="#cb26-1864" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.force_overwrite <span class="kw">and</span> filepath.exists():</span>
<span id="cb26-1865"><a href="#cb26-1865" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">continue</span></span>
<span id="cb26-1866"><a href="#cb26-1866" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb26-1867"><a href="#cb26-1867" aria-hidden="true" tabindex="-1"></a>                markdown_content <span class="op">=</span> <span class="va">self</span>.create_enhanced_markdown_content(conv)</span>
<span id="cb26-1868"><a href="#cb26-1868" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb26-1869"><a href="#cb26-1869" aria-hidden="true" tabindex="-1"></a>                <span class="cf">with</span> <span class="bu">open</span>(filepath, <span class="st">'w'</span>, encoding<span class="op">=</span><span class="st">'utf-8'</span>) <span class="im">as</span> f:</span>
<span id="cb26-1870"><a href="#cb26-1870" aria-hidden="true" tabindex="-1"></a>                    f.write(markdown_content)</span>
<span id="cb26-1871"><a href="#cb26-1871" aria-hidden="true" tabindex="-1"></a>                saved_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb26-1872"><a href="#cb26-1872" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb26-1873"><a href="#cb26-1873" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb26-1874"><a href="#cb26-1874" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.error(<span class="ss">f"‚ùå Erro ao salvar conversa </span><span class="sc">{</span>conv[<span class="st">'number'</span>]<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb26-1875"><a href="#cb26-1875" aria-hidden="true" tabindex="-1"></a>                failed_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb26-1876"><a href="#cb26-1876" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span></span>
<span id="cb26-1877"><a href="#cb26-1877" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb26-1878"><a href="#cb26-1878" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.logger.info(<span class="ss">f"‚úÖ Markdown: </span><span class="sc">{</span>saved_count<span class="sc">}</span><span class="ss"> arquivos criados, </span><span class="sc">{</span>failed_count<span class="sc">}</span><span class="ss"> falhas em '</span><span class="sc">{</span>folder<span class="sc">}</span><span class="ss">'"</span>)</span>
<span id="cb26-1879"><a href="#cb26-1879" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1880"><a href="#cb26-1880" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> save_as_csv(<span class="va">self</span>):</span>
<span id="cb26-1881"><a href="#cb26-1881" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Salva conversas em arquivos CSV individuais"""</span></span>
<span id="cb26-1882"><a href="#cb26-1882" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb26-1883"><a href="#cb26-1883" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="st">"üîÆ [DRY-RUN] CSVs seriam criados:"</span>)</span>
<span id="cb26-1884"><a href="#cb26-1884" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> conv <span class="kw">in</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb26-1885"><a href="#cb26-1885" aria-hidden="true" tabindex="-1"></a>                safe_title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(conv[<span class="st">'title'</span>])</span>
<span id="cb26-1886"><a href="#cb26-1886" aria-hidden="true" tabindex="-1"></a>                filename <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>conv[<span class="st">'number'</span>]<span class="sc">:03d}</span><span class="ss">_</span><span class="sc">{</span>conv[<span class="st">'source'</span>]<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>safe_title<span class="sc">}</span><span class="ss">.csv"</span></span>
<span id="cb26-1887"><a href="#cb26-1887" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.info(<span class="ss">f"   üìä </span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb26-1888"><a href="#cb26-1888" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb26-1889"><a href="#cb26-1889" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb26-1890"><a href="#cb26-1890" aria-hidden="true" tabindex="-1"></a>        folder <span class="op">=</span> Path(<span class="va">self</span>.output_dirs[<span class="st">'csv'</span>])</span>
<span id="cb26-1891"><a href="#cb26-1891" aria-hidden="true" tabindex="-1"></a>        saved_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb26-1892"><a href="#cb26-1892" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb26-1893"><a href="#cb26-1893" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> conv <span class="kw">in</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb26-1894"><a href="#cb26-1894" aria-hidden="true" tabindex="-1"></a>            safe_title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(conv[<span class="st">'title'</span>])</span>
<span id="cb26-1895"><a href="#cb26-1895" aria-hidden="true" tabindex="-1"></a>            filename <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>conv[<span class="st">'number'</span>]<span class="sc">:03d}</span><span class="ss">_</span><span class="sc">{</span>conv[<span class="st">'source'</span>]<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>safe_title<span class="sc">}</span><span class="ss">.csv"</span></span>
<span id="cb26-1896"><a href="#cb26-1896" aria-hidden="true" tabindex="-1"></a>            filepath <span class="op">=</span> folder <span class="op">/</span> filename</span>
<span id="cb26-1897"><a href="#cb26-1897" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb26-1898"><a href="#cb26-1898" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.force_overwrite <span class="kw">and</span> filepath.exists():</span>
<span id="cb26-1899"><a href="#cb26-1899" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span></span>
<span id="cb26-1900"><a href="#cb26-1900" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb26-1901"><a href="#cb26-1901" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(filepath, <span class="st">'w'</span>, encoding<span class="op">=</span><span class="st">'utf-8'</span>, newline<span class="op">=</span><span class="st">''</span>) <span class="im">as</span> f:</span>
<span id="cb26-1902"><a href="#cb26-1902" aria-hidden="true" tabindex="-1"></a>                writer <span class="op">=</span> csv.DictWriter(f, fieldnames<span class="op">=</span>[</span>
<span id="cb26-1903"><a href="#cb26-1903" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'node_id'</span>, <span class="st">'author'</span>, <span class="st">'role'</span>, <span class="st">'timestamp'</span>, <span class="st">'model'</span>, <span class="st">'content'</span></span>
<span id="cb26-1904"><a href="#cb26-1904" aria-hidden="true" tabindex="-1"></a>                ])</span>
<span id="cb26-1905"><a href="#cb26-1905" aria-hidden="true" tabindex="-1"></a>                writer.writeheader()</span>
<span id="cb26-1906"><a href="#cb26-1906" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> i, msg <span class="kw">in</span> <span class="bu">enumerate</span>(conv[<span class="st">'messages'</span>]):</span>
<span id="cb26-1907"><a href="#cb26-1907" aria-hidden="true" tabindex="-1"></a>                    writer.writerow({</span>
<span id="cb26-1908"><a href="#cb26-1908" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'node_id'</span>: <span class="bu">str</span>(i),</span>
<span id="cb26-1909"><a href="#cb26-1909" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'author'</span>: msg[<span class="st">'author'</span>],</span>
<span id="cb26-1910"><a href="#cb26-1910" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'role'</span>: msg[<span class="st">'role'</span>],</span>
<span id="cb26-1911"><a href="#cb26-1911" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'timestamp'</span>: msg[<span class="st">'timestamp'</span>],</span>
<span id="cb26-1912"><a href="#cb26-1912" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'model'</span>: msg[<span class="st">'model'</span>],</span>
<span id="cb26-1913"><a href="#cb26-1913" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'content'</span>: msg[<span class="st">'content'</span>]</span>
<span id="cb26-1914"><a href="#cb26-1914" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb26-1915"><a href="#cb26-1915" aria-hidden="true" tabindex="-1"></a>            saved_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb26-1916"><a href="#cb26-1916" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb26-1917"><a href="#cb26-1917" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.logger.info(<span class="ss">f"‚úÖ CSV: </span><span class="sc">{</span>saved_count<span class="sc">}</span><span class="ss"> arquivos criados em '</span><span class="sc">{</span>folder<span class="sc">}</span><span class="ss">'"</span>)</span>
<span id="cb26-1918"><a href="#cb26-1918" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1919"><a href="#cb26-1919" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> save_as_json(<span class="va">self</span>):</span>
<span id="cb26-1920"><a href="#cb26-1920" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Salva conversas em arquivos JSON individuais"""</span></span>
<span id="cb26-1921"><a href="#cb26-1921" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb26-1922"><a href="#cb26-1922" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="st">"üîÆ [DRY-RUN] JSONs seriam criados:"</span>)</span>
<span id="cb26-1923"><a href="#cb26-1923" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> conv <span class="kw">in</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb26-1924"><a href="#cb26-1924" aria-hidden="true" tabindex="-1"></a>                safe_title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(conv[<span class="st">'title'</span>])</span>
<span id="cb26-1925"><a href="#cb26-1925" aria-hidden="true" tabindex="-1"></a>                filename <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>conv[<span class="st">'number'</span>]<span class="sc">:03d}</span><span class="ss">_</span><span class="sc">{</span>conv[<span class="st">'source'</span>]<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>safe_title<span class="sc">}</span><span class="ss">.json"</span></span>
<span id="cb26-1926"><a href="#cb26-1926" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.logger.info(<span class="ss">f"   üìã </span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb26-1927"><a href="#cb26-1927" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb26-1928"><a href="#cb26-1928" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb26-1929"><a href="#cb26-1929" aria-hidden="true" tabindex="-1"></a>        folder <span class="op">=</span> Path(<span class="va">self</span>.output_dirs[<span class="st">'json'</span>])</span>
<span id="cb26-1930"><a href="#cb26-1930" aria-hidden="true" tabindex="-1"></a>        saved_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb26-1931"><a href="#cb26-1931" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb26-1932"><a href="#cb26-1932" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> conv <span class="kw">in</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb26-1933"><a href="#cb26-1933" aria-hidden="true" tabindex="-1"></a>            safe_title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(conv[<span class="st">'title'</span>])</span>
<span id="cb26-1934"><a href="#cb26-1934" aria-hidden="true" tabindex="-1"></a>            filename <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>conv[<span class="st">'number'</span>]<span class="sc">:03d}</span><span class="ss">_</span><span class="sc">{</span>conv[<span class="st">'source'</span>]<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>safe_title<span class="sc">}</span><span class="ss">.json"</span></span>
<span id="cb26-1935"><a href="#cb26-1935" aria-hidden="true" tabindex="-1"></a>            filepath <span class="op">=</span> folder <span class="op">/</span> filename</span>
<span id="cb26-1936"><a href="#cb26-1936" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb26-1937"><a href="#cb26-1937" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.force_overwrite <span class="kw">and</span> filepath.exists():</span>
<span id="cb26-1938"><a href="#cb26-1938" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span></span>
<span id="cb26-1939"><a href="#cb26-1939" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb26-1940"><a href="#cb26-1940" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(filepath, <span class="st">'w'</span>, encoding<span class="op">=</span><span class="st">'utf-8'</span>) <span class="im">as</span> f:</span>
<span id="cb26-1941"><a href="#cb26-1941" aria-hidden="true" tabindex="-1"></a>                json.dump(conv, f, ensure_ascii<span class="op">=</span><span class="va">False</span>, indent<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb26-1942"><a href="#cb26-1942" aria-hidden="true" tabindex="-1"></a>            saved_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb26-1943"><a href="#cb26-1943" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb26-1944"><a href="#cb26-1944" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.logger.info(<span class="ss">f"‚úÖ JSON: </span><span class="sc">{</span>saved_count<span class="sc">}</span><span class="ss"> arquivos criados em '</span><span class="sc">{</span>folder<span class="sc">}</span><span class="ss">'"</span>)</span>
<span id="cb26-1945"><a href="#cb26-1945" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1946"><a href="#cb26-1946" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> save_all_to_single_files(<span class="va">self</span>):</span>
<span id="cb26-1947"><a href="#cb26-1947" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Salva todas as conversas em arquivos √∫nicos CSV e JSON"""</span></span>
<span id="cb26-1948"><a href="#cb26-1948" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb26-1949"><a href="#cb26-1949" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="st">"üîÆ [DRY-RUN] Arquivos √∫nicos seriam criados:"</span>)</span>
<span id="cb26-1950"><a href="#cb26-1950" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="ss">f"   üìÅ </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>single_files[<span class="st">'csv'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb26-1951"><a href="#cb26-1951" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="ss">f"   üìÅ </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>single_files[<span class="st">'json'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb26-1952"><a href="#cb26-1952" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb26-1953"><a href="#cb26-1953" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb26-1954"><a href="#cb26-1954" aria-hidden="true" tabindex="-1"></a>        <span class="co"># CSV √∫nico</span></span>
<span id="cb26-1955"><a href="#cb26-1955" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> <span class="bu">open</span>(<span class="va">self</span>.single_files[<span class="st">'csv'</span>], <span class="st">'w'</span>, encoding<span class="op">=</span><span class="st">'utf-8'</span>, newline<span class="op">=</span><span class="st">''</span>) <span class="im">as</span> f:</span>
<span id="cb26-1956"><a href="#cb26-1956" aria-hidden="true" tabindex="-1"></a>            fieldnames <span class="op">=</span> [</span>
<span id="cb26-1957"><a href="#cb26-1957" aria-hidden="true" tabindex="-1"></a>                <span class="st">'conversation_number'</span>, <span class="st">'source'</span>, <span class="st">'conversation_title'</span>, <span class="st">'category'</span>,</span>
<span id="cb26-1958"><a href="#cb26-1958" aria-hidden="true" tabindex="-1"></a>                <span class="st">'author'</span>, <span class="st">'role'</span>, <span class="st">'timestamp'</span>, <span class="st">'model'</span>, <span class="st">'content'</span></span>
<span id="cb26-1959"><a href="#cb26-1959" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb26-1960"><a href="#cb26-1960" aria-hidden="true" tabindex="-1"></a>            writer <span class="op">=</span> csv.DictWriter(f, fieldnames<span class="op">=</span>fieldnames)</span>
<span id="cb26-1961"><a href="#cb26-1961" aria-hidden="true" tabindex="-1"></a>            writer.writeheader()</span>
<span id="cb26-1962"><a href="#cb26-1962" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> conv <span class="kw">in</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb26-1963"><a href="#cb26-1963" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> msg <span class="kw">in</span> conv[<span class="st">'messages'</span>]:</span>
<span id="cb26-1964"><a href="#cb26-1964" aria-hidden="true" tabindex="-1"></a>                    writer.writerow({</span>
<span id="cb26-1965"><a href="#cb26-1965" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'conversation_number'</span>: conv[<span class="st">'number'</span>],</span>
<span id="cb26-1966"><a href="#cb26-1966" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'source'</span>: conv[<span class="st">'source'</span>],</span>
<span id="cb26-1967"><a href="#cb26-1967" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'conversation_title'</span>: conv[<span class="st">'title'</span>],</span>
<span id="cb26-1968"><a href="#cb26-1968" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'category'</span>: conv[<span class="st">'category'</span>],</span>
<span id="cb26-1969"><a href="#cb26-1969" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'author'</span>: msg[<span class="st">'author'</span>],</span>
<span id="cb26-1970"><a href="#cb26-1970" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'role'</span>: msg[<span class="st">'role'</span>],</span>
<span id="cb26-1971"><a href="#cb26-1971" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'timestamp'</span>: msg[<span class="st">'timestamp'</span>],</span>
<span id="cb26-1972"><a href="#cb26-1972" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'model'</span>: msg[<span class="st">'model'</span>],</span>
<span id="cb26-1973"><a href="#cb26-1973" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'content'</span>: msg[<span class="st">'content'</span>]</span>
<span id="cb26-1974"><a href="#cb26-1974" aria-hidden="true" tabindex="-1"></a>                    })</span>
<span id="cb26-1975"><a href="#cb26-1975" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.logger.info(<span class="ss">f"‚úÖ CSV √∫nico: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>single_files[<span class="st">'csv'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb26-1976"><a href="#cb26-1976" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1977"><a href="#cb26-1977" aria-hidden="true" tabindex="-1"></a>        <span class="co"># JSON √∫nico</span></span>
<span id="cb26-1978"><a href="#cb26-1978" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> <span class="bu">open</span>(<span class="va">self</span>.single_files[<span class="st">'json'</span>], <span class="st">'w'</span>, encoding<span class="op">=</span><span class="st">'utf-8'</span>) <span class="im">as</span> f:</span>
<span id="cb26-1979"><a href="#cb26-1979" aria-hidden="true" tabindex="-1"></a>            json.dump(<span class="va">self</span>.all_conversations, f, ensure_ascii<span class="op">=</span><span class="va">False</span>, indent<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb26-1980"><a href="#cb26-1980" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.logger.info(<span class="ss">f"‚úÖ JSON √∫nico: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>single_files[<span class="st">'json'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb26-1981"><a href="#cb26-1981" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1982"><a href="#cb26-1982" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_searchable_index(<span class="va">self</span>):</span>
<span id="cb26-1983"><a href="#cb26-1983" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Cria √≠ndice HTML pesquis√°vel com links para HTML"""</span></span>
<span id="cb26-1984"><a href="#cb26-1984" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.dry_run:</span>
<span id="cb26-1985"><a href="#cb26-1985" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.logger.info(<span class="ss">f"üîÆ [DRY-RUN] √çndice HTML seria criado: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>index_file<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb26-1986"><a href="#cb26-1986" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb26-1987"><a href="#cb26-1987" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb26-1988"><a href="#cb26-1988" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.logger.info(<span class="st">"üéØ Criando √≠ndice HTML combinado..."</span>)</span>
<span id="cb26-1989"><a href="#cb26-1989" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb26-1990"><a href="#cb26-1990" aria-hidden="true" tabindex="-1"></a>        category_stats <span class="op">=</span> {}</span>
<span id="cb26-1991"><a href="#cb26-1991" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> conv <span class="kw">in</span> <span class="va">self</span>.all_conversations:</span>
<span id="cb26-1992"><a href="#cb26-1992" aria-hidden="true" tabindex="-1"></a>            cat <span class="op">=</span> conv[<span class="st">'category'</span>]</span>
<span id="cb26-1993"><a href="#cb26-1993" aria-hidden="true" tabindex="-1"></a>            category_stats[cat] <span class="op">=</span> category_stats.get(cat, <span class="dv">0</span>) <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb26-1994"><a href="#cb26-1994" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1995"><a href="#cb26-1995" aria-hidden="true" tabindex="-1"></a>        html_content <span class="op">=</span> <span class="ss">f"""<!DOCTYPE html></span></span>
<span id="cb26-1996"><a href="#cb26-1996" aria-hidden="true" tabindex="-1"></a><span class="ss"><html lang="pt-PT"></span></span>
<span id="cb26-1997"><a href="#cb26-1997" aria-hidden="true" tabindex="-1"></a><span class="ss"><head>

        <style id="fixed-toc-styles">
        /* === ESTILOS PRINCIPAIS - TOC FIXO √Ä DIREITA === */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
            scroll-behavior: smooth;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            position: relative;
        }
        /* === TOC FIXO √Ä DIREITA - POSI√á√ÉO CORRIGIDA === */
        #TOC {
            position: fixed !important;
            top: 50% !important;
            right: 20px !important;
            transform: translateY(-50%) !important;
            width: 320px !important;
            max-height: 80vh !important;
            overflow-y: auto !important;
            z-index: 1000 !important;
            background: rgba(255, 255, 255, 0.98) !important;
            padding: 20px !important;
            border-radius: 12px !important;
            box-shadow: 0 8px 32px rgba(0,0,0,0.15) !important;
            border: 1px solid #e0e0e0 !important;
            backdrop-filter: blur(10px) !important;
            transition: all 0.3s ease-in-out !important;
        }
        #TOC.toc-minimized {
            transform: translateY(-50%) translateX(calc(320px - 50px)) !important;
            opacity: 0.3;
            width: 50px !important;
            overflow: hidden;
        }
        #TOC.toc-minimized > *:not(.toc-toggle-btn) {
            display: none !important;
        }
        #TOC h2 {
            margin-top: 0;
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
            font-size: 1.2em;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .toc-toggle-btn {
            background: none;
            border: none;
            font-size: 1.2em;
            cursor: pointer;
            padding: 5px;
            border-radius: 4px;
            transition: background-color 0.2s;
        }
        .toc-toggle-btn:hover {
            background-color: rgba(0,0,0,0.1);
        }
        #TOC ul {
            list-style-type: none;
            padding-left: 15px;
            margin: 10px 0;
        }
        #TOC ul ul {
            padding-left: 20px;
        }
        #TOC li {
            margin: 8px 0;
            line-height: 1.4;
        }
        #TOC a {
            text-decoration: none;
            color: #495057;
            font-weight: 500;
            transition: all 0.2s ease;
            display: block;
            padding: 6px 10px;
            border-radius: 6px;
            border-left: 3px solid transparent;
        }
        #TOC a:hover {
            color: #007bff;
            background-color: rgba(0, 123, 255, 0.1);
            border-left-color: #007bff;
        }
        #TOC a.active {
            background-color: #007bff !important;
            color: white !important;
            font-weight: bold;
            border-left-color: #0056b3;
        }
        /* Conte√∫do principal com margem para o TOC */
        .main-content {
            margin-right: calc(320px + 40px) !important;
        }
        /* Barra de scroll personalizada APENAS para TOC */
        #TOC::-webkit-scrollbar {
            width: 8px;
        }
        #TOC::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }
        #TOC::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 4px;
        }
        #TOC::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }
        /* === BOT√ÉO VOLTAR AO TOPO (HTMLs individuais) === */
        .back-to-top-content {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            font-size: 18px;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 999;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .back-to-top-content.show {
            opacity: 1;
            transform: translateY(0);
        }
        .back-to-top-content:hover {
            background: #0056b3;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0,0,0,0.2);
        }
        /* === RESPONSIVIDADE === */
        @media (max-width: 1400px) {
            .container {
                max-width: 95%;
                padding: 30px;
            }
            #TOC {
                width: 280px !important;
            }
            .main-content {
                margin-right: 320px !important;
            }
        }
        @media (max-width: 1200px) {
            #TOC {
                width: 260px !important;
                right: 15px !important;
            }
            .main-content {
                margin-right: 300px !important;
            }
        }
        @media (max-width: 992px) {
            #TOC {
                position: relative !important;
                width: 100% !important;
                right: 0 !important;
                top: 0 !important;
                transform: none !important;
                margin: 20px 0;
                max-height: 300px !important;
            }
            .main-content {
                margin-right: 0 !important;
            }
            .back-to-top-content {
                right: 20px;
                bottom: 20px;
            }
        }
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            .container {
                padding: 20px;
                max-width: 100%;
            }
            #TOC {
                max-height: 250px !important;
                padding: 15px !important;
            }
        }
        </style>
        </span></span>
<span id="cb26-1998"><a href="#cb26-1998" aria-hidden="true" tabindex="-1"></a><span class="ss">    <meta charset="UTF-8"></span></span>
<span id="cb26-1999"><a href="#cb26-1999" aria-hidden="true" tabindex="-1"></a><span class="ss">    <meta name="viewport" content="width=device-width, initial-scale=1.0"></span></span>
<span id="cb26-2000"><a href="#cb26-2000" aria-hidden="true" tabindex="-1"></a><span class="ss">    <title>√çndice Combinado - AI Chats</title></span></span>
<span id="cb26-2001"><a href="#cb26-2001" aria-hidden="true" tabindex="-1"></a><span class="ss">    <style></span></span>
<span id="cb26-2002"><a href="#cb26-2002" aria-hidden="true" tabindex="-1"></a><span class="ss">        * </span><span class="ch">{{</span><span class="ss"> margin: 0; padding: 0; box-sizing: border-box; </span><span class="ch">}}</span></span>
<span id="cb26-2003"><a href="#cb26-2003" aria-hidden="true" tabindex="-1"></a><span class="ss">        body </span><span class="ch">{{</span><span class="ss"> font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; padding: 20px; color: #333; </span><span class="ch">}}</span></span>
<span id="cb26-2004"><a href="#cb26-2004" aria-hidden="true" tabindex="-1"></a><span class="ss">        .container </span><span class="ch">{{</span><span class="ss"> max-width: 1400px; margin: 0 auto; background: white; border-radius: 15px; box-shadow: 0 20px 40px rgba(0,0,0,0.1); overflow: hidden; </span><span class="ch">}}</span></span>
<span id="cb26-2005"><a href="#cb26-2005" aria-hidden="true" tabindex="-1"></a><span class="ss">        .header </span><span class="ch">{{</span><span class="ss"> background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 40px; text-align: center; </span><span class="ch">}}</span></span>
<span id="cb26-2006"><a href="#cb26-2006" aria-hidden="true" tabindex="-1"></a><span class="ss">        .header h1 </span><span class="ch">{{</span><span class="ss"> font-size: 2.8em; margin-bottom: 15px; font-weight: 300; </span><span class="ch">}}</span></span>
<span id="cb26-2007"><a href="#cb26-2007" aria-hidden="true" tabindex="-1"></a><span class="ss">        .header p </span><span class="ch">{{</span><span class="ss"> font-size: 1.2em; opacity: 0.9; margin-bottom: 20px; </span><span class="ch">}}</span></span>
<span id="cb26-2008"><a href="#cb26-2008" aria-hidden="true" tabindex="-1"></a><span class="ss">        .stats </span><span class="ch">{{</span><span class="ss"> display: flex; justify-content: center; gap: 30px; margin-top: 25px; flex-wrap: wrap; </span><span class="ch">}}</span></span>
<span id="cb26-2009"><a href="#cb26-2009" aria-hidden="true" tabindex="-1"></a><span class="ss">        .stat-item </span><span class="ch">{{</span><span class="ss"> background: rgba(255,255,255,0.15); padding: 18px 28px; border-radius: 12px; backdrop-filter: blur(10px); font-size: 1.1em; </span><span class="ch">}}</span></span>
<span id="cb26-2010"><a href="#cb26-2010" aria-hidden="true" tabindex="-1"></a><span class="ss">        .search-section </span><span class="ch">{{</span><span class="ss"> padding: 30px; background: #f8f9fa; border-bottom: 1px solid #e9ecef; </span><span class="ch">}}</span></span>
<span id="cb26-2011"><a href="#cb26-2011" aria-hidden="true" tabindex="-1"></a><span class="ss">        .search-box </span><span class="ch">{{</span><span class="ss"> width: 100%; padding: 18px 25px; font-size: 16px; border: 2px solid #e9ecef; border-radius: 25px; outline: none; transition: all 0.3s ease; font-family: inherit; </span><span class="ch">}}</span></span>
<span id="cb26-2012"><a href="#cb26-2012" aria-hidden="true" tabindex="-1"></a><span class="ss">        .search-box:focus </span><span class="ch">{{</span><span class="ss"> border-color: #667eea; box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1); </span><span class="ch">}}</span></span>
<span id="cb26-2013"><a href="#cb26-2013" aria-hidden="true" tabindex="-1"></a><span class="ss">        .filter-section </span><span class="ch">{{</span></span>
<span id="cb26-2014"><a href="#cb26-2014" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 20px 30px;</span></span>
<span id="cb26-2015"><a href="#cb26-2015" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: flex;</span></span>
<span id="cb26-2016"><a href="#cb26-2016" aria-hidden="true" tabindex="-1"></a><span class="ss">            flex-wrap: wrap;</span></span>
<span id="cb26-2017"><a href="#cb26-2017" aria-hidden="true" tabindex="-1"></a><span class="ss">            gap: 12px;</span></span>
<span id="cb26-2018"><a href="#cb26-2018" aria-hidden="true" tabindex="-1"></a><span class="ss">            justify-content: center;</span></span>
<span id="cb26-2019"><a href="#cb26-2019" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #f8f9fa;</span></span>
<span id="cb26-2020"><a href="#cb26-2020" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-bottom: 1px solid #e9ecef;</span></span>
<span id="cb26-2021"><a href="#cb26-2021" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb26-2022"><a href="#cb26-2022" aria-hidden="true" tabindex="-1"></a><span class="ss">        .filter-btn </span><span class="ch">{{</span></span>
<span id="cb26-2023"><a href="#cb26-2023" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 10px 20px;</span></span>
<span id="cb26-2024"><a href="#cb26-2024" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: white;</span></span>
<span id="cb26-2025"><a href="#cb26-2025" aria-hidden="true" tabindex="-1"></a><span class="ss">            border: 2px solid #e9ecef;</span></span>
<span id="cb26-2026"><a href="#cb26-2026" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 25px;</span></span>
<span id="cb26-2027"><a href="#cb26-2027" aria-hidden="true" tabindex="-1"></a><span class="ss">            cursor: pointer;</span></span>
<span id="cb26-2028"><a href="#cb26-2028" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.95em;</span></span>
<span id="cb26-2029"><a href="#cb26-2029" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-weight: 500;</span></span>
<span id="cb26-2030"><a href="#cb26-2030" aria-hidden="true" tabindex="-1"></a><span class="ss">            transition: all 0.3s ease;</span></span>
<span id="cb26-2031"><a href="#cb26-2031" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-family: inherit;</span></span>
<span id="cb26-2032"><a href="#cb26-2032" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb26-2033"><a href="#cb26-2033" aria-hidden="true" tabindex="-1"></a><span class="ss">        .filter-btn.active, .filter-btn:hover </span><span class="ch">{{</span></span>
<span id="cb26-2034"><a href="#cb26-2034" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #667eea;</span></span>
<span id="cb26-2035"><a href="#cb26-2035" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: white;</span></span>
<span id="cb26-2036"><a href="#cb26-2036" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-color: #667eea;</span></span>
<span id="cb26-2037"><a href="#cb26-2037" aria-hidden="true" tabindex="-1"></a><span class="ss">            transform: translateY(-2px);</span></span>
<span id="cb26-2038"><a href="#cb26-2038" aria-hidden="true" tabindex="-1"></a><span class="ss">            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);</span></span>
<span id="cb26-2039"><a href="#cb26-2039" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb26-2040"><a href="#cb26-2040" aria-hidden="true" tabindex="-1"></a><span class="ss">        .conversations-grid </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb26-2041"><a href="#cb26-2041" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: grid; </span></span>
<span id="cb26-2042"><a href="#cb26-2042" aria-hidden="true" tabindex="-1"></a><span class="ss">            grid-template-columns: repeat(auto-fill, minmax(380px, 1fr)); </span></span>
<span id="cb26-2043"><a href="#cb26-2043" aria-hidden="true" tabindex="-1"></a><span class="ss">            gap: 25px; </span></span>
<span id="cb26-2044"><a href="#cb26-2044" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 35px;</span></span>
<span id="cb26-2045"><a href="#cb26-2045" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);</span></span>
<span id="cb26-2046"><a href="#cb26-2046" aria-hidden="true" tabindex="-1"></a><span class="ss">            min-height: 400px;</span></span>
<span id="cb26-2047"><a href="#cb26-2047" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb26-2048"><a href="#cb26-2048" aria-hidden="true" tabindex="-1"></a><span class="ss">        .conversation-card </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb26-2049"><a href="#cb26-2049" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: white; </span></span>
<span id="cb26-2050"><a href="#cb26-2050" aria-hidden="true" tabindex="-1"></a><span class="ss">            border: 1px solid #e9ecef; </span></span>
<span id="cb26-2051"><a href="#cb26-2051" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 15px; </span></span>
<span id="cb26-2052"><a href="#cb26-2052" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 25px; </span></span>
<span id="cb26-2053"><a href="#cb26-2053" aria-hidden="true" tabindex="-1"></a><span class="ss">            transition: all 0.4s ease; </span></span>
<span id="cb26-2054"><a href="#cb26-2054" aria-hidden="true" tabindex="-1"></a><span class="ss">            cursor: pointer; </span></span>
<span id="cb26-2055"><a href="#cb26-2055" aria-hidden="true" tabindex="-1"></a><span class="ss">            position: relative;</span></span>
<span id="cb26-2056"><a href="#cb26-2056" aria-hidden="true" tabindex="-1"></a><span class="ss">            box-shadow: 0 5px 15px rgba(0,0,0,0.08);</span></span>
<span id="cb26-2057"><a href="#cb26-2057" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb26-2058"><a href="#cb26-2058" aria-hidden="true" tabindex="-1"></a><span class="ss">        .conversation-card:hover </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb26-2059"><a href="#cb26-2059" aria-hidden="true" tabindex="-1"></a><span class="ss">            transform: translateY(-8px); </span></span>
<span id="cb26-2060"><a href="#cb26-2060" aria-hidden="true" tabindex="-1"></a><span class="ss">            box-shadow: 0 15px 35px rgba(0,0,0,0.15); </span></span>
<span id="cb26-2061"><a href="#cb26-2061" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-color: #667eea;</span></span>
<span id="cb26-2062"><a href="#cb26-2062" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb26-2063"><a href="#cb26-2063" aria-hidden="true" tabindex="-1"></a><span class="ss">        .card-header </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb26-2064"><a href="#cb26-2064" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: flex; </span></span>
<span id="cb26-2065"><a href="#cb26-2065" aria-hidden="true" tabindex="-1"></a><span class="ss">            justify-content: space-between; </span></span>
<span id="cb26-2066"><a href="#cb26-2066" aria-hidden="true" tabindex="-1"></a><span class="ss">            align-items: flex-start; </span></span>
<span id="cb26-2067"><a href="#cb26-2067" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-bottom: 18px; </span></span>
<span id="cb26-2068"><a href="#cb26-2068" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb26-2069"><a href="#cb26-2069" aria-hidden="true" tabindex="-1"></a><span class="ss">        .card-number </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb26-2070"><a href="#cb26-2070" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: linear-gradient(135deg, #667eea, #764ba2); </span></span>
<span id="cb26-2071"><a href="#cb26-2071" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: white; </span></span>
<span id="cb26-2072"><a href="#cb26-2072" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 8px 16px; </span></span>
<span id="cb26-2073"><a href="#cb26-2073" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 20px; </span></span>
<span id="cb26-2074"><a href="#cb26-2074" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.9em; </span></span>
<span id="cb26-2075"><a href="#cb26-2075" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-weight: bold;</span></span>
<span id="cb26-2076"><a href="#cb26-2076" aria-hidden="true" tabindex="-1"></a><span class="ss">            box-shadow: 0 3px 10px rgba(102, 126, 234, 0.3);</span></span>
<span id="cb26-2077"><a href="#cb26-2077" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb26-2078"><a href="#cb26-2078" aria-hidden="true" tabindex="-1"></a><span class="ss">        .card-source </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb26-2079"><a href="#cb26-2079" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #e3f2fd; </span></span>
<span id="cb26-2080"><a href="#cb26-2080" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #1976d2; </span></span>
<span id="cb26-2081"><a href="#cb26-2081" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 5px 12px; </span></span>
<span id="cb26-2082"><a href="#cb26-2082" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 12px; </span></span>
<span id="cb26-2083"><a href="#cb26-2083" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.85em; </span></span>
<span id="cb26-2084"><a href="#cb26-2084" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-weight: bold; </span></span>
<span id="cb26-2085"><a href="#cb26-2085" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-left: 10px;</span></span>
<span id="cb26-2086"><a href="#cb26-2086" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb26-2087"><a href="#cb26-2087" aria-hidden="true" tabindex="-1"></a><span class="ss">        .card-title </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb26-2088"><a href="#cb26-2088" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 1.3em; </span></span>
<span id="cb26-2089"><a href="#cb26-2089" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-weight: 600; </span></span>
<span id="cb26-2090"><a href="#cb26-2090" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #2c3e50; </span></span>
<span id="cb26-2091"><a href="#cb26-2091" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-bottom: 12px; </span></span>
<span id="cb26-2092"><a href="#cb26-2092" aria-hidden="true" tabindex="-1"></a><span class="ss">            line-height: 1.4;</span></span>
<span id="cb26-2093"><a href="#cb26-2093" aria-hidden="true" tabindex="-1"></a><span class="ss">            min-height: 3.6em;</span></span>
<span id="cb26-2094"><a href="#cb26-2094" aria-hidden="true" tabindex="-1"></a><span class="ss">            cursor: pointer;</span></span>
<span id="cb26-2095"><a href="#cb26-2095" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb26-2096"><a href="#cb26-2096" aria-hidden="true" tabindex="-1"></a><span class="ss">        .card-summary </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb26-2097"><a href="#cb26-2097" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #6c757d; </span></span>
<span id="cb26-2098"><a href="#cb26-2098" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.95em; </span></span>
<span id="cb26-2099"><a href="#cb26-2099" aria-hidden="true" tabindex="-1"></a><span class="ss">            line-height: 1.5; </span></span>
<span id="cb26-2100"><a href="#cb26-2100" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-bottom: 18px;</span></span>
<span id="cb26-2101"><a href="#cb26-2101" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: -webkit-box;</span></span>
<span id="cb26-2102"><a href="#cb26-2102" aria-hidden="true" tabindex="-1"></a><span class="ss">            -webkit-line-clamp: 3;</span></span>
<span id="cb26-2103"><a href="#cb26-2103" aria-hidden="true" tabindex="-1"></a><span class="ss">            -webkit-box-orient: vertical;</span></span>
<span id="cb26-2104"><a href="#cb26-2104" aria-hidden="true" tabindex="-1"></a><span class="ss">            overflow: hidden;</span></span>
<span id="cb26-2105"><a href="#cb26-2105" aria-hidden="true" tabindex="-1"></a><span class="ss">            cursor: pointer;</span></span>
<span id="cb26-2106"><a href="#cb26-2106" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb26-2107"><a href="#cb26-2107" aria-hidden="true" tabindex="-1"></a><span class="ss">        .card-meta </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb26-2108"><a href="#cb26-2108" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: flex; </span></span>
<span id="cb26-2109"><a href="#cb26-2109" aria-hidden="true" tabindex="-1"></a><span class="ss">            justify-content: space-between; </span></span>
<span id="cb26-2110"><a href="#cb26-2110" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.85em; </span></span>
<span id="cb26-2111"><a href="#cb26-2111" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #868e96; </span></span>
<span id="cb26-2112"><a href="#cb26-2112" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-top: 1px solid #e9ecef; </span></span>
<span id="cb26-2113"><a href="#cb26-2113" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding-top: 18px;</span></span>
<span id="cb26-2114"><a href="#cb26-2114" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb26-2115"><a href="#cb26-2115" aria-hidden="true" tabindex="-1"></a><span class="ss">        .card-actions </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb26-2116"><a href="#cb26-2116" aria-hidden="true" tabindex="-1"></a><span class="ss">            position: absolute; </span></span>
<span id="cb26-2117"><a href="#cb26-2117" aria-hidden="true" tabindex="-1"></a><span class="ss">            top: 20px; </span></span>
<span id="cb26-2118"><a href="#cb26-2118" aria-hidden="true" tabindex="-1"></a><span class="ss">            right: 20px; </span></span>
<span id="cb26-2119"><a href="#cb26-2119" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: flex; </span></span>
<span id="cb26-2120"><a href="#cb26-2120" aria-hidden="true" tabindex="-1"></a><span class="ss">            gap: 8px; </span></span>
<span id="cb26-2121"><a href="#cb26-2121" aria-hidden="true" tabindex="-1"></a><span class="ss">            opacity: 0; </span></span>
<span id="cb26-2122"><a href="#cb26-2122" aria-hidden="true" tabindex="-1"></a><span class="ss">            transition: opacity 0.3s ease; </span></span>
<span id="cb26-2123"><a href="#cb26-2123" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb26-2124"><a href="#cb26-2124" aria-hidden="true" tabindex="-1"></a><span class="ss">        .conversation-card:hover .card-actions </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb26-2125"><a href="#cb26-2125" aria-hidden="true" tabindex="-1"></a><span class="ss">            opacity: 1; </span></span>
<span id="cb26-2126"><a href="#cb26-2126" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb26-2127"><a href="#cb26-2127" aria-hidden="true" tabindex="-1"></a><span class="ss">        .action-btn </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb26-2128"><a href="#cb26-2128" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: white; </span></span>
<span id="cb26-2129"><a href="#cb26-2129" aria-hidden="true" tabindex="-1"></a><span class="ss">            border: 2px solid #e9ecef; </span></span>
<span id="cb26-2130"><a href="#cb26-2130" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 8px; </span></span>
<span id="cb26-2131"><a href="#cb26-2131" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 6px 12px; </span></span>
<span id="cb26-2132"><a href="#cb26-2132" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.8em; </span></span>
<span id="cb26-2133"><a href="#cb26-2133" aria-hidden="true" tabindex="-1"></a><span class="ss">            cursor: pointer; </span></span>
<span id="cb26-2134"><a href="#cb26-2134" aria-hidden="true" tabindex="-1"></a><span class="ss">            transition: all 0.3s ease;</span></span>
<span id="cb26-2135"><a href="#cb26-2135" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-weight: 500;</span></span>
<span id="cb26-2136"><a href="#cb26-2136" aria-hidden="true" tabindex="-1"></a><span class="ss">            text-decoration: none;</span></span>
<span id="cb26-2137"><a href="#cb26-2137" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #333;</span></span>
<span id="cb26-2138"><a href="#cb26-2138" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: inline-block;</span></span>
<span id="cb26-2139"><a href="#cb26-2139" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb26-2140"><a href="#cb26-2140" aria-hidden="true" tabindex="-1"></a><span class="ss">        .action-btn:hover </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb26-2141"><a href="#cb26-2141" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #667eea; </span></span>
<span id="cb26-2142"><a href="#cb26-2142" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: white; </span></span>
<span id="cb26-2143"><a href="#cb26-2143" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-color: #667eea;</span></span>
<span id="cb26-2144"><a href="#cb26-2144" aria-hidden="true" tabindex="-1"></a><span class="ss">            transform: scale(1.05);</span></span>
<span id="cb26-2145"><a href="#cb26-2145" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb26-2146"><a href="#cb26-2146" aria-hidden="true" tabindex="-1"></a><span class="ss">        .recent-badge </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb26-2147"><a href="#cb26-2147" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #ff6b6b; </span></span>
<span id="cb26-2148"><a href="#cb26-2148" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: white; </span></span>
<span id="cb26-2149"><a href="#cb26-2149" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 3px 10px; </span></span>
<span id="cb26-2150"><a href="#cb26-2150" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 12px; </span></span>
<span id="cb26-2151"><a href="#cb26-2151" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.75em; </span></span>
<span id="cb26-2152"><a href="#cb26-2152" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-left: 8px;</span></span>
<span id="cb26-2153"><a href="#cb26-2153" aria-hidden="true" tabindex="-1"></a><span class="ss">            animation: pulse 2s infinite;</span></span>
<span id="cb26-2154"><a href="#cb26-2154" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb26-2155"><a href="#cb26-2155" aria-hidden="true" tabindex="-1"></a><span class="ss">        .no-results </span><span class="ch">{{</span><span class="ss"> </span></span>
<span id="cb26-2156"><a href="#cb26-2156" aria-hidden="true" tabindex="-1"></a><span class="ss">            text-align: center; </span></span>
<span id="cb26-2157"><a href="#cb26-2157" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 60px 20px; </span></span>
<span id="cb26-2158"><a href="#cb26-2158" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #6c757d;</span></span>
<span id="cb26-2159"><a href="#cb26-2159" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 1.1em;</span></span>
<span id="cb26-2160"><a href="#cb26-2160" aria-hidden="true" tabindex="-1"></a><span class="ss">            grid-column: 1 / -1;</span></span>
<span id="cb26-2161"><a href="#cb26-2161" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb26-2162"><a href="#cb26-2162" aria-hidden="true" tabindex="-1"></a><span class="ss">        @keyframes pulse </span><span class="ch">{{</span></span>
<span id="cb26-2163"><a href="#cb26-2163" aria-hidden="true" tabindex="-1"></a><span class="ss">            0% </span><span class="ch">{{</span><span class="ss"> transform: scale(1); </span><span class="ch">}}</span></span>
<span id="cb26-2164"><a href="#cb26-2164" aria-hidden="true" tabindex="-1"></a><span class="ss">            50% </span><span class="ch">{{</span><span class="ss"> transform: scale(1.05); </span><span class="ch">}}</span></span>
<span id="cb26-2165"><a href="#cb26-2165" aria-hidden="true" tabindex="-1"></a><span class="ss">            100% </span><span class="ch">{{</span><span class="ss"> transform: scale(1); </span><span class="ch">}}</span></span>
<span id="cb26-2166"><a href="#cb26-2166" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb26-2167"><a href="#cb26-2167" aria-hidden="true" tabindex="-1"></a><span class="ss">        .category-badge </span><span class="ch">{{</span></span>
<span id="cb26-2168"><a href="#cb26-2168" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: inline-block;</span></span>
<span id="cb26-2169"><a href="#cb26-2169" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #e3f2fd;</span></span>
<span id="cb26-2170"><a href="#cb26-2170" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: #1976d2;</span></span>
<span id="cb26-2171"><a href="#cb26-2171" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 4px 10px;</span></span>
<span id="cb26-2172"><a href="#cb26-2172" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 12px;</span></span>
<span id="cb26-2173"><a href="#cb26-2173" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.8em;</span></span>
<span id="cb26-2174"><a href="#cb26-2174" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin-left: 8px;</span></span>
<span id="cb26-2175"><a href="#cb26-2175" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-weight: 500;</span></span>
<span id="cb26-2176"><a href="#cb26-2176" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb26-2177"><a href="#cb26-2177" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb26-2178"><a href="#cb26-2178" aria-hidden="true" tabindex="-1"></a><span class="ss">        .direct-link </span><span class="ch">{{</span></span>
<span id="cb26-2179"><a href="#cb26-2179" aria-hidden="true" tabindex="-1"></a><span class="ss">            display: inline-block;</span></span>
<span id="cb26-2180"><a href="#cb26-2180" aria-hidden="true" tabindex="-1"></a><span class="ss">            margin: 5px;</span></span>
<span id="cb26-2181"><a href="#cb26-2181" aria-hidden="true" tabindex="-1"></a><span class="ss">            padding: 8px 15px;</span></span>
<span id="cb26-2182"><a href="#cb26-2182" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #28a745;</span></span>
<span id="cb26-2183"><a href="#cb26-2183" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: white;</span></span>
<span id="cb26-2184"><a href="#cb26-2184" aria-hidden="true" tabindex="-1"></a><span class="ss">            text-decoration: none;</span></span>
<span id="cb26-2185"><a href="#cb26-2185" aria-hidden="true" tabindex="-1"></a><span class="ss">            border-radius: 5px;</span></span>
<span id="cb26-2186"><a href="#cb26-2186" aria-hidden="true" tabindex="-1"></a><span class="ss">            font-size: 0.9em;</span></span>
<span id="cb26-2187"><a href="#cb26-2187" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb26-2188"><a href="#cb26-2188" aria-hidden="true" tabindex="-1"></a><span class="ss">        .direct-link:hover </span><span class="ch">{{</span></span>
<span id="cb26-2189"><a href="#cb26-2189" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #218838;</span></span>
<span id="cb26-2190"><a href="#cb26-2190" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb26-2191"><a href="#cb26-2191" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb26-2192"><a href="#cb26-2192" aria-hidden="true" tabindex="-1"></a><span class="ss">        .html-btn </span><span class="ch">{{</span></span>
<span id="cb26-2193"><a href="#cb26-2193" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #17a2b8;</span></span>
<span id="cb26-2194"><a href="#cb26-2194" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: white;</span></span>
<span id="cb26-2195"><a href="#cb26-2195" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb26-2196"><a href="#cb26-2196" aria-hidden="true" tabindex="-1"></a><span class="ss">        .html-btn:hover </span><span class="ch">{{</span></span>
<span id="cb26-2197"><a href="#cb26-2197" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #138496;</span></span>
<span id="cb26-2198"><a href="#cb26-2198" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb26-2199"><a href="#cb26-2199" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb26-2200"><a href="#cb26-2200" aria-hidden="true" tabindex="-1"></a><span class="ss">        .pdf-btn </span><span class="ch">{{</span></span>
<span id="cb26-2201"><a href="#cb26-2201" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #dc3545;</span></span>
<span id="cb26-2202"><a href="#cb26-2202" aria-hidden="true" tabindex="-1"></a><span class="ss">            color: white;</span></span>
<span id="cb26-2203"><a href="#cb26-2203" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb26-2204"><a href="#cb26-2204" aria-hidden="true" tabindex="-1"></a><span class="ss">        .pdf-btn:hover </span><span class="ch">{{</span></span>
<span id="cb26-2205"><a href="#cb26-2205" aria-hidden="true" tabindex="-1"></a><span class="ss">            background: #c82333;</span></span>
<span id="cb26-2206"><a href="#cb26-2206" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span><span class="ch">}}</span></span>
<span id="cb26-2207"><a href="#cb26-2207" aria-hidden="true" tabindex="-1"></a><span class="ss">    </style></span></span>
<span id="cb26-2208"><a href="#cb26-2208" aria-hidden="true" tabindex="-1"></a><span class="ss"></head></span></span>
<span id="cb26-2209"><a href="#cb26-2209" aria-hidden="true" tabindex="-1"></a><span class="ss"><body></span></span>
<span id="cb26-2210"><a href="#cb26-2210" aria-hidden="true" tabindex="-1"></a><span class="ss">    <div class="container"></span></span>
<span id="cb26-2211"><a href="#cb26-2211" aria-hidden="true" tabindex="-1"></a><span class="ss">        <div class="header"></span></span>
<span id="cb26-2212"><a href="#cb26-2212" aria-hidden="true" tabindex="-1"></a><span class="ss">            <h1>üìö √çndice Combinado de Conversas</h1></span></span>
<span id="cb26-2213"><a href="#cb26-2213" aria-hidden="true" tabindex="-1"></a><span class="ss">            <p>Qwen3 ‚Ä¢ ChatGPT ‚Ä¢ DeepSeek ‚Ä¢ Grok ‚Ä¢ COM HTML (Pandoc + MathJax)</p></span></span>
<span id="cb26-2214"><a href="#cb26-2214" aria-hidden="true" tabindex="-1"></a><span class="ss">            <div class="stats"></span></span>
<span id="cb26-2215"><a href="#cb26-2215" aria-hidden="true" tabindex="-1"></a><span class="ss">                <div class="stat-item"></span></span>
<span id="cb26-2216"><a href="#cb26-2216" aria-hidden="true" tabindex="-1"></a><span class="ss">                    <strong>Total:</strong> <span id="total-count"></span><span class="sc">{</span><span class="bu">len</span>(<span class="va">self</span>.all_conversations)<span class="sc">}</span><span class="ss"></span> conversas</span></span>
<span id="cb26-2217"><a href="#cb26-2217" aria-hidden="true" tabindex="-1"></a><span class="ss">                </div></span></span>
<span id="cb26-2218"><a href="#cb26-2218" aria-hidden="true" tabindex="-1"></a><span class="ss">                <div class="stat-item"></span></span>
<span id="cb26-2219"><a href="#cb26-2219" aria-hidden="true" tabindex="-1"></a><span class="ss">                    <strong>Ordena√ß√£o:</strong> Mais Recentes Primeiro</span></span>
<span id="cb26-2220"><a href="#cb26-2220" aria-hidden="true" tabindex="-1"></a><span class="ss">                </div></span></span>
<span id="cb26-2221"><a href="#cb26-2221" aria-hidden="true" tabindex="-1"></a><span class="ss">                <div class="stat-item"></span></span>
<span id="cb26-2222"><a href="#cb26-2222" aria-hidden="true" tabindex="-1"></a><span class="ss">                    <strong>Atualizado:</strong> </span><span class="sc">{</span>datetime<span class="sc">.</span>now()<span class="sc">.</span>strftime(<span class="st">'</span><span class="sc">%d</span><span class="st">/%m/%Y %H:%M'</span>)<span class="sc">}</span></span>
<span id="cb26-2223"><a href="#cb26-2223" aria-hidden="true" tabindex="-1"></a><span class="ss">                </div></span></span>
<span id="cb26-2224"><a href="#cb26-2224" aria-hidden="true" tabindex="-1"></a><span class="ss">            </div></span></span>
<span id="cb26-2225"><a href="#cb26-2225" aria-hidden="true" tabindex="-1"></a><span class="ss">        </div></span></span>
<span id="cb26-2226"><a href="#cb26-2226" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb26-2227"><a href="#cb26-2227" aria-hidden="true" tabindex="-1"></a><span class="ss">        <div class="search-section"></span></span>
<span id="cb26-2228"><a href="#cb26-2228" aria-hidden="true" tabindex="-1"></a><span class="ss">            <input type="text" id="searchInput" class="search-box" placeholder="üîç Pesquisar por t√≠tulo, conte√∫do ou categoria..."></span></span>
<span id="cb26-2229"><a href="#cb26-2229" aria-hidden="true" tabindex="-1"></a><span class="ss">        </div></span></span>
<span id="cb26-2230"><a href="#cb26-2230" aria-hidden="true" tabindex="-1"></a><span class="ss">        </span></span>
<span id="cb26-2231"><a href="#cb26-2231" aria-hidden="true" tabindex="-1"></a><span class="ss">        <div class="filter-section"></span></span>
<span id="cb26-2232"><a href="#cb26-2232" aria-hidden="true" tabindex="-1"></a><span class="ss">            <button class="filter-btn active" data-filter="todas">Todas (</span><span class="sc">{</span><span class="bu">len</span>(<span class="va">self</span>.all_conversations)<span class="sc">}</span><span class="ss">)</button></span></span>
<span id="cb26-2233"><a href="#cb26-2233" aria-hidden="true" tabindex="-1"></a><span class="ss">"""</span></span>
<span id="cb26-2234"><a href="#cb26-2234" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb26-2235"><a href="#cb26-2235" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> category, count <span class="kw">in</span> category_stats.items():</span>
<span id="cb26-2236"><a href="#cb26-2236" aria-hidden="true" tabindex="-1"></a>            html_content <span class="op">+=</span> <span class="ss">f'<button class="filter-btn" data-filter="</span><span class="sc">{</span>category<span class="sc">.</span>lower()<span class="sc">}</span><span class="ss">"></span><span class="sc">{</span>category<span class="sc">}</span><span class="ss"> (</span><span class="sc">{</span>count<span class="sc">}</span><span class="ss">)</button></span><span class="ch">\n</span><span class="ss">'</span></span>
<span id="cb26-2237"><a href="#cb26-2237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-2238"><a href="#cb26-2238" aria-hidden="true" tabindex="-1"></a>        html_content <span class="op">+=</span> <span class="st">"""</span></span>
<span id="cb26-2239"><a href="#cb26-2239" aria-hidden="true" tabindex="-1"></a><span class="st">        </div></span></span>
<span id="cb26-2240"><a href="#cb26-2240" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb26-2241"><a href="#cb26-2241" aria-hidden="true" tabindex="-1"></a><span class="st">        <div style="text-align: center; padding: 15px; background: #e9ecef; border-bottom: 1px solid #ddd;"></span></span>
<span id="cb26-2242"><a href="#cb26-2242" aria-hidden="true" tabindex="-1"></a><span class="st">            <strong>Acesso R√°pido:</strong></span></span>
<span id="cb26-2243"><a href="#cb26-2243" aria-hidden="true" tabindex="-1"></a><span class="st">            <a href="combined_markdown/" class="direct-link" target="_blank">üìÅ Markdown</a></span></span>
<span id="cb26-2244"><a href="#cb26-2244" aria-hidden="true" tabindex="-1"></a><span class="st">            <a href="combined_html/" class="direct-link" target="_blank">üåê HTML</a></span></span>
<span id="cb26-2245"><a href="#cb26-2245" aria-hidden="true" tabindex="-1"></a><span class="st">            <a href="combined_pdfs/" class="direct-link" target="_blank">üìÑ PDF</a></span></span>
<span id="cb26-2246"><a href="#cb26-2246" aria-hidden="true" tabindex="-1"></a><span class="st">            <a href="combined_json/" class="direct-link" target="_blank">üìã JSON</a></span></span>
<span id="cb26-2247"><a href="#cb26-2247" aria-hidden="true" tabindex="-1"></a><span class="st">        </div></span></span>
<span id="cb26-2248"><a href="#cb26-2248" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb26-2249"><a href="#cb26-2249" aria-hidden="true" tabindex="-1"></a><span class="st">        <div class="conversations-grid" id="conversationsGrid"></span></span>
<span id="cb26-2250"><a href="#cb26-2250" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb26-2251"><a href="#cb26-2251" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb26-2252"><a href="#cb26-2252" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, conv <span class="kw">in</span> <span class="bu">enumerate</span>(<span class="va">self</span>.all_conversations):</span>
<span id="cb26-2253"><a href="#cb26-2253" aria-hidden="true" tabindex="-1"></a>            safe_title <span class="op">=</span> <span class="va">self</span>.sanitize_filename(conv[<span class="st">'title'</span>])</span>
<span id="cb26-2254"><a href="#cb26-2254" aria-hidden="true" tabindex="-1"></a>            filename <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>conv[<span class="st">'number'</span>]<span class="sc">:03d}</span><span class="ss">_</span><span class="sc">{</span>conv[<span class="st">'source'</span>]<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>safe_title<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb26-2255"><a href="#cb26-2255" aria-hidden="true" tabindex="-1"></a>            recent_badge <span class="op">=</span> <span class="st">"<span class='recent-badge'>NOVO</span>"</span> <span class="cf">if</span> i <span class="op"><</span> <span class="dv">5</span> <span class="cf">else</span> <span class="st">""</span></span>
<span id="cb26-2256"><a href="#cb26-2256" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb26-2257"><a href="#cb26-2257" aria-hidden="true" tabindex="-1"></a>            summary <span class="op">=</span> conv.get(<span class="st">'summary'</span>, <span class="st">'Sem resumo dispon√≠vel'</span>)</span>
<span id="cb26-2258"><a href="#cb26-2258" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">len</span>(summary) <span class="op">></span> <span class="dv">150</span>:</span>
<span id="cb26-2259"><a href="#cb26-2259" aria-hidden="true" tabindex="-1"></a>                summary <span class="op">=</span> summary[:<span class="dv">150</span>] <span class="op">+</span> <span class="st">"..."</span></span>
<span id="cb26-2260"><a href="#cb26-2260" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb26-2261"><a href="#cb26-2261" aria-hidden="true" tabindex="-1"></a>            html_content <span class="op">+=</span> <span class="ss">f"""</span></span>
<span id="cb26-2262"><a href="#cb26-2262" aria-hidden="true" tabindex="-1"></a><span class="ss">            <div class="conversation-card" data-title="</span><span class="sc">{</span>conv[<span class="st">'title'</span>]<span class="sc">}</span><span class="ss">" data-summary="</span><span class="sc">{</span>summary<span class="sc">}</span><span class="ss">" data-source="</span><span class="sc">{</span>conv[<span class="st">'source'</span>]<span class="sc">.</span>lower()<span class="sc">}</span><span class="ss">" data-category="</span><span class="sc">{</span>conv[<span class="st">'category'</span>]<span class="sc">.</span>lower()<span class="sc">}</span><span class="ss">"></span></span>
<span id="cb26-2263"><a href="#cb26-2263" aria-hidden="true" tabindex="-1"></a><span class="ss">                <div class="card-header"></span></span>
<span id="cb26-2264"><a href="#cb26-2264" aria-hidden="true" tabindex="-1"></a><span class="ss">                    <div class="card-number">#</span><span class="sc">{</span>conv[<span class="st">'number'</span>]<span class="sc">}</span><span class="ss"> </span><span class="sc">{</span>recent_badge<span class="sc">}</span><span class="ss"></div></span></span>
<span id="cb26-2265"><a href="#cb26-2265" aria-hidden="true" tabindex="-1"></a><span class="ss">                    <div class="card-actions"></span></span>
<span id="cb26-2266"><a href="#cb26-2266" aria-hidden="true" tabindex="-1"></a><span class="ss">                        <a href="combined_markdown/</span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">.md" class="action-btn" target="_blank" onclick="event.stopPropagation();">üìÑ MD</a></span></span>
<span id="cb26-2267"><a href="#cb26-2267" aria-hidden="true" tabindex="-1"></a><span class="ss">                        <a href="combined_html/</span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">.html" class="action-btn html-btn" target="_blank" onclick="event.stopPropagation();">üåê HTML</a></span></span>
<span id="cb26-2268"><a href="#cb26-2268" aria-hidden="true" tabindex="-1"></a><span class="ss">                        <a href="combined_pdfs/</span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">.pdf" class="action-btn pdf-btn" target="_blank" onclick="event.stopPropagation();">üìä PDF</a></span></span>
<span id="cb26-2269"><a href="#cb26-2269" aria-hidden="true" tabindex="-1"></a><span class="ss">                    </div></span></span>
<span id="cb26-2270"><a href="#cb26-2270" aria-hidden="true" tabindex="-1"></a><span class="ss">                </div></span></span>
<span id="cb26-2271"><a href="#cb26-2271" aria-hidden="true" tabindex="-1"></a><span class="ss">                <div class="card-title" onclick="openHTML('</span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">.html')"></span><span class="sc">{</span>conv[<span class="st">'title'</span>]<span class="sc">}</span><span class="ss"></div></span></span>
<span id="cb26-2272"><a href="#cb26-2272" aria-hidden="true" tabindex="-1"></a><span class="ss">                <div></span></span>
<span id="cb26-2273"><a href="#cb26-2273" aria-hidden="true" tabindex="-1"></a><span class="ss">                    <span class="card-source"></span><span class="sc">{</span>conv[<span class="st">'source'</span>]<span class="sc">}</span><span class="ss"></span></span></span>
<span id="cb26-2274"><a href="#cb26-2274" aria-hidden="true" tabindex="-1"></a><span class="ss">                    <span class="category-badge"></span><span class="sc">{</span>conv[<span class="st">'category'</span>]<span class="sc">}</span><span class="ss"></span></span></span>
<span id="cb26-2275"><a href="#cb26-2275" aria-hidden="true" tabindex="-1"></a><span class="ss">                </div></span></span>
<span id="cb26-2276"><a href="#cb26-2276" aria-hidden="true" tabindex="-1"></a><span class="ss">                <div class="card-summary" onclick="openHTML('</span><span class="sc">{</span>filename<span class="sc">}</span><span class="ss">.html')"></span><span class="sc">{</span>summary<span class="sc">}</span><span class="ss"></div></span></span>
<span id="cb26-2277"><a href="#cb26-2277" aria-hidden="true" tabindex="-1"></a><span class="ss">                <div class="card-meta"></span></span>
<span id="cb26-2278"><a href="#cb26-2278" aria-hidden="true" tabindex="-1"></a><span class="ss">                    <span>üìÖ </span><span class="sc">{</span>conv<span class="sc">.</span>get(<span class="st">'updated_at'</span>) <span class="kw">or</span> conv<span class="sc">.</span>get(<span class="st">'inserted_at'</span>) <span class="kw">or</span> <span class="st">'N/A'</span><span class="sc">}</span><span class="ss"></span></span></span>
<span id="cb26-2279"><a href="#cb26-2279" aria-hidden="true" tabindex="-1"></a><span class="ss">                    <span>üí¨ </span><span class="sc">{</span><span class="bu">len</span>(conv[<span class="st">'messages'</span>])<span class="sc">}</span><span class="ss"> mensagens</span></span></span>
<span id="cb26-2280"><a href="#cb26-2280" aria-hidden="true" tabindex="-1"></a><span class="ss">                </div></span></span>
<span id="cb26-2281"><a href="#cb26-2281" aria-hidden="true" tabindex="-1"></a><span class="ss">            </div></span></span>
<span id="cb26-2282"><a href="#cb26-2282" aria-hidden="true" tabindex="-1"></a><span class="ss">            """</span></span>
<span id="cb26-2283"><a href="#cb26-2283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-2284"><a href="#cb26-2284" aria-hidden="true" tabindex="-1"></a>        html_content <span class="op">+=</span> <span class="st">"""</span></span>
<span id="cb26-2285"><a href="#cb26-2285" aria-hidden="true" tabindex="-1"></a><span class="st">        </div></span></span>
<span id="cb26-2286"><a href="#cb26-2286" aria-hidden="true" tabindex="-1"></a><span class="st">    </div></span></span>
<span id="cb26-2287"><a href="#cb26-2287" aria-hidden="true" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb26-2288"><a href="#cb26-2288" aria-hidden="true" tabindex="-1"></a><span class="st">    <script></span></span>
<span id="cb26-2289"><a href="#cb26-2289" aria-hidden="true" tabindex="-1"></a><span class="st">        let currentFilter = 'todas';</span></span>
<span id="cb26-2290"><a href="#cb26-2290" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb26-2291"><a href="#cb26-2291" aria-hidden="true" tabindex="-1"></a><span class="st">        document.addEventListener('DOMContentLoaded', function() {</span></span>
<span id="cb26-2292"><a href="#cb26-2292" aria-hidden="true" tabindex="-1"></a><span class="st">            updateStats();</span></span>
<span id="cb26-2293"><a href="#cb26-2293" aria-hidden="true" tabindex="-1"></a><span class="st">        });</span></span>
<span id="cb26-2294"><a href="#cb26-2294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-2295"><a href="#cb26-2295" aria-hidden="true" tabindex="-1"></a><span class="st">        document.querySelectorAll('.filter-btn').forEach(btn => {</span></span>
<span id="cb26-2296"><a href="#cb26-2296" aria-hidden="true" tabindex="-1"></a><span class="st">            btn.addEventListener('click', () => {</span></span>
<span id="cb26-2297"><a href="#cb26-2297" aria-hidden="true" tabindex="-1"></a><span class="st">                document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));</span></span>
<span id="cb26-2298"><a href="#cb26-2298" aria-hidden="true" tabindex="-1"></a><span class="st">                btn.classList.add('active');</span></span>
<span id="cb26-2299"><a href="#cb26-2299" aria-hidden="true" tabindex="-1"></a><span class="st">                currentFilter = btn.getAttribute('data-filter');</span></span>
<span id="cb26-2300"><a href="#cb26-2300" aria-hidden="true" tabindex="-1"></a><span class="st">                filterConversations();</span></span>
<span id="cb26-2301"><a href="#cb26-2301" aria-hidden="true" tabindex="-1"></a><span class="st">            });</span></span>
<span id="cb26-2302"><a href="#cb26-2302" aria-hidden="true" tabindex="-1"></a><span class="st">        });</span></span>
<span id="cb26-2303"><a href="#cb26-2303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-2304"><a href="#cb26-2304" aria-hidden="true" tabindex="-1"></a><span class="st">        document.getElementById('searchInput').addEventListener('input', filterConversations);</span></span>
<span id="cb26-2305"><a href="#cb26-2305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-2306"><a href="#cb26-2306" aria-hidden="true" tabindex="-1"></a><span class="st">        function filterConversations() {</span></span>
<span id="cb26-2307"><a href="#cb26-2307" aria-hidden="true" tabindex="-1"></a><span class="st">            const term = document.getElementById('searchInput').value.toLowerCase();</span></span>
<span id="cb26-2308"><a href="#cb26-2308" aria-hidden="true" tabindex="-1"></a><span class="st">            const cards = document.querySelectorAll('.conversation-card');</span></span>
<span id="cb26-2309"><a href="#cb26-2309" aria-hidden="true" tabindex="-1"></a><span class="st">            let visible = 0;</span></span>
<span id="cb26-2310"><a href="#cb26-2310" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb26-2311"><a href="#cb26-2311" aria-hidden="true" tabindex="-1"></a><span class="st">            cards.forEach(card => {</span></span>
<span id="cb26-2312"><a href="#cb26-2312" aria-hidden="true" tabindex="-1"></a><span class="st">                const title = card.getAttribute('data-title').toLowerCase();</span></span>
<span id="cb26-2313"><a href="#cb26-2313" aria-hidden="true" tabindex="-1"></a><span class="st">                const summary = card.getAttribute('data-summary').toLowerCase();</span></span>
<span id="cb26-2314"><a href="#cb26-2314" aria-hidden="true" tabindex="-1"></a><span class="st">                const source = card.getAttribute('data-source').toLowerCase();</span></span>
<span id="cb26-2315"><a href="#cb26-2315" aria-hidden="true" tabindex="-1"></a><span class="st">                const category = card.getAttribute('data-category').toLowerCase();</span></span>
<span id="cb26-2316"><a href="#cb26-2316" aria-hidden="true" tabindex="-1"></a><span class="st">                </span></span>
<span id="cb26-2317"><a href="#cb26-2317" aria-hidden="true" tabindex="-1"></a><span class="st">                const matchesSearch = (title.includes(term) || summary.includes(term) || category.includes(term) || source.includes(term));</span></span>
<span id="cb26-2318"><a href="#cb26-2318" aria-hidden="true" tabindex="-1"></a><span class="st">                const matchesCategory = (currentFilter === 'todas' || category === currentFilter);</span></span>
<span id="cb26-2319"><a href="#cb26-2319" aria-hidden="true" tabindex="-1"></a><span class="st">                </span></span>
<span id="cb26-2320"><a href="#cb26-2320" aria-hidden="true" tabindex="-1"></a><span class="st">                if (matchesSearch && matchesCategory) {</span></span>
<span id="cb26-2321"><a href="#cb26-2321" aria-hidden="true" tabindex="-1"></a><span class="st">                    card.style.display = 'block';</span></span>
<span id="cb26-2322"><a href="#cb26-2322" aria-hidden="true" tabindex="-1"></a><span class="st">                    visible++;</span></span>
<span id="cb26-2323"><a href="#cb26-2323" aria-hidden="true" tabindex="-1"></a><span class="st">                } else {</span></span>
<span id="cb26-2324"><a href="#cb26-2324" aria-hidden="true" tabindex="-1"></a><span class="st">                    card.style.display = 'none';</span></span>
<span id="cb26-2325"><a href="#cb26-2325" aria-hidden="true" tabindex="-1"></a><span class="st">                }</span></span>
<span id="cb26-2326"><a href="#cb26-2326" aria-hidden="true" tabindex="-1"></a><span class="st">            });</span></span>
<span id="cb26-2327"><a href="#cb26-2327" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb26-2328"><a href="#cb26-2328" aria-hidden="true" tabindex="-1"></a><span class="st">            updateStats(visible);</span></span>
<span id="cb26-2329"><a href="#cb26-2329" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb26-2330"><a href="#cb26-2330" aria-hidden="true" tabindex="-1"></a><span class="st">            const grid = document.getElementById('conversationsGrid');</span></span>
<span id="cb26-2331"><a href="#cb26-2331" aria-hidden="true" tabindex="-1"></a><span class="st">            const noResults = document.getElementById('no-results-message');</span></span>
<span id="cb26-2332"><a href="#cb26-2332" aria-hidden="true" tabindex="-1"></a><span class="st">            </span></span>
<span id="cb26-2333"><a href="#cb26-2333" aria-hidden="true" tabindex="-1"></a><span class="st">            if (visible === 0) {</span></span>
<span id="cb26-2334"><a href="#cb26-2334" aria-hidden="true" tabindex="-1"></a><span class="st">                if (!noResults) {</span></span>
<span id="cb26-2335"><a href="#cb26-2335" aria-hidden="true" tabindex="-1"></a><span class="st">                    const noResultsMsg = document.createElement('div');</span></span>
<span id="cb26-2336"><a href="#cb26-2336" aria-hidden="true" tabindex="-1"></a><span class="st">                    noResultsMsg.id = 'no-results-message';</span></span>
<span id="cb26-2337"><a href="#cb26-2337" aria-hidden="true" tabindex="-1"></a><span class="st">                    noResultsMsg.className = 'no-results';</span></span>
<span id="cb26-2338"><a href="#cb26-2338" aria-hidden="true" tabindex="-1"></a><span class="st">                    noResultsMsg.innerHTML = 'üîç Nenhuma conversa encontrada. Tente ajustar os filtros ou a pesquisa.';</span></span>
<span id="cb26-2339"><a href="#cb26-2339" aria-hidden="true" tabindex="-1"></a><span class="st">                    grid.appendChild(noResultsMsg);</span></span>
<span id="cb26-2340"><a href="#cb26-2340" aria-hidden="true" tabindex="-1"></a><span class="st">                }</span></span>
<span id="cb26-2341"><a href="#cb26-2341" aria-hidden="true" tabindex="-1"></a><span class="st">            } else if (noResults) {</span></span>
<span id="cb26-2342"><a href="#cb26-2342" aria-hidden="true" tabindex="-1"></a><span class="st">                noResults.remove();</span></span>
<span id="cb26-2343"><a href="#cb26-2343" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb26-2344"><a href="#cb26-2344" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb26-2345"><a href="#cb26-2345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-2346"><a href="#cb26-2346" aria-hidden="true" tabindex="-1"></a><span class="st">        function updateStats(visibleCount = null) {</span></span>
<span id="cb26-2347"><a href="#cb26-2347" aria-hidden="true" tabindex="-1"></a><span class="st">            const totalElement = document.getElementById('total-count');</span></span>
<span id="cb26-2348"><a href="#cb26-2348" aria-hidden="true" tabindex="-1"></a><span class="st">            if (visibleCount !== null) {</span></span>
<span id="cb26-2349"><a href="#cb26-2349" aria-hidden="true" tabindex="-1"></a><span class="st">                totalElement.textContent = visibleCount;</span></span>
<span id="cb26-2350"><a href="#cb26-2350" aria-hidden="true" tabindex="-1"></a><span class="st">            } else {</span></span>
<span id="cb26-2351"><a href="#cb26-2351" aria-hidden="true" tabindex="-1"></a><span class="st">                totalElement.textContent = """</span> <span class="op">+</span> <span class="bu">str</span>(<span class="bu">len</span>(<span class="va">self</span>.all_conversations)) <span class="op">+</span> <span class="st">""";</span></span>
<span id="cb26-2352"><a href="#cb26-2352" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb26-2353"><a href="#cb26-2353" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb26-2354"><a href="#cb26-2354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-2355"><a href="#cb26-2355" aria-hidden="true" tabindex="-1"></a><span class="st">        function openHTML(filename) {</span></span>
<span id="cb26-2356"><a href="#cb26-2356" aria-hidden="true" tabindex="-1"></a><span class="st">            const htmlUrl = 'combined_html/' + filename;</span></span>
<span id="cb26-2357"><a href="#cb26-2357" aria-hidden="true" tabindex="-1"></a><span class="st">            console.log('Abrindo HTML:', htmlUrl);</span></span>
<span id="cb26-2358"><a href="#cb26-2358" aria-hidden="true" tabindex="-1"></a><span class="st">            window.open(htmlUrl, '_blank');</span></span>
<span id="cb26-2359"><a href="#cb26-2359" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb26-2360"><a href="#cb26-2360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-2361"><a href="#cb26-2361" aria-hidden="true" tabindex="-1"></a><span class="st">        function openMD(filename) {</span></span>
<span id="cb26-2362"><a href="#cb26-2362" aria-hidden="true" tabindex="-1"></a><span class="st">            const mdUrl = 'combined_markdown/' + filename;</span></span>
<span id="cb26-2363"><a href="#cb26-2363" aria-hidden="true" tabindex="-1"></a><span class="st">            window.open(mdUrl, '_blank');</span></span>
<span id="cb26-2364"><a href="#cb26-2364" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb26-2365"><a href="#cb26-2365" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb26-2366"><a href="#cb26-2366" aria-hidden="true" tabindex="-1"></a><span class="st">        function openPDF(filename) {</span></span>
<span id="cb26-2367"><a href="#cb26-2367" aria-hidden="true" tabindex="-1"></a><span class="st">            const pdfFile = filename.replace('.html', '.pdf');</span></span>
<span id="cb26-2368"><a href="#cb26-2368" aria-hidden="true" tabindex="-1"></a><span class="st">            const pdfUrl = 'combined_pdfs/' + pdfFile;</span></span>
<span id="cb26-2369"><a href="#cb26-2369" aria-hidden="true" tabindex="-1"></a><span class="st">            window.open(pdfUrl, '_blank');</span></span>
<span id="cb26-2370"><a href="#cb26-2370" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb26-2371"><a href="#cb26-2371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-2372"><a href="#cb26-2372" aria-hidden="true" tabindex="-1"></a><span class="st">        document.addEventListener('keydown', function(e) {</span></span>
<span id="cb26-2373"><a href="#cb26-2373" aria-hidden="true" tabindex="-1"></a><span class="st">            if (e.key === 'Escape') {</span></span>
<span id="cb26-2374"><a href="#cb26-2374" aria-hidden="true" tabindex="-1"></a><span class="st">                document.getElementById('searchInput').value = '';</span></span>
<span id="cb26-2375"><a href="#cb26-2375" aria-hidden="true" tabindex="-1"></a><span class="st">                filterConversations();</span></span>
<span id="cb26-2376"><a href="#cb26-2376" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb26-2377"><a href="#cb26-2377" aria-hidden="true" tabindex="-1"></a><span class="st">        });</span></span>
<span id="cb26-2378"><a href="#cb26-2378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-2379"><a href="#cb26-2379" aria-hidden="true" tabindex="-1"></a><span class="st">        document.querySelectorAll('.conversation-card').forEach(card => {</span></span>
<span id="cb26-2380"><a href="#cb26-2380" aria-hidden="true" tabindex="-1"></a><span class="st">            card.addEventListener('click', function(e) {</span></span>
<span id="cb26-2381"><a href="#cb26-2381" aria-hidden="true" tabindex="-1"></a><span class="st">                if (e.target.closest('.action-btn')) {</span></span>
<span id="cb26-2382"><a href="#cb26-2382" aria-hidden="true" tabindex="-1"></a><span class="st">                    return;</span></span>
<span id="cb26-2383"><a href="#cb26-2383" aria-hidden="true" tabindex="-1"></a><span class="st">                }</span></span>
<span id="cb26-2384"><a href="#cb26-2384" aria-hidden="true" tabindex="-1"></a><span class="st">                </span></span>
<span id="cb26-2385"><a href="#cb26-2385" aria-hidden="true" tabindex="-1"></a><span class="st">                const htmlBtn = this.querySelector('a.html-btn');</span></span>
<span id="cb26-2386"><a href="#cb26-2386" aria-hidden="true" tabindex="-1"></a><span class="st">                if (htmlBtn) {</span></span>
<span id="cb26-2387"><a href="#cb26-2387" aria-hidden="true" tabindex="-1"></a><span class="st">                    const htmlUrl = htmlBtn.getAttribute('href');</span></span>
<span id="cb26-2388"><a href="#cb26-2388" aria-hidden="true" tabindex="-1"></a><span class="st">                    window.open(htmlUrl, '_blank');</span></span>
<span id="cb26-2389"><a href="#cb26-2389" aria-hidden="true" tabindex="-1"></a><span class="st">                }</span></span>
<span id="cb26-2390"><a href="#cb26-2390" aria-hidden="true" tabindex="-1"></a><span class="st">            });</span></span>
<span id="cb26-2391"><a href="#cb26-2391" aria-hidden="true" tabindex="-1"></a><span class="st">        });</span></span>
<span id="cb26-2392"><a href="#cb26-2392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-2393"><a href="#cb26-2393" aria-hidden="true" tabindex="-1"></a><span class="st">        document.getElementById('searchInput').focus();</span></span>
<span id="cb26-2394"><a href="#cb26-2394" aria-hidden="true" tabindex="-1"></a><span class="st">        </span></span>
<span id="cb26-2395"><a href="#cb26-2395" aria-hidden="true" tabindex="-1"></a><span class="st">        console.log('√çndice carregado com', """</span> <span class="op">+</span> <span class="bu">str</span>(<span class="bu">len</span>(<span class="va">self</span>.all_conversations)) <span class="op">+</span> <span class="st">""", 'conversas');</span></span>
<span id="cb26-2396"><a href="#cb26-2396" aria-hidden="true" tabindex="-1"></a><span class="st">    </script></span></span>
<span id="cb26-2397"><a href="#cb26-2397" aria-hidden="true" tabindex="-1"></a><span class="st">
        <script id="fixed-toc-script">
        document.addEventListener('DOMContentLoaded', function() {
            const toc = document.getElementById('TOC');
            if (toc) {
                const tocTitle = toc.querySelector('h2');
                if (tocTitle) {
                    const toggleBtn = document.createElement('button');
                    toggleBtn.innerHTML = '‚ò∞';
                    toggleBtn.className = 'toc-toggle-btn';
                    toggleBtn.title = 'Minimizar/Expandir TOC';
                    let isMinimized = false;
                    toggleBtn.addEventListener('click', function(e) {
                        e.stopPropagation();
                        isMinimized = !isMinimized;
                        if (isMinimized) {
                            toc.classList.add('toc-minimized');
                        } else {
                            toc.classList.remove('toc-minimized');
                        }
                    });
                    tocTitle.appendChild(toggleBtn);
                }
            }
            
            // SCROLLSPY
            const sections = document.querySelectorAll('h1, h2, h3, h4, h5');
            const tocLinks = document.querySelectorAll('#TOC a');
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const id = entry.target.getAttribute('id');
                        tocLinks.forEach(link => {
                            link.classList.remove('active');
                            if (link.getAttribute('href') === '#' + id) {
                                link.classList.add('active');
                            }
                        });
                    }
                });
            }, { 
                rootMargin: '-20% 0px -60% 0px', 
                threshold: 0 
            });
            
            sections.forEach(section => {
                if (section.id) observer.observe(section);
            });
            
            // Scroll suave
            tocLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const targetId = link.getAttribute('href').substring(1);
                    const targetElement = document.getElementById(targetId);
                    if (targetElement) {
                        const offsetTop = targetElement.offsetTop - 80;
                        window.scrollTo({ top: offsetTop, behavior: 'smooth' });
                    }
                });
            });
            
            // BOT√ÉO VOLTAR AO TOPO
            const backToTopBtn = document.createElement('button');
            backToTopBtn.className = 'back-to-top-content';
            backToTopBtn.innerHTML = '‚Üë';
            backToTopBtn.title = 'Voltar ao Topo';
            document.body.appendChild(backToTopBtn);
            
            window.addEventListener('scroll', () => {
                if (window.pageYOffset > 300) {
                    backToTopBtn.classList.add('show');
                } else {
                    backToTopBtn.classList.remove('show');
                }
            });
            
            backToTopBtn.addEventListener('click', () => {
                window.scrollTo({ top: 0, behavior: 'smooth' });
            });
        });
        </script>
        
</body></span></span>
<span id="cb26-2398"><a href="#cb26-2398" aria-hidden="true" tabindex="-1"></a><span class="st"></html></span></span>
<span id="cb26-2399"><a href="#cb26-2399" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb26-2400"><a href="#cb26-2400" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb26-2401"><a href="#cb26-2401" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> <span class="bu">open</span>(<span class="va">self</span>.index_file, <span class="st">'w'</span>, encoding<span class="op">=</span><span class="st">'utf-8'</span>) <span class="im">as</span> f:</span>
<span id="cb26-2402"><a href="#cb26-2402" aria-hidden="true" tabindex="-1"></a>            f.write(html_content)</span>
<span id="cb26-2403"><a href="#cb26-2403" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.logger.info(<span class="ss">f"‚úÖ √çndice combinado criado: </span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>index_file<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb26-2404"><a href="#cb26-2404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-2405"><a href="#cb26-2405" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> main():</span>
<span id="cb26-2406"><a href="#cb26-2406" aria-hidden="true" tabindex="-1"></a>    parser <span class="op">=</span> argparse.ArgumentParser(</span>
<span id="cb26-2407"><a href="#cb26-2407" aria-hidden="true" tabindex="-1"></a>        description<span class="op">=</span><span class="st">"Processa exporta√ß√µes combinadas com exporta√ß√£o HTML via Pandoc."</span></span>
<span id="cb26-2408"><a href="#cb26-2408" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb26-2409"><a href="#cb26-2409" aria-hidden="true" tabindex="-1"></a>    parser.add_argument(<span class="st">"--dry-run"</span>, action<span class="op">=</span><span class="st">"store_true"</span>, <span class="bu">help</span><span class="op">=</span><span class="st">"Executa sem salvar arquivos"</span>)</span>
<span id="cb26-2410"><a href="#cb26-2410" aria-hidden="true" tabindex="-1"></a>    parser.add_argument(<span class="st">"--force-overwrite"</span>, action<span class="op">=</span><span class="st">"store_true"</span>, <span class="bu">help</span><span class="op">=</span><span class="st">"Substitui arquivos existentes"</span>)</span>
<span id="cb26-2411"><a href="#cb26-2411" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb26-2412"><a href="#cb26-2412" aria-hidden="true" tabindex="-1"></a>    args <span class="op">=</span> parser.parse_args()</span>
<span id="cb26-2413"><a href="#cb26-2413" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb26-2414"><a href="#cb26-2414" aria-hidden="true" tabindex="-1"></a>    system <span class="op">=</span> CombinedFragmentsSystem(</span>
<span id="cb26-2415"><a href="#cb26-2415" aria-hidden="true" tabindex="-1"></a>        dry_run<span class="op">=</span>args.dry_run,</span>
<span id="cb26-2416"><a href="#cb26-2416" aria-hidden="true" tabindex="-1"></a>        force_overwrite<span class="op">=</span>args.force_overwrite</span>
<span id="cb26-2417"><a href="#cb26-2417" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb26-2418"><a href="#cb26-2418" aria-hidden="true" tabindex="-1"></a>    system.run()</span>
<span id="cb26-2419"><a href="#cb26-2419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-2420"><a href="#cb26-2420" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">"__main__"</span>:</span>
<span id="cb26-2421"><a href="#cb26-2421" aria-hidden="true" tabindex="-1"></a>    main()</span></code></pre></div>
<p><strong>Principais altera√ß√µes na vers√£o 7:</strong></p>
<ol type="1">
<li><strong><code>--toc-depth=1</code></strong> em todos os comandos
Pandoc (otimizado e b√°sico)</li>
<li><strong>CSS ajustado</strong> para TOC de n√≠vel 1 (removido excesso
de indenta√ß√£o para n√≠veis mais profundos)</li>
<li><strong>Mantidas todas as corre√ß√µes de visibilidade</strong> da
vers√£o anterior</li>
<li><strong>Sistema completo e funcional</strong> com todas as
otimiza√ß√µes</li>
</ol>
<p>Agora o TOC mostrar√° apenas os cabe√ßalhos de n√≠vel 1
(<code>h1</code>), tornando a navega√ß√£o mais limpa e focada nos t√≠tulos
principais das conversas.</p>
<hr></hr>
<p><em>Conversa exportada do DeepSeek</em> <em>Processado em: 24/11/2025
22:27</em></p>

        <script id="fixed-toc-script">
        document.addEventListener('DOMContentLoaded', function() {
            const toc = document.getElementById('TOC');
            if (toc) {
                const tocTitle = toc.querySelector('h2');
                if (tocTitle) {
                    const toggleBtn = document.createElement('button');
                    toggleBtn.innerHTML = '‚ò∞';
                    toggleBtn.className = 'toc-toggle-btn';
                    toggleBtn.title = 'Minimizar/Expandir TOC';
                    let isMinimized = false;
                    toggleBtn.addEventListener('click', function(e) {
                        e.stopPropagation();
                        isMinimized = !isMinimized;
                        if (isMinimized) {
                            toc.classList.add('toc-minimized');
                        } else {
                            toc.classList.remove('toc-minimized');
                        }
                    });
                    tocTitle.appendChild(toggleBtn);
                }
            }
            
            // SCROLLSPY
            const sections = document.querySelectorAll('h1, h2, h3, h4, h5');
            const tocLinks = document.querySelectorAll('#TOC a');
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const id = entry.target.getAttribute('id');
                        tocLinks.forEach(link => {
                            link.classList.remove('active');
                            if (link.getAttribute('href') === '#' + id) {
                                link.classList.add('active');
                            }
                        });
                    }
                });
            }, { 
                rootMargin: '-20% 0px -60% 0px', 
                threshold: 0 
            });
            
            sections.forEach(section => {
                if (section.id) observer.observe(section);
            });
            
            // Scroll suave
            tocLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const targetId = link.getAttribute('href').substring(1);
                    const targetElement = document.getElementById(targetId);
                    if (targetElement) {
                        const offsetTop = targetElement.offsetTop - 80;
                        window.scrollTo({ top: offsetTop, behavior: 'smooth' });
                    }
                });
            });
            
            // BOT√ÉO VOLTAR AO TOPO
            const backToTopBtn = document.createElement('button');
            backToTopBtn.className = 'back-to-top-content';
            backToTopBtn.innerHTML = '‚Üë';
            backToTopBtn.title = 'Voltar ao Topo';
            document.body.appendChild(backToTopBtn);
            
            window.addEventListener('scroll', () => {
                if (window.pageYOffset > 300) {
                    backToTopBtn.classList.add('show');
                } else {
                    backToTopBtn.classList.remove('show');
                }
            });
            
            backToTopBtn.addEventListener('click', () => {
                window.scrollTo({ top: 0, behavior: 'smooth' });
            });
        });
        </script>
        
</body>
</html>
